### <a name="accessibility-improvements-in-windows-forms-controls-for-net-472"></a><span data-ttu-id="85137-101">已改進 .NET 4.7.2 之 Windows Forms 控制項的協助工具</span><span class="sxs-lookup"><span data-stu-id="85137-101">Accessibility improvements in Windows Forms controls for .NET 4.7.2</span></span>

|   |   |
|---|---|
|<span data-ttu-id="85137-102">詳細資料</span><span class="sxs-lookup"><span data-stu-id="85137-102">Details</span></span>|<span data-ttu-id="85137-103">Windows Forms Framework 利用了協助工具技術改善其運作方式，可為 Windows Forms 客戶提供更良好的支援。</span><span class="sxs-lookup"><span data-stu-id="85137-103">Windows Forms Framework is improving how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="85137-104">這些包括下列變更：</span><span class="sxs-lookup"><span data-stu-id="85137-104">These include the following changes:</span></span><ul><li><span data-ttu-id="85137-105">改善高對比模式期間之顯示方式的變更。</span><span class="sxs-lookup"><span data-stu-id="85137-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="85137-106">在 DataGridView 與 MenuStrip 控制項中進行了改進鍵盤瀏覽的變更。</span><span class="sxs-lookup"><span data-stu-id="85137-106">Changes to improve the keyboard navigation in the DataGridView and MenuStrip controls.</span></span></li><li><span data-ttu-id="85137-107">對朗讀程式的互動進行了變更。</span><span class="sxs-lookup"><span data-stu-id="85137-107">Changes to interaction with Narrator.</span></span></li></ul>|
|<span data-ttu-id="85137-108">建議</span><span class="sxs-lookup"><span data-stu-id="85137-108">Suggestion</span></span>|<span data-ttu-id="85137-109"><strong>如何選擇使用或不使用這些變更</strong>為了讓應用程式能受益於這些變更，它必須在 .NET Framework 4.7.2 或更新版本上執行。</span><span class="sxs-lookup"><span data-stu-id="85137-109"><strong>How to opt in or out of these changes</strong>In order for the application to benefit from these changes, it must run on the .NET Framework 4.7.2 or later.</span></span> <span data-ttu-id="85137-110">應用程式可以用下列任一種方式受益於這些變更：</span><span class="sxs-lookup"><span data-stu-id="85137-110">The application can benefit from these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="85137-111">其已重新編譯為以 .NET Framework 4.7.2 為目標。</span><span class="sxs-lookup"><span data-stu-id="85137-111">It is recompiled to target the .NET Framework 4.7.2.</span></span> <span data-ttu-id="85137-112">在以 .NET Framework 4.7.2 或更新版本為目標的 Windows Forms 應用程式上，預設會啟用這些協助工具的變更。</span><span class="sxs-lookup"><span data-stu-id="85137-112">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.7.2 or later.</span></span></li><li><span data-ttu-id="85137-113">其以 .NET Framework 4.7.1 或更新版本為目標，且藉由在應用程式組態檔的 <code>&lt;runtime&gt;</code> 區段中新增下列 [AppContext 參數](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element)，並將其設定為 <code>false</code>，選擇不使用舊版協助工具行為，如下範例所示。</span><span class="sxs-lookup"><span data-stu-id="85137-113">It targets the .NET Framework 4.7.1 or earlier version and opts out of the legacy accessibility behaviors by adding the following [AppContext Switch](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element) to the <code>&lt;runtime&gt;</code> section of the app config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><span data-ttu-id="85137-114">請注意，選擇使用 .NET Framework 4.7.2 中新增的協助工具功能時，也必須選擇使用 .NET Framework 4.7.1 的協助工具功能。</span><span class="sxs-lookup"><span data-stu-id="85137-114">Note that to opt in to the accessibility features added in .NET Framework 4.7.2, you must also opt in to accessibility features of .NET Framework 4.7.1 as well.</span></span> <span data-ttu-id="85137-115">以 .NET Framework 4.7.2 或更新版本為目標，並且想要保留舊版協助工具行為的應用程式，可以藉由明確地將此 AppContext 參數設定為 <code>true</code>，選擇使用舊版協助工具功能。<strong>在高對比佈景主題中會使用 OS 所定義的色彩</strong></span><span class="sxs-lookup"><span data-stu-id="85137-115">Applications that target the .NET Framework 4.7.2 or later and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.<strong>Use of OS-defined colors in High Contrast themes</strong></span></span><ul><li><span data-ttu-id="85137-116"><xref:System.Windows.Forms.ToolStripDropDownButton> 的下拉式箭頭現會於高對比佈景主題中使用 OS 所定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="85137-116">The drop down arrow arrow of the <xref:System.Windows.Forms.ToolStripDropDownButton> now uses OS-defined colors in High Contrast theme.</span></span></li><li><span data-ttu-id="85137-117">若有選取時，其 <xref:System.Windows.Forms.ButtonBase.FlatStyle> 設定為 <xref:System.Windows.Forms.FlatStyle.Flat?displayProperty=nameWithType> 或 <xref:System.Windows.Forms.FlatStyle.Popup?displayProperty=nameWithType> 的 <xref:System.Windows.Forms.Button>、<xref:System.Windows.Forms.RadioButton> 及 <xref:System.Windows.Forms.CheckBox> 控制項，現已會於高對比佈景主題中使用 OS 所定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="85137-117"><xref:System.Windows.Forms.Button>, <xref:System.Windows.Forms.RadioButton> and <xref:System.Windows.Forms.CheckBox> controls with <xref:System.Windows.Forms.ButtonBase.FlatStyle> set to <xref:System.Windows.Forms.FlatStyle.Flat?displayProperty=nameWithType> or <xref:System.Windows.Forms.FlatStyle.Popup?displayProperty=nameWithType> now use OS-defined colors in High Contrast theme when selected.</span></span> <span data-ttu-id="85137-118">以往，文字和背景色彩不會呈現對比，因此難以閱讀。</span><span class="sxs-lookup"><span data-stu-id="85137-118">Previously, text and background colors were not contrasting and were hard to read.</span></span></li><li><span data-ttu-id="85137-119">在 <xref:System.Windows.Forms.GroupBox> 中其 <xref:System.Windows.Forms.Control.Enabled> 屬性設定為 <code>false</code> 的控制項，現已會於高對比佈景主題中使用 OS 所定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="85137-119">Controls contained within a <xref:System.Windows.Forms.GroupBox> that has its <xref:System.Windows.Forms.Control.Enabled> property set to <code>false</code> will now use OS-defined colors in High Contrast theme.</span></span></li><li><span data-ttu-id="85137-120">控制項 <xref:System.Windows.Forms.ToolStripButton>、<xref:System.Windows.Forms.ToolStripComboBox> 和 <xref:System.Windows.Forms.ToolStripDropDownButton> 在高對比模式下有更高的亮度對比率。</span><span class="sxs-lookup"><span data-stu-id="85137-120">The <xref:System.Windows.Forms.ToolStripButton>, <xref:System.Windows.Forms.ToolStripComboBox>, and <xref:System.Windows.Forms.ToolStripDropDownButton> controls have an increased luminosity contrast ratio in High Contrast Mode.</span></span></li><li><span data-ttu-id="85137-121"><xref:System.Windows.Forms.DataGridViewLinkCell> 預設會為 <xref:System.Windows.Forms.DataGridViewLinkCell.LinkColor?displayProperty=nameWithType> 屬性在高對比模式下使用 OS 所定義的色彩。</span><span class="sxs-lookup"><span data-stu-id="85137-121"><xref:System.Windows.Forms.DataGridViewLinkCell> will by default use OS-defined colors in High Contrast mode for the <xref:System.Windows.Forms.DataGridViewLinkCell.LinkColor?displayProperty=nameWithType> property.</span></span></li></ul><span data-ttu-id="85137-122">注意：Windows 10 已變更某些高對比系統色彩的值。</span><span class="sxs-lookup"><span data-stu-id="85137-122">NOTE: Windows 10 has changed values for some high contrast system colors.</span></span> <span data-ttu-id="85137-123">Windows Forms 架構是以 Win32 架構為基礎。</span><span class="sxs-lookup"><span data-stu-id="85137-123">Windows Forms Framework is based on the Win32 framework.</span></span> <span data-ttu-id="85137-124">為獲得最佳體驗、在最新版的 Windows 上執行，以及新增最新作業系統變更，請在測試應用程式中新增 app.manifest 檔案，並取消註解下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="85137-124">For the best experience, run on the latest version of Windows and opt in to the latest OS changes by adding an app.manifest file in a test application and uncommenting the following code:</span></span><pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><span data-ttu-id="85137-125"><strong>改善的朗讀程式支援</strong></span><span class="sxs-lookup"><span data-stu-id="85137-125"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="85137-126">朗讀程式在播報 <xref:System.Windows.Forms.ToolStripMenuItem> 的文字時，現已會播報 <xref:System.Windows.Forms.ToolStripMenuItem.ShortcutKeys?displayProperty=nameWithType>屬性的值。</span><span class="sxs-lookup"><span data-stu-id="85137-126">Narrator now announces the value of the <xref:System.Windows.Forms.ToolStripMenuItem.ShortcutKeys?displayProperty=nameWithType> property when announcing the text of a <xref:System.Windows.Forms.ToolStripMenuItem>.</span></span></li><li><span data-ttu-id="85137-127">當 <xref:System.Windows.Forms.ToolStripMenuItem> 的 <xref:System.Windows.Forms.Control.Enabled> 屬性設定為 <code>false</code> 時，朗讀程式現在會指明該情況。</span><span class="sxs-lookup"><span data-stu-id="85137-127">Narrator now indicates when a <xref:System.Windows.Forms.ToolStripMenuItem> has its <xref:System.Windows.Forms.Control.Enabled> property set to <code>false</code>.</span></span></li><li><span data-ttu-id="85137-128">當 <xref:System.Windows.Forms.ListView.CheckBoxes?displayProperty=nameWithType> 屬性設定為 <code>true</code> 時，朗讀程式現已會提供核取方塊狀態的回應。</span><span class="sxs-lookup"><span data-stu-id="85137-128">Narrator now gives feedback on the state of a check box when the <xref:System.Windows.Forms.ListView.CheckBoxes?displayProperty=nameWithType> property is set to <code>true</code>.</span></span></li><li><span data-ttu-id="85137-129">朗讀程式掃描模式的焦點順序，與 ClickOnce 下載對話視窗中所看見的控制項順序現已一致。</span><span class="sxs-lookup"><span data-stu-id="85137-129">Narrator Scan Mode focus order is now consistent with the visual order of the controls on the ClickOnce download dialog window.</span></span></li></ul><span data-ttu-id="85137-130"><strong>已改進 DataGridView 協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="85137-130"><strong>Improved DataGridView Accessibility support</strong></span></span><ul><li><span data-ttu-id="85137-131"><xref:System.Windows.Forms.DataGridView> 中的資料列現已可使用鍵盤排序。</span><span class="sxs-lookup"><span data-stu-id="85137-131">Rows in a <xref:System.Windows.Forms.DataGridView> can now be sorted using the keyboard.</span></span> <span data-ttu-id="85137-132">使用者現已可使用 F3 鍵，依目前的資料行排序。</span><span class="sxs-lookup"><span data-stu-id="85137-132">Now a user can use the F3 key in order to sort by the current column.</span></span></li><li><span data-ttu-id="85137-133">當 <xref:System.Windows.Forms.DataGridView.SelectionMode?displayProperty=nameWithType> 設定為 <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> 時，資料行標頭會變更色彩，以在目前的資料列中指出使用者滑過儲存格時所在的資料行位置。</span><span class="sxs-lookup"><span data-stu-id="85137-133">When the <xref:System.Windows.Forms.DataGridView.SelectionMode?displayProperty=nameWithType> is set to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>, the column header will change color to indicate the current column as the user tabs through the cells in the current row.</span></span></li><li><span data-ttu-id="85137-134"><xref:System.Windows.Forms.DataGridViewCell.DataGridViewCellAccessibleObject.Parent?displayProperty=nameWithType> 屬性現已會傳回正確的父控制項。</span><span class="sxs-lookup"><span data-stu-id="85137-134">The <xref:System.Windows.Forms.DataGridViewCell.DataGridViewCellAccessibleObject.Parent?displayProperty=nameWithType> property now returns the correct parent control.</span></span></li></ul><span data-ttu-id="85137-135"><strong>已改進視覺提示</strong></span><span class="sxs-lookup"><span data-stu-id="85137-135"><strong>Improved Visual cues</strong></span></span><ul><li><span data-ttu-id="85137-136"><xref:System.Windows.Forms.ButtonBase.Text> 屬性為空白的控制項 <xref:System.Windows.Forms.RadioButton> 與 <xref:System.Windows.Forms.CheckBox>，現已會於接收到焦點時顯示焦點指標。</span><span class="sxs-lookup"><span data-stu-id="85137-136">The <xref:System.Windows.Forms.RadioButton> and <xref:System.Windows.Forms.CheckBox> controls with an empty <xref:System.Windows.Forms.ButtonBase.Text> property will now display a focus indicator when they receive focus.</span></span></li></ul><span data-ttu-id="85137-137"><strong>已改進屬性方格支援</strong></span><span class="sxs-lookup"><span data-stu-id="85137-137"><strong>Improved Property Grid Support</strong></span></span><ul><li><span data-ttu-id="85137-138"><xref:System.Windows.Forms.PropertyGrid> 控制項子項目現在只有在已啟用 PropertyGrid 項目的情況下，才會傳回 <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> 屬性的 <code>true</code>。</span><span class="sxs-lookup"><span data-stu-id="85137-138">The <xref:System.Windows.Forms.PropertyGrid> control child elements now return a <code>true</code> for the  <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> property only when a PropertyGrid element is enabled.</span></span></li><li><span data-ttu-id="85137-139"><xref:System.Windows.Forms.PropertyGrid> 控制項子項目現在只有在使用者可變更 PropertyGrid 項目的情況下，才會傳回 <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> 屬性的 <code>false</code>。</span><span class="sxs-lookup"><span data-stu-id="85137-139">The <xref:System.Windows.Forms.PropertyGrid> control child elements now return a <code>false</code> for the <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> property only when a PropertyGrid element can be changed by the user.</span></span></li></ul><span data-ttu-id="85137-140">如需 UI 自動化的概觀，請參閱 [UI 自動化概觀](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview)。<strong>已改進鍵盤瀏覽</strong></span><span class="sxs-lookup"><span data-stu-id="85137-140">For an overview of UI automation, see the [UI Automation Overview](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview).<strong>Improved keyboard navigation</strong></span></span><ul><li><span data-ttu-id="85137-141"><xref:System.Windows.Forms.ToolStripPanel.TabStop> 屬性設定為 <code>true</code> 的 <xref:System.Windows.Forms.ToolStripPanel>，內含有焦點時，<xref:System.Windows.Forms.ToolStripButton> 現已允許焦點</span><span class="sxs-lookup"><span data-stu-id="85137-141"><xref:System.Windows.Forms.ToolStripButton> now allows focus when contained within a <xref:System.Windows.Forms.ToolStripPanel> that has the <xref:System.Windows.Forms.ToolStripPanel.TabStop> property set to <code>true</code></span></span></li></ul>|
|<span data-ttu-id="85137-142">範圍</span><span class="sxs-lookup"><span data-stu-id="85137-142">Scope</span></span>|<span data-ttu-id="85137-143">主要</span><span class="sxs-lookup"><span data-stu-id="85137-143">Major</span></span>|
|<span data-ttu-id="85137-144">版本</span><span class="sxs-lookup"><span data-stu-id="85137-144">Version</span></span>|<span data-ttu-id="85137-145">4.7.2</span><span class="sxs-lookup"><span data-stu-id="85137-145">4.7.2</span></span>|
|<span data-ttu-id="85137-146">類型</span><span class="sxs-lookup"><span data-stu-id="85137-146">Type</span></span>|<span data-ttu-id="85137-147">正在重定目標</span><span class="sxs-lookup"><span data-stu-id="85137-147">Retargeting</span></span>|

