### <a name="accessibility-improvements-in-windows-forms-controls-for-net-472"></a>已改進 .NET 4.7.2 之 Windows Forms 控制項的協助工具

|   |   |
|---|---|
|詳細資料|Windows Forms Framework 利用了協助工具技術改善其運作方式，可為 Windows Forms 客戶提供更良好的支援。 這些包括下列變更：<ul><li>改善高對比模式期間之顯示方式的變更。</li><li>在 DataGridView 與 MenuStrip 控制項中進行了改進鍵盤瀏覽的變更。</li><li>對朗讀程式的互動進行了變更。</li></ul> | 
| 建議 | <strong>如何選擇使用或不使用這些變更</strong>為了讓應用程式能受益於這些變更，它必須在 .NET Framework 4.7.2 或更新版本上執行。 應用程式可以用下列任一種方式受益於這些變更：<ul><li>將其重新編譯為以 .NET Framework 4.7.2 為目標。 在以 .NET Framework 4.7.2 或更新版本為目標的 Windows Forms 應用程式上，預設會啟用這些協助工具的變更。</li><li>其以 .NET Framework 4.7.1 或更新版本為目標，且藉由在應用程式組態檔的 <code>&lt;runtime&gt;</code> 區段中新增下列 [AppContext 參數](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element)，並將其設定為 <code>false</code>，選擇不使用舊版協助工具行為，如下範例所示。</li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>請注意，選擇使用 .NET Framework 4.7.2 中新增的協助工具功能時，也必須選擇使用 .NET Framework 4.7.1 的協助工具功能。 以 .NET Framework 4.7.2 或更新版本為目標，並且想要保留舊版協助工具行為的應用程式，可以藉由明確地將此 AppContext 參數設定為 <code>true</code>，選擇使用舊版協助工具功能。<strong>在高對比佈景主題中會使用 OS 所定義的色彩</strong><ul><li><xref:System.Windows.Forms.ToolStripDropDownButton> 的下拉式箭號現在會於高對比佈景主題中使用 OS 所定義的色彩。</li><li>若有選取時，其 <xref:System.Windows.Forms.ButtonBase.FlatStyle> 設定為 <xref:System.Windows.Forms.FlatStyle.Flat?displayProperty=nameWithType> 或 <xref:System.Windows.Forms.FlatStyle.Popup?displayProperty=nameWithType> 的 <xref:System.Windows.Forms.Button>、<xref:System.Windows.Forms.RadioButton> 及 <xref:System.Windows.Forms.CheckBox> 控制項，現已會於高對比佈景主題中使用 OS 所定義的色彩。 以往，文字和背景色彩不會呈現對比，因此難以閱讀。</li><li>在 <xref:System.Windows.Forms.GroupBox> 中其 <xref:System.Windows.Forms.Control.Enabled> 屬性設定為 <code>false</code> 的控制項，現已會於高對比佈景主題中使用 OS 所定義的色彩。</li><li>控制項 <xref:System.Windows.Forms.ToolStripButton>、<xref:System.Windows.Forms.ToolStripComboBox> 和 <xref:System.Windows.Forms.ToolStripDropDownButton> 在高對比模式下有更高的亮度對比率。</li><li><xref:System.Windows.Forms.DataGridViewLinkCell> 預設會為 <xref:System.Windows.Forms.DataGridViewLinkCell.LinkColor?displayProperty=nameWithType> 屬性在高對比模式下使用 OS 所定義的色彩。</li></ul>注意：Windows 10 已變更某些高對比系統色彩的值。 Windows Forms 架構是以 Win32 架構為基礎。 為獲得最佳體驗、在最新版的 Windows 上執行，以及新增最新作業系統變更，請在測試應用程式中新增 app.manifest 檔案，並取消註解下列程式碼：<pre><code>&lt;!-- Windows 10 --&gt;&#13;&#10;&lt;supportedOS Id=&quot;{8e0f7a12-bfb3-4fe8-b9a5-48fd50a15a9a}&quot; /&gt;&#13;&#10;</code></pre><strong>改善的朗讀程式支援</strong><ul><li>朗讀程式在播報 <xref:System.Windows.Forms.ToolStripMenuItem> 的文字時，現已會播報 <xref:System.Windows.Forms.ToolStripMenuItem.ShortcutKeys?displayProperty=nameWithType>屬性的值。</li><li>當 <xref:System.Windows.Forms.ToolStripMenuItem> 的 <xref:System.Windows.Forms.Control.Enabled> 屬性設定為 <code>false</code> 時，朗讀程式現在會指明該情況。</li><li>當 <xref:System.Windows.Forms.ListView.CheckBoxes?displayProperty=nameWithType> 屬性設定為 <code>true</code> 時，朗讀程式現已會提供核取方塊狀態的回應。</li><li>朗讀程式掃描模式的焦點順序，與 ClickOnce 下載對話視窗中所看見的控制項順序現已一致。</li></ul><strong>已改進 DataGridView 協助工具支援</strong><ul><li><xref:System.Windows.Forms.DataGridView> 中的資料列現已可使用鍵盤排序。 使用者現已可使用 F3 鍵，依目前的資料行排序。</li><li>當 <xref:System.Windows.Forms.DataGridView.SelectionMode?displayProperty=nameWithType> 設定為 <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> 時，資料行標頭會變更色彩，以在目前的資料列中指出使用者滑過儲存格時所在的資料行位置。</li><li><xref:System.Windows.Forms.DataGridViewCell.DataGridViewCellAccessibleObject.Parent?displayProperty=nameWithType> 屬性現已會傳回正確的父控制項。</li></ul><strong>已改進視覺提示</strong><ul><li><xref:System.Windows.Forms.ButtonBase.Text> 屬性為空白的控制項 <xref:System.Windows.Forms.RadioButton> 與 <xref:System.Windows.Forms.CheckBox>，現已會於接收到焦點時顯示焦點指標。</li></ul><strong>已改進屬性方格支援</strong><ul><li><xref:System.Windows.Forms.PropertyGrid> 控制項子項目現在只有在已啟用 PropertyGrid 項目的情況下，才會傳回 <xref:System.Windows.Automation.ValuePattern.IsReadOnlyProperty> 屬性的 <code>true</code>。</li><li><xref:System.Windows.Forms.PropertyGrid> 控制項子項目現在只有在使用者可變更 PropertyGrid 項目的情況下，才會傳回 <xref:System.Windows.Automation.AutomationElement.IsEnabledProperty> 屬性的 <code>false</code>。</li></ul>如需 UI 自動化的概觀，請參閱 [UI 自動化概觀](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview)。<strong>已改進鍵盤瀏覽</strong><ul><li><xref:System.Windows.Forms.ToolStripPanel.TabStop> 屬性設定為 <code>true</code> 的 <xref:System.Windows.Forms.ToolStripPanel>，內含有焦點時，<xref:System.Windows.Forms.ToolStripButton> 現已允許焦點</li></ul>|
|範圍|主要|
|版本|4.7.2|
|類型|正在重定目標|

