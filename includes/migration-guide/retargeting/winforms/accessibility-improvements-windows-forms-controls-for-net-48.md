---
ms.openlocfilehash: a9d2a28d85668cd8b6b2b7370e805ebf9c5b2843
ms.sourcegitcommit: d55e14eb63588830c0ba1ea95a24ce6c57ef8c8c
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2019
ms.locfileid: "67803527"
---
### <a name="accessibility-improvements-in-windows-forms-controls-for-net-48"></a>已改進 .NET 4.8 之 Windows Forms 控制項的協助工具

|   |   |
|---|---|
|詳細資料|Windows Forms Framework 利用協助工具技術，持續改善運作方式，可為 Windows Forms 客戶提供更良好的支援。 這些包括下列變更：<ul><li>改善高對比模式期間之顯示方式的變更。</li><li>對朗讀程式的互動進行了變更。</li><li>對可存取階層進行了變更 (改善 UI 自動化樹狀的瀏覽)。</li></ul>|
|建議|<strong>如何選擇使用或不使用這些變更</strong>為了讓應用程式能受益於這些變更，應用程式必須在 .NET Framework 4.8 上執行。 應用程式可以用下列任一種方式選擇使用這些變更：<ul><li>將其重新編譯為以 .NET Framework 4.8 為目標。 在以 .NET Framework 4.8 為目標的 Windows Forms 應用程式上，預設會啟用這些協助工具的變更。</li><li>其以 .NET Framework 4.7.2 或更早版本為目標，且藉由在應用程式組態檔的 <code>&lt;runtime&gt;</code> 區段中新增下列 [AppContext 參數](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element)，並設定為 <code>false</code>，選擇不使用舊版協助工具行為，如下範例所示。</li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false;Switch.UseLegacyAccessibilityFeatures.3=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre>請注意，選擇使用 .NET Framework 4.8 中新增的協助工具功能時，也必須選擇使用 .NET Framework 4.7.1 和 4.7.2 的協助工具功能。 以 .NET Framework 4.8 為目標，並且想要保留舊版協助工具行為的應用程式，可以藉由明確將此 AppContext 參數設為 <code>true</code>，選擇使用舊版的協助工具功能。如需啟用鍵盤工具提示引動過程支援，需要將 <code>Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false</code> 行新增至 AppContextSwitchOverrides 值：<pre><code class="lang-xml">&#39;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false;Switch.UseLegacyAccessibilityFeatures.3=false;Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false&quot; /&gt;&#39;&#13;&#10;</code></pre>請注意，啟用這項功能需要選擇使用上述 .NET Framework 4.7.1 - 4.8 的協助工具功能。 此外，如果未選擇使用任何協助工具，但選擇使用了工具提示顯示功能，則在第一次存取這些功能時將擲回執行階段 <xref:System.NotSupportedException>。 例外狀況訊息指出鍵盤工具提示需要啟用層級 3 的協助工具改善。<strong>在高對比佈景主題中使用 OS 定義的色彩</strong><ul><li>改善的高對比佈景主題。</li></ul><strong>改善的朗讀程式支援</strong><ul><li>朗讀程式現在會在宣布 <xref:System.Windows.Forms.DataGridViewCell> 的可存取名稱時，宣布 <xref:System.Windows.Forms.DataGridViewColumn> 的排序方向。</li></ul><strong>改善的 CheckedListBox 協助工具支援</strong><ul><li>已改善 <xref:System.Windows.Forms.CheckedListBox> 控制項的朗讀程式支援。 使用鍵盤瀏覽至 <xref:System.Windows.Forms.CheckedListBox> 控制項時，朗讀程式會專注於 <xref:System.Windows.Forms.CheckedListBox> 項目並宣布該項目。</li><li>當控制項變成焦點時，空白 CheckedListBox 控制項現在具有為虛擬第一個項目繪製的焦點矩形。</li></ul><strong>改善的 ComboBox 協助工具支援</strong><ul><li>已啟用 <xref:System.Windows.Forms.ComboBox> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</li></ul><strong>已改進 DataGridView 協助工具支援</strong><ul><li>已啟用 <xref:System.Windows.Forms.DataGridView> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</li><li>對應至 <xref:System.Windows.Forms.DataGridViewComboBoxEditingControl> 或 <xref:System.Windows.Forms.DataGridViewTextBoxEditingControl> 的 UI 自動化項目，現為對應編輯儲存格的子項目。</li></ul><strong>改善的 LinkLabel 協助工具支援</strong><ul><li>改善的 <xref:System.Windows.Forms.LinkLabel> 控制項協助工具：如果對應的 <xref:System.Windows.Forms.LinkLabel> 控制項已停用，朗讀程式會宣布停用的連結狀態。</li></ul><strong>改善的進度列協助工具支援</strong><ul><li>已啟用 <xref:System.Windows.Forms.ProgressBar> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。 開發人員現在可以使用 UI 自動化通知，朗讀程式可以透過這些通知顯示進度。</li></ul>如需 UI 自動化事件概觀 (包括 UI 自動化通知事件)，請參閱 [UI 自動化事件概觀](https://docs.microsoft.com/en-us/windows/desktop/WinAuto/uiauto-eventsoverview)。<strong>改善的 PropertyGrid 協助工具支援</strong><ul><li>已啟用 <xref:System.Windows.Forms.PropertyGrid> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</li><li>與當前已編輯屬性對應的 UI 自動化項目，現為對應屬性項目 UI 自動化項目的子項目。</li><li>如果父 <xref:System.Windows.Forms.PropertyGrid> 控制項設為類別檢視，則 UI 自動化屬性項目項目現為對應類別項目的子項目。</li></ul><strong>改善的 ToolStrip 支援</strong><ul><li>已啟用 <xref:System.Windows.Forms.ToolStrip> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</li><li>已改善 <xref:System.Windows.Forms.ToolStrip> 項目的瀏覽。</li><li>在項目模式中，朗讀程式的焦點未消失，且不會前往隱藏的項目。</li></ul><strong>已改進視覺提示</strong><ul><li>空白 <xref:System.Windows.Forms.CheckedListBox> 控制項現會在收到焦點時顯示焦點指標。</li></ul>注意:UI 自動化支援會在執行階段為控制項啟用，但不會在設計階段使用。 如需 UI 自動化的概觀，請參閱 [UI 自動化概觀](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview)。</p><strong>使用鍵盤叫用控制項的工具提示</strong><ul><li>現在可以把焦點放在使用鍵盤控制，叫用控制項工具提示。 這項功能必須針對應用程式明確啟用 (請參閱<strong>&quot;如何選擇使用或不使用這些變更&quot;</strong>章節)</li></ul>|
|範圍|主要|
|版本|4.8|
|類型|正在重定目標|

