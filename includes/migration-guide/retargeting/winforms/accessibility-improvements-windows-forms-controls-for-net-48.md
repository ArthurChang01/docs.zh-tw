---
ms.openlocfilehash: a9d2a28d85668cd8b6b2b7370e805ebf9c5b2843
ms.sourcegitcommit: d55e14eb63588830c0ba1ea95a24ce6c57ef8c8c
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/11/2019
ms.locfileid: "67803527"
---
### <a name="accessibility-improvements-in-windows-forms-controls-for-net-48"></a><span data-ttu-id="6bb67-101">已改進 .NET 4.8 之 Windows Forms 控制項的協助工具</span><span class="sxs-lookup"><span data-stu-id="6bb67-101">Accessibility improvements in Windows Forms controls for .NET 4.8</span></span>

|   |   |
|---|---|
|<span data-ttu-id="6bb67-102">詳細資料</span><span class="sxs-lookup"><span data-stu-id="6bb67-102">Details</span></span>|<span data-ttu-id="6bb67-103">Windows Forms Framework 利用協助工具技術，持續改善運作方式，可為 Windows Forms 客戶提供更良好的支援。</span><span class="sxs-lookup"><span data-stu-id="6bb67-103">The Windows Forms Framework is continuing to improve how it works with accessibility technologies to better support Windows Forms customers.</span></span> <span data-ttu-id="6bb67-104">這些包括下列變更：</span><span class="sxs-lookup"><span data-stu-id="6bb67-104">These include the following changes:</span></span><ul><li><span data-ttu-id="6bb67-105">改善高對比模式期間之顯示方式的變更。</span><span class="sxs-lookup"><span data-stu-id="6bb67-105">Changes to improve display during High Contrast mode.</span></span></li><li><span data-ttu-id="6bb67-106">對朗讀程式的互動進行了變更。</span><span class="sxs-lookup"><span data-stu-id="6bb67-106">Changes to interaction with Narrator.</span></span></li><li><span data-ttu-id="6bb67-107">對可存取階層進行了變更 (改善 UI 自動化樹狀的瀏覽)。</span><span class="sxs-lookup"><span data-stu-id="6bb67-107">Changes in the Accessible hierarchy (improving navigation through the UI Automation tree).</span></span></li></ul>|
|<span data-ttu-id="6bb67-108">建議</span><span class="sxs-lookup"><span data-stu-id="6bb67-108">Suggestion</span></span>|<span data-ttu-id="6bb67-109"><strong>如何選擇使用或不使用這些變更</strong>為了讓應用程式能受益於這些變更，應用程式必須在 .NET Framework 4.8 上執行。</span><span class="sxs-lookup"><span data-stu-id="6bb67-109"><strong>How to opt in or out of these changes</strong>In order for the application to benefit from these changes, it must run on the .NET Framework 4.8.</span></span> <span data-ttu-id="6bb67-110">應用程式可以用下列任一種方式選擇使用這些變更：</span><span class="sxs-lookup"><span data-stu-id="6bb67-110">The application can opt in into these changes in either of the following ways:</span></span><ul><li><span data-ttu-id="6bb67-111">將其重新編譯為以 .NET Framework 4.8 為目標。</span><span class="sxs-lookup"><span data-stu-id="6bb67-111">It is recompiled to target the .NET Framework 4.8.</span></span> <span data-ttu-id="6bb67-112">在以 .NET Framework 4.8 為目標的 Windows Forms 應用程式上，預設會啟用這些協助工具的變更。</span><span class="sxs-lookup"><span data-stu-id="6bb67-112">These accessibility changes are enabled by default on Windows Forms applications that target the .NET Framework 4.8.</span></span></li><li><span data-ttu-id="6bb67-113">其以 .NET Framework 4.7.2 或更早版本為目標，且藉由在應用程式組態檔的 <code>&lt;runtime&gt;</code> 區段中新增下列 [AppContext 參數](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element)，並設定為 <code>false</code>，選擇不使用舊版協助工具行為，如下範例所示。</span><span class="sxs-lookup"><span data-stu-id="6bb67-113">It targets the .NET Framework 4.7.2 or earlier version and opts out of the legacy accessibility behaviors by adding the following [AppContext switch](https://docs.microsoft.com/dotnet/framework/configure-apps/file-schema/runtime/appcontextswitchoverrides-element) to the <code>&lt;runtime&gt;</code> section of the app config file and setting it to <code>false</code>, as the following example shows.</span></span></li></ul><pre><code class="lang-xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&#13;&#10;&lt;configuration&gt;&#13;&#10;&lt;startup&gt;&#13;&#10;&lt;supportedRuntime version=&quot;v4.0&quot; sku=&quot;.NETFramework,Version=v4.7&quot;/&gt;&#13;&#10;&lt;/startup&gt;&#13;&#10;&lt;runtime&gt;&#13;&#10;&lt;!-- AppContextSwitchOverrides value attribute is in the form of &#39;key1=true/false;key2=true/false  --&gt;&#13;&#10;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false;Switch.UseLegacyAccessibilityFeatures.3=false&quot; /&gt;&#13;&#10;&lt;/runtime&gt;&#13;&#10;&lt;/configuration&gt;&#13;&#10;</code></pre><span data-ttu-id="6bb67-114">請注意，選擇使用 .NET Framework 4.8 中新增的協助工具功能時，也必須選擇使用 .NET Framework 4.7.1 和 4.7.2 的協助工具功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-114">Note that to opt in to the accessibility features added in .NET Framework 4.8, you must also opt in to accessibility features of .NET Framework 4.7.1 and 4.7.2 as well.</span></span> <span data-ttu-id="6bb67-115">以 .NET Framework 4.8 為目標，並且想要保留舊版協助工具行為的應用程式，可以藉由明確將此 AppContext 參數設為 <code>true</code>，選擇使用舊版的協助工具功能。如需啟用鍵盤工具提示引動過程支援，需要將 <code>Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false</code> 行新增至 AppContextSwitchOverrides 值：</span><span class="sxs-lookup"><span data-stu-id="6bb67-115">Applications that target the .NET Framework 4.8 and want to preserve the legacy accessibility behavior can opt in to the use of legacy accessibility features by explicitly setting this AppContext switch to <code>true</code>.Enabling the keyboard ToolTip invocation support requires adding the <code>Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false</code> line to the AppContextSwitchOverrides value:</span></span><pre><code class="lang-xml">&#39;&lt;AppContextSwitchOverrides value=&quot;Switch.UseLegacyAccessibilityFeatures=false;Switch.UseLegacyAccessibilityFeatures.2=false;Switch.UseLegacyAccessibilityFeatures.3=false;Switch.System.Windows.Forms.UseLegacyToolTipDisplay=false&quot; /&gt;&#39;&#13;&#10;</code></pre><span data-ttu-id="6bb67-116">請注意，啟用這項功能需要選擇使用上述 .NET Framework 4.7.1 - 4.8 的協助工具功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-116">Note that enabling this feature requires opting in to the aforementioned accessibility features of .NET Framework 4.7.1 - 4.8.</span></span> <span data-ttu-id="6bb67-117">此外，如果未選擇使用任何協助工具，但選擇使用了工具提示顯示功能，則在第一次存取這些功能時將擲回執行階段 <xref:System.NotSupportedException>。</span><span class="sxs-lookup"><span data-stu-id="6bb67-117">Also, if any of the accessibility features are not opted in but the tooltip display feature is opted in, a runtime <xref:System.NotSupportedException> will be thrown on the first access to these features.</span></span> <span data-ttu-id="6bb67-118">例外狀況訊息指出鍵盤工具提示需要啟用層級 3 的協助工具改善。<strong>在高對比佈景主題中使用 OS 定義的色彩</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-118">The exception message indicates that keyboard ToolTips require accessibility improvements of level 3 to be enabled.<strong>Use of OS-defined colors in High Contrast themes</strong></span></span><ul><li><span data-ttu-id="6bb67-119">改善的高對比佈景主題。</span><span class="sxs-lookup"><span data-stu-id="6bb67-119">Improved high-contrast themes.</span></span></li></ul><span data-ttu-id="6bb67-120"><strong>改善的朗讀程式支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-120"><strong>Improved Narrator support</strong></span></span><ul><li><span data-ttu-id="6bb67-121">朗讀程式現在會在宣布 <xref:System.Windows.Forms.DataGridViewCell> 的可存取名稱時，宣布 <xref:System.Windows.Forms.DataGridViewColumn> 的排序方向。</span><span class="sxs-lookup"><span data-stu-id="6bb67-121">Narrator now announces the sort direction of the <xref:System.Windows.Forms.DataGridViewColumn> when announcing an accessible name of a <xref:System.Windows.Forms.DataGridViewCell>.</span></span></li></ul><span data-ttu-id="6bb67-122"><strong>改善的 CheckedListBox 協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-122"><strong>Improved CheckedListBox Accessibility support</strong></span></span><ul><li><span data-ttu-id="6bb67-123">已改善 <xref:System.Windows.Forms.CheckedListBox> 控制項的朗讀程式支援。</span><span class="sxs-lookup"><span data-stu-id="6bb67-123">Improved Narrator support for the <xref:System.Windows.Forms.CheckedListBox> control.</span></span> <span data-ttu-id="6bb67-124">使用鍵盤瀏覽至 <xref:System.Windows.Forms.CheckedListBox> 控制項時，朗讀程式會專注於 <xref:System.Windows.Forms.CheckedListBox> 項目並宣布該項目。</span><span class="sxs-lookup"><span data-stu-id="6bb67-124">When navigating to the <xref:System.Windows.Forms.CheckedListBox> control using the keyboard, Narrator focuses the <xref:System.Windows.Forms.CheckedListBox> item and announces it.</span></span></li><li><span data-ttu-id="6bb67-125">當控制項變成焦點時，空白 CheckedListBox 控制項現在具有為虛擬第一個項目繪製的焦點矩形。</span><span class="sxs-lookup"><span data-stu-id="6bb67-125">An empty CheckedListBox control now has a focus rectangle drawn for a virtual first item when the control becomes focused.</span></span></li></ul><span data-ttu-id="6bb67-126"><strong>改善的 ComboBox 協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-126"><strong>Improved ComboBox Accessibility support</strong></span></span><ul><li><span data-ttu-id="6bb67-127">已啟用 <xref:System.Windows.Forms.ComboBox> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-127">Enabled UI Automation support for the <xref:System.Windows.Forms.ComboBox> control, with the ability to use UI Automation notifications and other UI Automation features.</span></span></li></ul><span data-ttu-id="6bb67-128"><strong>已改進 DataGridView 協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-128"><strong>Improved DataGridView Accessibility support</strong></span></span><ul><li><span data-ttu-id="6bb67-129">已啟用 <xref:System.Windows.Forms.DataGridView> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-129">Enabled UI Automation support for <xref:System.Windows.Forms.DataGridView> control with ability to use UI Automation notifications and other UI Automation features.</span></span></li><li><span data-ttu-id="6bb67-130">對應至 <xref:System.Windows.Forms.DataGridViewComboBoxEditingControl> 或 <xref:System.Windows.Forms.DataGridViewTextBoxEditingControl> 的 UI 自動化項目，現為對應編輯儲存格的子項目。</span><span class="sxs-lookup"><span data-stu-id="6bb67-130">The UI Automation element which corresponds to the <xref:System.Windows.Forms.DataGridViewComboBoxEditingControl> or <xref:System.Windows.Forms.DataGridViewTextBoxEditingControl> is now a child of corresponding editing cell.</span></span></li></ul><span data-ttu-id="6bb67-131"><strong>改善的 LinkLabel 協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-131"><strong>Improved LinkLabel Accessibility support</strong></span></span><ul><li><span data-ttu-id="6bb67-132">改善的 <xref:System.Windows.Forms.LinkLabel> 控制項協助工具：如果對應的 <xref:System.Windows.Forms.LinkLabel> 控制項已停用，朗讀程式會宣布停用的連結狀態。</span><span class="sxs-lookup"><span data-stu-id="6bb67-132">Improved <xref:System.Windows.Forms.LinkLabel> control accessibility: Narrator announces the disabled state for the link if the corresponding <xref:System.Windows.Forms.LinkLabel> control is disabled.</span></span></li></ul><span data-ttu-id="6bb67-133"><strong>改善的進度列協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-133"><strong>Improved ProgressBar Accessibility support</strong></span></span><ul><li><span data-ttu-id="6bb67-134">已啟用 <xref:System.Windows.Forms.ProgressBar> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-134">Enabled UI Automation support for the <xref:System.Windows.Forms.ProgressBar> control with the ability to use UI Automation notifications and other UI Automation features.</span></span> <span data-ttu-id="6bb67-135">開發人員現在可以使用 UI 自動化通知，朗讀程式可以透過這些通知顯示進度。</span><span class="sxs-lookup"><span data-stu-id="6bb67-135">Developers are now able to use UI Automation notifications which Narrator can announce to indicate progress.</span></span></li></ul><span data-ttu-id="6bb67-136">如需 UI 自動化事件概觀 (包括 UI 自動化通知事件)，請參閱 [UI 自動化事件概觀](https://docs.microsoft.com/en-us/windows/desktop/WinAuto/uiauto-eventsoverview)。<strong>改善的 PropertyGrid 協助工具支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-136">For an overview of UI automation events overview, including UI automation notification events, see the [UI Automation Events Overview](https://docs.microsoft.com/en-us/windows/desktop/WinAuto/uiauto-eventsoverview).<strong>Improved PropertyGrid Accessibility support</strong></span></span><ul><li><span data-ttu-id="6bb67-137">已啟用 <xref:System.Windows.Forms.PropertyGrid> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-137">Enabled UI Automation support for the <xref:System.Windows.Forms.PropertyGrid> control, with the ability to use UI Automation notifications and other UI Automation features.</span></span></li><li><span data-ttu-id="6bb67-138">與當前已編輯屬性對應的 UI 自動化項目，現為對應屬性項目 UI 自動化項目的子項目。</span><span class="sxs-lookup"><span data-stu-id="6bb67-138">The UI Automation element which corresponds to the currently edited property is now a child of the corresponding property item UI Automation element.</span></span></li><li><span data-ttu-id="6bb67-139">如果父 <xref:System.Windows.Forms.PropertyGrid> 控制項設為類別檢視，則 UI 自動化屬性項目項目現為對應類別項目的子項目。</span><span class="sxs-lookup"><span data-stu-id="6bb67-139">The UI Automation property item element is now a child of the corresponding category element if the parent <xref:System.Windows.Forms.PropertyGrid> control is set to category view.</span></span></li></ul><span data-ttu-id="6bb67-140"><strong>改善的 ToolStrip 支援</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-140"><strong>Improved ToolStrip support</strong></span></span><ul><li><span data-ttu-id="6bb67-141">已啟用 <xref:System.Windows.Forms.ToolStrip> 控制項的 UI 自動化支援，並可使用 UI 自動化通知和其他 UI 自動化功能。</span><span class="sxs-lookup"><span data-stu-id="6bb67-141">Enabled UI Automation support for the <xref:System.Windows.Forms.ToolStrip> control, with the ability to use UI Automation notifications and other UI Automation features.</span></span></li><li><span data-ttu-id="6bb67-142">已改善 <xref:System.Windows.Forms.ToolStrip> 項目的瀏覽。</span><span class="sxs-lookup"><span data-stu-id="6bb67-142">Improved navigation through <xref:System.Windows.Forms.ToolStrip> items.</span></span></li><li><span data-ttu-id="6bb67-143">在項目模式中，朗讀程式的焦點未消失，且不會前往隱藏的項目。</span><span class="sxs-lookup"><span data-stu-id="6bb67-143">In items mode, Narrator focus does not disappear and does not go to hidden items.</span></span></li></ul><span data-ttu-id="6bb67-144"><strong>已改進視覺提示</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-144"><strong>Improved Visual cues</strong></span></span><ul><li><span data-ttu-id="6bb67-145">空白 <xref:System.Windows.Forms.CheckedListBox> 控制項現會在收到焦點時顯示焦點指標。</span><span class="sxs-lookup"><span data-stu-id="6bb67-145">An empty <xref:System.Windows.Forms.CheckedListBox> control now displays a focus indicator when it receives focus.</span></span></li></ul><span data-ttu-id="6bb67-146">注意:UI 自動化支援會在執行階段為控制項啟用，但不會在設計階段使用。</span><span class="sxs-lookup"><span data-stu-id="6bb67-146">Note: UI automation support is enabled for controls in runtime but is not used in design time.</span></span> <span data-ttu-id="6bb67-147">如需 UI 自動化的概觀，請參閱 [UI 自動化概觀](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview)。</span><span class="sxs-lookup"><span data-stu-id="6bb67-147">For an overview of UI automation, see the [UI Automation Overview](https://docs.microsoft.com/dotnet/framework/ui-automation/ui-automation-overview).</span></span></p><span data-ttu-id="6bb67-148"><strong>使用鍵盤叫用控制項的工具提示</strong></span><span class="sxs-lookup"><span data-stu-id="6bb67-148"><strong>Invoking controls' ToolTips with a keyboard</strong></span></span><ul><li><span data-ttu-id="6bb67-149">現在可以把焦點放在使用鍵盤控制，叫用控制項工具提示。</span><span class="sxs-lookup"><span data-stu-id="6bb67-149">Control tooltip can now be invoked by focusing the control with keyboard.</span></span> <span data-ttu-id="6bb67-150">這項功能必須針對應用程式明確啟用 (請參閱<strong>&quot;如何選擇使用或不使用這些變更&quot;</strong>章節)</span><span class="sxs-lookup"><span data-stu-id="6bb67-150">This feature needs to be enabled explicitly for the application (see section <strong>&quot;How to opt in or out of these changes&quot;</strong>)</span></span></li></ul>|
|<span data-ttu-id="6bb67-151">範圍</span><span class="sxs-lookup"><span data-stu-id="6bb67-151">Scope</span></span>|<span data-ttu-id="6bb67-152">主要</span><span class="sxs-lookup"><span data-stu-id="6bb67-152">Major</span></span>|
|<span data-ttu-id="6bb67-153">版本</span><span class="sxs-lookup"><span data-stu-id="6bb67-153">Version</span></span>|<span data-ttu-id="6bb67-154">4.8</span><span class="sxs-lookup"><span data-stu-id="6bb67-154">4.8</span></span>|
|<span data-ttu-id="6bb67-155">類型</span><span class="sxs-lookup"><span data-stu-id="6bb67-155">Type</span></span>|<span data-ttu-id="6bb67-156">正在重定目標</span><span class="sxs-lookup"><span data-stu-id="6bb67-156">Retargeting</span></span>|

