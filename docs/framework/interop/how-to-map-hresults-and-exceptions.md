---
title: 作法：對應 HRESULT 和例外狀況
ms.date: 03/30/2017
dev_langs:
- cpp
helpviewer_keywords:
- interoperation with unmanaged code, HRESULTs
- exceptions, HRESULTs
- interoperation with unmanaged code, exceptions
- HRESULTs
- COM interop, HRESULTs
- COM interop, exceptions
ms.assetid: 610b364b-2761-429d-9c4a-afbc3e66f1b9
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 60173739842835a705a72da4e7ab442cacfc08d2
ms.sourcegitcommit: 558d78d2a68acd4c95ef23231c8b4e4c7bac3902
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/09/2019
ms.locfileid: "59306543"
---
# <a name="how-to-map-hresults-and-exceptions"></a><span data-ttu-id="9f896-102">作法：對應 HRESULT 和例外狀況</span><span class="sxs-lookup"><span data-stu-id="9f896-102">How to: Map HRESULTs and Exceptions</span></span>
<span data-ttu-id="9f896-103">COM 方法是藉由傳回 HRESULT 來報告錯誤；.NET 方法則是藉由擲回例外狀況來報告錯誤。</span><span class="sxs-lookup"><span data-stu-id="9f896-103">COM methods report errors by returning HRESULTs; .NET methods report them by throwing exceptions.</span></span> <span data-ttu-id="9f896-104">執行階段則負責處理兩者之間的轉換。</span><span class="sxs-lookup"><span data-stu-id="9f896-104">The runtime handles the transition between the two.</span></span> <span data-ttu-id="9f896-105">.NET Framework 的每一個例外狀況類別都會對應到一個 HRESULT。</span><span class="sxs-lookup"><span data-stu-id="9f896-105">Each exception class in the .NET Framework maps to an HRESULT.</span></span>  
  
 <span data-ttu-id="9f896-106">使用者定義的例外狀況類別可以指定任何適當的 HRESULT。</span><span class="sxs-lookup"><span data-stu-id="9f896-106">User-defined exception classes can specify whatever HRESULT is appropriate.</span></span> <span data-ttu-id="9f896-107">當例外狀況是藉由設定例外狀況物件上的 **HResult** 欄位而產生時，這些例外狀況類別可以動態地變更要傳回的 HRESULT。</span><span class="sxs-lookup"><span data-stu-id="9f896-107">These exception classes can dynamically change the HRESULT to be returned when the exception is generated by setting the **HResult** field on the exception object.</span></span> <span data-ttu-id="9f896-108">例外狀況的其他資訊會透過 **IErrorInfo** 介面提供給用戶端，而該介面是實作於 Unmanaged 處理序中的 .NET 物件上。</span><span class="sxs-lookup"><span data-stu-id="9f896-108">Additional information about the exception is provided to the client through the **IErrorInfo** interface, which is implemented on the .NET object in the unmanaged process.</span></span>  
  
 <span data-ttu-id="9f896-109">如果您建立了擴充 **System.Exception** 的類別，則必須在建構期間設定 HRESULT 欄位。</span><span class="sxs-lookup"><span data-stu-id="9f896-109">If you create a class that extends **System.Exception**, you must set the HRESULT field during construction.</span></span> <span data-ttu-id="9f896-110">否則，基底類別會指派 HRESULT 值。</span><span class="sxs-lookup"><span data-stu-id="9f896-110">Otherwise, the base class assigns the HRESULT value.</span></span> <span data-ttu-id="9f896-111">您可以在例外狀況的建構函式中提供值，將新的例外狀況類別對應到現有的 HRESULT。</span><span class="sxs-lookup"><span data-stu-id="9f896-111">You can map new exception classes to an existing HRESULT by supplying the value in the exception's constructor.</span></span>  
  
 <span data-ttu-id="9f896-112">請注意，執行階段有時候會忽略 `HRESULT`，以應付萬一執行緒上存在 `IErrorInfo` 的情況。</span><span class="sxs-lookup"><span data-stu-id="9f896-112">Note that the runtime will sometimes ignore an `HRESULT` in cases where there is an `IErrorInfo` present on the thread.</span></span>  <span data-ttu-id="9f896-113">如果 `HRESULT` 和 `IErrorInfo` 並不代表相同的錯誤，就可能會發生這種行為。</span><span class="sxs-lookup"><span data-stu-id="9f896-113">This behavior can occur in cases where the `HRESULT` and the `IErrorInfo` do not represent the same error.</span></span>  
  
### <a name="to-create-a-new-exception-class-and-map-it-to-an-hresult"></a><span data-ttu-id="9f896-114">建立新的例外狀況類別並將其對應到 HRESULT</span><span class="sxs-lookup"><span data-stu-id="9f896-114">To create a new exception class and map it to an HRESULT</span></span>  
  
1. <span data-ttu-id="9f896-115">使用下列程式碼來建立稱為 `NoAccessException` 的新例外狀況類別，並將其對應到 HRESULT `E_ACCESSDENIED`。</span><span class="sxs-lookup"><span data-stu-id="9f896-115">Use the following code to create a new exception class called `NoAccessException` and map it to the HRESULT `E_ACCESSDENIED`.</span></span>  
  
    ```cpp  
    Class NoAccessException : public ApplicationException  
    {  
        NoAccessException () {  
        HResult = E_ACCESSDENIED;   
    }  
    }  
    CMyClass::MethodThatThrows  
    {  
    throw new NoAccessException();  
    }  
    ```  
  
 <span data-ttu-id="9f896-116">您也許會遇到同時使用 Managed 和 Unmanaged 程式碼的程式 (以任何程式語言所撰寫)。</span><span class="sxs-lookup"><span data-stu-id="9f896-116">You might encounter a program (in any programming language) that uses both managed and unmanaged code at the same time.</span></span> <span data-ttu-id="9f896-117">例如，下列程式碼範例中的自訂封送處理器是使用 **Marshal.ThrowExceptionForHR(int HResult)** 方法來擲回具有特定 HRESULT 值的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="9f896-117">For example, the custom marshaler in the following code example uses the **Marshal.ThrowExceptionForHR(int HResult)** method to throw an exception with a specific HRESULT value.</span></span> <span data-ttu-id="9f896-118">此方法會查詢 HRESULT 並產生適當的例外狀況,類型。</span><span class="sxs-lookup"><span data-stu-id="9f896-118">The method looks up the HRESULT and generates the appropriate exception type.</span></span> <span data-ttu-id="9f896-119">例如，下列程式碼片段中的 HRESULT 會產生 **ArgumentException**。</span><span class="sxs-lookup"><span data-stu-id="9f896-119">For example, the HRESULT in the following code fragment generates **ArgumentException**.</span></span>  
  
```cpp  
CMyClass::MethodThatThrows  
{  
    Marshal.ThrowExceptionForHR(COR_E_ARGUMENT);  
}  
```  
  
 <span data-ttu-id="9f896-120">下表提供每一個 HRESULT 與其在 .NET Framework 中可比較之例外狀況類別的完整對應。</span><span class="sxs-lookup"><span data-stu-id="9f896-120">The following table provides the complete mapping from each HRESULT to its comparable exception class in the .NET Framework.</span></span>  
  
|<span data-ttu-id="9f896-121">HRESULT</span><span class="sxs-lookup"><span data-stu-id="9f896-121">HRESULT</span></span>|<span data-ttu-id="9f896-122">.NET 例外狀況</span><span class="sxs-lookup"><span data-stu-id="9f896-122">.NET exception</span></span>|  
|-------------|--------------------|  
|**<span data-ttu-id="9f896-123">MSEE_E_APPDOMAINUNLOADED</span><span class="sxs-lookup"><span data-stu-id="9f896-123">MSEE_E_APPDOMAINUNLOADED</span></span>**|**<span data-ttu-id="9f896-124">AppDomainUnloadedException</span><span class="sxs-lookup"><span data-stu-id="9f896-124">AppDomainUnloadedException</span></span>**|  
|**<span data-ttu-id="9f896-125">COR_E_APPLICATION</span><span class="sxs-lookup"><span data-stu-id="9f896-125">COR_E_APPLICATION</span></span>**|**<span data-ttu-id="9f896-126">ApplicationException</span><span class="sxs-lookup"><span data-stu-id="9f896-126">ApplicationException</span></span>**|  
|**<span data-ttu-id="9f896-127">COR_E_ARGUMENT 或 E_INVALIDARG</span><span class="sxs-lookup"><span data-stu-id="9f896-127">COR_E_ARGUMENT or E_INVALIDARG</span></span>**|**<span data-ttu-id="9f896-128">ArgumentException</span><span class="sxs-lookup"><span data-stu-id="9f896-128">ArgumentException</span></span>**|  
|**<span data-ttu-id="9f896-129">COR_E_ARGUMENTOUTOFRANGE</span><span class="sxs-lookup"><span data-stu-id="9f896-129">COR_E_ARGUMENTOUTOFRANGE</span></span>**|**<span data-ttu-id="9f896-130">ArgumentOutOfRangeException</span><span class="sxs-lookup"><span data-stu-id="9f896-130">ArgumentOutOfRangeException</span></span>**|  
|**<span data-ttu-id="9f896-131">COR_E_ARITHMETIC 或 ERROR_ARITHMETIC_OVERFLOW</span><span class="sxs-lookup"><span data-stu-id="9f896-131">COR_E_ARITHMETIC or ERROR_ARITHMETIC_OVERFLOW</span></span>**|**<span data-ttu-id="9f896-132">ArithmeticException</span><span class="sxs-lookup"><span data-stu-id="9f896-132">ArithmeticException</span></span>**|  
|**<span data-ttu-id="9f896-133">COR_E_ARRAYTYPEMISMATCH</span><span class="sxs-lookup"><span data-stu-id="9f896-133">COR_E_ARRAYTYPEMISMATCH</span></span>**|**<span data-ttu-id="9f896-134">ArrayTypeMismatchException</span><span class="sxs-lookup"><span data-stu-id="9f896-134">ArrayTypeMismatchException</span></span>**|  
|**<span data-ttu-id="9f896-135">COR_E_BADIMAGEFORMAT 或 ERROR_BAD_FORMAT</span><span class="sxs-lookup"><span data-stu-id="9f896-135">COR_E_BADIMAGEFORMAT or ERROR_BAD_FORMAT</span></span>**|**<span data-ttu-id="9f896-136">BadImageFormatException</span><span class="sxs-lookup"><span data-stu-id="9f896-136">BadImageFormatException</span></span>**|  
|**<span data-ttu-id="9f896-137">COR_E_COMEMULATE_ERROR</span><span class="sxs-lookup"><span data-stu-id="9f896-137">COR_E_COMEMULATE_ERROR</span></span>**|**<span data-ttu-id="9f896-138">COMEmulateException</span><span class="sxs-lookup"><span data-stu-id="9f896-138">COMEmulateException</span></span>**|  
|**<span data-ttu-id="9f896-139">COR_E_CONTEXTMARSHAL</span><span class="sxs-lookup"><span data-stu-id="9f896-139">COR_E_CONTEXTMARSHAL</span></span>**|**<span data-ttu-id="9f896-140">ContextMarshalException</span><span class="sxs-lookup"><span data-stu-id="9f896-140">ContextMarshalException</span></span>**|  
|**<span data-ttu-id="9f896-141">COR_E_CORE</span><span class="sxs-lookup"><span data-stu-id="9f896-141">COR_E_CORE</span></span>**|**<span data-ttu-id="9f896-142">CoreException</span><span class="sxs-lookup"><span data-stu-id="9f896-142">CoreException</span></span>**|  
|**<span data-ttu-id="9f896-143">NTE_FAIL</span><span class="sxs-lookup"><span data-stu-id="9f896-143">NTE_FAIL</span></span>**|**<span data-ttu-id="9f896-144">CryptographicException</span><span class="sxs-lookup"><span data-stu-id="9f896-144">CryptographicException</span></span>**|  
|**<span data-ttu-id="9f896-145">COR_E_DIRECTORYNOTFOUND 或 ERROR_PATH_NOT_FOUND</span><span class="sxs-lookup"><span data-stu-id="9f896-145">COR_E_DIRECTORYNOTFOUND or ERROR_PATH_NOT_FOUND</span></span>**|**<span data-ttu-id="9f896-146">DirectoryNotFoundException</span><span class="sxs-lookup"><span data-stu-id="9f896-146">DirectoryNotFoundException</span></span>**|  
|**<span data-ttu-id="9f896-147">COR_E_DIVIDEBYZERO</span><span class="sxs-lookup"><span data-stu-id="9f896-147">COR_E_DIVIDEBYZERO</span></span>**|**<span data-ttu-id="9f896-148">DivideByZeroException</span><span class="sxs-lookup"><span data-stu-id="9f896-148">DivideByZeroException</span></span>**|  
|**<span data-ttu-id="9f896-149">COR_E_DUPLICATEWAITOBJECT</span><span class="sxs-lookup"><span data-stu-id="9f896-149">COR_E_DUPLICATEWAITOBJECT</span></span>**|**<span data-ttu-id="9f896-150">DuplicateWaitObjectException</span><span class="sxs-lookup"><span data-stu-id="9f896-150">DuplicateWaitObjectException</span></span>**|  
|**<span data-ttu-id="9f896-151">COR_E_ENDOFSTREAM</span><span class="sxs-lookup"><span data-stu-id="9f896-151">COR_E_ENDOFSTREAM</span></span>**|**<span data-ttu-id="9f896-152">EndOfStreamException</span><span class="sxs-lookup"><span data-stu-id="9f896-152">EndOfStreamException</span></span>**|  
|**<span data-ttu-id="9f896-153">COR_E_TYPELOAD</span><span class="sxs-lookup"><span data-stu-id="9f896-153">COR_E_TYPELOAD</span></span>**|**<span data-ttu-id="9f896-154">EntryPointNotFoundException</span><span class="sxs-lookup"><span data-stu-id="9f896-154">EntryPointNotFoundException</span></span>**|  
|**<span data-ttu-id="9f896-155">COR_E_EXCEPTION</span><span class="sxs-lookup"><span data-stu-id="9f896-155">COR_E_EXCEPTION</span></span>**|**<span data-ttu-id="9f896-156">例外</span><span class="sxs-lookup"><span data-stu-id="9f896-156">Exception</span></span>**|  
|**<span data-ttu-id="9f896-157">COR_E_EXECUTIONENGINE</span><span class="sxs-lookup"><span data-stu-id="9f896-157">COR_E_EXECUTIONENGINE</span></span>**|**<span data-ttu-id="9f896-158">ExecutionEngineException</span><span class="sxs-lookup"><span data-stu-id="9f896-158">ExecutionEngineException</span></span>**|  
|**<span data-ttu-id="9f896-159">COR_E_FIELDACCESS</span><span class="sxs-lookup"><span data-stu-id="9f896-159">COR_E_FIELDACCESS</span></span>**|**<span data-ttu-id="9f896-160">FieldAccessException</span><span class="sxs-lookup"><span data-stu-id="9f896-160">FieldAccessException</span></span>**|  
|**<span data-ttu-id="9f896-161">COR_E_FILENOTFOUND 或 ERROR_FILE_NOT_FOUND</span><span class="sxs-lookup"><span data-stu-id="9f896-161">COR_E_FILENOTFOUND or ERROR_FILE_NOT_FOUND</span></span>**|**<span data-ttu-id="9f896-162">FileNotFoundException</span><span class="sxs-lookup"><span data-stu-id="9f896-162">FileNotFoundException</span></span>**|  
|**<span data-ttu-id="9f896-163">COR_E_FORMAT</span><span class="sxs-lookup"><span data-stu-id="9f896-163">COR_E_FORMAT</span></span>**|**<span data-ttu-id="9f896-164">FormatException</span><span class="sxs-lookup"><span data-stu-id="9f896-164">FormatException</span></span>**|  
|**<span data-ttu-id="9f896-165">COR_E_INDEXOUTOFRANGE</span><span class="sxs-lookup"><span data-stu-id="9f896-165">COR_E_INDEXOUTOFRANGE</span></span>**|**<span data-ttu-id="9f896-166">IndexOutOfRangeException</span><span class="sxs-lookup"><span data-stu-id="9f896-166">IndexOutOfRangeException</span></span>**|  
|**<span data-ttu-id="9f896-167">COR_E_INVALIDCAST 或 E_NOINTERFACE</span><span class="sxs-lookup"><span data-stu-id="9f896-167">COR_E_INVALIDCAST or E_NOINTERFACE</span></span>**|**<span data-ttu-id="9f896-168">InvalidCastException</span><span class="sxs-lookup"><span data-stu-id="9f896-168">InvalidCastException</span></span>**|  
|**<span data-ttu-id="9f896-169">COR_E_INVALIDCOMOBJECT</span><span class="sxs-lookup"><span data-stu-id="9f896-169">COR_E_INVALIDCOMOBJECT</span></span>**|**<span data-ttu-id="9f896-170">InvalidComObjectException</span><span class="sxs-lookup"><span data-stu-id="9f896-170">InvalidComObjectException</span></span>**|  
|**<span data-ttu-id="9f896-171">COR_E_INVALIDFILTERCRITERIA</span><span class="sxs-lookup"><span data-stu-id="9f896-171">COR_E_INVALIDFILTERCRITERIA</span></span>**|**<span data-ttu-id="9f896-172">InvalidFilterCriteriaException</span><span class="sxs-lookup"><span data-stu-id="9f896-172">InvalidFilterCriteriaException</span></span>**|  
|**<span data-ttu-id="9f896-173">COR_E_INVALIDOLEVARIANTTYPE</span><span class="sxs-lookup"><span data-stu-id="9f896-173">COR_E_INVALIDOLEVARIANTTYPE</span></span>**|**<span data-ttu-id="9f896-174">InvalidOleVariantTypeException</span><span class="sxs-lookup"><span data-stu-id="9f896-174">InvalidOleVariantTypeException</span></span>**|  
|**<span data-ttu-id="9f896-175">COR_E_INVALIDOPERATION</span><span class="sxs-lookup"><span data-stu-id="9f896-175">COR_E_INVALIDOPERATION</span></span>**|**<span data-ttu-id="9f896-176">InvalidOperationException</span><span class="sxs-lookup"><span data-stu-id="9f896-176">InvalidOperationException</span></span>**|  
|**<span data-ttu-id="9f896-177">COR_E_IO</span><span class="sxs-lookup"><span data-stu-id="9f896-177">COR_E_IO</span></span>**|**<span data-ttu-id="9f896-178">IOException</span><span class="sxs-lookup"><span data-stu-id="9f896-178">IOException</span></span>**|  
|**<span data-ttu-id="9f896-179">COR_E_MEMBERACCESS</span><span class="sxs-lookup"><span data-stu-id="9f896-179">COR_E_MEMBERACCESS</span></span>**|**<span data-ttu-id="9f896-180">AccessException</span><span class="sxs-lookup"><span data-stu-id="9f896-180">AccessException</span></span>**|  
|**<span data-ttu-id="9f896-181">COR_E_METHODACCESS</span><span class="sxs-lookup"><span data-stu-id="9f896-181">COR_E_METHODACCESS</span></span>**|**<span data-ttu-id="9f896-182">MethodAccessException</span><span class="sxs-lookup"><span data-stu-id="9f896-182">MethodAccessException</span></span>**|  
|**<span data-ttu-id="9f896-183">COR_E_MISSINGFIELD</span><span class="sxs-lookup"><span data-stu-id="9f896-183">COR_E_MISSINGFIELD</span></span>**|**<span data-ttu-id="9f896-184">MissingFieldException</span><span class="sxs-lookup"><span data-stu-id="9f896-184">MissingFieldException</span></span>**|  
|**<span data-ttu-id="9f896-185">COR_E_MISSINGMANIFESTRESOURCE</span><span class="sxs-lookup"><span data-stu-id="9f896-185">COR_E_MISSINGMANIFESTRESOURCE</span></span>**|**<span data-ttu-id="9f896-186">MissingManifestResourceException</span><span class="sxs-lookup"><span data-stu-id="9f896-186">MissingManifestResourceException</span></span>**|  
|**<span data-ttu-id="9f896-187">COR_E_MISSINGMEMBER</span><span class="sxs-lookup"><span data-stu-id="9f896-187">COR_E_MISSINGMEMBER</span></span>**|**<span data-ttu-id="9f896-188">MissingMemberException</span><span class="sxs-lookup"><span data-stu-id="9f896-188">MissingMemberException</span></span>**|  
|**<span data-ttu-id="9f896-189">COR_E_MISSINGMETHOD</span><span class="sxs-lookup"><span data-stu-id="9f896-189">COR_E_MISSINGMETHOD</span></span>**|**<span data-ttu-id="9f896-190">MissingMethodException</span><span class="sxs-lookup"><span data-stu-id="9f896-190">MissingMethodException</span></span>**|  
|**<span data-ttu-id="9f896-191">COR_E_MULTICASTNOTSUPPORTED</span><span class="sxs-lookup"><span data-stu-id="9f896-191">COR_E_MULTICASTNOTSUPPORTED</span></span>**|**<span data-ttu-id="9f896-192">MulticastNotSupportedException</span><span class="sxs-lookup"><span data-stu-id="9f896-192">MulticastNotSupportedException</span></span>**|  
|**<span data-ttu-id="9f896-193">COR_E_NOTFINITENUMBER</span><span class="sxs-lookup"><span data-stu-id="9f896-193">COR_E_NOTFINITENUMBER</span></span>**|**<span data-ttu-id="9f896-194">NotFiniteNumberException</span><span class="sxs-lookup"><span data-stu-id="9f896-194">NotFiniteNumberException</span></span>**|  
|**<span data-ttu-id="9f896-195">E_NOTIMPL</span><span class="sxs-lookup"><span data-stu-id="9f896-195">E_NOTIMPL</span></span>**|**<span data-ttu-id="9f896-196">NotImplementedException</span><span class="sxs-lookup"><span data-stu-id="9f896-196">NotImplementedException</span></span>**|  
|**<span data-ttu-id="9f896-197">COR_E_NOTSUPPORTED</span><span class="sxs-lookup"><span data-stu-id="9f896-197">COR_E_NOTSUPPORTED</span></span>**|**<span data-ttu-id="9f896-198">NotSupportedException</span><span class="sxs-lookup"><span data-stu-id="9f896-198">NotSupportedException</span></span>**|  
|**<span data-ttu-id="9f896-199">COR_E_NULLREFERENCE 或 E_POINTER</span><span class="sxs-lookup"><span data-stu-id="9f896-199">COR_E_NULLREFERENCE orE_POINTER</span></span>**|**<span data-ttu-id="9f896-200">NullReferenceException</span><span class="sxs-lookup"><span data-stu-id="9f896-200">NullReferenceException</span></span>**|  
|**<span data-ttu-id="9f896-201">COR_E_OUTOFMEMORY 或</span><span class="sxs-lookup"><span data-stu-id="9f896-201">COR_E_OUTOFMEMORY or</span></span>**<br /><br /> **<span data-ttu-id="9f896-202">E_OUTOFMEMORY</span><span class="sxs-lookup"><span data-stu-id="9f896-202">E_OUTOFMEMORY</span></span>**|**<span data-ttu-id="9f896-203">OutOfMemoryException</span><span class="sxs-lookup"><span data-stu-id="9f896-203">OutOfMemoryException</span></span>**|  
|**<span data-ttu-id="9f896-204">COR_E_OVERFLOW</span><span class="sxs-lookup"><span data-stu-id="9f896-204">COR_E_OVERFLOW</span></span>**|**<span data-ttu-id="9f896-205">OverflowException</span><span class="sxs-lookup"><span data-stu-id="9f896-205">OverflowException</span></span>**|  
|**<span data-ttu-id="9f896-206">COR_E_PATHTOOLONG 或 ERROR_FILENAME_EXCED_RANGE</span><span class="sxs-lookup"><span data-stu-id="9f896-206">COR_E_PATHTOOLONG or ERROR_FILENAME_EXCED_RANGE</span></span>**|**<span data-ttu-id="9f896-207">PathTooLongException</span><span class="sxs-lookup"><span data-stu-id="9f896-207">PathTooLongException</span></span>**|  
|**<span data-ttu-id="9f896-208">COR_E_RANK</span><span class="sxs-lookup"><span data-stu-id="9f896-208">COR_E_RANK</span></span>**|**<span data-ttu-id="9f896-209">RankException</span><span class="sxs-lookup"><span data-stu-id="9f896-209">RankException</span></span>**|  
|**<span data-ttu-id="9f896-210">COR_E_REFLECTIONTYPELOAD</span><span class="sxs-lookup"><span data-stu-id="9f896-210">COR_E_REFLECTIONTYPELOAD</span></span>**|**<span data-ttu-id="9f896-211">ReflectionTypeLoadException</span><span class="sxs-lookup"><span data-stu-id="9f896-211">ReflectionTypeLoadException</span></span>**|  
|**<span data-ttu-id="9f896-212">COR_E_REMOTING</span><span class="sxs-lookup"><span data-stu-id="9f896-212">COR_E_REMOTING</span></span>**|**<span data-ttu-id="9f896-213">RemotingException</span><span class="sxs-lookup"><span data-stu-id="9f896-213">RemotingException</span></span>**|  
|**<span data-ttu-id="9f896-214">COR_E_SAFEARRAYTYPEMISMATCH</span><span class="sxs-lookup"><span data-stu-id="9f896-214">COR_E_SAFEARRAYTYPEMISMATCH</span></span>**|**<span data-ttu-id="9f896-215">SafeArrayTypeMismatchException</span><span class="sxs-lookup"><span data-stu-id="9f896-215">SafeArrayTypeMismatchException</span></span>**|  
|**<span data-ttu-id="9f896-216">COR_E_SECURITY</span><span class="sxs-lookup"><span data-stu-id="9f896-216">COR_E_SECURITY</span></span>**|**<span data-ttu-id="9f896-217">SecurityException</span><span class="sxs-lookup"><span data-stu-id="9f896-217">SecurityException</span></span>**|  
|**<span data-ttu-id="9f896-218">COR_E_SERIALIZATION</span><span class="sxs-lookup"><span data-stu-id="9f896-218">COR_E_SERIALIZATION</span></span>**|**<span data-ttu-id="9f896-219">SerializationException</span><span class="sxs-lookup"><span data-stu-id="9f896-219">SerializationException</span></span>**|  
|**<span data-ttu-id="9f896-220">COR_E_STACKOVERFLOW 或 ERROR_STACK_OVERFLOW</span><span class="sxs-lookup"><span data-stu-id="9f896-220">COR_E_STACKOVERFLOW orERROR_STACK_OVERFLOW</span></span>**|**<span data-ttu-id="9f896-221">StackOverflowException</span><span class="sxs-lookup"><span data-stu-id="9f896-221">StackOverflowException</span></span>**|  
|**<span data-ttu-id="9f896-222">COR_E_SYNCHRONIZATIONLOCK</span><span class="sxs-lookup"><span data-stu-id="9f896-222">COR_E_SYNCHRONIZATIONLOCK</span></span>**|**<span data-ttu-id="9f896-223">SynchronizationLockException</span><span class="sxs-lookup"><span data-stu-id="9f896-223">SynchronizationLockException</span></span>**|  
|**<span data-ttu-id="9f896-224">COR_E_SYSTEM</span><span class="sxs-lookup"><span data-stu-id="9f896-224">COR_E_SYSTEM</span></span>**|**<span data-ttu-id="9f896-225">SystemException</span><span class="sxs-lookup"><span data-stu-id="9f896-225">SystemException</span></span>**|  
|**<span data-ttu-id="9f896-226">COR_E_TARGET</span><span class="sxs-lookup"><span data-stu-id="9f896-226">COR_E_TARGET</span></span>**|**<span data-ttu-id="9f896-227">TargetException</span><span class="sxs-lookup"><span data-stu-id="9f896-227">TargetException</span></span>**|  
|**<span data-ttu-id="9f896-228">COR_E_TARGETINVOCATION</span><span class="sxs-lookup"><span data-stu-id="9f896-228">COR_E_TARGETINVOCATION</span></span>**|**<span data-ttu-id="9f896-229">TargetInvocationException</span><span class="sxs-lookup"><span data-stu-id="9f896-229">TargetInvocationException</span></span>**|  
|**<span data-ttu-id="9f896-230">COR_E_TARGETPARAMCOUNT</span><span class="sxs-lookup"><span data-stu-id="9f896-230">COR_E_TARGETPARAMCOUNT</span></span>**|**<span data-ttu-id="9f896-231">TargetParameterCountException</span><span class="sxs-lookup"><span data-stu-id="9f896-231">TargetParameterCountException</span></span>**|  
|**<span data-ttu-id="9f896-232">COR_E_THREADABORTED</span><span class="sxs-lookup"><span data-stu-id="9f896-232">COR_E_THREADABORTED</span></span>**|**<span data-ttu-id="9f896-233">ThreadAbortException</span><span class="sxs-lookup"><span data-stu-id="9f896-233">ThreadAbortException</span></span>**|  
|**<span data-ttu-id="9f896-234">COR_E_THREADINTERRUPTED</span><span class="sxs-lookup"><span data-stu-id="9f896-234">COR_E_THREADINTERRUPTED</span></span>**|**<span data-ttu-id="9f896-235">ThreadInterruptedException</span><span class="sxs-lookup"><span data-stu-id="9f896-235">ThreadInterruptedException</span></span>**|  
|**<span data-ttu-id="9f896-236">COR_E_THREADSTATE</span><span class="sxs-lookup"><span data-stu-id="9f896-236">COR_E_THREADSTATE</span></span>**|**<span data-ttu-id="9f896-237">ThreadStateException</span><span class="sxs-lookup"><span data-stu-id="9f896-237">ThreadStateException</span></span>**|  
|**<span data-ttu-id="9f896-238">COR_E_THREADSTOP</span><span class="sxs-lookup"><span data-stu-id="9f896-238">COR_E_THREADSTOP</span></span>**|**<span data-ttu-id="9f896-239">ThreadStopException</span><span class="sxs-lookup"><span data-stu-id="9f896-239">ThreadStopException</span></span>**|  
|**<span data-ttu-id="9f896-240">COR_E_TYPELOAD</span><span class="sxs-lookup"><span data-stu-id="9f896-240">COR_E_TYPELOAD</span></span>**|**<span data-ttu-id="9f896-241">TypeLoadException</span><span class="sxs-lookup"><span data-stu-id="9f896-241">TypeLoadException</span></span>**|  
|**<span data-ttu-id="9f896-242">COR_E_TYPEINITIALIZATION</span><span class="sxs-lookup"><span data-stu-id="9f896-242">COR_E_TYPEINITIALIZATION</span></span>**|**<span data-ttu-id="9f896-243">TypeInitializationException</span><span class="sxs-lookup"><span data-stu-id="9f896-243">TypeInitializationException</span></span>**|  
|**<span data-ttu-id="9f896-244">COR_E_VERIFICATION</span><span class="sxs-lookup"><span data-stu-id="9f896-244">COR_E_VERIFICATION</span></span>**|**<span data-ttu-id="9f896-245">VerificationException</span><span class="sxs-lookup"><span data-stu-id="9f896-245">VerificationException</span></span>**|  
|**<span data-ttu-id="9f896-246">COR_E_WEAKREFERENCE</span><span class="sxs-lookup"><span data-stu-id="9f896-246">COR_E_WEAKREFERENCE</span></span>**|**<span data-ttu-id="9f896-247">WeakReferenceException</span><span class="sxs-lookup"><span data-stu-id="9f896-247">WeakReferenceException</span></span>**|  
|**<span data-ttu-id="9f896-248">COR_E_VTABLECALLSNOTSUPPORTED</span><span class="sxs-lookup"><span data-stu-id="9f896-248">COR_E_VTABLECALLSNOTSUPPORTED</span></span>**|**<span data-ttu-id="9f896-249">VTableCallsNotSupportedException</span><span class="sxs-lookup"><span data-stu-id="9f896-249">VTableCallsNotSupportedException</span></span>**|  
|**<span data-ttu-id="9f896-250">所有其他的 HRESULT</span><span class="sxs-lookup"><span data-stu-id="9f896-250">All other HRESULTs</span></span>**|**<span data-ttu-id="9f896-251">COMException</span><span class="sxs-lookup"><span data-stu-id="9f896-251">COMException</span></span>**|  
  
 <span data-ttu-id="9f896-252">若要擷取擴充錯誤資訊，Managed 用戶端必須檢查所產生之例外狀況物件的欄位。</span><span class="sxs-lookup"><span data-stu-id="9f896-252">To retrieve extended error information, the managed client must examine the fields of the exception object that was generated.</span></span> <span data-ttu-id="9f896-253">若要讓例外狀況物件提供有關錯誤的有用資訊，COM 物件必須實作 **IErrorInfo** 介面。</span><span class="sxs-lookup"><span data-stu-id="9f896-253">For the exception object to provide useful information about an error, the COM object must implement the **IErrorInfo** interface.</span></span> <span data-ttu-id="9f896-254">執行階段會使用 **IErrorInfo** 提供的資訊來初始化例外狀況物件。</span><span class="sxs-lookup"><span data-stu-id="9f896-254">The runtime uses the information provided by **IErrorInfo** to initialize the exception object.</span></span>  
  
 <span data-ttu-id="9f896-255">如果 COM 物件不支援 **IErrorInfo**，執行階段會使用預設值來初始化例外狀況物件。</span><span class="sxs-lookup"><span data-stu-id="9f896-255">If the COM object does not support **IErrorInfo**, the runtime initializes an exception object with default values.</span></span> <span data-ttu-id="9f896-256">下表列出與例外狀況物件建立關聯的每一個欄位，並且指出當 COM 物件支援 **IErrorInfo** 時的預設資訊來源。</span><span class="sxs-lookup"><span data-stu-id="9f896-256">The following table lists each field associated with an exception object and identifies the source of default information when the COM object supports **IErrorInfo**.</span></span>  
  
 <span data-ttu-id="9f896-257">請注意，執行階段有時候會忽略 `HRESULT`，以應付萬一執行緒上存在 `IErrorInfo` 的情況。</span><span class="sxs-lookup"><span data-stu-id="9f896-257">Note that the runtime will sometimes ignore an `HRESULT` in cases where there is an `IErrorInfo` present on the thread.</span></span>  <span data-ttu-id="9f896-258">如果 `HRESULT` 和 `IErrorInfo` 並不代表相同的錯誤，就可能會發生這種行為。</span><span class="sxs-lookup"><span data-stu-id="9f896-258">This behavior can occur in cases where the `HRESULT` and the `IErrorInfo` do not represent the same error.</span></span>  
  
|<span data-ttu-id="9f896-259">例外狀況欄位</span><span class="sxs-lookup"><span data-stu-id="9f896-259">Exception field</span></span>|<span data-ttu-id="9f896-260">來自 COM 的資訊來源</span><span class="sxs-lookup"><span data-stu-id="9f896-260">Source of Information from COM</span></span>|  
|---------------------|------------------------------------|  
|**<span data-ttu-id="9f896-261">ErrorCode</span><span class="sxs-lookup"><span data-stu-id="9f896-261">ErrorCode</span></span>**|<span data-ttu-id="9f896-262">從呼叫傳回的 HRESULT。</span><span class="sxs-lookup"><span data-stu-id="9f896-262">HRESULT returned from call.</span></span>|  
|**<span data-ttu-id="9f896-263">HelpLink</span><span class="sxs-lookup"><span data-stu-id="9f896-263">HelpLink</span></span>**|<span data-ttu-id="9f896-264">如果 **IErrorInfo->HelpContext** 是非零值，則字串是由串連 **IErrorInfo->GetHelpFile**、"#" 和 **IErrorInfo->GetHelpContext** 所構成。</span><span class="sxs-lookup"><span data-stu-id="9f896-264">If **IErrorInfo->HelpContext** is nonzero, the string is formed by concatenating **IErrorInfo->GetHelpFile** and "#" and **IErrorInfo->GetHelpContext**.</span></span> <span data-ttu-id="9f896-265">否則，字串是從 **IErrorInfo->GetHelpFile** 所傳回。</span><span class="sxs-lookup"><span data-stu-id="9f896-265">Otherwise the string is returned from **IErrorInfo->GetHelpFile**.</span></span>|  
|**<span data-ttu-id="9f896-266">InnerException</span><span class="sxs-lookup"><span data-stu-id="9f896-266">InnerException</span></span>**|<span data-ttu-id="9f896-267">一律為 Null 參考 (在 Visual Basic 中為 **Nothing**)。</span><span class="sxs-lookup"><span data-stu-id="9f896-267">Always a null reference (**Nothing** in Visual Basic).</span></span>|  
|**<span data-ttu-id="9f896-268">訊息</span><span class="sxs-lookup"><span data-stu-id="9f896-268">Message</span></span>**|<span data-ttu-id="9f896-269">從 **IErrorInfo->GetDescription** 傳回的字串。</span><span class="sxs-lookup"><span data-stu-id="9f896-269">String returned from **IErrorInfo->GetDescription**.</span></span>|  
|**<span data-ttu-id="9f896-270">原始程式檔</span><span class="sxs-lookup"><span data-stu-id="9f896-270">Source</span></span>**|<span data-ttu-id="9f896-271">從 **IErrorInfo->GetSource** 傳回的字串。</span><span class="sxs-lookup"><span data-stu-id="9f896-271">String returned from **IErrorInfo->GetSource**.</span></span>|  
|**<span data-ttu-id="9f896-272">StackTrace</span><span class="sxs-lookup"><span data-stu-id="9f896-272">StackTrace</span></span>**|<span data-ttu-id="9f896-273">堆疊追蹤。</span><span class="sxs-lookup"><span data-stu-id="9f896-273">The stack trace.</span></span>|  
|**<span data-ttu-id="9f896-274">TargetSite</span><span class="sxs-lookup"><span data-stu-id="9f896-274">TargetSite</span></span>**|<span data-ttu-id="9f896-275">傳回失敗 HRESULT 之方法的名稱。</span><span class="sxs-lookup"><span data-stu-id="9f896-275">The name of the method that returned the failing HRESULT.</span></span>|  
  
 <span data-ttu-id="9f896-276">如 **Message**、**Source** 和 **StackTrace** 之類的例外狀況欄位，並不適用於 **StackOverflowException**。</span><span class="sxs-lookup"><span data-stu-id="9f896-276">Exception fields, such as **Message**, **Source**, and **StackTrace** are not available for the **StackOverflowException**.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9f896-277">另請參閱</span><span class="sxs-lookup"><span data-stu-id="9f896-277">See also</span></span>

- [<span data-ttu-id="9f896-278">進階 COM 互通性</span><span class="sxs-lookup"><span data-stu-id="9f896-278">Advanced COM Interoperability</span></span>](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/bd9cdfyx(v=vs.100))
- [<span data-ttu-id="9f896-279">例外狀況</span><span class="sxs-lookup"><span data-stu-id="9f896-279">Exceptions</span></span>](../../standard/exceptions/index.md)
