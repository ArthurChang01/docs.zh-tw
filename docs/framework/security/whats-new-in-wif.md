---
title: Windows Identity Foundation 4.5 的新功能
ms.date: 03/30/2017
ms.assetid: 3b381f04-593b-471f-bd33-0362be1aade5
author: BrucePerlerMS
manager: mbaldwin
ms.openlocfilehash: 2a275c32caefb54b11cc605c1339526465c8319a
ms.sourcegitcommit: 76a304c79a32aa13889ebcf4b9789a4542b48e3e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/13/2018
ms.locfileid: "45529286"
---
# <a name="what39s-new-in-windows-identity-foundation-45"></a><span data-ttu-id="4cd39-102">Windows Identity Foundation 4.5 的新功能</span><span class="sxs-lookup"><span data-stu-id="4cd39-102">What&#39;s New in Windows Identity Foundation 4.5</span></span>
<span data-ttu-id="4cd39-103">第一版的 Windows Identity Foundation (WIF) 是發行為獨立下載的版本，稱為 WIF 3.5，因為它是在 .NET 3.5 SP1 的期間內所引入的。</span><span class="sxs-lookup"><span data-stu-id="4cd39-103">The first version of Windows Identity Foundation (WIF) shipped as a standalone download and is known as WIF 3.5 because it was introduced in the .NET 3.5 SP1 timeframe.</span></span> <span data-ttu-id="4cd39-104">從 .NET 4.5 開始，WIF 就成為 .NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="4cd39-104">Starting with .NET 4.5, WIF is part of the .NET framework.</span></span> <span data-ttu-id="4cd39-105">在架構中直接提供 WIF 類別可讓 .NET 中的宣告式身分識別的整合更加深入，讓您更容易使用宣告。</span><span class="sxs-lookup"><span data-stu-id="4cd39-105">Having the WIF classes directly available in the framework allows for a much deeper integration of claims-based identity in .NET, making it easier to use claims.</span></span> <span data-ttu-id="4cd39-106">您需要修改為 WIF 3.5 所撰寫的應用程式，才能利用新的模型；如需詳細資訊，請參閱[將使用 WIF 3.5 建置的應用程式移轉至 WIF 4.5 的方針](../../../docs/framework/security/guidelines-for-migrating-an-application-built-using-wif-3-5-to-wif-4-5.md)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-106">Applications written for WIF 3.5 will need to be modified in order to take advantage of the new model; for information, see [Guidelines for Migrating an Application Built Using WIF 3.5 to WIF 4.5](../../../docs/framework/security/guidelines-for-migrating-an-application-built-using-wif-3-5-to-wif-4-5.md).</span></span>  
  
 <span data-ttu-id="4cd39-107">您可以在下文中找到一些主要變更重點。</span><span class="sxs-lookup"><span data-stu-id="4cd39-107">Below you can find some highlights of the main changes.</span></span>  
  
## <a name="wif-is-now-part-of-the-net-framework"></a><span data-ttu-id="4cd39-108">WIF 現在是 .NET Framework 的一部分</span><span class="sxs-lookup"><span data-stu-id="4cd39-108">WIF Is Now Part of the .NET Framework</span></span>  
 <span data-ttu-id="4cd39-109">WIF 類別現在散佈在數個組件，主要有 `mscorlib`、`System.IdentityModel`、`System.IdentityModel.Services` 和 `System.ServiceModel`。</span><span class="sxs-lookup"><span data-stu-id="4cd39-109">WIF classes are now spread across several assemblies, the main ones being `mscorlib`, `System.IdentityModel`, `System.IdentityModel.Services`, and `System.ServiceModel`.</span></span> <span data-ttu-id="4cd39-110">同樣地，WIF 類別也散佈在數個命名空間中：<xref:System.Security.Claims?displayProperty=nameWithType>、數個 [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) 命名空間以及 <xref:System.ServiceModel.Security?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="4cd39-110">Likewise, the WIF classes are spread across several namespaces: <xref:System.Security.Claims?displayProperty=nameWithType>, several [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) namespaces, and <xref:System.ServiceModel.Security?displayProperty=nameWithType>.</span></span> <span data-ttu-id="4cd39-111"><xref:System.Security.Claims?displayProperty=nameWithType> 命名空間包含新的 <xref:System.Security.Claims.ClaimsPrincipal> 和 <xref:System.Security.Claims.ClaimsIdentity> 類別 (請參閱下文)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-111">The <xref:System.Security.Claims?displayProperty=nameWithType> namespace contains the new <xref:System.Security.Claims.ClaimsPrincipal> and <xref:System.Security.Claims.ClaimsIdentity> classes (see below).</span></span> <span data-ttu-id="4cd39-112">.NET 中所有的主體現在是衍生自 <xref:System.Security.Claims.ClaimsPrincipal>。</span><span class="sxs-lookup"><span data-stu-id="4cd39-112">All principals in .NET now derive from <xref:System.Security.Claims.ClaimsPrincipal>.</span></span> <span data-ttu-id="4cd39-113">如需 WIF 命名空間以及其所包含之各種類別的詳細資訊，請參閱 [WIF API 參考](../../../docs/framework/security/wif-api-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-113">For more detailed information about the WIF namespaces and the kinds of classes that they contain, see [WIF API Reference](../../../docs/framework/security/wif-api-reference.md).</span></span> <span data-ttu-id="4cd39-114">如需 WIF 3.5 和 WIF 4.5 之間的命名空間對應方式詳細資訊，請參閱 [WIF 3.5 和 WIF 4.5 之間的命名空間對應](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-114">For information about how namespaces map between WIF 3.5 and WIF 4.5, see [Namespace Mapping between WIF 3.5 and WIF 4.5](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md).</span></span>  
  
## <a name="new-claims-model-and-principal-object"></a><span data-ttu-id="4cd39-115">新的宣告模型和主體物件</span><span class="sxs-lookup"><span data-stu-id="4cd39-115">New Claims Model and Principal Object</span></span>  
 <span data-ttu-id="4cd39-116">宣告是位於 .NET Framework 4.5 的最核心。</span><span class="sxs-lookup"><span data-stu-id="4cd39-116">Claims are at the very core of the .NET Framework 4.5.</span></span> <span data-ttu-id="4cd39-117">基本的宣告類別 (<xref:System.Security.Claims.Claim>、<xref:System.Security.Claims.ClaimsIdentity>、<xref:System.Security.Claims.ClaimsPrincipal>、<xref:System.Security.Claims.ClaimTypes> 和 <xref:System.Security.Claims.ClaimValueTypes>) 全部都是直接位於 `mscorlib` 命名空間的 <xref:System.Security.Claims?displayProperty=nameWithType> 中。</span><span class="sxs-lookup"><span data-stu-id="4cd39-117">The base claim classes (<xref:System.Security.Claims.Claim>, <xref:System.Security.Claims.ClaimsIdentity>, <xref:System.Security.Claims.ClaimsPrincipal>, <xref:System.Security.Claims.ClaimTypes>, and <xref:System.Security.Claims.ClaimValueTypes>) all live directly in `mscorlib` in the <xref:System.Security.Claims?displayProperty=nameWithType> namespace.</span></span> <span data-ttu-id="4cd39-118">現在已經不需要使用介面來將宣告外掛到 .NET 識別系統中：<xref:System.Security.Principal.WindowsPrincipal>、<xref:System.Security.Principal.GenericPrincipal> 和 <xref:System.Web.Security.RolePrincipal> 現在是繼承自 <xref:System.Security.Claims.ClaimsPrincipal>；而 <xref:System.Security.Principal.WindowsIdentity>、<xref:System.Security.Principal.GenericIdentity> 和 <xref:System.Web.Security.FormsIdentity> 現在則是繼承自 <xref:System.Security.Claims.ClaimsIdentity>。</span><span class="sxs-lookup"><span data-stu-id="4cd39-118">It is no longer necessary to use interfaces in order to plug claims into the .NET identity system: <xref:System.Security.Principal.WindowsPrincipal>, <xref:System.Security.Principal.GenericPrincipal>, and <xref:System.Web.Security.RolePrincipal> now inherit from <xref:System.Security.Claims.ClaimsPrincipal>; and <xref:System.Security.Principal.WindowsIdentity>, <xref:System.Security.Principal.GenericIdentity>, and <xref:System.Web.Security.FormsIdentity> now inherit from <xref:System.Security.Claims.ClaimsIdentity>.</span></span> <span data-ttu-id="4cd39-119">簡單地說，現在每個主體類別都可提供宣告。</span><span class="sxs-lookup"><span data-stu-id="4cd39-119">In short, every principal class will now serve claims.</span></span> <span data-ttu-id="4cd39-120">因此，也就移除了 WIF 3.5 整合類別和介面 (`WindowsClaimsIdentity`、`WindowsClaimsPrincipal`、`IClaimsPrincipal` 和 `IClaimsIdentity`)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-120">The WIF 3.5 integration classes and interfaces (`WindowsClaimsIdentity`, `WindowsClaimsPrincipal`, `IClaimsPrincipal`, `IClaimsIdentity`) have thus been removed.</span></span> <span data-ttu-id="4cd39-121">此外，<xref:System.Security.Claims.ClaimsIdentity> 類別現在會公開可以輕鬆查詢識別的宣告集合的方法。</span><span class="sxs-lookup"><span data-stu-id="4cd39-121">In addition, the <xref:System.Security.Claims.ClaimsIdentity> class now exposes methods which make it easier to query the identity’s claims collection.</span></span>  
  
## <a name="changes-to-the-wif-45-visual-studio-experience"></a><span data-ttu-id="4cd39-122">對 WIF 4.5 Visual Studio 經驗的變更</span><span class="sxs-lookup"><span data-stu-id="4cd39-122">Changes to the WIF 4.5 Visual Studio Experience</span></span>  
  
-   <span data-ttu-id="4cd39-123">**新增 STS 參考...**</span><span class="sxs-lookup"><span data-stu-id="4cd39-123">The **Add STS Reference …**</span></span> <span data-ttu-id="4cd39-124">Visual Studio 功能 (cmdline 公用程式 FedUtil) 已不存在；您可以改為使用新的 Visual Studio 延伸模組 **Visual Studio 2012 的身分識別與存取工具**。</span><span class="sxs-lookup"><span data-stu-id="4cd39-124">Visual Studio functionality (cmdline utility FedUtil) no longer exists; instead you can use the new Visual Studio extension **Identity and Access Tool for Visual Studio 2012**.</span></span> <span data-ttu-id="4cd39-125">這可讓您與現有的 STS 建立同盟或使用 LocalSTS 來測試方案。</span><span class="sxs-lookup"><span data-stu-id="4cd39-125">This allows you to federate with an existing STS or use LocalSTS to test your solutions.</span></span> <span data-ttu-id="4cd39-126">安裝此延伸模組之後，您可以用滑鼠右鍵按一下專案，然後尋找操作功能表上的 [身分識別與存取]。</span><span class="sxs-lookup"><span data-stu-id="4cd39-126">After installing the extension you can right-click on your project and look for **Identity and Access** in the context menu.</span></span>  
  
-   <span data-ttu-id="4cd39-127">ASP.NET 和 STS 範本已不再提供，因為現有的 ASP.NET、網站和 WCF 專案範本中可以直接使用宣告。</span><span class="sxs-lookup"><span data-stu-id="4cd39-127">The ASP.NET and STS templates are no longer provided as claims can be used directly in existing project templates for ASP.Net, web sites, and WCF.</span></span>  
  
-   <span data-ttu-id="4cd39-128">WIF 4.5 不再延續使用 `Microsoft.IdentityModel.Web.Controls` 命名空間中的控制項 (`SignInControl`、`FederatedPassiveSignInControl` 和 `FederatedPassiveSignInStatus`)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-128">The controls in the `Microsoft.IdentityModel.Web.Controls` namespace (`SignInControl`, `FederatedPassiveSignInControl`, and `FederatedPassiveSignInStatus`) are not carried over into WIF 4.5.</span></span>  
  
## <a name="changes-to-the-wif-45-api"></a><span data-ttu-id="4cd39-129">WIF 4.5 應用程式開發介面的變更</span><span class="sxs-lookup"><span data-stu-id="4cd39-129">Changes to the WIF 4.5 API</span></span>  
  
-   <span data-ttu-id="4cd39-130">一般而言，宣告相關類別是位於 <xref:System.Security.Claims?displayProperty=nameWithType> 命名空間中；WCF 相關類別 (用於 WS-Trust 情節的服務合約、通道、通道處理站和服務主機) 是位於 <xref:System.ServiceModel.Security?displayProperty=nameWithType> 中；而所有其他 WIF 類別則是散佈在各種 [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) 命名空間中 (這些類別包括，例如，表示 WS-\* 和 SAML 成品的類別、權杖處理常式和相關類別，以及用於 WS-同盟情節的類別)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-130">In general, claims related classes are in the <xref:System.Security.Claims?displayProperty=nameWithType> namespace; WCF related classes –- service contracts, channels, channel factories, and service hosts that are used for WS-Trust scenarios -- are in <xref:System.ServiceModel.Security?displayProperty=nameWithType>; and all other WIF classes are spread across various [System.IdentityModel](https://go.microsoft.com/fwlink/?LinkId=272004) namespaces – these include, for example, classes that represent WS-\* and SAML artifacts, token handlers and related classes, and classes used in WS-Federation scenarios.</span></span> <span data-ttu-id="4cd39-131">如需詳細資訊，請參閱 [WIF 3.5 和 WIF 4.5 之間的命名空間對應](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md)和 [WIF API 參考](../../../docs/framework/security/wif-api-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-131">For more information, see [Namespace Mapping between WIF 3.5 and WIF 4.5](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md) and [WIF API Reference](../../../docs/framework/security/wif-api-reference.md).</span></span>  
  
-   <span data-ttu-id="4cd39-132">電腦金鑰已可用於 Web 伺服陣列情節中的工作階段 Cookie 中。</span><span class="sxs-lookup"><span data-stu-id="4cd39-132">Machine key has been enabled for use in session cookies for web farm scenarios.</span></span> <span data-ttu-id="4cd39-133">如需詳細資訊，請參閱 [WIF 和 Web 伺服陣列](../../../docs/framework/security/wif-and-web-farms.md)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-133">For more information, see [WIF and Web Farms](../../../docs/framework/security/wif-and-web-farms.md).</span></span>  
  
-   <span data-ttu-id="4cd39-134">您現在以宣告方式設定 [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) 和 [\<system.identityModel.services>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel-services.md) 元素下的 WIF。</span><span class="sxs-lookup"><span data-stu-id="4cd39-134">You now declaratively configure WIF under the [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) and [\<system.identityModel.services>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel-services.md) elements.</span></span> <span data-ttu-id="4cd39-135">如需 WIF 組態的詳細資訊，請參閱 [WIF 組態參考](../../../docs/framework/security/wif-configuration-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="4cd39-135">For more information about WIF configuration, see [WIF Configuration Reference](../../../docs/framework/security/wif-configuration-reference.md).</span></span>  
  
## <a name="other-notable-net-changes-or-features-that-are-caused-by-the-integration-of-wif-into-net"></a><span data-ttu-id="4cd39-136">將 WIF 整合到 .NET 中所造成的其他值得注意的 .NET 變更或功能</span><span class="sxs-lookup"><span data-stu-id="4cd39-136">Other notable .NET changes or features that are caused by the integration of WIF into .NET</span></span>  
  
-   <span data-ttu-id="4cd39-137">執行宣告式授權 (CBAC) 的可能性現在已整合至 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="4cd39-137">The potential for performing claims-based authorization (CBAC) is now integral to the .NET framework.</span></span> <span data-ttu-id="4cd39-138">您可以設定 <xref:System.Security.Claims.ClaimsAuthorizationManager> 物件，然後使用 <xref:System.IdentityModel.Services.ClaimsPrincipalPermission> 和 <xref:System.IdentityModel.Services.ClaimsPrincipalPermissionAttribute> 類別在您的程式碼中執行命令式和宣告式存取檢查。</span><span class="sxs-lookup"><span data-stu-id="4cd39-138">You can configure a <xref:System.Security.Claims.ClaimsAuthorizationManager> object and then use the <xref:System.IdentityModel.Services.ClaimsPrincipalPermission> and <xref:System.IdentityModel.Services.ClaimsPrincipalPermissionAttribute> classes to perform imperative and declarative access checks in your code.</span></span> <span data-ttu-id="4cd39-139">CBAC 比傳統的角色式存取檢查 (RBAC) 提供更多的彈性和更佳的細微性。</span><span class="sxs-lookup"><span data-stu-id="4cd39-139">CBAC provides more flexibility and greater granularity than traditional role-based access checks (RBAC).</span></span> <span data-ttu-id="4cd39-140">它也可以讓授權原則更有效地從商務邏輯分離，因為商務邏輯可以根據特定宣告或宣告集進行存取檢查，而這些宣告的授權原則可以用宣告的方式設定在 [\<claimsAuthorizationManager>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/claimsauthorizationmanager.md) 元素下。</span><span class="sxs-lookup"><span data-stu-id="4cd39-140">It also allows greater separation of authorization policy from business logic because the business logic can base the access check on a specific claim or set of claims and the authorization policy for those claims can be configured declaratively under the [\<claimsAuthorizationManager>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/claimsauthorizationmanager.md) element.</span></span>  
  
## <a name="wcf-changes-as-a-result-of-wif-integration"></a><span data-ttu-id="4cd39-141">由 WIF 整合所造成的 WCF 變更：</span><span class="sxs-lookup"><span data-stu-id="4cd39-141">WCF changes as a result of WIF integration:</span></span>  
  
-   <span data-ttu-id="4cd39-142">WIF 已取代 WCF 宣告式識別模型。</span><span class="sxs-lookup"><span data-stu-id="4cd39-142">The WCF claims-based identity model is superseded by WIF.</span></span> <span data-ttu-id="4cd39-143">這表示應該捨棄 <xref:System.IdentityModel.Claims?displayProperty=nameWithType>、<xref:System.IdentityModel.Policy?displayProperty=nameWithType> 和 <xref:System.IdentityModel.Selectors?displayProperty=nameWithType> 命名空間中的類別，改為使用 WIF 類別。</span><span class="sxs-lookup"><span data-stu-id="4cd39-143">This means that classes in the <xref:System.IdentityModel.Claims?displayProperty=nameWithType>, <xref:System.IdentityModel.Policy?displayProperty=nameWithType>, and <xref:System.IdentityModel.Selectors?displayProperty=nameWithType> namespaces should be dropped in favor of using WIF classes.</span></span>  
  
-   <span data-ttu-id="4cd39-144">WCF 服務現在可以使用 WIF，只需指定 `<system.serviceModel>`/`<behaviors>`/`<serviceBehaviors>`/`<serviceCredentials>` 元素的 `useIdentityConfiguration` 屬性，如下面 XML 所示：</span><span class="sxs-lookup"><span data-stu-id="4cd39-144">WIF is now enabled on a WCF service by specifying the `useIdentityConfiguration` attribute on the `<system.serviceModel>`/`<behaviors>`/`<serviceBehaviors>`/`<serviceCredentials>` element as in the following XML:</span></span>  
  
    ```xml  
    <serviceCredentials useIdentityConfiguration="true">  
        <!--Certificate added by Identity And Access VS Package.  Subject='CN=localhost', Issuer='CN=localhost'. Make sure you have this certificate installed. The Identity and Access tool does not install this certificate.-->  
        <serviceCertificate findValue="CN=localhost" storeLocation="LocalMachine" storeName="My" x509FindType="FindBySubjectDistinguishedName" />  
    </serviceCredentials>  
    ```  
  
     <span data-ttu-id="4cd39-145">當您使用 **Visual Studio 2012 的身分識別分與存取工具** (請參閱上述的**對 Visual Studio 體驗的變更**) 時，此工具會為您在組態檔中新增設定了 `useIdentityConfiguration` 屬性的 `<serviceCredentials>` 元素。</span><span class="sxs-lookup"><span data-stu-id="4cd39-145">When you use the **Identity and Access Tool for Visual Studio 2012** (see **Changes to the Visual Studio Experience** above), the tool adds a `<serviceCredentials>` element with the `useIdentityConfiguration` attribute set to the configuration file for you.</span></span> <span data-ttu-id="4cd39-146">它還會新增一個含有 WIF 組態設定的對應 [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) 元素，以及新增繫結和其他必要的設定，以便讓您將驗證外包給您選擇的 STS。</span><span class="sxs-lookup"><span data-stu-id="4cd39-146">It also adds a corresponding [\<system.identityModel>](../../../docs/framework/configure-apps/file-schema/windows-identity-foundation/system-identitymodel.md) element that contains the WIF configuration settings and adds a binding and other settings necessary to outsource authentication to your chosen STS.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4cd39-147">另請參閱</span><span class="sxs-lookup"><span data-stu-id="4cd39-147">See Also</span></span>  
 [<span data-ttu-id="4cd39-148">將使用 WIF 3.5 建置的應用程式移轉至 WIF 4.5 的方針</span><span class="sxs-lookup"><span data-stu-id="4cd39-148">Guidelines for Migrating an Application Built Using WIF 3.5 to WIF 4.5</span></span>](../../../docs/framework/security/guidelines-for-migrating-an-application-built-using-wif-3-5-to-wif-4-5.md)  
 [<span data-ttu-id="4cd39-149">WIF 3.5 和 WIF 4.5 之間的命名空間對應</span><span class="sxs-lookup"><span data-stu-id="4cd39-149">Namespace Mapping between WIF 3.5 and WIF 4.5</span></span>](../../../docs/framework/security/namespace-mapping-between-wif-3-5-and-wif-4-5.md)  
 [<span data-ttu-id="4cd39-150">WIF API 參考</span><span class="sxs-lookup"><span data-stu-id="4cd39-150">WIF API Reference</span></span>](../../../docs/framework/security/wif-api-reference.md)  
 [<span data-ttu-id="4cd39-151">WIF 組態參考</span><span class="sxs-lookup"><span data-stu-id="4cd39-151">WIF Configuration Reference</span></span>](../../../docs/framework/security/wif-configuration-reference.md)
