---
title: "Windows Form 中的安全性概觀"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- code access security [Windows Forms], Windows Forms
- permissions [Windows Forms], Windows Forms
- Windows Forms, security
- security [Windows Forms], about security
- access control [Windows Forms], Windows Forms
ms.assetid: 4810dc9f-ea23-4ce1-8ea1-657f0ff1d820
caps.latest.revision: "16"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 63b7b704cf5d69ea2186ddef6e86f5c6d7993778
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/22/2017
---
# <a name="security-in-windows-forms-overview"></a><span data-ttu-id="6277a-102">Windows Form 中的安全性概觀</span><span class="sxs-lookup"><span data-stu-id="6277a-102">Security in Windows Forms Overview</span></span>
<span data-ttu-id="6277a-103">在 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 發行之前，在使用者電腦上執行的所有程式碼，對資源的存取權限都和電腦的使用者相同。</span><span class="sxs-lookup"><span data-stu-id="6277a-103">Before the release of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)], all code running on a user's computer had the same rights or permissions to access resources that a user of the computer had.</span></span> <span data-ttu-id="6277a-104">例如，如果使用者可以存取檔案系統，程式碼就可以存取檔案系統，如果使用者可以存取某個資料庫，程式碼就可以存取該資料庫。</span><span class="sxs-lookup"><span data-stu-id="6277a-104">For example, if the user was allowed to access the file system, the code was allowed to access the file system; if the user was allowed to access a database, the code was allowed to access that database.</span></span> <span data-ttu-id="6277a-105">就使用者明確安裝在本機電腦上的可執行檔中的程式碼而言，也許這些權限是可接受的，但是就來自網際網路或近端內部網路的潛在惡意程式碼而言，可能就無法接受了。</span><span class="sxs-lookup"><span data-stu-id="6277a-105">Although these rights or permissions may be acceptable for code in executables that the user has explicitly installed on the local computer, they may not be acceptable for potentially malicious code coming from the Internet or a local Intranet.</span></span> <span data-ttu-id="6277a-106">不應該讓這個程式碼在沒有權限的情況下，存取使用者的電腦資源。</span><span class="sxs-lookup"><span data-stu-id="6277a-106">This code should not be able to access the user's computer resources without permission.</span></span>  
  
 <span data-ttu-id="6277a-107">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 引進一種稱為「程式碼存取安全性」的基礎結構，可讓您區分程式碼擁有的權限與使用者擁有的權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-107">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] introduces an infrastructure called Code Access Security that lets you differentiate the permissions, or rights, that code has from the rights that the user has.</span></span> <span data-ttu-id="6277a-108">根據預設，來自網際網路及內部網路的程式碼，只能在所謂部分信任的環境中執行。</span><span class="sxs-lookup"><span data-stu-id="6277a-108">By default, code coming from the Internet and the Intranet can only run in what is known as partial trust.</span></span> <span data-ttu-id="6277a-109">部分信任會使應用程式遵守一系列的限制，例如，限制應用程式不能存取本機硬碟，且無法執行 Unmanaged 程式碼等等。</span><span class="sxs-lookup"><span data-stu-id="6277a-109">Partial trust subjects an application to a series of restrictions: among other things, an application is restricted from accessing the local hard disk, and cannot run unmanaged code.</span></span> <span data-ttu-id="6277a-110">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 會依據程式碼的身分識別，控制可允許該程式碼存取的資源；例如，程式碼來自何處、是否有[強式名稱組件](../../../docs/framework/app-domains/strong-named-assemblies.md)、是否已簽署憑證等等。</span><span class="sxs-lookup"><span data-stu-id="6277a-110">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] controls the resources that code is allowed to access based on the identity of that code: where it came from, whether it has a [Strong-Named Assemblies](../../../docs/framework/app-domains/strong-named-assemblies.md), whether it is signed with a certificate, and so on.</span></span>  
  
 <span data-ttu-id="6277a-111">您用來部署 Windows Form 應用程式的 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 技術，可協助您更輕鬆地開發可在部分信任、完全信任或提高權限的部分信任中執行的應用程式。</span><span class="sxs-lookup"><span data-stu-id="6277a-111">[!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] technology, which you use to deploy Windows Forms applications, helps make it easier for you to develop applications that run in partial trust, in full trust, or in partial trust with elevated permissions.</span></span> [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)]<span data-ttu-id="6277a-112"> 提供「提高權限」和「受信任的應用程式部署」之類的功能，讓您的應用程式能夠以負責任的方式，向本機使用者要求完全信任或提高權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-112"> provides features such as Permission Elevation and Trusted Application Deployment so that your application can request full trust or elevated permissions from the local user in a responsible manner.</span></span>  
  
## <a name="understanding-security-in-the-net-framework"></a><span data-ttu-id="6277a-113">了解 .NET Framework 中的安全性</span><span class="sxs-lookup"><span data-stu-id="6277a-113">Understanding Security in the .NET Framework</span></span>  
 <span data-ttu-id="6277a-114">程式碼存取安全性可依據程式碼的來源，以及程式碼其他方面的身分識別，提供程式碼各種程度的信任等級。</span><span class="sxs-lookup"><span data-stu-id="6277a-114">Code access security allows code to be trusted to varying degrees, depending on where the code originates and on other aspects of the code's identity.</span></span> <span data-ttu-id="6277a-115">如需 Common Language Runtime 用來判斷安全性原則的辨識項相關資訊，請參閱[辨識項](http://msdn.microsoft.com/en-us/64ceb7c8-a0b4-46c4-97dc-6c22da0539da)。</span><span class="sxs-lookup"><span data-stu-id="6277a-115">For more information about the evidence the common language runtime uses to determine security policy, see [Evidence](http://msdn.microsoft.com/en-us/64ceb7c8-a0b4-46c4-97dc-6c22da0539da).</span></span> <span data-ttu-id="6277a-116">它可以幫助保護電腦系統不受惡意程式碼的威脅，並幫助防止受信任的程式碼有意或無意地危及安全性。</span><span class="sxs-lookup"><span data-stu-id="6277a-116">It helps protect computer systems from malicious code and helps protect trusted code from intentionally or accidentally compromising security.</span></span> <span data-ttu-id="6277a-117">程式碼存取安全性也讓您更充分掌控您的應用程式可以執行哪些動作，因為您可以只指定您要讓應用程式擁有的那些權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-117">Code access security also gives you more control over what actions your application can perform, because you can specify only those permissions you need your application to have.</span></span> <span data-ttu-id="6277a-118">程式碼存取安全性會影響以 Common Language Runtime 為目標的所有 Managed 程式碼，即使該程式碼沒有進行單一程式碼存取安全性權限檢查也一樣。</span><span class="sxs-lookup"><span data-stu-id="6277a-118">Code access security affects all managed code that targets the common language runtime, even if that code does not make a single code-access-security permission check.</span></span> <span data-ttu-id="6277a-119">如需 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 中安全性的詳細資訊，請參閱[重要的安全性概念](../../../docs/standard/security/key-security-concepts.md)和[程式碼存取安全性基本概念](../../../docs/framework/misc/code-access-security-basics.md)。</span><span class="sxs-lookup"><span data-stu-id="6277a-119">For more information about security in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)], see [Key Security Concepts](../../../docs/standard/security/key-security-concepts.md) and [Code Access Security Basics](../../../docs/framework/misc/code-access-security-basics.md).</span></span>  
  
 <span data-ttu-id="6277a-120">如果使用者不透過 Web 伺服器或檔案共用，而直接執行 Windows Form 可執行檔，則授與應用程式的信任層級，取決於程式碼所在的位置，以及其啟動方式。</span><span class="sxs-lookup"><span data-stu-id="6277a-120">If the user run a Windows Forms executable file directly off of a Web server or a file share, the degree of trust granted to your application depends on where the code resides, and how it is started.</span></span> <span data-ttu-id="6277a-121">當應用程式執行時，會自動受到評估，並且會從 Common Language Runtime 收到具名權限集合。</span><span class="sxs-lookup"><span data-stu-id="6277a-121">When an application runs, it is automatically evaluated and it receives a named permission set from the common language runtime.</span></span> <span data-ttu-id="6277a-122">根據預設，來自本機電腦的程式碼會被授與完全信任權限集合，來自區域網路的程式碼會被授與近端內部網路權限集合，而來自網際網路的程式碼會被授與網際網路權限集合。</span><span class="sxs-lookup"><span data-stu-id="6277a-122">By default, the code from the local computer is granted the Full Trust permission set, code from a local network is granted the Local Intranet permission set, and code from the Internet is granted the Internet permission set.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="6277a-123">在 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 1.0 版 Service Pack 1 和 Service Pack 2 中，網際網路區域程式碼群組會收到 Nothing 權限集合。</span><span class="sxs-lookup"><span data-stu-id="6277a-123">In the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 1.0 Service Pack 1 and Service Pack 2, the Internet zone code group receives the Nothing permission set.</span></span> <span data-ttu-id="6277a-124">在 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 的所有其他版本中，網際網路區域程式碼群組都會收到網際網路權限集合。</span><span class="sxs-lookup"><span data-stu-id="6277a-124">In all other releases of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)], the Internet zone code group receives the Internet permissions set.</span></span>  
>   
>  <span data-ttu-id="6277a-125">各權限集合中授與的預設權限詳列於[預設安全性原則](http://msdn.microsoft.com/en-us/2c086873-0894-4f4d-8f7e-47427c1a3b55)主題中。</span><span class="sxs-lookup"><span data-stu-id="6277a-125">The default permissions granted in each of these permission sets are listed in the [Default Security Policy](http://msdn.microsoft.com/en-us/2c086873-0894-4f4d-8f7e-47427c1a3b55) topic.</span></span> <span data-ttu-id="6277a-126">根據應用程式接收的權限，它會正確執行，或是產生安全性例外狀況。</span><span class="sxs-lookup"><span data-stu-id="6277a-126">Depending on the permissions that the application receives, it either runs correctly or generates a security exception.</span></span>  
>   
>  <span data-ttu-id="6277a-127">許多 Windows Form 應用程式都會使用 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 來部署。</span><span class="sxs-lookup"><span data-stu-id="6277a-127">Many Windows Forms applications will be deployed using [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)].</span></span> <span data-ttu-id="6277a-128">用來產生 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 部署的工具所擁有的安全性預設值不同於先前討論的內容。</span><span class="sxs-lookup"><span data-stu-id="6277a-128">The tools used for generating a [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] deployment have different security defaults than what was discussed earlier.</span></span> <span data-ttu-id="6277a-129">如需詳細資訊，請參閱下列討論：</span><span class="sxs-lookup"><span data-stu-id="6277a-129">For more information, see the following discussion.</span></span>  
  
 <span data-ttu-id="6277a-130">授與應用程式的實際權限可能不同於預設值，因為安全性原則是可以修改的，這表示您的應用程式可能在某部電腦上具有權限，而在另一部電腦上則沒有。</span><span class="sxs-lookup"><span data-stu-id="6277a-130">The actual permissions granted to your application can be different from the default values, because the security policy can be modified; this means that your application can have permission on one computer, but not on another.</span></span>  
  
## <a name="developing-a-more-secure-windows-forms-application"></a><span data-ttu-id="6277a-131">開發更安全的 Windows Form 應用程式</span><span class="sxs-lookup"><span data-stu-id="6277a-131">Developing a More Secure Windows Forms Application</span></span>  
 <span data-ttu-id="6277a-132">在應用程式開發的所有步驟中，安全性都很重要。</span><span class="sxs-lookup"><span data-stu-id="6277a-132">Security is important in all steps of application development.</span></span> <span data-ttu-id="6277a-133">一開始請先檢閱並遵循[安全程式碼撰寫方針](../../../docs/standard/security/secure-coding-guidelines.md)。</span><span class="sxs-lookup"><span data-stu-id="6277a-133">Start by reviewing and following the [Secure Coding Guidelines](../../../docs/standard/security/secure-coding-guidelines.md).</span></span>  
  
 <span data-ttu-id="6277a-134">接著，決定您的應用程式必須在完全信任中執行，或是應該在部分信任中執行。</span><span class="sxs-lookup"><span data-stu-id="6277a-134">Next, decide whether your application must run in full trust, or whether it should run in partial trust.</span></span> <span data-ttu-id="6277a-135">以完全信任來執行您的應用程式，比較容易存取本機電腦上的資源，但是如果沒有嚴格遵守＜安全程式碼撰寫方針＞主題來設計及開發您的應用程式，就會讓您的應用程式及其使用者暴露在高度的安全性風險中。</span><span class="sxs-lookup"><span data-stu-id="6277a-135">Running your application in full trust makes it easier to access resources on the local computer, but exposes your application and its users to high security risks if you do not design and develop your application strictly according to the Secure Coding Guidelines topic.</span></span> <span data-ttu-id="6277a-136">以部分信任來執行您的應用程式，比較容易開發較安全的應用程式，並大幅降低風險，但是需要詳細規劃如何實作特定功能。</span><span class="sxs-lookup"><span data-stu-id="6277a-136">Running your application in partial trust makes it easier to develop a more secure application and reduces much risk, but requires more planning in how to implement certain features.</span></span>  
  
 <span data-ttu-id="6277a-137">如果您選擇部分信任 (也就是網際網路或近端內部網路權限集合)，請決定您想要讓應用程式如何在此環境中運作。</span><span class="sxs-lookup"><span data-stu-id="6277a-137">If you choose partial trust (that is, either the Internet or Local Intranet permission sets), decide how you want your application to behave in this environment.</span></span> <span data-ttu-id="6277a-138">Windows Form 提供更安全的替代方式，可在非完全信任的環境中實作功能。</span><span class="sxs-lookup"><span data-stu-id="6277a-138">Windows Forms provides alternative, more secure ways to implement features when in a semi-trusted environment.</span></span> <span data-ttu-id="6277a-139">針對部分信任和完全信任的環境，都可以用不同方式來設計和撰寫應用程式的某些部分，例如資料存取。</span><span class="sxs-lookup"><span data-stu-id="6277a-139">Certain parts of your application, such as data access, can be designed and written differently for both partial trust and full trust environments.</span></span> <span data-ttu-id="6277a-140">某些 Windows Form 功能 (例如應用程式設定) 是為了在部分信任中運作而設計。</span><span class="sxs-lookup"><span data-stu-id="6277a-140">Some Windows Forms features, such as application settings, are designed to work in partial trust.</span></span> <span data-ttu-id="6277a-141">如需詳細資訊，請參閱[應用程式設定概觀](../../../docs/framework/winforms/advanced/application-settings-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6277a-141">For more information, see [Application Settings Overview](../../../docs/framework/winforms/advanced/application-settings-overview.md).</span></span>  
  
 <span data-ttu-id="6277a-142">如果您的應用程式所需的權限，超出部分信任的限制，但是您不想要在完全信任中執行，您可以在部分信任中執行，並且只確立您需要的那些額外權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-142">If your application needs more permissions than partial trust allows, but you do not want to run in full trust, you can run in partial trust while asserting only those additional permissions you need.</span></span> <span data-ttu-id="6277a-143">例如，如果您想要在部分信任中執行，但必須為您的應用程式授與使用者檔案系統上之目錄的唯讀存取權，您可以只針對該目錄要求 <xref:System.Security.Permissions.FileIOPermission>。</span><span class="sxs-lookup"><span data-stu-id="6277a-143">For example, if you want to run in partial trust, but must grant your application read-only access to a directory on the user's file system, you can request <xref:System.Security.Permissions.FileIOPermission> only for that directory.</span></span> <span data-ttu-id="6277a-144">如果正確使用，這種方法可以給予應用程式更多功能，並且讓使用者的安全性風險降到最低。</span><span class="sxs-lookup"><span data-stu-id="6277a-144">Used correctly, this approach can give your application increased functionality and minimize security risks to your users.</span></span>  
  
 <span data-ttu-id="6277a-145">當您開發要在部分信任中執行的應用程式時，請追蹤應用程式必須執行的權限，以及應用程式可以選擇性使用的權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-145">When you develop an application that will run in partial trust, keep track of what permissions your application must run and what permissions your application could optionally use.</span></span> <span data-ttu-id="6277a-146">在已知所有權限的情況下，您應針對應用程式層級的權限提出宣告式要求。</span><span class="sxs-lookup"><span data-stu-id="6277a-146">When all the permissions are known, you should make a declarative request for permission at the application level.</span></span> <span data-ttu-id="6277a-147">要求權限時會通知 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 執行階段您的應用程式需要哪些權限，以及明確不想要哪些權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-147">Requesting permissions informs the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] run time about which permissions your application needs and which permissions it specifically does not want.</span></span> <span data-ttu-id="6277a-148">如需有關要求權限的詳細資訊，請參閱[要求權限](http://msdn.microsoft.com/en-us/0447c49d-8cba-45e4-862c-ff0b59bebdc2)。</span><span class="sxs-lookup"><span data-stu-id="6277a-148">For more information about requesting permissions, see [Requesting Permissions](http://msdn.microsoft.com/en-us/0447c49d-8cba-45e4-862c-ff0b59bebdc2).</span></span>  
  
 <span data-ttu-id="6277a-149">當您要求選擇性權限時，您必須處理當應用程式執行的動作需要未被授與的權限時，所產生的安全性例外狀況。</span><span class="sxs-lookup"><span data-stu-id="6277a-149">When you request optional permissions, you must handle security exceptions that will be generated if your application performs an action that requires permissions not granted to it.</span></span> <span data-ttu-id="6277a-150">適當處理 <xref:System.Security.SecurityException> 可確保您的應用程式能夠繼續運作。</span><span class="sxs-lookup"><span data-stu-id="6277a-150">Appropriate handling of the <xref:System.Security.SecurityException> will ensure that your application can continue to operate.</span></span> <span data-ttu-id="6277a-151">您的應用程式可以使用例外狀況來判斷是否應該為使用者停用某功能。</span><span class="sxs-lookup"><span data-stu-id="6277a-151">Your application can use the exception to determine whether a feature should become disabled for the user.</span></span> <span data-ttu-id="6277a-152">例如，如果未授與必要的檔案權限，應用程式可以停用 [儲存] 功能表選項。</span><span class="sxs-lookup"><span data-stu-id="6277a-152">For example, an application can disable the **Save** menu option if the required file permission is not granted.</span></span>  
  
 <span data-ttu-id="6277a-153">有時候，很難知道您是否已確立所有適當的權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-153">Sometimes, it is difficult to know if you have asserted all the appropriate permissions.</span></span> <span data-ttu-id="6277a-154">比方說，表面上看起來無害的方法呼叫，可能會在其執行期間的某個時間點存取檔案系統。</span><span class="sxs-lookup"><span data-stu-id="6277a-154">A method call which looks innocuous on the surface, for example, may access the file system at some point during its execution.</span></span> <span data-ttu-id="6277a-155">如果您未以所有的必要權限來部署應用程式，在桌面上偵錯時，測試可能沒問題，但部署時可能會失敗。</span><span class="sxs-lookup"><span data-stu-id="6277a-155">If you do not deploy your application with all the required permissions, it may test fine when you debug it on your desktop, but fail when deployed.</span></span> <span data-ttu-id="6277a-156">[!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)] SDK 和 [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)] 都有包含用來計算應用程式所需權限的工具：分別是 MT.exe 命令列工具，以及 [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] 的計算權限功能。</span><span class="sxs-lookup"><span data-stu-id="6277a-156">Both the [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)] SDK and [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)] contain tools for calculating the permissions an application needs: the MT.exe command line tool and the Calculate Permissions feature of [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)], respectively.</span></span>  
  
 <span data-ttu-id="6277a-157">下列主題說明其他 Windows Form 安全性功能。</span><span class="sxs-lookup"><span data-stu-id="6277a-157">The following topics describe additional Windows Forms security features.</span></span>  
  
|<span data-ttu-id="6277a-158">主題</span><span class="sxs-lookup"><span data-stu-id="6277a-158">Topic</span></span>|<span data-ttu-id="6277a-159">描述</span><span class="sxs-lookup"><span data-stu-id="6277a-159">Description</span></span>|  
|-----------|-----------------|  
|<span data-ttu-id="6277a-160">-   [Windows Forms 中更安全的檔案和資料存取](../../../docs/framework/winforms/more-secure-file-and-data-access-in-windows-forms.md)</span><span class="sxs-lookup"><span data-stu-id="6277a-160">-   [More Secure File and Data Access in Windows Forms](../../../docs/framework/winforms/more-secure-file-and-data-access-in-windows-forms.md)</span></span>|<span data-ttu-id="6277a-161">說明如何在部分信任的環境中存取檔案和資料。</span><span class="sxs-lookup"><span data-stu-id="6277a-161">Describes how to access files and data in a partial trust environment.</span></span>|  
|<span data-ttu-id="6277a-162">-   [Windows Forms 中更安全的列印](../../../docs/framework/winforms/more-secure-printing-in-windows-forms.md)</span><span class="sxs-lookup"><span data-stu-id="6277a-162">-   [More Secure Printing in Windows Forms](../../../docs/framework/winforms/more-secure-printing-in-windows-forms.md)</span></span>|<span data-ttu-id="6277a-163">說明如何在部分信任的環境中存取列印功能。</span><span class="sxs-lookup"><span data-stu-id="6277a-163">Describes how to access printing features in a partial trust environment.</span></span>|  
|<span data-ttu-id="6277a-164">-   [Windows Forms 中的其他安全性考量](../../../docs/framework/winforms/additional-security-considerations-in-windows-forms.md)</span><span class="sxs-lookup"><span data-stu-id="6277a-164">-   [Additional Security Considerations in Windows Forms](../../../docs/framework/winforms/additional-security-considerations-in-windows-forms.md)</span></span>|<span data-ttu-id="6277a-165">說明如何在部分信任的環境中執行視窗操作、使用剪貼簿，以及呼叫 Unmanaged 程式碼。</span><span class="sxs-lookup"><span data-stu-id="6277a-165">Describes performing window manipulation, using the Clipboard, and making calls to unmanaged code in a partial trust environment.</span></span>|  
  
-  
  
### <a name="deploying-an-application-with-the-appropriate-permissions"></a><span data-ttu-id="6277a-166">使用適當的權限部署應用程式</span><span class="sxs-lookup"><span data-stu-id="6277a-166">Deploying an Application with the Appropriate Permissions</span></span>  
 <span data-ttu-id="6277a-167">將 Windows Form 應用程式部署至用戶端電腦時，最常見的方法是使用 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)]，這個部署技術會描述應用程式必須執行的所有元件。</span><span class="sxs-lookup"><span data-stu-id="6277a-167">The most common means of deploying a Windows Forms application to a client computer is with [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)], a deployment technology that describes all of the components your application needs to run.</span></span> [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)]<span data-ttu-id="6277a-168"> 使用稱為資訊清單的 XML 檔案來描述構成應用程式的組件和檔案，以及應用程式所需的權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-168"> uses XML files called manifests to describe the assemblies and files that make up your application, and also the permissions your application requires.</span></span>  
  
 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)]<span data-ttu-id="6277a-169"> 有兩種技術可在用戶端電腦上要求提高權限。</span><span class="sxs-lookup"><span data-stu-id="6277a-169"> has two technologies for requesting elevated permissions on a client computer.</span></span> <span data-ttu-id="6277a-170">這兩種技術都需要使用 Authenticode 憑證。</span><span class="sxs-lookup"><span data-stu-id="6277a-170">Both technologies rely on the use of Authenticode certificates.</span></span> <span data-ttu-id="6277a-171">該憑證有助於確保應用程式的使用者是來自受信任的來源。</span><span class="sxs-lookup"><span data-stu-id="6277a-171">The certificates help provide some assurance to your users that the application has come from a trusted source.</span></span>  
  
 <span data-ttu-id="6277a-172">下表將描述這些技術。</span><span class="sxs-lookup"><span data-stu-id="6277a-172">The following table describes these technologies.</span></span>  
  
|<span data-ttu-id="6277a-173">提高權限技術</span><span class="sxs-lookup"><span data-stu-id="6277a-173">Elevated permission technology</span></span>|<span data-ttu-id="6277a-174">描述</span><span class="sxs-lookup"><span data-stu-id="6277a-174">Description</span></span>|  
|------------------------------------|-----------------|  
|<span data-ttu-id="6277a-175">權限提高</span><span class="sxs-lookup"><span data-stu-id="6277a-175">Permission Elevation</span></span>|<span data-ttu-id="6277a-176">在應用程式第一次執行時，會以安全性對話方塊來提示使用者。</span><span class="sxs-lookup"><span data-stu-id="6277a-176">Prompts the user with a security dialog box the first time your application runs.</span></span> <span data-ttu-id="6277a-177">[權限提高] 對話方塊會通知使用者是誰發行該應用程式，讓使用者能夠明智地決定是否要授與其額外的信任</span><span class="sxs-lookup"><span data-stu-id="6277a-177">The **Permission Elevation** dialog box informs the user about who published the application, so that the user can make an informed decision about whether to grant it additional trust</span></span>|  
|<span data-ttu-id="6277a-178">受信任的應用程式部署</span><span class="sxs-lookup"><span data-stu-id="6277a-178">Trusted Application Deployment</span></span>|<span data-ttu-id="6277a-179">需要系統管理員在用戶端電腦上執行發行者 Authenticode 憑證的單次安裝。</span><span class="sxs-lookup"><span data-stu-id="6277a-179">Involves a system administrator performing a one-time installation of a publisher's Authenticode certificate on a client computer.</span></span> <span data-ttu-id="6277a-180">從此之後，有簽署憑證的任何應用程式都會視為受信任，並且可以在本機電腦上以完全信任執行，而不會有其他提示。</span><span class="sxs-lookup"><span data-stu-id="6277a-180">From that point on, any applications signed with the certificate are regarded as trusted, and can run at full trust on the local computer without additional prompting.</span></span>|  
  
 <span data-ttu-id="6277a-181">您要選擇哪一種技術，將取決於您的部署環境。</span><span class="sxs-lookup"><span data-stu-id="6277a-181">Which technology you choose will depend on your deployment environment.</span></span> <span data-ttu-id="6277a-182">如需詳細資訊，請參閱[選擇 ClickOnce 部署策略](/visualstudio/deployment/choosing-a-clickonce-deployment-strategy)。</span><span class="sxs-lookup"><span data-stu-id="6277a-182">For more information, see [Choosing a ClickOnce Deployment Strategy](/visualstudio/deployment/choosing-a-clickonce-deployment-strategy).</span></span>  
  
 <span data-ttu-id="6277a-183">根據預設，使用 [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] 或 [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)] SDK 工具 (Mage.exe 和 MageUI.exe) 來部署的 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 應用程式，會設定為要在具有完全信任的用戶端電腦上執行。</span><span class="sxs-lookup"><span data-stu-id="6277a-183">By default, [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] applications deployed using either [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] or the [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)] SDK tools (Mage.exe and MageUI.exe) are configured to run on a client computer that has Full Trust.</span></span> <span data-ttu-id="6277a-184">如果您在部署應用程式時，是使用部分信任，或是只有使用某些額外的權限，則必須變更這個預設值。</span><span class="sxs-lookup"><span data-stu-id="6277a-184">If you are deploying your application by using partial trust or by using only some additional permissions, you will have to change this default.</span></span> <span data-ttu-id="6277a-185">您可以在設定部署時，使用 [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] 或 [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)] SDK 工具 MageUI.exe 來執行此作業。</span><span class="sxs-lookup"><span data-stu-id="6277a-185">You can do this with either [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] or the [!INCLUDE[dnprdnlong](../../../includes/dnprdnlong-md.md)] SDK tool MageUI.exe when you configure your deployment.</span></span> <span data-ttu-id="6277a-186">如需有關如何使用 MageUI.exe 的詳細資訊，請參閱＜逐步解說：從命令列部署 ClickOnce 應用程式＞。</span><span class="sxs-lookup"><span data-stu-id="6277a-186">For more information about how to use MageUI.exe, see Walkthrough: Deploying a ClickOnce Application from the Command Line.</span></span>  <span data-ttu-id="6277a-187">另請參閱[如何：設定 ClickOnce 應用程式的自訂權限](http://msdn.microsoft.com/library/hafybdaa\(v=vs.110\))或[如何：設定 ClickOnce 應用程式的自訂權限](http://msdn.microsoft.com/library/hafybdaa\(v=vs.120\))。</span><span class="sxs-lookup"><span data-stu-id="6277a-187">Also see [How to: Set Custom Permissions for a ClickOnce Application](http://msdn.microsoft.com/library/hafybdaa\(v=vs.110\)) or [How to: Set Custom Permissions for a ClickOnce Application](http://msdn.microsoft.com/library/hafybdaa\(v=vs.120\)).</span></span>  
  
 <span data-ttu-id="6277a-188">如需有關 [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] 安全性層面和權限提高的詳細資訊，請參閱[保護 ClickOnce 應用程式](/visualstudio/deployment/securing-clickonce-applications)。</span><span class="sxs-lookup"><span data-stu-id="6277a-188">For more information about the security aspects of [!INCLUDE[ndptecclick](../../../includes/ndptecclick-md.md)] and Permission Elevation, see [Securing ClickOnce Applications](/visualstudio/deployment/securing-clickonce-applications).</span></span> <span data-ttu-id="6277a-189">如需有關受信任的應用程式部署的詳細資訊，請參閱[受信任的應用程式部署概觀](/visualstudio/deployment/trusted-application-deployment-overview)。</span><span class="sxs-lookup"><span data-stu-id="6277a-189">For more information about Trusted Application Deployment, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview).</span></span>  
  
### <a name="testing-the-application"></a><span data-ttu-id="6277a-190">測試應用程式</span><span class="sxs-lookup"><span data-stu-id="6277a-190">Testing the Application</span></span>  
 <span data-ttu-id="6277a-191">如果您已使用 [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)] 來部署您的 Windows Form 應用程式，您可以從開發環境啟用部分信任中的偵錯或受限制的權限集合。</span><span class="sxs-lookup"><span data-stu-id="6277a-191">If you have deployed your Windows Forms application by using [!INCLUDE[vsprvs](../../../includes/vsprvs-md.md)], you can enable debugging in partial trust or a restricted permission set from the development environment.</span></span>  <span data-ttu-id="6277a-192">另請參閱[如何：以限制使用權限偵錯 ClickOnce 應用程式](http://msdn.microsoft.com/library/593zkfdf\(v=vs.110\))或[如何：以限制使用權限偵錯 ClickOnce 應用程式](http://msdn.microsoft.com/library/593zkfdf\(v=vs.120\))。</span><span class="sxs-lookup"><span data-stu-id="6277a-192">Also see [How to: Debug a ClickOnce Application with Restricted Permissions](http://msdn.microsoft.com/library/593zkfdf\(v=vs.110\)) or [How to: Debug a ClickOnce Application with Restricted Permissions](http://msdn.microsoft.com/library/593zkfdf\(v=vs.120\)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6277a-193">請參閱</span><span class="sxs-lookup"><span data-stu-id="6277a-193">See Also</span></span>  
 [<span data-ttu-id="6277a-194">Windows Forms 安全性</span><span class="sxs-lookup"><span data-stu-id="6277a-194">Windows Forms Security</span></span>](../../../docs/framework/winforms/windows-forms-security.md)  
 [<span data-ttu-id="6277a-195">程式碼存取安全性的基本概念</span><span class="sxs-lookup"><span data-stu-id="6277a-195">Code Access Security Basics</span></span>](../../../docs/framework/misc/code-access-security-basics.md)  
 [<span data-ttu-id="6277a-196">ClickOnce 安全性和部署</span><span class="sxs-lookup"><span data-stu-id="6277a-196">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)  
 [<span data-ttu-id="6277a-197">受信任的應用程式部署概觀</span><span class="sxs-lookup"><span data-stu-id="6277a-197">Trusted Application Deployment Overview</span></span>](/visualstudio/deployment/trusted-application-deployment-overview)  
 [<span data-ttu-id="6277a-198">Mage.exe (資訊清單產生和編輯工具)</span><span class="sxs-lookup"><span data-stu-id="6277a-198">Mage.exe (Manifest Generation and Editing Tool)</span></span>](../../../docs/framework/tools/mage-exe-manifest-generation-and-editing-tool.md)  
 [<span data-ttu-id="6277a-199">MageUI.exe (圖形用戶端、資訊清單產生和編輯工具)</span><span class="sxs-lookup"><span data-stu-id="6277a-199">MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)</span></span>](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)
