---
title: 支援的資料來源
ms.date: 03/30/2017
helpviewer_keywords:
- collections [Windows Forms], binding to
- OLE DB providers [Windows Forms], Windows Forms
- DataTable class [Windows Forms], binding and Windows Forms
- Windows Forms, data binding
- DataView class [Windows Forms], binding and Windows Forms
- DataViewManager class [Windows Forms], binding and Windows Forms
- Windows Forms, source data
- arrays [Windows Forms]
- data sources [Windows Forms]
- data providers [Windows Forms]
- DataSet class [Windows Forms], binding and Windows Forms
- data [Windows Forms], data providers
ms.assetid: 3d2c43f6-462b-4d35-9c86-13e9afe012e1
ms.openlocfilehash: 83ce4bb0d6f0bf81bcad4e38af212dccc3483ca5
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76742307"
---
# <a name="data-sources-supported-by-windows-forms"></a><span data-ttu-id="a36b0-102">Windows Form 支援的資料來源</span><span class="sxs-lookup"><span data-stu-id="a36b0-102">Data Sources Supported by Windows Forms</span></span>
<span data-ttu-id="a36b0-103">傳統上，已在應用程式中使用資料系結，以利用儲存在資料庫中的資料。</span><span class="sxs-lookup"><span data-stu-id="a36b0-103">Traditionally, data binding has been used within applications to take advantage of data stored in databases.</span></span> <span data-ttu-id="a36b0-104">使用 Windows Forms 的資料系結，您可以從資料庫以及其他結構（例如陣列和集合）中的資料存取資料，只要符合特定的最低需求即可。</span><span class="sxs-lookup"><span data-stu-id="a36b0-104">With Windows Forms data binding, you can access data from databases as well as data in other structures, such as arrays and collections, so long as certain minimum requirements have been met.</span></span>  
  
## <a name="structures-to-bind-to"></a><span data-ttu-id="a36b0-105">要系結的結構</span><span class="sxs-lookup"><span data-stu-id="a36b0-105">Structures to Bind To</span></span>  
 <span data-ttu-id="a36b0-106">在 Windows Forms 中，您可以系結至各種不同的結構，從簡單物件（簡單系結）到複雜清單（例如 ADO.NET 資料表（複雜系結））。</span><span class="sxs-lookup"><span data-stu-id="a36b0-106">In Windows Forms, you can bind to a wide variety of structures, from simple objects (simple binding) to complex lists such as ADO.NET data tables (complex binding).</span></span> <span data-ttu-id="a36b0-107">針對簡單系結，Windows Forms 支援系結至簡單物件上的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="a36b0-107">For simple binding, Windows Forms supports binding to the public properties on the simple object.</span></span> <span data-ttu-id="a36b0-108">Windows Forms 以清單為基礎的系結通常會要求物件支援 <xref:System.Collections.IList> 介面或 <xref:System.ComponentModel.IListSource> 介面。</span><span class="sxs-lookup"><span data-stu-id="a36b0-108">Windows Forms list-based binding generally requires that the object support the <xref:System.Collections.IList> interface or the <xref:System.ComponentModel.IListSource> interface.</span></span> <span data-ttu-id="a36b0-109">此外，如果您透過 <xref:System.Windows.Forms.BindingSource> 元件系結，您可以系結至支援 <xref:System.Collections.IEnumerable> 介面的物件。</span><span class="sxs-lookup"><span data-stu-id="a36b0-109">Additionally, if you are binding with through a <xref:System.Windows.Forms.BindingSource> component, you can bind to an object that supports the <xref:System.Collections.IEnumerable> interface.</span></span> <span data-ttu-id="a36b0-110">如需與資料系結相關之介面的詳細資訊，請參閱與資料系結[相關的介面](interfaces-related-to-data-binding.md)。</span><span class="sxs-lookup"><span data-stu-id="a36b0-110">For more information about interfaces related to data binding, see [Interfaces Related to Data Binding](interfaces-related-to-data-binding.md).</span></span>  
  
 <span data-ttu-id="a36b0-111">下列清單顯示您可以在 Windows Forms 中系結的結構。</span><span class="sxs-lookup"><span data-stu-id="a36b0-111">The following list shows the structures you can bind to in Windows Forms.</span></span>  
  
 <xref:System.Windows.Forms.BindingSource>  
 <span data-ttu-id="a36b0-112"><xref:System.Windows.Forms.BindingSource> 是最常見的 Windows Forms 資料來源，並可在資料來源和 Windows Forms 控制項之間進行 proxy。</span><span class="sxs-lookup"><span data-stu-id="a36b0-112">A <xref:System.Windows.Forms.BindingSource> is the most common Windows Forms data source and acts a proxy between a data source and Windows Forms controls.</span></span> <span data-ttu-id="a36b0-113">一般 <xref:System.Windows.Forms.BindingSource> 使用模式是將控制項系結至 <xref:System.Windows.Forms.BindingSource>，並將 <xref:System.Windows.Forms.BindingSource> 系結至資料來源（例如，ADO.NET 資料表或商務物件）。</span><span class="sxs-lookup"><span data-stu-id="a36b0-113">The general <xref:System.Windows.Forms.BindingSource> usage pattern is to bind your controls to the <xref:System.Windows.Forms.BindingSource> and bind the <xref:System.Windows.Forms.BindingSource> to the data source (for example, an ADO.NET data table or a business object).</span></span> <span data-ttu-id="a36b0-114"><xref:System.Windows.Forms.BindingSource> 提供可啟用及改善資料系結支援層級的服務。</span><span class="sxs-lookup"><span data-stu-id="a36b0-114">The <xref:System.Windows.Forms.BindingSource> provides services that enable and improve the level of data binding support.</span></span> <span data-ttu-id="a36b0-115">例如，Windows Forms 清單型控制項（例如 <xref:System.Windows.Forms.DataGridView> 和 <xref:System.Windows.Forms.ComboBox> 並不會直接支援系結至 <xref:System.Collections.IEnumerable> 資料來源，不過您可以透過 <xref:System.Windows.Forms.BindingSource>系結來啟用此案例。</span><span class="sxs-lookup"><span data-stu-id="a36b0-115">For example, Windows Forms list based controls such as the <xref:System.Windows.Forms.DataGridView> and <xref:System.Windows.Forms.ComboBox> do not directly support binding to <xref:System.Collections.IEnumerable> data sources however, you can enable this scenario by binding through a <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="a36b0-116">在此情況下，<xref:System.Windows.Forms.BindingSource> 會將資料來源轉換成 <xref:System.Collections.IList>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-116">In this case, the <xref:System.Windows.Forms.BindingSource> will convert the data source to an <xref:System.Collections.IList>.</span></span>  
  
 <span data-ttu-id="a36b0-117">簡單物件</span><span class="sxs-lookup"><span data-stu-id="a36b0-117">Simple objects</span></span>  
 <span data-ttu-id="a36b0-118">Windows Forms 使用 <xref:System.Windows.Forms.Binding> 類型，支援資料系結控制項屬性至物件實例上的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="a36b0-118">Windows Forms supports data binding control properties to public properties on the instance of an object using the <xref:System.Windows.Forms.Binding> type.</span></span> <span data-ttu-id="a36b0-119">Windows Forms 也支援系結清單型控制項，例如使用 <xref:System.Windows.Forms.BindingSource> 時，物件實例的 <xref:System.Windows.Forms.ListControl>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-119">Windows Forms also supports binding list based controls, such as a <xref:System.Windows.Forms.ListControl> to an object instance when a <xref:System.Windows.Forms.BindingSource> is used.</span></span>  
  
 <span data-ttu-id="a36b0-120">陣列或集合</span><span class="sxs-lookup"><span data-stu-id="a36b0-120">array or collection</span></span>  
 <span data-ttu-id="a36b0-121">若要作為資料來源，清單必須執行 <xref:System.Collections.IList> 介面;其中一個範例是 <xref:System.Array> 類別之實例的陣列。</span><span class="sxs-lookup"><span data-stu-id="a36b0-121">To act as a data source, a list must implement the <xref:System.Collections.IList> interface; one example would be an array that is an instance of the <xref:System.Array> class.</span></span> <span data-ttu-id="a36b0-122">如需陣列的詳細資訊，請參閱[如何：建立物件的陣列（Visual Basic）](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/487y7874(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="a36b0-122">For more information on arrays, see [How to: Create an Array of Objects (Visual Basic)](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/487y7874(v=vs.100)).</span></span>  
  
 <span data-ttu-id="a36b0-123">一般而言，當您建立資料系結的物件清單時，應該使用 <xref:System.ComponentModel.BindingList%601>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-123">In general, you should use <xref:System.ComponentModel.BindingList%601> when you create lists of objects for data binding.</span></span> <span data-ttu-id="a36b0-124"><xref:System.ComponentModel.BindingList%601> 是 <xref:System.ComponentModel.IBindingList> 介面的泛型版本。</span><span class="sxs-lookup"><span data-stu-id="a36b0-124"><xref:System.ComponentModel.BindingList%601> is a generic version of the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="a36b0-125"><xref:System.ComponentModel.IBindingList> 介面會藉由加入雙向資料系結所需的屬性、方法和事件來擴充 <xref:System.Collections.IList> 介面。</span><span class="sxs-lookup"><span data-stu-id="a36b0-125">The <xref:System.ComponentModel.IBindingList> interface extends the <xref:System.Collections.IList> interface by adding properties, methods and events necessary for two-way data binding.</span></span>  
  
 <xref:System.Collections.IEnumerable>  
 <span data-ttu-id="a36b0-126">Windows Forms 控制項可以系結至僅支援 <xref:System.Collections.IEnumerable> 介面的資料來源（如果它們是透過 <xref:System.Windows.Forms.BindingSource> 元件所系結）。</span><span class="sxs-lookup"><span data-stu-id="a36b0-126">Windows Forms controls can be bound to data sources that only support the <xref:System.Collections.IEnumerable> interface if they are bound through a <xref:System.Windows.Forms.BindingSource> component.</span></span>  
  
 <span data-ttu-id="a36b0-127">ADO.NET 資料物件</span><span class="sxs-lookup"><span data-stu-id="a36b0-127">ADO.NET data objects</span></span>  
 <span data-ttu-id="a36b0-128">ADO.NET 提供了一些適用于系結至的資料結構。</span><span class="sxs-lookup"><span data-stu-id="a36b0-128">ADO.NET provides a number of data structures suitable for binding to.</span></span> <span data-ttu-id="a36b0-129">每個都有其複雜和複雜度的差異。</span><span class="sxs-lookup"><span data-stu-id="a36b0-129">Each varies in its sophistication and complexity.</span></span>  
  
- <span data-ttu-id="a36b0-130"><xref:System.Data.DataColumn>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-130"><xref:System.Data.DataColumn>.</span></span> <span data-ttu-id="a36b0-131"><xref:System.Data.DataColumn> 是 <xref:System.Data.DataTable>的基本建立區塊，其中有一些資料行組成資料表。</span><span class="sxs-lookup"><span data-stu-id="a36b0-131">A <xref:System.Data.DataColumn> is the essential building block of a <xref:System.Data.DataTable>, in that a number of columns comprise a table.</span></span> <span data-ttu-id="a36b0-132">每個 <xref:System.Data.DataColumn> 都有一個 <xref:System.Data.DataColumn.DataType%2A> 屬性，可決定資料行所保留的資料類型（例如，在描述汽車的資料表中建立汽車）。</span><span class="sxs-lookup"><span data-stu-id="a36b0-132">Each <xref:System.Data.DataColumn> has a <xref:System.Data.DataColumn.DataType%2A> property that determines the kind of data the column holds (for example, the make of an automobile in a table describing cars).</span></span> <span data-ttu-id="a36b0-133">您可以簡單地將控制項（例如 <xref:System.Windows.Forms.TextBox> 控制項的 <xref:System.Windows.Forms.Control.Text%2A> 屬性）系結至資料表中的資料行。</span><span class="sxs-lookup"><span data-stu-id="a36b0-133">You can simple-bind a control (such as a <xref:System.Windows.Forms.TextBox> control's <xref:System.Windows.Forms.Control.Text%2A> property) to a column within a data table.</span></span>  
  
- <span data-ttu-id="a36b0-134"><xref:System.Data.DataTable>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-134"><xref:System.Data.DataTable>.</span></span> <span data-ttu-id="a36b0-135"><xref:System.Data.DataTable> 是資料表的表示，其中包含資料列和資料行，在 ADO.NET 中。</span><span class="sxs-lookup"><span data-stu-id="a36b0-135">A <xref:System.Data.DataTable> is the representation of a table, with rows and columns, in ADO.NET.</span></span> <span data-ttu-id="a36b0-136">資料表包含兩個集合： <xref:System.Data.DataColumn>，代表給定資料表中的資料行（最終會決定可以輸入該資料表的資料類型），並 <xref:System.Data.DataRow>，代表給定資料表中的資料列。</span><span class="sxs-lookup"><span data-stu-id="a36b0-136">A data table contains two collections: <xref:System.Data.DataColumn>, representing the columns of data in a given table (which ultimately determine the kinds of data that can be entered into that table), and <xref:System.Data.DataRow>, representing the rows of data in a given table.</span></span> <span data-ttu-id="a36b0-137">您可以將控制項複雜地系結至資料表中包含的資訊（例如，將 <xref:System.Windows.Forms.DataGridView> 控制項系結至資料表）。</span><span class="sxs-lookup"><span data-stu-id="a36b0-137">You can complex-bind a control to the information contained in a data table (such as binding the <xref:System.Windows.Forms.DataGridView> control to a data table).</span></span> <span data-ttu-id="a36b0-138">不過，當您系結至 <xref:System.Data.DataTable>時，您實際上就是系結至資料表的預設 view。</span><span class="sxs-lookup"><span data-stu-id="a36b0-138">However, when you bind to a <xref:System.Data.DataTable>, you are a really binding to the table's default view.</span></span>  
  
- <span data-ttu-id="a36b0-139"><xref:System.Data.DataView>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-139"><xref:System.Data.DataView>.</span></span> <span data-ttu-id="a36b0-140"><xref:System.Data.DataView> 是單一資料表的自訂視圖，可以篩選或排序。</span><span class="sxs-lookup"><span data-stu-id="a36b0-140">A <xref:System.Data.DataView> is a customized view of a single data table that may be filtered or sorted.</span></span> <span data-ttu-id="a36b0-141">資料檢視是複雜繫結控制項所使用的「快照集」資料。</span><span class="sxs-lookup"><span data-stu-id="a36b0-141">A data view is the data "snapshot" used by complex-bound controls.</span></span> <span data-ttu-id="a36b0-142">您可以簡單地系結或複雜系結至資料檢視內的資料，但請注意，您會系結至資料的固定「圖片」，而不是「清除」的「更新資料來源」。</span><span class="sxs-lookup"><span data-stu-id="a36b0-142">You can simple-bind or complex-bind to the data within a data view, but be aware that you are binding to a fixed "picture" of the data rather than a clean, updating data source.</span></span>  
  
- <span data-ttu-id="a36b0-143"><xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-143"><xref:System.Data.DataSet>.</span></span> <span data-ttu-id="a36b0-144"><xref:System.Data.DataSet> 是資料庫中資料的資料表、關聯性和條件約束的集合。</span><span class="sxs-lookup"><span data-stu-id="a36b0-144">A <xref:System.Data.DataSet> is a collection of tables, relationships, and constraints of the data in a database.</span></span> <span data-ttu-id="a36b0-145">您可以簡單地系結或複雜系結至資料集內的資料，但請注意，您會系結至 <xref:System.Data.DataSet> 的預設 <xref:System.Data.DataViewManager> （請參閱下一個專案符號點）。</span><span class="sxs-lookup"><span data-stu-id="a36b0-145">You can simple-bind or complex-bind to the data within a dataset, but be aware that you are binding to the default <xref:System.Data.DataViewManager> for the <xref:System.Data.DataSet> (see the next bullet point).</span></span>  
  
- <span data-ttu-id="a36b0-146"><xref:System.Data.DataViewManager>。</span><span class="sxs-lookup"><span data-stu-id="a36b0-146"><xref:System.Data.DataViewManager>.</span></span> <span data-ttu-id="a36b0-147"><xref:System.Data.DataViewManager> 是整個 <xref:System.Data.DataSet>的自訂視圖，類似于 <xref:System.Data.DataView>，但包含關聯性。</span><span class="sxs-lookup"><span data-stu-id="a36b0-147">A <xref:System.Data.DataViewManager> is a customized view of the entire <xref:System.Data.DataSet>, analogous to a <xref:System.Data.DataView>, but with relations included.</span></span> <span data-ttu-id="a36b0-148">有了 <xref:System.Data.DataViewManager.DataViewSettings%2A> 集合，您可以針對 <xref:System.Data.DataViewManager> 對指定資料表具有的任何視圖，設定預設的篩選準則和排序選項。</span><span class="sxs-lookup"><span data-stu-id="a36b0-148">With a <xref:System.Data.DataViewManager.DataViewSettings%2A> collection, you can set default filters and sort options for any views that the <xref:System.Data.DataViewManager> has for a given table.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a36b0-149">請參閱</span><span class="sxs-lookup"><span data-stu-id="a36b0-149">See also</span></span>

- [<span data-ttu-id="a36b0-150">Windows Forms 資料繫結中的變更告知</span><span class="sxs-lookup"><span data-stu-id="a36b0-150">Change Notification in Windows Forms Data Binding</span></span>](change-notification-in-windows-forms-data-binding.md)
- [<span data-ttu-id="a36b0-151">資料繫結和 Windows Forms</span><span class="sxs-lookup"><span data-stu-id="a36b0-151">Data Binding and Windows Forms</span></span>](data-binding-and-windows-forms.md)
- [<span data-ttu-id="a36b0-152">Windows Forms 資料繫結</span><span class="sxs-lookup"><span data-stu-id="a36b0-152">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
