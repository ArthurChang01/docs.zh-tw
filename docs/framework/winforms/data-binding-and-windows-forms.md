---
title: 資料繫結和 Windows Form
ms.date: 03/30/2017
helpviewer_keywords:
- master-details lists
- data [Windows Forms], data binding
- reports [Windows Forms], Windows Forms
- lookup tables [Windows Forms], data binding
- data [Windows Forms], complex data binding
- data binding [Windows Forms], Windows Forms
- data [Windows Forms], simple data binding
- Windows Forms controls, data binding
- data-bound controls [Windows Forms], Windows Forms
ms.assetid: 419aac5e-819b-4aad-88b0-73a2f8c0bd27
ms.openlocfilehash: 240b68f901f819313fcae7aab0474abd5535c30d
ms.sourcegitcommit: c7a7e1468bf0fa7f7065de951d60dfc8d5ba89f5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/14/2019
ms.locfileid: "65592303"
---
# <a name="data-binding-and-windows-forms"></a><span data-ttu-id="3f351-102">資料繫結和 Windows Form</span><span class="sxs-lookup"><span data-stu-id="3f351-102">Data Binding and Windows Forms</span></span>
<span data-ttu-id="3f351-103">在 Windows Forms 中，您不只可以繫結至傳統的資料來源，也能繫結至幾乎任何包含資料的結構。</span><span class="sxs-lookup"><span data-stu-id="3f351-103">In Windows Forms, you can bind to not just traditional data sources, but also to almost any structure that contains data.</span></span> <span data-ttu-id="3f351-104">您可以繫結程序至執行階段計算、從檔案讀取，或衍生自其他控制項之值的值陣列。</span><span class="sxs-lookup"><span data-stu-id="3f351-104">You can bind to an array of values that you calculate at run time, read from a file, or derive from the values of other controls.</span></span>  
  
 <span data-ttu-id="3f351-105">此外，您也可以將任何控制項的任何屬性繫結至資料來源。</span><span class="sxs-lookup"><span data-stu-id="3f351-105">In addition, you can bind any property of any control to the data source.</span></span> <span data-ttu-id="3f351-106">在傳統資料繫結中，您通常將顯示屬性 — 例如 <xref:System.Windows.Forms.Control.Text%2A> 控制項的 <xref:System.Windows.Forms.TextBox> 屬性 — 繫結到資料來源。</span><span class="sxs-lookup"><span data-stu-id="3f351-106">In traditional data binding, you typically bind the display property—for example, the <xref:System.Windows.Forms.Control.Text%2A> property of a <xref:System.Windows.Forms.TextBox> control—to the data source.</span></span> <span data-ttu-id="3f351-107">使用.NET Framework 中，您也可以設定其他屬性，透過繫結的選擇。</span><span class="sxs-lookup"><span data-stu-id="3f351-107">With the .NET Framework, you also have the option of setting other properties through binding as well.</span></span> <span data-ttu-id="3f351-108">您可以使用繫結來執行下列工作：</span><span class="sxs-lookup"><span data-stu-id="3f351-108">You might use binding to perform the following tasks:</span></span>  
  
- <span data-ttu-id="3f351-109">設定影像控制項的圖形。</span><span class="sxs-lookup"><span data-stu-id="3f351-109">Setting the graphic of an image control.</span></span>  
  
- <span data-ttu-id="3f351-110">設定一或多個控制項的背景色彩。</span><span class="sxs-lookup"><span data-stu-id="3f351-110">Setting the background color of one or more controls.</span></span>  
  
- <span data-ttu-id="3f351-111">設定控制項的大小。</span><span class="sxs-lookup"><span data-stu-id="3f351-111">Setting the size of controls.</span></span>  
  
 <span data-ttu-id="3f351-112">基本上，資料繫結是在表單上自動設定任何控制項的任何執行階段可存取屬性的方法。</span><span class="sxs-lookup"><span data-stu-id="3f351-112">Essentially, data binding is an automatic way of setting any run-time accessible property of any control on a form.</span></span>  
  
## <a name="types-of-data-binding"></a><span data-ttu-id="3f351-113">資料繫結的類型</span><span class="sxs-lookup"><span data-stu-id="3f351-113">Types of Data Binding</span></span>  
 <span data-ttu-id="3f351-114">Windows Forms 可以利用兩種類型的資料繫結：簡單繫結和複雜繫結。</span><span class="sxs-lookup"><span data-stu-id="3f351-114">Windows Forms can take advantage of two types of data binding: simple binding and complex binding.</span></span> <span data-ttu-id="3f351-115">各有不同的優點。</span><span class="sxs-lookup"><span data-stu-id="3f351-115">Each offers different advantages.</span></span>  
  
|<span data-ttu-id="3f351-116">資料繫結的類型</span><span class="sxs-lookup"><span data-stu-id="3f351-116">Type of data binding</span></span>|<span data-ttu-id="3f351-117">描述</span><span class="sxs-lookup"><span data-stu-id="3f351-117">Description</span></span>|  
|--------------------------|-----------------|  
|<span data-ttu-id="3f351-118">簡單資料繫結</span><span class="sxs-lookup"><span data-stu-id="3f351-118">Simple data binding</span></span>|<span data-ttu-id="3f351-119">控制項繫結至單一資料項目的能力，例如資料集中資料表的資料行值。</span><span class="sxs-lookup"><span data-stu-id="3f351-119">The ability of a control to bind to a single data element, such as a value in a column in a dataset table.</span></span> <span data-ttu-id="3f351-120">這是一般適用於例如 <xref:System.Windows.Forms.TextBox> 控制項或 <xref:System.Windows.Forms.Label> 控制項等控制項的繫結類型，這些控制項通常只會顯示單一值。</span><span class="sxs-lookup"><span data-stu-id="3f351-120">This is the type of binding typical for controls such as a <xref:System.Windows.Forms.TextBox> control or <xref:System.Windows.Forms.Label> control, which are controls that typically only displays a single value.</span></span> <span data-ttu-id="3f351-121">事實上，控制項上的任何屬性都可以繫結至資料庫中的欄位。</span><span class="sxs-lookup"><span data-stu-id="3f351-121">In fact, any property on a control can be bound to a field in a database.</span></span> <span data-ttu-id="3f351-122">沒有這項功能在 Visual Studio 中的廣泛支援。</span><span class="sxs-lookup"><span data-stu-id="3f351-122">There is extensive support for this feature in Visual Studio.</span></span><br /><br /> <span data-ttu-id="3f351-123">如需詳細資訊，請參閱:</span><span class="sxs-lookup"><span data-stu-id="3f351-123">For more information, see:</span></span><br /><br /> <span data-ttu-id="3f351-124">-   [與資料繫結相關的介面](interfaces-related-to-data-binding.md)</span><span class="sxs-lookup"><span data-stu-id="3f351-124">-   [Interfaces Related to Data Binding](interfaces-related-to-data-binding.md)</span></span><br /><span data-ttu-id="3f351-125">-   [如何：瀏覽 Windows Form 中的資料](how-to-navigate-data-in-windows-forms.md)</span><span class="sxs-lookup"><span data-stu-id="3f351-125">-   [How to: Navigate Data in Windows Forms](how-to-navigate-data-in-windows-forms.md)</span></span><br /><span data-ttu-id="3f351-126">-   [如何：建立 Windows Form 上的簡單繫結控制項](how-to-create-a-simple-bound-control-on-a-windows-form.md)</span><span class="sxs-lookup"><span data-stu-id="3f351-126">-   [How to: Create a Simple-Bound Control on a Windows Form](how-to-create-a-simple-bound-control-on-a-windows-form.md)</span></span>|  
|<span data-ttu-id="3f351-127">複雜資料繫結</span><span class="sxs-lookup"><span data-stu-id="3f351-127">Complex data binding</span></span>|<span data-ttu-id="3f351-128">控制項繫結至一個以上資料項目的能力，在資料庫中通常會超過一筆記錄。</span><span class="sxs-lookup"><span data-stu-id="3f351-128">The ability of a control to bind to more than one data element, typically more than one record in a database.</span></span> <span data-ttu-id="3f351-129">複雜繫結也稱為清單架構繫結。</span><span class="sxs-lookup"><span data-stu-id="3f351-129">Complex binding is also called list-based binding.</span></span> <span data-ttu-id="3f351-130">支援複雜繫結的控制項範例有 <xref:System.Windows.Forms.DataGridView>、<xref:System.Windows.Forms.ListBox> 和 <xref:System.Windows.Forms.ComboBox> 控制項。</span><span class="sxs-lookup"><span data-stu-id="3f351-130">Examples of controls that support complex binding are the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.ListBox>, and <xref:System.Windows.Forms.ComboBox> controls.</span></span> <span data-ttu-id="3f351-131">如需複雜資料繫結的範例，請參閱[How to:將 Windows Form ComboBox 或 ListBox 控制項繫結至資料](./controls/how-to-bind-a-windows-forms-combobox-or-listbox-control-to-data.md)。</span><span class="sxs-lookup"><span data-stu-id="3f351-131">For an example of complex data binding, see [How to: Bind a Windows Forms ComboBox or ListBox Control to Data](./controls/how-to-bind-a-windows-forms-combobox-or-listbox-control-to-data.md).</span></span>|  
  
## <a name="bindingsource-component"></a><span data-ttu-id="3f351-132">BindingSource 元件</span><span class="sxs-lookup"><span data-stu-id="3f351-132">BindingSource Component</span></span>  
 <span data-ttu-id="3f351-133">為了簡化資料繫結，Windows Forms 可讓您將資料來源繫結至 <xref:System.Windows.Forms.BindingSource> 元件，然後將控制項繫結至 <xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="3f351-133">To simplify data binding, Windows Forms enables you to bind a data source to the <xref:System.Windows.Forms.BindingSource> component and then bind controls to the <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="3f351-134">您可以在簡單或複雜繫結案例中使用 <xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="3f351-134">You can use the <xref:System.Windows.Forms.BindingSource> in simple or complex binding scenarios.</span></span> <span data-ttu-id="3f351-135">在任一種情況下，<xref:System.Windows.Forms.BindingSource> 擔任了資料來源與繫結程序控制項之間的媒介，提供變更通知流通管理和其他服務。</span><span class="sxs-lookup"><span data-stu-id="3f351-135">In either case, the <xref:System.Windows.Forms.BindingSource> acts as an intermediary between the data source and bound controls providing change notification currency management and other services.</span></span>  
  
## <a name="common-scenarios-that-employ-data-binding"></a><span data-ttu-id="3f351-136">使用資料繫結的常見案例</span><span class="sxs-lookup"><span data-stu-id="3f351-136">Common Scenarios That Employ Data Binding</span></span>  
 <span data-ttu-id="3f351-137">幾乎所有商業應用程式都使用讀取自某種資料來源的資訊，通常是透過資料繫結。</span><span class="sxs-lookup"><span data-stu-id="3f351-137">Nearly every commercial application uses information read from data sources of one type or another, usually through data binding.</span></span> <span data-ttu-id="3f351-138">下列清單顯示一些最常見的案例，利用資料繫結作為資料展示和管理的方法。</span><span class="sxs-lookup"><span data-stu-id="3f351-138">The following list shows a few of the most common scenarios that utilize data binding as the method of data presentation and manipulation.</span></span>  
  
|<span data-ttu-id="3f351-139">情節</span><span class="sxs-lookup"><span data-stu-id="3f351-139">Scenario</span></span>|<span data-ttu-id="3f351-140">描述</span><span class="sxs-lookup"><span data-stu-id="3f351-140">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="3f351-141">報告</span><span class="sxs-lookup"><span data-stu-id="3f351-141">Reporting</span></span>|<span data-ttu-id="3f351-142">報表會提供有彈性的方式，以在書面文件中顯示和彙總資料。</span><span class="sxs-lookup"><span data-stu-id="3f351-142">Reports provide a flexible way for you to display and summarize your data in a printed document.</span></span> <span data-ttu-id="3f351-143">建立報表，將選取的資料來源內容列印至螢幕或印表機，是很常見的作法。</span><span class="sxs-lookup"><span data-stu-id="3f351-143">It is very common to create a report that prints selected contents of a data source either to the screen or to a printer.</span></span> <span data-ttu-id="3f351-144">常見的報表包含清單、發票和摘要。</span><span class="sxs-lookup"><span data-stu-id="3f351-144">Common reports include lists, invoices, and summaries.</span></span> <span data-ttu-id="3f351-145">項目通常會格式化成清單資料行，且將子項目組織在每個清單項目下，但您應該選擇最適合資料的版面配置。</span><span class="sxs-lookup"><span data-stu-id="3f351-145">Items are usually formatted into columns of lists, with sub-items organized under each list item, but you should choose the layout that best suits the data.</span></span>|  
|<span data-ttu-id="3f351-146">資料輸入</span><span class="sxs-lookup"><span data-stu-id="3f351-146">Data entry</span></span>|<span data-ttu-id="3f351-147">若要輸入大量相關資料，或提示使用者輸入資訊，常用的方式是透過資料輸入表單。</span><span class="sxs-lookup"><span data-stu-id="3f351-147">A common way to enter large amounts of related data or to prompt users for information is through a data entry form.</span></span> <span data-ttu-id="3f351-148">使用者可以輸入資訊，或使用文字方塊、選項按鈕、下拉式清單和核取方塊來選取選項。</span><span class="sxs-lookup"><span data-stu-id="3f351-148">Users can enter information or select choices using text boxes, option buttons, drop-down lists, and check boxes.</span></span> <span data-ttu-id="3f351-149">資訊便會送出並儲存在資料庫中，其結構是根據輸入的資訊。</span><span class="sxs-lookup"><span data-stu-id="3f351-149">Information is then submitted and stored in a database, whose structure is based on the information entered.</span></span>|  
|<span data-ttu-id="3f351-150">主從式關係</span><span class="sxs-lookup"><span data-stu-id="3f351-150">Master/detail relationship</span></span>|<span data-ttu-id="3f351-151">主從式應用程式是查看相關資料的一種格式。</span><span class="sxs-lookup"><span data-stu-id="3f351-151">A master/detail application is one format for looking at related data.</span></span> <span data-ttu-id="3f351-152">明確地說，有兩個具有相連關係的資料表 — 在一般的商業範例中，「客戶」資料表和「訂單」資料表，它們之間連結了客戶和個別訂單的關係。</span><span class="sxs-lookup"><span data-stu-id="3f351-152">Specifically, there are two tables of data with a relation connecting them—in the classic business example, a "Customers" table and an "Orders" table with a relationship between them linking customers and their respective orders.</span></span> <span data-ttu-id="3f351-153">如需有關建立主從式應用程式使用兩個 Windows Form<xref:System.Windows.Forms.DataGridView>控制項，請參閱[How to:建立主版/詳細表單使用兩個 Windows Form DataGridView 控制項](./controls/create-a-master-detail-form-using-two-datagridviews.md)</span><span class="sxs-lookup"><span data-stu-id="3f351-153">For more information about creating a master/detail application with two Windows Forms <xref:System.Windows.Forms.DataGridView> controls, see [How to: Create a Master/Detail Form Using Two Windows Forms DataGridView Controls](./controls/create-a-master-detail-form-using-two-datagridviews.md)</span></span>|  
|<span data-ttu-id="3f351-154">查閱資料表</span><span class="sxs-lookup"><span data-stu-id="3f351-154">Lookup Table</span></span>|<span data-ttu-id="3f351-155">另一個常見的資料展示/管理案例是資料表查閱。</span><span class="sxs-lookup"><span data-stu-id="3f351-155">Another common data presentation/manipulation scenario is the table lookup.</span></span> <span data-ttu-id="3f351-156">通常，在較大的資料顯示中，<xref:System.Windows.Forms.ComboBox> 控制項是用來顯示和管理資料。</span><span class="sxs-lookup"><span data-stu-id="3f351-156">Often, as part of a larger data display, a <xref:System.Windows.Forms.ComboBox> control is used to display and manipulate data.</span></span> <span data-ttu-id="3f351-157">關鍵在於 <xref:System.Windows.Forms.ComboBox> 控制項中顯示的資料與寫入資料庫的資料不同。</span><span class="sxs-lookup"><span data-stu-id="3f351-157">The key is that the data displayed in the <xref:System.Windows.Forms.ComboBox> control is different than the data written to the database.</span></span> <span data-ttu-id="3f351-158">例如，如果您有 <xref:System.Windows.Forms.ComboBox> 控制項，顯示可從雜貨店取得的項目，您可能會想看到產品的名稱 (麵包、牛奶、蛋)。</span><span class="sxs-lookup"><span data-stu-id="3f351-158">For example, if you have a <xref:System.Windows.Forms.ComboBox> control displaying the items available from a grocery store, you would probably like to see the names of the products (bread, milk, eggs).</span></span> <span data-ttu-id="3f351-159">不過，為了簡化資料庫中的資訊擷取以及資料庫的正規化，您可能會將特定訂單的特定項目資訊儲存為項目編號 (#501、#603 等)。</span><span class="sxs-lookup"><span data-stu-id="3f351-159">However, to ease information retrieval within the database and for database normalization, you would probably store the information for the specific items of a given order as item numbers (#501, #603, and so on).</span></span> <span data-ttu-id="3f351-160">因此，表單上 <xref:System.Windows.Forms.ComboBox> 控制項中的雜貨項目的「易記名稱」，與訂單中出現的相關項目編號，兩者之間有隱含的連接。</span><span class="sxs-lookup"><span data-stu-id="3f351-160">Thus, there is an implicit connection between the "friendly name" of the grocery item in the <xref:System.Windows.Forms.ComboBox> control on your form and the related item number that is present in an order.</span></span> <span data-ttu-id="3f351-161">這是資料表查閱的本質。</span><span class="sxs-lookup"><span data-stu-id="3f351-161">This is the essence of a table lookup.</span></span> <span data-ttu-id="3f351-162">如需詳細資訊，請參閱[如何：使用 Windows Forms BindingSource 元件建立查閱資料表](./controls/how-to-create-a-lookup-table-with-the-windows-forms-bindingsource-component.md)。</span><span class="sxs-lookup"><span data-stu-id="3f351-162">For more information, see [How to: Create a Lookup Table with the Windows Forms BindingSource Component](./controls/how-to-create-a-lookup-table-with-the-windows-forms-bindingsource-component.md).</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="3f351-163">另請參閱</span><span class="sxs-lookup"><span data-stu-id="3f351-163">See also</span></span>

- <xref:System.Windows.Forms.Binding>
- [<span data-ttu-id="3f351-164">Windows Forms 資料繫結</span><span class="sxs-lookup"><span data-stu-id="3f351-164">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
- [<span data-ttu-id="3f351-165">如何：將 Windows Forms DataGrid 控制項繫結至資料來源</span><span class="sxs-lookup"><span data-stu-id="3f351-165">How to: Bind the Windows Forms DataGrid Control to a Data Source</span></span>](./controls/how-to-bind-the-windows-forms-datagrid-control-to-a-data-source.md)
- [<span data-ttu-id="3f351-166">BindingSource 元件</span><span class="sxs-lookup"><span data-stu-id="3f351-166">BindingSource Component</span></span>](./controls/bindingsource-component.md)
