---
title: 與資料繫結相關的介面
ms.date: 03/30/2017
helpviewer_keywords:
- data [Windows Forms], data-binding interfaces
- INotifyPropertyChanged interface
- IBindingListView interface
- IList interface [Windows Forms], Windows Forms data binding
- IBindingList interface [Windows Forms], Windows Forms data binding
- interfaces [Windows Forms], Windows Forms data binding
- IEditableObject interface [Windows Forms], Windows Forms data binding
- data binding [Windows Forms], interfaces
- IDataErrorInfo interface [Windows Forms], Windows Forms data binding
ms.assetid: 14e49a2e-3e46-47ca-b491-70d546333277
ms.openlocfilehash: ffda85b2704212ea5323117447e0cfe17ffb33db
ms.sourcegitcommit: 5b6d778ebb269ee6684fb57ad69a8c28b06235b9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/08/2019
ms.locfileid: "59226951"
---
# <a name="interfaces-related-to-data-binding"></a><span data-ttu-id="21ed3-102">與資料繫結相關的介面</span><span class="sxs-lookup"><span data-stu-id="21ed3-102">Interfaces Related to Data Binding</span></span>
<span data-ttu-id="21ed3-103">透過 [!INCLUDE[vstecado](../../../includes/vstecado-md.md)]，您可以建立許多不同的資料結構，以滿足您正在使用之應用程式和資料的繫結需求。</span><span class="sxs-lookup"><span data-stu-id="21ed3-103">With [!INCLUDE[vstecado](../../../includes/vstecado-md.md)], you can create many different data structures to suit the binding needs of your application and the data you are working with.</span></span> <span data-ttu-id="21ed3-104">您或許會想要建立自有類別以在 Windows Forms 中提供或取用資料。</span><span class="sxs-lookup"><span data-stu-id="21ed3-104">You may want to create your own classes that provide or consume data in Windows Forms.</span></span> <span data-ttu-id="21ed3-105">這些物件可以提供不同程度的功能和複雜度，從基本的資料繫結，到提供設計階段支援、錯誤檢查、變更通知，或甚至對資料本身所做變更的結構化回復支援。</span><span class="sxs-lookup"><span data-stu-id="21ed3-105">These objects can offer varying levels of functionality and complexity, from basic data binding, to providing design-time support, error checking, change notification, or even support for a structured rollback of the changes made to the data itself.</span></span>  
  
## <a name="consumers-of-data-binding-interfaces"></a><span data-ttu-id="21ed3-106">資料繫結介面的取用者</span><span class="sxs-lookup"><span data-stu-id="21ed3-106">Consumers of Data-Binding Interfaces</span></span>  
 <span data-ttu-id="21ed3-107">下列幾節會說明兩個群組的介面物件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-107">Following sections describe two groups of interface objects.</span></span> <span data-ttu-id="21ed3-108">第一個群組所列出的介面會由資料來源作者實作到資料來源上。</span><span class="sxs-lookup"><span data-stu-id="21ed3-108">The first group lists interfaces that are implemented on data sources by data source authors.</span></span> <span data-ttu-id="21ed3-109">這些介面是設計來供資料來源取用者取用，而在大部分情況下，這些取用者就是 Windows Forms 控制項或元件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-109">These interfaces are designed to be consumed by data source consumers, which are in most cases Windows Forms controls or components.</span></span> <span data-ttu-id="21ed3-110">第二個群組所列出的介面則是設計來供元件作者使用。</span><span class="sxs-lookup"><span data-stu-id="21ed3-110">The second group lists interfaces designed for use by component authors.</span></span> <span data-ttu-id="21ed3-111">元件作者在建立可支援資料繫結的元件以供 Windows Forms 資料繫結引擎取用時，就會使用這些介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-111">Component authors use these interfaces when they are creating a component that supports data binding to be consumed by the Windows Forms data-binding engine.</span></span> <span data-ttu-id="21ed3-112">您可以在與表單相關聯的類別內實作這些介面，以啟用資料繫結；下列每個案例都會提出一個類別，該類別會實作可與資料互動的介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-112">You can implement these interfaces within classes associated with your form to enable data binding; each case presents a class that implements an interface that enables interaction with data.</span></span> <span data-ttu-id="21ed3-113">Visual Studio 的快速應用程式開發 (RAD) 的資料設計體驗工具已利用這項功能。</span><span class="sxs-lookup"><span data-stu-id="21ed3-113">Visual Studio rapid application development (RAD) data design experience tools already take advantage of this functionality.</span></span>  
  
### <a name="interfaces-for-implementation-by-data-source-authors"></a><span data-ttu-id="21ed3-114">可供資料來源作者實作的介面</span><span class="sxs-lookup"><span data-stu-id="21ed3-114">Interfaces for Implementation by Data Source Authors</span></span>  
 <span data-ttu-id="21ed3-115">下列介面是設計來供 Windows Forms 控制項取用︰</span><span class="sxs-lookup"><span data-stu-id="21ed3-115">The following interfaces are designed to be consumed by Windows Forms controls:</span></span>  
  
-   <xref:System.Collections.IList> <span data-ttu-id="21ed3-116">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-116">interface</span></span>  
  
     <span data-ttu-id="21ed3-117">類別若實作<xref:System.Collections.IList>介面可能<xref:System.Array>， <xref:System.Collections.ArrayList>，或<xref:System.Collections.CollectionBase>。</span><span class="sxs-lookup"><span data-stu-id="21ed3-117">A class that implements the <xref:System.Collections.IList> interface could be an <xref:System.Array>, <xref:System.Collections.ArrayList>, or <xref:System.Collections.CollectionBase>.</span></span> <span data-ttu-id="21ed3-118">這些是型別項目的索引的清單<xref:System.Object>。</span><span class="sxs-lookup"><span data-stu-id="21ed3-118">These are indexed lists of items of type <xref:System.Object>.</span></span> <span data-ttu-id="21ed3-119">這些清單必須包含同質型別，因為此索引的第一個項目會決定其型別。</span><span class="sxs-lookup"><span data-stu-id="21ed3-119">These lists must contain homogenous types, because the first item of the index determines the type.</span></span> <xref:System.Collections.IList> <span data-ttu-id="21ed3-120">會在適用於只能在執行階段的繫結。</span><span class="sxs-lookup"><span data-stu-id="21ed3-120">would be available for binding only at run time.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-121">如果您想要使用 Windows Form 建立商務物件繫結的清單，您應該考慮使用<xref:System.ComponentModel.BindingList%601>。</span><span class="sxs-lookup"><span data-stu-id="21ed3-121">If you want to create a list of business objects for binding with Windows Forms, you should consider using the <xref:System.ComponentModel.BindingList%601>.</span></span> <span data-ttu-id="21ed3-122"><xref:System.ComponentModel.BindingList%601>是一個可延伸的類別，實作雙向 Windows Form 資料繫結所需的主要介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-122">The <xref:System.ComponentModel.BindingList%601> is an extensible class that implements the primary interfaces required for two-way Windows Forms data binding.</span></span>  
  
-   <xref:System.ComponentModel.IBindingList> <span data-ttu-id="21ed3-123">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-123">interface</span></span>  
  
     <span data-ttu-id="21ed3-124">類別若實作<xref:System.ComponentModel.IBindingList>介面提供更高層級的資料繫結功能。</span><span class="sxs-lookup"><span data-stu-id="21ed3-124">A class that implements the <xref:System.ComponentModel.IBindingList> interface provides a much higher level of data-binding functionality.</span></span> <span data-ttu-id="21ed3-125">此實作可提供您基本的排序功能和變更通知，讓您在清單項目變更時 (例如，客戶清單的第三個項目變更了 [位址] 欄位) 以及在清單本身變更時 (例如，清單的項目數增加或減少) 使用。</span><span class="sxs-lookup"><span data-stu-id="21ed3-125">This implementation offers you basic sorting capabilities and change notification, both for when the list items change (for example, the third item in a list of customers has a change to the Address field), as well as when the list itself changes (for example, the number of items in the list increases or decreases).</span></span> <span data-ttu-id="21ed3-126">如果您打算讓多個控制項繫結至相同資料，並想要讓其中一個控制項的資料變更傳播到其他繫結控制項，變更通知就很重要。</span><span class="sxs-lookup"><span data-stu-id="21ed3-126">Change notification is important if you plan to have multiple controls bound to the same data, and you want data changes made in one of the controls to propagate to the other bound controls.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-127">已啟用變更通知<xref:System.ComponentModel.IBindingList>透過介面<xref:System.ComponentModel.IBindingList.SupportsChangeNotification%2A>屬性的當`true`，會引發<xref:System.ComponentModel.IBindingList.ListChanged>變更事件，表示清單已變更或清單中的項目。</span><span class="sxs-lookup"><span data-stu-id="21ed3-127">Change notification is enabled for the <xref:System.ComponentModel.IBindingList> interface through the <xref:System.ComponentModel.IBindingList.SupportsChangeNotification%2A> property which, when `true`, raises a <xref:System.ComponentModel.IBindingList.ListChanged> event, indicating the list changed or an item in the list changed.</span></span>  
  
     <span data-ttu-id="21ed3-128">所描述的變更類型<xref:System.ComponentModel.ListChangedType>屬性<xref:System.ComponentModel.ListChangedEventArgs>參數。</span><span class="sxs-lookup"><span data-stu-id="21ed3-128">The type of change is described by the <xref:System.ComponentModel.ListChangedType> property of the <xref:System.ComponentModel.ListChangedEventArgs> parameter.</span></span> <span data-ttu-id="21ed3-129">因此，每當資料模型更新時，所有相依的檢視 (例如其他繫結至相同資料來源的控制項) 也會隨之更新。</span><span class="sxs-lookup"><span data-stu-id="21ed3-129">Hence, whenever the data model is updated, any dependent views, such as other controls bound to the same data source, will also be updated.</span></span> <span data-ttu-id="21ed3-130">不過，在清單中包含的物件會有變更，因此，清單才能引發時，通知清單<xref:System.ComponentModel.IBindingList.ListChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-130">However, objects contained within the list will have to notify the list when they change so that the list can raise the <xref:System.ComponentModel.IBindingList.ListChanged> event.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-131"><xref:System.ComponentModel.BindingList%601>提供的泛型實作<xref:System.ComponentModel.IBindingList>介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-131">The <xref:System.ComponentModel.BindingList%601> provides a generic implementation of the <xref:System.ComponentModel.IBindingList> interface.</span></span>  
  
-   <xref:System.ComponentModel.IBindingListView> <span data-ttu-id="21ed3-132">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-132">interface</span></span>  
  
     <span data-ttu-id="21ed3-133">類別若實作<xref:System.ComponentModel.IBindingListView>介面提供的實作的所有功能<xref:System.ComponentModel.IBindingList>，以及篩選和進階排序功能。</span><span class="sxs-lookup"><span data-stu-id="21ed3-133">A class that implements the <xref:System.ComponentModel.IBindingListView> interface provides all the functionality of an implementation of <xref:System.ComponentModel.IBindingList>, as well as filtering and advanced sorting functionality.</span></span> <span data-ttu-id="21ed3-134">此實作可提供以字串為基礎的篩選功能，以及利用屬性描述元與方向配對來進行的多欄排序功能。</span><span class="sxs-lookup"><span data-stu-id="21ed3-134">This implementation offers string-based filtering, and multicolumn sorting with property descriptor-direction pairs.</span></span>  
  
-   <xref:System.ComponentModel.IEditableObject> <span data-ttu-id="21ed3-135">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-135">interface</span></span>  
  
     <span data-ttu-id="21ed3-136">類別若實作<xref:System.ComponentModel.IEditableObject>介面可讓要控制何時進行永久變更該物件的物件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-136">A class that implements the <xref:System.ComponentModel.IEditableObject> interface allows an object to control when changes to that object are made permanent.</span></span> <span data-ttu-id="21ed3-137">這個實作可提供您<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>， <xref:System.ComponentModel.IEditableObject.EndEdit%2A>，和<xref:System.ComponentModel.IEditableObject.CancelEdit%2A>方法，可讓您回復物件所做的變更。</span><span class="sxs-lookup"><span data-stu-id="21ed3-137">This implementation affords you the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>, and <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> methods, which enable you to roll back changes made to the object.</span></span> <span data-ttu-id="21ed3-138">以下是簡短說明的運作<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>， <xref:System.ComponentModel.IEditableObject.EndEdit%2A>，和<xref:System.ComponentModel.IEditableObject.CancelEdit%2A>方法，以及它們如何搭配另一個啟用得以復原您的資料所做的變更：</span><span class="sxs-lookup"><span data-stu-id="21ed3-138">Following is a brief explanation of the functioning of the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>, and <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> methods and how they work in conjunction with one another to enable a possible rollback of changes made to the data:</span></span>  
  
    -   <span data-ttu-id="21ed3-139"><xref:System.ComponentModel.IEditableObject.BeginEdit%2A>方法表示的物件上開始編輯。</span><span class="sxs-lookup"><span data-stu-id="21ed3-139">The <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> method signals the start of an edit on an object.</span></span> <span data-ttu-id="21ed3-140">實作此介面的物件必須儲存所有更新後,<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>方法呼叫的方式，可捨棄更新如果<xref:System.ComponentModel.IEditableObject.CancelEdit%2A>呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="21ed3-140">An object that implements this interface will need to store any updates after the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> method call in such a way that the updates can be discarded if the <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> method is called.</span></span> <span data-ttu-id="21ed3-141">在資料繫結 Windows Form 中，您可以呼叫<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>多個時間範圍內的單一編輯交易 (例如<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>， <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>， <xref:System.ComponentModel.IEditableObject.EndEdit%2A>)。</span><span class="sxs-lookup"><span data-stu-id="21ed3-141">In data binding Windows Forms, you can call <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> multiple times within the scope of a single edit transaction (for example, <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>).</span></span> <span data-ttu-id="21ed3-142">實作<xref:System.ComponentModel.IEditableObject>應該追蹤是否<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>已經呼叫，並忽略後續呼叫<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>。</span><span class="sxs-lookup"><span data-stu-id="21ed3-142">Implementations of <xref:System.ComponentModel.IEditableObject> should keep track of whether <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> has already been called and ignore subsequent calls to <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>.</span></span> <span data-ttu-id="21ed3-143">因為可以多次呼叫這個方法，是很重要的後續呼叫是破壞性;也就是說，後續<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>呼叫不能終結已進行，或變更已儲存的資料更新第一天<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>呼叫。</span><span class="sxs-lookup"><span data-stu-id="21ed3-143">Because this method can be called multiple times, it is important that subsequent calls to it are nondestructive; that is, subsequent <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> calls cannot destroy the updates that have been made or change the data that was saved on the first <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> call.</span></span>  
  
    -   <span data-ttu-id="21ed3-144"><xref:System.ComponentModel.IEditableObject.EndEdit%2A>方法會將推入的任何變更<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>呼叫到基礎物件，如果物件目前處於編輯模式。</span><span class="sxs-lookup"><span data-stu-id="21ed3-144">The <xref:System.ComponentModel.IEditableObject.EndEdit%2A> method pushes any changes since <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> was called into the underlying object, if the object is currently in edit mode.</span></span>  
  
    -   <span data-ttu-id="21ed3-145"><xref:System.ComponentModel.IEditableObject.CancelEdit%2A>方法會捨棄任何物件所做的變更。</span><span class="sxs-lookup"><span data-stu-id="21ed3-145">The <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> method discards any changes made to the object.</span></span>  
  
     <span data-ttu-id="21ed3-146">如需有關如何<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>， <xref:System.ComponentModel.IEditableObject.EndEdit%2A>，並<xref:System.ComponentModel.IEditableObject.CancelEdit%2A>方法運作，請參閱[將資料儲存回資料庫](/visualstudio/data-tools/save-data-back-to-the-database)。</span><span class="sxs-lookup"><span data-stu-id="21ed3-146">For more information about how the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>, and <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> methods work, see [Save data back to the database](/visualstudio/data-tools/save-data-back-to-the-database).</span></span>  
  
     <span data-ttu-id="21ed3-147">資料功能的這個交易性概念由<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="21ed3-147">This transactional notion of data functionality is used by the <xref:System.Windows.Forms.DataGridView> control.</span></span>  
  
-   <xref:System.ComponentModel.ICancelAddNew> <span data-ttu-id="21ed3-148">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-148">interface</span></span>  
  
     <span data-ttu-id="21ed3-149">類別若實作<xref:System.ComponentModel.ICancelAddNew>通常會實作介面<xref:System.ComponentModel.IBindingList>介面，並可讓您回復所進行的資料來源<xref:System.ComponentModel.IBindingList.AddNew%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="21ed3-149">A class that implements the <xref:System.ComponentModel.ICancelAddNew> interface usually implements the <xref:System.ComponentModel.IBindingList> interface and allows you to roll back an addition made to the data source with the <xref:System.ComponentModel.IBindingList.AddNew%2A> method.</span></span> <span data-ttu-id="21ed3-150">如果您的資料來源會實作<xref:System.ComponentModel.IBindingList>介面，您應該讓它也實作<xref:System.ComponentModel.ICancelAddNew>介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-150">If your data source implements the <xref:System.ComponentModel.IBindingList> interface, you should also have it implement the <xref:System.ComponentModel.ICancelAddNew> interface.</span></span>  
  
-   <xref:System.ComponentModel.IDataErrorInfo> <span data-ttu-id="21ed3-151">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-151">interface</span></span>  
  
     <span data-ttu-id="21ed3-152">類別若實作<xref:System.ComponentModel.IDataErrorInfo>介面可讓物件能夠繫結控制項的自訂錯誤資訊：</span><span class="sxs-lookup"><span data-stu-id="21ed3-152">A class that implements the <xref:System.ComponentModel.IDataErrorInfo> interface allows objects to offer custom error information to bound controls:</span></span>  
  
    -   <span data-ttu-id="21ed3-153"><xref:System.ComponentModel.IDataErrorInfo.Error%2A>屬性會傳回一般錯誤訊息文字 （例如，「 已發生錯誤 」）。</span><span class="sxs-lookup"><span data-stu-id="21ed3-153">The <xref:System.ComponentModel.IDataErrorInfo.Error%2A> property returns general error message text (for example, "An error has occurred").</span></span>  
  
    -   <span data-ttu-id="21ed3-154"><xref:System.ComponentModel.IDataErrorInfo.Item%2A>屬性會傳回含有特定的錯誤訊息的字串資料行 (例如，"中的值`State`資料行無效 」)。</span><span class="sxs-lookup"><span data-stu-id="21ed3-154">The <xref:System.ComponentModel.IDataErrorInfo.Item%2A> property returns a string with the specific error message from the column (for example, "The value in the `State` column is invalid").</span></span>  
  
-   <xref:System.Collections.IEnumerable> <span data-ttu-id="21ed3-155">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-155">interface</span></span>  
  
     <span data-ttu-id="21ed3-156">類別若實作<xref:System.Collections.IEnumerable>介面通常由[!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="21ed3-156">A class that implements the <xref:System.Collections.IEnumerable> interface is typically consumed by [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)].</span></span> <span data-ttu-id="21ed3-157">此介面的 Windows Form 支援僅可透過<xref:System.Windows.Forms.BindingSource>元件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-157">Windows Forms support for this interface is only available through the <xref:System.Windows.Forms.BindingSource> component.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-158"><xref:System.Windows.Forms.BindingSource>元件會複製所有<xref:System.Collections.IEnumerable>到不同的清單，供繫結使用的項目。</span><span class="sxs-lookup"><span data-stu-id="21ed3-158">The <xref:System.Windows.Forms.BindingSource> component copies all <xref:System.Collections.IEnumerable> items into a separate list for binding purposes.</span></span>  
  
-   <xref:System.ComponentModel.ITypedList> <span data-ttu-id="21ed3-159">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-159">interface</span></span>  
  
     <span data-ttu-id="21ed3-160">集合類別若實作<xref:System.ComponentModel.ITypedList>介面讓您能夠控制的順序，以及一組屬性公開至繫結的控制項。</span><span class="sxs-lookup"><span data-stu-id="21ed3-160">A collections class that implements the <xref:System.ComponentModel.ITypedList> interface provides the ability to control the order and the set of properties exposed to the bound control.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-161">當您實作<xref:System.ComponentModel.ITypedList.GetItemProperties%2A>方法，而<xref:System.ComponentModel.PropertyDescriptor>陣列不是 null，在陣列中的最後一個項目會描述已是另一個項目清單的清單屬性的屬性描述元。</span><span class="sxs-lookup"><span data-stu-id="21ed3-161">When you implement the <xref:System.ComponentModel.ITypedList.GetItemProperties%2A> method, and the <xref:System.ComponentModel.PropertyDescriptor> array is not null, the last entry in the array will be the property descriptor that describes the list property that is another list of items.</span></span>  
  
-   <xref:System.ComponentModel.ICustomTypeDescriptor> <span data-ttu-id="21ed3-162">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-162">interface</span></span>  
  
     <span data-ttu-id="21ed3-163">類別若實作<xref:System.ComponentModel.ICustomTypeDescriptor>介面會提供有關本身的動態資訊。</span><span class="sxs-lookup"><span data-stu-id="21ed3-163">A class that implements the <xref:System.ComponentModel.ICustomTypeDescriptor> interface provides dynamic information about itself.</span></span> <span data-ttu-id="21ed3-164">這個介面是類似於<xref:System.ComponentModel.ITypedList>，但用於物件，而不是清單。</span><span class="sxs-lookup"><span data-stu-id="21ed3-164">This interface is similar to <xref:System.ComponentModel.ITypedList> but is used for objects rather than lists.</span></span> <span data-ttu-id="21ed3-165">這個介面由<xref:System.Data.DataRowView>投影基礎資料列的結構描述。</span><span class="sxs-lookup"><span data-stu-id="21ed3-165">This interface is used by <xref:System.Data.DataRowView> to project the schema of the underlying rows.</span></span> <span data-ttu-id="21ed3-166">簡單實作<xref:System.ComponentModel.ICustomTypeDescriptor>係由<xref:System.ComponentModel.CustomTypeDescriptor>類別。</span><span class="sxs-lookup"><span data-stu-id="21ed3-166">A simple implementation of <xref:System.ComponentModel.ICustomTypeDescriptor> is provided by the <xref:System.ComponentModel.CustomTypeDescriptor> class.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-167">若要支援設計階段繫結至型別都會實作<xref:System.ComponentModel.ICustomTypeDescriptor>，也必須實作的型別<xref:System.ComponentModel.IComponent>，做為表單上的執行個體存在。</span><span class="sxs-lookup"><span data-stu-id="21ed3-167">To support design-time binding to types that implement <xref:System.ComponentModel.ICustomTypeDescriptor>, the type must also implement <xref:System.ComponentModel.IComponent> and exist as an instance on the Form.</span></span>  
  
-   <xref:System.ComponentModel.IListSource> <span data-ttu-id="21ed3-168">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-168">interface</span></span>  
  
     <span data-ttu-id="21ed3-169">類別若實作<xref:System.ComponentModel.IListSource>介面可讓非 list 物件上的清單架構繫結。</span><span class="sxs-lookup"><span data-stu-id="21ed3-169">A class that implements the <xref:System.ComponentModel.IListSource> interface enables list-based binding on non-list objects.</span></span> <span data-ttu-id="21ed3-170"><xref:System.ComponentModel.IListSource.GetList%2A>方法<xref:System.ComponentModel.IListSource>用來傳回可繫結的清單，從並非繼承自物件<xref:System.Collections.IList>。</span><span class="sxs-lookup"><span data-stu-id="21ed3-170">The <xref:System.ComponentModel.IListSource.GetList%2A> method of <xref:System.ComponentModel.IListSource> is used to return a bindable list from an object that does not inherit from <xref:System.Collections.IList>.</span></span> <xref:System.ComponentModel.IListSource> <span data-ttu-id="21ed3-171">會使用<xref:System.Data.DataSet>類別。</span><span class="sxs-lookup"><span data-stu-id="21ed3-171">is used by the <xref:System.Data.DataSet> class.</span></span>  
  
-   <xref:System.ComponentModel.IRaiseItemChangedEvents> <span data-ttu-id="21ed3-172">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-172">interface</span></span>  
  
     <span data-ttu-id="21ed3-173">類別若實作<xref:System.ComponentModel.IRaiseItemChangedEvents>介面是以可繫結的清單，也會實作<xref:System.ComponentModel.IBindingList>介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-173">A class that implements the <xref:System.ComponentModel.IRaiseItemChangedEvents> interface is a bindable list that also implements the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="21ed3-174">此介面用來指出您的型別是否引發<xref:System.ComponentModel.IBindingList.ListChanged>類型的事件<xref:System.ComponentModel.ListChangedType.ItemChanged>透過其<xref:System.ComponentModel.IRaiseItemChangedEvents.RaisesItemChangedEvents%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21ed3-174">This interface is used to indicate if your type raises <xref:System.ComponentModel.IBindingList.ListChanged> events of type <xref:System.ComponentModel.ListChangedType.ItemChanged> through its <xref:System.ComponentModel.IRaiseItemChangedEvents.RaisesItemChangedEvents%2A> property.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-175">您應該實作<xref:System.ComponentModel.IRaiseItemChangedEvents>如果您的資料來源提供的屬性至清單事件 」 轉換先前所述，而且正在與互動<xref:System.Windows.Forms.BindingSource>元件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-175">You should implement the <xref:System.ComponentModel.IRaiseItemChangedEvents> if your data source provides the property to list event conversion described previously and is interacting with the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="21ed3-176">否則，<xref:System.Windows.Forms.BindingSource>也會執行 「 屬性至清單事件 」 轉換導致效能變慢。</span><span class="sxs-lookup"><span data-stu-id="21ed3-176">Otherwise, the <xref:System.Windows.Forms.BindingSource> will also perform property to list event conversion resulting in slower performance.</span></span>  
  
-   <xref:System.ComponentModel.ISupportInitialize> <span data-ttu-id="21ed3-177">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-177">interface</span></span>  
  
     <span data-ttu-id="21ed3-178">元件若實作<xref:System.ComponentModel.ISupportInitialize>介面就會利用批次最佳化來設定屬性，並初始化共同相依的屬性。</span><span class="sxs-lookup"><span data-stu-id="21ed3-178">A component that implements the <xref:System.ComponentModel.ISupportInitialize> interface takes advantages of batch optimizations for setting properties and initializing co-dependent properties.</span></span> <span data-ttu-id="21ed3-179"><xref:System.ComponentModel.ISupportInitialize>包含兩個方法：</span><span class="sxs-lookup"><span data-stu-id="21ed3-179">The <xref:System.ComponentModel.ISupportInitialize> contains two methods:</span></span>  
  
    -   <xref:System.ComponentModel.ISupportInitialize.BeginInit%2A> <span data-ttu-id="21ed3-180">表示正在啟動該物件初始化。</span><span class="sxs-lookup"><span data-stu-id="21ed3-180">signals that object initialization is starting.</span></span>  
  
    -   <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> <span data-ttu-id="21ed3-181">表示已完成的物件初始設定。</span><span class="sxs-lookup"><span data-stu-id="21ed3-181">signals that object initialization is finishing.</span></span>  
  
-   <xref:System.ComponentModel.ISupportInitializeNotification> <span data-ttu-id="21ed3-182">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-182">interface</span></span>  
  
     <span data-ttu-id="21ed3-183">實作的元件<xref:System.ComponentModel.ISupportInitializeNotification>介面也會實作<xref:System.ComponentModel.ISupportInitialize>介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-183">A component that implements the <xref:System.ComponentModel.ISupportInitializeNotification> interface also implements the <xref:System.ComponentModel.ISupportInitialize> interface.</span></span> <span data-ttu-id="21ed3-184">此介面可讓您通知其他<xref:System.ComponentModel.ISupportInitialize>元件表示初始化已完成。</span><span class="sxs-lookup"><span data-stu-id="21ed3-184">This interface allows you to notify other <xref:System.ComponentModel.ISupportInitialize> components that initialization is complete.</span></span> <span data-ttu-id="21ed3-185"><xref:System.ComponentModel.ISupportInitializeNotification>介面包含兩個成員：</span><span class="sxs-lookup"><span data-stu-id="21ed3-185">The <xref:System.ComponentModel.ISupportInitializeNotification> interface contains two members:</span></span>  
  
    -   <xref:System.ComponentModel.ISupportInitializeNotification.IsInitialized%2A> <span data-ttu-id="21ed3-186">傳回`boolean`值，指出元件是否已初始化。</span><span class="sxs-lookup"><span data-stu-id="21ed3-186">returns a `boolean` value indicating whether the component is initialized.</span></span>  
  
    -   <xref:System.ComponentModel.ISupportInitializeNotification.Initialized> <span data-ttu-id="21ed3-187">發生時<xref:System.ComponentModel.ISupportInitialize.EndInit%2A>呼叫。</span><span class="sxs-lookup"><span data-stu-id="21ed3-187">occurs when <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> is called.</span></span>  
  
-   <xref:System.ComponentModel.INotifyPropertyChanged> <span data-ttu-id="21ed3-188">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-188">interface</span></span>  
  
     <span data-ttu-id="21ed3-189">類別若實作此介面，代表其所屬的型別會在其任何屬性值變更時引發事件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-189">A class that implements this interface is a type that raises an event when any of its property values change.</span></span> <span data-ttu-id="21ed3-190">對於會讓控制項的每個屬性有一個變更事件的模式，我們設計了此介面來加以取代。</span><span class="sxs-lookup"><span data-stu-id="21ed3-190">This interface is designed to replace the pattern of having a change event for each property of a control.</span></span> <span data-ttu-id="21ed3-191">在中使用時<xref:System.ComponentModel.BindingList%601>，應該實作的商務物件<xref:System.ComponentModel.INotifyPropertyChanged>介面，而且 BindingList\`1 會將轉換<xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged>事件<xref:System.ComponentModel.BindingList%601.ListChanged>型別事件<xref:System.ComponentModel.ListChangedType.ItemChanged>。</span><span class="sxs-lookup"><span data-stu-id="21ed3-191">When used in a <xref:System.ComponentModel.BindingList%601>, a business object should implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface and the BindingList\`1 will convert <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> events to <xref:System.ComponentModel.BindingList%601.ListChanged> events of type <xref:System.ComponentModel.ListChangedType.ItemChanged>.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-192">變更通知，以在繫結的用戶端和資料之間的繫結來源繫結的資料來源類型應該實作<xref:System.ComponentModel.INotifyPropertyChanged>介面 （慣用） 或您可以提供*propertyName* `Changed`事件繫結的型別，但您不應該進行這兩項。</span><span class="sxs-lookup"><span data-stu-id="21ed3-192">For change notification to occur in a binding between a bound client and a data source your bound data-source type should either implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface (preferred) or you can provide *propertyName*`Changed` events for the bound type, but you shouldn't do both.</span></span>  
  
### <a name="interfaces-for-implementation-by-component-authors"></a><span data-ttu-id="21ed3-193">可供元件作者實作的介面</span><span class="sxs-lookup"><span data-stu-id="21ed3-193">Interfaces for Implementation by Component Authors</span></span>  
 <span data-ttu-id="21ed3-194">下列介面是設計來供 Windows Forms 資料繫結引擎取用︰</span><span class="sxs-lookup"><span data-stu-id="21ed3-194">The following interfaces are designed for consumption by the Windows Forms data-binding engine:</span></span>  
  
-   <xref:System.Windows.Forms.IBindableComponent> <span data-ttu-id="21ed3-195">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-195">interface</span></span>  
  
     <span data-ttu-id="21ed3-196">類別若實作此介面，就是可支援資料繫結的非控制項元件。</span><span class="sxs-lookup"><span data-stu-id="21ed3-196">A class that implements this interface is a non-control component that supports data binding.</span></span> <span data-ttu-id="21ed3-197">這個類別會傳回的資料繫結和繫結內容的元件，透過<xref:System.Windows.Forms.IBindableComponent.DataBindings%2A>和<xref:System.Windows.Forms.IBindableComponent.BindingContext%2A>此介面的屬性。</span><span class="sxs-lookup"><span data-stu-id="21ed3-197">This class returns the data bindings and binding context of the component through the <xref:System.Windows.Forms.IBindableComponent.DataBindings%2A> and <xref:System.Windows.Forms.IBindableComponent.BindingContext%2A> properties of this interface.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-198">如果您的元件繼承自<xref:System.Windows.Forms.Control>，您不需要實作<xref:System.Windows.Forms.IBindableComponent>介面。</span><span class="sxs-lookup"><span data-stu-id="21ed3-198">If your component inherits from <xref:System.Windows.Forms.Control>, you do not need to implement the <xref:System.Windows.Forms.IBindableComponent> interface.</span></span>  
  
-   <xref:System.Windows.Forms.ICurrencyManagerProvider> <span data-ttu-id="21ed3-199">interface</span><span class="sxs-lookup"><span data-stu-id="21ed3-199">interface</span></span>  
  
     <span data-ttu-id="21ed3-200">類別若實作<xref:System.Windows.Forms.ICurrencyManagerProvider>介面是一個元件，提供它自己<xref:System.Windows.Forms.CurrencyManager>來管理這個特定元件相關聯的繫結。</span><span class="sxs-lookup"><span data-stu-id="21ed3-200">A class that implements the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface is a component that provides its own <xref:System.Windows.Forms.CurrencyManager> to manage the bindings associated with this particular component.</span></span> <span data-ttu-id="21ed3-201">存取自訂<xref:System.Windows.Forms.CurrencyManager>係由<xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="21ed3-201">Access to the custom <xref:System.Windows.Forms.CurrencyManager> is provided by the <xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> property.</span></span>  
  
    > [!NOTE]
    >  <span data-ttu-id="21ed3-202">類別繼承自<xref:System.Windows.Forms.Control>管理繫結會自動透過其<xref:System.Windows.Forms.Control.BindingContext%2A>屬性，因此您需要實作的情況下<xref:System.Windows.Forms.ICurrencyManagerProvider>很少見。</span><span class="sxs-lookup"><span data-stu-id="21ed3-202">A class that inherits from <xref:System.Windows.Forms.Control> manages bindings automatically through its <xref:System.Windows.Forms.Control.BindingContext%2A> property, so cases in which you need to implement the <xref:System.Windows.Forms.ICurrencyManagerProvider> are fairly rare.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="21ed3-203">另請參閱</span><span class="sxs-lookup"><span data-stu-id="21ed3-203">See also</span></span>

- [<span data-ttu-id="21ed3-204">資料繫結和 Windows Form</span><span class="sxs-lookup"><span data-stu-id="21ed3-204">Data Binding and Windows Forms</span></span>](data-binding-and-windows-forms.md)
- [<span data-ttu-id="21ed3-205">HOW TO：在 Windows Form 上建立簡單繫結控制項</span><span class="sxs-lookup"><span data-stu-id="21ed3-205">How to: Create a Simple-Bound Control on a Windows Form</span></span>](how-to-create-a-simple-bound-control-on-a-windows-form.md)
- [<span data-ttu-id="21ed3-206">Windows Form 資料繫結</span><span class="sxs-lookup"><span data-stu-id="21ed3-206">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
