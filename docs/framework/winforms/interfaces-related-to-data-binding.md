---
title: 與資料繫結相關的介面
ms.date: 03/30/2017
helpviewer_keywords:
- data [Windows Forms], data-binding interfaces
- INotifyPropertyChanged interface
- IBindingListView interface
- IList interface [Windows Forms], Windows Forms data binding
- IBindingList interface [Windows Forms], Windows Forms data binding
- interfaces [Windows Forms], Windows Forms data binding
- IEditableObject interface [Windows Forms], Windows Forms data binding
- data binding [Windows Forms], interfaces
- IDataErrorInfo interface [Windows Forms], Windows Forms data binding
ms.assetid: 14e49a2e-3e46-47ca-b491-70d546333277
ms.openlocfilehash: 4e40f7ec1922cdf43e6a0b8f5734acaaeefbc514
ms.sourcegitcommit: 8a0fe8a2227af612f8b8941bdb8b19d6268748e7
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/03/2019
ms.locfileid: "71834596"
---
# <a name="interfaces-related-to-data-binding"></a><span data-ttu-id="2358e-102">與資料繫結相關的介面</span><span class="sxs-lookup"><span data-stu-id="2358e-102">Interfaces Related to Data Binding</span></span>

<span data-ttu-id="2358e-103">透過 ADO.NET，您可以建立許多不同的資料結構，以符合應用程式的系結需求和您正在使用的資料。</span><span class="sxs-lookup"><span data-stu-id="2358e-103">With ADO.NET, you can create many different data structures to suit the binding needs of your application and the data you are working with.</span></span> <span data-ttu-id="2358e-104">您或許會想要建立自有類別以在 Windows Forms 中提供或取用資料。</span><span class="sxs-lookup"><span data-stu-id="2358e-104">You may want to create your own classes that provide or consume data in Windows Forms.</span></span> <span data-ttu-id="2358e-105">這些物件可以提供不同程度的功能和複雜度，從基本的資料繫結，到提供設計階段支援、錯誤檢查、變更通知，或甚至對資料本身所做變更的結構化回復支援。</span><span class="sxs-lookup"><span data-stu-id="2358e-105">These objects can offer varying levels of functionality and complexity, from basic data binding, to providing design-time support, error checking, change notification, or even support for a structured rollback of the changes made to the data itself.</span></span>

## <a name="consumers-of-data-binding-interfaces"></a><span data-ttu-id="2358e-106">資料繫結介面的取用者</span><span class="sxs-lookup"><span data-stu-id="2358e-106">Consumers of Data-Binding Interfaces</span></span>

<span data-ttu-id="2358e-107">下列各節描述介面物件的兩個群組。</span><span class="sxs-lookup"><span data-stu-id="2358e-107">The following sections describe two groups of interface objects.</span></span> <span data-ttu-id="2358e-108">第一個群組所列出的介面會由資料來源作者實作到資料來源上。</span><span class="sxs-lookup"><span data-stu-id="2358e-108">The first group lists interfaces that are implemented on data sources by data source authors.</span></span> <span data-ttu-id="2358e-109">這些介面是設計來供資料來源取用者取用，而在大部分情況下，這些取用者就是 Windows Forms 控制項或元件。</span><span class="sxs-lookup"><span data-stu-id="2358e-109">These interfaces are designed to be consumed by data source consumers, which are in most cases Windows Forms controls or components.</span></span> <span data-ttu-id="2358e-110">第二個群組所列出的介面則是設計來供元件作者使用。</span><span class="sxs-lookup"><span data-stu-id="2358e-110">The second group lists interfaces designed for use by component authors.</span></span> <span data-ttu-id="2358e-111">元件作者在建立可支援資料繫結的元件以供 Windows Forms 資料繫結引擎取用時，就會使用這些介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-111">Component authors use these interfaces when they are creating a component that supports data binding to be consumed by the Windows Forms data-binding engine.</span></span> <span data-ttu-id="2358e-112">您可以在與表單相關聯的類別內實作這些介面，以啟用資料繫結；下列每個案例都會提出一個類別，該類別會實作可與資料互動的介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-112">You can implement these interfaces within classes associated with your form to enable data binding; each case presents a class that implements an interface that enables interaction with data.</span></span> <span data-ttu-id="2358e-113">Visual Studio 快速應用程式開發（RAD）資料設計體驗工具已充分利用這項功能。</span><span class="sxs-lookup"><span data-stu-id="2358e-113">Visual Studio rapid application development (RAD) data design experience tools already take advantage of this functionality.</span></span>

### <a name="interfaces-for-implementation-by-data-source-authors"></a><span data-ttu-id="2358e-114">可供資料來源作者實作的介面</span><span class="sxs-lookup"><span data-stu-id="2358e-114">Interfaces for Implementation by Data Source Authors</span></span>

<span data-ttu-id="2358e-115">下列介面是設計來供 Windows Forms 控制項取用︰</span><span class="sxs-lookup"><span data-stu-id="2358e-115">The following interfaces are designed to be consumed by Windows Forms controls:</span></span>

- <span data-ttu-id="2358e-116"><xref:System.Collections.IList> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-116"><xref:System.Collections.IList> interface</span></span>

  <span data-ttu-id="2358e-117">實 <xref:System.Collections.IList> 介面的類別可以是 <xref:System.Array>、<xref:System.Collections.ArrayList>或 <xref:System.Collections.CollectionBase>。</span><span class="sxs-lookup"><span data-stu-id="2358e-117">A class that implements the <xref:System.Collections.IList> interface could be an <xref:System.Array>, <xref:System.Collections.ArrayList>, or <xref:System.Collections.CollectionBase>.</span></span> <span data-ttu-id="2358e-118">這些是 <xref:System.Object>類型之專案的索引清單。</span><span class="sxs-lookup"><span data-stu-id="2358e-118">These are indexed lists of items of type <xref:System.Object>.</span></span> <span data-ttu-id="2358e-119">這些清單必須包含同質型別，因為此索引的第一個項目會決定其型別。</span><span class="sxs-lookup"><span data-stu-id="2358e-119">These lists must contain homogenous types, because the first item of the index determines the type.</span></span> <span data-ttu-id="2358e-120"><xref:System.Collections.IList> 只可在執行時間進行系結。</span><span class="sxs-lookup"><span data-stu-id="2358e-120"><xref:System.Collections.IList> would be available for binding only at run time.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-121">如果您想要建立與 Windows Forms 系結的商務物件清單，您應該考慮使用 <xref:System.ComponentModel.BindingList%601>。</span><span class="sxs-lookup"><span data-stu-id="2358e-121">If you want to create a list of business objects for binding with Windows Forms, you should consider using the <xref:System.ComponentModel.BindingList%601>.</span></span> <span data-ttu-id="2358e-122"><xref:System.ComponentModel.BindingList%601> 是一種可延伸的類別，可執行雙向 Windows Forms 資料系結所需的主要介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-122">The <xref:System.ComponentModel.BindingList%601> is an extensible class that implements the primary interfaces required for two-way Windows Forms data binding.</span></span>

- <span data-ttu-id="2358e-123"><xref:System.ComponentModel.IBindingList> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-123"><xref:System.ComponentModel.IBindingList> interface</span></span>

  <span data-ttu-id="2358e-124">實作為 <xref:System.ComponentModel.IBindingList> 介面的類別，可提供更高層級的資料系結功能。</span><span class="sxs-lookup"><span data-stu-id="2358e-124">A class that implements the <xref:System.ComponentModel.IBindingList> interface provides a much higher level of data-binding functionality.</span></span> <span data-ttu-id="2358e-125">此實作可提供您基本的排序功能和變更通知，讓您在清單項目變更時 (例如，客戶清單的第三個項目變更了 [位址] 欄位) 以及在清單本身變更時 (例如，清單的項目數增加或減少) 使用。</span><span class="sxs-lookup"><span data-stu-id="2358e-125">This implementation offers you basic sorting capabilities and change notification, both for when the list items change (for example, the third item in a list of customers has a change to the Address field), as well as when the list itself changes (for example, the number of items in the list increases or decreases).</span></span> <span data-ttu-id="2358e-126">如果您打算讓多個控制項繫結至相同資料，並想要讓其中一個控制項的資料變更傳播到其他繫結控制項，變更通知就很重要。</span><span class="sxs-lookup"><span data-stu-id="2358e-126">Change notification is important if you plan to have multiple controls bound to the same data, and you want data changes made in one of the controls to propagate to the other bound controls.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-127">系統會透過 <xref:System.ComponentModel.IBindingList.SupportsChangeNotification%2A> 屬性來啟用 <xref:System.ComponentModel.IBindingList> 介面的變更通知，而當 `true`時，會引發 <xref:System.ComponentModel.IBindingList.ListChanged> 事件，指出清單已變更或清單中的專案已變更。</span><span class="sxs-lookup"><span data-stu-id="2358e-127">Change notification is enabled for the <xref:System.ComponentModel.IBindingList> interface through the <xref:System.ComponentModel.IBindingList.SupportsChangeNotification%2A> property which, when `true`, raises a <xref:System.ComponentModel.IBindingList.ListChanged> event, indicating the list changed or an item in the list changed.</span></span>

  <span data-ttu-id="2358e-128">變更的類型是由 <xref:System.ComponentModel.ListChangedEventArgs> 參數的 <xref:System.ComponentModel.ListChangedType> 屬性所描述。</span><span class="sxs-lookup"><span data-stu-id="2358e-128">The type of change is described by the <xref:System.ComponentModel.ListChangedType> property of the <xref:System.ComponentModel.ListChangedEventArgs> parameter.</span></span> <span data-ttu-id="2358e-129">因此，每當資料模型更新時，所有相依的檢視 (例如其他繫結至相同資料來源的控制項) 也會隨之更新。</span><span class="sxs-lookup"><span data-stu-id="2358e-129">Hence, whenever the data model is updated, any dependent views, such as other controls bound to the same data source, will also be updated.</span></span> <span data-ttu-id="2358e-130">不過，清單中包含的物件必須在變更時通知清單，讓清單可以引發 <xref:System.ComponentModel.IBindingList.ListChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="2358e-130">However, objects contained within the list will have to notify the list when they change so that the list can raise the <xref:System.ComponentModel.IBindingList.ListChanged> event.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-131"><xref:System.ComponentModel.BindingList%601> 提供 <xref:System.ComponentModel.IBindingList> 介面的泛型實作為。</span><span class="sxs-lookup"><span data-stu-id="2358e-131">The <xref:System.ComponentModel.BindingList%601> provides a generic implementation of the <xref:System.ComponentModel.IBindingList> interface.</span></span>

- <span data-ttu-id="2358e-132"><xref:System.ComponentModel.IBindingListView> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-132"><xref:System.ComponentModel.IBindingListView> interface</span></span>

  <span data-ttu-id="2358e-133">實作為 <xref:System.ComponentModel.IBindingListView> 介面的類別，可提供 <xref:System.ComponentModel.IBindingList>執行的所有功能，以及篩選和先進排序功能。</span><span class="sxs-lookup"><span data-stu-id="2358e-133">A class that implements the <xref:System.ComponentModel.IBindingListView> interface provides all the functionality of an implementation of <xref:System.ComponentModel.IBindingList>, as well as filtering and advanced sorting functionality.</span></span> <span data-ttu-id="2358e-134">此實作可提供以字串為基礎的篩選功能，以及利用屬性描述元與方向配對來進行的多欄排序功能。</span><span class="sxs-lookup"><span data-stu-id="2358e-134">This implementation offers string-based filtering, and multicolumn sorting with property descriptor-direction pairs.</span></span>

- <span data-ttu-id="2358e-135"><xref:System.ComponentModel.IEditableObject> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-135"><xref:System.ComponentModel.IEditableObject> interface</span></span>

  <span data-ttu-id="2358e-136">實作為 <xref:System.ComponentModel.IEditableObject> 介面的類別，可讓物件控制何時將該物件的變更設為永久。</span><span class="sxs-lookup"><span data-stu-id="2358e-136">A class that implements the <xref:System.ComponentModel.IEditableObject> interface allows an object to control when changes to that object are made permanent.</span></span> <span data-ttu-id="2358e-137">此實作為提供您 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>、<xref:System.ComponentModel.IEditableObject.EndEdit%2A>和 <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> 方法，可讓您復原對物件所做的變更。</span><span class="sxs-lookup"><span data-stu-id="2358e-137">This implementation affords you the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>, and <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> methods, which enable you to roll back changes made to the object.</span></span> <span data-ttu-id="2358e-138">以下簡短說明 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>、<xref:System.ComponentModel.IEditableObject.EndEdit%2A>和 <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> 方法的運作方式，以及它們如何彼此搭配運作，以啟用對資料所做之變更的可能復原：</span><span class="sxs-lookup"><span data-stu-id="2358e-138">Following is a brief explanation of the functioning of the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>, and <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> methods and how they work in conjunction with one another to enable a possible rollback of changes made to the data:</span></span>

  - <span data-ttu-id="2358e-139"><xref:System.ComponentModel.IEditableObject.BeginEdit%2A> 方法會指示物件上的編輯開始。</span><span class="sxs-lookup"><span data-stu-id="2358e-139">The <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> method signals the start of an edit on an object.</span></span> <span data-ttu-id="2358e-140">執行此介面的物件必須在 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> 方法呼叫之後儲存任何更新，如此一來，當呼叫 <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> 方法時，就可以捨棄更新。</span><span class="sxs-lookup"><span data-stu-id="2358e-140">An object that implements this interface will need to store any updates after the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> method call in such a way that the updates can be discarded if the <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> method is called.</span></span> <span data-ttu-id="2358e-141">在 資料系結 Windows Forms 中，您可以在單一編輯交易的範圍內多次呼叫 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> （例如，<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>、<xref:System.ComponentModel.IEditableObject.BeginEdit%2A>、<xref:System.ComponentModel.IEditableObject.EndEdit%2A>）。</span><span class="sxs-lookup"><span data-stu-id="2358e-141">In data binding Windows Forms, you can call <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> multiple times within the scope of a single edit transaction (for example, <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>).</span></span> <span data-ttu-id="2358e-142"><xref:System.ComponentModel.IEditableObject> 的執行應該追蹤是否已呼叫 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>，並忽略 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>的後續呼叫。</span><span class="sxs-lookup"><span data-stu-id="2358e-142">Implementations of <xref:System.ComponentModel.IEditableObject> should keep track of whether <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> has already been called and ignore subsequent calls to <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>.</span></span> <span data-ttu-id="2358e-143">因為可以多次呼叫此方法，所以對它的後續呼叫很重要。也就是說，後續的 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> 呼叫無法摧毀已進行的更新，或變更第一個 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> 呼叫所儲存的資料。</span><span class="sxs-lookup"><span data-stu-id="2358e-143">Because this method can be called multiple times, it is important that subsequent calls to it are nondestructive; that is, subsequent <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> calls cannot destroy the updates that have been made or change the data that was saved on the first <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> call.</span></span>

  - <span data-ttu-id="2358e-144">如果物件目前處於編輯模式，<xref:System.ComponentModel.IEditableObject.EndEdit%2A> 方法會推送任何變更，因為 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> 被呼叫到基礎物件。</span><span class="sxs-lookup"><span data-stu-id="2358e-144">The <xref:System.ComponentModel.IEditableObject.EndEdit%2A> method pushes any changes since <xref:System.ComponentModel.IEditableObject.BeginEdit%2A> was called into the underlying object, if the object is currently in edit mode.</span></span>

  - <span data-ttu-id="2358e-145"><xref:System.ComponentModel.IEditableObject.CancelEdit%2A> 方法會捨棄對物件所做的任何變更。</span><span class="sxs-lookup"><span data-stu-id="2358e-145">The <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> method discards any changes made to the object.</span></span>

  <span data-ttu-id="2358e-146">如需 <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>、<xref:System.ComponentModel.IEditableObject.EndEdit%2A>和 <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> 方法如何使用的詳細資訊，請參閱[將資料儲存回資料庫](/visualstudio/data-tools/save-data-back-to-the-database)。</span><span class="sxs-lookup"><span data-stu-id="2358e-146">For more information about how the <xref:System.ComponentModel.IEditableObject.BeginEdit%2A>, <xref:System.ComponentModel.IEditableObject.EndEdit%2A>, and <xref:System.ComponentModel.IEditableObject.CancelEdit%2A> methods work, see [Save data back to the database](/visualstudio/data-tools/save-data-back-to-the-database).</span></span>

  <span data-ttu-id="2358e-147">此資料功能的交易式概念是由 <xref:System.Windows.Forms.DataGridView> 控制項所使用。</span><span class="sxs-lookup"><span data-stu-id="2358e-147">This transactional notion of data functionality is used by the <xref:System.Windows.Forms.DataGridView> control.</span></span>

- <span data-ttu-id="2358e-148"><xref:System.ComponentModel.ICancelAddNew> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-148"><xref:System.ComponentModel.ICancelAddNew> interface</span></span>

  <span data-ttu-id="2358e-149">實 <xref:System.ComponentModel.ICancelAddNew> 介面的類別通常會執行 <xref:System.ComponentModel.IBindingList> 介面，並可讓您使用 <xref:System.ComponentModel.IBindingList.AddNew%2A> 方法來復原對資料來源所做的加法。</span><span class="sxs-lookup"><span data-stu-id="2358e-149">A class that implements the <xref:System.ComponentModel.ICancelAddNew> interface usually implements the <xref:System.ComponentModel.IBindingList> interface and allows you to roll back an addition made to the data source with the <xref:System.ComponentModel.IBindingList.AddNew%2A> method.</span></span> <span data-ttu-id="2358e-150">如果您的資料來源會執行 <xref:System.ComponentModel.IBindingList> 介面，您也應該讓它實 <xref:System.ComponentModel.ICancelAddNew> 介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-150">If your data source implements the <xref:System.ComponentModel.IBindingList> interface, you should also have it implement the <xref:System.ComponentModel.ICancelAddNew> interface.</span></span>

- <span data-ttu-id="2358e-151"><xref:System.ComponentModel.IDataErrorInfo> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-151"><xref:System.ComponentModel.IDataErrorInfo> interface</span></span>

  <span data-ttu-id="2358e-152">實 <xref:System.ComponentModel.IDataErrorInfo> 介面的類別可讓物件提供自訂錯誤資訊給繫結控制項：</span><span class="sxs-lookup"><span data-stu-id="2358e-152">A class that implements the <xref:System.ComponentModel.IDataErrorInfo> interface allows objects to offer custom error information to bound controls:</span></span>

  - <span data-ttu-id="2358e-153"><xref:System.ComponentModel.IDataErrorInfo.Error%2A> 屬性會傳回一般錯誤訊息正文（例如「發生錯誤」）。</span><span class="sxs-lookup"><span data-stu-id="2358e-153">The <xref:System.ComponentModel.IDataErrorInfo.Error%2A> property returns general error message text (for example, "An error has occurred").</span></span>

  - <span data-ttu-id="2358e-154"><xref:System.ComponentModel.IDataErrorInfo.Item%2A> 屬性會傳回字串，其中包含資料行中的特定錯誤訊息（例如「`State` 資料行中的值無效」）。</span><span class="sxs-lookup"><span data-stu-id="2358e-154">The <xref:System.ComponentModel.IDataErrorInfo.Item%2A> property returns a string with the specific error message from the column (for example, "The value in the `State` column is invalid").</span></span>

- <span data-ttu-id="2358e-155"><xref:System.Collections.IEnumerable> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-155"><xref:System.Collections.IEnumerable> interface</span></span>

  <span data-ttu-id="2358e-156">ASP.NET 通常會使用實作為 <xref:System.Collections.IEnumerable> 介面的類別。</span><span class="sxs-lookup"><span data-stu-id="2358e-156">A class that implements the <xref:System.Collections.IEnumerable> interface is typically consumed by ASP.NET.</span></span> <span data-ttu-id="2358e-157">只有透過 <xref:System.Windows.Forms.BindingSource> 元件才能使用此介面的 Windows Forms 支援。</span><span class="sxs-lookup"><span data-stu-id="2358e-157">Windows Forms support for this interface is only available through the <xref:System.Windows.Forms.BindingSource> component.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-158"><xref:System.Windows.Forms.BindingSource> 元件會將所有 <xref:System.Collections.IEnumerable> 專案複製到不同的清單，以供系結之用。</span><span class="sxs-lookup"><span data-stu-id="2358e-158">The <xref:System.Windows.Forms.BindingSource> component copies all <xref:System.Collections.IEnumerable> items into a separate list for binding purposes.</span></span>

- <span data-ttu-id="2358e-159"><xref:System.ComponentModel.ITypedList> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-159"><xref:System.ComponentModel.ITypedList> interface</span></span>

  <span data-ttu-id="2358e-160">實作為 <xref:System.ComponentModel.ITypedList> 介面的集合類別，可讓您控制對繫結控制項所公開的順序和屬性集。</span><span class="sxs-lookup"><span data-stu-id="2358e-160">A collections class that implements the <xref:System.ComponentModel.ITypedList> interface provides the ability to control the order and the set of properties exposed to the bound control.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-161">當您執行 <xref:System.ComponentModel.ITypedList.GetItemProperties%2A> 方法，且 <xref:System.ComponentModel.PropertyDescriptor> 陣列不是 null 時，陣列中的最後一個專案會是描述清單屬性（也就是另一個專案清單）的屬性描述元。</span><span class="sxs-lookup"><span data-stu-id="2358e-161">When you implement the <xref:System.ComponentModel.ITypedList.GetItemProperties%2A> method, and the <xref:System.ComponentModel.PropertyDescriptor> array is not null, the last entry in the array will be the property descriptor that describes the list property that is another list of items.</span></span>

- <span data-ttu-id="2358e-162"><xref:System.ComponentModel.ICustomTypeDescriptor> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-162"><xref:System.ComponentModel.ICustomTypeDescriptor> interface</span></span>

  <span data-ttu-id="2358e-163">實 <xref:System.ComponentModel.ICustomTypeDescriptor> 介面的類別會提供其本身的動態資訊。</span><span class="sxs-lookup"><span data-stu-id="2358e-163">A class that implements the <xref:System.ComponentModel.ICustomTypeDescriptor> interface provides dynamic information about itself.</span></span> <span data-ttu-id="2358e-164">這個介面與 <xref:System.ComponentModel.ITypedList> 類似，但用於物件，而不是清單。</span><span class="sxs-lookup"><span data-stu-id="2358e-164">This interface is similar to <xref:System.ComponentModel.ITypedList> but is used for objects rather than lists.</span></span> <span data-ttu-id="2358e-165">這個介面是由 <xref:System.Data.DataRowView> 用來投影基礎資料列的架構。</span><span class="sxs-lookup"><span data-stu-id="2358e-165">This interface is used by <xref:System.Data.DataRowView> to project the schema of the underlying rows.</span></span> <span data-ttu-id="2358e-166"><xref:System.ComponentModel.ICustomTypeDescriptor> 的簡單執行是由 <xref:System.ComponentModel.CustomTypeDescriptor> 類別所提供。</span><span class="sxs-lookup"><span data-stu-id="2358e-166">A simple implementation of <xref:System.ComponentModel.ICustomTypeDescriptor> is provided by the <xref:System.ComponentModel.CustomTypeDescriptor> class.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-167">為了支援將設計階段系結至實 <xref:System.ComponentModel.ICustomTypeDescriptor>的型別，型別也必須實作為 <xref:System.ComponentModel.IComponent>，並以實例形式存在於表單上。</span><span class="sxs-lookup"><span data-stu-id="2358e-167">To support design-time binding to types that implement <xref:System.ComponentModel.ICustomTypeDescriptor>, the type must also implement <xref:System.ComponentModel.IComponent> and exist as an instance on the Form.</span></span>

- <span data-ttu-id="2358e-168"><xref:System.ComponentModel.IListSource> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-168"><xref:System.ComponentModel.IListSource> interface</span></span>

  <span data-ttu-id="2358e-169">執行 <xref:System.ComponentModel.IListSource> 介面的類別，會在非清單物件上啟用以清單為基礎的系結。</span><span class="sxs-lookup"><span data-stu-id="2358e-169">A class that implements the <xref:System.ComponentModel.IListSource> interface enables list-based binding on non-list objects.</span></span> <span data-ttu-id="2358e-170"><xref:System.ComponentModel.IListSource> 的 <xref:System.ComponentModel.IListSource.GetList%2A> 方法是用來從未繼承自 <xref:System.Collections.IList>的物件傳回可系結清單。</span><span class="sxs-lookup"><span data-stu-id="2358e-170">The <xref:System.ComponentModel.IListSource.GetList%2A> method of <xref:System.ComponentModel.IListSource> is used to return a bindable list from an object that does not inherit from <xref:System.Collections.IList>.</span></span> <span data-ttu-id="2358e-171"><xref:System.ComponentModel.IListSource> 由 <xref:System.Data.DataSet> 類別使用。</span><span class="sxs-lookup"><span data-stu-id="2358e-171"><xref:System.ComponentModel.IListSource> is used by the <xref:System.Data.DataSet> class.</span></span>

- <span data-ttu-id="2358e-172"><xref:System.ComponentModel.IRaiseItemChangedEvents> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-172"><xref:System.ComponentModel.IRaiseItemChangedEvents> interface</span></span>

  <span data-ttu-id="2358e-173">實作為 <xref:System.ComponentModel.IRaiseItemChangedEvents> 介面的類別是可系結的清單，它也會執行 <xref:System.ComponentModel.IBindingList> 介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-173">A class that implements the <xref:System.ComponentModel.IRaiseItemChangedEvents> interface is a bindable list that also implements the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="2358e-174">這個介面是用來指出您的類型是否會透過其 <xref:System.ComponentModel.IRaiseItemChangedEvents.RaisesItemChangedEvents%2A> 屬性，引發 <xref:System.ComponentModel.ListChangedType.ItemChanged> 類型的 <xref:System.ComponentModel.IBindingList.ListChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="2358e-174">This interface is used to indicate if your type raises <xref:System.ComponentModel.IBindingList.ListChanged> events of type <xref:System.ComponentModel.ListChangedType.ItemChanged> through its <xref:System.ComponentModel.IRaiseItemChangedEvents.RaisesItemChangedEvents%2A> property.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-175">如果您的資料來源提供屬性來列出先前所述的事件轉換，並且與 <xref:System.Windows.Forms.BindingSource> 元件互動，您應該執行 <xref:System.ComponentModel.IRaiseItemChangedEvents>。</span><span class="sxs-lookup"><span data-stu-id="2358e-175">You should implement the <xref:System.ComponentModel.IRaiseItemChangedEvents> if your data source provides the property to list event conversion described previously and is interacting with the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="2358e-176">否則，<xref:System.Windows.Forms.BindingSource> 也會執行屬性來列出事件轉換，因而導致效能變慢。</span><span class="sxs-lookup"><span data-stu-id="2358e-176">Otherwise, the <xref:System.Windows.Forms.BindingSource> will also perform property to list event conversion resulting in slower performance.</span></span>

- <span data-ttu-id="2358e-177"><xref:System.ComponentModel.ISupportInitialize> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-177"><xref:System.ComponentModel.ISupportInitialize> interface</span></span>

  <span data-ttu-id="2358e-178">執行 <xref:System.ComponentModel.ISupportInitialize> 介面的元件會利用批次優化的優點來設定屬性和初始化共同相依屬性。</span><span class="sxs-lookup"><span data-stu-id="2358e-178">A component that implements the <xref:System.ComponentModel.ISupportInitialize> interface takes advantages of batch optimizations for setting properties and initializing co-dependent properties.</span></span> <span data-ttu-id="2358e-179"><xref:System.ComponentModel.ISupportInitialize> 包含兩種方法：</span><span class="sxs-lookup"><span data-stu-id="2358e-179">The <xref:System.ComponentModel.ISupportInitialize> contains two methods:</span></span>

  - <span data-ttu-id="2358e-180"><xref:System.ComponentModel.ISupportInitialize.BeginInit%2A> 通知物件初始化正在啟動。</span><span class="sxs-lookup"><span data-stu-id="2358e-180"><xref:System.ComponentModel.ISupportInitialize.BeginInit%2A> signals that object initialization is starting.</span></span>

  - <span data-ttu-id="2358e-181"><xref:System.ComponentModel.ISupportInitialize.EndInit%2A> 通知物件初始化已完成。</span><span class="sxs-lookup"><span data-stu-id="2358e-181"><xref:System.ComponentModel.ISupportInitialize.EndInit%2A> signals that object initialization is finishing.</span></span>

- <span data-ttu-id="2358e-182"><xref:System.ComponentModel.ISupportInitializeNotification> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-182"><xref:System.ComponentModel.ISupportInitializeNotification> interface</span></span>

  <span data-ttu-id="2358e-183">實作為 <xref:System.ComponentModel.ISupportInitializeNotification> 介面的元件也會執行 <xref:System.ComponentModel.ISupportInitialize> 介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-183">A component that implements the <xref:System.ComponentModel.ISupportInitializeNotification> interface also implements the <xref:System.ComponentModel.ISupportInitialize> interface.</span></span> <span data-ttu-id="2358e-184">此介面可讓您通知其他 <xref:System.ComponentModel.ISupportInitialize> 元件初始化已完成。</span><span class="sxs-lookup"><span data-stu-id="2358e-184">This interface allows you to notify other <xref:System.ComponentModel.ISupportInitialize> components that initialization is complete.</span></span> <span data-ttu-id="2358e-185"><xref:System.ComponentModel.ISupportInitializeNotification> 介面包含兩個成員：</span><span class="sxs-lookup"><span data-stu-id="2358e-185">The <xref:System.ComponentModel.ISupportInitializeNotification> interface contains two members:</span></span>

  - <span data-ttu-id="2358e-186"><xref:System.ComponentModel.ISupportInitializeNotification.IsInitialized%2A> 會傳回 `boolean` 值，指出元件是否已初始化。</span><span class="sxs-lookup"><span data-stu-id="2358e-186"><xref:System.ComponentModel.ISupportInitializeNotification.IsInitialized%2A> returns a `boolean` value indicating whether the component is initialized.</span></span>

  - <span data-ttu-id="2358e-187">呼叫 <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> 時，就會發生 <xref:System.ComponentModel.ISupportInitializeNotification.Initialized>。</span><span class="sxs-lookup"><span data-stu-id="2358e-187"><xref:System.ComponentModel.ISupportInitializeNotification.Initialized> occurs when <xref:System.ComponentModel.ISupportInitialize.EndInit%2A> is called.</span></span>

- <span data-ttu-id="2358e-188"><xref:System.ComponentModel.INotifyPropertyChanged> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-188"><xref:System.ComponentModel.INotifyPropertyChanged> interface</span></span>

  <span data-ttu-id="2358e-189">類別若實作此介面，代表其所屬的型別會在其任何屬性值變更時引發事件。</span><span class="sxs-lookup"><span data-stu-id="2358e-189">A class that implements this interface is a type that raises an event when any of its property values change.</span></span> <span data-ttu-id="2358e-190">對於會讓控制項的每個屬性有一個變更事件的模式，我們設計了此介面來加以取代。</span><span class="sxs-lookup"><span data-stu-id="2358e-190">This interface is designed to replace the pattern of having a change event for each property of a control.</span></span> <span data-ttu-id="2358e-191">在 <xref:System.ComponentModel.BindingList%601>中使用時，商務物件應該會執行 <xref:System.ComponentModel.INotifyPropertyChanged> 介面，而 BindingList\`1 會將 <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> 事件轉換成 <xref:System.ComponentModel.BindingList%601.ListChanged> 類型的 <xref:System.ComponentModel.ListChangedType.ItemChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="2358e-191">When used in a <xref:System.ComponentModel.BindingList%601>, a business object should implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface and the BindingList\`1 will convert <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> events to <xref:System.ComponentModel.BindingList%601.ListChanged> events of type <xref:System.ComponentModel.ListChangedType.ItemChanged>.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-192">若要讓變更通知出現在系結的用戶端與資料來源之間的系結中，系結的資料來源類型應執行 <xref:System.ComponentModel.INotifyPropertyChanged> 介面（慣用），或者您可以提供系結類型的*propertyName*`Changed` 事件，但不應同時這麼做。</span><span class="sxs-lookup"><span data-stu-id="2358e-192">For change notification to occur in a binding between a bound client and a data source your bound data-source type should either implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface (preferred) or you can provide *propertyName*`Changed` events for the bound type, but you shouldn't do both.</span></span>

### <a name="interfaces-for-implementation-by-component-authors"></a><span data-ttu-id="2358e-193">可供元件作者實作的介面</span><span class="sxs-lookup"><span data-stu-id="2358e-193">Interfaces for Implementation by Component Authors</span></span>

<span data-ttu-id="2358e-194">下列介面是設計來供 Windows Forms 資料繫結引擎取用︰</span><span class="sxs-lookup"><span data-stu-id="2358e-194">The following interfaces are designed for consumption by the Windows Forms data-binding engine:</span></span>

- <span data-ttu-id="2358e-195"><xref:System.Windows.Forms.IBindableComponent> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-195"><xref:System.Windows.Forms.IBindableComponent> interface</span></span>

  <span data-ttu-id="2358e-196">類別若實作此介面，就是可支援資料繫結的非控制項元件。</span><span class="sxs-lookup"><span data-stu-id="2358e-196">A class that implements this interface is a non-control component that supports data binding.</span></span> <span data-ttu-id="2358e-197">這個類別會透過此介面的 <xref:System.Windows.Forms.IBindableComponent.DataBindings%2A> 和 <xref:System.Windows.Forms.IBindableComponent.BindingContext%2A> 屬性，傳回元件的資料系結和系結內容。</span><span class="sxs-lookup"><span data-stu-id="2358e-197">This class returns the data bindings and binding context of the component through the <xref:System.Windows.Forms.IBindableComponent.DataBindings%2A> and <xref:System.Windows.Forms.IBindableComponent.BindingContext%2A> properties of this interface.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-198">如果您的元件繼承自 <xref:System.Windows.Forms.Control>，您就不需要執行 <xref:System.Windows.Forms.IBindableComponent> 介面。</span><span class="sxs-lookup"><span data-stu-id="2358e-198">If your component inherits from <xref:System.Windows.Forms.Control>, you do not need to implement the <xref:System.Windows.Forms.IBindableComponent> interface.</span></span>

- <span data-ttu-id="2358e-199"><xref:System.Windows.Forms.ICurrencyManagerProvider> 介面</span><span class="sxs-lookup"><span data-stu-id="2358e-199"><xref:System.Windows.Forms.ICurrencyManagerProvider> interface</span></span>

  <span data-ttu-id="2358e-200">實作為 <xref:System.Windows.Forms.ICurrencyManagerProvider> 介面的類別是一個元件，它會提供自己的 <xref:System.Windows.Forms.CurrencyManager> 來管理與此特定元件相關聯的系結。</span><span class="sxs-lookup"><span data-stu-id="2358e-200">A class that implements the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface is a component that provides its own <xref:System.Windows.Forms.CurrencyManager> to manage the bindings associated with this particular component.</span></span> <span data-ttu-id="2358e-201">自訂 <xref:System.Windows.Forms.CurrencyManager> 的存取是由 <xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> 屬性所提供。</span><span class="sxs-lookup"><span data-stu-id="2358e-201">Access to the custom <xref:System.Windows.Forms.CurrencyManager> is provided by the <xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> property.</span></span>

  > [!NOTE]
  > <span data-ttu-id="2358e-202">繼承自 <xref:System.Windows.Forms.Control> 的類別會透過其 <xref:System.Windows.Forms.Control.BindingContext%2A> 屬性自動管理系結，因此您需要執行 <xref:System.Windows.Forms.ICurrencyManagerProvider> 的情況相當罕見。</span><span class="sxs-lookup"><span data-stu-id="2358e-202">A class that inherits from <xref:System.Windows.Forms.Control> manages bindings automatically through its <xref:System.Windows.Forms.Control.BindingContext%2A> property, so cases in which you need to implement the <xref:System.Windows.Forms.ICurrencyManagerProvider> are fairly rare.</span></span>

## <a name="see-also"></a><span data-ttu-id="2358e-203">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2358e-203">See also</span></span>

- [<span data-ttu-id="2358e-204">資料繫結和 Windows Forms</span><span class="sxs-lookup"><span data-stu-id="2358e-204">Data Binding and Windows Forms</span></span>](data-binding-and-windows-forms.md)
- [<span data-ttu-id="2358e-205">操作說明：在 Windows Forms 上建立簡單繫結控制項</span><span class="sxs-lookup"><span data-stu-id="2358e-205">How to: Create a Simple-Bound Control on a Windows Form</span></span>](how-to-create-a-simple-bound-control-on-a-windows-form.md)
- [<span data-ttu-id="2358e-206">Windows Forms 資料繫結</span><span class="sxs-lookup"><span data-stu-id="2358e-206">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
