---
title: DataGridView 控制項中的資料顯示模式
ms.date: 03/30/2017
helpviewer_keywords:
- data [Windows Forms], display modes
- data grids [Windows Forms], display modes
- DataGridView control [Windows Forms], display modes
ms.assetid: 9755a030-3f3f-4705-a661-ba5a48a81875
ms.openlocfilehash: ad6be647e3a36904b055fd6771f539df28938fab
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76744015"
---
# <a name="data-display-modes-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="4a618-102">Windows Form DataGridView 控制項的資料顯示模式</span><span class="sxs-lookup"><span data-stu-id="4a618-102">Data Display Modes in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="4a618-103"><xref:System.Windows.Forms.DataGridView> 控制項可以用三種不同的模式顯示資料：系結、解除系結和虛擬。</span><span class="sxs-lookup"><span data-stu-id="4a618-103">The <xref:System.Windows.Forms.DataGridView> control can display data in three distinct modes: bound, unbound, and virtual.</span></span> <span data-ttu-id="4a618-104">根據您的需求選擇最適合的模式。</span><span class="sxs-lookup"><span data-stu-id="4a618-104">Choose the most suitable mode based on your requirements.</span></span>  
  
## <a name="unbound"></a><span data-ttu-id="4a618-105">未繫結</span><span class="sxs-lookup"><span data-stu-id="4a618-105">Unbound</span></span>  
 <span data-ttu-id="4a618-106">「解除系結模式」適合用來顯示以程式設計方式管理的相對較少量資料。</span><span class="sxs-lookup"><span data-stu-id="4a618-106">Unbound mode is suitable for displaying relatively small amounts of data that you manage programmatically.</span></span> <span data-ttu-id="4a618-107">您不會將 <xref:System.Windows.Forms.DataGridView> 控制項直接附加至以系結模式為的資料來源。</span><span class="sxs-lookup"><span data-stu-id="4a618-107">You do not attach the <xref:System.Windows.Forms.DataGridView> control directly to a data source as in bound mode.</span></span> <span data-ttu-id="4a618-108">相反地，您必須自行填入控制項，通常是使用 <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="4a618-108">Instead, you must populate the control yourself, typically by using the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="4a618-109">解除系結模式對於靜態、唯讀資料而言特別有用，或者當您想要提供您自己的程式碼來與外部資料存放區互動時，是非常實用的。</span><span class="sxs-lookup"><span data-stu-id="4a618-109">Unbound mode can be particularly useful for static, read-only data, or when you want to provide your own code that interacts with an external data store.</span></span> <span data-ttu-id="4a618-110">不過，當您想要讓使用者與外部資料源互動時，通常會使用系結模式。</span><span class="sxs-lookup"><span data-stu-id="4a618-110">When you want your users to interact with an external data source, however, you will typically use bound mode.</span></span>  
  
 <span data-ttu-id="4a618-111">如需使用唯讀未系結 <xref:System.Windows.Forms.DataGridView>的範例，請參閱[如何：建立未系結的 Windows Forms DataGridView 控制項](how-to-create-an-unbound-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="4a618-111">For an example that uses a read-only unbound <xref:System.Windows.Forms.DataGridView>, see [How to: Create an Unbound Windows Forms DataGridView Control](how-to-create-an-unbound-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="bound"></a><span data-ttu-id="4a618-112">繫結</span><span class="sxs-lookup"><span data-stu-id="4a618-112">Bound</span></span>  
 <span data-ttu-id="4a618-113">系結模式適用于使用與資料存放區的自動互動來管理資料。</span><span class="sxs-lookup"><span data-stu-id="4a618-113">Bound mode is suitable for managing data using automatic interaction with the data store.</span></span> <span data-ttu-id="4a618-114">您可以藉由設定 <xref:System.Windows.Forms.DataGridView.DataSource%2A> 屬性，將 <xref:System.Windows.Forms.DataGridView> 控制項直接附加至其資料來源。</span><span class="sxs-lookup"><span data-stu-id="4a618-114">You can attach the <xref:System.Windows.Forms.DataGridView> control directly to its data source by setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property.</span></span> <span data-ttu-id="4a618-115">當控制項是資料系結時，資料列就會推送並提取，而不需要您的明確管理。</span><span class="sxs-lookup"><span data-stu-id="4a618-115">When the control is data bound, data rows are pushed and pulled without the need of explicit management on your part.</span></span> <span data-ttu-id="4a618-116">`true`<xref:System.Windows.Forms.DataGridView.AutoGenerateColumns%2A> 屬性時，資料來源中的每個資料行都會導致在控制項中建立對應的資料行。</span><span class="sxs-lookup"><span data-stu-id="4a618-116">When the <xref:System.Windows.Forms.DataGridView.AutoGenerateColumns%2A> property is `true`, each column in your data source will cause a corresponding column to be created in the control.</span></span> <span data-ttu-id="4a618-117">如果您想要建立自己的資料行，可以將此屬性設定為 `false` 並使用 <xref:System.Windows.Forms.DataGridViewColumn.DataPropertyName%2A> 屬性，在設定每個資料行時加以系結。</span><span class="sxs-lookup"><span data-stu-id="4a618-117">If you prefer to create your own columns, you can set this property to `false` and use the <xref:System.Windows.Forms.DataGridViewColumn.DataPropertyName%2A> property to bind each column when you configure it.</span></span> <span data-ttu-id="4a618-118">當您想要使用預設產生的類型以外的資料行類型時，這會很有用。</span><span class="sxs-lookup"><span data-stu-id="4a618-118">This is useful when you want to use a column type other than the types that are generated by default.</span></span> <span data-ttu-id="4a618-119">如需詳細資訊，請參閱[Windows Forms DataGridView 控制項中的資料行類型](column-types-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="4a618-119">For more information, see [Column Types in the Windows Forms DataGridView Control](column-types-in-the-windows-forms-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="4a618-120">如需使用系結 <xref:System.Windows.Forms.DataGridView> 控制項的範例，請參閱[逐步解說：驗證 Windows Forms DataGridView 控制項中的資料](walkthrough-validating-data-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="4a618-120">For an example that uses a bound <xref:System.Windows.Forms.DataGridView> control, see [Walkthrough: Validating Data in the Windows Forms DataGridView Control](walkthrough-validating-data-in-the-windows-forms-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="4a618-121">您也可以將未系結的資料行加入至系結模式中的 <xref:System.Windows.Forms.DataGridView> 控制項。</span><span class="sxs-lookup"><span data-stu-id="4a618-121">You can also add unbound columns to a <xref:System.Windows.Forms.DataGridView> control in bound mode.</span></span> <span data-ttu-id="4a618-122">當您想要顯示可讓使用者在特定資料列上執行動作的按鈕或連結的資料行時，這會很有用。</span><span class="sxs-lookup"><span data-stu-id="4a618-122">This is useful when you want to display a column of buttons or links that enable users to perform actions on specific rows.</span></span> <span data-ttu-id="4a618-123">使用從系結的資料行計算出的值，也很有用。</span><span class="sxs-lookup"><span data-stu-id="4a618-123">It is also useful to display columns with values calculated from bound columns.</span></span> <span data-ttu-id="4a618-124">您可以在 <xref:System.Windows.Forms.DataGridView.CellFormatting> 事件的處理常式中，填入計算結果欄的資料格值。</span><span class="sxs-lookup"><span data-stu-id="4a618-124">You can populate the cell values for calculated columns in a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting> event.</span></span> <span data-ttu-id="4a618-125">不過，如果您使用 <xref:System.Data.DataSet> 或 <xref:System.Data.DataTable> 做為資料來源，您可能會想要改為使用 <xref:System.Data.DataColumn.Expression%2A?displayProperty=nameWithType> 屬性來建立計算結果欄。</span><span class="sxs-lookup"><span data-stu-id="4a618-125">If you are using a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> as the data source, however, you might want to use the <xref:System.Data.DataColumn.Expression%2A?displayProperty=nameWithType> property to create a calculated column instead.</span></span> <span data-ttu-id="4a618-126">在這種情況下，<xref:System.Windows.Forms.DataGridView> 控制項將會處理匯出資料行，就像資料來源中的任何其他資料行一樣。</span><span class="sxs-lookup"><span data-stu-id="4a618-126">In this case, the <xref:System.Windows.Forms.DataGridView> control will treat calculated column just like any other column in the data source.</span></span>  
  
 <span data-ttu-id="4a618-127">不支援以系結模式的未系結資料行排序。</span><span class="sxs-lookup"><span data-stu-id="4a618-127">Sorting by unbound columns in bound mode is not supported.</span></span> <span data-ttu-id="4a618-128">如果您在系結模式中建立包含使用者可編輯值的未系結資料行，當控制項依系結的資料行排序時，您必須執行虛擬模式來維護這些值。</span><span class="sxs-lookup"><span data-stu-id="4a618-128">If you create an unbound column in bound mode that contains user-editable values, you must implement virtual mode to maintain these values when the control is sorted by a bound column.</span></span>  
  
## <a name="virtual"></a><span data-ttu-id="4a618-129">Virtual</span><span class="sxs-lookup"><span data-stu-id="4a618-129">Virtual</span></span>  
 <span data-ttu-id="4a618-130">透過虛擬模式，您可以執行自己的資料管理作業。</span><span class="sxs-lookup"><span data-stu-id="4a618-130">With virtual mode, you can implement your own data management operations.</span></span> <span data-ttu-id="4a618-131">當控制項依系結的資料行排序時，必須使用這項功能來維護系結模式中未系結之資料行的值。</span><span class="sxs-lookup"><span data-stu-id="4a618-131">This is necessary to maintain the values of unbound columns in bound mode when the control is sorted by bound columns.</span></span> <span data-ttu-id="4a618-132">不過，虛擬模式的主要用途是在與大量資料互動時，將效能優化。</span><span class="sxs-lookup"><span data-stu-id="4a618-132">The primary use of virtual mode, however, is to optimize performance when interacting with large amounts of data.</span></span>  
  
 <span data-ttu-id="4a618-133">您會將 <xref:System.Windows.Forms.DataGridView> 控制項附加至您所管理的快取，而您的程式碼會控制何時推送和提取資料列。</span><span class="sxs-lookup"><span data-stu-id="4a618-133">You attach the <xref:System.Windows.Forms.DataGridView> control to a cache that you manage, and your code controls when data rows are pushed and pulled.</span></span> <span data-ttu-id="4a618-134">為了讓記憶體耗用量變小，快取的大小應該與目前顯示的資料列數目相似。</span><span class="sxs-lookup"><span data-stu-id="4a618-134">To keep the memory footprint small, the cache should be similar in size to the number of rows currently displayed.</span></span> <span data-ttu-id="4a618-135">當使用者將新的資料列滾動到 view 時，您的程式碼會向快取要求新資料，並選擇性地從記憶體中清除舊資料。</span><span class="sxs-lookup"><span data-stu-id="4a618-135">When the user scrolls new rows into view, your code requests new data from the cache and optionally flushes old data from memory.</span></span>  
  
 <span data-ttu-id="4a618-136">當您正在執行虛擬模式時，您必須追蹤何時需要在資料模型中建立新的資料列，以及何時要復原新資料列的加入。</span><span class="sxs-lookup"><span data-stu-id="4a618-136">When you are implementing virtual mode, you will need to track when a new row is needed in the data model and when to rollback the addition of the new row.</span></span> <span data-ttu-id="4a618-137">這項功能的確切執行將取決於資料模型的執行和資料模型的交易語義;認可範圍是否在資料格或資料列層級。</span><span class="sxs-lookup"><span data-stu-id="4a618-137">The exact implementation of this functionality will depend on the implementation of the data model and the transaction semantics of the data model; whether commit scope is at the cell or row level.</span></span>  
  
 <span data-ttu-id="4a618-138">如需虛擬模式的詳細資訊，請參閱[Windows Forms DataGridView 控制項中的虛擬模式](virtual-mode-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="4a618-138">For more information about virtual mode, see [Virtual Mode in the Windows Forms DataGridView Control](virtual-mode-in-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="4a618-139">如需顯示如何使用虛擬模式事件的範例，請參閱[逐步解說：在 Windows Forms DataGridView 控制項中執行虛擬模式](implementing-virtual-mode-wf-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="4a618-139">For an example that shows how to use virtual mode events, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](implementing-virtual-mode-wf-datagridview-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="4a618-140">請參閱</span><span class="sxs-lookup"><span data-stu-id="4a618-140">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.VirtualMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.BindingSource>
- <xref:System.Windows.Forms.DataGridViewColumn.DataPropertyName%2A?displayProperty=nameWithType>
- [<span data-ttu-id="4a618-141">在 Windows Forms DataGridView 控制項中顯示資料</span><span class="sxs-lookup"><span data-stu-id="4a618-141">Displaying Data in the Windows Forms DataGridView Control</span></span>](displaying-data-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="4a618-142">Windows Forms DataGridView 控制項中的資料行類型</span><span class="sxs-lookup"><span data-stu-id="4a618-142">Column Types in the Windows Forms DataGridView Control</span></span>](column-types-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="4a618-143">逐步解說：建立未繫結的 Windows Forms DataGridView 控制項</span><span class="sxs-lookup"><span data-stu-id="4a618-143">Walkthrough: Creating an Unbound Windows Forms DataGridView Control</span></span>](walkthrough-creating-an-unbound-windows-forms-datagridview-control.md)
- [<span data-ttu-id="4a618-144">操作說明：將資料繫結至 Windows Forms DataGridView 控制項</span><span class="sxs-lookup"><span data-stu-id="4a618-144">How to: Bind Data to the Windows Forms DataGridView Control</span></span>](how-to-bind-data-to-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="4a618-145">Windows Forms DataGridView 控制項中的虛擬模式</span><span class="sxs-lookup"><span data-stu-id="4a618-145">Virtual Mode in the Windows Forms DataGridView Control</span></span>](virtual-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="4a618-146">逐步解說：在 Windows Forms DataGridView 控制項中實作虛擬模式</span><span class="sxs-lookup"><span data-stu-id="4a618-146">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](implementing-virtual-mode-wf-datagridview-control.md)
