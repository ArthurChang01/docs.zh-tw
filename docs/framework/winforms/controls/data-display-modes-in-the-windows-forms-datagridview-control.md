---
title: "Windows Form DataGridView 控制項的資料顯示模式"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-winforms
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- data [Windows Forms], display modes
- data grids [Windows Forms], display modes
- DataGridView control [Windows Forms], display modes
ms.assetid: 9755a030-3f3f-4705-a661-ba5a48a81875
caps.latest.revision: "13"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.openlocfilehash: dc7fd3d3012053d8c40edf5fdce8af45c62c98c5
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/21/2017
---
# <a name="data-display-modes-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="12132-102">Windows Form DataGridView 控制項的資料顯示模式</span><span class="sxs-lookup"><span data-stu-id="12132-102">Data Display Modes in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="12132-103"><xref:System.Windows.Forms.DataGridView>控制項可以顯示三種不同模式中的資料： 繫結、 繫結，與虛擬。</span><span class="sxs-lookup"><span data-stu-id="12132-103">The <xref:System.Windows.Forms.DataGridView> control can display data in three distinct modes: bound, unbound, and virtual.</span></span> <span data-ttu-id="12132-104">選擇最適合您的需求為基礎的模式。</span><span class="sxs-lookup"><span data-stu-id="12132-104">Choose the most suitable mode based on your requirements.</span></span>  
  
## <a name="unbound"></a><span data-ttu-id="12132-105">未繫結</span><span class="sxs-lookup"><span data-stu-id="12132-105">Unbound</span></span>  
 <span data-ttu-id="12132-106">未繫結的模式適合用來顯示相對較小的大量資料，您以程式設計方式管理。</span><span class="sxs-lookup"><span data-stu-id="12132-106">Unbound mode is suitable for displaying relatively small amounts of data that you manage programmatically.</span></span> <span data-ttu-id="12132-107">您不要附加<xref:System.Windows.Forms.DataGridView>直接到資料來源與繫結模式的控制項。</span><span class="sxs-lookup"><span data-stu-id="12132-107">You do not attach the <xref:System.Windows.Forms.DataGridView> control directly to a data source as in bound mode.</span></span> <span data-ttu-id="12132-108">相反地，您必須自行填入控制項，通常使用<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="12132-108">Instead, you must populate the control yourself, typically by using the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A?displayProperty=nameWithType> method.</span></span>  
  
 <span data-ttu-id="12132-109">未繫結的模式可以是靜態的唯讀資料，或當您想要使用外部資料存放區提供自己的程式碼互動時特別有用。</span><span class="sxs-lookup"><span data-stu-id="12132-109">Unbound mode can be particularly useful for static, read-only data, or when you want to provide your own code that interacts with an external data store.</span></span> <span data-ttu-id="12132-110">當您想讓使用者互動的外部資料來源時，不過，您通常會使用繫結的模式。</span><span class="sxs-lookup"><span data-stu-id="12132-110">When you want your users to interact with an external data source, however, you will typically use bound mode.</span></span>  
  
 <span data-ttu-id="12132-111">如需範例，會使用唯讀未繫結<xref:System.Windows.Forms.DataGridView>，請參閱[How to： 建立未繫結的 Windows Form DataGridView 控制項](../../../../docs/framework/winforms/controls/how-to-create-an-unbound-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="12132-111">For an example that uses a read-only unbound <xref:System.Windows.Forms.DataGridView>, see [How to: Create an Unbound Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/how-to-create-an-unbound-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="bound"></a><span data-ttu-id="12132-112">繫結</span><span class="sxs-lookup"><span data-stu-id="12132-112">Bound</span></span>  
 <span data-ttu-id="12132-113">繫結的模式適合用來管理使用與資料存放區的自動互動的資料。</span><span class="sxs-lookup"><span data-stu-id="12132-113">Bound mode is suitable for managing data using automatic interaction with the data store.</span></span> <span data-ttu-id="12132-114">您可以將附加<xref:System.Windows.Forms.DataGridView>直接藉由設定其資料來源控制項<xref:System.Windows.Forms.DataGridView.DataSource%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="12132-114">You can attach the <xref:System.Windows.Forms.DataGridView> control directly to its data source by setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A> property.</span></span> <span data-ttu-id="12132-115">資料繫結控制項時，資料列會推送和提取而不需要明確管理組件。</span><span class="sxs-lookup"><span data-stu-id="12132-115">When the control is data bound, data rows are pushed and pulled without the need of explicit management on your part.</span></span> <span data-ttu-id="12132-116">當<xref:System.Windows.Forms.DataGridView.AutoGenerateColumns%2A>屬性是`true`，資料來源中的每個資料行，會導致控制項中建立對應資料行。</span><span class="sxs-lookup"><span data-stu-id="12132-116">When the <xref:System.Windows.Forms.DataGridView.AutoGenerateColumns%2A> property is `true`, each column in your data source will cause a corresponding column to be created in the control.</span></span> <span data-ttu-id="12132-117">如果您想要建立您自己的資料行，您可以設定這個屬性為`false`並用<xref:System.Windows.Forms.DataGridViewColumn.DataPropertyName%2A>繫結每個資料行，當您設定它的屬性。</span><span class="sxs-lookup"><span data-stu-id="12132-117">If you prefer to create your own columns, you can set this property to `false` and use the <xref:System.Windows.Forms.DataGridViewColumn.DataPropertyName%2A> property to bind each column when you configure it.</span></span> <span data-ttu-id="12132-118">當您想要使用資料行以外的類型會預設產生的型別時，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="12132-118">This is useful when you want to use a column type other than the types that are generated by default.</span></span> <span data-ttu-id="12132-119">如需詳細資訊，請參閱[Windows Form DataGridView 控制項中的資料行類型](../../../../docs/framework/winforms/controls/column-types-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="12132-119">For more information, see [Column Types in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/column-types-in-the-windows-forms-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="12132-120">如需範例，會使用繫結至<xref:System.Windows.Forms.DataGridView>控制，請參閱[逐步解說： 驗證 Windows Form DataGridView 控制項中的資料](../../../../docs/framework/winforms/controls/walkthrough-validating-data-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="12132-120">For an example that uses a bound <xref:System.Windows.Forms.DataGridView> control, see [Walkthrough: Validating Data in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/walkthrough-validating-data-in-the-windows-forms-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="12132-121">您也可以加入未繫結的資料行以<xref:System.Windows.Forms.DataGridView>中繫結模式的控制項。</span><span class="sxs-lookup"><span data-stu-id="12132-121">You can also add unbound columns to a <xref:System.Windows.Forms.DataGridView> control in bound mode.</span></span> <span data-ttu-id="12132-122">當您想要顯示的按鈕或連結，可讓使用者執行動作的特定資料列的資料行時，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="12132-122">This is useful when you want to display a column of buttons or links that enable users to perform actions on specific rows.</span></span> <span data-ttu-id="12132-123">它也很有用，顯示資料行值從繫結資料行計算而得。</span><span class="sxs-lookup"><span data-stu-id="12132-123">It is also useful to display columns with values calculated from bound columns.</span></span> <span data-ttu-id="12132-124">您可以填入處理常式中的導出資料行的資料格值<xref:System.Windows.Forms.DataGridView.CellFormatting>事件。</span><span class="sxs-lookup"><span data-stu-id="12132-124">You can populate the cell values for calculated columns in a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting> event.</span></span> <span data-ttu-id="12132-125">如果您使用<xref:System.Data.DataSet>或<xref:System.Data.DataTable>做為資料來源，不過，您可能想要使用<xref:System.Data.DataColumn.Expression%2A?displayProperty=nameWithType>改為建立導出資料行的屬性。</span><span class="sxs-lookup"><span data-stu-id="12132-125">If you are using a <xref:System.Data.DataSet> or <xref:System.Data.DataTable> as the data source, however, you might want to use the <xref:System.Data.DataColumn.Expression%2A?displayProperty=nameWithType> property to create a calculated column instead.</span></span> <span data-ttu-id="12132-126">在此情況下，<xref:System.Windows.Forms.DataGridView>控制項便會將導出資料行，就像任何其他資料行中的資料來源。</span><span class="sxs-lookup"><span data-stu-id="12132-126">In this case, the <xref:System.Windows.Forms.DataGridView> control will treat calculated column just like any other column in the data source.</span></span>  
  
 <span data-ttu-id="12132-127">不支援的繫結模式的未繫結資料行排序。</span><span class="sxs-lookup"><span data-stu-id="12132-127">Sorting by unbound columns in bound mode is not supported.</span></span> <span data-ttu-id="12132-128">如果您建立未繫結的資料行，其中包含使用者可編輯的值繫結模式中，您必須實作虛擬模式，以維護這些值，當控制項所繫結的資料行排序時。</span><span class="sxs-lookup"><span data-stu-id="12132-128">If you create an unbound column in bound mode that contains user-editable values, you must implement virtual mode to maintain these values when the control is sorted by a bound column.</span></span>  
  
## <a name="virtual"></a><span data-ttu-id="12132-129">虛擬</span><span class="sxs-lookup"><span data-stu-id="12132-129">Virtual</span></span>  
 <span data-ttu-id="12132-130">虛擬模式中，您可以實作您自己的資料管理作業。</span><span class="sxs-lookup"><span data-stu-id="12132-130">With virtual mode, you can implement your own data management operations.</span></span> <span data-ttu-id="12132-131">這是為了維護未繫結的資料行的值繫結模式中，當控制項繫結資料行來排序。</span><span class="sxs-lookup"><span data-stu-id="12132-131">This is necessary to maintain the values of unbound columns in bound mode when the control is sorted by bound columns.</span></span> <span data-ttu-id="12132-132">不過，虛擬模式的主要用途是大量的資料和互動時，將效能最佳化。</span><span class="sxs-lookup"><span data-stu-id="12132-132">The primary use of virtual mode, however, is to optimize performance when interacting with large amounts of data.</span></span>  
  
 <span data-ttu-id="12132-133">您將附加<xref:System.Windows.Forms.DataGridView>管理時，快取控制項和您的程式碼會控制何時發送和提取資料的資料列。</span><span class="sxs-lookup"><span data-stu-id="12132-133">You attach the <xref:System.Windows.Forms.DataGridView> control to a cache that you manage, and your code controls when data rows are pushed and pulled.</span></span> <span data-ttu-id="12132-134">若要維持記憶體耗用量，快取應該的大小類似的目前顯示的資料列數目。</span><span class="sxs-lookup"><span data-stu-id="12132-134">To keep the memory footprint small, the cache should be similar in size to the number of rows currently displayed.</span></span> <span data-ttu-id="12132-135">當使用者將新的資料列捲動到檢視中時，您的程式碼會從快取要求新的資料，並選擇性地從記憶體清除舊資料。</span><span class="sxs-lookup"><span data-stu-id="12132-135">When the user scrolls new rows into view, your code requests new data from the cache and optionally flushes old data from memory.</span></span>  
  
 <span data-ttu-id="12132-136">當您實作虛擬模式時，您必須視需要新的資料列是在資料模型時復原新的資料列加入追蹤。</span><span class="sxs-lookup"><span data-stu-id="12132-136">When you are implementing virtual mode, you will need to track when a new row is needed in the data model and when to rollback the addition of the new row.</span></span> <span data-ttu-id="12132-137">確切實作這項功能將取決於資料模型的實作和交易的語意資料模型。認可範圍是否在資料列層級。</span><span class="sxs-lookup"><span data-stu-id="12132-137">The exact implementation of this functionality will depend on the implementation of the data model and the transaction semantics of the data model; whether commit scope is at the cell or row level.</span></span>  
  
 <span data-ttu-id="12132-138">如需虛擬模式的詳細資訊，請參閱[Windows Form DataGridView 控制項中的虛擬模式](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="12132-138">For more information about virtual mode, see [Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="12132-139">如需示範如何使用虛擬模式事件的範例，請參閱[逐步解說： 在 Windows Form DataGridView 控制項中實作虛擬模式](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="12132-139">For an example that shows how to use virtual mode events, see [Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="12132-140">另請參閱</span><span class="sxs-lookup"><span data-stu-id="12132-140">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.VirtualMode%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.BindingSource>  
 <xref:System.Windows.Forms.DataGridViewColumn.DataPropertyName%2A?displayProperty=nameWithType>  
 [<span data-ttu-id="12132-141">在 Windows Forms DataGridView 控制項中顯示資料</span><span class="sxs-lookup"><span data-stu-id="12132-141">Displaying Data in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/displaying-data-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12132-142">Windows Forms DataGridView 控制項中的資料行類型</span><span class="sxs-lookup"><span data-stu-id="12132-142">Column Types in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/column-types-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12132-143">逐步解說：建立未繫結的 Windows Forms DataGridView 控制項</span><span class="sxs-lookup"><span data-stu-id="12132-143">Walkthrough: Creating an Unbound Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/walkthrough-creating-an-unbound-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12132-144">操作說明：將資料繫結至 Windows Forms DataGridView 控制項</span><span class="sxs-lookup"><span data-stu-id="12132-144">How to: Bind Data to the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-bind-data-to-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12132-145">Windows Forms DataGridView 控制項中的虛擬模式</span><span class="sxs-lookup"><span data-stu-id="12132-145">Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/virtual-mode-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="12132-146">逐步解說：在 Windows Forms DataGridView 控制項中實作虛擬模式</span><span class="sxs-lookup"><span data-stu-id="12132-146">Walkthrough: Implementing Virtual Mode in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/implementing-virtual-mode-wf-datagridview-control.md)
