---
title: Windows Form DataGridView 控制項中的儲存格樣式
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], cell styles
- cells [Windows Forms], styles
- data grids [Windows Forms], cell styles
ms.assetid: dbb75ed6-8804-4232-8382-f9920c2e380c
ms.openlocfilehash: 3cb46ec5b203451cb2f9fd1c87457ad52552359c
ms.sourcegitcommit: 58fc0e6564a37fa1b9b1b140a637e864c4cf696e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/08/2019
ms.locfileid: "57674675"
---
# <a name="cell-styles-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="b4876-102">Windows Form DataGridView 控制項中的儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="b4876-102">Cell Styles in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="b4876-103">每個資料格內<xref:System.Windows.Forms.DataGridView>控制項可以有它自己的樣式，例如文字格式、 背景色彩、 前景色彩和字型。</span><span class="sxs-lookup"><span data-stu-id="b4876-103">Each cell within the <xref:System.Windows.Forms.DataGridView> control can have its own style, such as text format, background color, foreground color, and font.</span></span> <span data-ttu-id="b4876-104">一般而言，不過，多個資料格會共用特定樣式特性。</span><span class="sxs-lookup"><span data-stu-id="b4876-104">Typically, however, multiple cells will share particular style characteristics.</span></span>  
  
 <span data-ttu-id="b4876-105">共用樣式的資料格的群組可能包含特定的資料列或資料行，所有的資料格包含特定值或所有儲存格內的所有資料格控制項中。</span><span class="sxs-lookup"><span data-stu-id="b4876-105">Groups of cells that share styles may include all cells within particular rows or columns, all cells that contain particular values, or all cells in the control.</span></span> <span data-ttu-id="b4876-106">因為這些群組重疊，每個資料格可能會收到其樣式資訊從一個以上的位置。</span><span class="sxs-lookup"><span data-stu-id="b4876-106">Because these groups overlap, each cell may get its styling information from more than one place.</span></span> <span data-ttu-id="b4876-107">例如，您可以每個資料格<xref:System.Windows.Forms.DataGridView>負數的數字與使用相同的字型，但只使用貨幣格式的貨幣資料行中的資料格和只貨幣資料格，來使用紅色前景色彩的控制項。</span><span class="sxs-lookup"><span data-stu-id="b4876-107">For example, you may want every cell in a <xref:System.Windows.Forms.DataGridView> control to use the same font, but only cells in currency columns to use currency format, and only currency cells with negative numbers to use a red foreground color.</span></span>  
  
## <a name="the-datagridviewcellstyle-class"></a><span data-ttu-id="b4876-108">DataGridViewCellStyle 類別</span><span class="sxs-lookup"><span data-stu-id="b4876-108">The DataGridViewCellStyle Class</span></span>  
 <span data-ttu-id="b4876-109"><xref:System.Windows.Forms.DataGridViewCellStyle>類別包含視覺化樣式的相關的下列屬性：</span><span class="sxs-lookup"><span data-stu-id="b4876-109">The <xref:System.Windows.Forms.DataGridViewCellStyle> class contains the following properties related to visual style:</span></span>  
  
-   <span data-ttu-id="b4876-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="b4876-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span></span>  
  
-   <span data-ttu-id="b4876-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="b4876-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span></span>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Font%2A>  
  
 <span data-ttu-id="b4876-112">這個類別也包含與格式相關的下列屬性：</span><span class="sxs-lookup"><span data-stu-id="b4876-112">This class also contains the following properties related to formatting:</span></span>  
  
-   <span data-ttu-id="b4876-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span><span class="sxs-lookup"><span data-stu-id="b4876-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span></span>  
  
-   <span data-ttu-id="b4876-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span><span class="sxs-lookup"><span data-stu-id="b4876-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span></span>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Alignment%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Padding%2A>  
  
 <span data-ttu-id="b4876-115">如需有關這些屬性和其他儲存格樣式屬性的詳細資訊，請參閱<xref:System.Windows.Forms.DataGridViewCellStyle>另請參閱下一節中列出的參考文件和主題。</span><span class="sxs-lookup"><span data-stu-id="b4876-115">For more information on these properties and other cell-style properties, see the <xref:System.Windows.Forms.DataGridViewCellStyle> reference documentation and the topics listed in the See Also section below.</span></span>  
  
## <a name="using-datagridviewcellstyle-objects"></a><span data-ttu-id="b4876-116">使用 DataGridViewCellStyle 物件</span><span class="sxs-lookup"><span data-stu-id="b4876-116">Using DataGridViewCellStyle Objects</span></span>  
 <span data-ttu-id="b4876-117">您可以擷取<xref:System.Windows.Forms.DataGridViewCellStyle>物件的各種屬性從<xref:System.Windows.Forms.DataGridView>， <xref:System.Windows.Forms.DataGridViewColumn>， <xref:System.Windows.Forms.DataGridViewRow>，和<xref:System.Windows.Forms.DataGridViewCell>類別和其衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="b4876-117">You can retrieve <xref:System.Windows.Forms.DataGridViewCellStyle> objects from various properties of the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and <xref:System.Windows.Forms.DataGridViewCell> classes and their derived classes.</span></span> <span data-ttu-id="b4876-118">如果其中一個屬性有尚未設定，擷取其值將會建立新<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="b4876-118">If one of these properties has not yet been set, retrieving its value will create a new <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="b4876-119">您可以也具現化自己<xref:System.Windows.Forms.DataGridViewCellStyle>物件，並將它們指派給這些屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-119">You can also instantiate your own <xref:System.Windows.Forms.DataGridViewCellStyle> objects and assign them to these properties.</span></span>  
  
 <span data-ttu-id="b4876-120">您可以藉由共用來避免不必要的樣式資訊的重複<xref:System.Windows.Forms.DataGridViewCellStyle>到多個物件<xref:System.Windows.Forms.DataGridView>項目。</span><span class="sxs-lookup"><span data-stu-id="b4876-120">You can avoid unnecessary duplication of style information by sharing <xref:System.Windows.Forms.DataGridViewCellStyle> objects among multiple <xref:System.Windows.Forms.DataGridView> elements.</span></span> <span data-ttu-id="b4876-121">因為控制項、 資料行和資料列層級向下篩選至資料格層級的每個層級設定的樣式，您也可以藉由設定不同於上述的層級的每個層級的只有這些樣式屬性來避免樣式重複資料刪除。</span><span class="sxs-lookup"><span data-stu-id="b4876-121">Because the styles set at the control, column, and row levels filter down through each level to the cell level, you can also avoid style duplication by setting only those style properties at each level that differ from the levels above.</span></span> <span data-ttu-id="b4876-122">這是在樣式繼承一節中詳細描述。</span><span class="sxs-lookup"><span data-stu-id="b4876-122">This is described in more detail in the Style Inheritance section that follows.</span></span>  
  
 <span data-ttu-id="b4876-123">下表列出的主要屬性，取得或設定<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="b4876-123">The following table lists the primary properties that get or set <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span>  
  
|<span data-ttu-id="b4876-124">屬性</span><span class="sxs-lookup"><span data-stu-id="b4876-124">Property</span></span>|<span data-ttu-id="b4876-125">類別</span><span class="sxs-lookup"><span data-stu-id="b4876-125">Classes</span></span>|<span data-ttu-id="b4876-126">描述</span><span class="sxs-lookup"><span data-stu-id="b4876-126">Description</span></span>|  
|--------------|-------------|-----------------|  
|`DefaultCellStyle`|<span data-ttu-id="b4876-127"><xref:System.Windows.Forms.DataGridView><xref:System.Windows.Forms.DataGridViewColumn>， <xref:System.Windows.Forms.DataGridViewRow>，和衍生類別</span><span class="sxs-lookup"><span data-stu-id="b4876-127"><xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and derived classes</span></span>|<span data-ttu-id="b4876-128">取得或設定整個控制項 （包括標題儲存格），在專欄中，或資料列中的所有儲存格所用的預設樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-128">Gets or sets default styles used by all cells in the entire control (including header cells), in a column, or in a row.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="b4876-129">取得或設定控制項中的所有資料列所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-129">Gets or sets default cell styles used by all rows in the control.</span></span> <span data-ttu-id="b4876-130">這不包括標題儲存格。</span><span class="sxs-lookup"><span data-stu-id="b4876-130">This does not include header cells.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="b4876-131">取得或設定控制項中交替資料列所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-131">Gets or sets default cell styles used by alternating rows in the control.</span></span> <span data-ttu-id="b4876-132">用來建立類似 ledger 的效果。</span><span class="sxs-lookup"><span data-stu-id="b4876-132">Used to create a ledger-like effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="b4876-133">取得或設定控制項的資料列行首所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-133">Gets or sets default cell styles used by the control's row headers.</span></span> <span data-ttu-id="b4876-134">如果啟用視覺化樣式所覆寫目前的佈景主題。</span><span class="sxs-lookup"><span data-stu-id="b4876-134">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="b4876-135">取得或設定控制項的資料行行首所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-135">Gets or sets default cell styles used by the control's column headers.</span></span> <span data-ttu-id="b4876-136">如果啟用視覺化樣式所覆寫目前的佈景主題。</span><span class="sxs-lookup"><span data-stu-id="b4876-136">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A>|<span data-ttu-id="b4876-137"><xref:System.Windows.Forms.DataGridViewCell> 類別和衍生的類別</span><span class="sxs-lookup"><span data-stu-id="b4876-137"><xref:System.Windows.Forms.DataGridViewCell> and derived classes</span></span>|<span data-ttu-id="b4876-138">取得或設定資料格層級指定的樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-138">Gets or sets styles specified at the cell level.</span></span> <span data-ttu-id="b4876-139">這些樣式會覆寫繼承自更高層級。</span><span class="sxs-lookup"><span data-stu-id="b4876-139">These styles override those inherited from higher levels.</span></span>|  
|`InheritedStyle`|<span data-ttu-id="b4876-140"><xref:System.Windows.Forms.DataGridViewCell><xref:System.Windows.Forms.DataGridViewRow>， <xref:System.Windows.Forms.DataGridViewColumn>，和衍生類別</span><span class="sxs-lookup"><span data-stu-id="b4876-140"><xref:System.Windows.Forms.DataGridViewCell>, <xref:System.Windows.Forms.DataGridViewRow>, <xref:System.Windows.Forms.DataGridViewColumn>, and derived classes</span></span>|<span data-ttu-id="b4876-141">取得目前套用至資料格、 資料列或資料行，包括樣式繼承自更高層級的所有樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-141">Gets all the styles currently applied to the cell, row, or column, including styles inherited from higher levels.</span></span>|  
  
 <span data-ttu-id="b4876-142">如先前所述，會自動取得樣式屬性的值具現化新<xref:System.Windows.Forms.DataGridViewCellStyle>如果屬性尚未先前設定的物件。</span><span class="sxs-lookup"><span data-stu-id="b4876-142">As mentioned above, getting the value of a style property automatically instantiates a new <xref:System.Windows.Forms.DataGridViewCellStyle> object if the property has not been previously set.</span></span> <span data-ttu-id="b4876-143">若要避免不必要地建立這些物件，資料列和資料行都具有<xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A>屬性，您可以檢查以判斷是否<xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A>屬性已設定。</span><span class="sxs-lookup"><span data-stu-id="b4876-143">To avoid creating these objects unnecessarily, the row and column classes have a <xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A> property that you can check to determine whether the <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A> property has been set.</span></span> <span data-ttu-id="b4876-144">同樣地，資料格都具有<xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A>屬性，指出是否<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性已設定。</span><span class="sxs-lookup"><span data-stu-id="b4876-144">Similarly, the cell classes have a <xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A> property that indicates whether the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property has been set.</span></span>  
  
 <span data-ttu-id="b4876-145">樣式屬性的每個都有對應*PropertyName* `Changed`上的事件<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="b4876-145">Each of the style properties has a corresponding *PropertyName*`Changed` event on the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="b4876-146">資料列、 資料行和資料格屬性，事件的名稱開頭 「`Row`"，"`Column`"，或 「`Cell`」 (比方說， <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>)。</span><span class="sxs-lookup"><span data-stu-id="b4876-146">For row, column, and cell properties, the name of the event begins with "`Row`", "`Column`", or "`Cell`" (for example, <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>).</span></span> <span data-ttu-id="b4876-147">每個事件發生時對應的樣式屬性設定為不同<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="b4876-147">Each of these events occurs when the corresponding style property is set to a different <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="b4876-148">當您擷取這些事件不會發生<xref:System.Windows.Forms.DataGridViewCellStyle>物件的樣式屬性，並修改其屬性值。</span><span class="sxs-lookup"><span data-stu-id="b4876-148">These events do not occur when you retrieve a <xref:System.Windows.Forms.DataGridViewCellStyle> object from a style property and modify its property values.</span></span> <span data-ttu-id="b4876-149">若要回應變更儲存格樣式物件本身，處理<xref:System.Windows.Forms.DataGridView.CellStyleContentChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="b4876-149">To respond to changes to the cell style objects themselves, handle the <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged> event.</span></span>  
  
## <a name="style-inheritance"></a><span data-ttu-id="b4876-150">樣式繼承</span><span class="sxs-lookup"><span data-stu-id="b4876-150">Style Inheritance</span></span>  
 <span data-ttu-id="b4876-151">每個<xref:System.Windows.Forms.DataGridViewCell>取得它的外觀，從其<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-151">Each <xref:System.Windows.Forms.DataGridViewCell> gets its appearance from its <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span> <span data-ttu-id="b4876-152"><xref:System.Windows.Forms.DataGridViewCellStyle>這個屬性所傳回的物件會繼承類型的屬性階層中的其值<xref:System.Windows.Forms.DataGridViewCellStyle>。</span><span class="sxs-lookup"><span data-stu-id="b4876-152">The <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by this property inherits its values from a hierarchy of properties of type <xref:System.Windows.Forms.DataGridViewCellStyle>.</span></span> <span data-ttu-id="b4876-153">這些屬性如下所列的順序在<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>非標頭資料格取得其值。</span><span class="sxs-lookup"><span data-stu-id="b4876-153">These properties are listed below in the order in which the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> for non-header cells obtains its values.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2.  <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
3.  <span data-ttu-id="b4876-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> （僅適用於含有奇數索引資料列中的資料格）</span><span class="sxs-lookup"><span data-stu-id="b4876-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
4.  <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
5.  <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
6.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="b4876-155">資料列和資料行的標頭資料格，<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性由從下列清單中指定的順序的來源屬性的值擴展。</span><span class="sxs-lookup"><span data-stu-id="b4876-155">For row and column header cells, the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property is populated by values from the following list of source properties in the given order.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2.  <span data-ttu-id="b4876-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> 或 <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="b4876-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span></span>  
  
3.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="b4876-157">下圖說明此程序。</span><span class="sxs-lookup"><span data-stu-id="b4876-157">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="b4876-158">![DataGridViewCellStyle 類型的](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells 繼承圖表")</span><span class="sxs-lookup"><span data-stu-id="b4876-158">![Properties of type DataGridViewCellStyle](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells inheritance diagram")</span></span>  
  
 <span data-ttu-id="b4876-159">您也可以存取特定的資料列和資料行所繼承的樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-159">You can also access the styles inherited by specific rows and columns.</span></span> <span data-ttu-id="b4876-160">資料行<xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A>屬性繼承自下列屬性的值。</span><span class="sxs-lookup"><span data-stu-id="b4876-160">The column <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="b4876-161">資料列<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>屬性繼承自下列屬性的值。</span><span class="sxs-lookup"><span data-stu-id="b4876-161">The row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2.  <span data-ttu-id="b4876-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> （僅適用於含有奇數索引資料列中的資料格）</span><span class="sxs-lookup"><span data-stu-id="b4876-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
3.  <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
4.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="b4876-163">中每一個屬性<xref:System.Windows.Forms.DataGridViewCellStyle>所傳回的物件`InheritedStyle`屬性，屬性值取自適當設為值以外的對應屬性的清單中的第一個儲存格樣式<xref:System.Windows.Forms.DataGridViewCellStyle>類別的預設值。</span><span class="sxs-lookup"><span data-stu-id="b4876-163">For each property in a <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by an `InheritedStyle` property, the property value is obtained from the first cell style in the appropriate list that has the corresponding property set to a value other than the <xref:System.Windows.Forms.DataGridViewCellStyle> class defaults.</span></span>  
  
 <span data-ttu-id="b4876-164">下表將說明如何<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>範例資料格的屬性值繼承自其包含的資料行。</span><span class="sxs-lookup"><span data-stu-id="b4876-164">The following table illustrates how the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value for an example cell is inherited from its containing column.</span></span>  
  
|<span data-ttu-id="b4876-165">類型屬性 `DataGridViewCellStyle`</span><span class="sxs-lookup"><span data-stu-id="b4876-165">Property of type `DataGridViewCellStyle`</span></span>|<span data-ttu-id="b4876-166">範例`ForeColor`擷取物件的值</span><span class="sxs-lookup"><span data-stu-id="b4876-166">Example `ForeColor` value for retrieved object</span></span>|  
|----------------------------------------------|----------------------------------------------------|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.DarkBlue%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Black%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="b4876-167">在此情況下，<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>從儲存格的資料列的值是在清單上第一個真正的值。</span><span class="sxs-lookup"><span data-stu-id="b4876-167">In this case, the <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType> value from the cell's row is the first real value on the list.</span></span> <span data-ttu-id="b4876-168">這會變成<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>屬性值的儲存格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>。</span><span class="sxs-lookup"><span data-stu-id="b4876-168">This becomes the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value of the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>.</span></span>  
  
 <span data-ttu-id="b4876-169">下圖說明不同<xref:System.Windows.Forms.DataGridViewCellStyle>屬性可以繼承它們的值，從不同的地方。</span><span class="sxs-lookup"><span data-stu-id="b4876-169">The following diagram illustrates how different <xref:System.Windows.Forms.DataGridViewCellStyle> properties can inherit their values from different places.</span></span>  
  
 <span data-ttu-id="b4876-170">![DataGridView 屬性&#45;值繼承](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells 值繼承圖表")</span><span class="sxs-lookup"><span data-stu-id="b4876-170">![DataGridView property&#45;value inheritance](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells value inheritance diagram")</span></span>  
  
 <span data-ttu-id="b4876-171">利用樣式繼承，您可以提供適當的樣式整個控制項而不需要在多個位置指定相同的資訊。</span><span class="sxs-lookup"><span data-stu-id="b4876-171">By taking advantage of style inheritance, you can provide appropriate styles for the entire control without having to specify the same information in multiple places.</span></span>  
  
 <span data-ttu-id="b4876-172">標頭資料格會參與繼承樣式，如所述，雖然所傳回的物件<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>並<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>屬性的<xref:System.Windows.Forms.DataGridView>控制項必須覆寫所傳回之物件的屬性值的初始屬性值<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-172">Although header cells participate in style inheritance as described, the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties of the <xref:System.Windows.Forms.DataGridView> control have initial property values that override the property values of the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="b4876-173">如果您想為所傳回的物件設定的屬性<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>屬性，將套用至資料列和資料行的標頭，您必須設定對應的屬性所傳回的物件<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>和<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>屬性設為預設值指示針對<xref:System.Windows.Forms.DataGridViewCellStyle>類別。</span><span class="sxs-lookup"><span data-stu-id="b4876-173">If you want the properties set for the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property to apply to row and column headers, you must set the corresponding properties of the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties to the defaults indicated for the <xref:System.Windows.Forms.DataGridViewCellStyle> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b4876-174">如果啟用視覺化樣式，資料列和資料行標頭 (除了<xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) 樣式會自動由目前的佈景主題，並覆寫這些屬性指定任何樣式。</span><span class="sxs-lookup"><span data-stu-id="b4876-174">If visual styles are enabled, the row and column headers (except for the <xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) are automatically styled by the current theme, overriding any styles specified by these properties.</span></span>  
  
 <span data-ttu-id="b4876-175"><xref:System.Windows.Forms.DataGridViewButtonColumn>， <xref:System.Windows.Forms.DataGridViewImageColumn>，並<xref:System.Windows.Forms.DataGridViewCheckBoxColumn>型別也會初始化資料行所傳回之物件一些值<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-175">The <xref:System.Windows.Forms.DataGridViewButtonColumn>, <xref:System.Windows.Forms.DataGridViewImageColumn>, and <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> types also initialize some values of the object returned by the column <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="b4876-176">如需詳細資訊，請參閱這些類型的參考文件。</span><span class="sxs-lookup"><span data-stu-id="b4876-176">For more information, see the reference documentation for these types.</span></span>  
  
## <a name="setting-styles-dynamically"></a><span data-ttu-id="b4876-177">以動態方式設定樣式</span><span class="sxs-lookup"><span data-stu-id="b4876-177">Setting Styles Dynamically</span></span>  
 <span data-ttu-id="b4876-178">若要自訂的特定值的資料格的樣式，實作的處理常式<xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>事件。</span><span class="sxs-lookup"><span data-stu-id="b4876-178">To customize the styles of cells with particular values, implement a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="b4876-179">這個事件處理常式收到的引數<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs>型別。</span><span class="sxs-lookup"><span data-stu-id="b4876-179">Handlers for this event receive an argument of the <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs> type.</span></span> <span data-ttu-id="b4876-180">此物件包含的屬性，可讓您判斷的值中的位置以及要格式化的儲存格之<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="b4876-180">This object contains properties that let you determine the value of the cell being formatted along with its location in the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="b4876-181">此物件也包含<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A>初始化為值的屬性<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>正在格式化資料格的屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-181">This object also contains a <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A> property that is initialized to the value of the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property of the cell being formatted.</span></span> <span data-ttu-id="b4876-182">您可以修改以指定適當的資料格的值和位置的樣式資訊的儲存格樣式屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-182">You can modify the cell style properties to specify style information appropriate to the cell value and location.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b4876-183"><xref:System.Windows.Forms.DataGridView.RowPrePaint>並<xref:System.Windows.Forms.DataGridView.RowPostPaint>事件也會收到<xref:System.Windows.Forms.DataGridViewCellStyle>在事件物件的資料，但在它們的大小寫的資料列的副本<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>唯讀用途，並變更它的屬性不會影響控制項。</span><span class="sxs-lookup"><span data-stu-id="b4876-183">The <xref:System.Windows.Forms.DataGridView.RowPrePaint> and <xref:System.Windows.Forms.DataGridView.RowPostPaint> events also receive a <xref:System.Windows.Forms.DataGridViewCellStyle> object in the event data, but in their case, it is a copy of the row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property for read-only purposes, and changes to it do not affect the control.</span></span>  
  
 <span data-ttu-id="b4876-184">例如您可以也會動態地修改以回應事件的個別儲存格的樣式<xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType>和<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件。</span><span class="sxs-lookup"><span data-stu-id="b4876-184">You can also dynamically modify the styles of individual cells in response to events such as the <xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridView.CellMouseLeave> events.</span></span> <span data-ttu-id="b4876-185">比方說，在處理常式<xref:System.Windows.Forms.DataGridView.CellMouseEnter>事件，您可以儲存的資料格背景色彩的目前值 (透過儲存格的擷取<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性)，然後將它設定為新的色彩，會反白顯示儲存格的滑鼠停留在其上方時。</span><span class="sxs-lookup"><span data-stu-id="b4876-185">For example, in a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseEnter> event, you could store the current value of the cell background color (retrieved through the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property), then set it to a new color that will highlight the cell when the mouse hovers over it.</span></span> <span data-ttu-id="b4876-186">中的處理常式<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件，您接著可以還原的背景色彩至原始的值。</span><span class="sxs-lookup"><span data-stu-id="b4876-186">In a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseLeave> event, you can then restore the background color to the original value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="b4876-187">快取儲存在儲存格的值<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性是非常重要，不論是否已設定特定的樣式值。</span><span class="sxs-lookup"><span data-stu-id="b4876-187">Caching the values stored in the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property is important regardless of whether a particular style value is set.</span></span> <span data-ttu-id="b4876-188">如果您暫時將樣式設定，將它還原到其原始的 「 未設定 」 狀態可確保儲存格將回送到較高層級繼承樣式設定。</span><span class="sxs-lookup"><span data-stu-id="b4876-188">If you temporarily replace a style setting, restoring it to its original "not set" state ensures that the cell will go back to inheriting the style setting from a higher level.</span></span> <span data-ttu-id="b4876-189">如果您需要決定儲存格值，不管是否繼承樣式是作用中的實際樣式，請使用儲存格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="b4876-189">If you need to determine the actual style in effect for a cell regardless of whether the style is inherited, use the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="b4876-190">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b4876-190">See also</span></span>
- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridViewCellStyle>
- <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPrePaint?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPostPaint?displayProperty=nameWithType>
- [<span data-ttu-id="b4876-191">Windows Forms DataGridView 控制項中的基本格式化和樣式設定</span><span class="sxs-lookup"><span data-stu-id="b4876-191">Basic Formatting and Styling in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/basic-formatting-and-styling-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="b4876-192">如何：為 Windows Form DataGridView 控制項中的預設儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="b4876-192">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="b4876-193">Windows Forms DataGridView 控制項中的資料格式</span><span class="sxs-lookup"><span data-stu-id="b4876-193">Data Formatting in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/data-formatting-in-the-windows-forms-datagridview-control.md)
