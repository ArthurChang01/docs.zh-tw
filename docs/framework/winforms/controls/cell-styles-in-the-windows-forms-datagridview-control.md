---
title: Windows Form DataGridView 控制項中的儲存格樣式
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], cell styles
- cells [Windows Forms], styles
- data grids [Windows Forms], cell styles
ms.assetid: dbb75ed6-8804-4232-8382-f9920c2e380c
ms.openlocfilehash: be4c47db5c56685a84153a9ae4a9a2fe14c6adad
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/22/2019
ms.locfileid: "69917761"
---
# <a name="cell-styles-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="ecebf-102">Windows Form DataGridView 控制項中的儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="ecebf-102">Cell Styles in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="ecebf-103">控制項中的<xref:System.Windows.Forms.DataGridView>每個資料格都可以有自己的樣式, 例如文字格式、背景色彩、前景色彩和字型。</span><span class="sxs-lookup"><span data-stu-id="ecebf-103">Each cell within the <xref:System.Windows.Forms.DataGridView> control can have its own style, such as text format, background color, foreground color, and font.</span></span> <span data-ttu-id="ecebf-104">不過, 通常多個資料格會共用特定的樣式特性。</span><span class="sxs-lookup"><span data-stu-id="ecebf-104">Typically, however, multiple cells will share particular style characteristics.</span></span>  
  
 <span data-ttu-id="ecebf-105">共用樣式的資料格群組可能包括特定資料列或資料行中的所有儲存格、包含特定值的所有儲存格, 或控制項中的所有儲存格。</span><span class="sxs-lookup"><span data-stu-id="ecebf-105">Groups of cells that share styles may include all cells within particular rows or columns, all cells that contain particular values, or all cells in the control.</span></span> <span data-ttu-id="ecebf-106">因為這些群組會重迭, 所以每個資料格可能會從多個位置取得其樣式資訊。</span><span class="sxs-lookup"><span data-stu-id="ecebf-106">Because these groups overlap, each cell may get its styling information from more than one place.</span></span> <span data-ttu-id="ecebf-107">例如, 您可能希望<xref:System.Windows.Forms.DataGridView>控制項中的每個儲存格都使用相同的字型, 但只有貨幣資料行中的儲存格才會使用貨幣格式, 而只有包含負數的貨幣儲存格才會使用紅色前景色彩。</span><span class="sxs-lookup"><span data-stu-id="ecebf-107">For example, you may want every cell in a <xref:System.Windows.Forms.DataGridView> control to use the same font, but only cells in currency columns to use currency format, and only currency cells with negative numbers to use a red foreground color.</span></span>  
  
## <a name="the-datagridviewcellstyle-class"></a><span data-ttu-id="ecebf-108">DataGridViewCellStyle 類別</span><span class="sxs-lookup"><span data-stu-id="ecebf-108">The DataGridViewCellStyle Class</span></span>  
 <span data-ttu-id="ecebf-109"><xref:System.Windows.Forms.DataGridViewCellStyle>類別包含下列與視覺化樣式相關的屬性:</span><span class="sxs-lookup"><span data-stu-id="ecebf-109">The <xref:System.Windows.Forms.DataGridViewCellStyle> class contains the following properties related to visual style:</span></span>  
  
- <span data-ttu-id="ecebf-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="ecebf-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span></span>  
  
- <span data-ttu-id="ecebf-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="ecebf-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span></span>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.Font%2A>  
  
 <span data-ttu-id="ecebf-112">這個類別也包含下列與格式相關的屬性:</span><span class="sxs-lookup"><span data-stu-id="ecebf-112">This class also contains the following properties related to formatting:</span></span>  
  
- <span data-ttu-id="ecebf-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span><span class="sxs-lookup"><span data-stu-id="ecebf-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span></span>  
  
- <span data-ttu-id="ecebf-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span><span class="sxs-lookup"><span data-stu-id="ecebf-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span></span>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.Alignment%2A>  
  
- <xref:System.Windows.Forms.DataGridViewCellStyle.Padding%2A>  
  
 <span data-ttu-id="ecebf-115">如需這些屬性和其他儲存格樣式屬性的詳細資訊, 請<xref:System.Windows.Forms.DataGridViewCellStyle>參閱參考檔和下一節中所列的主題。</span><span class="sxs-lookup"><span data-stu-id="ecebf-115">For more information on these properties and other cell-style properties, see the <xref:System.Windows.Forms.DataGridViewCellStyle> reference documentation and the topics listed in the See Also section below.</span></span>  
  
## <a name="using-datagridviewcellstyle-objects"></a><span data-ttu-id="ecebf-116">使用 DataGridViewCellStyle 物件</span><span class="sxs-lookup"><span data-stu-id="ecebf-116">Using DataGridViewCellStyle Objects</span></span>  
 <span data-ttu-id="ecebf-117">您可以<xref:System.Windows.Forms.DataGridViewCellStyle>從<xref:System.Windows.Forms.DataGridView>、 <xref:System.Windows.Forms.DataGridViewColumn>、和類別<xref:System.Windows.Forms.DataGridViewCell>的各種屬性和其衍生類別抓取物件。 <xref:System.Windows.Forms.DataGridViewRow></span><span class="sxs-lookup"><span data-stu-id="ecebf-117">You can retrieve <xref:System.Windows.Forms.DataGridViewCellStyle> objects from various properties of the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and <xref:System.Windows.Forms.DataGridViewCell> classes and their derived classes.</span></span> <span data-ttu-id="ecebf-118">如果尚未設定這些屬性的其中一個, 則抓取其值將會建立新<xref:System.Windows.Forms.DataGridViewCellStyle>的物件。</span><span class="sxs-lookup"><span data-stu-id="ecebf-118">If one of these properties has not yet been set, retrieving its value will create a new <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="ecebf-119">您也可以具現化<xref:System.Windows.Forms.DataGridViewCellStyle>自己的物件, 並將它們指派給這些屬性。</span><span class="sxs-lookup"><span data-stu-id="ecebf-119">You can also instantiate your own <xref:System.Windows.Forms.DataGridViewCellStyle> objects and assign them to these properties.</span></span>  
  
 <span data-ttu-id="ecebf-120">您可以在多個<xref:System.Windows.Forms.DataGridViewCellStyle> <xref:System.Windows.Forms.DataGridView>專案之間共用物件, 以避免不必要的樣式資訊重複。</span><span class="sxs-lookup"><span data-stu-id="ecebf-120">You can avoid unnecessary duplication of style information by sharing <xref:System.Windows.Forms.DataGridViewCellStyle> objects among multiple <xref:System.Windows.Forms.DataGridView> elements.</span></span> <span data-ttu-id="ecebf-121">由於在控制項、資料行和資料列層級設定的樣式會向下篩選到資料格層級, 因此您也可以在每個層級上設定不同于上述層級的樣式屬性, 以避免樣式重複。</span><span class="sxs-lookup"><span data-stu-id="ecebf-121">Because the styles set at the control, column, and row levels filter down through each level to the cell level, you can also avoid style duplication by setting only those style properties at each level that differ from the levels above.</span></span> <span data-ttu-id="ecebf-122">這在下面的 [樣式繼承] 區段中有更詳細的說明。</span><span class="sxs-lookup"><span data-stu-id="ecebf-122">This is described in more detail in the Style Inheritance section that follows.</span></span>  
  
 <span data-ttu-id="ecebf-123">下表列出取得或設定<xref:System.Windows.Forms.DataGridViewCellStyle>物件的主要屬性。</span><span class="sxs-lookup"><span data-stu-id="ecebf-123">The following table lists the primary properties that get or set <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span>  
  
|<span data-ttu-id="ecebf-124">屬性</span><span class="sxs-lookup"><span data-stu-id="ecebf-124">Property</span></span>|<span data-ttu-id="ecebf-125">類別</span><span class="sxs-lookup"><span data-stu-id="ecebf-125">Classes</span></span>|<span data-ttu-id="ecebf-126">描述</span><span class="sxs-lookup"><span data-stu-id="ecebf-126">Description</span></span>|  
|--------------|-------------|-----------------|  
|`DefaultCellStyle`|<span data-ttu-id="ecebf-127"><xref:System.Windows.Forms.DataGridView>、 <xref:System.Windows.Forms.DataGridViewColumn> 、<xref:System.Windows.Forms.DataGridViewRow>和衍生類別</span><span class="sxs-lookup"><span data-stu-id="ecebf-127"><xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and derived classes</span></span>|<span data-ttu-id="ecebf-128">取得或設定在整個控制項 (包括標題儲存格)、資料行或資料列中的所有儲存格所使用的預設樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-128">Gets or sets default styles used by all cells in the entire control (including header cells), in a column, or in a row.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="ecebf-129">取得或設定控制項中所有資料列所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-129">Gets or sets default cell styles used by all rows in the control.</span></span> <span data-ttu-id="ecebf-130">這不包含標頭資料格。</span><span class="sxs-lookup"><span data-stu-id="ecebf-130">This does not include header cells.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="ecebf-131">取得或設定控制項中交替資料列所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-131">Gets or sets default cell styles used by alternating rows in the control.</span></span> <span data-ttu-id="ecebf-132">用來建立類似總帳的效果。</span><span class="sxs-lookup"><span data-stu-id="ecebf-132">Used to create a ledger-like effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="ecebf-133">取得或設定控制項的資料列標頭所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-133">Gets or sets default cell styles used by the control's row headers.</span></span> <span data-ttu-id="ecebf-134">如果已啟用視覺化樣式, 則會由目前的主題覆寫。</span><span class="sxs-lookup"><span data-stu-id="ecebf-134">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="ecebf-135">取得或設定控制項的資料行標頭所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-135">Gets or sets default cell styles used by the control's column headers.</span></span> <span data-ttu-id="ecebf-136">如果已啟用視覺化樣式, 則會由目前的主題覆寫。</span><span class="sxs-lookup"><span data-stu-id="ecebf-136">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A>|<span data-ttu-id="ecebf-137"><xref:System.Windows.Forms.DataGridViewCell>和衍生類別</span><span class="sxs-lookup"><span data-stu-id="ecebf-137"><xref:System.Windows.Forms.DataGridViewCell> and derived classes</span></span>|<span data-ttu-id="ecebf-138">取得或設定在資料格層級指定的樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-138">Gets or sets styles specified at the cell level.</span></span> <span data-ttu-id="ecebf-139">這些樣式會覆寫繼承自較高層級的那些樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-139">These styles override those inherited from higher levels.</span></span>|  
|`InheritedStyle`|<span data-ttu-id="ecebf-140"><xref:System.Windows.Forms.DataGridViewCell>、 <xref:System.Windows.Forms.DataGridViewRow> 、<xref:System.Windows.Forms.DataGridViewColumn>和衍生類別</span><span class="sxs-lookup"><span data-stu-id="ecebf-140"><xref:System.Windows.Forms.DataGridViewCell>, <xref:System.Windows.Forms.DataGridViewRow>, <xref:System.Windows.Forms.DataGridViewColumn>, and derived classes</span></span>|<span data-ttu-id="ecebf-141">取得目前套用至儲存格、資料列或資料行的所有樣式, 包括繼承自較高層級的樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-141">Gets all the styles currently applied to the cell, row, or column, including styles inherited from higher levels.</span></span>|  
  
 <span data-ttu-id="ecebf-142">如前所述, 如果先前尚未設定屬性, 取得 style 屬性的值會自動<xref:System.Windows.Forms.DataGridViewCellStyle>具現化新的物件。</span><span class="sxs-lookup"><span data-stu-id="ecebf-142">As mentioned above, getting the value of a style property automatically instantiates a new <xref:System.Windows.Forms.DataGridViewCellStyle> object if the property has not been previously set.</span></span> <span data-ttu-id="ecebf-143">為了避免不必要地建立這些物件, 資料列和資料行<xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A>類別具有可供您檢查的<xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A>屬性, 以判斷屬性是否已設定。</span><span class="sxs-lookup"><span data-stu-id="ecebf-143">To avoid creating these objects unnecessarily, the row and column classes have a <xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A> property that you can check to determine whether the <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A> property has been set.</span></span> <span data-ttu-id="ecebf-144">同樣地, 資料格類別具有<xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A>屬性, 可指出<xref:System.Windows.Forms.DataGridViewCell.Style%2A>是否已設定屬性。</span><span class="sxs-lookup"><span data-stu-id="ecebf-144">Similarly, the cell classes have a <xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A> property that indicates whether the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property has been set.</span></span>  
  
 <span data-ttu-id="ecebf-145">每個樣式屬性在<xref:System.Windows.Forms.DataGridView>控制項上都有對應的*PropertyName* `Changed`事件。</span><span class="sxs-lookup"><span data-stu-id="ecebf-145">Each of the style properties has a corresponding *PropertyName*`Changed` event on the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="ecebf-146">針對資料列、資料行和資料格屬性, 事件的名稱開頭為 "`Row`"、"`Column`" 或 "`Cell`" ( <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>例如)。</span><span class="sxs-lookup"><span data-stu-id="ecebf-146">For row, column, and cell properties, the name of the event begins with "`Row`", "`Column`", or "`Cell`" (for example, <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>).</span></span> <span data-ttu-id="ecebf-147">當對應的樣式屬性設定為不同<xref:System.Windows.Forms.DataGridViewCellStyle>的物件時, 就會發生這些事件。</span><span class="sxs-lookup"><span data-stu-id="ecebf-147">Each of these events occurs when the corresponding style property is set to a different <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="ecebf-148">當您從樣式屬性取得<xref:System.Windows.Forms.DataGridViewCellStyle>物件並修改其屬性值時, 不會發生這些事件。</span><span class="sxs-lookup"><span data-stu-id="ecebf-148">These events do not occur when you retrieve a <xref:System.Windows.Forms.DataGridViewCellStyle> object from a style property and modify its property values.</span></span> <span data-ttu-id="ecebf-149">若要回應儲存格樣式物件本身的變更, 請處理<xref:System.Windows.Forms.DataGridView.CellStyleContentChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="ecebf-149">To respond to changes to the cell style objects themselves, handle the <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged> event.</span></span>  
  
## <a name="style-inheritance"></a><span data-ttu-id="ecebf-150">樣式繼承</span><span class="sxs-lookup"><span data-stu-id="ecebf-150">Style Inheritance</span></span>  
 <span data-ttu-id="ecebf-151">每<xref:System.Windows.Forms.DataGridViewCell>個都會從其<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性取得其外觀。</span><span class="sxs-lookup"><span data-stu-id="ecebf-151">Each <xref:System.Windows.Forms.DataGridViewCell> gets its appearance from its <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span> <span data-ttu-id="ecebf-152">這個<xref:System.Windows.Forms.DataGridViewCellStyle>屬性所傳回的物件會從類型<xref:System.Windows.Forms.DataGridViewCellStyle>的屬性階層繼承其值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-152">The <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by this property inherits its values from a hierarchy of properties of type <xref:System.Windows.Forms.DataGridViewCellStyle>.</span></span> <span data-ttu-id="ecebf-153">下列屬性會依照的順序<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>列在中, 以供非標頭儲存格取得其值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-153">These properties are listed below in the order in which the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> for non-header cells obtains its values.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
3. <span data-ttu-id="ecebf-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>(僅適用于具有奇數索引編號的資料列中的儲存格)</span><span class="sxs-lookup"><span data-stu-id="ecebf-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
4. <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
5. <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
6. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="ecebf-155">若是資料列和資料行標頭單元<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>格, 屬性會依指定順序填入下列來源屬性清單中的值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-155">For row and column header cells, the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property is populated by values from the following list of source properties in the given order.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2. <span data-ttu-id="ecebf-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> 或 <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="ecebf-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span></span>  
  
3. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="ecebf-157">下圖說明此程式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-157">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="ecebf-158">![DataGridViewCellStyle 類型的屬性](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells 繼承圖表")</span><span class="sxs-lookup"><span data-stu-id="ecebf-158">![Properties of type DataGridViewCellStyle](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-inheritance-diagram.gif "DataGridViewCells inheritance diagram")</span></span>  
  
 <span data-ttu-id="ecebf-159">您也可以存取特定資料列和資料行所繼承的樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-159">You can also access the styles inherited by specific rows and columns.</span></span> <span data-ttu-id="ecebf-160">Column <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A>屬性會從下列屬性繼承其值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-160">The column <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="ecebf-161">Row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>屬性會從下列屬性繼承其值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-161">The row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1. <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2. <span data-ttu-id="ecebf-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>(僅適用于具有奇數索引編號的資料列中的儲存格)</span><span class="sxs-lookup"><span data-stu-id="ecebf-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
3. <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
4. <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="ecebf-163">針對<xref:System.Windows.Forms.DataGridViewCellStyle> 屬性`InheritedStyle`所傳回之物件中的每個屬性, 會從適當清單中的第一個儲存格樣式取得屬性值, 而該對應屬性會設定為<xref:System.Windows.Forms.DataGridViewCellStyle>類別預設值以外的值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-163">For each property in a <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by an `InheritedStyle` property, the property value is obtained from the first cell style in the appropriate list that has the corresponding property set to a value other than the <xref:System.Windows.Forms.DataGridViewCellStyle> class defaults.</span></span>  
  
 <span data-ttu-id="ecebf-164">下表說明範例資料格<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>的屬性值如何繼承自其包含的資料行。</span><span class="sxs-lookup"><span data-stu-id="ecebf-164">The following table illustrates how the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value for an example cell is inherited from its containing column.</span></span>  
  
|<span data-ttu-id="ecebf-165">類型的屬性`DataGridViewCellStyle`</span><span class="sxs-lookup"><span data-stu-id="ecebf-165">Property of type `DataGridViewCellStyle`</span></span>|<span data-ttu-id="ecebf-166">抓取`ForeColor`物件的範例值</span><span class="sxs-lookup"><span data-stu-id="ecebf-166">Example `ForeColor` value for retrieved object</span></span>|  
|----------------------------------------------|----------------------------------------------------|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.DarkBlue%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Black%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="ecebf-167">在此情況下, <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>資料格資料列中的值是清單中的第一個實際值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-167">In this case, the <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType> value from the cell's row is the first real value on the list.</span></span> <span data-ttu-id="ecebf-168">這會變成<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>儲存格的屬性值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-168">This becomes the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value of the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>.</span></span>  
  
 <span data-ttu-id="ecebf-169">下圖說明不同<xref:System.Windows.Forms.DataGridViewCellStyle>的屬性如何從不同的位置繼承其值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-169">The following diagram illustrates how different <xref:System.Windows.Forms.DataGridViewCellStyle> properties can inherit their values from different places.</span></span>  
  
 <span data-ttu-id="ecebf-170">![DataGridView 屬性&#45;值繼承](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells 值繼承圖表")</span><span class="sxs-lookup"><span data-stu-id="ecebf-170">![DataGridView property&#45;value inheritance](./media/cell-styles-in-the-windows-forms-datagridview-control/datagridviewcells-value-inheritance-diagram.gif "DataGridViewCells value inheritance diagram")</span></span>  
  
 <span data-ttu-id="ecebf-171">藉由利用樣式繼承, 您可以為整個控制項提供適當的樣式, 而不需要在多個位置指定相同的資訊。</span><span class="sxs-lookup"><span data-stu-id="ecebf-171">By taking advantage of style inheritance, you can provide appropriate styles for the entire control without having to specify the same information in multiple places.</span></span>  
  
 <span data-ttu-id="ecebf-172">雖然標頭儲存格會依照所述的方式參與樣式繼承, <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>但<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> <xref:System.Windows.Forms.DataGridView>控制項的和屬性所傳回的物件具有初始屬性值, 可覆寫所傳回之物件的屬性值。<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ecebf-172">Although header cells participate in style inheritance as described, the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties of the <xref:System.Windows.Forms.DataGridView> control have initial property values that override the property values of the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="ecebf-173">如果您想要將<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>屬性所傳回之物件的屬性設定為套用到資料列和資料行標頭, 您必須將<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>和<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>屬性所傳回之物件的對應屬性設定為指定的預設值<xref:System.Windows.Forms.DataGridViewCellStyle>類別的。</span><span class="sxs-lookup"><span data-stu-id="ecebf-173">If you want the properties set for the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property to apply to row and column headers, you must set the corresponding properties of the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties to the defaults indicated for the <xref:System.Windows.Forms.DataGridViewCellStyle> class.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ecebf-174">如果啟用視覺化樣式, 則會由目前的主題自動將資料列<xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>和資料行標頭 (除外) 樣式化, 以覆寫這些屬性所指定的任何樣式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-174">If visual styles are enabled, the row and column headers (except for the <xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) are automatically styled by the current theme, overriding any styles specified by these properties.</span></span>  
  
 <span data-ttu-id="ecebf-175">、和類型也會初始化資料行<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A>屬性所傳回之物件的一些值。 <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> <xref:System.Windows.Forms.DataGridViewImageColumn> <xref:System.Windows.Forms.DataGridViewButtonColumn></span><span class="sxs-lookup"><span data-stu-id="ecebf-175">The <xref:System.Windows.Forms.DataGridViewButtonColumn>, <xref:System.Windows.Forms.DataGridViewImageColumn>, and <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> types also initialize some values of the object returned by the column <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="ecebf-176">如需詳細資訊, 請參閱這些類型的參考檔。</span><span class="sxs-lookup"><span data-stu-id="ecebf-176">For more information, see the reference documentation for these types.</span></span>  
  
## <a name="setting-styles-dynamically"></a><span data-ttu-id="ecebf-177">動態設定樣式</span><span class="sxs-lookup"><span data-stu-id="ecebf-177">Setting Styles Dynamically</span></span>  
 <span data-ttu-id="ecebf-178">若要自訂具有特定值的儲存格樣式, 請執行<xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>事件的處理常式。</span><span class="sxs-lookup"><span data-stu-id="ecebf-178">To customize the styles of cells with particular values, implement a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="ecebf-179">這個事件的處理常式會接收<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs>類型的引數。</span><span class="sxs-lookup"><span data-stu-id="ecebf-179">Handlers for this event receive an argument of the <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs> type.</span></span> <span data-ttu-id="ecebf-180">這個物件所包含的屬性可讓您判斷要格式化的儲存格值, 以及其在<xref:System.Windows.Forms.DataGridView>控制項中的位置。</span><span class="sxs-lookup"><span data-stu-id="ecebf-180">This object contains properties that let you determine the value of the cell being formatted along with its location in the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="ecebf-181">這個物件也包含一個<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A>屬性, 它會初始化為正在格式化之<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>儲存格的屬性值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-181">This object also contains a <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A> property that is initialized to the value of the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property of the cell being formatted.</span></span> <span data-ttu-id="ecebf-182">您可以修改儲存格樣式屬性, 以指定適合儲存格值和位置的樣式資訊。</span><span class="sxs-lookup"><span data-stu-id="ecebf-182">You can modify the cell style properties to specify style information appropriate to the cell value and location.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ecebf-183">和事件也會在事件<xref:System.Windows.Forms.DataGridViewCellStyle>資料中接收物件, 但在其情況下, 它是唯讀用途的資料列<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>屬性複本, 而且對其所做的變更不會影響控制項。 <xref:System.Windows.Forms.DataGridView.RowPostPaint> <xref:System.Windows.Forms.DataGridView.RowPrePaint></span><span class="sxs-lookup"><span data-stu-id="ecebf-183">The <xref:System.Windows.Forms.DataGridView.RowPrePaint> and <xref:System.Windows.Forms.DataGridView.RowPostPaint> events also receive a <xref:System.Windows.Forms.DataGridViewCellStyle> object in the event data, but in their case, it is a copy of the row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property for read-only purposes, and changes to it do not affect the control.</span></span>  
  
 <span data-ttu-id="ecebf-184">您也可以動態修改個別資料格的樣式, 以回應事件 (例如<xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType>和<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件)。</span><span class="sxs-lookup"><span data-stu-id="ecebf-184">You can also dynamically modify the styles of individual cells in response to events such as the <xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridView.CellMouseLeave> events.</span></span> <span data-ttu-id="ecebf-185">例如, 在<xref:System.Windows.Forms.DataGridView.CellMouseEnter>事件的處理常式中, 您可以儲存儲存格背景色彩的目前值 (透過儲存格的<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性抓取), 然後將它設定為新的色彩, 當滑鼠停留在資料格上方時, 就會反白顯示該儲存格。</span><span class="sxs-lookup"><span data-stu-id="ecebf-185">For example, in a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseEnter> event, you could store the current value of the cell background color (retrieved through the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property), then set it to a new color that will highlight the cell when the mouse hovers over it.</span></span> <span data-ttu-id="ecebf-186">在<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件的處理常式中, 您可以將背景色彩還原成原始值。</span><span class="sxs-lookup"><span data-stu-id="ecebf-186">In a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseLeave> event, you can then restore the background color to the original value.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="ecebf-187">無論是否已設定特定的樣式值<xref:System.Windows.Forms.DataGridViewCell.Style%2A> , 快取儲存在儲存格屬性中的值都很重要。</span><span class="sxs-lookup"><span data-stu-id="ecebf-187">Caching the values stored in the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property is important regardless of whether a particular style value is set.</span></span> <span data-ttu-id="ecebf-188">如果您暫時取代樣式設定, 將它還原成其原始的「未設定」狀態, 可確保資料格會回到繼承較高層級的樣式設定。</span><span class="sxs-lookup"><span data-stu-id="ecebf-188">If you temporarily replace a style setting, restoring it to its original "not set" state ensures that the cell will go back to inheriting the style setting from a higher level.</span></span> <span data-ttu-id="ecebf-189">如果您需要判斷資料格的實際有效樣式 (不論該樣式是否已繼承), 請使用資料格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="ecebf-189">If you need to determine the actual style in effect for a cell regardless of whether the style is inherited, use the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="ecebf-190">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ecebf-190">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridViewCellStyle>
- <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPrePaint?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowPostPaint?displayProperty=nameWithType>
- [<span data-ttu-id="ecebf-191">Windows Forms DataGridView 控制項中的基本格式化和樣式設定</span><span class="sxs-lookup"><span data-stu-id="ecebf-191">Basic Formatting and Styling in the Windows Forms DataGridView Control</span></span>](basic-formatting-and-styling-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="ecebf-192">如何：設定 Windows Forms DataGridView 控制項的預設儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="ecebf-192">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="ecebf-193">Windows Forms DataGridView 控制項中的資料格式</span><span class="sxs-lookup"><span data-stu-id="ecebf-193">Data Formatting in the Windows Forms DataGridView Control</span></span>](data-formatting-in-the-windows-forms-datagridview-control.md)
