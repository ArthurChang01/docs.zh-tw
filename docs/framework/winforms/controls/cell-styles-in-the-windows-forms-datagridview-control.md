---
title: Windows Form DataGridView 控制項中的儲存格樣式
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], cell styles
- cells [Windows Forms], styles
- data grids [Windows Forms], cell styles
ms.assetid: dbb75ed6-8804-4232-8382-f9920c2e380c
ms.openlocfilehash: 463fbbffe1e88991934f08fbe7e7445b2e233081
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33529655"
---
# <a name="cell-styles-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="a37b8-102">Windows Form DataGridView 控制項中的儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="a37b8-102">Cell Styles in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="a37b8-103">每個資料格內<xref:System.Windows.Forms.DataGridView>控制項可以有它自己的樣式，例如，文字格式、 背景色彩、 前景色彩和字型。</span><span class="sxs-lookup"><span data-stu-id="a37b8-103">Each cell within the <xref:System.Windows.Forms.DataGridView> control can have its own style, such as text format, background color, foreground color, and font.</span></span> <span data-ttu-id="a37b8-104">通常，不過，多個資料格會共用特定的樣式特性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-104">Typically, however, multiple cells will share particular style characteristics.</span></span>  
  
 <span data-ttu-id="a37b8-105">群組的共用樣式的資料格可能包含特定的資料列或資料行，所有的資料格包含特定值或所有儲存格內的所有資料格控制項中。</span><span class="sxs-lookup"><span data-stu-id="a37b8-105">Groups of cells that share styles may include all cells within particular rows or columns, all cells that contain particular values, or all cells in the control.</span></span> <span data-ttu-id="a37b8-106">這些群組重疊，因為每個資料格可能會收到多個位置的樣式設定資訊。</span><span class="sxs-lookup"><span data-stu-id="a37b8-106">Because these groups overlap, each cell may get its styling information from more than one place.</span></span> <span data-ttu-id="a37b8-107">例如，您可能想每個資料格在<xref:System.Windows.Forms.DataGridView>控制項使用的相同字型，但只使用貨幣格式的貨幣資料行中的資料格和只有貨幣資料格具有負數使用紅色前景色彩。</span><span class="sxs-lookup"><span data-stu-id="a37b8-107">For example, you may want every cell in a <xref:System.Windows.Forms.DataGridView> control to use the same font, but only cells in currency columns to use currency format, and only currency cells with negative numbers to use a red foreground color.</span></span>  
  
## <a name="the-datagridviewcellstyle-class"></a><span data-ttu-id="a37b8-108">DataGridViewCellStyle 類別</span><span class="sxs-lookup"><span data-stu-id="a37b8-108">The DataGridViewCellStyle Class</span></span>  
 <span data-ttu-id="a37b8-109"><xref:System.Windows.Forms.DataGridViewCellStyle>類別包含視覺化樣式相關的下列屬性：</span><span class="sxs-lookup"><span data-stu-id="a37b8-109">The <xref:System.Windows.Forms.DataGridViewCellStyle> class contains the following properties related to visual style:</span></span>  
  
-   <span data-ttu-id="a37b8-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="a37b8-110"><xref:System.Windows.Forms.DataGridViewCellStyle.BackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A></span></span>  
  
-   <span data-ttu-id="a37b8-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span><span class="sxs-lookup"><span data-stu-id="a37b8-111"><xref:System.Windows.Forms.DataGridViewCellStyle.SelectionBackColor%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.SelectionForeColor%2A></span></span>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Font%2A>  
  
 <span data-ttu-id="a37b8-112">這個類別也包含與格式相關的下列屬性：</span><span class="sxs-lookup"><span data-stu-id="a37b8-112">This class also contains the following properties related to formatting:</span></span>  
  
-   <span data-ttu-id="a37b8-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span><span class="sxs-lookup"><span data-stu-id="a37b8-113"><xref:System.Windows.Forms.DataGridViewCellStyle.Format%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.FormatProvider%2A></span></span>  
  
-   <span data-ttu-id="a37b8-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> 和 <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span><span class="sxs-lookup"><span data-stu-id="a37b8-114"><xref:System.Windows.Forms.DataGridViewCellStyle.NullValue%2A> and <xref:System.Windows.Forms.DataGridViewCellStyle.DataSourceNullValue%2A></span></span>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Alignment%2A>  
  
-   <xref:System.Windows.Forms.DataGridViewCellStyle.Padding%2A>  
  
 <span data-ttu-id="a37b8-115">如需有關這些屬性和其他儲存格樣式屬性的詳細資訊，請參閱<xref:System.Windows.Forms.DataGridViewCellStyle>參考文件和主題所列在 < 另請參閱下一節。</span><span class="sxs-lookup"><span data-stu-id="a37b8-115">For more information on these properties and other cell-style properties, see the <xref:System.Windows.Forms.DataGridViewCellStyle> reference documentation and the topics listed in the See Also section below.</span></span>  
  
## <a name="using-datagridviewcellstyle-objects"></a><span data-ttu-id="a37b8-116">使用 DataGridViewCellStyle 物件</span><span class="sxs-lookup"><span data-stu-id="a37b8-116">Using DataGridViewCellStyle Objects</span></span>  
 <span data-ttu-id="a37b8-117">您可以擷取<xref:System.Windows.Forms.DataGridViewCellStyle>物件的各種屬性從<xref:System.Windows.Forms.DataGridView>， <xref:System.Windows.Forms.DataGridViewColumn>， <xref:System.Windows.Forms.DataGridViewRow>，和<xref:System.Windows.Forms.DataGridViewCell>類別和其衍生的類別。</span><span class="sxs-lookup"><span data-stu-id="a37b8-117">You can retrieve <xref:System.Windows.Forms.DataGridViewCellStyle> objects from various properties of the <xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and <xref:System.Windows.Forms.DataGridViewCell> classes and their derived classes.</span></span> <span data-ttu-id="a37b8-118">如果其中一個屬性具有尚未設定，擷取其值將會建立新<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-118">If one of these properties has not yet been set, retrieving its value will create a new <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="a37b8-119">也可以產生您自己<xref:System.Windows.Forms.DataGridViewCellStyle>物件，並將它們指派給這些屬性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-119">You can also instantiate your own <xref:System.Windows.Forms.DataGridViewCellStyle> objects and assign them to these properties.</span></span>  
  
 <span data-ttu-id="a37b8-120">您可以避免不必要的樣式資訊複製共用<xref:System.Windows.Forms.DataGridViewCellStyle>物件多部<xref:System.Windows.Forms.DataGridView>項目。</span><span class="sxs-lookup"><span data-stu-id="a37b8-120">You can avoid unnecessary duplication of style information by sharing <xref:System.Windows.Forms.DataGridViewCellStyle> objects among multiple <xref:System.Windows.Forms.DataGridView> elements.</span></span> <span data-ttu-id="a37b8-121">因為在控制項、 資料行和資料列層級向下篩選至資料格層級的每個層級設定的樣式，您也可以藉由設定每個不同的層級上面的層級只有這些樣式屬性來避開樣式重複。</span><span class="sxs-lookup"><span data-stu-id="a37b8-121">Because the styles set at the control, column, and row levels filter down through each level to the cell level, you can also avoid style duplication by setting only those style properties at each level that differ from the levels above.</span></span> <span data-ttu-id="a37b8-122">這是樣式繼承一節中詳細說明。</span><span class="sxs-lookup"><span data-stu-id="a37b8-122">This is described in more detail in the Style Inheritance section that follows.</span></span>  
  
 <span data-ttu-id="a37b8-123">下表列出主屬性，取得或設定<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-123">The following table lists the primary properties that get or set <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span>  
  
|<span data-ttu-id="a37b8-124">屬性</span><span class="sxs-lookup"><span data-stu-id="a37b8-124">Property</span></span>|<span data-ttu-id="a37b8-125">類別</span><span class="sxs-lookup"><span data-stu-id="a37b8-125">Classes</span></span>|<span data-ttu-id="a37b8-126">描述</span><span class="sxs-lookup"><span data-stu-id="a37b8-126">Description</span></span>|  
|--------------|-------------|-----------------|  
|`DefaultCellStyle`|<span data-ttu-id="a37b8-127"><xref:System.Windows.Forms.DataGridView><xref:System.Windows.Forms.DataGridViewColumn>， <xref:System.Windows.Forms.DataGridViewRow>，和衍生類別</span><span class="sxs-lookup"><span data-stu-id="a37b8-127"><xref:System.Windows.Forms.DataGridView>, <xref:System.Windows.Forms.DataGridViewColumn>, <xref:System.Windows.Forms.DataGridViewRow>, and derived classes</span></span>|<span data-ttu-id="a37b8-128">取得或設定整個控制項 （包括標題儲存格），資料行或資料列中的所有資料格所使用的預設樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-128">Gets or sets default styles used by all cells in the entire control (including header cells), in a column, or in a row.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="a37b8-129">取得或設定控制項中的所有資料列所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-129">Gets or sets default cell styles used by all rows in the control.</span></span> <span data-ttu-id="a37b8-130">這不包括標頭資料格。</span><span class="sxs-lookup"><span data-stu-id="a37b8-130">This does not include header cells.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="a37b8-131">取得或設定使用的替代控制項中的資料列的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-131">Gets or sets default cell styles used by alternating rows in the control.</span></span> <span data-ttu-id="a37b8-132">用來建立類似 ledger 的效果。</span><span class="sxs-lookup"><span data-stu-id="a37b8-132">Used to create a ledger-like effect.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="a37b8-133">取得或設定控制項的資料列標頭所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-133">Gets or sets default cell styles used by the control's row headers.</span></span> <span data-ttu-id="a37b8-134">如果已啟用視覺化樣式會覆寫目前的佈景主題。</span><span class="sxs-lookup"><span data-stu-id="a37b8-134">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>|<xref:System.Windows.Forms.DataGridView>|<span data-ttu-id="a37b8-135">取得或設定控制項的資料行標頭所使用的預設儲存格樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-135">Gets or sets default cell styles used by the control's column headers.</span></span> <span data-ttu-id="a37b8-136">如果已啟用視覺化樣式會覆寫目前的佈景主題。</span><span class="sxs-lookup"><span data-stu-id="a37b8-136">Overridden by the current theme if visual styles are enabled.</span></span>|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A>|<span data-ttu-id="a37b8-137"><xref:System.Windows.Forms.DataGridViewCell> 類別和衍生的類別</span><span class="sxs-lookup"><span data-stu-id="a37b8-137"><xref:System.Windows.Forms.DataGridViewCell> and derived classes</span></span>|<span data-ttu-id="a37b8-138">取得或設定指定資料格層級的樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-138">Gets or sets styles specified at the cell level.</span></span> <span data-ttu-id="a37b8-139">這些樣式會覆寫繼承自較高的層級。</span><span class="sxs-lookup"><span data-stu-id="a37b8-139">These styles override those inherited from higher levels.</span></span>|  
|`InheritedStyle`|<span data-ttu-id="a37b8-140"><xref:System.Windows.Forms.DataGridViewCell><xref:System.Windows.Forms.DataGridViewRow>， <xref:System.Windows.Forms.DataGridViewColumn>，和衍生類別</span><span class="sxs-lookup"><span data-stu-id="a37b8-140"><xref:System.Windows.Forms.DataGridViewCell>, <xref:System.Windows.Forms.DataGridViewRow>, <xref:System.Windows.Forms.DataGridViewColumn>, and derived classes</span></span>|<span data-ttu-id="a37b8-141">取得所有目前套用至資料格、 資料列或資料行，包括繼承自較高的層級的樣式的樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-141">Gets all the styles currently applied to the cell, row, or column, including styles inherited from higher levels.</span></span>|  
  
 <span data-ttu-id="a37b8-142">如上面所述，自動取得樣式屬性的值會具現化新<xref:System.Windows.Forms.DataGridViewCellStyle>如果屬性尚未先前設定的物件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-142">As mentioned above, getting the value of a style property automatically instantiates a new <xref:System.Windows.Forms.DataGridViewCellStyle> object if the property has not been previously set.</span></span> <span data-ttu-id="a37b8-143">若要避免不必要地建立這些物件，資料列和資料類別都具有<xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A>屬性，您可以檢查以判斷是否<xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A>屬性已設定。</span><span class="sxs-lookup"><span data-stu-id="a37b8-143">To avoid creating these objects unnecessarily, the row and column classes have a <xref:System.Windows.Forms.DataGridViewBand.HasDefaultCellStyle%2A> property that you can check to determine whether the <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A> property has been set.</span></span> <span data-ttu-id="a37b8-144">同樣地，資料格具有<xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A>屬性，指出是否<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性已設定。</span><span class="sxs-lookup"><span data-stu-id="a37b8-144">Similarly, the cell classes have a <xref:System.Windows.Forms.DataGridViewCell.HasStyle%2A> property that indicates whether the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property has been set.</span></span>  
  
 <span data-ttu-id="a37b8-145">每個樣式屬性都有對應*PropertyName* `Changed`事件<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="a37b8-145">Each of the style properties has a corresponding *PropertyName*`Changed` event on the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="a37b8-146">資料列、 資料行和資料格屬性，事件的名稱開頭為"`Row`"，"`Column`"，或 「`Cell`」 (比方說， <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>)。</span><span class="sxs-lookup"><span data-stu-id="a37b8-146">For row, column, and cell properties, the name of the event begins with "`Row`", "`Column`", or "`Cell`" (for example, <xref:System.Windows.Forms.DataGridView.RowDefaultCellStyleChanged>).</span></span> <span data-ttu-id="a37b8-147">每個事件發生時對應的樣式屬性設定為不同<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-147">Each of these events occurs when the corresponding style property is set to a different <xref:System.Windows.Forms.DataGridViewCellStyle> object.</span></span> <span data-ttu-id="a37b8-148">當您擷取時不會發生這些事件<xref:System.Windows.Forms.DataGridViewCellStyle>樣式屬性的物件，並修改其屬性值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-148">These events do not occur when you retrieve a <xref:System.Windows.Forms.DataGridViewCellStyle> object from a style property and modify its property values.</span></span> <span data-ttu-id="a37b8-149">若要回應變更儲存格樣式物件本身，處理<xref:System.Windows.Forms.DataGridView.CellStyleContentChanged>事件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-149">To respond to changes to the cell style objects themselves, handle the <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged> event.</span></span>  
  
## <a name="style-inheritance"></a><span data-ttu-id="a37b8-150">樣式繼承</span><span class="sxs-lookup"><span data-stu-id="a37b8-150">Style Inheritance</span></span>  
 <span data-ttu-id="a37b8-151">每個<xref:System.Windows.Forms.DataGridViewCell>取得它的外觀，從其<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-151">Each <xref:System.Windows.Forms.DataGridViewCell> gets its appearance from its <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span> <span data-ttu-id="a37b8-152"><xref:System.Windows.Forms.DataGridViewCellStyle>這個屬性所傳回的物件會繼承型別的屬性階層中的其值<xref:System.Windows.Forms.DataGridViewCellStyle>。</span><span class="sxs-lookup"><span data-stu-id="a37b8-152">The <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by this property inherits its values from a hierarchy of properties of type <xref:System.Windows.Forms.DataGridViewCellStyle>.</span></span> <span data-ttu-id="a37b8-153">這些屬性如下所列的順序在<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>非標頭資料格取得其值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-153">These properties are listed below in the order in which the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> for non-header cells obtains its values.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2.  <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
3.  <span data-ttu-id="a37b8-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> （僅適用於在奇數索引資料列中的資料格）</span><span class="sxs-lookup"><span data-stu-id="a37b8-154"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
4.  <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
5.  <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
6.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="a37b8-155">資料列和資料行的標頭資料格，<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性由從下列清單中指定的順序的來源屬性的值擴展。</span><span class="sxs-lookup"><span data-stu-id="a37b8-155">For row and column header cells, the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property is populated by values from the following list of source properties in the given order.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
  
2.  <span data-ttu-id="a37b8-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> 或 <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span><span class="sxs-lookup"><span data-stu-id="a37b8-156"><xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType></span></span>  
  
3.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="a37b8-157">下圖說明此程序。</span><span class="sxs-lookup"><span data-stu-id="a37b8-157">The following diagram illustrates this process.</span></span>  
  
 <span data-ttu-id="a37b8-158">![DataGridViewCellStyle 類型的](../../../../docs/framework/winforms/controls/media/datagridviewcells1.gif "DataGridViewCells1")</span><span class="sxs-lookup"><span data-stu-id="a37b8-158">![Properties of type DataGridViewCellStyle](../../../../docs/framework/winforms/controls/media/datagridviewcells1.gif "DataGridViewCells1")</span></span>  
  
 <span data-ttu-id="a37b8-159">您也可以存取特定資料列和資料行所繼承的樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-159">You can also access the styles inherited by specific rows and columns.</span></span> <span data-ttu-id="a37b8-160">資料行<xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A>屬性會從下列屬性繼承其值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-160">The column <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="a37b8-161">資料列<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>屬性會從下列屬性繼承其值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-161">The row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property inherits its values from the following properties.</span></span>  
  
1.  <xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
2.  <span data-ttu-id="a37b8-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> （僅適用於在奇數索引資料列中的資料格）</span><span class="sxs-lookup"><span data-stu-id="a37b8-162"><xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType> (only for cells in rows with odd index numbers)</span></span>  
  
3.  <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
  
4.  <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="a37b8-163">中每一個屬性<xref:System.Windows.Forms.DataGridViewCellStyle>所傳回物件`InheritedStyle`屬性，屬性值取自適當有對應的屬性不是設為值的清單中的第一個儲存格樣式<xref:System.Windows.Forms.DataGridViewCellStyle>類別的預設值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-163">For each property in a <xref:System.Windows.Forms.DataGridViewCellStyle> object returned by an `InheritedStyle` property, the property value is obtained from the first cell style in the appropriate list that has the corresponding property set to a value other than the <xref:System.Windows.Forms.DataGridViewCellStyle> class defaults.</span></span>  
  
 <span data-ttu-id="a37b8-164">下表將說明如何<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>範例資料格的屬性值都繼承自其包含的資料行。</span><span class="sxs-lookup"><span data-stu-id="a37b8-164">The following table illustrates how the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value for an example cell is inherited from its containing column.</span></span>  
  
|<span data-ttu-id="a37b8-165">類型的屬性 `DataGridViewCellStyle`</span><span class="sxs-lookup"><span data-stu-id="a37b8-165">Property of type `DataGridViewCellStyle`</span></span>|<span data-ttu-id="a37b8-166">範例`ForeColor`擷取物件的值</span><span class="sxs-lookup"><span data-stu-id="a37b8-166">Example `ForeColor` value for retrieved object</span></span>|  
|----------------------------------------------|----------------------------------------------------|  
|<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewRow.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Empty?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.DarkBlue%2A?displayProperty=nameWithType>|  
|<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>|<xref:System.Drawing.Color.Black%2A?displayProperty=nameWithType>|  
  
 <span data-ttu-id="a37b8-167">在此情況下，<xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType>從儲存格的資料列的值是在清單上的第一個實際值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-167">In this case, the <xref:System.Drawing.Color.Red%2A?displayProperty=nameWithType> value from the cell's row is the first real value on the list.</span></span> <span data-ttu-id="a37b8-168">這會變成<xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A>屬性值的儲存格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>。</span><span class="sxs-lookup"><span data-stu-id="a37b8-168">This becomes the <xref:System.Windows.Forms.DataGridViewCellStyle.ForeColor%2A> property value of the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>.</span></span>  
  
 <span data-ttu-id="a37b8-169">下圖說明不同<xref:System.Windows.Forms.DataGridViewCellStyle>屬性可以繼承其值的不同位置。</span><span class="sxs-lookup"><span data-stu-id="a37b8-169">The following diagram illustrates how different <xref:System.Windows.Forms.DataGridViewCellStyle> properties can inherit their values from different places.</span></span>  
  
 <span data-ttu-id="a37b8-170">![DataGridView 屬性&#45;值繼承](../../../../docs/framework/winforms/controls/media/datagridviewcells2.gif "DataGridViewCells2")</span><span class="sxs-lookup"><span data-stu-id="a37b8-170">![DataGridView property&#45;value inheritance](../../../../docs/framework/winforms/controls/media/datagridviewcells2.gif "DataGridViewCells2")</span></span>  
  
 <span data-ttu-id="a37b8-171">利用樣式繼承，您可以提供適當的樣式整個控制項而不需要在多個位置指定相同的資訊。</span><span class="sxs-lookup"><span data-stu-id="a37b8-171">By taking advantage of style inheritance, you can provide appropriate styles for the entire control without having to specify the same information in multiple places.</span></span>  
  
 <span data-ttu-id="a37b8-172">標頭資料格會參與樣式繼承所述，雖然所傳回的物件<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>和<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>屬性<xref:System.Windows.Forms.DataGridView>控制項有覆寫所傳回的物件的屬性值的初始屬性值<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-172">Although header cells participate in style inheritance as described, the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties of the <xref:System.Windows.Forms.DataGridView> control have initial property values that override the property values of the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="a37b8-173">如果要讓屬性所傳回的物件設定<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A>屬性套用至資料列和資料行標頭，您必須設定對應的屬性所傳回的物件<xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A>和<xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A>指示內容設為預設值如<xref:System.Windows.Forms.DataGridViewCellStyle>類別。</span><span class="sxs-lookup"><span data-stu-id="a37b8-173">If you want the properties set for the object returned by the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A> property to apply to row and column headers, you must set the corresponding properties of the objects returned by the <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A> and <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A> properties to the defaults indicated for the <xref:System.Windows.Forms.DataGridViewCellStyle> class.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a37b8-174">如果已啟用視覺化樣式，資料列和資料行標頭 (除了<xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) 的樣式會自動根據目前的佈景主題，並覆寫這些屬性所指定的任何樣式。</span><span class="sxs-lookup"><span data-stu-id="a37b8-174">If visual styles are enabled, the row and column headers (except for the <xref:System.Windows.Forms.DataGridView.TopLeftHeaderCell%2A>) are automatically styled by the current theme, overriding any styles specified by these properties.</span></span>  
  
 <span data-ttu-id="a37b8-175"><xref:System.Windows.Forms.DataGridViewButtonColumn>， <xref:System.Windows.Forms.DataGridViewImageColumn>，和<xref:System.Windows.Forms.DataGridViewCheckBoxColumn>類型也會初始化的資料行所傳回之物件的某些值<xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-175">The <xref:System.Windows.Forms.DataGridViewButtonColumn>, <xref:System.Windows.Forms.DataGridViewImageColumn>, and <xref:System.Windows.Forms.DataGridViewCheckBoxColumn> types also initialize some values of the object returned by the column <xref:System.Windows.Forms.DataGridViewColumn.DefaultCellStyle%2A> property.</span></span> <span data-ttu-id="a37b8-176">如需詳細資訊，請參閱這些類型的參考文件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-176">For more information, see the reference documentation for these types.</span></span>  
  
## <a name="setting-styles-dynamically"></a><span data-ttu-id="a37b8-177">動態設定樣式</span><span class="sxs-lookup"><span data-stu-id="a37b8-177">Setting Styles Dynamically</span></span>  
 <span data-ttu-id="a37b8-178">若要自訂的特定值的資料格的樣式，實作的處理常式<xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>事件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-178">To customize the styles of cells with particular values, implement a handler for the <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType> event.</span></span> <span data-ttu-id="a37b8-179">此事件處理常式會接收的引數<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs>型別。</span><span class="sxs-lookup"><span data-stu-id="a37b8-179">Handlers for this event receive an argument of the <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs> type.</span></span> <span data-ttu-id="a37b8-180">此物件包含可讓您決定的位置中以及正在格式化儲存格的值的屬性<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="a37b8-180">This object contains properties that let you determine the value of the cell being formatted along with its location in the <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="a37b8-181">此物件也包含<xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A>屬性初始化為值的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>正在格式化資料格的屬性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-181">This object also contains a <xref:System.Windows.Forms.DataGridViewCellFormattingEventArgs.CellStyle%2A> property that is initialized to the value of the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property of the cell being formatted.</span></span> <span data-ttu-id="a37b8-182">您可以修改儲存格樣式屬性，指定適當的資料格的值和位置的樣式資訊。</span><span class="sxs-lookup"><span data-stu-id="a37b8-182">You can modify the cell style properties to specify style information appropriate to the cell value and location.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a37b8-183"><xref:System.Windows.Forms.DataGridView.RowPrePaint>和<xref:System.Windows.Forms.DataGridView.RowPostPaint>事件也會收到<xref:System.Windows.Forms.DataGridViewCellStyle>物件在事件資料，但在他們的情況下，它是資料列的複本<xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A>唯讀用途，而且它會變更的屬性不會影響控制項。</span><span class="sxs-lookup"><span data-stu-id="a37b8-183">The <xref:System.Windows.Forms.DataGridView.RowPrePaint> and <xref:System.Windows.Forms.DataGridView.RowPostPaint> events also receive a <xref:System.Windows.Forms.DataGridViewCellStyle> object in the event data, but in their case, it is a copy of the row <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A> property for read-only purposes, and changes to it do not affect the control.</span></span>  
  
 <span data-ttu-id="a37b8-184">您可以也會動態修改為了回應事件的個別儲存格的樣式例如<xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType>和<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件。</span><span class="sxs-lookup"><span data-stu-id="a37b8-184">You can also dynamically modify the styles of individual cells in response to events such as the <xref:System.Windows.Forms.DataGridView.CellMouseEnter?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridView.CellMouseLeave> events.</span></span> <span data-ttu-id="a37b8-185">比方說，在處理常式中<xref:System.Windows.Forms.DataGridView.CellMouseEnter>事件，您可以儲存的資料格的背景色彩的目前值 (透過儲存格的擷取<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性)，然後將它設定為新的會反白顯示資料格時滑鼠停留色彩。</span><span class="sxs-lookup"><span data-stu-id="a37b8-185">For example, in a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseEnter> event, you could store the current value of the cell background color (retrieved through the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property), then set it to a new color that will highlight the cell when the mouse hovers over it.</span></span> <span data-ttu-id="a37b8-186">中的處理常式<xref:System.Windows.Forms.DataGridView.CellMouseLeave>事件，您接著可以還原的背景色彩為原始值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-186">In a handler for the <xref:System.Windows.Forms.DataGridView.CellMouseLeave> event, you can then restore the background color to the original value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a37b8-187">快取儲存在儲存格的值<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性是非常重要，不論設定特定的樣式值。</span><span class="sxs-lookup"><span data-stu-id="a37b8-187">Caching the values stored in the cell's <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property is important regardless of whether a particular style value is set.</span></span> <span data-ttu-id="a37b8-188">如果您暫時取代樣式設定，將其還原至其原始的 「 未設定 」 狀態可確保，資料格會回到繼承較高層級的樣式設定。</span><span class="sxs-lookup"><span data-stu-id="a37b8-188">If you temporarily replace a style setting, restoring it to its original "not set" state ensures that the cell will go back to inheriting the style setting from a higher level.</span></span> <span data-ttu-id="a37b8-189">如果您需要決定作用中的儲存格值，不管是否繼承樣式的實際樣式，請使用儲存格的<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="a37b8-189">If you need to determine the actual style in effect for a cell regardless of whether the style is inherited, use the cell's <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A> property.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a37b8-190">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a37b8-190">See Also</span></span>  
 <xref:System.Windows.Forms.DataGridView>  
 <xref:System.Windows.Forms.DataGridViewCellStyle>  
 <xref:System.Windows.Forms.DataGridView.AlternatingRowsDefaultCellStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.ColumnHeadersDefaultCellStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.RowHeadersDefaultCellStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.RowsDefaultCellStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridViewBand.InheritedStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridViewRow.InheritedStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridViewColumn.InheritedStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridViewBand.DefaultCellStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.CellFormatting?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.CellStyleContentChanged?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.RowPrePaint?displayProperty=nameWithType>  
 <xref:System.Windows.Forms.DataGridView.RowPostPaint?displayProperty=nameWithType>  
 [<span data-ttu-id="a37b8-191">Windows Forms DataGridView 控制項中的基本格式化和樣式設定</span><span class="sxs-lookup"><span data-stu-id="a37b8-191">Basic Formatting and Styling in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/basic-formatting-and-styling-in-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a37b8-192">操作說明：設定 Windows Forms DataGridView 控制項的預設儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="a37b8-192">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)  
 [<span data-ttu-id="a37b8-193">Windows Forms DataGridView 控制項中的資料格式</span><span class="sxs-lookup"><span data-stu-id="a37b8-193">Data Formatting in the Windows Forms DataGridView Control</span></span>](../../../../docs/framework/winforms/controls/data-formatting-in-the-windows-forms-datagridview-control.md)
