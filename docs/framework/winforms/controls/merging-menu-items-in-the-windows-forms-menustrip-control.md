---
title: 合併 MenuStrip 控制項中的功能表項目
ms.date: 03/30/2017
helpviewer_keywords:
- MenuStrip [Windows Forms], merging
- merging [Windows Forms], general concepts
ms.assetid: 95e113ba-f362-4dda-8a76-6d95ddc45cee
ms.openlocfilehash: 9fc2b40ef23d72db51853c124095b734a7646cda
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76739049"
---
# <a name="merging-menu-items-in-the-windows-forms-menustrip-control"></a><span data-ttu-id="50325-102">合併 Windows Form MenuStrip 控制項中的功能表項目</span><span class="sxs-lookup"><span data-stu-id="50325-102">Merging Menu Items in the Windows Forms MenuStrip Control</span></span>
<span data-ttu-id="50325-103">如果您有多重文件介面（MDI）應用程式，您可以將子表單中的功能表項目或整個功能表合併到父表單的功能表中。</span><span class="sxs-lookup"><span data-stu-id="50325-103">If you have a multiple-document interface (MDI) application, you can merge menu items or whole menus from the child form into the menus of the parent form.</span></span>  
  
 <span data-ttu-id="50325-104">本主題描述與在 MDI 應用程式中合併功能表項目相關聯的基本概念。</span><span class="sxs-lookup"><span data-stu-id="50325-104">This topic describes the basic concepts associated with merging menu items in an MDI application.</span></span>  
  
## <a name="general-concepts"></a><span data-ttu-id="50325-105">一般概念</span><span class="sxs-lookup"><span data-stu-id="50325-105">General Concepts</span></span>  
 <span data-ttu-id="50325-106">合併套裝程式含目標和原始檔控制：</span><span class="sxs-lookup"><span data-stu-id="50325-106">Merging procedures involve both a target and a source control:</span></span>  
  
- <span data-ttu-id="50325-107">目標是要在其中合併功能表項目的主要或 MDI 父表單上的 <xref:System.Windows.Forms.MenuStrip> 控制項。</span><span class="sxs-lookup"><span data-stu-id="50325-107">The target is the <xref:System.Windows.Forms.MenuStrip> control on the main or MDI parent form into which you are merging menu items.</span></span>  
  
- <span data-ttu-id="50325-108">來源是 MDI 子表單上的 <xref:System.Windows.Forms.MenuStrip> 控制項，其中包含您要合併至目標功能表的功能表項目。</span><span class="sxs-lookup"><span data-stu-id="50325-108">The source is the <xref:System.Windows.Forms.MenuStrip> control on the MDI child form that contains the menu items you want to merge into the target menu.</span></span>  
  
 <span data-ttu-id="50325-109">[<xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A>] 屬性會識別功能表項目，其下拉式清單會填入目前 MDI 父表單的 MDI 子系的標題。</span><span class="sxs-lookup"><span data-stu-id="50325-109">The <xref:System.Windows.Forms.MenuStrip.MdiWindowListItem%2A> property identifies the menu item whose drop-down list you will populate with the titles of the current MDI parent form's MDI children.</span></span> <span data-ttu-id="50325-110">例如，您通常會列出目前在 [**視窗]** 功能表上開啟的 MDI 子系。</span><span class="sxs-lookup"><span data-stu-id="50325-110">For example, you typically list MDI children that are currently open on the **Window** menu.</span></span>  
  
 <span data-ttu-id="50325-111"><xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> 屬性會識別哪些功能表項目來自 MDI 子表單上的 <xref:System.Windows.Forms.MenuStrip>。</span><span class="sxs-lookup"><span data-stu-id="50325-111">The <xref:System.Windows.Forms.ToolStripMenuItem.IsMdiWindowListEntry%2A> property identifies which menu items come from a <xref:System.Windows.Forms.MenuStrip> on an MDI child form.</span></span>  
  
 <span data-ttu-id="50325-112">您可以手動或自動合併功能表項目。</span><span class="sxs-lookup"><span data-stu-id="50325-112">You can merge menu items manually or automatically.</span></span> <span data-ttu-id="50325-113">這兩種方法的功能表項目會以相同的方式進行合併，但合併會以不同的方式啟動，如本主題稍後的「手動合併」和「自動合併」章節所述。</span><span class="sxs-lookup"><span data-stu-id="50325-113">The menu items merge in the same way for both methods, but the merge is activated differently, as discussed in the "Manual Merging" and "Automatic Merging" sections later in this topic.</span></span> <span data-ttu-id="50325-114">在手動和自動合併中，每個合併動作都會影響下一個合併動作。</span><span class="sxs-lookup"><span data-stu-id="50325-114">In both manual and automatic merging, each merge action affects the next merge action.</span></span>  
  
 <span data-ttu-id="50325-115"><xref:System.Windows.Forms.MenuStrip> 合併會將功能表項目從一個 <xref:System.Windows.Forms.ToolStrip> 移到另一個，而不是複製它們，就像 <xref:System.Windows.Forms.MainMenu>的情況一樣。</span><span class="sxs-lookup"><span data-stu-id="50325-115"><xref:System.Windows.Forms.MenuStrip> merging moves menu items from one <xref:System.Windows.Forms.ToolStrip> to another rather than cloning them, as was the case with <xref:System.Windows.Forms.MainMenu>.</span></span>  
  
## <a name="mergeaction-values"></a><span data-ttu-id="50325-116">MergeAction 值</span><span class="sxs-lookup"><span data-stu-id="50325-116">MergeAction Values</span></span>  
 <span data-ttu-id="50325-117">您可以使用 <xref:System.Windows.Forms.MergeAction> 屬性，在來源 <xref:System.Windows.Forms.MenuStrip> 的功能表項目上設定合併動作。</span><span class="sxs-lookup"><span data-stu-id="50325-117">You set the merge action on menu items in the source <xref:System.Windows.Forms.MenuStrip> using the <xref:System.Windows.Forms.MergeAction> property.</span></span>  
  
 <span data-ttu-id="50325-118">下表描述可用合併動作的意義和一般用法。</span><span class="sxs-lookup"><span data-stu-id="50325-118">The following table describes the meaning and typical use of the available merge actions.</span></span>  
  
|<span data-ttu-id="50325-119">MergeAction 值</span><span class="sxs-lookup"><span data-stu-id="50325-119">MergeAction Value</span></span>|<span data-ttu-id="50325-120">描述</span><span class="sxs-lookup"><span data-stu-id="50325-120">Description</span></span>|<span data-ttu-id="50325-121">一般用法</span><span class="sxs-lookup"><span data-stu-id="50325-121">Typical Use</span></span>|  
|-----------------------|-----------------|-----------------|  
|<xref:System.Windows.Forms.MergeAction.Append>|<span data-ttu-id="50325-122">預設將來源專案加入目標專案集合的結尾。</span><span class="sxs-lookup"><span data-stu-id="50325-122">(Default) Adds the source item to the end of the target item's collection.</span></span>|<span data-ttu-id="50325-123">當程式的某些部分啟動時，將功能表項目加入至功能表的結尾。</span><span class="sxs-lookup"><span data-stu-id="50325-123">Adding menu items to the end of the menu when some part of the program is activated.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Insert>|<span data-ttu-id="50325-124">在來源專案上設定的 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 屬性所指定的位置中，將來源專案加入目標專案的集合中。</span><span class="sxs-lookup"><span data-stu-id="50325-124">Adds the source item to the target item's collection, in the location specified by the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> property set on the source item.</span></span>|<span data-ttu-id="50325-125">當程式的某些部分啟動時，將功能表項目加入至功能表的中間或開頭。</span><span class="sxs-lookup"><span data-stu-id="50325-125">Adding menu items to the middle or the beginning of the menu when some part of the program is activated.</span></span><br /><br /> <span data-ttu-id="50325-126">如果兩個功能表項目的 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值都相同，則會以反向順序加入。</span><span class="sxs-lookup"><span data-stu-id="50325-126">If the value of <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> is the same for both menu items, they are added in reverse order.</span></span> <span data-ttu-id="50325-127">適當地設定 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 以保留原始訂單。</span><span class="sxs-lookup"><span data-stu-id="50325-127">Set <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> appropriately to preserve the original order.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Replace>|<span data-ttu-id="50325-128">尋找文字相符專案，如果找不到文字相符專案，則使用 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值，然後以 [來源] 功能表項目取代相符的 [目標] 功能表項目。</span><span class="sxs-lookup"><span data-stu-id="50325-128">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then replaces the matching target menu item with the source menu item.</span></span>|<span data-ttu-id="50325-129">以相同名稱的來源功能表項目取代目標功能表項目，以執行不同的作業。</span><span class="sxs-lookup"><span data-stu-id="50325-129">Replacing a target menu item with a source menu item of the same name that does something different.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.MatchOnly>|<span data-ttu-id="50325-130">尋找文字相符專案，如果找不到文字相符專案，則使用 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值，然後將來源中的所有下拉式功能表新增至目標。</span><span class="sxs-lookup"><span data-stu-id="50325-130">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then adds all the drop-down items from the source to the target.</span></span>|<span data-ttu-id="50325-131">建立功能表結構，將功能表項目插入或加入至子功能表，或從子功能表移除功能表項目。</span><span class="sxs-lookup"><span data-stu-id="50325-131">Building a menu structure that inserts or adds menu items into a submenu, or removes menu items from a submenu.</span></span> <span data-ttu-id="50325-132">例如，您可以將功能表項目從 MDI 子系加入至主 <xref:System.Windows.Forms.MenuStrip>[**另存**新檔] 功能表。</span><span class="sxs-lookup"><span data-stu-id="50325-132">For example, you can add a menu item from an MDI child to a main <xref:System.Windows.Forms.MenuStrip>**Save As** menu.</span></span><br /><br /> <span data-ttu-id="50325-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> 可讓您流覽功能表結構，而不需要採取任何動作。</span><span class="sxs-lookup"><span data-stu-id="50325-133"><xref:System.Windows.Forms.MergeAction.MatchOnly> allows you to navigate through the menu structure without taking any action.</span></span> <span data-ttu-id="50325-134">它提供評估後續專案的方法。</span><span class="sxs-lookup"><span data-stu-id="50325-134">It provides a way to evaluate the subsequent items.</span></span>|  
|<xref:System.Windows.Forms.MergeAction.Remove>|<span data-ttu-id="50325-135">尋找文字相符專案，如果找不到文字相符專案，則使用 <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> 值，然後從目標中移除該專案。</span><span class="sxs-lookup"><span data-stu-id="50325-135">Finds a text match, or uses the <xref:System.Windows.Forms.ToolStripItem.MergeIndex%2A> value if no text match is found, and then removes the item from the target.</span></span>|<span data-ttu-id="50325-136">從目標 <xref:System.Windows.Forms.MenuStrip>中移除功能表項目。</span><span class="sxs-lookup"><span data-stu-id="50325-136">Removing a menu item from the target <xref:System.Windows.Forms.MenuStrip>.</span></span>|  
  
## <a name="manual-merging"></a><span data-ttu-id="50325-137">手動合併</span><span class="sxs-lookup"><span data-stu-id="50325-137">Manual Merging</span></span>  
 <span data-ttu-id="50325-138">只有 <xref:System.Windows.Forms.MenuStrip> 控制項會參與自動合併。</span><span class="sxs-lookup"><span data-stu-id="50325-138">Only <xref:System.Windows.Forms.MenuStrip> controls participate in automatic merging.</span></span> <span data-ttu-id="50325-139">若要結合其他控制項的專案（例如 <xref:System.Windows.Forms.ToolStrip> 和 <xref:System.Windows.Forms.StatusStrip> 控制項），您必須在程式碼中依需求呼叫 <xref:System.Windows.Forms.ToolStripManager.Merge%2A> 和 <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> 方法，以手動方式進行合併。</span><span class="sxs-lookup"><span data-stu-id="50325-139">To combine the items of other controls, such as <xref:System.Windows.Forms.ToolStrip> and <xref:System.Windows.Forms.StatusStrip> controls, you must merge them manually, by calling the <xref:System.Windows.Forms.ToolStripManager.Merge%2A> and <xref:System.Windows.Forms.ToolStripManager.RevertMerge%2A> methods in your code as required.</span></span>  
  
## <a name="automatic-merging"></a><span data-ttu-id="50325-140">自動合併</span><span class="sxs-lookup"><span data-stu-id="50325-140">Automatic Merging</span></span>  
 <span data-ttu-id="50325-141">您可以藉由啟用原始格式，為 MDI 應用程式使用自動合併。</span><span class="sxs-lookup"><span data-stu-id="50325-141">You can use automatic merging for MDI applications by activating the source form.</span></span> <span data-ttu-id="50325-142">若要在 MDI 應用程式中使用 <xref:System.Windows.Forms.MenuStrip>，請將 <xref:System.Windows.Forms.Form.MainMenuStrip%2A> 屬性設定為目標 <xref:System.Windows.Forms.MenuStrip>，以便在來源 <xref:System.Windows.Forms.MenuStrip> 上執行的合併動作會反映在目標 <xref:System.Windows.Forms.MenuStrip>中。</span><span class="sxs-lookup"><span data-stu-id="50325-142">To use a <xref:System.Windows.Forms.MenuStrip> in an MDI application, set the <xref:System.Windows.Forms.Form.MainMenuStrip%2A> property to the target <xref:System.Windows.Forms.MenuStrip> so that merging actions performed on the source <xref:System.Windows.Forms.MenuStrip> are reflected in the target <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
 <span data-ttu-id="50325-143">您可以藉由啟用 MDI 來源上的 <xref:System.Windows.Forms.MenuStrip>，來觸發自動合併。</span><span class="sxs-lookup"><span data-stu-id="50325-143">You can trigger automatic merging by activating the <xref:System.Windows.Forms.MenuStrip> on the MDI source.</span></span> <span data-ttu-id="50325-144">啟用時，會將來源 <xref:System.Windows.Forms.MenuStrip> 合併至 MDI 目標。</span><span class="sxs-lookup"><span data-stu-id="50325-144">Upon activation, the source <xref:System.Windows.Forms.MenuStrip> is merged into the MDI target.</span></span> <span data-ttu-id="50325-145">新表單變成作用中時，會在最後一個表單上還原合併，並在新表單上觸發。</span><span class="sxs-lookup"><span data-stu-id="50325-145">When a new form becomes active, the merge is reverted on the last form and triggered on the new form.</span></span> <span data-ttu-id="50325-146">您可以視需要在每個 <xref:System.Windows.Forms.ToolStripItem>上設定 <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> 屬性，以及在每個 <xref:System.Windows.Forms.MenuStrip>上設定 <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> 屬性來控制此行為。</span><span class="sxs-lookup"><span data-stu-id="50325-146">You can control this behavior by setting the <xref:System.Windows.Forms.ToolStripItem.MergeAction%2A> property as needed on each <xref:System.Windows.Forms.ToolStripItem>, and by setting the <xref:System.Windows.Forms.ToolStrip.AllowMerge%2A> property on each <xref:System.Windows.Forms.MenuStrip>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="50325-147">另請參閱</span><span class="sxs-lookup"><span data-stu-id="50325-147">See also</span></span>

- <xref:System.Windows.Forms.ToolStripManager>
- <xref:System.Windows.Forms.MenuStrip>
- [<span data-ttu-id="50325-148">MenuStrip 控制項</span><span class="sxs-lookup"><span data-stu-id="50325-148">MenuStrip Control</span></span>](menustrip-control-windows-forms.md)
- [<span data-ttu-id="50325-149">操作說明：使用 MenuStrip 建立 MDI 視窗清單</span><span class="sxs-lookup"><span data-stu-id="50325-149">How to: Create an MDI Window List with MenuStrip</span></span>](how-to-create-an-mdi-window-list-with-menustrip-windows-forms.md)
- [<span data-ttu-id="50325-150">操作說明：設定 MDI 應用程式的自動功能表合併功能</span><span class="sxs-lookup"><span data-stu-id="50325-150">How to: Set Up Automatic Menu Merging for MDI Applications</span></span>](how-to-set-up-automatic-menu-merging-for-mdi-applications.md)
