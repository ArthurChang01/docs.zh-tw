---
title: DataGridView 控制項中的調整大小選項
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], row sizing
- data grids [Windows Forms], column sizing
- DataGridView control [Windows Forms], column sizing
- DataGridView control [Windows Forms], sizing options
- data grids [Windows Forms], row sizing
- data grids [Windows Forms], sizing options
ms.assetid: a5620a9c-0d06-41e3-8934-c25ddb16c9e6
ms.openlocfilehash: bf1be699a18608bb452bd9fb98cbca1e99f7a9e4
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76742990"
---
# <a name="sizing-options-in-the-windows-forms-datagridview-control"></a><span data-ttu-id="f5712-102">Windows Form DataGridView 控制項中的調整大小選項</span><span class="sxs-lookup"><span data-stu-id="f5712-102">Sizing Options in the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="f5712-103"><xref:System.Windows.Forms.DataGridView> 的資料列、資料行和標頭可能會因為許多不同的出現結果而變更大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-103"><xref:System.Windows.Forms.DataGridView> rows, columns, and headers can change size as a result of many different occurrences.</span></span> <span data-ttu-id="f5712-104">下表顯示這些發生的情況。</span><span class="sxs-lookup"><span data-stu-id="f5712-104">The following table shows these occurrences.</span></span>  
  
|<span data-ttu-id="f5712-105">發生次數</span><span class="sxs-lookup"><span data-stu-id="f5712-105">Occurrence</span></span>|<span data-ttu-id="f5712-106">描述</span><span class="sxs-lookup"><span data-stu-id="f5712-106">Description</span></span>|  
|----------------|-----------------|  
|<span data-ttu-id="f5712-107">使用者調整大小</span><span class="sxs-lookup"><span data-stu-id="f5712-107">User resize</span></span>|<span data-ttu-id="f5712-108">使用者可以藉由拖曳或按兩下列、資料行或標頭分隔線來調整大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-108">Users can make size adjustments by dragging or double-clicking row, column, or header dividers.</span></span>|  
|<span data-ttu-id="f5712-109">控制項調整大小</span><span class="sxs-lookup"><span data-stu-id="f5712-109">Control resize</span></span>|<span data-ttu-id="f5712-110">在 [資料行填滿模式] 中，當控制項寬度變更時，資料行寬度會變更;例如，當控制項停駐于其父表單，且使用者調整表單的大小時。</span><span class="sxs-lookup"><span data-stu-id="f5712-110">In column fill mode, column widths change when the control width changes; for example, when the control is docked to its parent form and the user resizes the form.</span></span>|  
|<span data-ttu-id="f5712-111">資料格值變更</span><span class="sxs-lookup"><span data-stu-id="f5712-111">Cell value change</span></span>|<span data-ttu-id="f5712-112">在以內容為基礎的自動調整大小模式中，大小會變更以符合新的顯示值。</span><span class="sxs-lookup"><span data-stu-id="f5712-112">In content-based automatic sizing modes, sizes change to fit new display values.</span></span>|  
|<span data-ttu-id="f5712-113">方法呼叫</span><span class="sxs-lookup"><span data-stu-id="f5712-113">Method call</span></span>|<span data-ttu-id="f5712-114">以程式設計的內容為基礎的調整大小，可讓您根據方法呼叫時的資料格值進行相應調整。</span><span class="sxs-lookup"><span data-stu-id="f5712-114">Programmatic content-based resizing lets you make opportunistic size adjustments based on cell values at the time of the method call.</span></span>|  
|<span data-ttu-id="f5712-115">屬性設定</span><span class="sxs-lookup"><span data-stu-id="f5712-115">Property setting</span></span>|<span data-ttu-id="f5712-116">您也可以設定特定的高度和寬度值。</span><span class="sxs-lookup"><span data-stu-id="f5712-116">You can also set specific height and width values.</span></span>|  
  
 <span data-ttu-id="f5712-117">根據預設，會啟用使用者調整大小、停用自動調整大小，而且會裁剪寬度超出其資料行的儲存格值。</span><span class="sxs-lookup"><span data-stu-id="f5712-117">By default, user resizing is enabled, automatic sizing is disabled, and cell values that are wider than their columns are clipped.</span></span>  
  
 <span data-ttu-id="f5712-118">下表顯示可用來調整預設行為，或使用特定調整大小選項來達到特定效果的案例。</span><span class="sxs-lookup"><span data-stu-id="f5712-118">The following table shows scenarios that you can use to adjust the default behavior or to use specific sizing options to achieve particular effects.</span></span>  
  
|<span data-ttu-id="f5712-119">狀況</span><span class="sxs-lookup"><span data-stu-id="f5712-119">Scenario</span></span>|<span data-ttu-id="f5712-120">實作</span><span class="sxs-lookup"><span data-stu-id="f5712-120">Implementation</span></span>|  
|--------------|--------------------|  
|<span data-ttu-id="f5712-121">使用 [資料行填滿模式]，在不顯示水準捲軸的情況下，于相對較少的資料行中顯示類似大小的資料。</span><span class="sxs-lookup"><span data-stu-id="f5712-121">Use column fill mode for displaying similarly sized data in a relatively small number of columns that occupy the entire width of the control without displaying the horizontal scroll bar.</span></span>|<span data-ttu-id="f5712-122">將 <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> 屬性設為 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill>。</span><span class="sxs-lookup"><span data-stu-id="f5712-122">Set the <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> property to <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill>.</span></span>|  
|<span data-ttu-id="f5712-123">使用 [資料行填滿] 模式與 [不同大小] 的顯示值。</span><span class="sxs-lookup"><span data-stu-id="f5712-123">Use column fill mode with display values of varying sizes.</span></span>|<span data-ttu-id="f5712-124">將 <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> 屬性設為 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill>。</span><span class="sxs-lookup"><span data-stu-id="f5712-124">Set the <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> property to <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill>.</span></span> <span data-ttu-id="f5712-125">藉由設定資料行 <xref:System.Windows.Forms.DataGridViewColumn.FillWeight%2A> 屬性，或在填滿控制項的資料之後呼叫控制項 <xref:System.Windows.Forms.DataGridView.AutoResizeColumns%2A> 方法，來初始化相對資料行寬度。</span><span class="sxs-lookup"><span data-stu-id="f5712-125">Initialize relative column widths by setting the column <xref:System.Windows.Forms.DataGridViewColumn.FillWeight%2A> properties or by calling the control <xref:System.Windows.Forms.DataGridView.AutoResizeColumns%2A> method after filling the control with data.</span></span>|  
|<span data-ttu-id="f5712-126">使用具有不同重要性值的資料行填滿模式。</span><span class="sxs-lookup"><span data-stu-id="f5712-126">Use column fill mode with values of varying importance.</span></span>|<span data-ttu-id="f5712-127">將 <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> 屬性設為 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill>。</span><span class="sxs-lookup"><span data-stu-id="f5712-127">Set the <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> property to <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode.Fill>.</span></span> <span data-ttu-id="f5712-128">針對必須一律顯示部分資料，或針對特定資料行使用 [填滿模式] 以外的 [調整大小] 選項的資料行，設定大型的 <xref:System.Windows.Forms.DataGridViewColumn.MinimumWidth%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="f5712-128">Set large <xref:System.Windows.Forms.DataGridViewColumn.MinimumWidth%2A> values for columns that must always display some of their data or use a sizing option other than fill mode for specific columns.</span></span>|  
|<span data-ttu-id="f5712-129">使用資料行填滿模式來避免顯示控制項背景。</span><span class="sxs-lookup"><span data-stu-id="f5712-129">Use column fill mode to avoid displaying the control background.</span></span>|<span data-ttu-id="f5712-130">將最後一個資料行的 <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> 屬性設定為 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.Fill>，並使用其他資料行的其他調整大小選項。</span><span class="sxs-lookup"><span data-stu-id="f5712-130">Set the <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> property of the last column to <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.Fill> and use other sizing options for the other columns.</span></span> <span data-ttu-id="f5712-131">如果其他資料行使用太多可用空間，請設定最後一個資料行的 <xref:System.Windows.Forms.DataGridViewColumn.MinimumWidth%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="f5712-131">If the other columns use too much of the available space, set the <xref:System.Windows.Forms.DataGridViewColumn.MinimumWidth%2A> property of the last column.</span></span>|  
|<span data-ttu-id="f5712-132">顯示固定寬度的資料行，例如 [圖示] 或 [ID] 資料行。</span><span class="sxs-lookup"><span data-stu-id="f5712-132">Display a fixed-width column, such as an icon or ID column.</span></span>|<span data-ttu-id="f5712-133">將 <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> 設定為 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.None>，並 <xref:System.Windows.Forms.DataGridViewColumn.Resizable%2A> 資料行 <xref:System.Windows.Forms.DataGridViewTriState.False>。</span><span class="sxs-lookup"><span data-stu-id="f5712-133">Set <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> to <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.None> and <xref:System.Windows.Forms.DataGridViewColumn.Resizable%2A> to <xref:System.Windows.Forms.DataGridViewTriState.False> for the column.</span></span> <span data-ttu-id="f5712-134">藉由設定 <xref:System.Windows.Forms.DataGridViewColumn.Width%2A> 屬性，或在以資料填滿控制項後呼叫控制項 <xref:System.Windows.Forms.DataGridView.AutoResizeColumn%2A> 方法，初始化其寬度。</span><span class="sxs-lookup"><span data-stu-id="f5712-134">Initialize its width by setting the <xref:System.Windows.Forms.DataGridViewColumn.Width%2A> property or by calling the control <xref:System.Windows.Forms.DataGridView.AutoResizeColumn%2A> method after filling the control with data.</span></span>|  
|<span data-ttu-id="f5712-135">在資料格內容變更時自動調整大小，以避免裁剪並優化空間的使用。</span><span class="sxs-lookup"><span data-stu-id="f5712-135">Adjust sizes automatically whenever cell contents change to avoid clipping and to optimize the use of space.</span></span>|<span data-ttu-id="f5712-136">將 [自動調整大小] 屬性設定為代表以內容為基礎之大小調整模式的值。</span><span class="sxs-lookup"><span data-stu-id="f5712-136">Set an automatic sizing property to a value that represents a content-based sizing mode.</span></span> <span data-ttu-id="f5712-137">若要避免在使用大量資料時造成效能上的負面影響，請使用調整大小模式，只計算顯示的列數。</span><span class="sxs-lookup"><span data-stu-id="f5712-137">To avoid a performance penalty when working with large amounts of data, use a sizing mode that calculates displayed rows only.</span></span>|  
|<span data-ttu-id="f5712-138">調整大小以符合所顯示資料列中的值，以避免在處理許多資料列時產生效能的負面影響。</span><span class="sxs-lookup"><span data-stu-id="f5712-138">Adjust sizes to fit values in displayed rows to avoid performance penalties when working with many rows.</span></span>|<span data-ttu-id="f5712-139">使用適當的調整大小模式列舉值搭配自動或以程式設計方式調整大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-139">Use the appropriate sizing-mode enumeration values with automatic or programmatic resizing.</span></span> <span data-ttu-id="f5712-140">若要在滾動時調整大小以符合新顯示資料列中的值，請在 <xref:System.Windows.Forms.DataGridView.Scroll> 事件處理常式中呼叫調整大小方法。</span><span class="sxs-lookup"><span data-stu-id="f5712-140">To adjust sizes to fit values in newly displayed rows while scrolling, call a resizing method in a <xref:System.Windows.Forms.DataGridView.Scroll> event handler.</span></span> <span data-ttu-id="f5712-141">若要自訂使用者按兩下調整大小，以便只有顯示的資料列中的值會決定新的大小，請在 <xref:System.Windows.Forms.DataGridView.RowDividerDoubleClick> 或 <xref:System.Windows.Forms.DataGridView.ColumnDividerDoubleClick> 事件處理常式中呼叫調整大小方法。</span><span class="sxs-lookup"><span data-stu-id="f5712-141">To customize user double-click resizing so that only values in displayed rows determine the new sizes, call a resizing method in a <xref:System.Windows.Forms.DataGridView.RowDividerDoubleClick> or <xref:System.Windows.Forms.DataGridView.ColumnDividerDoubleClick> event handler.</span></span>|  
|<span data-ttu-id="f5712-142">調整大小以僅在特定時間符合資料格內容，以避免發生效能損失或讓使用者調整大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-142">Adjust sizes to fit cell contents only at specific times to avoid performance penalties or to enable user resizing.</span></span>|<span data-ttu-id="f5712-143">在事件處理常式中呼叫以內容為基礎的調整大小方法。</span><span class="sxs-lookup"><span data-stu-id="f5712-143">Call a content-based resizing method in an event handler.</span></span> <span data-ttu-id="f5712-144">例如，使用 <xref:System.Windows.Forms.DataGridView.DataBindingComplete> 事件來初始化系結後的大小，並處理 <xref:System.Windows.Forms.DataGridView.CellValidated> 或 <xref:System.Windows.Forms.DataGridView.CellValueChanged> 事件，以調整大小以補償已系結資料來源中的使用者編輯或變更。</span><span class="sxs-lookup"><span data-stu-id="f5712-144">For example, use the <xref:System.Windows.Forms.DataGridView.DataBindingComplete> event to initialize sizes after binding, and handle the <xref:System.Windows.Forms.DataGridView.CellValidated> or <xref:System.Windows.Forms.DataGridView.CellValueChanged> event to adjust sizes to compensate for user edits or changes in a bound data source.</span></span>|  
|<span data-ttu-id="f5712-145">調整多行資料格內容的資料列高度。</span><span class="sxs-lookup"><span data-stu-id="f5712-145">Adjust row heights for multiline cell contents.</span></span>|<span data-ttu-id="f5712-146">請確定資料行寬度適合用來顯示文欄位落，並使用自動或以程式設計方式以內容為基礎的資料列大小來調整高度。</span><span class="sxs-lookup"><span data-stu-id="f5712-146">Ensure that column widths are appropriate for displaying paragraphs of text and use automatic or programmatic content-based row sizing to adjust the heights.</span></span> <span data-ttu-id="f5712-147">此外，請確定具有多行內容的資料格會使用 <xref:System.Windows.Forms.DataGridViewTriState.True>的 <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A> 儲存格樣式值來顯示。</span><span class="sxs-lookup"><span data-stu-id="f5712-147">Also ensure that cells with multiline content are displayed using a <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A> cell style value of <xref:System.Windows.Forms.DataGridViewTriState.True>.</span></span><br /><br /> <span data-ttu-id="f5712-148">一般而言，您將使用自動資料行調整大小模式來維護資料行寬度，或在調整資料列高度之前，將其設定為特定寬度。</span><span class="sxs-lookup"><span data-stu-id="f5712-148">Typically, you will use an automatic column sizing mode to maintain column widths or set them to specific widths before row heights are adjusted.</span></span>|  
  
## <a name="resizing-with-the-mouse"></a><span data-ttu-id="f5712-149">使用滑鼠調整大小</span><span class="sxs-lookup"><span data-stu-id="f5712-149">Resizing with the Mouse</span></span>  
 <span data-ttu-id="f5712-150">根據預設，使用者可以調整不使用以資料格值為基礎之自動調整大小模式的資料列、資料行和標頭大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-150">By default, users can resize rows, columns, and headers that do not use an automatic sizing mode based on cell values.</span></span> <span data-ttu-id="f5712-151">若要防止使用者調整其他模式的大小（例如資料行填滿模式），請設定下列一或多個 <xref:System.Windows.Forms.DataGridView> 屬性：</span><span class="sxs-lookup"><span data-stu-id="f5712-151">To prevent users from resizing with other modes, such as column fill mode, set one or more of the following <xref:System.Windows.Forms.DataGridView> properties:</span></span>  
  
- <xref:System.Windows.Forms.DataGridView.AllowUserToResizeColumns%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AllowUserToResizeRows%2A>  
  
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersHeightSizeMode%2A>  
  
- <xref:System.Windows.Forms.DataGridView.RowHeadersWidthSizeMode%2A>  
  
 <span data-ttu-id="f5712-152">您也可以藉由設定其 <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 屬性，防止使用者調整個別資料列或資料行的大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-152">You can also prevent users from resizing individual rows or columns by setting their <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> properties.</span></span> <span data-ttu-id="f5712-153">根據預設，<xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 屬性值是以資料行的 <xref:System.Windows.Forms.DataGridView.AllowUserToResizeColumns%2A> 屬性值和資料列的 <xref:System.Windows.Forms.DataGridView.AllowUserToResizeRows%2A> 屬性值為基礎。</span><span class="sxs-lookup"><span data-stu-id="f5712-153">By default, the <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> property value is based on the <xref:System.Windows.Forms.DataGridView.AllowUserToResizeColumns%2A> property value for columns and the <xref:System.Windows.Forms.DataGridView.AllowUserToResizeRows%2A> property value for rows.</span></span> <span data-ttu-id="f5712-154">不過，如果您明確地將 <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 設定為 <xref:System.Windows.Forms.DataGridViewTriState.True> 或 <xref:System.Windows.Forms.DataGridViewTriState.False>，則指定的值會覆寫該資料列或資料行的控制項值。</span><span class="sxs-lookup"><span data-stu-id="f5712-154">If you explicitly set <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> to <xref:System.Windows.Forms.DataGridViewTriState.True> or <xref:System.Windows.Forms.DataGridViewTriState.False>, however, the specified value overrides the control value is for that row or column.</span></span> <span data-ttu-id="f5712-155">將 <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 設定為 <xref:System.Windows.Forms.DataGridViewTriState.NotSet> 以還原繼承。</span><span class="sxs-lookup"><span data-stu-id="f5712-155">Set <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> to <xref:System.Windows.Forms.DataGridViewTriState.NotSet> to restore the inheritance.</span></span>  
  
 <span data-ttu-id="f5712-156">因為 <xref:System.Windows.Forms.DataGridViewTriState.NotSet> 會還原值繼承，除非資料列或資料行尚未加入 <xref:System.Windows.Forms.DataGridView> 控制項中，否則 <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 屬性永遠不會傳回 <xref:System.Windows.Forms.DataGridViewTriState.NotSet> 值。</span><span class="sxs-lookup"><span data-stu-id="f5712-156">Because <xref:System.Windows.Forms.DataGridViewTriState.NotSet> restores the value inheritance, the <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> property will never return a <xref:System.Windows.Forms.DataGridViewTriState.NotSet> value unless the row or column has not been added to a <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="f5712-157">如果您需要判斷資料列或資料行的 <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 屬性值是否已繼承，請檢查其 <xref:System.Windows.Forms.DataGridViewElement.State%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="f5712-157">If you need to determine whether the <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> property value of a row or column is inherited, examine its <xref:System.Windows.Forms.DataGridViewElement.State%2A> property.</span></span> <span data-ttu-id="f5712-158">如果 <xref:System.Windows.Forms.DataGridViewElement.State%2A> 值包含 <xref:System.Windows.Forms.DataGridViewElementStates.ResizableSet> 旗標，則不會繼承 <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> 屬性值。</span><span class="sxs-lookup"><span data-stu-id="f5712-158">If the <xref:System.Windows.Forms.DataGridViewElement.State%2A> value includes the <xref:System.Windows.Forms.DataGridViewElementStates.ResizableSet> flag, the <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A> property value is not inherited.</span></span>  
  
## <a name="automatic-sizing"></a><span data-ttu-id="f5712-159">自動調整大小</span><span class="sxs-lookup"><span data-stu-id="f5712-159">Automatic Sizing</span></span>  
 <span data-ttu-id="f5712-160"><xref:System.Windows.Forms.DataGridView> 控制項中有兩種自動調整大小：資料行填滿模式和以內容為基礎的自動調整大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-160">There are two kinds of automatic sizing in the <xref:System.Windows.Forms.DataGridView> control: column fill mode and content-based automatic sizing.</span></span>  
  
 <span data-ttu-id="f5712-161">資料行填滿模式會使控制項中的可見資料行填滿控制項顯示區域的寬度。</span><span class="sxs-lookup"><span data-stu-id="f5712-161">Column fill mode causes the visible columns in the control to fill the width of the control's display area.</span></span> <span data-ttu-id="f5712-162">如需此模式的詳細資訊，請參閱[Windows Forms DataGridView 控制項中的資料行填滿模式](column-fill-mode-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="f5712-162">For more information about this mode, see [Column Fill Mode in the Windows Forms DataGridView Control](column-fill-mode-in-the-windows-forms-datagridview-control.md).</span></span>  
  
 <span data-ttu-id="f5712-163">您也可以設定資料列、資料行和標頭，以自動調整其大小以符合其資料格內容。</span><span class="sxs-lookup"><span data-stu-id="f5712-163">You can also configure rows, columns, and headers to automatically adjust their sizes to fit their cell contents.</span></span> <span data-ttu-id="f5712-164">在此情況下，每當資料格內容變更時，就會進行大小調整。</span><span class="sxs-lookup"><span data-stu-id="f5712-164">In this case, size adjustment occurs whenever cell contents change.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="f5712-165">如果您使用虛擬模式來維護自訂資料快取中的儲存格值，當使用者編輯儲存格值時，就會發生自動調整大小，但當您在 <xref:System.Windows.Forms.DataGridView.CellValuePushed> 事件處理常式以外改變快取值時，就不會發生這種情況。</span><span class="sxs-lookup"><span data-stu-id="f5712-165">If you maintain cell values in a custom data cache using virtual mode, automatic sizing occurs when the user edits a cell value but does not occur when you alter a cached value outside of a <xref:System.Windows.Forms.DataGridView.CellValuePushed> event handler.</span></span> <span data-ttu-id="f5712-166">在此情況下，請呼叫 <xref:System.Windows.Forms.DataGridView.UpdateCellValue%2A> 方法來強制控制項更新儲存格顯示，並套用目前的自動調整大小模式。</span><span class="sxs-lookup"><span data-stu-id="f5712-166">In this case, call the <xref:System.Windows.Forms.DataGridView.UpdateCellValue%2A> method to force the control to update the cell display and apply the current automatic sizing modes.</span></span>  
  
 <span data-ttu-id="f5712-167">如果只針對一個維度啟用以內容為基礎的自動調整大小（也就是針對資料列，而不是資料行，或用於資料行而非資料列），而且也會啟用 <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>，則當其他維度變更時也會發生大小調整。</span><span class="sxs-lookup"><span data-stu-id="f5712-167">If content-based automatic sizing is enabled for one dimension only—that is, for rows but not columns, or for columns but not rows—and <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A> is also enabled, size adjustment also occurs whenever the other dimension changes.</span></span> <span data-ttu-id="f5712-168">例如，如果資料列（而非資料行）設定為自動調整大小，而且已啟用 <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>，則使用者可以拖曳資料行分隔線來變更資料行的寬度，而資料列高度會自動調整，讓儲存格內容仍然會完整顯示。</span><span class="sxs-lookup"><span data-stu-id="f5712-168">For example, if rows but not columns are configured for automatic sizing and <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A> is enabled, users can drag column dividers to change the width of a column and row heights will automatically adjust so that cell contents are still fully displayed.</span></span>  
  
 <span data-ttu-id="f5712-169">如果您設定以內容為基礎的自動調整大小的資料列和資料行，而且已啟用 <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A>，則每當資料格內容變更時，<xref:System.Windows.Forms.DataGridView> 控制項都會調整大小，而在計算新的大小時，將會使用理想的儲存格高度與寬度比例。</span><span class="sxs-lookup"><span data-stu-id="f5712-169">If you configure both rows and columns for content-based automatic sizing and <xref:System.Windows.Forms.DataGridViewCellStyle.WrapMode%2A> is enabled, the <xref:System.Windows.Forms.DataGridView> control will adjust sizes whenever cell contents changed and will use an ideal cell height-to-width ratio when calculating new sizes.</span></span>  
  
 <span data-ttu-id="f5712-170">若要設定標頭和資料列的調整大小模式，以及不覆寫控制項值的資料行，請設定下列一或多個 <xref:System.Windows.Forms.DataGridView> 屬性：</span><span class="sxs-lookup"><span data-stu-id="f5712-170">To configure the sizing mode for headers and rows and for columns that do not override the control value, set one or more of the following <xref:System.Windows.Forms.DataGridView> properties:</span></span>  
  
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersHeightSizeMode%2A>  
  
- <xref:System.Windows.Forms.DataGridView.RowHeadersWidthSizeMode%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoSizeRowsMode%2A>  
  
 <span data-ttu-id="f5712-171">若要覆寫個別資料行的控制項資料行調整大小模式，請將其 <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> 屬性設定為 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.NotSet>以外的值。</span><span class="sxs-lookup"><span data-stu-id="f5712-171">To override the control's column sizing mode for an individual column, set its <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> property to a value other than <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.NotSet>.</span></span> <span data-ttu-id="f5712-172">資料行的調整大小模式實際上是由其 <xref:System.Windows.Forms.DataGridViewColumn.InheritedAutoSizeMode%2A> 屬性所決定。</span><span class="sxs-lookup"><span data-stu-id="f5712-172">The sizing mode for a column is actually determined by its <xref:System.Windows.Forms.DataGridViewColumn.InheritedAutoSizeMode%2A> property.</span></span> <span data-ttu-id="f5712-173">這個屬性的值是根據資料行的 <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> 屬性值，除非 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.NotSet>此值，在此情況下，會繼承控制項的 <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> 值。</span><span class="sxs-lookup"><span data-stu-id="f5712-173">The value of this property is based on the column's <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A> property value unless that value is <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.NotSet>, in which case the control's <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A> value is inherited.</span></span>  
  
 <span data-ttu-id="f5712-174">在處理大量資料時，請小心使用以內容為基礎的自動調整。</span><span class="sxs-lookup"><span data-stu-id="f5712-174">Use content-based automatic resizing with caution when working with large amounts of data.</span></span> <span data-ttu-id="f5712-175">若要避免效能受到影響，請使用自動調整大小模式，根據顯示的資料列計算大小，而不是分析控制項中的每個資料列。</span><span class="sxs-lookup"><span data-stu-id="f5712-175">To avoid performance penalties, use the automatic sizing modes that calculate sizes based only on the displayed rows rather than analyzing every row in the control.</span></span> <span data-ttu-id="f5712-176">為了達到最大效能，請改用以程式設計方式調整大小，讓您可以在特定時間重新調整，例如在載入新資料之後立即。</span><span class="sxs-lookup"><span data-stu-id="f5712-176">For maximum performance, use programmatic resizing instead so that you can resize at specific times, such as immediately after new data is loaded.</span></span>  
  
 <span data-ttu-id="f5712-177">以內容為基礎的自動調整大小模式不會影響您隱藏的資料列、資料行或標頭，您可以將資料列或資料行 <xref:System.Windows.Forms.DataGridViewBand.Visible%2A> 屬性或控制項 <xref:System.Windows.Forms.DataGridView.RowHeadersVisible%2A> 或 <xref:System.Windows.Forms.DataGridView.ColumnHeadersVisible%2A> 屬性設定為 `false`。</span><span class="sxs-lookup"><span data-stu-id="f5712-177">Content-based automatic sizing modes do not affect rows, columns, or headers that you have hidden by setting the row or column <xref:System.Windows.Forms.DataGridViewBand.Visible%2A> property or the control <xref:System.Windows.Forms.DataGridView.RowHeadersVisible%2A> or <xref:System.Windows.Forms.DataGridView.ColumnHeadersVisible%2A> properties to `false`.</span></span> <span data-ttu-id="f5712-178">例如，如果資料行在自動調整大小以符合大型資料格的值之後隱藏，則如果刪除包含大型資料格值的資料列，隱藏的資料行會不會變更其大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-178">For example, if a column is hidden after it is automatically sized to fit a large cell value, the hidden column will not change its size if the row containing the large cell value is deleted.</span></span> <span data-ttu-id="f5712-179">當可見度變更時，不會發生自動調整大小，因此將資料行 <xref:System.Windows.Forms.DataGridViewColumn.Visible%2A> 屬性變更回 `true` 不會強制它根據目前的內容重新計算其大小。</span><span class="sxs-lookup"><span data-stu-id="f5712-179">Automatic sizing does not occur when visibility changes, so changing the column <xref:System.Windows.Forms.DataGridViewColumn.Visible%2A> property back to `true` will not force it to recalculate its size based on its current contents.</span></span>  
  
 <span data-ttu-id="f5712-180">以程式設計內容為基礎的大小調整會影響資料列、資料行和標頭，而不論其可見度為何。</span><span class="sxs-lookup"><span data-stu-id="f5712-180">Programmatic content-based resizing affects rows, columns, and headers regardless of their visibility.</span></span>  
  
## <a name="programmatic-resizing"></a><span data-ttu-id="f5712-181">以程式設計方式調整大小</span><span class="sxs-lookup"><span data-stu-id="f5712-181">Programmatic Resizing</span></span>  
 <span data-ttu-id="f5712-182">停用自動調整大小時，您可以透過下列屬性，以程式設計方式設定資料列、資料行或標頭的確切寬度或高度：</span><span class="sxs-lookup"><span data-stu-id="f5712-182">When automatic sizing is disabled, you can programmatically set the exact width or height of rows, columns, or headers through the following properties:</span></span>  
  
- <xref:System.Windows.Forms.DataGridView.RowHeadersWidth%2A?displayProperty=nameWithType>  
  
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersHeight%2A?displayProperty=nameWithType>  
  
- <xref:System.Windows.Forms.DataGridViewRow.Height%2A?displayProperty=nameWithType>  
  
- <xref:System.Windows.Forms.DataGridViewColumn.Width%2A?displayProperty=nameWithType>  
  
 <span data-ttu-id="f5712-183">您也可以使用下列方法，以程式設計方式調整資料列、資料行和標頭的大小，以符合其內容：</span><span class="sxs-lookup"><span data-stu-id="f5712-183">You can also programmatically resize rows, columns, and headers to fit their contents using the following methods:</span></span>  
  
- <xref:System.Windows.Forms.DataGridView.AutoResizeColumn%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoResizeColumns%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoResizeColumnHeadersHeight%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoResizeRow%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoResizeRows%2A>  
  
- <xref:System.Windows.Forms.DataGridView.AutoResizeRowHeadersWidth%2A>  
  
 <span data-ttu-id="f5712-184">這些方法會調整資料列、資料行或標頭一次的大小，而不是設定它們以進行連續調整。</span><span class="sxs-lookup"><span data-stu-id="f5712-184">These methods will resize rows, columns, or headers once rather than configuring them for continuous resizing.</span></span> <span data-ttu-id="f5712-185">新的大小會自動計算，以顯示所有資料格內容而不進行裁剪。</span><span class="sxs-lookup"><span data-stu-id="f5712-185">The new sizes are automatically calculated to display all cell contents without clipping.</span></span> <span data-ttu-id="f5712-186">不過，當您以程式設計方式調整具有 <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.Fill><xref:System.Windows.Forms.DataGridViewColumn.InheritedAutoSizeMode%2A> 屬性值的資料行時，會使用計算的以內容為基礎的寬度來按比例調整資料行 <xref:System.Windows.Forms.DataGridViewColumn.FillWeight%2A> 屬性值，而實際的資料行寬度則會根據這些新的比例計算，讓所有資料行填滿控制項的可用顯示區域。</span><span class="sxs-lookup"><span data-stu-id="f5712-186">When you programmatically resize columns that have <xref:System.Windows.Forms.DataGridViewColumn.InheritedAutoSizeMode%2A> property values of <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode.Fill>, however, the calculated content-based widths are used to proportionally adjust the column <xref:System.Windows.Forms.DataGridViewColumn.FillWeight%2A> property values, and the actually column widths are then calculated according to these new proportions so that all columns fill the available display area of the control.</span></span>  
  
 <span data-ttu-id="f5712-187">以程式設計方式調整大小有助於避免連續調整大小的效能損失。</span><span class="sxs-lookup"><span data-stu-id="f5712-187">Programmatic resizing is useful to avoid performance penalties with continuous resizing.</span></span> <span data-ttu-id="f5712-188">針對使用者可以調整大小的資料列、資料行和標頭，以及資料行填滿模式，提供初始大小也很有用。</span><span class="sxs-lookup"><span data-stu-id="f5712-188">It is also useful to provide initial sizes for user-resizable rows, columns, and headers, and for column fill mode.</span></span>  
  
 <span data-ttu-id="f5712-189">您通常會在特定時間呼叫以程式設計方式調整大小的方法。</span><span class="sxs-lookup"><span data-stu-id="f5712-189">You will typically call the programmatic resizing methods at specific times.</span></span> <span data-ttu-id="f5712-190">例如，您可能會在載入資料之後，以程式設計方式調整所有資料行的大小，或者您可能會在修改特定資料格值之後，以程式設計方式調整特定資料列的大小</span><span class="sxs-lookup"><span data-stu-id="f5712-190">For example, you might programmatically resize all columns immediately after loading data, or you might programmatically resize a specific row after a particular cell value has been modified.</span></span>  
  
## <a name="customizing-content-based-sizing-behavior"></a><span data-ttu-id="f5712-191">自訂以內容為基礎的調整大小行為</span><span class="sxs-lookup"><span data-stu-id="f5712-191">Customizing Content-based Sizing Behavior</span></span>  
 <span data-ttu-id="f5712-192">您可以使用衍生的 <xref:System.Windows.Forms.DataGridView> 資料格、資料列和資料行類型來自訂調整大小行為，方法是覆寫 <xref:System.Windows.Forms.DataGridViewCell.GetPreferredSize%2A?displayProperty=nameWithType>、<xref:System.Windows.Forms.DataGridViewRow.GetPreferredHeight%2A?displayProperty=nameWithType>或 <xref:System.Windows.Forms.DataGridViewColumn.GetPreferredWidth%2A?displayProperty=nameWithType> 方法，或在衍生的 <xref:System.Windows.Forms.DataGridView> 控制項中呼叫受保護的調整大小方法多載。</span><span class="sxs-lookup"><span data-stu-id="f5712-192">You can customize sizing behaviors when working with derived <xref:System.Windows.Forms.DataGridView> cell, row, and column types by overriding the <xref:System.Windows.Forms.DataGridViewCell.GetPreferredSize%2A?displayProperty=nameWithType>, <xref:System.Windows.Forms.DataGridViewRow.GetPreferredHeight%2A?displayProperty=nameWithType>, or <xref:System.Windows.Forms.DataGridViewColumn.GetPreferredWidth%2A?displayProperty=nameWithType> methods or by calling protected resizing method overloads in a derived <xref:System.Windows.Forms.DataGridView> control.</span></span> <span data-ttu-id="f5712-193">受保護的調整大小方法多載是設計成搭配使用，以達到理想的儲存格高度與寬度的比率，以避免過度寬或高度的資料格。</span><span class="sxs-lookup"><span data-stu-id="f5712-193">The protected resizing method overloads are designed to work in pairs to achieve an ideal cell height-to-width ratio, avoiding overly wide or tall cells.</span></span> <span data-ttu-id="f5712-194">例如，如果您呼叫 <xref:System.Windows.Forms.DataGridView.AutoResizeRows%2A> 方法的 `AutoResizeRows(DataGridViewAutoSizeRowsMode,Boolean)` 多載，並傳入 <xref:System.Boolean> 參數的 `false` 值，則多載會計算資料列中儲存格的理想高度和寬度，但只會調整資料列高度。</span><span class="sxs-lookup"><span data-stu-id="f5712-194">For example, if you call the `AutoResizeRows(DataGridViewAutoSizeRowsMode,Boolean)` overload of the <xref:System.Windows.Forms.DataGridView.AutoResizeRows%2A> method and pass in a value of `false` for the <xref:System.Boolean> parameter, the overload will calculate the ideal heights and widths for cells in the row, but it will adjust the row heights only.</span></span> <span data-ttu-id="f5712-195">接著，您必須呼叫 <xref:System.Windows.Forms.DataGridView.AutoResizeColumns%2A> 方法，將資料行寬度調整為計算的理想。</span><span class="sxs-lookup"><span data-stu-id="f5712-195">You must then call the <xref:System.Windows.Forms.DataGridView.AutoResizeColumns%2A> method to adjust the column widths to the calculated ideal.</span></span>  
  
## <a name="content-based-sizing-options"></a><span data-ttu-id="f5712-196">以內容為基礎的調整大小選項</span><span class="sxs-lookup"><span data-stu-id="f5712-196">Content-based Sizing Options</span></span>  
 <span data-ttu-id="f5712-197">調整大小屬性和方法所使用的列舉與以內容為基礎的大小調整有類似的值。</span><span class="sxs-lookup"><span data-stu-id="f5712-197">The enumerations used by sizing properties and methods have similar values for content-based sizing.</span></span> <span data-ttu-id="f5712-198">使用這些值，您可以限制用來計算慣用大小的儲存格。</span><span class="sxs-lookup"><span data-stu-id="f5712-198">With these values, you can limit which cells are used to calculate the preferred sizes.</span></span> <span data-ttu-id="f5712-199">針對所有大小的列舉，名稱參考所顯示資料格的值，會將其計算限制為顯示之資料列中的儲存格。</span><span class="sxs-lookup"><span data-stu-id="f5712-199">For all sizing enumerations, values with names that refer to displayed cells limit their calculations to cells in displayed rows.</span></span> <span data-ttu-id="f5712-200">排除資料列有助於避免在使用大量資料列時造成效能上的負面影響。</span><span class="sxs-lookup"><span data-stu-id="f5712-200">Excluding rows is useful to avoid a performance penalty when you are working with a large quantity of rows.</span></span> <span data-ttu-id="f5712-201">您也可以將計算限制為標頭或 nonheader 儲存格中的資料格值。</span><span class="sxs-lookup"><span data-stu-id="f5712-201">You can also restrict calculations to cell values in header or nonheader cells.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="f5712-202">另請參閱</span><span class="sxs-lookup"><span data-stu-id="f5712-202">See also</span></span>

- <xref:System.Windows.Forms.DataGridView>
- <xref:System.Windows.Forms.DataGridView.AllowUserToResizeColumns%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AllowUserToResizeRows%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersHeightSizeMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowHeadersWidthSizeMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewBand.Resizable%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoSizeColumnsMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoSizeRowsMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.AutoSizeMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.InheritedAutoSizeMode%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.RowHeadersWidth%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.ColumnHeadersHeight%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewRow.Height%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewColumn.Width%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoResizeColumn%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoResizeColumns%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoResizeColumnHeadersHeight%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoResizeRow%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoResizeRows%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridView.AutoResizeRowHeadersWidth%2A?displayProperty=nameWithType>
- <xref:System.Windows.Forms.DataGridViewAutoSizeRowMode>
- <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>
- <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode>
- <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>
- <xref:System.Windows.Forms.DataGridViewColumnHeadersHeightSizeMode>
- <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode>
- [<span data-ttu-id="f5712-203">調整 Windows Forms DataGridView 控制項中資料行和資料列的大小</span><span class="sxs-lookup"><span data-stu-id="f5712-203">Resizing Columns and Rows in the Windows Forms DataGridView Control</span></span>](resizing-columns-and-rows-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f5712-204">Windows Forms DataGridView 控制項中的資料行填入模式</span><span class="sxs-lookup"><span data-stu-id="f5712-204">Column Fill Mode in the Windows Forms DataGridView Control</span></span>](column-fill-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="f5712-205">操作說明：設定 Windows Forms DataGridView 控制項的縮放模式</span><span class="sxs-lookup"><span data-stu-id="f5712-205">How to: Set the Sizing Modes of the Windows Forms DataGridView Control</span></span>](how-to-set-the-sizing-modes-of-the-windows-forms-datagridview-control.md)
