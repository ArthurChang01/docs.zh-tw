---
title: BindingSource 元件架構
ms.date: 03/30/2017
helpviewer_keywords:
- BindingSource component [Windows Forms], architecture
- Windows Forms, data binding
- BindingSource component [Windows Forms], about BindingSource component
- data binding [Windows Forms], BindingSource component
ms.assetid: 7bc69c90-8a11-48b1-9336-3adab5b41591
ms.openlocfilehash: 81559444b6e3da2861e48bdc637ae01d246c0758
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "61961573"
---
# <a name="bindingsource-component-architecture"></a><span data-ttu-id="d6d0e-102">BindingSource 元件架構</span><span class="sxs-lookup"><span data-stu-id="d6d0e-102">BindingSource Component Architecture</span></span>
<span data-ttu-id="d6d0e-103">使用<xref:System.Windows.Forms.BindingSource>元件，都將資料來源所有的 Windows Form 控制項繫結。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-103">With the <xref:System.Windows.Forms.BindingSource> component, you can universally bind  all Windows Forms controls to data sources.</span></span>  
  
 <span data-ttu-id="d6d0e-104"><xref:System.Windows.Forms.BindingSource>元件簡化將控制項繫結至資料來源的程序，並提供下列優點勝過傳統的資料繫結：</span><span class="sxs-lookup"><span data-stu-id="d6d0e-104">The <xref:System.Windows.Forms.BindingSource> component simplifies the process of binding controls to a data source and provides the following advantages over traditional data binding:</span></span>  
  
- <span data-ttu-id="d6d0e-105">可讓設計階段繫結至商務物件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-105">Enables design-time binding to business objects.</span></span>  
  
- <span data-ttu-id="d6d0e-106">封裝<xref:System.Windows.Forms.CurrencyManager>功能並公開<xref:System.Windows.Forms.CurrencyManager>在設計階段的事件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-106">Encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes <xref:System.Windows.Forms.CurrencyManager> events at design time.</span></span>  
  
- <span data-ttu-id="d6d0e-107">可簡化建立清單支援<xref:System.ComponentModel.IBindingList>原本不支援清單中的資料來源變更通知，提供清單變更通知的介面。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-107">Simplifies creating a list that supports the <xref:System.ComponentModel.IBindingList> interface by providing list change notification for data sources that do not natively support list change notification.</span></span>  
  
- <span data-ttu-id="d6d0e-108">提供的擴充點<xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-108">Provides an extensibility point for the <xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType> method.</span></span>  
  
- <span data-ttu-id="d6d0e-109">提供資料來源和控制項之間的間接取值層的級。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-109">Provides a level of indirection between the data source and the control.</span></span> <span data-ttu-id="d6d0e-110">資料來源可能會在執行階段變更時，則這種間接方式會相當重要。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-110">This indirection is important when the data source may change at run time.</span></span>  
  
- <span data-ttu-id="d6d0e-111">與其他資料相關的 Windows Form 控制項，特別是相互操作<xref:System.Windows.Forms.BindingNavigator>而<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-111">Interoperates with other data-related Windows Forms controls, specifically the <xref:System.Windows.Forms.BindingNavigator> and the <xref:System.Windows.Forms.DataGridView> controls.</span></span>  
  
 <span data-ttu-id="d6d0e-112">基於這些理由，<xref:System.Windows.Forms.BindingSource>元件是您的 Windows Forms 控制項繫結至資料來源的慣用的方法。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-112">For these reasons, the <xref:System.Windows.Forms.BindingSource> component is the preferred way to bind your Windows Forms controls to data sources.</span></span>  
  
## <a name="bindingsource-features"></a><span data-ttu-id="d6d0e-113">BindingSource 功能</span><span class="sxs-lookup"><span data-stu-id="d6d0e-113">BindingSource Features</span></span>  
 <span data-ttu-id="d6d0e-114"><xref:System.Windows.Forms.BindingSource>元件提供數個功能控制項繫結至資料。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-114">The <xref:System.Windows.Forms.BindingSource> component provides several features for binding controls to data.</span></span> <span data-ttu-id="d6d0e-115">使用這些功能，您可以實作幾乎任何程式碼在您的組件上的大部分資料繫結案例。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-115">With these features, you can implement most data-binding scenarios with almost no coding on your part.</span></span>  
  
 <span data-ttu-id="d6d0e-116"><xref:System.Windows.Forms.BindingSource>元件可完成此作業藉由提供一致的介面來存取許多不同種類的資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-116">The <xref:System.Windows.Forms.BindingSource> component accomplishes this by providing a consistent interface for accessing many different kinds of data sources.</span></span> <span data-ttu-id="d6d0e-117">這表示，您會使用相同的程序繫結至任何類型。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-117">This means that you use the same procedure for binding to any type.</span></span> <span data-ttu-id="d6d0e-118">例如，您可以將附加<xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性設<xref:System.Data.DataSet>或商務物件，然後在這兩種情況您會使用同一組屬性、 方法和事件來操作資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-118">For example, you can attach the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property to a <xref:System.Data.DataSet> or to a business object and in both cases you use the same set of properties, methods, and events to manipulate the data source.</span></span>  
  
 <span data-ttu-id="d6d0e-119">提供的一致介面<xref:System.Windows.Forms.BindingSource>元件可大幅簡化資料繫結至控制項的程序。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-119">The consistent interface provided by the <xref:System.Windows.Forms.BindingSource> component greatly simplifies the process of binding data to controls.</span></span> <span data-ttu-id="d6d0e-120">資料來源類型，可提供變更通知，<xref:System.Windows.Forms.BindingSource>元件會自動進行通訊的控制項與資料來源之間的變更。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-120">For data-source types that provide change notification, the <xref:System.Windows.Forms.BindingSource> component automatically communicates changes between the control and the data source.</span></span> <span data-ttu-id="d6d0e-121">對於不提供變更通知的資料來源類型，事件會提供可讓您引發變更通知。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-121">For data-source types that do not provide change notification, events are provided that let you raise change notifications.</span></span> <span data-ttu-id="d6d0e-122">下列清單顯示所支援的功能<xref:System.Windows.Forms.BindingSource>元件：</span><span class="sxs-lookup"><span data-stu-id="d6d0e-122">The following list shows the features supported by the <xref:System.Windows.Forms.BindingSource> component:</span></span>  
  
- <span data-ttu-id="d6d0e-123">間接取值。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-123">Indirection.</span></span>  
  
- <span data-ttu-id="d6d0e-124">貨幣的管理。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-124">Currency management.</span></span>  
  
- <span data-ttu-id="d6d0e-125">為清單的資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-125">Data source as a list.</span></span>  
  
- <span data-ttu-id="d6d0e-126"><xref:System.Windows.Forms.BindingSource> 為<xref:System.ComponentModel.IBindingList>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-126"><xref:System.Windows.Forms.BindingSource> as an <xref:System.ComponentModel.IBindingList>.</span></span>  
  
- <span data-ttu-id="d6d0e-127">建立自訂的項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-127">Custom item creation.</span></span>  
  
- <span data-ttu-id="d6d0e-128">建立交易式的項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-128">Transactional item creation.</span></span>  
  
- <span data-ttu-id="d6d0e-129"><xref:System.Collections.IEnumerable> 支援。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-129"><xref:System.Collections.IEnumerable> support.</span></span>  
  
- <span data-ttu-id="d6d0e-130">設計階段支援。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-130">Design-time support.</span></span>  
  
- <span data-ttu-id="d6d0e-131">靜態<xref:System.Windows.Forms.ListBindingHelper>方法。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-131">Static <xref:System.Windows.Forms.ListBindingHelper> methods.</span></span>  
  
- <span data-ttu-id="d6d0e-132">排序和篩選與<xref:System.ComponentModel.IBindingListView>介面。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-132">Sorting and filtering with the <xref:System.ComponentModel.IBindingListView> interface.</span></span>  
  
- <span data-ttu-id="d6d0e-133">與整合<xref:System.Windows.Forms.BindingNavigator>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-133">Integration with <xref:System.Windows.Forms.BindingNavigator>.</span></span>  
  
### <a name="indirection"></a><span data-ttu-id="d6d0e-134">間接</span><span class="sxs-lookup"><span data-stu-id="d6d0e-134">Indirection</span></span>  
 <span data-ttu-id="d6d0e-135"><xref:System.Windows.Forms.BindingSource>元件所提供的控制項和資料來源之間的間接取值層級。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-135">The <xref:System.Windows.Forms.BindingSource> component provides a level of indirection between a control and a data source.</span></span> <span data-ttu-id="d6d0e-136">而不是將控制項繫結至資料來源直接，您將控制項繫結至<xref:System.Windows.Forms.BindingSource>，並附加資料來源<xref:System.Windows.Forms.BindingSource>元件的<xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-136">Instead of binding a control directly to a data source, you bind the control to a <xref:System.Windows.Forms.BindingSource>, and you attach the data source to the <xref:System.Windows.Forms.BindingSource> component's <xref:System.Windows.Forms.BindingSource.DataSource%2A> property.</span></span>  
  
 <span data-ttu-id="d6d0e-137">這個間接取值的層級，您可以變更資料來源，而不必重設的控制項繫結。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-137">With this level of indirection, you can change the data source without resetting the control binding.</span></span> <span data-ttu-id="d6d0e-138">這可讓您下列功能：</span><span class="sxs-lookup"><span data-stu-id="d6d0e-138">This gives you the following capabilities:</span></span>  
  
- <span data-ttu-id="d6d0e-139">您可以將附加<xref:System.Windows.Forms.BindingSource>到不同的資料來源，同時保留目前的控制項繫結。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-139">You can attach the <xref:System.Windows.Forms.BindingSource> to different data sources while retaining the current control bindings.</span></span>  
  
- <span data-ttu-id="d6d0e-140">您可以變更資料來源中的項目，並通知繫結的控制項。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-140">You can change items in the data source and notify bound controls.</span></span> <span data-ttu-id="d6d0e-141">如需詳細資訊，請參閱[如何：反映 Windows Form 控制項使用 BindingSource 中的資料來源更新](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-141">For more information, see [How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md).</span></span>  
  
- <span data-ttu-id="d6d0e-142">您可以繫結至<xref:System.Type>而非在記憶體中的物件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-142">You can bind to a <xref:System.Type> instead of an object in memory.</span></span> <span data-ttu-id="d6d0e-143">如需詳細資訊，請參閱[如何：將 Windows Forms 控制項繫結至型別](how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-143">For more information, see [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md).</span></span> <span data-ttu-id="d6d0e-144">您接著可以在執行階段繫結至物件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-144">You can then bind to an object at run time.</span></span>  
  
### <a name="currency-management"></a><span data-ttu-id="d6d0e-145">貨幣管理</span><span class="sxs-lookup"><span data-stu-id="d6d0e-145">Currency Management</span></span>  
 <span data-ttu-id="d6d0e-146"><xref:System.Windows.Forms.BindingSource>元件實作<xref:System.Windows.Forms.ICurrencyManagerProvider>来處理貨幣管理，以便您的介面。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-146">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface to handle currency management for you.</span></span> <span data-ttu-id="d6d0e-147">具有<xref:System.Windows.Forms.ICurrencyManagerProvider>介面，您也可以存取到 currency 管理員<xref:System.Windows.Forms.BindingSource>，另一個的 currency 管理員除了<xref:System.Windows.Forms.BindingSource>繫結至相同<xref:System.Windows.Forms.BindingSource.DataMember%2A>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-147">With the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface, you can also access to the currency manager for a <xref:System.Windows.Forms.BindingSource>, in addition to the currency manager for another <xref:System.Windows.Forms.BindingSource> bound to the same <xref:System.Windows.Forms.BindingSource.DataMember%2A>.</span></span>  
  
 <span data-ttu-id="d6d0e-148"><xref:System.Windows.Forms.BindingSource>元件會封裝<xref:System.Windows.Forms.CurrencyManager>功能，並會公開最常見<xref:System.Windows.Forms.CurrencyManager>屬性和事件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-148">The <xref:System.Windows.Forms.BindingSource> component encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes the most common <xref:System.Windows.Forms.CurrencyManager> properties and events.</span></span> <span data-ttu-id="d6d0e-149">下表說明一些與貨幣管理相關的成員。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-149">The following table describes some of the members related to currency management.</span></span>  
  
 <span data-ttu-id="d6d0e-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> property</span></span>  
 <span data-ttu-id="d6d0e-151">取得相關聯的 currency 管理員<xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-151">Gets the currency manager associated with the <xref:System.Windows.Forms.BindingSource>.</span></span>  
  
 <span data-ttu-id="d6d0e-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="d6d0e-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> method</span></span>  
 <span data-ttu-id="d6d0e-153">如果有另一個<xref:System.Windows.Forms.BindingSource>繫結至指定的資料成員，則會取得其 currency 管理員。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-153">If there is another <xref:System.Windows.Forms.BindingSource> bound to the specified data member, gets its currency manager.</span></span>  
  
 <span data-ttu-id="d6d0e-154"><xref:System.Windows.Forms.BindingSource.Current%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-154"><xref:System.Windows.Forms.BindingSource.Current%2A> property</span></span>  
 <span data-ttu-id="d6d0e-155">取得資料來源的目前項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-155">Gets the current item of the data source.</span></span>  
  
 <span data-ttu-id="d6d0e-156"><xref:System.Windows.Forms.BindingSource.Position%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-156"><xref:System.Windows.Forms.BindingSource.Position%2A> property</span></span>  
 <span data-ttu-id="d6d0e-157">取得或設定基礎清單中的目前位置。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-157">Gets or sets the current position in the underlying list.</span></span>  
  
 <span data-ttu-id="d6d0e-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="d6d0e-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> method</span></span>  
 <span data-ttu-id="d6d0e-159">將暫止的變更套用至基礎資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-159">Applies pending changes to the underlying data source.</span></span>  
  
 <span data-ttu-id="d6d0e-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="d6d0e-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> method</span></span>  
 <span data-ttu-id="d6d0e-161">取消目前的編輯作業。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-161">Cancels the current edit operation.</span></span>  
  
### <a name="data-source-as-a-list"></a><span data-ttu-id="d6d0e-162">為清單的資料來源</span><span class="sxs-lookup"><span data-stu-id="d6d0e-162">Data Source as a List</span></span>  
 <span data-ttu-id="d6d0e-163"><xref:System.Windows.Forms.BindingSource>元件會實作<xref:System.ComponentModel.IBindingListView>和<xref:System.ComponentModel.ITypedList>介面。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-163">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> and <xref:System.ComponentModel.ITypedList> interfaces.</span></span> <span data-ttu-id="d6d0e-164">此實作中，您可以使用<xref:System.Windows.Forms.BindingSource>元件本身當做資料來源，而不需要任何外部儲存體。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-164">With this implementation, you can use the <xref:System.Windows.Forms.BindingSource> component itself as a data source, without any external storage.</span></span>  
  
 <span data-ttu-id="d6d0e-165">當<xref:System.Windows.Forms.BindingSource>元件連接到資料來源，它會公開為清單的資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-165">When the <xref:System.Windows.Forms.BindingSource> component is attached to a data source, it exposes the data source as a list.</span></span>  
  
 <span data-ttu-id="d6d0e-166"><xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性可以設定為多個資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-166">The <xref:System.Windows.Forms.BindingSource.DataSource%2A> property can be set to several data sources.</span></span> <span data-ttu-id="d6d0e-167">其中包括型別、 物件和類型的清單。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-167">These include types, objects, and lists of types.</span></span> <span data-ttu-id="d6d0e-168">產生的資料來源會公開為清單。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-168">The resulting data source will be exposed as a list.</span></span> <span data-ttu-id="d6d0e-169">下表顯示一些常見的資料來源和產生的清單評估。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-169">The following table shows some of the common data sources and the resulting list evaluation.</span></span>  
  
|<span data-ttu-id="d6d0e-170">資料來源屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-170">DataSource property</span></span>|<span data-ttu-id="d6d0e-171">清單結果</span><span class="sxs-lookup"><span data-stu-id="d6d0e-171">List results</span></span>|  
|-------------------------|------------------|  
|<span data-ttu-id="d6d0e-172">null 參考 (在 Visual Basic 中為 `Nothing`)</span><span class="sxs-lookup"><span data-stu-id="d6d0e-172">A null reference (`Nothing` in Visual Basic)</span></span>|<span data-ttu-id="d6d0e-173">空白<xref:System.ComponentModel.IBindingList>的物件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-173">An empty <xref:System.ComponentModel.IBindingList> of objects.</span></span> <span data-ttu-id="d6d0e-174">新增項目設定要加入的項目類型的清單。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-174">Adding an item sets the list to the type of the added item.</span></span>|  
|<span data-ttu-id="d6d0e-175">Null 參考 (`Nothing`在 Visual Basic 中) 與<xref:System.Windows.Forms.BindingSource.DataMember%2A>設定</span><span class="sxs-lookup"><span data-stu-id="d6d0e-175">A null reference (`Nothing` in Visual Basic) with <xref:System.Windows.Forms.BindingSource.DataMember%2A> set</span></span>|<span data-ttu-id="d6d0e-176">不支援;引發<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-176">Not supported; raises <xref:System.ArgumentException>.</span></span>|  
|<span data-ttu-id="d6d0e-177">非清單型別或型別"T"的物件</span><span class="sxs-lookup"><span data-stu-id="d6d0e-177">Non-list type or object of type "T"</span></span>|<span data-ttu-id="d6d0e-178">空白<xref:System.ComponentModel.IBindingList>的型別"T"。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-178">An empty <xref:System.ComponentModel.IBindingList> of type "T".</span></span>|  
|<span data-ttu-id="d6d0e-179">陣列執行個體</span><span class="sxs-lookup"><span data-stu-id="d6d0e-179">Array instance</span></span>|<span data-ttu-id="d6d0e-180"><xref:System.ComponentModel.IBindingList>包含陣列項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-180">An <xref:System.ComponentModel.IBindingList> containing the array elements.</span></span>|  
|<span data-ttu-id="d6d0e-181"><xref:System.Collections.IEnumerable> 執行個體</span><span class="sxs-lookup"><span data-stu-id="d6d0e-181"><xref:System.Collections.IEnumerable> instance</span></span>|<span data-ttu-id="d6d0e-182"><xref:System.ComponentModel.IBindingList>包含<xref:System.Collections.IEnumerable>項目</span><span class="sxs-lookup"><span data-stu-id="d6d0e-182">An <xref:System.ComponentModel.IBindingList> containing the <xref:System.Collections.IEnumerable> items</span></span>|  
|<span data-ttu-id="d6d0e-183">列出執行個體，包含型別"T"</span><span class="sxs-lookup"><span data-stu-id="d6d0e-183">List instance containing type "T"</span></span>|<span data-ttu-id="d6d0e-184"><xref:System.ComponentModel.IBindingList>包含型別"T"的執行個體。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-184">An <xref:System.ComponentModel.IBindingList> instance containing type "T".</span></span>|  
  
 <span data-ttu-id="d6d0e-185">此外，<xref:System.Windows.Forms.BindingSource.DataSource%2A>可以設定為其他清單類型，例如<xref:System.ComponentModel.IListSource>並<xref:System.ComponentModel.ITypedList>，和<xref:System.Windows.Forms.BindingSource>會適當地處理它們。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-185">Additionally, <xref:System.Windows.Forms.BindingSource.DataSource%2A> can be set to other list types, such as <xref:System.ComponentModel.IListSource> and <xref:System.ComponentModel.ITypedList>, and the <xref:System.Windows.Forms.BindingSource> will handle them appropriately.</span></span> <span data-ttu-id="d6d0e-186">在此情況下，在清單中包含的類型應該有預設建構函式。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-186">In this case, the type that is contained in the list should have a default constructor.</span></span>  
  
### <a name="bindingsource-as-an-ibindinglist"></a><span data-ttu-id="d6d0e-187">BindingSource 表示為 IBindingList</span><span class="sxs-lookup"><span data-stu-id="d6d0e-187">BindingSource as an IBindingList</span></span>  
 <span data-ttu-id="d6d0e-188"><xref:System.Windows.Forms.BindingSource>元件所提供用於存取和管理為基礎的資料成員<xref:System.ComponentModel.IBindingList>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-188">The <xref:System.Windows.Forms.BindingSource> component provides members for accessing and manipulating the underlying data as an <xref:System.ComponentModel.IBindingList>.</span></span> <span data-ttu-id="d6d0e-189">下表說明部分這些成員。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-189">The following table describes some of these members.</span></span>  
  
|<span data-ttu-id="d6d0e-190">成員</span><span class="sxs-lookup"><span data-stu-id="d6d0e-190">Member</span></span>|<span data-ttu-id="d6d0e-191">描述</span><span class="sxs-lookup"><span data-stu-id="d6d0e-191">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="d6d0e-192"><xref:System.Windows.Forms.BindingSource.List%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-192"><xref:System.Windows.Forms.BindingSource.List%2A> property</span></span>|<span data-ttu-id="d6d0e-193">取得評估的結果清單<xref:System.Windows.Forms.BindingSource.DataSource%2A>或<xref:System.Windows.Forms.BindingSource.DataMember%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-193">Gets the list that results from the evaluation of the <xref:System.Windows.Forms.BindingSource.DataSource%2A> or <xref:System.Windows.Forms.BindingSource.DataMember%2A> properties.</span></span>|  
|<span data-ttu-id="d6d0e-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="d6d0e-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> method</span></span>|<span data-ttu-id="d6d0e-195">將新的項目加入基礎清單中。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-195">Adds a new item to the underlying list.</span></span> <span data-ttu-id="d6d0e-196">適用於實作的資料來源<xref:System.ComponentModel.IBindingList>介面，並允許加入項目 (亦即<xref:System.Windows.Forms.BindingSource.AllowNew%2A>屬性設定為`true`)。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-196">Applies to data sources that implement the <xref:System.ComponentModel.IBindingList> interface and allow adding items (that is, the <xref:System.Windows.Forms.BindingSource.AllowNew%2A> property is set to `true`).</span></span>|  
  
### <a name="custom-item-creation"></a><span data-ttu-id="d6d0e-197">建立自訂項目</span><span class="sxs-lookup"><span data-stu-id="d6d0e-197">Custom Item Creation</span></span>  
 <span data-ttu-id="d6d0e-198">您可以處理<xref:System.Windows.Forms.BindingSource.AddingNew>事件來提供您自己的項目建立的邏輯。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-198">You can handle the <xref:System.Windows.Forms.BindingSource.AddingNew> event to provide your own item-creation logic.</span></span> <span data-ttu-id="d6d0e-199"><xref:System.Windows.Forms.BindingSource.AddingNew>加入新的物件之前，就會發生事件<xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-199">The <xref:System.Windows.Forms.BindingSource.AddingNew> event occurs before a new object is added to the <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="d6d0e-200">之後會引發這個事件<xref:System.Windows.Forms.BindingSource.AddNew%2A>呼叫方法時，但新的項目加入基礎清單之前。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-200">This event is raised after the <xref:System.Windows.Forms.BindingSource.AddNew%2A> method is called, but before the new item is added to the underlying list.</span></span> <span data-ttu-id="d6d0e-201">藉由處理這個事件，您可以提供自訂的項目建立行為，而不需要衍生自<xref:System.Windows.Forms.BindingSource>類別。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-201">By handling this event, you can provide custom item creation behavior without deriving from the <xref:System.Windows.Forms.BindingSource> class.</span></span> <span data-ttu-id="d6d0e-202">如需詳細資訊，請參閱[如何：自訂使用 Windows Forms BindingSource 的項目加入](how-to-customize-item-addition-with-the-windows-forms-bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-202">For more information, see [How to: Customize Item Addition with the Windows Forms BindingSource](how-to-customize-item-addition-with-the-windows-forms-bindingsource.md).</span></span>  
  
### <a name="transactional-item-creation"></a><span data-ttu-id="d6d0e-203">建立交易式的項目</span><span class="sxs-lookup"><span data-stu-id="d6d0e-203">Transactional Item Creation</span></span>  
 <span data-ttu-id="d6d0e-204"><xref:System.Windows.Forms.BindingSource>元件實作<xref:System.ComponentModel.ICancelAddNew>介面，讓建立交易式的項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-204">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.ICancelAddNew> interface, which enables transactional item creation.</span></span> <span data-ttu-id="d6d0e-205">部份建立新的項目使用的呼叫之後<xref:System.Windows.Forms.BindingSource.AddNew%2A>，可能會認可或回復透過下列方式新增：</span><span class="sxs-lookup"><span data-stu-id="d6d0e-205">After a new item is provisionally created by using a call to <xref:System.Windows.Forms.BindingSource.AddNew%2A>, the addition may be committed or rolled back in the following ways:</span></span>  
  
- <span data-ttu-id="d6d0e-206"><xref:System.ComponentModel.ICancelAddNew.EndNew%2A>方法將會明確地認可暫止的加入。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-206">The <xref:System.ComponentModel.ICancelAddNew.EndNew%2A> method will explicitly commit the pending addition.</span></span>  
  
- <span data-ttu-id="d6d0e-207">執行另一個集合運算，例如插入、 移除或移動，將會以隱含方式認可暫止的加入。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-207">Performing another collection operation, such as an insertion, removal, or move, will implicitly commit the pending addition.</span></span>  
  
- <span data-ttu-id="d6d0e-208"><xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>方法將復原暫止的加入如果方法已被認可。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-208">The <xref:System.ComponentModel.ICancelAddNew.CancelNew%2A> method will roll back the pending addition if the method has not already been committed.</span></span>  
  
### <a name="ienumerable-support"></a><span data-ttu-id="d6d0e-209">IEnumerable 支援</span><span class="sxs-lookup"><span data-stu-id="d6d0e-209">IEnumerable Support</span></span>  
 <span data-ttu-id="d6d0e-210"><xref:System.Windows.Forms.BindingSource>元件可讓控制項繫結至<xref:System.Collections.IEnumerable>資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-210">The <xref:System.Windows.Forms.BindingSource> component enables binding controls to <xref:System.Collections.IEnumerable> data sources.</span></span> <span data-ttu-id="d6d0e-211">與這個元件，您可以繫結至資料來源這類<xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-211">With this component, you can bind to a data source such as a <xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="d6d0e-212">當<xref:System.Collections.IEnumerable>資料來源已指派給<xref:System.Windows.Forms.BindingSource>元件，<xref:System.Windows.Forms.BindingSource>建立<xref:System.ComponentModel.IBindingList>並將內容加入<xref:System.Collections.IEnumerable>清單中的資料來源。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-212">When an <xref:System.Collections.IEnumerable> data source is assigned to the <xref:System.Windows.Forms.BindingSource> component, the <xref:System.Windows.Forms.BindingSource> creates an <xref:System.ComponentModel.IBindingList> and adds the contents of the <xref:System.Collections.IEnumerable> data source to the list.</span></span>  
  
### <a name="design-time-support"></a><span data-ttu-id="d6d0e-213">設計階段支援</span><span class="sxs-lookup"><span data-stu-id="d6d0e-213">Design-Time Support</span></span>  
 <span data-ttu-id="d6d0e-214">無法建立某些物件類型，在設計階段，例如從 factory 類別，建立的物件或 Web 服務所傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-214">Some object types cannot be created at design time, such as objects created from a factory class, or objects returned by a Web service.</span></span> <span data-ttu-id="d6d0e-215">您有時可能要將控制項繫結至這些類型在設計階段，即使在您的控制項可以繫結的記憶體中沒有任何物件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-215">You may sometimes have to bind your controls to these types at design time, even though there is no object in memory to which your controls can bind.</span></span> <span data-ttu-id="d6d0e-216">比方說，可能需要加上標籤的資料行標頭<xref:System.Windows.Forms.DataGridView>控制您的自訂類型的公用屬性的名稱。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-216">You may, for example, need to label the column headers of a <xref:System.Windows.Forms.DataGridView> control with the names of your custom type's public properties.</span></span>  
  
 <span data-ttu-id="d6d0e-217">為了支援此案例中，<xref:System.Windows.Forms.BindingSource>元件支援的繫結至<xref:System.Type>。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-217">To support this scenario, the <xref:System.Windows.Forms.BindingSource> component supports binding to a <xref:System.Type>.</span></span> <span data-ttu-id="d6d0e-218">當您將指派<xref:System.Type>要<xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性，<xref:System.Windows.Forms.BindingSource>元件會建立空白<xref:System.ComponentModel.BindingList%601>的<xref:System.Type>項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-218">When you assign a <xref:System.Type> to the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property, the <xref:System.Windows.Forms.BindingSource> component creates an empty <xref:System.ComponentModel.BindingList%601> of <xref:System.Type> items.</span></span> <span data-ttu-id="d6d0e-219">您接著繫結至任何控制項<xref:System.Windows.Forms.BindingSource>元件會警示您類型的結構描述之屬性的目前狀態，在設計階段，或在執行階段。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-219">Any controls you subsequently bind to the <xref:System.Windows.Forms.BindingSource> component will be alerted to the presence of the properties or schema of your type at design time, or at run time.</span></span> <span data-ttu-id="d6d0e-220">如需詳細資訊，請參閱[如何：將 Windows Forms 控制項繫結至型別](how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-220">For more information, see [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md).</span></span>  
  
### <a name="static-listbindinghelper-methods"></a><span data-ttu-id="d6d0e-221">靜態 ListBindingHelper 方法</span><span class="sxs-lookup"><span data-stu-id="d6d0e-221">Static ListBindingHelper Methods</span></span>  
 <span data-ttu-id="d6d0e-222"><xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>， <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>，並<xref:System.Windows.Forms.BindingSource>類型來產生一份清單列出的共用通用邏輯`DataSource` / `DataMember`組。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-222">The <xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>, <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>, and <xref:System.Windows.Forms.BindingSource> types all share common logic to generate a list from a `DataSource`/`DataMember` pair.</span></span> <span data-ttu-id="d6d0e-223">此外，這個常見的邏輯對外公開使用的控制項作者和其他第三方在下列`static`方法：</span><span class="sxs-lookup"><span data-stu-id="d6d0e-223">Additionally, this common logic is publicly exposed for use by control authors and other third parties in the following `static` methods:</span></span>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListItemProperties%2A>  
  
- <span data-ttu-id="d6d0e-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span><span class="sxs-lookup"><span data-stu-id="d6d0e-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span></span>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListName%2A>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListItemType%2A>  
  
### <a name="sorting-and-filtering-with-the-ibindinglistview-interface"></a><span data-ttu-id="d6d0e-225">排序和篩選 IBindingListView 介面</span><span class="sxs-lookup"><span data-stu-id="d6d0e-225">Sorting and Filtering with the IBindingListView Interface</span></span>  
 <span data-ttu-id="d6d0e-226"><xref:System.Windows.Forms.BindingSource>元件會實作<xref:System.ComponentModel.IBindingListView>介面，此功能擴充了<xref:System.ComponentModel.IBindingList>介面。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-226">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> interface, which extends the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="d6d0e-227"><xref:System.ComponentModel.IBindingList>提供了單一資料行排序和<xref:System.ComponentModel.IBindingListView>提供進階排序和篩選。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-227">The <xref:System.ComponentModel.IBindingList> offers single column sorting and the <xref:System.ComponentModel.IBindingListView> offers advanced sorting and filtering.</span></span> <span data-ttu-id="d6d0e-228">使用<xref:System.ComponentModel.IBindingListView>，您可以排序和篩選項目，在資料來源中，如果資料來源也會實作這些介面的其中一個。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-228">With <xref:System.ComponentModel.IBindingListView>, you can sort and filter items in the data source, if the data source also implements one of these interfaces.</span></span> <span data-ttu-id="d6d0e-229"><xref:System.Windows.Forms.BindingSource>元件不提供這些成員的參考實作。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-229">The <xref:System.Windows.Forms.BindingSource> component does not provide a reference implementation of these members.</span></span> <span data-ttu-id="d6d0e-230">相反地，呼叫會轉送至基礎清單中。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-230">Instead, calls are forwarded to the underlying list.</span></span>  
  
 <span data-ttu-id="d6d0e-231">下表描述您用於排序和篩選的屬性。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-231">The following table describes the properties you use for sorting and filtering.</span></span>  
  
|<span data-ttu-id="d6d0e-232">成員</span><span class="sxs-lookup"><span data-stu-id="d6d0e-232">Member</span></span>|<span data-ttu-id="d6d0e-233">描述</span><span class="sxs-lookup"><span data-stu-id="d6d0e-233">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="d6d0e-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> property</span></span>|<span data-ttu-id="d6d0e-235">如果資料來源是 <xref:System.ComponentModel.IBindingListView>，可取得或設定用來篩選所檢視之資料列的運算式。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-235">If the data source is an <xref:System.ComponentModel.IBindingListView>, gets or sets the expression used to filter which rows are viewed.</span></span>|  
|<span data-ttu-id="d6d0e-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="d6d0e-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> property</span></span>|<span data-ttu-id="d6d0e-237">如果資料來源是 <xref:System.ComponentModel.IBindingList>，可取得或設定用來排序的資料行名稱，以及排序次序資訊。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-237">If the data source is an <xref:System.ComponentModel.IBindingList>, gets or sets a column name used for sorting and sort order information.</span></span><br /><br /> <span data-ttu-id="d6d0e-238">-或-</span><span class="sxs-lookup"><span data-stu-id="d6d0e-238">-or-</span></span><br /><br /> <span data-ttu-id="d6d0e-239">如果資料來源是<xref:System.ComponentModel.IBindingListView>並支援進階排序，取得用來排序和排序順序的多個資料行名稱</span><span class="sxs-lookup"><span data-stu-id="d6d0e-239">If the data source is an <xref:System.ComponentModel.IBindingListView> and supports advanced sorting, gets multiple column names used for sorting and sort order</span></span>|  
  
### <a name="integration-with-bindingnavigator"></a><span data-ttu-id="d6d0e-240">BindingNavigator 與整合</span><span class="sxs-lookup"><span data-stu-id="d6d0e-240">Integration with BindingNavigator</span></span>  
 <span data-ttu-id="d6d0e-241">您可以使用<xref:System.Windows.Forms.BindingSource>元件，以將任何 Windows Form 控制項繫結至資料來源，但<xref:System.Windows.Forms.BindingNavigator>控制項是專為搭配<xref:System.Windows.Forms.BindingSource>元件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-241">You can use the <xref:System.Windows.Forms.BindingSource> component to bind any Windows Forms control to a data source, but the <xref:System.Windows.Forms.BindingNavigator> control is designed specifically to work with the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="d6d0e-242"><xref:System.Windows.Forms.BindingNavigator>控制項提供使用者介面來控制<xref:System.Windows.Forms.BindingSource>元件的目前項目。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-242">The <xref:System.Windows.Forms.BindingNavigator> control provides a user interface for controlling the <xref:System.Windows.Forms.BindingSource> component's current item.</span></span> <span data-ttu-id="d6d0e-243">根據預設，<xref:System.Windows.Forms.BindingNavigator>控制項提供的巡覽方法對應的按鈕<xref:System.Windows.Forms.BindingSource>元件。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-243">By default, the <xref:System.Windows.Forms.BindingNavigator> control provides buttons that correspond to the navigation methods on the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="d6d0e-244">如需詳細資訊，請參閱[如何：使用 Windows Forms BindingNavigator 控制項巡覽資料](how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md)。</span><span class="sxs-lookup"><span data-stu-id="d6d0e-244">For more information, see [How to: Navigate Data with the Windows Forms BindingNavigator Control](how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d6d0e-245">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d6d0e-245">See also</span></span>

- <xref:System.Windows.Forms.BindingSource>
- <xref:System.Windows.Forms.BindingNavigator>
- [<span data-ttu-id="d6d0e-246">BindingSource 元件概觀</span><span class="sxs-lookup"><span data-stu-id="d6d0e-246">BindingSource Component Overview</span></span>](bindingsource-component-overview.md)
- [<span data-ttu-id="d6d0e-247">BindingNavigator 控制項</span><span class="sxs-lookup"><span data-stu-id="d6d0e-247">BindingNavigator Control</span></span>](bindingnavigator-control-windows-forms.md)
- [<span data-ttu-id="d6d0e-248">Windows Forms 資料繫結</span><span class="sxs-lookup"><span data-stu-id="d6d0e-248">Windows Forms Data Binding</span></span>](../windows-forms-data-binding.md)
- [<span data-ttu-id="d6d0e-249">在 Windows Forms 上使用的控制項</span><span class="sxs-lookup"><span data-stu-id="d6d0e-249">Controls to Use on Windows Forms</span></span>](controls-to-use-on-windows-forms.md)
- [<span data-ttu-id="d6d0e-250">如何：將 Windows Forms 控制項繫結至型別</span><span class="sxs-lookup"><span data-stu-id="d6d0e-250">How to: Bind a Windows Forms Control to a Type</span></span>](how-to-bind-a-windows-forms-control-to-a-type.md)
- [<span data-ttu-id="d6d0e-251">如何：反映 Windows Form 控制項使用 BindingSource 中的資料來源更新</span><span class="sxs-lookup"><span data-stu-id="d6d0e-251">How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource</span></span>](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)
