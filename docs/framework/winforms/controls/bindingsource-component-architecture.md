---
title: BindingSource 元件架構
ms.date: 03/30/2017
helpviewer_keywords:
- BindingSource component [Windows Forms], architecture
- Windows Forms, data binding
- BindingSource component [Windows Forms], about BindingSource component
- data binding [Windows Forms], BindingSource component
ms.assetid: 7bc69c90-8a11-48b1-9336-3adab5b41591
ms.openlocfilehash: 54a23ba899ceb05701fe3580aefbb723c6b3f0fd
ms.sourcegitcommit: 30a83efb57c468da74e9e218de26cf88d3254597
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/20/2019
ms.locfileid: "68364412"
---
# <a name="bindingsource-component-architecture"></a><span data-ttu-id="781d4-102">BindingSource 元件架構</span><span class="sxs-lookup"><span data-stu-id="781d4-102">BindingSource Component Architecture</span></span>
<span data-ttu-id="781d4-103"><xref:System.Windows.Forms.BindingSource>使用元件, 您可以將所有 Windows Forms 控制項通用地系結至資料來源。</span><span class="sxs-lookup"><span data-stu-id="781d4-103">With the <xref:System.Windows.Forms.BindingSource> component, you can universally bind  all Windows Forms controls to data sources.</span></span>  
  
 <span data-ttu-id="781d4-104">此<xref:System.Windows.Forms.BindingSource>元件簡化了將控制項系結至資料來源的程式, 並提供與傳統資料系結相比的下列優點:</span><span class="sxs-lookup"><span data-stu-id="781d4-104">The <xref:System.Windows.Forms.BindingSource> component simplifies the process of binding controls to a data source and provides the following advantages over traditional data binding:</span></span>  
  
- <span data-ttu-id="781d4-105">啟用商務物件的設計階段系結。</span><span class="sxs-lookup"><span data-stu-id="781d4-105">Enables design-time binding to business objects.</span></span>  
  
- <span data-ttu-id="781d4-106">封裝<xref:System.Windows.Forms.CurrencyManager>功能, 並<xref:System.Windows.Forms.CurrencyManager>在設計階段公開事件。</span><span class="sxs-lookup"><span data-stu-id="781d4-106">Encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes <xref:System.Windows.Forms.CurrencyManager> events at design time.</span></span>  
  
- <span data-ttu-id="781d4-107">藉由提供不以原生<xref:System.ComponentModel.IBindingList>方式支援清單變更通知的資料來源清單變更通知, 簡化建立支援介面的清單。</span><span class="sxs-lookup"><span data-stu-id="781d4-107">Simplifies creating a list that supports the <xref:System.ComponentModel.IBindingList> interface by providing list change notification for data sources that do not natively support list change notification.</span></span>  
  
- <span data-ttu-id="781d4-108">提供<xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType>方法的擴充點。</span><span class="sxs-lookup"><span data-stu-id="781d4-108">Provides an extensibility point for the <xref:System.ComponentModel.IBindingList.AddNew%2A?displayProperty=nameWithType> method.</span></span>  
  
- <span data-ttu-id="781d4-109">提供資料來源和控制項之間的間接取值層級。</span><span class="sxs-lookup"><span data-stu-id="781d4-109">Provides a level of indirection between the data source and the control.</span></span> <span data-ttu-id="781d4-110">當資料來源在執行時間可能變更時, 這個間接取值就很重要。</span><span class="sxs-lookup"><span data-stu-id="781d4-110">This indirection is important when the data source may change at run time.</span></span>  
  
- <span data-ttu-id="781d4-111">與其他資料相關的 Windows Forms 控制項交互操作, 尤其<xref:System.Windows.Forms.BindingNavigator>是<xref:System.Windows.Forms.DataGridView>和控制項。</span><span class="sxs-lookup"><span data-stu-id="781d4-111">Interoperates with other data-related Windows Forms controls, specifically the <xref:System.Windows.Forms.BindingNavigator> and the <xref:System.Windows.Forms.DataGridView> controls.</span></span>  
  
 <span data-ttu-id="781d4-112">基於這些理由, <xref:System.Windows.Forms.BindingSource>元件是將 Windows Forms 控制項系結至資料來源的慣用方式。</span><span class="sxs-lookup"><span data-stu-id="781d4-112">For these reasons, the <xref:System.Windows.Forms.BindingSource> component is the preferred way to bind your Windows Forms controls to data sources.</span></span>  
  
## <a name="bindingsource-features"></a><span data-ttu-id="781d4-113">BindingSource 功能</span><span class="sxs-lookup"><span data-stu-id="781d4-113">BindingSource Features</span></span>  
 <span data-ttu-id="781d4-114"><xref:System.Windows.Forms.BindingSource>元件提供數個將控制項系結至資料的功能。</span><span class="sxs-lookup"><span data-stu-id="781d4-114">The <xref:System.Windows.Forms.BindingSource> component provides several features for binding controls to data.</span></span> <span data-ttu-id="781d4-115">有了這些功能, 您就可以執行大部分的資料系結案例, 幾乎不需要自行撰寫程式碼。</span><span class="sxs-lookup"><span data-stu-id="781d4-115">With these features, you can implement most data-binding scenarios with almost no coding on your part.</span></span>  
  
 <span data-ttu-id="781d4-116">此<xref:System.Windows.Forms.BindingSource>元件藉由提供一致的介面來存取許多不同類型的資料來源, 來完成這項工作。</span><span class="sxs-lookup"><span data-stu-id="781d4-116">The <xref:System.Windows.Forms.BindingSource> component accomplishes this by providing a consistent interface for accessing many different kinds of data sources.</span></span> <span data-ttu-id="781d4-117">這表示您會使用相同的程式來系結至任何類型。</span><span class="sxs-lookup"><span data-stu-id="781d4-117">This means that you use the same procedure for binding to any type.</span></span> <span data-ttu-id="781d4-118">例如, 您可以將<xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性附加<xref:System.Data.DataSet>至或商務物件, 而在這兩種情況下, 您會使用相同的屬性、方法和事件集來運算元據源。</span><span class="sxs-lookup"><span data-stu-id="781d4-118">For example, you can attach the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property to a <xref:System.Data.DataSet> or to a business object and in both cases you use the same set of properties, methods, and events to manipulate the data source.</span></span>  
  
 <span data-ttu-id="781d4-119"><xref:System.Windows.Forms.BindingSource>元件所提供的一致介面會大幅簡化將資料系結至控制項的程式。</span><span class="sxs-lookup"><span data-stu-id="781d4-119">The consistent interface provided by the <xref:System.Windows.Forms.BindingSource> component greatly simplifies the process of binding data to controls.</span></span> <span data-ttu-id="781d4-120">對於提供變更通知的資料來源類型, <xref:System.Windows.Forms.BindingSource>元件會自動傳達控制項與資料來源之間的變更。</span><span class="sxs-lookup"><span data-stu-id="781d4-120">For data-source types that provide change notification, the <xref:System.Windows.Forms.BindingSource> component automatically communicates changes between the control and the data source.</span></span> <span data-ttu-id="781d4-121">若為不提供變更通知的資料來源類型, 則會提供事件, 讓您引發變更通知。</span><span class="sxs-lookup"><span data-stu-id="781d4-121">For data-source types that do not provide change notification, events are provided that let you raise change notifications.</span></span> <span data-ttu-id="781d4-122">下列清單顯示<xref:System.Windows.Forms.BindingSource>元件支援的功能:</span><span class="sxs-lookup"><span data-stu-id="781d4-122">The following list shows the features supported by the <xref:System.Windows.Forms.BindingSource> component:</span></span>  
  
- <span data-ttu-id="781d4-123">間接取值.</span><span class="sxs-lookup"><span data-stu-id="781d4-123">Indirection.</span></span>  
  
- <span data-ttu-id="781d4-124">貨幣管理。</span><span class="sxs-lookup"><span data-stu-id="781d4-124">Currency management.</span></span>  
  
- <span data-ttu-id="781d4-125">以清單形式的資料來源。</span><span class="sxs-lookup"><span data-stu-id="781d4-125">Data source as a list.</span></span>  
  
- <span data-ttu-id="781d4-126"><xref:System.Windows.Forms.BindingSource>做為<xref:System.ComponentModel.IBindingList>。</span><span class="sxs-lookup"><span data-stu-id="781d4-126"><xref:System.Windows.Forms.BindingSource> as an <xref:System.ComponentModel.IBindingList>.</span></span>  
  
- <span data-ttu-id="781d4-127">自訂專案建立。</span><span class="sxs-lookup"><span data-stu-id="781d4-127">Custom item creation.</span></span>  
  
- <span data-ttu-id="781d4-128">建立交易式專案。</span><span class="sxs-lookup"><span data-stu-id="781d4-128">Transactional item creation.</span></span>  
  
- <span data-ttu-id="781d4-129"><xref:System.Collections.IEnumerable>部門.</span><span class="sxs-lookup"><span data-stu-id="781d4-129"><xref:System.Collections.IEnumerable> support.</span></span>  
  
- <span data-ttu-id="781d4-130">設計階段支援。</span><span class="sxs-lookup"><span data-stu-id="781d4-130">Design-time support.</span></span>  
  
- <span data-ttu-id="781d4-131">靜態<xref:System.Windows.Forms.ListBindingHelper>方法。</span><span class="sxs-lookup"><span data-stu-id="781d4-131">Static <xref:System.Windows.Forms.ListBindingHelper> methods.</span></span>  
  
- <span data-ttu-id="781d4-132">使用<xref:System.ComponentModel.IBindingListView>介面進行排序和篩選。</span><span class="sxs-lookup"><span data-stu-id="781d4-132">Sorting and filtering with the <xref:System.ComponentModel.IBindingListView> interface.</span></span>  
  
- <span data-ttu-id="781d4-133">與<xref:System.Windows.Forms.BindingNavigator>整合。</span><span class="sxs-lookup"><span data-stu-id="781d4-133">Integration with <xref:System.Windows.Forms.BindingNavigator>.</span></span>  
  
### <a name="indirection"></a><span data-ttu-id="781d4-134">間接</span><span class="sxs-lookup"><span data-stu-id="781d4-134">Indirection</span></span>  
 <span data-ttu-id="781d4-135"><xref:System.Windows.Forms.BindingSource>元件提供控制項和資料來源之間的間接取值層級。</span><span class="sxs-lookup"><span data-stu-id="781d4-135">The <xref:System.Windows.Forms.BindingSource> component provides a level of indirection between a control and a data source.</span></span> <span data-ttu-id="781d4-136">您不需要將控制項直接系結至資料來源, 而是將控制項系<xref:System.Windows.Forms.BindingSource>結至, 並將資料來源附加<xref:System.Windows.Forms.BindingSource>至元件的<xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="781d4-136">Instead of binding a control directly to a data source, you bind the control to a <xref:System.Windows.Forms.BindingSource>, and you attach the data source to the <xref:System.Windows.Forms.BindingSource> component's <xref:System.Windows.Forms.BindingSource.DataSource%2A> property.</span></span>  
  
 <span data-ttu-id="781d4-137">使用此間接取值層級, 您可以變更資料來源, 而不需要重設控制項系結。</span><span class="sxs-lookup"><span data-stu-id="781d4-137">With this level of indirection, you can change the data source without resetting the control binding.</span></span> <span data-ttu-id="781d4-138">這可提供下列功能:</span><span class="sxs-lookup"><span data-stu-id="781d4-138">This gives you the following capabilities:</span></span>  
  
- <span data-ttu-id="781d4-139">您可以將附加<xref:System.Windows.Forms.BindingSource>到不同的資料來源, 同時保留目前的控制項系結。</span><span class="sxs-lookup"><span data-stu-id="781d4-139">You can attach the <xref:System.Windows.Forms.BindingSource> to different data sources while retaining the current control bindings.</span></span>  
  
- <span data-ttu-id="781d4-140">您可以變更資料來源中的專案, 並通知繫結控制項。</span><span class="sxs-lookup"><span data-stu-id="781d4-140">You can change items in the data source and notify bound controls.</span></span> <span data-ttu-id="781d4-141">如需詳細資訊，請參閱[如何：使用 BindingSource](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)來反映 Windows Forms 控制項中的資料來源更新。</span><span class="sxs-lookup"><span data-stu-id="781d4-141">For more information, see [How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md).</span></span>  
  
- <span data-ttu-id="781d4-142">您可以系結至<xref:System.Type>記憶體中的, 而不是物件。</span><span class="sxs-lookup"><span data-stu-id="781d4-142">You can bind to a <xref:System.Type> instead of an object in memory.</span></span> <span data-ttu-id="781d4-143">如需詳細資訊，請參閱[如何：將 Windows Forms 控制項系結至類型](how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="781d4-143">For more information, see [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md).</span></span> <span data-ttu-id="781d4-144">接著, 您可以在執行時間系結至物件。</span><span class="sxs-lookup"><span data-stu-id="781d4-144">You can then bind to an object at run time.</span></span>  
  
### <a name="currency-management"></a><span data-ttu-id="781d4-145">貨幣管理</span><span class="sxs-lookup"><span data-stu-id="781d4-145">Currency Management</span></span>  
 <span data-ttu-id="781d4-146"><xref:System.Windows.Forms.BindingSource>元件會執行介面,為<xref:System.Windows.Forms.ICurrencyManagerProvider>您處理貨幣管理。</span><span class="sxs-lookup"><span data-stu-id="781d4-146">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface to handle currency management for you.</span></span> <span data-ttu-id="781d4-147">使用介面, 除了另<xref:System.Windows.Forms.BindingSource>一個系結至相同<xref:System.Windows.Forms.BindingSource.DataMember%2A>的貨幣管理員以外<xref:System.Windows.Forms.BindingSource>, 您也可以存取的「貨幣管理員」。 <xref:System.Windows.Forms.ICurrencyManagerProvider></span><span class="sxs-lookup"><span data-stu-id="781d4-147">With the <xref:System.Windows.Forms.ICurrencyManagerProvider> interface, you can also access to the currency manager for a <xref:System.Windows.Forms.BindingSource>, in addition to the currency manager for another <xref:System.Windows.Forms.BindingSource> bound to the same <xref:System.Windows.Forms.BindingSource.DataMember%2A>.</span></span>  
  
 <span data-ttu-id="781d4-148">元件會封裝<xref:System.Windows.Forms.CurrencyManager>功能並公開最常見<xref:System.Windows.Forms.CurrencyManager>的屬性和事件。 <xref:System.Windows.Forms.BindingSource></span><span class="sxs-lookup"><span data-stu-id="781d4-148">The <xref:System.Windows.Forms.BindingSource> component encapsulates <xref:System.Windows.Forms.CurrencyManager> functionality and exposes the most common <xref:System.Windows.Forms.CurrencyManager> properties and events.</span></span> <span data-ttu-id="781d4-149">下表描述一些與貨幣管理相關的成員。</span><span class="sxs-lookup"><span data-stu-id="781d4-149">The following table describes some of the members related to currency management.</span></span>  
  
 <span data-ttu-id="781d4-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-150"><xref:System.Windows.Forms.ICurrencyManagerProvider.CurrencyManager%2A> property</span></span>  
 <span data-ttu-id="781d4-151">取得與<xref:System.Windows.Forms.BindingSource>相關聯的 currency 管理員。</span><span class="sxs-lookup"><span data-stu-id="781d4-151">Gets the currency manager associated with the <xref:System.Windows.Forms.BindingSource>.</span></span>  
  
 <span data-ttu-id="781d4-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="781d4-152"><xref:System.Windows.Forms.ICurrencyManagerProvider.GetRelatedCurrencyManager%2A> method</span></span>  
 <span data-ttu-id="781d4-153">如果有另一個<xref:System.Windows.Forms.BindingSource>系結至指定的資料成員, 則會取得其 currency 管理員。</span><span class="sxs-lookup"><span data-stu-id="781d4-153">If there is another <xref:System.Windows.Forms.BindingSource> bound to the specified data member, gets its currency manager.</span></span>  
  
 <span data-ttu-id="781d4-154"><xref:System.Windows.Forms.BindingSource.Current%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-154"><xref:System.Windows.Forms.BindingSource.Current%2A> property</span></span>  
 <span data-ttu-id="781d4-155">取得資料來源的目前項目。</span><span class="sxs-lookup"><span data-stu-id="781d4-155">Gets the current item of the data source.</span></span>  
  
 <span data-ttu-id="781d4-156"><xref:System.Windows.Forms.BindingSource.Position%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-156"><xref:System.Windows.Forms.BindingSource.Position%2A> property</span></span>  
 <span data-ttu-id="781d4-157">取得或設定基礎清單中的目前位置。</span><span class="sxs-lookup"><span data-stu-id="781d4-157">Gets or sets the current position in the underlying list.</span></span>  
  
 <span data-ttu-id="781d4-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="781d4-158"><xref:System.Windows.Forms.BindingSource.EndEdit%2A> method</span></span>  
 <span data-ttu-id="781d4-159">將暫止的變更套用至基礎資料來源。</span><span class="sxs-lookup"><span data-stu-id="781d4-159">Applies pending changes to the underlying data source.</span></span>  
  
 <span data-ttu-id="781d4-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="781d4-160"><xref:System.Windows.Forms.BindingSource.CancelEdit%2A> method</span></span>  
 <span data-ttu-id="781d4-161">取消目前的編輯作業。</span><span class="sxs-lookup"><span data-stu-id="781d4-161">Cancels the current edit operation.</span></span>  
  
### <a name="data-source-as-a-list"></a><span data-ttu-id="781d4-162">以清單形式的資料來源</span><span class="sxs-lookup"><span data-stu-id="781d4-162">Data Source as a List</span></span>  
 <span data-ttu-id="781d4-163">元件會執行<xref:System.ComponentModel.ITypedList>和介面。 <xref:System.ComponentModel.IBindingListView> <xref:System.Windows.Forms.BindingSource></span><span class="sxs-lookup"><span data-stu-id="781d4-163">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> and <xref:System.ComponentModel.ITypedList> interfaces.</span></span> <span data-ttu-id="781d4-164">使用此實作為, 您可以使用<xref:System.Windows.Forms.BindingSource>元件本身作為資料來源, 而不需要任何外部儲存體。</span><span class="sxs-lookup"><span data-stu-id="781d4-164">With this implementation, you can use the <xref:System.Windows.Forms.BindingSource> component itself as a data source, without any external storage.</span></span>  
  
 <span data-ttu-id="781d4-165"><xref:System.Windows.Forms.BindingSource>當元件附加至資料來源時, 它會將資料來源公開為清單。</span><span class="sxs-lookup"><span data-stu-id="781d4-165">When the <xref:System.Windows.Forms.BindingSource> component is attached to a data source, it exposes the data source as a list.</span></span>  
  
 <span data-ttu-id="781d4-166"><xref:System.Windows.Forms.BindingSource.DataSource%2A>屬性可以設定為數個數據源。</span><span class="sxs-lookup"><span data-stu-id="781d4-166">The <xref:System.Windows.Forms.BindingSource.DataSource%2A> property can be set to several data sources.</span></span> <span data-ttu-id="781d4-167">這些包括類型、物件和類型清單。</span><span class="sxs-lookup"><span data-stu-id="781d4-167">These include types, objects, and lists of types.</span></span> <span data-ttu-id="781d4-168">產生的資料來源將會公開為清單。</span><span class="sxs-lookup"><span data-stu-id="781d4-168">The resulting data source will be exposed as a list.</span></span> <span data-ttu-id="781d4-169">下表顯示一些常見的資料來源和所產生的清單評估。</span><span class="sxs-lookup"><span data-stu-id="781d4-169">The following table shows some of the common data sources and the resulting list evaluation.</span></span>  
  
|<span data-ttu-id="781d4-170">DataSource 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-170">DataSource property</span></span>|<span data-ttu-id="781d4-171">列出結果</span><span class="sxs-lookup"><span data-stu-id="781d4-171">List results</span></span>|  
|-------------------------|------------------|  
|<span data-ttu-id="781d4-172">null 參考 (在 Visual Basic 中為 `Nothing`)</span><span class="sxs-lookup"><span data-stu-id="781d4-172">A null reference (`Nothing` in Visual Basic)</span></span>|<span data-ttu-id="781d4-173">物件的<xref:System.ComponentModel.IBindingList>空白。</span><span class="sxs-lookup"><span data-stu-id="781d4-173">An empty <xref:System.ComponentModel.IBindingList> of objects.</span></span> <span data-ttu-id="781d4-174">加入專案會將清單設定為已加入專案的類型。</span><span class="sxs-lookup"><span data-stu-id="781d4-174">Adding an item sets the list to the type of the added item.</span></span>|  
|<span data-ttu-id="781d4-175">`Nothing` 具有<xref:System.Windows.Forms.BindingSource.DataMember%2A> set 的 null 參考 (在 Visual Basic 中)</span><span class="sxs-lookup"><span data-stu-id="781d4-175">A null reference (`Nothing` in Visual Basic) with <xref:System.Windows.Forms.BindingSource.DataMember%2A> set</span></span>|<span data-ttu-id="781d4-176">不支援;引發<xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="781d4-176">Not supported; raises <xref:System.ArgumentException>.</span></span>|  
|<span data-ttu-id="781d4-177">非清單類型或類型 "T" 的物件</span><span class="sxs-lookup"><span data-stu-id="781d4-177">Non-list type or object of type "T"</span></span>|<span data-ttu-id="781d4-178">類型為<xref:System.ComponentModel.IBindingList> "T" 的空白。</span><span class="sxs-lookup"><span data-stu-id="781d4-178">An empty <xref:System.ComponentModel.IBindingList> of type "T".</span></span>|  
|<span data-ttu-id="781d4-179">陣列實例</span><span class="sxs-lookup"><span data-stu-id="781d4-179">Array instance</span></span>|<span data-ttu-id="781d4-180"><xref:System.ComponentModel.IBindingList>包含陣列元素的。</span><span class="sxs-lookup"><span data-stu-id="781d4-180">An <xref:System.ComponentModel.IBindingList> containing the array elements.</span></span>|  
|<span data-ttu-id="781d4-181"><xref:System.Collections.IEnumerable>示例</span><span class="sxs-lookup"><span data-stu-id="781d4-181"><xref:System.Collections.IEnumerable> instance</span></span>|<span data-ttu-id="781d4-182"><xref:System.ComponentModel.IBindingList> 包含<xref:System.Collections.IEnumerable>專案的。</span><span class="sxs-lookup"><span data-stu-id="781d4-182">An <xref:System.ComponentModel.IBindingList> containing the <xref:System.Collections.IEnumerable> items</span></span>|  
|<span data-ttu-id="781d4-183">包含類型 "T" 的清單實例</span><span class="sxs-lookup"><span data-stu-id="781d4-183">List instance containing type "T"</span></span>|<span data-ttu-id="781d4-184">包含<xref:System.ComponentModel.IBindingList>類型 "T" 的實例。</span><span class="sxs-lookup"><span data-stu-id="781d4-184">An <xref:System.ComponentModel.IBindingList> instance containing type "T".</span></span>|  
  
 <span data-ttu-id="781d4-185">此外, <xref:System.Windows.Forms.BindingSource.DataSource%2A>可以設定為其他清單類型 ( <xref:System.ComponentModel.IListSource>例如和<xref:System.ComponentModel.ITypedList>), 而且<xref:System.Windows.Forms.BindingSource>會適當地處理它們。</span><span class="sxs-lookup"><span data-stu-id="781d4-185">Additionally, <xref:System.Windows.Forms.BindingSource.DataSource%2A> can be set to other list types, such as <xref:System.ComponentModel.IListSource> and <xref:System.ComponentModel.ITypedList>, and the <xref:System.Windows.Forms.BindingSource> will handle them appropriately.</span></span> <span data-ttu-id="781d4-186">在此情況下, 清單中所包含的型別應該具有無參數的函式。</span><span class="sxs-lookup"><span data-stu-id="781d4-186">In this case, the type that is contained in the list should have a parameterless constructor.</span></span>  
  
### <a name="bindingsource-as-an-ibindinglist"></a><span data-ttu-id="781d4-187">BindingSource 做為 IBindingList</span><span class="sxs-lookup"><span data-stu-id="781d4-187">BindingSource as an IBindingList</span></span>  
 <span data-ttu-id="781d4-188">元件會提供成員來存取和操作基礎資料<xref:System.ComponentModel.IBindingList>做為。 <xref:System.Windows.Forms.BindingSource></span><span class="sxs-lookup"><span data-stu-id="781d4-188">The <xref:System.Windows.Forms.BindingSource> component provides members for accessing and manipulating the underlying data as an <xref:System.ComponentModel.IBindingList>.</span></span> <span data-ttu-id="781d4-189">下表描述其中一些成員。</span><span class="sxs-lookup"><span data-stu-id="781d4-189">The following table describes some of these members.</span></span>  
  
|<span data-ttu-id="781d4-190">成員</span><span class="sxs-lookup"><span data-stu-id="781d4-190">Member</span></span>|<span data-ttu-id="781d4-191">說明</span><span class="sxs-lookup"><span data-stu-id="781d4-191">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="781d4-192"><xref:System.Windows.Forms.BindingSource.List%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-192"><xref:System.Windows.Forms.BindingSource.List%2A> property</span></span>|<span data-ttu-id="781d4-193">取得由<xref:System.Windows.Forms.BindingSource.DataSource%2A>或<xref:System.Windows.Forms.BindingSource.DataMember%2A>屬性的評估所產生的清單。</span><span class="sxs-lookup"><span data-stu-id="781d4-193">Gets the list that results from the evaluation of the <xref:System.Windows.Forms.BindingSource.DataSource%2A> or <xref:System.Windows.Forms.BindingSource.DataMember%2A> properties.</span></span>|  
|<span data-ttu-id="781d4-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="781d4-194"><xref:System.Windows.Forms.BindingSource.AddNew%2A> method</span></span>|<span data-ttu-id="781d4-195">將新的項目加入基礎清單中。</span><span class="sxs-lookup"><span data-stu-id="781d4-195">Adds a new item to the underlying list.</span></span> <span data-ttu-id="781d4-196">適用于執行<xref:System.ComponentModel.IBindingList>介面並允許加入專案的資料來源 (也就是<xref:System.Windows.Forms.BindingSource.AllowNew%2A>屬性設定為`true`)。</span><span class="sxs-lookup"><span data-stu-id="781d4-196">Applies to data sources that implement the <xref:System.ComponentModel.IBindingList> interface and allow adding items (that is, the <xref:System.Windows.Forms.BindingSource.AllowNew%2A> property is set to `true`).</span></span>|  
  
### <a name="custom-item-creation"></a><span data-ttu-id="781d4-197">自訂專案建立</span><span class="sxs-lookup"><span data-stu-id="781d4-197">Custom Item Creation</span></span>  
 <span data-ttu-id="781d4-198">您可以處理<xref:System.Windows.Forms.BindingSource.AddingNew>事件, 以提供您自己的專案建立邏輯。</span><span class="sxs-lookup"><span data-stu-id="781d4-198">You can handle the <xref:System.Windows.Forms.BindingSource.AddingNew> event to provide your own item-creation logic.</span></span> <span data-ttu-id="781d4-199">事件發生于新的物件加入<xref:System.Windows.Forms.BindingSource>至之前。 <xref:System.Windows.Forms.BindingSource.AddingNew></span><span class="sxs-lookup"><span data-stu-id="781d4-199">The <xref:System.Windows.Forms.BindingSource.AddingNew> event occurs before a new object is added to the <xref:System.Windows.Forms.BindingSource>.</span></span> <span data-ttu-id="781d4-200">這個事件是在呼叫<xref:System.Windows.Forms.BindingSource.AddNew%2A>方法之後, 但在將新專案加入基礎清單之前引發。</span><span class="sxs-lookup"><span data-stu-id="781d4-200">This event is raised after the <xref:System.Windows.Forms.BindingSource.AddNew%2A> method is called, but before the new item is added to the underlying list.</span></span> <span data-ttu-id="781d4-201">藉由處理這個事件, 您可以提供自訂專案建立行為, 而<xref:System.Windows.Forms.BindingSource>不需要從類別衍生。</span><span class="sxs-lookup"><span data-stu-id="781d4-201">By handling this event, you can provide custom item creation behavior without deriving from the <xref:System.Windows.Forms.BindingSource> class.</span></span> <span data-ttu-id="781d4-202">如需詳細資訊，請參閱[如何：使用 Windows Forms BindingSource](how-to-customize-item-addition-with-the-windows-forms-bindingsource.md)自訂加入專案。</span><span class="sxs-lookup"><span data-stu-id="781d4-202">For more information, see [How to: Customize Item Addition with the Windows Forms BindingSource](how-to-customize-item-addition-with-the-windows-forms-bindingsource.md).</span></span>  
  
### <a name="transactional-item-creation"></a><span data-ttu-id="781d4-203">交易式專案建立</span><span class="sxs-lookup"><span data-stu-id="781d4-203">Transactional Item Creation</span></span>  
 <span data-ttu-id="781d4-204"><xref:System.Windows.Forms.BindingSource>元件會執行介面,以啟用交易<xref:System.ComponentModel.ICancelAddNew>式專案的建立。</span><span class="sxs-lookup"><span data-stu-id="781d4-204">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.ICancelAddNew> interface, which enables transactional item creation.</span></span> <span data-ttu-id="781d4-205">使用的呼叫<xref:System.Windows.Forms.BindingSource.AddNew%2A>建立新專案 provisionally 之後, 可能會以下列方式來認可或回復加入:</span><span class="sxs-lookup"><span data-stu-id="781d4-205">After a new item is provisionally created by using a call to <xref:System.Windows.Forms.BindingSource.AddNew%2A>, the addition may be committed or rolled back in the following ways:</span></span>  
  
- <span data-ttu-id="781d4-206"><xref:System.ComponentModel.ICancelAddNew.EndNew%2A>方法會明確認可暫止的加入。</span><span class="sxs-lookup"><span data-stu-id="781d4-206">The <xref:System.ComponentModel.ICancelAddNew.EndNew%2A> method will explicitly commit the pending addition.</span></span>  
  
- <span data-ttu-id="781d4-207">執行另一個集合作業 (例如插入、移除或移動), 會隱含地認可擱置的加入。</span><span class="sxs-lookup"><span data-stu-id="781d4-207">Performing another collection operation, such as an insertion, removal, or move, will implicitly commit the pending addition.</span></span>  
  
- <span data-ttu-id="781d4-208">如果<xref:System.ComponentModel.ICancelAddNew.CancelNew%2A>尚未認可方法, 此方法將會回復暫止的新增。</span><span class="sxs-lookup"><span data-stu-id="781d4-208">The <xref:System.ComponentModel.ICancelAddNew.CancelNew%2A> method will roll back the pending addition if the method has not already been committed.</span></span>  
  
### <a name="ienumerable-support"></a><span data-ttu-id="781d4-209">IEnumerable 支援</span><span class="sxs-lookup"><span data-stu-id="781d4-209">IEnumerable Support</span></span>  
 <span data-ttu-id="781d4-210">元件可讓您將控制項<xref:System.Collections.IEnumerable>系結至資料來源。 <xref:System.Windows.Forms.BindingSource></span><span class="sxs-lookup"><span data-stu-id="781d4-210">The <xref:System.Windows.Forms.BindingSource> component enables binding controls to <xref:System.Collections.IEnumerable> data sources.</span></span> <span data-ttu-id="781d4-211">使用此元件, 您可以系結至資料來源 (例如<xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>)。</span><span class="sxs-lookup"><span data-stu-id="781d4-211">With this component, you can bind to a data source such as a <xref:System.Data.SqlClient.SqlDataReader?displayProperty=nameWithType>.</span></span>  
  
 <span data-ttu-id="781d4-212"><xref:System.Windows.Forms.BindingSource> <xref:System.Windows.Forms.BindingSource> <xref:System.Collections.IEnumerable>將資料來源指派給<xref:System.ComponentModel.IBindingList>元件時, 會建立, 並將資料來源的內容加入至清單中。 <xref:System.Collections.IEnumerable></span><span class="sxs-lookup"><span data-stu-id="781d4-212">When an <xref:System.Collections.IEnumerable> data source is assigned to the <xref:System.Windows.Forms.BindingSource> component, the <xref:System.Windows.Forms.BindingSource> creates an <xref:System.ComponentModel.IBindingList> and adds the contents of the <xref:System.Collections.IEnumerable> data source to the list.</span></span>  
  
### <a name="design-time-support"></a><span data-ttu-id="781d4-213">設計階段支援</span><span class="sxs-lookup"><span data-stu-id="781d4-213">Design-Time Support</span></span>  
 <span data-ttu-id="781d4-214">某些物件類型無法在設計階段建立, 例如從 factory 類別建立的物件, 或由 Web 服務傳回的物件。</span><span class="sxs-lookup"><span data-stu-id="781d4-214">Some object types cannot be created at design time, such as objects created from a factory class, or objects returned by a Web service.</span></span> <span data-ttu-id="781d4-215">您有時可能需要在設計階段將控制項系結至這些類型, 即使您的控制項可以系結的記憶體中沒有物件。</span><span class="sxs-lookup"><span data-stu-id="781d4-215">You may sometimes have to bind your controls to these types at design time, even though there is no object in memory to which your controls can bind.</span></span> <span data-ttu-id="781d4-216">例如, 您可能需要使用自訂類型之公用屬性的名稱<xref:System.Windows.Forms.DataGridView> , 為控制項的資料行標頭加上標籤。</span><span class="sxs-lookup"><span data-stu-id="781d4-216">You may, for example, need to label the column headers of a <xref:System.Windows.Forms.DataGridView> control with the names of your custom type's public properties.</span></span>  
  
 <span data-ttu-id="781d4-217">為了支援此案例, <xref:System.Windows.Forms.BindingSource>元件支援系結<xref:System.Type>至。</span><span class="sxs-lookup"><span data-stu-id="781d4-217">To support this scenario, the <xref:System.Windows.Forms.BindingSource> component supports binding to a <xref:System.Type>.</span></span> <span data-ttu-id="781d4-218">當您將指派<xref:System.Type> <xref:System.Windows.Forms.BindingSource.DataSource%2A>給屬性時, 該<xref:System.Windows.Forms.BindingSource>元件會建立一個<xref:System.ComponentModel.BindingList%601>空<xref:System.Type>的專案。</span><span class="sxs-lookup"><span data-stu-id="781d4-218">When you assign a <xref:System.Type> to the <xref:System.Windows.Forms.BindingSource.DataSource%2A> property, the <xref:System.Windows.Forms.BindingSource> component creates an empty <xref:System.ComponentModel.BindingList%601> of <xref:System.Type> items.</span></span> <span data-ttu-id="781d4-219">您後續系結至<xref:System.Windows.Forms.BindingSource>元件的任何控制項都會在設計階段或執行時間收到您類型的屬性或架構出現的警示。</span><span class="sxs-lookup"><span data-stu-id="781d4-219">Any controls you subsequently bind to the <xref:System.Windows.Forms.BindingSource> component will be alerted to the presence of the properties or schema of your type at design time, or at run time.</span></span> <span data-ttu-id="781d4-220">如需詳細資訊，請參閱[如何：將 Windows Forms 控制項系結至類型](how-to-bind-a-windows-forms-control-to-a-type.md)。</span><span class="sxs-lookup"><span data-stu-id="781d4-220">For more information, see [How to: Bind a Windows Forms Control to a Type](how-to-bind-a-windows-forms-control-to-a-type.md).</span></span>  
  
### <a name="static-listbindinghelper-methods"></a><span data-ttu-id="781d4-221">靜態 ListBindingHelper 方法</span><span class="sxs-lookup"><span data-stu-id="781d4-221">Static ListBindingHelper Methods</span></span>  
 <span data-ttu-id="781d4-222"><xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>、和<xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>類型全都/會共用`DataSource` 共同的邏輯,以從`DataMember`配對產生清單。 <xref:System.Windows.Forms.BindingSource></span><span class="sxs-lookup"><span data-stu-id="781d4-222">The <xref:System.Windows.Forms.BindingContext?displayProperty=nameWithType>, <xref:System.Windows.Forms.CurrencyManager?displayProperty=nameWithType>, and <xref:System.Windows.Forms.BindingSource> types all share common logic to generate a list from a `DataSource`/`DataMember` pair.</span></span> <span data-ttu-id="781d4-223">此外, 這個常見的邏輯會公開供控制項作者和其他協力廠商用於下列`static`方法:</span><span class="sxs-lookup"><span data-stu-id="781d4-223">Additionally, this common logic is publicly exposed for use by control authors and other third parties in the following `static` methods:</span></span>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListItemProperties%2A>  
  
- <span data-ttu-id="781d4-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span><span class="sxs-lookup"><span data-stu-id="781d4-224"><xref:System.Windows.Forms.ListBindingHelper.GetList%2A>.</span></span>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListName%2A>  
  
- <xref:System.Windows.Forms.ListBindingHelper.GetListItemType%2A>  
  
### <a name="sorting-and-filtering-with-the-ibindinglistview-interface"></a><span data-ttu-id="781d4-225">使用 IBindingListView 介面進行排序和篩選</span><span class="sxs-lookup"><span data-stu-id="781d4-225">Sorting and Filtering with the IBindingListView Interface</span></span>  
 <span data-ttu-id="781d4-226">元件會執行<xref:System.ComponentModel.IBindingList>介面, 以擴充介面。 <xref:System.ComponentModel.IBindingListView> <xref:System.Windows.Forms.BindingSource></span><span class="sxs-lookup"><span data-stu-id="781d4-226">The <xref:System.Windows.Forms.BindingSource> component implements the <xref:System.ComponentModel.IBindingListView> interface, which extends the <xref:System.ComponentModel.IBindingList> interface.</span></span> <span data-ttu-id="781d4-227">提供單一資料行排序, 以及<xref:System.ComponentModel.IBindingListView>提供先進的排序和篩選。 <xref:System.ComponentModel.IBindingList></span><span class="sxs-lookup"><span data-stu-id="781d4-227">The <xref:System.ComponentModel.IBindingList> offers single column sorting and the <xref:System.ComponentModel.IBindingListView> offers advanced sorting and filtering.</span></span> <span data-ttu-id="781d4-228">使用<xref:System.ComponentModel.IBindingListView>, 您可以在資料來源中排序和篩選項目 (如果資料來源也會執行這些介面的其中一個)。</span><span class="sxs-lookup"><span data-stu-id="781d4-228">With <xref:System.ComponentModel.IBindingListView>, you can sort and filter items in the data source, if the data source also implements one of these interfaces.</span></span> <span data-ttu-id="781d4-229"><xref:System.Windows.Forms.BindingSource>元件不會提供這些成員的參考執行。</span><span class="sxs-lookup"><span data-stu-id="781d4-229">The <xref:System.Windows.Forms.BindingSource> component does not provide a reference implementation of these members.</span></span> <span data-ttu-id="781d4-230">相反地, 呼叫會轉送到基礎清單。</span><span class="sxs-lookup"><span data-stu-id="781d4-230">Instead, calls are forwarded to the underlying list.</span></span>  
  
 <span data-ttu-id="781d4-231">下表描述您用於排序和篩選的屬性。</span><span class="sxs-lookup"><span data-stu-id="781d4-231">The following table describes the properties you use for sorting and filtering.</span></span>  
  
|<span data-ttu-id="781d4-232">成員</span><span class="sxs-lookup"><span data-stu-id="781d4-232">Member</span></span>|<span data-ttu-id="781d4-233">描述</span><span class="sxs-lookup"><span data-stu-id="781d4-233">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="781d4-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-234"><xref:System.Windows.Forms.BindingSource.Filter%2A> property</span></span>|<span data-ttu-id="781d4-235">如果資料來源是 <xref:System.ComponentModel.IBindingListView>，可取得或設定用來篩選所檢視之資料列的運算式。</span><span class="sxs-lookup"><span data-stu-id="781d4-235">If the data source is an <xref:System.ComponentModel.IBindingListView>, gets or sets the expression used to filter which rows are viewed.</span></span>|  
|<span data-ttu-id="781d4-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="781d4-236"><xref:System.Windows.Forms.BindingSource.Sort%2A> property</span></span>|<span data-ttu-id="781d4-237">如果資料來源是 <xref:System.ComponentModel.IBindingList>，可取得或設定用來排序的資料行名稱，以及排序次序資訊。</span><span class="sxs-lookup"><span data-stu-id="781d4-237">If the data source is an <xref:System.ComponentModel.IBindingList>, gets or sets a column name used for sorting and sort order information.</span></span><br /><br /> <span data-ttu-id="781d4-238">-或-</span><span class="sxs-lookup"><span data-stu-id="781d4-238">-or-</span></span><br /><br /> <span data-ttu-id="781d4-239">如果資料來源是<xref:System.ComponentModel.IBindingListView>並支援高階排序, 會取得用於排序和排序次序的多個資料行名稱</span><span class="sxs-lookup"><span data-stu-id="781d4-239">If the data source is an <xref:System.ComponentModel.IBindingListView> and supports advanced sorting, gets multiple column names used for sorting and sort order</span></span>|  
  
### <a name="integration-with-bindingnavigator"></a><span data-ttu-id="781d4-240">與 BindingNavigator 整合</span><span class="sxs-lookup"><span data-stu-id="781d4-240">Integration with BindingNavigator</span></span>  
 <span data-ttu-id="781d4-241">您可以使用<xref:System.Windows.Forms.BindingSource>元件將任何 Windows Forms 控制項系結至資料來源, <xref:System.Windows.Forms.BindingNavigator>但控制項是<xref:System.Windows.Forms.BindingSource>特別設計來與元件搭配使用。</span><span class="sxs-lookup"><span data-stu-id="781d4-241">You can use the <xref:System.Windows.Forms.BindingSource> component to bind any Windows Forms control to a data source, but the <xref:System.Windows.Forms.BindingNavigator> control is designed specifically to work with the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="781d4-242">控制項會提供用來<xref:System.Windows.Forms.BindingSource>控制元件目前專案的使用者介面。 <xref:System.Windows.Forms.BindingNavigator></span><span class="sxs-lookup"><span data-stu-id="781d4-242">The <xref:System.Windows.Forms.BindingNavigator> control provides a user interface for controlling the <xref:System.Windows.Forms.BindingSource> component's current item.</span></span> <span data-ttu-id="781d4-243">根據預設, <xref:System.Windows.Forms.BindingNavigator>控制項會提供對應至<xref:System.Windows.Forms.BindingSource>元件上之導覽方法的按鈕。</span><span class="sxs-lookup"><span data-stu-id="781d4-243">By default, the <xref:System.Windows.Forms.BindingNavigator> control provides buttons that correspond to the navigation methods on the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="781d4-244">如需詳細資訊，請參閱[如何：使用 Windows Forms BindingNavigator 控制項](how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md)流覽資料。</span><span class="sxs-lookup"><span data-stu-id="781d4-244">For more information, see [How to: Navigate Data with the Windows Forms BindingNavigator Control](how-to-navigate-data-with-the-windows-forms-bindingnavigator-control.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="781d4-245">另請參閱</span><span class="sxs-lookup"><span data-stu-id="781d4-245">See also</span></span>

- <xref:System.Windows.Forms.BindingSource>
- <xref:System.Windows.Forms.BindingNavigator>
- [<span data-ttu-id="781d4-246">BindingSource 元件概觀</span><span class="sxs-lookup"><span data-stu-id="781d4-246">BindingSource Component Overview</span></span>](bindingsource-component-overview.md)
- [<span data-ttu-id="781d4-247">BindingNavigator 控制項</span><span class="sxs-lookup"><span data-stu-id="781d4-247">BindingNavigator Control</span></span>](bindingnavigator-control-windows-forms.md)
- [<span data-ttu-id="781d4-248">Windows Forms 資料繫結</span><span class="sxs-lookup"><span data-stu-id="781d4-248">Windows Forms Data Binding</span></span>](../windows-forms-data-binding.md)
- [<span data-ttu-id="781d4-249">在 Windows Forms 上使用的控制項</span><span class="sxs-lookup"><span data-stu-id="781d4-249">Controls to Use on Windows Forms</span></span>](controls-to-use-on-windows-forms.md)
- [<span data-ttu-id="781d4-250">如何：將 Windows Forms 控制項系結至類型</span><span class="sxs-lookup"><span data-stu-id="781d4-250">How to: Bind a Windows Forms Control to a Type</span></span>](how-to-bind-a-windows-forms-control-to-a-type.md)
- [<span data-ttu-id="781d4-251">如何：使用 BindingSource 反映 Windows Forms 控制項中的資料來源更新</span><span class="sxs-lookup"><span data-stu-id="781d4-251">How to: Reflect Data Source Updates in a Windows Forms Control with the BindingSource</span></span>](reflect-data-source-updates-in-a-wf-control-with-the-bindingsource.md)
