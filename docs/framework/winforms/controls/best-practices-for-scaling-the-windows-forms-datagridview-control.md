---
title: 縮放 Windows Form DataGridView 控制項的最佳作法
ms.date: 03/30/2017
helpviewer_keywords:
- DataGridView control [Windows Forms], row sharing
- data grids [Windows Forms], best practices
- DataGridView control [Windows Forms], shared rows
- DataGridView control [Windows Forms], best practices
- best practices [Windows Forms], dataGridView control
- DataGridView control [Windows Forms], scaling
ms.assetid: 8321a8a6-6340-4fd1-b475-fa090b905aaf
ms.openlocfilehash: 895dd132c070157355c28a935e43240f2750159e
ms.sourcegitcommit: 160a88c8087b0e63606e6e35f9bd57fa5f69c168
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/09/2019
ms.locfileid: "57706413"
---
# <a name="best-practices-for-scaling-the-windows-forms-datagridview-control"></a><span data-ttu-id="0f6c8-102">縮放 Windows Form DataGridView 控制項的最佳作法</span><span class="sxs-lookup"><span data-stu-id="0f6c8-102">Best Practices for Scaling the Windows Forms DataGridView Control</span></span>
<span data-ttu-id="0f6c8-103"><xref:System.Windows.Forms.DataGridView>控制項的設計是可提供最大的延展性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-103">The <xref:System.Windows.Forms.DataGridView> control is designed to provide maximum scalability.</span></span> <span data-ttu-id="0f6c8-104">如果您要顯示大量的資料，您應該遵循本主題，以避免消耗大量的記憶體，或降低回應能力的使用者介面 (UI) 中所述的指導方針。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-104">If you need to display large amounts of data, you should follow the guidelines described in this topic to avoid consuming large amounts of memory or degrading the responsiveness of the user interface (UI).</span></span> <span data-ttu-id="0f6c8-105">本主題將討論下列問題：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-105">This topic discusses the following issues:</span></span>  
  
-   <span data-ttu-id="0f6c8-106">有效率地使用的儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="0f6c8-106">Using cell styles efficiently</span></span>  
  
-   <span data-ttu-id="0f6c8-107">有效率地使用快顯功能表</span><span class="sxs-lookup"><span data-stu-id="0f6c8-107">Using shortcut menus efficiently</span></span>  
  
-   <span data-ttu-id="0f6c8-108">使用有效率的方式自動的調整大小</span><span class="sxs-lookup"><span data-stu-id="0f6c8-108">Using automatic resizing efficiently</span></span>  
  
-   <span data-ttu-id="0f6c8-109">有效率地使用選取的資料格、 資料列和資料行集合</span><span class="sxs-lookup"><span data-stu-id="0f6c8-109">Using the selected cells, rows, and columns collections efficiently</span></span>  
  
-   <span data-ttu-id="0f6c8-110">使用共用的資料列</span><span class="sxs-lookup"><span data-stu-id="0f6c8-110">Using shared rows</span></span>  
  
-   <span data-ttu-id="0f6c8-111">防止資料列變成非共用</span><span class="sxs-lookup"><span data-stu-id="0f6c8-111">Preventing rows from becoming unshared</span></span>  
  
 <span data-ttu-id="0f6c8-112">如果您有特殊效能需求，您可以實作虛擬模式，並提供您自己的資料管理作業。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-112">If you have special performance needs, you can implement virtual mode and provide your own data management operations.</span></span> <span data-ttu-id="0f6c8-113">如需詳細資訊，請參閱 < [Windows Forms DataGridView 控制項中的資料顯示模式](data-display-modes-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-113">For more information, see [Data Display Modes in the Windows Forms DataGridView Control](data-display-modes-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-cell-styles-efficiently"></a><span data-ttu-id="0f6c8-114">有效率地使用的儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="0f6c8-114">Using Cell Styles Efficiently</span></span>  
 <span data-ttu-id="0f6c8-115">每個資料格、 資料列和資料行可以有它自己的樣式資訊。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-115">Each cell, row, and column can have its own style information.</span></span> <span data-ttu-id="0f6c8-116">樣式資訊會儲存在<xref:System.Windows.Forms.DataGridViewCellStyle>物件。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-116">Style information is stored in <xref:System.Windows.Forms.DataGridViewCellStyle> objects.</span></span> <span data-ttu-id="0f6c8-117">建立針對許多個別儲存格樣式物件<xref:System.Windows.Forms.DataGridView>項目可以是效率不佳，尤其是使用大量的資料。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-117">Creating cell style objects for many individual <xref:System.Windows.Forms.DataGridView> elements can be inefficient, especially when working with large amounts of data.</span></span> <span data-ttu-id="0f6c8-118">若要避免對效能產生影響，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-118">To avoid a performance impact, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="0f6c8-119">請避免設定個別的儲存格樣式屬性<xref:System.Windows.Forms.DataGridViewCell>或<xref:System.Windows.Forms.DataGridViewRow>物件。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-119">Avoid setting cell style properties for individual <xref:System.Windows.Forms.DataGridViewCell> or <xref:System.Windows.Forms.DataGridViewRow> objects.</span></span> <span data-ttu-id="0f6c8-120">這包括所指定的資料列物件<xref:System.Windows.Forms.DataGridView.RowTemplate%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-120">This includes the row object specified by the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A> property.</span></span> <span data-ttu-id="0f6c8-121">每個新的資料列作為複製來源資料列範本，將會收到它自己的範本的儲存格樣式物件的複本。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-121">Each new row that is cloned from the row template will receive its own copy of the template's cell style object.</span></span> <span data-ttu-id="0f6c8-122">最大延展性，設定儲存格樣式屬性，在<xref:System.Windows.Forms.DataGridView>層級。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-122">For maximum scalability, set cell style properties at the <xref:System.Windows.Forms.DataGridView> level.</span></span> <span data-ttu-id="0f6c8-123">例如，設定<xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType>屬性而非<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-123">For example, set the <xref:System.Windows.Forms.DataGridView.DefaultCellStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="0f6c8-124">如果某些資料格需要格式而非預設的格式設定，請使用相同<xref:System.Windows.Forms.DataGridViewCellStyle>跨越的資料格、 資料列或資料行群組的執行個體。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-124">If some cells require formatting other than default formatting, use the same <xref:System.Windows.Forms.DataGridViewCellStyle> instance across groups of cells, rows, or columns.</span></span> <span data-ttu-id="0f6c8-125">請避免直接設定屬性的型別<xref:System.Windows.Forms.DataGridViewCellStyle>個別儲存格、 資料列和資料行上。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-125">Avoid directly setting properties of type <xref:System.Windows.Forms.DataGridViewCellStyle> on individual cells, rows, and columns.</span></span> <span data-ttu-id="0f6c8-126">如需的儲存格樣式共用的範例，請參閱[How to:設定 Windows Form DataGridView 控制項的預設儲存格樣式](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-126">For an example of cell style sharing, see [How to: Set Default Cell Styles for the Windows Forms DataGridView Control](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md).</span></span> <span data-ttu-id="0f6c8-127">您也可以藉由處理個別設定儲存格樣式時避免對效能帶來負面影響<xref:System.Windows.Forms.DataGridView.CellFormatting>事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-127">You can also avoid a performance penalty when setting cell styles individually by handling the <xref:System.Windows.Forms.DataGridView.CellFormatting> event handler.</span></span> <span data-ttu-id="0f6c8-128">如需範例，請參閱[如何：自訂 Windows Form DataGridView 控制項中的資料格式](how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-128">For an example, see [How to: Customize Data Formatting in the Windows Forms DataGridView Control](how-to-customize-data-formatting-in-the-windows-forms-datagridview-control.md).</span></span>  
  
-   <span data-ttu-id="0f6c8-129">在決定的儲存格樣式，請使用<xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType>屬性而非<xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-129">When determining a cell's style, use the <xref:System.Windows.Forms.DataGridViewCell.InheritedStyle%2A?displayProperty=nameWithType> property rather than the <xref:System.Windows.Forms.DataGridViewCell.Style%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="0f6c8-130">存取<xref:System.Windows.Forms.DataGridViewCell.Style%2A>屬性建立的新執行個體<xref:System.Windows.Forms.DataGridViewCellStyle>類別已經尚未使用的屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-130">Accessing the <xref:System.Windows.Forms.DataGridViewCell.Style%2A> property creates a new instance of the <xref:System.Windows.Forms.DataGridViewCellStyle> class if the property has not already been used.</span></span> <span data-ttu-id="0f6c8-131">此外，如果某些樣式繼承自資料列、 資料行或控制這個物件可能並未包含儲存格的完整樣式資訊。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-131">Additionally, this object might not contain the complete style information for the cell if some styles are inherited from the row, column, or control.</span></span> <span data-ttu-id="0f6c8-132">如需有關儲存格樣式繼承的詳細資訊，請參閱[Windows Forms DataGridView 控制項中的儲存格樣式](cell-styles-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-132">For more information about cell style inheritance, see [Cell Styles in the Windows Forms DataGridView Control](cell-styles-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-shortcut-menus-efficiently"></a><span data-ttu-id="0f6c8-133">有效率地使用快顯功能表</span><span class="sxs-lookup"><span data-stu-id="0f6c8-133">Using Shortcut Menus Efficiently</span></span>  
 <span data-ttu-id="0f6c8-134">每個資料格、 資料列和資料行可以有它自己的快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-134">Each cell, row, and column can have its own shortcut menu.</span></span> <span data-ttu-id="0f6c8-135">中的快顯功能表<xref:System.Windows.Forms.DataGridView>控制項由<xref:System.Windows.Forms.ContextMenuStrip>控制項。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-135">Shortcut menus in the <xref:System.Windows.Forms.DataGridView> control are represented by <xref:System.Windows.Forms.ContextMenuStrip> controls.</span></span> <span data-ttu-id="0f6c8-136">如同儲存格樣式的物件，建立快顯功能表針對許多個別<xref:System.Windows.Forms.DataGridView>項目將會對效能產生負面影響。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-136">Just as with cell style objects, creating shortcut menus for many individual <xref:System.Windows.Forms.DataGridView> elements will negatively impact performance.</span></span> <span data-ttu-id="0f6c8-137">若要避免這種效能損失，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-137">To avoid this penalty, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="0f6c8-138">請避免建立個別儲存格和資料列的捷徑功能表。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-138">Avoid creating shortcut menus for individual cells and rows.</span></span> <span data-ttu-id="0f6c8-139">這包括資料列範本，當新的資料列加入至控制項時，會將其捷徑功能表以及複製。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-139">This includes the row template, which is cloned along with its shortcut menu when new rows are added to the control.</span></span> <span data-ttu-id="0f6c8-140">最大的擴充性，使用只有控制項的<xref:System.Windows.Forms.Control.ContextMenuStrip%2A>屬性可指定整個控制項的單一快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-140">For maximum scalability, use only the control's <xref:System.Windows.Forms.Control.ContextMenuStrip%2A> property to specify a single shortcut menu for the entire control.</span></span>  
  
-   <span data-ttu-id="0f6c8-141">如果您需要多個快顯功能表的多個資料列或資料格時，處理<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>或<xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded>事件。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-141">If you require multiple shortcut menus for multiple rows or cells, handle the <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> or <xref:System.Windows.Forms.DataGridView.RowContextMenuStripNeeded> events.</span></span> <span data-ttu-id="0f6c8-142">這些事件可讓您管理的快顯功能表物件自己，可讓您調整效能。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-142">These events let you manage the shortcut menu objects yourself, allowing you to tune performance.</span></span>  
  
## <a name="using-automatic-resizing-efficiently"></a><span data-ttu-id="0f6c8-143">使用有效率的方式自動的調整大小</span><span class="sxs-lookup"><span data-stu-id="0f6c8-143">Using Automatic Resizing Efficiently</span></span>  
 <span data-ttu-id="0f6c8-144">資料列、 資料行和標頭可以是自動調整為資料格的內容變更，讓整個儲存格的內容會顯示未遭裁剪。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-144">Rows, columns, and headers can be automatically resized as cell content changes so that the entire contents of cells are displayed without clipping.</span></span> <span data-ttu-id="0f6c8-145">變更縮放模式也可以調整資料列、 資料行和標頭。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-145">Changing sizing modes can also resize rows, columns, and headers.</span></span> <span data-ttu-id="0f6c8-146">若要判斷正確的大小，<xref:System.Windows.Forms.DataGridView>控制項必須檢查它必須配合每個儲存格的值。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-146">To determine the correct size, the <xref:System.Windows.Forms.DataGridView> control must examine the value of each cell that it must accommodate.</span></span> <span data-ttu-id="0f6c8-147">當使用大型資料集，這項分析可以效能產生負面影響的控制項時自動調整大小，就會發生。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-147">When working with large data sets, this analysis can negatively impact the performance of the control when automatic resizing occurs.</span></span> <span data-ttu-id="0f6c8-148">若要避免效能的負面影響，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-148">To avoid performance penalties, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="0f6c8-149">請避免使用自動調整大小上<xref:System.Windows.Forms.DataGridView>大型的資料列集的控制項。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-149">Avoid using automatic sizing on a <xref:System.Windows.Forms.DataGridView> control with a large set of rows.</span></span> <span data-ttu-id="0f6c8-150">如果您使用自動調整大小，只根據顯示的資料列的調整大小。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-150">If you do use automatic sizing, only resize based on the displayed rows.</span></span> <span data-ttu-id="0f6c8-151">在虛擬模式中也使用只顯示的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-151">Use only the displayed rows in virtual mode as well.</span></span>  
  
    -   <span data-ttu-id="0f6c8-152">資料列和資料行，請使用`DisplayedCells`或是`DisplayedCellsExceptHeaders`欄位<xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>， <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>，和<xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode>列舉型別。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-152">For rows and columns, use the `DisplayedCells` or `DisplayedCellsExceptHeaders` field of the <xref:System.Windows.Forms.DataGridViewAutoSizeRowsMode>, <xref:System.Windows.Forms.DataGridViewAutoSizeColumnsMode>, and <xref:System.Windows.Forms.DataGridViewAutoSizeColumnMode> enumerations.</span></span>  
  
    -   <span data-ttu-id="0f6c8-153">用於資料列行首<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders>或是<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader>欄位<xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode>列舉型別。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-153">For row headers, use the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToDisplayedHeaders> or <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode.AutoSizeToFirstHeader> field of the <xref:System.Windows.Forms.DataGridViewRowHeadersWidthSizeMode> enumeration.</span></span>  
  
-   <span data-ttu-id="0f6c8-154">最大延展性，關閉自動調整大小，並使用以程式設計方式調整大小。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-154">For maximum scalability, turn off automatic sizing and use programmatic resizing.</span></span>  
  
 <span data-ttu-id="0f6c8-155">如需詳細資訊，請參閱 < [Windows Forms DataGridView 控制項中的調整大小選項](sizing-options-in-the-windows-forms-datagridview-control.md)。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-155">For more information, see [Sizing Options in the Windows Forms DataGridView Control](sizing-options-in-the-windows-forms-datagridview-control.md).</span></span>  
  
## <a name="using-the-selected-cells-rows-and-columns-collections-efficiently"></a><span data-ttu-id="0f6c8-156">有效率地使用選取的資料格、 列和資料行集合</span><span class="sxs-lookup"><span data-stu-id="0f6c8-156">Using the Selected Cells, Rows, and Columns Collections Efficiently</span></span>  
 <span data-ttu-id="0f6c8-157"><xref:System.Windows.Forms.DataGridView.SelectedCells%2A>大型的選取項目後的集合不會有效率地執行。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-157">The <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection does not perform efficiently with large selections.</span></span> <span data-ttu-id="0f6c8-158"><xref:System.Windows.Forms.DataGridView.SelectedRows%2A>並<xref:System.Windows.Forms.DataGridView.SelectedColumns%2A>集合也可以是效率不佳，雖然是以壓縮的程度會因為有許多資料列少於在典型的資料格<xref:System.Windows.Forms.DataGridView>控制和資料列比許多較少的資料行。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-158">The <xref:System.Windows.Forms.DataGridView.SelectedRows%2A> and <xref:System.Windows.Forms.DataGridView.SelectedColumns%2A> collections can also be inefficient, although to a lesser degree because there are many fewer rows than cells in a typical <xref:System.Windows.Forms.DataGridView> control, and many fewer columns than rows.</span></span> <span data-ttu-id="0f6c8-159">若要使用這些集合時，請避免效能的負面影響，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-159">To avoid performance penalties when working with these collections, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="0f6c8-160">若要判斷是否中的所有儲存格<xref:System.Windows.Forms.DataGridView>存取的內容之前已選取<xref:System.Windows.Forms.DataGridView.SelectedCells%2A>集合中，檢查傳回值的<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-160">To determine whether all the cells in the <xref:System.Windows.Forms.DataGridView> have been selected before you access the contents of the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A> collection, check the return value of the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A> method.</span></span> <span data-ttu-id="0f6c8-161">不過，要注意的是，這個方法可能會導致變成非共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-161">Note, however, that this method can cause rows to become unshared.</span></span> <span data-ttu-id="0f6c8-162">如需詳細資訊，請參閱下一章節。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-162">For more information, see the next section.</span></span>  
  
-   <span data-ttu-id="0f6c8-163">請避免使用<xref:System.Collections.ICollection.Count%2A>屬性<xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType>來決定選取之資料格數目。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-163">Avoid using the <xref:System.Collections.ICollection.Count%2A> property of the <xref:System.Windows.Forms.DataGridViewSelectedCellCollection?displayProperty=nameWithType> to determine the number of selected cells.</span></span> <span data-ttu-id="0f6c8-164">請改用<xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType>方法並傳入<xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType>值。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-164">Instead, use the <xref:System.Windows.Forms.DataGridView.GetCellCount%2A?displayProperty=nameWithType> method and pass in the <xref:System.Windows.Forms.DataGridViewElementStates.Selected?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="0f6c8-165">同樣地，使用<xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType>和<xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType>方法來判斷選取的項目，而不是存取選取的資料列和資料行集合的數目。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-165">Similarly, use the <xref:System.Windows.Forms.DataGridViewRowCollection.GetRowCount%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.DataGridViewColumnCollection.GetColumnCount%2A?displayProperty=nameWithType> methods to determine the number of selected elements, rather than accessing the selected row and column collections.</span></span>  
  
-   <span data-ttu-id="0f6c8-166">避免資料格為基礎的選取模式。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-166">Avoid cell-based selection modes.</span></span> <span data-ttu-id="0f6c8-167">相反地，設定<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>屬性，以<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-167">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
## <a name="using-shared-rows"></a><span data-ttu-id="0f6c8-168">使用共用資料列</span><span class="sxs-lookup"><span data-stu-id="0f6c8-168">Using Shared Rows</span></span>  
 <span data-ttu-id="0f6c8-169">有效率的記憶體使用量，就能<xref:System.Windows.Forms.DataGridView>透過共用的資料列的控制。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-169">Efficient memory use is achieved in the <xref:System.Windows.Forms.DataGridView> control through shared rows.</span></span> <span data-ttu-id="0f6c8-170">資料列會共用其外觀和行為的相關最多資訊，盡可能共用的執行個體<xref:System.Windows.Forms.DataGridViewRow>類別。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-170">Rows will share as much information about their appearance and behavior as possible by sharing instances of the <xref:System.Windows.Forms.DataGridViewRow> class.</span></span>  
  
 <span data-ttu-id="0f6c8-171">共用資料列執行個體節省記憶體，而資料列很容易變得不共用。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-171">While sharing row instances saves memory, rows can easily become unshared.</span></span> <span data-ttu-id="0f6c8-172">例如，每當使用者互動直接與儲存格時，其資料列會變成不共用。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-172">For example, whenever a user interacts directly with a cell, its row becomes unshared.</span></span> <span data-ttu-id="0f6c8-173">這並無法避免，因為本主題中的指導方針只在使用非常大量的資料時，才，並且唯有在使用者互動相對較小的部分資料的每次執行程式時很有用。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-173">Because this cannot be avoided, the guidelines in this topic are useful only when working with very large amounts of data and only when users will interact with a relatively small part of the data each time your program is run.</span></span>  
  
 <span data-ttu-id="0f6c8-174">無法共用一個資料列中包含解除繫結<xref:System.Windows.Forms.DataGridView>控制如果它的儲存格的任何包含的值。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-174">A row cannot be shared in an unbound <xref:System.Windows.Forms.DataGridView> control if any of its cells contain values.</span></span> <span data-ttu-id="0f6c8-175">當<xref:System.Windows.Forms.DataGridView>控制項所繫結至外部資料來源，或控制項之外，而不是資料格物件，可讓要共用的資料列中，當您實作虛擬模式，並提供您自己的資料來源，會儲存資料格的值。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-175">When the <xref:System.Windows.Forms.DataGridView> control is bound to an external data source or when you implement virtual mode and provide your own data source, the cell values are stored outside the control rather than in cell objects, allowing the rows to be shared.</span></span>  
  
 <span data-ttu-id="0f6c8-176">如果可以判斷其所有儲存格的狀態，從資料列狀態和資料行包含儲存格的狀態，可共用的資料列物件。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-176">A row object can only be shared if the state of all its cells can be determined from the state of the row and the states of the columns containing the cells.</span></span> <span data-ttu-id="0f6c8-177">如果您變更儲存格的狀態，使它不再推算其資料列和資料行的狀態，無法共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-177">If you change the state of a cell so that it can no longer be deduced from the state of its row and column, the row cannot be shared.</span></span>  
  
 <span data-ttu-id="0f6c8-178">比方說，資料列不共用任何下列情況：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-178">For example, a row cannot be shared in any of the following situations:</span></span>  
  
-   <span data-ttu-id="0f6c8-179">資料列都包含單一的所選儲存格不在所選資料行中。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-179">The row contains a single selected cell that is not in a selected column.</span></span>  
  
-   <span data-ttu-id="0f6c8-180">資料列包含資料格與它<xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A>或<xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A>屬性集。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-180">The row contains a cell with its <xref:System.Windows.Forms.DataGridViewCell.ToolTipText%2A> or <xref:System.Windows.Forms.DataGridViewCell.ContextMenuStrip%2A> properties set.</span></span>  
  
-   <span data-ttu-id="0f6c8-181">資料列都包含<xref:System.Windows.Forms.DataGridViewComboBoxCell>具有其<xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A>屬性集。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-181">The row contains a <xref:System.Windows.Forms.DataGridViewComboBoxCell> with its <xref:System.Windows.Forms.DataGridViewComboBoxCell.Items%2A> property set.</span></span>  
  
 <span data-ttu-id="0f6c8-182">在繫結的模式或虛擬模式中，您可以提供工具提示和捷徑功能表個別資料格的處理<xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded>和<xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded>事件。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-182">In bound mode or virtual mode, you can provide ToolTips and shortcut menus for individual cells by handling the <xref:System.Windows.Forms.DataGridView.CellToolTipTextNeeded> and <xref:System.Windows.Forms.DataGridView.CellContextMenuStripNeeded> events.</span></span>  
  
 <span data-ttu-id="0f6c8-183"><xref:System.Windows.Forms.DataGridView>控制項將會自動嘗試使用共用的資料列，每當資料列會加入<xref:System.Windows.Forms.DataGridViewRowCollection>。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-183">The <xref:System.Windows.Forms.DataGridView> control will automatically attempt to use shared rows whenever rows are added to the <xref:System.Windows.Forms.DataGridViewRowCollection>.</span></span> <span data-ttu-id="0f6c8-184">若要確認資料列共用，使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-184">Use the following guidelines to ensure that rows are shared:</span></span>  
  
-   <span data-ttu-id="0f6c8-185">避免呼叫`Add(Object[])`多載<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>方法並`Insert(Object[])`多載<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-185">Avoid calling the `Add(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method and the `Insert(Object[])` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="0f6c8-186">這些多載會自動建立非共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-186">These overloads automatically create unshared rows.</span></span>  
  
-   <span data-ttu-id="0f6c8-187">請確認在指定的資料列<xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType>可共用屬性，在下列情況：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-187">Be sure that the row specified in the <xref:System.Windows.Forms.DataGridView.RowTemplate%2A?displayProperty=nameWithType> property can be shared in the following cases:</span></span>  
  
    -   <span data-ttu-id="0f6c8-188">呼叫時`Add()`或是`Add(Int32)`的多載<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>方法或`Insert(Int32,Int32)`多載<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-188">When calling the `Add()` or `Add(Int32)` overloads of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method or the `Insert(Int32,Int32)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
    -   <span data-ttu-id="0f6c8-189">增加的值時<xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-189">When increasing the value of the <xref:System.Windows.Forms.DataGridView.RowCount%2A?displayProperty=nameWithType> property.</span></span>  
  
    -   <span data-ttu-id="0f6c8-190">設定時<xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-190">When setting the <xref:System.Windows.Forms.DataGridView.DataSource%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="0f6c8-191">請確認所指定的資料列`indexSource`呼叫時，就可以共用參數<xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>， <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>， <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>，並<xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-191">Be sure that the row indicated by the `indexSource` parameter can be shared when calling the <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopy%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.AddCopies%2A>, <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopy%2A>, and <xref:System.Windows.Forms.DataGridViewRowCollection.InsertCopies%2A> methods of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
-   <span data-ttu-id="0f6c8-192">確定建議的指定資料列或資料列可以共用時呼叫`Add(DataGridViewRow)`多載<xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A>方法，<xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A>方法，`Insert(Int32,DataGridViewRow)`多載<xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A>方法，而<xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A>方法<xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-192">Be sure that the specified row or rows can be shared when calling the `Add(DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Add%2A> method, the <xref:System.Windows.Forms.DataGridViewRowCollection.AddRange%2A> method, the `Insert(Int32,DataGridViewRow)` overload of the <xref:System.Windows.Forms.DataGridViewRowCollection.Insert%2A> method, and the <xref:System.Windows.Forms.DataGridViewRowCollection.InsertRange%2A> method of the <xref:System.Windows.Forms.DataGridView.Rows%2A?displayProperty=nameWithType> collection.</span></span>  
  
 <span data-ttu-id="0f6c8-193">若要判斷是否為共用資料列，請使用<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType>方法來擷取資料列物件，並接著檢查物件的<xref:System.Windows.Forms.DataGridViewBand.Index%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-193">To determine whether a row is shared, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method to retrieve the row object, and then check the object's <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property.</span></span> <span data-ttu-id="0f6c8-194">共用的資料列一定<xref:System.Windows.Forms.DataGridViewBand.Index%2A>屬性值為-1。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-194">Shared rows always have an <xref:System.Windows.Forms.DataGridViewBand.Index%2A> property value of –1.</span></span>  
  
## <a name="preventing-rows-from-becoming-unshared"></a><span data-ttu-id="0f6c8-195">防止資料列變成非共用</span><span class="sxs-lookup"><span data-stu-id="0f6c8-195">Preventing Rows from Becoming Unshared</span></span>  
 <span data-ttu-id="0f6c8-196">共用的資料列可能會取消共用程式碼或使用者動作的結果。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-196">Shared rows can become unshared as a result of code or user action.</span></span> <span data-ttu-id="0f6c8-197">若要避免對效能產生影響，您應該避免造成變成非共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-197">To avoid a performance impact, you should avoid causing rows to become unshared.</span></span> <span data-ttu-id="0f6c8-198">應用程式在開發期間，您可以處理<xref:System.Windows.Forms.DataGridView.RowUnshared>事件，以判斷當資料列變為非共用。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-198">During application development, you can handle the <xref:System.Windows.Forms.DataGridView.RowUnshared> event to determine when rows become unshared.</span></span> <span data-ttu-id="0f6c8-199">當資料列共用問題進行偵錯時，這非常有用。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-199">This is useful when debugging row-sharing problems.</span></span>  
  
 <span data-ttu-id="0f6c8-200">若要防止資料列變成非共用，請使用下列指導方針：</span><span class="sxs-lookup"><span data-stu-id="0f6c8-200">To prevent rows from becoming unshared, use the following guidelines:</span></span>  
  
-   <span data-ttu-id="0f6c8-201">避免索引編製<xref:System.Windows.Forms.DataGridView.Rows%2A>集合或逐一查看與`foreach`迴圈。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-201">Avoid indexing the <xref:System.Windows.Forms.DataGridView.Rows%2A> collection or iterating through it with a `foreach` loop.</span></span> <span data-ttu-id="0f6c8-202">您會通常不需要直接存取的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-202">You will not typically need to access rows directly.</span></span> <span data-ttu-id="0f6c8-203"><xref:System.Windows.Forms.DataGridView> 對資料列的方法會採用資料列索引引數，而不是資料列執行個體。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-203"><xref:System.Windows.Forms.DataGridView> methods that operate on rows take row index arguments rather than row instances.</span></span> <span data-ttu-id="0f6c8-204">此外，資料列相關的事件處理常式會收到事件引數物件包含可供您管理的資料列，而不會造成它們變成非共用的資料列屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-204">Additionally, handlers for row-related events receive event argument objects with row properties that you can use to manipulate rows without causing them to become unshared.</span></span>  
  
-   <span data-ttu-id="0f6c8-205">如果您需要存取資料列的物件，使用<xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType>方法並傳入資料列的實際的索引。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-205">If you need to access a row object, use the <xref:System.Windows.Forms.DataGridViewRowCollection.SharedRow%2A?displayProperty=nameWithType> method and pass in the row's actual index.</span></span> <span data-ttu-id="0f6c8-206">不過請注意，修改共用的資料列物件，擷取透過這個方法會修改共用此物件的所有資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-206">Note, however, that modifying a shared row object retrieved through this method will modify all the rows that share this object.</span></span> <span data-ttu-id="0f6c8-207">新記錄的資料列不會與共用其他資料列，不過，因此它不會影響當您修改任何其他資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-207">The row for new records is not shared with other rows, however, so it will not be affected when you modify any other row.</span></span> <span data-ttu-id="0f6c8-208">也請注意，共用的資料列代表不同的資料列可能會有不同的快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-208">Note also that different rows represented by a shared row may have different shortcut menus.</span></span> <span data-ttu-id="0f6c8-209">若要從共用的資料列執行個體中擷取正確的快顯功能表，請使用<xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A>方法並傳入資料列的實際的索引。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-209">To retrieve the correct shortcut menu from a shared row instance, use the <xref:System.Windows.Forms.DataGridViewRow.GetContextMenuStrip%2A> method and pass in the row's actual index.</span></span> <span data-ttu-id="0f6c8-210">如果您在存取共用的資料列<xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A>屬性相反地，它會使用共用資料列索引，-1，並將不會擷取正確的快顯功能表。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-210">If you access the shared row's <xref:System.Windows.Forms.DataGridViewRow.ContextMenuStrip%2A> property instead, it will use the shared row index of -1 and will not retrieve the correct shortcut menu.</span></span>  
  
-   <span data-ttu-id="0f6c8-211">避免索引<xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType>集合。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-211">Avoid indexing the <xref:System.Windows.Forms.DataGridViewRow.Cells%2A?displayProperty=nameWithType> collection.</span></span> <span data-ttu-id="0f6c8-212">直接存取的資料格，則會導致它變成非共用，具現化新的父資料列<xref:System.Windows.Forms.DataGridViewRow>。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-212">Accessing a cell directly will cause its parent row to become unshared, instantiating a new <xref:System.Windows.Forms.DataGridViewRow>.</span></span> <span data-ttu-id="0f6c8-213">儲存格相關的事件處理常式會接收事件引數物件包含可用來操作儲存格，而不會造成資料列變為非共用的資料格屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-213">Handlers for cell-related events receive event argument objects with cell properties that you can use to manipulate cells without causing rows to become unshared.</span></span> <span data-ttu-id="0f6c8-214">您也可以使用<xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A>屬性來擷取目前的儲存格的資料列和資料行索引，而不需要直接存取的資料格。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-214">You can also use the <xref:System.Windows.Forms.DataGridView.CurrentCellAddress%2A> property to retrieve the row and column indexes of the current cell without accessing the cell directly.</span></span>  
  
-   <span data-ttu-id="0f6c8-215">避免資料格為基礎的選取模式。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-215">Avoid cell-based selection modes.</span></span> <span data-ttu-id="0f6c8-216">這些模式會導致變成非共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-216">These modes cause rows to become unshared.</span></span> <span data-ttu-id="0f6c8-217">相反地，設定<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>屬性，以<xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-217">Instead, set the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property to <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect?displayProperty=nameWithType>.</span></span>  
  
-   <span data-ttu-id="0f6c8-218">不會處理<xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType>事件。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-218">Do not handle the <xref:System.Windows.Forms.DataGridViewRowCollection.CollectionChanged?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.RowStateChanged?displayProperty=nameWithType> events.</span></span> <span data-ttu-id="0f6c8-219">這些事件會導致變成非共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-219">These events cause rows to become unshared.</span></span> <span data-ttu-id="0f6c8-220">此外，請勿呼叫<xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType>或<xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType>引發這些事件的方法。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-220">Also, do not call the <xref:System.Windows.Forms.DataGridViewRowCollection.OnCollectionChanged%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.DataGridView.OnRowStateChanged%2A?displayProperty=nameWithType> methods, which raise these events.</span></span>  
  
-   <span data-ttu-id="0f6c8-221">不會存取<xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType>集合時<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>屬性值是<xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>， <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>， <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>，或<xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-221">Do not access the <xref:System.Windows.Forms.DataGridView.SelectedCells%2A?displayProperty=nameWithType> collection when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.FullColumnSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.ColumnHeaderSelect>, <xref:System.Windows.Forms.DataGridViewSelectionMode.FullRowSelect>, or <xref:System.Windows.Forms.DataGridViewSelectionMode.RowHeaderSelect>.</span></span> <span data-ttu-id="0f6c8-222">這會導致變成非共用所有選取的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-222">This causes all selected rows to become unshared.</span></span>  
  
-   <span data-ttu-id="0f6c8-223">請勿呼叫<xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-223">Do not call the <xref:System.Windows.Forms.DataGridView.AreAllCellsSelected%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="0f6c8-224">這個方法可能會導致變成非共用的資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-224">This method can cause rows to become unshared.</span></span>  
  
-   <span data-ttu-id="0f6c8-225">請勿呼叫<xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType>方法時<xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType>屬性值是<xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-225">Do not call the <xref:System.Windows.Forms.DataGridView.SelectAll%2A?displayProperty=nameWithType> method when the <xref:System.Windows.Forms.DataGridView.SelectionMode%2A?displayProperty=nameWithType> property value is <xref:System.Windows.Forms.DataGridViewSelectionMode.CellSelect>.</span></span> <span data-ttu-id="0f6c8-226">這會導致變成非共用的所有資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-226">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="0f6c8-227">未設定<xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A>或是<xref:System.Windows.Forms.DataGridViewCell.Selected%2A>屬性之資料格`false`當其資料行中對應的屬性設定為`true`。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-227">Do not set the <xref:System.Windows.Forms.DataGridViewCell.ReadOnly%2A> or <xref:System.Windows.Forms.DataGridViewCell.Selected%2A> property of a cell to `false` when the corresponding property in its column is set to `true`.</span></span> <span data-ttu-id="0f6c8-228">這會導致變成非共用的所有資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-228">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="0f6c8-229">不會存取<xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-229">Do not access the <xref:System.Windows.Forms.DataGridViewRowCollection.List%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="0f6c8-230">這會導致變成非共用的所有資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-230">This causes all rows to become unshared.</span></span>  
  
-   <span data-ttu-id="0f6c8-231">請勿呼叫`Sort(IComparer)`多載<xref:System.Windows.Forms.DataGridView.Sort%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-231">Do not call the `Sort(IComparer)` overload of the <xref:System.Windows.Forms.DataGridView.Sort%2A> method.</span></span> <span data-ttu-id="0f6c8-232">使用自訂比較子進行排序時，會導致變成非共用的所有資料列。</span><span class="sxs-lookup"><span data-stu-id="0f6c8-232">Sorting with a custom comparer causes all rows to become unshared.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0f6c8-233">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0f6c8-233">See also</span></span>
- <xref:System.Windows.Forms.DataGridView>
- [<span data-ttu-id="0f6c8-234">Windows Forms DataGridView 控制項中的效能微調</span><span class="sxs-lookup"><span data-stu-id="0f6c8-234">Performance Tuning in the Windows Forms DataGridView Control</span></span>](performance-tuning-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0f6c8-235">Windows Forms DataGridView 控制項中的虛擬模式</span><span class="sxs-lookup"><span data-stu-id="0f6c8-235">Virtual Mode in the Windows Forms DataGridView Control</span></span>](virtual-mode-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0f6c8-236">Windows Forms DataGridView 控制項的資料顯示模式</span><span class="sxs-lookup"><span data-stu-id="0f6c8-236">Data Display Modes in the Windows Forms DataGridView Control</span></span>](data-display-modes-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0f6c8-237">Windows Forms DataGridView 控制項中的儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="0f6c8-237">Cell Styles in the Windows Forms DataGridView Control</span></span>](cell-styles-in-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0f6c8-238">如何：為 Windows Form DataGridView 控制項中的預設儲存格樣式</span><span class="sxs-lookup"><span data-stu-id="0f6c8-238">How to: Set Default Cell Styles for the Windows Forms DataGridView Control</span></span>](how-to-set-default-cell-styles-for-the-windows-forms-datagridview-control.md)
- [<span data-ttu-id="0f6c8-239">Windows Forms DataGridView 控制項中的調整大小選項</span><span class="sxs-lookup"><span data-stu-id="0f6c8-239">Sizing Options in the Windows Forms DataGridView Control</span></span>](sizing-options-in-the-windows-forms-datagridview-control.md)
