---
title: 其他安全性考慮
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Forms, secure calls to Windows API
- security [Windows Forms]
- security [Windows Forms], calling APIs
- Clipboard [Windows Forms], securing access
ms.assetid: 15abda8b-0527-47c7-aedb-77ab595f2bf1
ms.openlocfilehash: c8d51a57194f1dc536bc4b5d0376987dbfd3b2cf
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76739816"
---
# <a name="additional-security-considerations-in-windows-forms"></a><span data-ttu-id="3f168-102">Windows Form 中的其他安全性考量</span><span class="sxs-lookup"><span data-stu-id="3f168-102">Additional Security Considerations in Windows Forms</span></span>
<span data-ttu-id="3f168-103">.NET Framework 安全性設定可能會導致您的應用程式在部分信任環境中的執行方式與您的本機電腦不同。</span><span class="sxs-lookup"><span data-stu-id="3f168-103">.NET Framework security settings might cause your application to run differently in a partial trust environment than on your local computer.</span></span> <span data-ttu-id="3f168-104">.NET Framework 會限制對這類重要本機資源的存取，例如檔案系統、網路和未受管理的 Api，還有其他專案。</span><span class="sxs-lookup"><span data-stu-id="3f168-104">The .NET Framework restricts access to such critical local resources as the file system, network, and unmanaged APIs, among other things.</span></span> <span data-ttu-id="3f168-105">安全性設定會影響呼叫 Microsoft Windows API 或其他無法由安全性系統驗證之 Api 的能力。</span><span class="sxs-lookup"><span data-stu-id="3f168-105">The security settings affect the ability to call the Microsoft Windows API or other APIs that cannot be verified by the security system.</span></span> <span data-ttu-id="3f168-106">安全性也會影響應用程式的其他層面，包括檔案和資料存取及列印。</span><span class="sxs-lookup"><span data-stu-id="3f168-106">Security also affects other aspects of your application, including file and data access, and printing.</span></span> <span data-ttu-id="3f168-107">如需在部分信任環境中存取檔案和資料的詳細資訊，請參閱 [Windows Forms 中更安全的檔案和資料存取](more-secure-file-and-data-access-in-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="3f168-107">For more information about file and data access in a partial trust environment, see [More Secure File and Data Access in Windows Forms](more-secure-file-and-data-access-in-windows-forms.md).</span></span> <span data-ttu-id="3f168-108">如需在部分信任環境中列印的詳細資訊，請參閱 [Windows Forms 中更安全的列印](more-secure-printing-in-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="3f168-108">For more information about printing in a partial trust environment, see [More Secure Printing in Windows Forms](more-secure-printing-in-windows-forms.md).</span></span>  
  
 <span data-ttu-id="3f168-109">下列各節將討論如何使用剪貼簿、執行視窗操作，以及從在部分信任環境中執行的應用程式呼叫 Windows API。</span><span class="sxs-lookup"><span data-stu-id="3f168-109">The following sections discuss how to work with the Clipboard, perform window manipulation, and call the Windows API from applications that are running in a partial trust environment.</span></span>  
  
## <a name="clipboard-access"></a><span data-ttu-id="3f168-110">剪貼簿存取</span><span class="sxs-lookup"><span data-stu-id="3f168-110">Clipboard Access</span></span>  
 <span data-ttu-id="3f168-111"><xref:System.Security.Permissions.UIPermission> 類別可控制剪貼簿的存取，而相關聯的 <xref:System.Security.Permissions.UIPermissionClipboard> 列舉值則表示存取層級。</span><span class="sxs-lookup"><span data-stu-id="3f168-111">The <xref:System.Security.Permissions.UIPermission> class controls access to the Clipboard, and the associated <xref:System.Security.Permissions.UIPermissionClipboard> enumeration value indicates the level of access.</span></span> <span data-ttu-id="3f168-112">下表顯示可能的權限層級。</span><span class="sxs-lookup"><span data-stu-id="3f168-112">The following table shows the possible permission levels.</span></span>  
  
|<span data-ttu-id="3f168-113">UIPermissionClipboard 值</span><span class="sxs-lookup"><span data-stu-id="3f168-113">UIPermissionClipboard value</span></span>|<span data-ttu-id="3f168-114">描述</span><span class="sxs-lookup"><span data-stu-id="3f168-114">Description</span></span>|  
|---------------------------------|-----------------|  
|<xref:System.Security.Permissions.UIPermissionClipboard.AllClipboard>|<span data-ttu-id="3f168-115">可以不受限制使用剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="3f168-115">The Clipboard can be used without restriction.</span></span>|  
|<xref:System.Security.Permissions.UIPermissionClipboard.OwnClipboard>|<span data-ttu-id="3f168-116">可以在受到部分限制下使用剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="3f168-116">The Clipboard can be used with some restrictions.</span></span> <span data-ttu-id="3f168-117">能夠不受限制將資料放在剪貼簿 (複製或剪下命令作業)。</span><span class="sxs-lookup"><span data-stu-id="3f168-117">The ability to put data on the Clipboard (Copy or Cut command operations) is unrestricted.</span></span> <span data-ttu-id="3f168-118">接受貼上的內建控制項 (例如文字方塊) 可以接受剪貼簿資料，但無法以程式設計方式從剪貼簿讀取使用者控制項。</span><span class="sxs-lookup"><span data-stu-id="3f168-118">Intrinsic controls that accept paste, such as a text box, can accept Clipboard data, but user controls cannot programmatically read from the Clipboard.</span></span>|  
|<xref:System.Security.Permissions.UIPermissionClipboard.NoClipboard>|<span data-ttu-id="3f168-119">無法使用剪貼簿。</span><span class="sxs-lookup"><span data-stu-id="3f168-119">The Clipboard cannot be used.</span></span>|  
  
 <span data-ttu-id="3f168-120">根據預設，近端內部網路區域會收到 <xref:System.Security.Permissions.UIPermissionClipboard.AllClipboard> 存取權，而網際網路區域會收到 <xref:System.Security.Permissions.UIPermissionClipboard.OwnClipboard> 存取權。</span><span class="sxs-lookup"><span data-stu-id="3f168-120">By default, the Local Intranet zone receives <xref:System.Security.Permissions.UIPermissionClipboard.AllClipboard> access and the Internet zone receives <xref:System.Security.Permissions.UIPermissionClipboard.OwnClipboard> access.</span></span> <span data-ttu-id="3f168-121">這表示應用程式可以將資料複製到剪貼簿，但應用程式無法以程式設計方式在剪貼簿中貼上或讀取。</span><span class="sxs-lookup"><span data-stu-id="3f168-121">This means that the application can copy data to the Clipboard, but the application cannot programmatically paste to or read from the Clipboard.</span></span> <span data-ttu-id="3f168-122">這些限制會防止未受完全信任的程式讀取另一個應用程式複製到剪貼簿的內容。</span><span class="sxs-lookup"><span data-stu-id="3f168-122">These restrictions prevent programs without full trust from reading content copied to the Clipboard by another application.</span></span> <span data-ttu-id="3f168-123">如果您的應用程式需要完整的剪貼簿存取，但您沒有權限，您必須提高應用程式的權限。</span><span class="sxs-lookup"><span data-stu-id="3f168-123">If your application requires full Clipboard access but you do not have the permissions, you will have to elevate the permissions for your application.</span></span> <span data-ttu-id="3f168-124">如需提高權限的詳細資訊，請參閱[一般安全性原則管理](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ed5htz45(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="3f168-124">For more information about elevating permissions, see [General Security Policy Administration](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ed5htz45(v=vs.100)).</span></span>  
  
## <a name="window-manipulation"></a><span data-ttu-id="3f168-125">視窗操作</span><span class="sxs-lookup"><span data-stu-id="3f168-125">Window Manipulation</span></span>  
 <span data-ttu-id="3f168-126"><xref:System.Security.Permissions.UIPermission> 類別也會控制執行視窗操作和其他 UI 相關動作的許可權，而相關聯的 <xref:System.Security.Permissions.UIPermissionWindow> 列舉值則表示存取層級。</span><span class="sxs-lookup"><span data-stu-id="3f168-126">The <xref:System.Security.Permissions.UIPermission> class also controls permission to perform window manipulation and other UI-related actions, and the associated <xref:System.Security.Permissions.UIPermissionWindow> enumeration value indicates the level of access.</span></span> <span data-ttu-id="3f168-127">下表顯示可能的權限層級。</span><span class="sxs-lookup"><span data-stu-id="3f168-127">The following table shows the possible permission levels.</span></span>  
  
 <span data-ttu-id="3f168-128">根據預設，近端內部網路區域會收到 <xref:System.Security.Permissions.UIPermissionWindow.AllWindows> 存取權，而網際網路區域會收到 <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> 存取權。</span><span class="sxs-lookup"><span data-stu-id="3f168-128">By default, the Local Intranet zone receives <xref:System.Security.Permissions.UIPermissionWindow.AllWindows> access and the Internet zone receives <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> access.</span></span> <span data-ttu-id="3f168-129">這表示在網際網路區域中，應用程式可以執行大部分的視窗和 UI 動作，但視窗的外觀會經過修改。</span><span class="sxs-lookup"><span data-stu-id="3f168-129">This means that in the Internet zone, the application can perform most windowing and UI actions, but the window's appearance will be modified.</span></span> <span data-ttu-id="3f168-130">修改過的視窗會在第一次執行時顯示氣球通知、包含修改過的標題列文字，而且在標題列上需要有關閉按鈕。</span><span class="sxs-lookup"><span data-stu-id="3f168-130">The modified window displays a balloon notification when first run, contains modified title bar text, and requires a close button on the title bar.</span></span> <span data-ttu-id="3f168-131">氣球通知和標題列讓應用程式的使用者知道，應用程式正在部分信任下執行。</span><span class="sxs-lookup"><span data-stu-id="3f168-131">The balloon notification and the title bar identify to the user of the application that the application is running under partial trust.</span></span>  
  
|<span data-ttu-id="3f168-132">UIPermissionWindow 值</span><span class="sxs-lookup"><span data-stu-id="3f168-132">UIPermissionWindow value</span></span>|<span data-ttu-id="3f168-133">描述</span><span class="sxs-lookup"><span data-stu-id="3f168-133">Description</span></span>|  
|------------------------------|-----------------|  
|<xref:System.Security.Permissions.UIPermissionWindow.AllWindows>|<span data-ttu-id="3f168-134">使用者可以無限制使用所有視窗和使用者輸入事件。</span><span class="sxs-lookup"><span data-stu-id="3f168-134">Users can use all windows and user input events without restriction.</span></span>|  
|<xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows>|<span data-ttu-id="3f168-135">使用者只能使用較安全的最上層視窗和較安全的子視窗來繪圖，且只能使用這些最上層視窗和子視窗內之使用者介面的使用者輸入事件。</span><span class="sxs-lookup"><span data-stu-id="3f168-135">Users can use only safer top-level windows and safer subwindows for drawing, and can use only user input events for the user interface within those top-level windows and subwindows.</span></span> <span data-ttu-id="3f168-136">這些較安全的視窗有清楚的標籤，也有大小上限和下限的限制。</span><span class="sxs-lookup"><span data-stu-id="3f168-136">These safer windows are clearly labeled and have minimum and maximum size restrictions.</span></span> <span data-ttu-id="3f168-137">這些限制可防止可能有害的詐騙攻擊，例如模仿系統登入畫面或系統桌面，並限制以程式設計方式存取父視窗、與焦點相關的 Api，以及使用 <xref:System.Windows.Forms.ToolTip> 控制項。</span><span class="sxs-lookup"><span data-stu-id="3f168-137">The restrictions prevent potentially harmful spoofing attacks, such as imitating system logon screens or the system desktop, and restricts programmatic access to parent windows, focus-related APIs, and use of the <xref:System.Windows.Forms.ToolTip> control,</span></span>|  
|<xref:System.Security.Permissions.UIPermissionWindow.SafeSubWindows>|<span data-ttu-id="3f168-138">使用者只能使用較安全的子視窗來繪圖，且只能使用該子視窗內之使用者介面的使用者輸入事件。</span><span class="sxs-lookup"><span data-stu-id="3f168-138">Users can use only safer subwindows for drawing, and can use only user input events for the user interface within that subwindow.</span></span> <span data-ttu-id="3f168-139">瀏覽器內顯示的控制項即為較安全子視窗的一個例子。</span><span class="sxs-lookup"><span data-stu-id="3f168-139">A control displayed within a browser is an example of a safer subwindow.</span></span>|  
|<xref:System.Security.Permissions.UIPermissionWindow.NoWindows>|<span data-ttu-id="3f168-140">使用者無法使用任何視窗或使用者介面事件。</span><span class="sxs-lookup"><span data-stu-id="3f168-140">Users cannot use any windows or user interface events.</span></span> <span data-ttu-id="3f168-141">無法使用任何使用者介面。</span><span class="sxs-lookup"><span data-stu-id="3f168-141">No user interface can be used.</span></span>|  
  
 <span data-ttu-id="3f168-142"><xref:System.Security.Permissions.UIPermissionWindow> 列舉所識別的每個許可權層級所允許的動作，比高於其上的層級更少。</span><span class="sxs-lookup"><span data-stu-id="3f168-142">Each permission level identified by the <xref:System.Security.Permissions.UIPermissionWindow> enumeration allows fewer actions than the level above it.</span></span> <span data-ttu-id="3f168-143">下表指出 <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> 和 <xref:System.Security.Permissions.UIPermissionWindow.SafeSubWindows> 值所限制的動作。</span><span class="sxs-lookup"><span data-stu-id="3f168-143">The following tables indicate the actions that are restricted by the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> and <xref:System.Security.Permissions.UIPermissionWindow.SafeSubWindows> values.</span></span> <span data-ttu-id="3f168-144">如果每個成員所需的確切權限，請參閱 .NET Framework Class Library 文件中該成員的參考。</span><span class="sxs-lookup"><span data-stu-id="3f168-144">For exact permissions that are required for each member, see the reference for that member in the .NET Framework class library documentation.</span></span>  
  
 <span data-ttu-id="3f168-145"><xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> 許可權會限制下表所列的動作。</span><span class="sxs-lookup"><span data-stu-id="3f168-145"><xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> permission restricts the actions listed in the following table.</span></span>  
  
|<span data-ttu-id="3f168-146">元件</span><span class="sxs-lookup"><span data-stu-id="3f168-146">Component</span></span>|<span data-ttu-id="3f168-147">受限制的動作</span><span class="sxs-lookup"><span data-stu-id="3f168-147">Restricted actions</span></span>|  
|---------------|------------------------|  
|<xref:System.Windows.Forms.Application>|<span data-ttu-id="3f168-148">-   設定 <xref:System.Windows.Forms.Application.SafeTopLevelCaptionFormat%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-148">-   Setting the <xref:System.Windows.Forms.Application.SafeTopLevelCaptionFormat%2A> property.</span></span>|  
|<xref:System.Windows.Forms.Control>|<span data-ttu-id="3f168-149">-取得 <xref:System.Windows.Forms.Control.Parent%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-149">-   Getting the <xref:System.Windows.Forms.Control.Parent%2A> property.</span></span><br /><span data-ttu-id="3f168-150">-   設定 `Region` 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-150">-   Setting the `Region` property.</span></span><br /><span data-ttu-id="3f168-151">-呼叫 <xref:System.Windows.Forms.Control.FindForm%2A>、<xref:System.Windows.Forms.Control.Focus%2A>、<xref:System.Windows.Forms.Control.FromChildHandle%2A> 和 <xref:System.Windows.Forms.Control.FromHandle%2A>、<xref:System.Windows.Forms.Control.PreProcessMessage%2A>、<xref:System.Windows.Forms.Control.ReflectMessage%2A>或 <xref:System.Windows.Forms.Control.SetTopLevel%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-151">-   Calling the <xref:System.Windows.Forms.Control.FindForm%2A> , <xref:System.Windows.Forms.Control.Focus%2A>, <xref:System.Windows.Forms.Control.FromChildHandle%2A> and <xref:System.Windows.Forms.Control.FromHandle%2A>, <xref:System.Windows.Forms.Control.PreProcessMessage%2A>, <xref:System.Windows.Forms.Control.ReflectMessage%2A>, or <xref:System.Windows.Forms.Control.SetTopLevel%2A> method.</span></span><br /><span data-ttu-id="3f168-152">-如果傳回的控制項不是呼叫控制項的子系，則呼叫 <xref:System.Windows.Forms.Control.GetChildAtPoint%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-152">-   Calling the <xref:System.Windows.Forms.Control.GetChildAtPoint%2A> method if the control returned is not a child of the calling control.</span></span><br /><span data-ttu-id="3f168-153">-   修改容器控制項內的控制項焦點。</span><span class="sxs-lookup"><span data-stu-id="3f168-153">-   Modify control focus inside a container control.</span></span>|  
|<xref:System.Windows.Forms.Cursor>|<span data-ttu-id="3f168-154">-   設定 <xref:System.Windows.Forms.Cursor.Clip%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-154">-   Setting the <xref:System.Windows.Forms.Cursor.Clip%2A> property.</span></span><br /><span data-ttu-id="3f168-155">-呼叫 <xref:System.Windows.Forms.Control.Hide%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-155">-   Calling the <xref:System.Windows.Forms.Control.Hide%2A> method.</span></span>|  
|<xref:System.Windows.Forms.DataGrid>|<span data-ttu-id="3f168-156">-呼叫 <xref:System.Windows.Forms.ContainerControl.ProcessTabKey%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-156">-   Calling the <xref:System.Windows.Forms.ContainerControl.ProcessTabKey%2A> method.</span></span>|  
|<xref:System.Windows.Forms.Form>|<span data-ttu-id="3f168-157">-取得 <xref:System.Windows.Forms.Form.ActiveForm%2A> 或 <xref:System.Windows.Forms.Form.MdiParent%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-157">-   Getting the <xref:System.Windows.Forms.Form.ActiveForm%2A> or <xref:System.Windows.Forms.Form.MdiParent%2A> property.</span></span><br /><span data-ttu-id="3f168-158">-設定 <xref:System.Windows.Forms.Form.ControlBox%2A>、<xref:System.Windows.Forms.Form.ShowInTaskbar%2A>或 <xref:System.Windows.Forms.Form.TopMost%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-158">-   Setting the <xref:System.Windows.Forms.Form.ControlBox%2A>, <xref:System.Windows.Forms.Form.ShowInTaskbar%2A>, or <xref:System.Windows.Forms.Form.TopMost%2A> property.</span></span><br /><span data-ttu-id="3f168-159">-將 <xref:System.Windows.Forms.Form.Opacity%2A> 屬性設定為低於50%。</span><span class="sxs-lookup"><span data-stu-id="3f168-159">-   Setting the <xref:System.Windows.Forms.Form.Opacity%2A> property below 50%.</span></span><br /><span data-ttu-id="3f168-160">-將 <xref:System.Windows.Forms.Form.WindowState%2A> 屬性設定為以程式設計方式 <xref:System.Windows.Forms.FormWindowState.Minimized>。</span><span class="sxs-lookup"><span data-stu-id="3f168-160">-   Setting the <xref:System.Windows.Forms.Form.WindowState%2A> property to <xref:System.Windows.Forms.FormWindowState.Minimized> programmatically.</span></span><br /><span data-ttu-id="3f168-161">-呼叫 <xref:System.Windows.Forms.Form.Activate%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-161">-   Calling the <xref:System.Windows.Forms.Form.Activate%2A> method.</span></span><br /><span data-ttu-id="3f168-162">-使用 <xref:System.Windows.Forms.FormBorderStyle.None>、<xref:System.Windows.Forms.FormBorderStyle.FixedToolWindow>和 <xref:System.Windows.Forms.FormBorderStyle.SizableToolWindow><xref:System.Windows.Forms.FormBorderStyle> 列舉值。</span><span class="sxs-lookup"><span data-stu-id="3f168-162">-   Using the <xref:System.Windows.Forms.FormBorderStyle.None>, <xref:System.Windows.Forms.FormBorderStyle.FixedToolWindow>, and <xref:System.Windows.Forms.FormBorderStyle.SizableToolWindow><xref:System.Windows.Forms.FormBorderStyle> enumeration values.</span></span>|  
|<xref:System.Windows.Forms.NotifyIcon>|<span data-ttu-id="3f168-163">-使用 <xref:System.Windows.Forms.NotifyIcon> 元件完全受到限制。</span><span class="sxs-lookup"><span data-stu-id="3f168-163">-   Using the <xref:System.Windows.Forms.NotifyIcon> component is completely restricted.</span></span>|  
  
 <span data-ttu-id="3f168-164"><xref:System.Security.Permissions.UIPermissionWindow.SafeSubWindows> 值會限制下表所列的動作，以及 <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> 值所設定的限制。</span><span class="sxs-lookup"><span data-stu-id="3f168-164">The <xref:System.Security.Permissions.UIPermissionWindow.SafeSubWindows> value restricts the actions listed in the following table, in addition to the restrictions placed by the <xref:System.Security.Permissions.UIPermissionWindow.SafeTopLevelWindows> value.</span></span>  
  
|<span data-ttu-id="3f168-165">元件</span><span class="sxs-lookup"><span data-stu-id="3f168-165">Component</span></span>|<span data-ttu-id="3f168-166">受限制的動作</span><span class="sxs-lookup"><span data-stu-id="3f168-166">Restricted actions</span></span>|  
|---------------|------------------------|  
|<xref:System.Windows.Forms.CommonDialog>|<span data-ttu-id="3f168-167">-顯示衍生自 <xref:System.Windows.Forms.CommonDialog> 類別的對話方塊。</span><span class="sxs-lookup"><span data-stu-id="3f168-167">-   Showing a dialog box derived from the <xref:System.Windows.Forms.CommonDialog> class.</span></span>|  
|<xref:System.Windows.Forms.Control>|<span data-ttu-id="3f168-168">-呼叫 <xref:System.Windows.Forms.Control.CreateGraphics%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-168">-   Calling the <xref:System.Windows.Forms.Control.CreateGraphics%2A> method.</span></span><br /><span data-ttu-id="3f168-169">-   設定 <xref:System.Windows.Forms.Control.Cursor%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-169">-   Setting the <xref:System.Windows.Forms.Control.Cursor%2A> property.</span></span>|  
|<xref:System.Windows.Forms.Control.Cursor%2A>|<span data-ttu-id="3f168-170">-   設定 <xref:System.Windows.Forms.Cursor.Current%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="3f168-170">-   Setting the <xref:System.Windows.Forms.Cursor.Current%2A> property.</span></span>|  
|<xref:System.Windows.Forms.MessageBox>|<span data-ttu-id="3f168-171">-呼叫 <xref:System.Windows.Forms.Form.Show%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="3f168-171">-   Calling the <xref:System.Windows.Forms.Form.Show%2A> method.</span></span>|  
  
### <a name="hosting-third-party-controls"></a><span data-ttu-id="3f168-172">裝載協力廠商控制項</span><span class="sxs-lookup"><span data-stu-id="3f168-172">Hosting Third-Party Controls</span></span>  
 <span data-ttu-id="3f168-173">如果您的表單裝載協力廠商控制項，可能會有另一種視窗操作。</span><span class="sxs-lookup"><span data-stu-id="3f168-173">Another kind of window manipulation can occur if your forms host third-party controls.</span></span> <span data-ttu-id="3f168-174">協力廠商控制項是您未自行開發和編譯的任何自訂 <xref:System.Windows.Forms.UserControl>。</span><span class="sxs-lookup"><span data-stu-id="3f168-174">A third-party control is any custom <xref:System.Windows.Forms.UserControl> that you have not developed and compiled yourself.</span></span> <span data-ttu-id="3f168-175">雖然很難入侵裝載情節，但在理論上，協力廠商控制項有可能展開其呈現表面來涵蓋表單的整個區域。</span><span class="sxs-lookup"><span data-stu-id="3f168-175">Although the hosting scenario is hard to exploit, it is theoretically possible for a third-party control to expand its rendering surface to cover the entire area of your form.</span></span> <span data-ttu-id="3f168-176">接著，此控制項可模擬重要的對話方塊，然後向您的使用者要求資訊，例如使用者名稱/密碼組合或銀行帳戶號碼。</span><span class="sxs-lookup"><span data-stu-id="3f168-176">This control could then mimic a critical dialog box, and request information such as username/password combinations or bank account numbers from your users.</span></span>  
  
 <span data-ttu-id="3f168-177">為了限制這種潛在風險，請只使用您信任的廠商的協力廠商控制項。</span><span class="sxs-lookup"><span data-stu-id="3f168-177">To limit this potential risk, use third-party controls only from vendors you can trust.</span></span> <span data-ttu-id="3f168-178">如果您使用的協力廠商控制項是從未驗證的來源下載，建議您檢閱原始程式碼中潛在的弱點。</span><span class="sxs-lookup"><span data-stu-id="3f168-178">If you use third-party controls you have downloaded from an unverifiable source, we recommend that you review the source code for potential exploits.</span></span> <span data-ttu-id="3f168-179">在確認來源沒有惡意之後，您應該自行編譯組件，以確保來源符合組件。</span><span class="sxs-lookup"><span data-stu-id="3f168-179">After you've verified that the source is non-malicious, you should compile the assembly yourself to ensure that the source matches the assembly.</span></span>  
  
## <a name="windows-api-calls"></a><span data-ttu-id="3f168-180">Windows API 呼叫</span><span class="sxs-lookup"><span data-stu-id="3f168-180">Windows API Calls</span></span>  
 <span data-ttu-id="3f168-181">如果您的應用程式設計需要從 Windows API 呼叫函式，您會存取非受控碼。</span><span class="sxs-lookup"><span data-stu-id="3f168-181">If your application design requires calling a function from the Windows API, you are accessing unmanaged code.</span></span> <span data-ttu-id="3f168-182">在此情況下，當您使用 Windows API 呼叫或值時，無法判斷程式碼對視窗或作業系統的動作。</span><span class="sxs-lookup"><span data-stu-id="3f168-182">In this case the code's actions to the window or operating system cannot be determined when you are working with Windows API calls or values.</span></span> <span data-ttu-id="3f168-183"><xref:System.Security.Permissions.SecurityPermission> 類別和 <xref:System.Security.Permissions.SecurityPermissionFlag> 列舉的 <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> 值控制對非受控程式碼的存取。</span><span class="sxs-lookup"><span data-stu-id="3f168-183">The <xref:System.Security.Permissions.SecurityPermission> class and the <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> value of the <xref:System.Security.Permissions.SecurityPermissionFlag> enumeration control access to unmanaged code.</span></span> <span data-ttu-id="3f168-184">只有當應用程式被授與 <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> 許可權時，才可以存取非受控碼。</span><span class="sxs-lookup"><span data-stu-id="3f168-184">An application can access unmanaged code only when it is granted the <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission.</span></span> <span data-ttu-id="3f168-185">根據預設，只有在本機執行的應用程式才能呼叫 Unmanaged 程式碼。</span><span class="sxs-lookup"><span data-stu-id="3f168-185">By default, only applications that are running locally can call unmanaged code.</span></span>  
  
 <span data-ttu-id="3f168-186">某些 Windows Forms 成員會提供需要 <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> 許可權的非受控存取權。</span><span class="sxs-lookup"><span data-stu-id="3f168-186">Some Windows Forms members provide unmanaged access that requires the <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission.</span></span> <span data-ttu-id="3f168-187">下表列出 <xref:System.Windows.Forms> 命名空間中需要許可權的成員。</span><span class="sxs-lookup"><span data-stu-id="3f168-187">The following table lists the members in the <xref:System.Windows.Forms> namespace that require the permission.</span></span> <span data-ttu-id="3f168-188">如需成員所需權限的詳細資訊，請參閱 .NET Framework Class Library 文件。</span><span class="sxs-lookup"><span data-stu-id="3f168-188">For more information about the permissions that are required for a member, see the .NET Framework class library documentation.</span></span>  
  
|<span data-ttu-id="3f168-189">元件</span><span class="sxs-lookup"><span data-stu-id="3f168-189">Component</span></span>|<span data-ttu-id="3f168-190">成員</span><span class="sxs-lookup"><span data-stu-id="3f168-190">Member</span></span>|  
|---------------|------------|  
|<xref:System.Windows.Forms.Application>|<span data-ttu-id="3f168-191">-   <xref:System.Windows.Forms.Application.AddMessageFilter%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-191">-   <xref:System.Windows.Forms.Application.AddMessageFilter%2A> method</span></span><br /><span data-ttu-id="3f168-192">-   <xref:System.Windows.Forms.Application.CurrentInputLanguage%2A> 屬性</span><span class="sxs-lookup"><span data-stu-id="3f168-192">-   <xref:System.Windows.Forms.Application.CurrentInputLanguage%2A> property</span></span><br /><span data-ttu-id="3f168-193">-   `Exit` 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-193">-   `Exit` method</span></span><br /><span data-ttu-id="3f168-194">-   <xref:System.Windows.Forms.Application.ExitThread%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-194">-   <xref:System.Windows.Forms.Application.ExitThread%2A> method</span></span><br /><span data-ttu-id="3f168-195">-   <xref:System.Windows.Forms.Application.ThreadException> 事件</span><span class="sxs-lookup"><span data-stu-id="3f168-195">-   <xref:System.Windows.Forms.Application.ThreadException> event</span></span>|  
|<xref:System.Windows.Forms.CommonDialog>|<span data-ttu-id="3f168-196">-   <xref:System.Windows.Forms.CommonDialog.HookProc%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-196">-   <xref:System.Windows.Forms.CommonDialog.HookProc%2A> method</span></span><br /><span data-ttu-id="3f168-197">-   <xref:System.Windows.Forms.CommonDialog.OwnerWndProc%2A>\ 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-197">-   <xref:System.Windows.Forms.CommonDialog.OwnerWndProc%2A>\ method</span></span><br /><span data-ttu-id="3f168-198">-   <xref:System.Windows.Forms.CommonDialog.Reset%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-198">-   <xref:System.Windows.Forms.CommonDialog.Reset%2A> method</span></span><br /><span data-ttu-id="3f168-199">-   <xref:System.Windows.Forms.CommonDialog.RunDialog%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-199">-   <xref:System.Windows.Forms.CommonDialog.RunDialog%2A> method</span></span>|  
|<xref:System.Windows.Forms.Control>|<span data-ttu-id="3f168-200">-   <xref:System.Windows.Forms.Control.CreateParams%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-200">-   <xref:System.Windows.Forms.Control.CreateParams%2A> method</span></span><br /><span data-ttu-id="3f168-201">-   <xref:System.Windows.Forms.Control.DefWndProc%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-201">-   <xref:System.Windows.Forms.Control.DefWndProc%2A> method</span></span><br /><span data-ttu-id="3f168-202">-   <xref:System.Windows.Forms.Control.DestroyHandle%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-202">-   <xref:System.Windows.Forms.Control.DestroyHandle%2A> method</span></span><br /><span data-ttu-id="3f168-203">-   <xref:System.Windows.Forms.Control.WndProc%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-203">-   <xref:System.Windows.Forms.Control.WndProc%2A> method</span></span>|  
|<xref:System.Windows.Forms.Help>|<span data-ttu-id="3f168-204">-   <xref:System.Windows.Forms.Help.ShowHelp%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-204">-   <xref:System.Windows.Forms.Help.ShowHelp%2A> methods</span></span><br /><span data-ttu-id="3f168-205">-   <xref:System.Windows.Forms.Help.ShowHelpIndex%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-205">-   <xref:System.Windows.Forms.Help.ShowHelpIndex%2A> method</span></span>|  
|<xref:System.Windows.Forms.NativeWindow>|<span data-ttu-id="3f168-206">-   <xref:System.Windows.Forms.NativeWindow> 類別</span><span class="sxs-lookup"><span data-stu-id="3f168-206">-   <xref:System.Windows.Forms.NativeWindow> class</span></span>|  
|<xref:System.Windows.Forms.Screen>|<span data-ttu-id="3f168-207">-   <xref:System.Windows.Forms.Screen.FromHandle%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-207">-   <xref:System.Windows.Forms.Screen.FromHandle%2A> method</span></span>|  
|<xref:System.Windows.Forms.SendKeys>|<span data-ttu-id="3f168-208">-   <xref:System.Windows.Forms.SendKeys.Send%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-208">-   <xref:System.Windows.Forms.SendKeys.Send%2A> method</span></span><br /><span data-ttu-id="3f168-209">-   <xref:System.Windows.Forms.SendKeys.SendWait%2A> 方法</span><span class="sxs-lookup"><span data-stu-id="3f168-209">-   <xref:System.Windows.Forms.SendKeys.SendWait%2A> method</span></span>|  
  
 <span data-ttu-id="3f168-210">如果您的應用程式沒有呼叫非受控碼的許可權，您的應用程式必須要求 <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> 許可權，或者您必須考慮採用其他方式來執行功能;在許多情況下，Windows Forms 提供 Windows API 函式的受控替代方式。</span><span class="sxs-lookup"><span data-stu-id="3f168-210">If your application does not have permission to call unmanaged code, your application must request <xref:System.Security.Permissions.SecurityPermissionFlag.UnmanagedCode> permission, or you must consider alternative ways of implementing features; in many cases, Windows Forms provides a managed alternative to Windows API functions.</span></span> <span data-ttu-id="3f168-211">如果沒有替代做法，但應用程式必須存取 Unmanaged 程式碼，您必須提高應用程式的權限。</span><span class="sxs-lookup"><span data-stu-id="3f168-211">If no alternative means exist and the application must access unmanaged code, you will have to elevate the permissions for the application.</span></span>  
  
 <span data-ttu-id="3f168-212">呼叫 Unmanaged 程式碼的權限可讓應用程式執行大部分的動作。</span><span class="sxs-lookup"><span data-stu-id="3f168-212">Permission to call unmanaged code allows an application to perform most anything.</span></span> <span data-ttu-id="3f168-213">因此，呼叫 Unmanaged 程式碼的權限應該只授與來自受信任來源的應用程式。</span><span class="sxs-lookup"><span data-stu-id="3f168-213">Therefore, permission to call unmanaged code should only be granted for applications that come from a trusted source.</span></span> <span data-ttu-id="3f168-214">另外，視應用程式而定，應用程式功能中會呼叫 Unmanaged 程式碼的部分可以是選擇性，或只在完全信任環境中啟用。</span><span class="sxs-lookup"><span data-stu-id="3f168-214">Alternatively, depending on the application, the piece of application functionality that makes the call to unmanaged code could be optional, or enabled in the full trust environment only.</span></span> <span data-ttu-id="3f168-215">如需危險性權限的詳細資訊，請參閱[危險性權限和原則管理](../misc/dangerous-permissions-and-policy-administration.md)。</span><span class="sxs-lookup"><span data-stu-id="3f168-215">For more information about dangerous permissions, see [Dangerous Permissions and Policy Administration](../misc/dangerous-permissions-and-policy-administration.md).</span></span> <span data-ttu-id="3f168-216">如需提高權限的詳細資訊，請參閱[一般安全性原則管理](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ed5htz45(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="3f168-216">For more information about elevating permissions, see [General Security Policy Administration](https://docs.microsoft.com/previous-versions/dotnet/netframework-4.0/ed5htz45(v=vs.100)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f168-217">請參閱</span><span class="sxs-lookup"><span data-stu-id="3f168-217">See also</span></span>

- [<span data-ttu-id="3f168-218">Windows Forms 中更安全的檔案和資料存取</span><span class="sxs-lookup"><span data-stu-id="3f168-218">More Secure File and Data Access in Windows Forms</span></span>](more-secure-file-and-data-access-in-windows-forms.md)
- [<span data-ttu-id="3f168-219">Windows Forms 中更安全的列印</span><span class="sxs-lookup"><span data-stu-id="3f168-219">More Secure Printing in Windows Forms</span></span>](more-secure-printing-in-windows-forms.md)
- [<span data-ttu-id="3f168-220">Windows Forms 中的安全性概觀</span><span class="sxs-lookup"><span data-stu-id="3f168-220">Security in Windows Forms Overview</span></span>](security-in-windows-forms-overview.md)
- [<span data-ttu-id="3f168-221">Windows Forms 安全性</span><span class="sxs-lookup"><span data-stu-id="3f168-221">Windows Forms Security</span></span>](windows-forms-security.md)
- [<span data-ttu-id="3f168-222">保護 ClickOnce 應用程式</span><span class="sxs-lookup"><span data-stu-id="3f168-222">Securing ClickOnce Applications</span></span>](/visualstudio/deployment/securing-clickonce-applications)
