---
title: 事件概觀 (Windows Form)
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Forms, event handling
- events [Windows Forms], about events
- delegates [Windows Forms], multicast
- delegates [Windows Forms], events and
- multicast event delegates
- Windows Forms controls, events
ms.assetid: 814a6a43-a312-4791-88d8-f75f9a4f8c4c
ms.openlocfilehash: 57802cad0a75ed21bba02a11fec39f821835c5ea
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/18/2019
ms.locfileid: "59157744"
---
# <a name="events-overview-windows-forms"></a><span data-ttu-id="26d6f-102">事件概觀 (Windows Form)</span><span class="sxs-lookup"><span data-stu-id="26d6f-102">Events Overview (Windows Forms)</span></span>
<span data-ttu-id="26d6f-103">事件是您可以透過程式碼加以回應或「處理」的動作。</span><span class="sxs-lookup"><span data-stu-id="26d6f-103">An event is an action which you can respond to, or "handle," in code.</span></span> <span data-ttu-id="26d6f-104">使用者動作 (例如按一下滑鼠按鈕或按下按鍵)、程式碼或系統都可以產生事件。</span><span class="sxs-lookup"><span data-stu-id="26d6f-104">Events can be generated by a user action, such as clicking the mouse or pressing a key; by program code; or by the system.</span></span>  
  
 <span data-ttu-id="26d6f-105">事件導向的應用程式會以執行程式碼的方式回應事件。</span><span class="sxs-lookup"><span data-stu-id="26d6f-105">Event-driven applications execute code in response to an event.</span></span> <span data-ttu-id="26d6f-106">每份表單與控制項都會提供一組預先定義的事件讓您進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="26d6f-106">Each form and control exposes a predefined set of events that you can program against.</span></span> <span data-ttu-id="26d6f-107">當這些事件中的任何事件發生時，而相關聯的事件處理常式中含有程式碼，即會叫用該程式碼。</span><span class="sxs-lookup"><span data-stu-id="26d6f-107">If one of these events occurs and there is code in the associated event handler, that code is invoked.</span></span>  
  
 <span data-ttu-id="26d6f-108">物件所引發的事件類型各有不同，但有許多類型為大多數控制項所共通。</span><span class="sxs-lookup"><span data-stu-id="26d6f-108">The types of events raised by an object vary, but many types are common to most controls.</span></span> <span data-ttu-id="26d6f-109">例如，大部分物件都會處理 <xref:System.Windows.Forms.Control.Click> 事件。</span><span class="sxs-lookup"><span data-stu-id="26d6f-109">For example, most objects will handle a <xref:System.Windows.Forms.Control.Click> event.</span></span> <span data-ttu-id="26d6f-110">若使用者按一下表單，便會執行表單之 <xref:System.Windows.Forms.Control.Click> 事件處理常式中的程式碼。</span><span class="sxs-lookup"><span data-stu-id="26d6f-110">If a user clicks a form, code in the form's <xref:System.Windows.Forms.Control.Click> event handler is executed.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="26d6f-111">許多事件會與其他事件連帶發生。</span><span class="sxs-lookup"><span data-stu-id="26d6f-111">Many events occur in conjunction with other events.</span></span> <span data-ttu-id="26d6f-112">例如在發生 <xref:System.Windows.Forms.Control.DoubleClick> 的過程中，<xref:System.Windows.Forms.Control.MouseDown>、<xref:System.Windows.Forms.Control.MouseUp> 及 <xref:System.Windows.Forms.Control.Click> 事件會連帶發生。</span><span class="sxs-lookup"><span data-stu-id="26d6f-112">For example, in the course of the <xref:System.Windows.Forms.Control.DoubleClick> event occurring, the <xref:System.Windows.Forms.Control.MouseDown>, <xref:System.Windows.Forms.Control.MouseUp>, and <xref:System.Windows.Forms.Control.Click> events occur.</span></span>  
  
 <span data-ttu-id="26d6f-113">如需如何引發和使用事件的資訊，請參閱[事件](../../standard/events/index.md)。</span><span class="sxs-lookup"><span data-stu-id="26d6f-113">For information about how to raise and consume an event, see [Events](../../standard/events/index.md).</span></span>  
  
## <a name="delegates-and-their-role"></a><span data-ttu-id="26d6f-114">委派及其角色</span><span class="sxs-lookup"><span data-stu-id="26d6f-114">Delegates and Their Role</span></span>  
 <span data-ttu-id="26d6f-115">委派是 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 中常用來建置事件處理機制的類別。</span><span class="sxs-lookup"><span data-stu-id="26d6f-115">Delegates are classes commonly used within the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] to build event-handling mechanisms.</span></span> <span data-ttu-id="26d6f-116">委派與函式指標大致相同，通常會在 [!INCLUDE[vcprvc](../../../includes/vcprvc-md.md)] 及其他物件導向語言中使用。</span><span class="sxs-lookup"><span data-stu-id="26d6f-116">Delegates roughly equate to function pointers, commonly used in [!INCLUDE[vcprvc](../../../includes/vcprvc-md.md)] and other object-oriented languages.</span></span> <span data-ttu-id="26d6f-117">不同之處在於委派為物件導向、類型安全，安全性也較好。</span><span class="sxs-lookup"><span data-stu-id="26d6f-117">Unlike function pointers however, delegates are object-oriented, type-safe, and secure.</span></span> <span data-ttu-id="26d6f-118">除此之外，函式指標只包含特定函式的參考，而委派不僅包含了物件參考，還包含了物件中一或多個方法的參考。</span><span class="sxs-lookup"><span data-stu-id="26d6f-118">In addition, where a function pointer contains only a reference to a particular function, a delegate consists of a reference to an object, and references to one or more methods within the object.</span></span>  
  
 <span data-ttu-id="26d6f-119">這種事件模型會使用*委派*來將事件繫結的方法，用來處理它們。</span><span class="sxs-lookup"><span data-stu-id="26d6f-119">This event model uses *delegates* to bind events to the methods that are used to handle them.</span></span> <span data-ttu-id="26d6f-120">委派允許透過指定處理常式方法的方式，為事件通知登錄其他類別。</span><span class="sxs-lookup"><span data-stu-id="26d6f-120">The delegate enables other classes to register for event notification by specifying a handler method.</span></span> <span data-ttu-id="26d6f-121">當事件發生時，委派即會呼叫所繫結的方法。</span><span class="sxs-lookup"><span data-stu-id="26d6f-121">When the event occurs, the delegate calls the bound method.</span></span> <span data-ttu-id="26d6f-122">如需如何定義委派的詳細資訊，請參閱[事件](../../standard/events/index.md)。</span><span class="sxs-lookup"><span data-stu-id="26d6f-122">For more information about how to define delegates, see [Events](../../standard/events/index.md).</span></span>  
  
 <span data-ttu-id="26d6f-123">委派可以繫結到單一方法或多個方法，稱為「多點傳送」。</span><span class="sxs-lookup"><span data-stu-id="26d6f-123">Delegates can be bound to a single method or to multiple methods, referred to as multicasting.</span></span> <span data-ttu-id="26d6f-124">在為事件建立委派時，您 (或 Windows Forms 設計工具) 通常會建立多點傳送事件。</span><span class="sxs-lookup"><span data-stu-id="26d6f-124">When creating a delegate for an event, you (or the Windows Forms Designer) typically create a multicast event.</span></span> <span data-ttu-id="26d6f-125">唯一例外是由邏輯上不會在每一事件中重複多次之特定程序 (例如顯示對話方塊) 所產生的事件，但此情況極為罕見。</span><span class="sxs-lookup"><span data-stu-id="26d6f-125">A rare exception might be an event that results in a specific procedure (such as displaying a dialog box) that would not logically repeat multiple times per event.</span></span> <span data-ttu-id="26d6f-126">如需如何建立多點傳送的委派的詳細資訊，請參閱[How to:組合委派 （多點傳送委派）](~/docs/csharp/programming-guide/delegates/how-to-combine-delegates-multicast-delegates.md)。</span><span class="sxs-lookup"><span data-stu-id="26d6f-126">For information about how to create a multicast delegate, see [How to: Combine Delegates (Multicast Delegates)](~/docs/csharp/programming-guide/delegates/how-to-combine-delegates-multicast-delegates.md).</span></span>  
  
 <span data-ttu-id="26d6f-127">多點傳送委派會維護其所繫結之方法的叫用清單。</span><span class="sxs-lookup"><span data-stu-id="26d6f-127">A multicast delegate maintains an invocation list of the methods it is bound to.</span></span> <span data-ttu-id="26d6f-128">多點傳送委派可以讓 <xref:System.Delegate.Combine%2A> 方法新增方法到叫用清單，並支援 <xref:System.Delegate.Remove%2A> 方法來移除此方法。</span><span class="sxs-lookup"><span data-stu-id="26d6f-128">The multicast delegate supports a <xref:System.Delegate.Combine%2A> method to add a method to the invocation list and a <xref:System.Delegate.Remove%2A> method to remove it.</span></span>  
  
 <span data-ttu-id="26d6f-129">當應用程式記錄事件時，控制項便會叫用該事件的委派來引發事件。</span><span class="sxs-lookup"><span data-stu-id="26d6f-129">When an event is recorded by the application, the control raises the event by invoking the delegate for that event.</span></span> <span data-ttu-id="26d6f-130">委派會接著呼叫所繫結的方法。</span><span class="sxs-lookup"><span data-stu-id="26d6f-130">The delegate in turn calls the bound method.</span></span> <span data-ttu-id="26d6f-131">在最常見的情況 (多點傳送委派) 下，委派會輪流呼叫叫用清單中每一個繫結的方法，以提供一對多的通知。</span><span class="sxs-lookup"><span data-stu-id="26d6f-131">In the most common case (a multicast delegate) the delegate calls each bound method in the invocation list in turn, which provides a one-to-many notification.</span></span> <span data-ttu-id="26d6f-132">此策略表示控制項無須針對事件通知而維護一份目標物件清單，因為委派會處理所有的登錄與通知事宜。</span><span class="sxs-lookup"><span data-stu-id="26d6f-132">This strategy means that the control does not need to maintain a list of target objects for event notification—the delegate handles all registration and notification.</span></span>  
  
 <span data-ttu-id="26d6f-133">委派也可讓多個件繫結到同一方法，如此一來即可提供多對一通知。</span><span class="sxs-lookup"><span data-stu-id="26d6f-133">Delegates also enable multiple events to be bound to the same method, allowing a many-to-one notification.</span></span> <span data-ttu-id="26d6f-134">例如按一下按鈕事件與按一下功能表命令事件都會叫用相同的委派，然後委派再呼叫一個方法，以相同方式處理這些個別的事件。</span><span class="sxs-lookup"><span data-stu-id="26d6f-134">For example, a button-click event and a menu-command–click event can both invoke the same delegate, which then calls a single method to handle these separate events the same way.</span></span>  
  
 <span data-ttu-id="26d6f-135">委派會隨機使用繫結機制，其可能在執行時繫結到任何簽章符合事件處理程式簽章的方法。</span><span class="sxs-lookup"><span data-stu-id="26d6f-135">The binding mechanism used with delegates is dynamic: a delegate can be bound at run time to any method whose signature matches that of the event handler.</span></span> <span data-ttu-id="26d6f-136">您可以利用此功能視條件設定或變更繫結方法，以及隨機將事件處理常式連結至控制項。</span><span class="sxs-lookup"><span data-stu-id="26d6f-136">With this feature, you can set up or change the bound method depending on a condition and to dynamically attach an event handler to a control.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="26d6f-137">另請參閱</span><span class="sxs-lookup"><span data-stu-id="26d6f-137">See also</span></span>

- [<span data-ttu-id="26d6f-138">在 Windows Forms 中建立事件處理常式</span><span class="sxs-lookup"><span data-stu-id="26d6f-138">Creating Event Handlers in Windows Forms</span></span>](creating-event-handlers-in-windows-forms.md)
- [<span data-ttu-id="26d6f-139">事件處理常式概觀</span><span class="sxs-lookup"><span data-stu-id="26d6f-139">Event Handlers Overview</span></span>](event-handlers-overview-windows-forms.md)
