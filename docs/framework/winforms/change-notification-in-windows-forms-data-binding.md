---
title: 資料系結中的變更通知
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Forms, data binding
- Windows Forms, adding change notification for data binding
ms.assetid: b5b10f90-0585-41d9-a377-409835262a92
ms.openlocfilehash: 2dffea46bf0db54d28ef55e507767d88bd29ebc2
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76746358"
---
# <a name="change-notification-in-windows-forms-data-binding"></a><span data-ttu-id="30bbe-102">Windows Form 資料繫結中的變更通知</span><span class="sxs-lookup"><span data-stu-id="30bbe-102">Change Notification in Windows Forms Data Binding</span></span>
<span data-ttu-id="30bbe-103">Windows Forms 資料系結的其中一個最重要概念是*變更通知*。</span><span class="sxs-lookup"><span data-stu-id="30bbe-103">One of the most important concepts of Windows Forms data binding is *change notification*.</span></span> <span data-ttu-id="30bbe-104">若要確保您的資料來源和繫結控制項一律具有最新的資料，您必須加入資料系結的變更通知。</span><span class="sxs-lookup"><span data-stu-id="30bbe-104">To ensure that your data source and bound controls always have the most recent data, you must add change notification for data binding.</span></span> <span data-ttu-id="30bbe-105">具體而言，您會想要確保繫結控制項收到其資料來源變更的通知，而資料來源會收到對控制項系結屬性所做變更的通知。</span><span class="sxs-lookup"><span data-stu-id="30bbe-105">Specifically, you want to ensure that bound controls are notified of changes that were made to their data source, and the data source is notified of changes that were made to the bound properties of a control.</span></span>  
  
 <span data-ttu-id="30bbe-106">有不同類型的變更通知，視資料系結類型而定：</span><span class="sxs-lookup"><span data-stu-id="30bbe-106">There are different kinds of change notification, depending on the kind of data binding:</span></span>  
  
- <span data-ttu-id="30bbe-107">簡單系結，其中單一控制項屬性會系結至物件的單一實例。</span><span class="sxs-lookup"><span data-stu-id="30bbe-107">Simple binding, in which a single control property is bound to a single instance of an object.</span></span>  
  
- <span data-ttu-id="30bbe-108">以清單為基礎的系結，其中可以包含系結至清單中專案之屬性的單一控制項屬性，或系結至物件清單的控制項屬性。</span><span class="sxs-lookup"><span data-stu-id="30bbe-108">List-based binding, which can include a single control property bound to the property of an item in a list or a control property bound to a list of objects.</span></span>  
  
 <span data-ttu-id="30bbe-109">此外，如果您要建立要用於資料系結的 Windows Forms 控制項，則必須將*PropertyName*changed 模式套用至控制項，以便將控制項之系結屬性的變更傳播至資料來源。</span><span class="sxs-lookup"><span data-stu-id="30bbe-109">Additionally, if you are creating Windows Forms controls that you want to use for data binding, you must apply the *PropertyName*Changed pattern to the controls, so that changes to the bound property of a control are propagated to the data source.</span></span>  
  
## <a name="change-notification-for-simple-binding"></a><span data-ttu-id="30bbe-110">簡單系結的變更通知</span><span class="sxs-lookup"><span data-stu-id="30bbe-110">Change Notification for Simple Binding</span></span>  
 <span data-ttu-id="30bbe-111">針對簡單系結，當系結屬性的值變更時，商務物件必須提供變更通知。</span><span class="sxs-lookup"><span data-stu-id="30bbe-111">For simple binding, business objects must provide change notification when the value of a bound property changes.</span></span> <span data-ttu-id="30bbe-112">若要這麼做，您可以為商務物件的每個屬性公開*PropertyName*已變更事件，並使用 <xref:System.Windows.Forms.BindingSource> 或慣用方法將商務物件系結至控制項，讓您的商務物件在其中執行 <xref:System.ComponentModel.INotifyPropertyChanged> 介面，並在屬性的值變更時引發 <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="30bbe-112">You can do this by exposing an *PropertyName*Changed event for each property of your business object and binding the business object to controls with the <xref:System.Windows.Forms.BindingSource> or the preferred method in which your business object implements the <xref:System.ComponentModel.INotifyPropertyChanged> interface and raises a <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> event when the value of a property changes.</span></span> <span data-ttu-id="30bbe-113">如需詳細資訊，請參閱 how [to：執行 INotifyPropertyChanged 介面](how-to-implement-the-inotifypropertychanged-interface.md)。</span><span class="sxs-lookup"><span data-stu-id="30bbe-113">For more information, see [How to: Implement the INotifyPropertyChanged Interface](how-to-implement-the-inotifypropertychanged-interface.md).</span></span> <span data-ttu-id="30bbe-114">當您使用可執行 <xref:System.ComponentModel.INotifyPropertyChanged> 介面的物件時，您不需要使用 <xref:System.Windows.Forms.BindingSource> 將物件系結至控制項，但建議使用 <xref:System.Windows.Forms.BindingSource>。</span><span class="sxs-lookup"><span data-stu-id="30bbe-114">When you use objects that implement the <xref:System.ComponentModel.INotifyPropertyChanged> interface, you do not have to use the <xref:System.Windows.Forms.BindingSource> to bind the object to a control, but using the <xref:System.Windows.Forms.BindingSource> is recommended.</span></span>  
  
## <a name="change-notification-for-list-based-binding"></a><span data-ttu-id="30bbe-115">以清單為基礎的系結變更通知</span><span class="sxs-lookup"><span data-stu-id="30bbe-115">Change Notification for List-Based Binding</span></span>  
 <span data-ttu-id="30bbe-116">Windows Forms 取決於系結清單，以提供屬性變更（清單專案屬性值變更）和清單已變更（專案已刪除或加入清單中）資訊到繫結控制項。</span><span class="sxs-lookup"><span data-stu-id="30bbe-116">Windows Forms depends on a bound list to provide property change (a list item property value changes) and list changed (an item is deleted or added to the list) information to bound controls.</span></span> <span data-ttu-id="30bbe-117">因此，用於資料系結的清單必須執行 <xref:System.ComponentModel.IBindingList>，這會提供兩種類型的變更通知。</span><span class="sxs-lookup"><span data-stu-id="30bbe-117">Therefore, lists used for data binding must implement the <xref:System.ComponentModel.IBindingList>, which provides both types of change notification.</span></span> <span data-ttu-id="30bbe-118"><xref:System.ComponentModel.BindingList%601> 是 <xref:System.ComponentModel.IBindingList> 的泛型實作為，而且是設計來搭配 Windows Forms 資料系結使用。</span><span class="sxs-lookup"><span data-stu-id="30bbe-118">The <xref:System.ComponentModel.BindingList%601> is a generic implementation of <xref:System.ComponentModel.IBindingList> and is designed for use with Windows Forms data binding.</span></span> <span data-ttu-id="30bbe-119">您可以建立 <xref:System.ComponentModel.BindingList%601>，其中包含可執行 <xref:System.ComponentModel.INotifyPropertyChanged> 的商業物件類型，而且清單會自動將 <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> 事件轉換成 <xref:System.ComponentModel.IBindingList.ListChanged> 事件。</span><span class="sxs-lookup"><span data-stu-id="30bbe-119">You can create a <xref:System.ComponentModel.BindingList%601> that contains a business object type that implements <xref:System.ComponentModel.INotifyPropertyChanged> and the list will automatically convert the <xref:System.ComponentModel.INotifyPropertyChanged.PropertyChanged> events to <xref:System.ComponentModel.IBindingList.ListChanged> events.</span></span> <span data-ttu-id="30bbe-120">如果系結清單不是 <xref:System.ComponentModel.IBindingList>，您就必須使用 <xref:System.Windows.Forms.BindingSource> 元件，將物件清單系結至 Windows Forms 控制項。</span><span class="sxs-lookup"><span data-stu-id="30bbe-120">If the bound list is not an <xref:System.ComponentModel.IBindingList>, you must bind the list of objects to Windows Forms controls by using the <xref:System.Windows.Forms.BindingSource> component.</span></span> <span data-ttu-id="30bbe-121"><xref:System.Windows.Forms.BindingSource> 元件會提供類似于 <xref:System.ComponentModel.BindingList%601>的屬性對清單轉換。</span><span class="sxs-lookup"><span data-stu-id="30bbe-121">The <xref:System.Windows.Forms.BindingSource> component will provide property-to-list conversion similar to that of the <xref:System.ComponentModel.BindingList%601>.</span></span> <span data-ttu-id="30bbe-122">如需詳細資訊，請參閱[如何：使用 BindingSource 和 INotifyPropertyChanged 介面引發變更通知](./controls/raise-change-notifications--bindingsource.md)。</span><span class="sxs-lookup"><span data-stu-id="30bbe-122">For more information, see [How to: Raise Change Notifications Using a BindingSource and the INotifyPropertyChanged Interface](./controls/raise-change-notifications--bindingsource.md).</span></span>  
  
## <a name="change-notification-for-custom-controls"></a><span data-ttu-id="30bbe-123">變更自訂控制項的通知</span><span class="sxs-lookup"><span data-stu-id="30bbe-123">Change Notification for Custom Controls</span></span>  
 <span data-ttu-id="30bbe-124">最後，您必須從控制項端公開每個設計要系結至資料之屬性的*PropertyName*已變更事件。</span><span class="sxs-lookup"><span data-stu-id="30bbe-124">Finally, from the control side you must expose a *PropertyName*Changed event for each property designed to be bound to data.</span></span> <span data-ttu-id="30bbe-125">控制項屬性的變更就會傳播到系結的資料來源。</span><span class="sxs-lookup"><span data-stu-id="30bbe-125">The changes to the control property are then propagated to the bound data source.</span></span> <span data-ttu-id="30bbe-126">如需詳細資訊，請參閱[如何：套用 PropertyNameChanged 模式](how-to-apply-the-propertynamechanged-pattern.md)</span><span class="sxs-lookup"><span data-stu-id="30bbe-126">For more information, see [How to: Apply the PropertyNameChanged Pattern](how-to-apply-the-propertynamechanged-pattern.md)</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="30bbe-127">另請參閱</span><span class="sxs-lookup"><span data-stu-id="30bbe-127">See also</span></span>

- <xref:System.Windows.Forms.BindingSource>
- <xref:System.ComponentModel.INotifyPropertyChanged>
- <xref:System.ComponentModel.BindingList%601>
- [<span data-ttu-id="30bbe-128">Windows Forms 資料繫結</span><span class="sxs-lookup"><span data-stu-id="30bbe-128">Windows Forms Data Binding</span></span>](windows-forms-data-binding.md)
- [<span data-ttu-id="30bbe-129">Windows Forms 支援的資料來源</span><span class="sxs-lookup"><span data-stu-id="30bbe-129">Data Sources Supported by Windows Forms</span></span>](data-sources-supported-by-windows-forms.md)
- [<span data-ttu-id="30bbe-130">資料繫結和 Windows Forms</span><span class="sxs-lookup"><span data-stu-id="30bbe-130">Data Binding and Windows Forms</span></span>](data-binding-and-windows-forms.md)
