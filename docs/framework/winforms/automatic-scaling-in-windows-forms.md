---
title: Windows Form 中的自動縮放比例
ms.date: 06/15/2017
helpviewer_keywords:
- scalability [Windows Forms], automatic in Windows Forms
- Windows Forms, automatic scaling
ms.assetid: 68fad25b-afbc-44bd-8e1b-966fc43507a4
ms.openlocfilehash: d3981be7977b56af0b60f9796519b78dc9ac5db3
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "61640504"
---
# <a name="automatic-scaling-in-windows-forms"></a><span data-ttu-id="b2019-102">自動縮放 Windows Form</span><span class="sxs-lookup"><span data-stu-id="b2019-102">Automatic scaling in Windows Forms</span></span>

<span data-ttu-id="b2019-103">自動縮放功能允許某部電腦上以特定顯示解析度或系統字型所設計的表單和其控制項，可以在另一部電腦上以不同的顯示解析度或系統字型正確地顯示。</span><span class="sxs-lookup"><span data-stu-id="b2019-103">Automatic scaling enables a form and its controls, designed on one machine with a certain display resolution or system font, to be displayed appropriately on another machine with a different display resolution or system font.</span></span> <span data-ttu-id="b2019-104">如此可確保表單和其控制項利用智慧方式調整大小，以便與使用者和其他開發人員電腦上的原生視窗和其他應用程式保持一致。</span><span class="sxs-lookup"><span data-stu-id="b2019-104">It assures that the form and its controls will intelligently resize to be consistent with native windows and other applications on both the users' and other developers' machines.</span></span> <span data-ttu-id="b2019-105">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 對自動縮放和視覺化樣式的支援，可以讓 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 應用程式在與每個使用者電腦上的原生 Windows 應用程式相較下，都能保有一致的外觀和風格。</span><span class="sxs-lookup"><span data-stu-id="b2019-105">The support of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] for automatic scaling and visual styles enables [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] applications to maintain a consistent look and feel when compared to native Windows applications on each user's machine.</span></span>

<span data-ttu-id="b2019-106">在 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 2.0 (含) 更新版本中，自動調整大部分會如預期運作。</span><span class="sxs-lookup"><span data-stu-id="b2019-106">For the most part, automatic scaling works as expected in [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0 and later.</span></span> <span data-ttu-id="b2019-107">不過，字型配置變更可能會造成問題。</span><span class="sxs-lookup"><span data-stu-id="b2019-107">However, font scheme changes can be problematic.</span></span> <span data-ttu-id="b2019-108">如需如何解決此問題的範例，請參閱[How to:回應 Windows Forms 應用程式中的字型配置變更](how-to-respond-to-font-scheme-changes-in-a-windows-forms-application.md)。</span><span class="sxs-lookup"><span data-stu-id="b2019-108">For an example of how to resolve this, see [How to: Respond to Font Scheme Changes in a Windows Forms Application](how-to-respond-to-font-scheme-changes-in-a-windows-forms-application.md).</span></span>

## <a name="need-for-automatic-scaling"></a><span data-ttu-id="b2019-109">自動縮放的需求</span><span class="sxs-lookup"><span data-stu-id="b2019-109">Need for automatic scaling</span></span>

<span data-ttu-id="b2019-110">如果沒有自動縮放功能，專為某種顯示解析度或字型所設計的應用程式會在該解析度或字型變更時，看起來太小或太大。</span><span class="sxs-lookup"><span data-stu-id="b2019-110">Without automatic scaling, an application designed for one display resolution or font will either appear too small or too large when that resolution or font is changed.</span></span> <span data-ttu-id="b2019-111">例如，如果應用程式在設計時使用新細明體 9 點做為基準，然後未經調整便在系統字型為新細明體 12 點的電腦上執行，則會看起來太小。</span><span class="sxs-lookup"><span data-stu-id="b2019-111">For example, if the application is designed using Tahoma 9 point as a baseline, without adjustment it will appear too small if run on a machine where the system font is Tahoma 12 point.</span></span> <span data-ttu-id="b2019-112">文字項目 (例如標題、功能表、文字方塊內容等) 的顯示將會比其他應用程式還要小。</span><span class="sxs-lookup"><span data-stu-id="b2019-112">Text elements, such as titles, menus, text box contents, and so on will render smaller than other applications.</span></span> <span data-ttu-id="b2019-113">此外，含有文字之使用者介面 (UI) 項目 (例如標題列、功能表和許多控制項) 的大小會取決於所使用的字型。</span><span class="sxs-lookup"><span data-stu-id="b2019-113">Furthermore, the size of user interface (UI) elements that contain text, such as the title bar, menus, and many controls are dependent on the font used.</span></span> <span data-ttu-id="b2019-114">在這個範例中，這些項目看起來也會相對較小。</span><span class="sxs-lookup"><span data-stu-id="b2019-114">In this example, these elements will also appear relatively smaller.</span></span>

<span data-ttu-id="b2019-115">當應用程式是專為特定顯示解析度而設計時，就會發生類似的情況。</span><span class="sxs-lookup"><span data-stu-id="b2019-115">An analogous situation occurs when an application is designed for a certain display resolution.</span></span> <span data-ttu-id="b2019-116">最常見的顯示解析度為 96 為 dots per inch (DPI)，而這就等於 100%顯示縮放比例，但支援 125%、 150%、 200%的更高解析度顯示畫面 (哪些分別等於 120，第 144 和 192 DPI) 和更新版本會變得更為普遍。</span><span class="sxs-lookup"><span data-stu-id="b2019-116">The most common display resolution is 96 dots per inch (DPI), which equals 100% display scaling, but higher resolution displays supporting 125%, 150%, 200% (which respectively equal 120, 144 and 192 DPI) and above are becoming more common.</span></span> <span data-ttu-id="b2019-117">如果未經調整，專為某種解析度所設計的應用程式 (特別是圖形應用程式) 以另一種解析度執行時，便會看起來太大或太小。</span><span class="sxs-lookup"><span data-stu-id="b2019-117">Without adjustment, an application, especially a graphics-based one, designed for one resolution will appear either too large or too small when run at another resolution.</span></span>

<span data-ttu-id="b2019-118">自動縮放功能會根據相對字型大小或顯示解析度，自動調整表單和其控制項的大小，以改善這些問題。</span><span class="sxs-lookup"><span data-stu-id="b2019-118">Automatic scaling seeks to ameliorate these problems by automatically resizing the form and its child controls according to the relative font size or display resolution.</span></span> <span data-ttu-id="b2019-119">Windows 作業系統支援使用稱為對話方塊單位的相對測量單位，來自動縮放對話方塊。</span><span class="sxs-lookup"><span data-stu-id="b2019-119">The Windows operating system supports automatic scaling of dialog boxes using a relative unit of measurement called dialog units.</span></span> <span data-ttu-id="b2019-120">對話方塊單位是以系統字型以及其與像素的關聯性為依據，並可透過 Win32 SDK 函式 `GetDialogBaseUnits` 來判斷。</span><span class="sxs-lookup"><span data-stu-id="b2019-120">A dialog unit is based on the system font and its relationship to pixels can be determined though the Win32 SDK function `GetDialogBaseUnits`.</span></span> <span data-ttu-id="b2019-121">當使用者變更 Windows 所使用的佈景主題時，所有對話方塊都會隨著自動調整。</span><span class="sxs-lookup"><span data-stu-id="b2019-121">When a user changes the theme used by Windows, all dialog boxes are automatically adjusted accordingly.</span></span> <span data-ttu-id="b2019-122">颾魤 ㄛ[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)]支援自動調整，根據預設系統字型或顯示解析度。</span><span class="sxs-lookup"><span data-stu-id="b2019-122">In addition, the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] supports automatic scaling either according to the default system font or the display resolution.</span></span> <span data-ttu-id="b2019-123">您可以選擇性地停用應用程式中的自動縮放功能。</span><span class="sxs-lookup"><span data-stu-id="b2019-123">Optionally, automatic scaling can be disabled in an application.</span></span>

## <a name="original-support-for-automatic-scaling"></a><span data-ttu-id="b2019-124">自動縮放的原始支援</span><span class="sxs-lookup"><span data-stu-id="b2019-124">Original support for automatic scaling</span></span>

<span data-ttu-id="b2019-125">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 1.0 和 1.1 版支援直接根據 UI 所使用的 Windows 預設字型 (以 Win32 SDK 的 **DEFAULT_GUI_FONT** 值表示) 來進行自動縮放。</span><span class="sxs-lookup"><span data-stu-id="b2019-125">Versions 1.0 and 1.1 of the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] supported automatic scaling in a straightforward manner that was dependent on the Windows default font used for the UI, represented by the Win32 SDK value **DEFAULT_GUI_FONT**.</span></span> <span data-ttu-id="b2019-126">這種字型通常只有在顯示解析度變更時才會變更。</span><span class="sxs-lookup"><span data-stu-id="b2019-126">This font is typically only changed when the display resolution changes.</span></span> <span data-ttu-id="b2019-127">之前會使用下列機制來實作自動縮放：</span><span class="sxs-lookup"><span data-stu-id="b2019-127">The following mechanism was used to implement automatic scaling:</span></span>

1. <span data-ttu-id="b2019-128">在設計階段，<xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> 屬性 (現在已被取代) 會設定為開發人員電腦上預設系統字型的高度和寬度。</span><span class="sxs-lookup"><span data-stu-id="b2019-128">At design time, the <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> property (which is now deprecated) was set to the height and width of the default system font on the developer's machine.</span></span>

2. <span data-ttu-id="b2019-129">在執行階段，使用者電腦的預設系統字型會用來初始化 <xref:System.Windows.Forms.Form> 類別的 <xref:System.Windows.Forms.Control.Font%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="b2019-129">At runtime, the default system font of the user's machine was used to initialize the <xref:System.Windows.Forms.Control.Font%2A> property of the <xref:System.Windows.Forms.Form> class.</span></span>

3. <span data-ttu-id="b2019-130">在顯示表單之前，會呼叫 <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> 方法來縮放表單。</span><span class="sxs-lookup"><span data-stu-id="b2019-130">Before displaying the form, the <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> method was called to scale the form.</span></span> <span data-ttu-id="b2019-131">這個方法會從 <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> 和 <xref:System.Windows.Forms.Control.Font%2A> 計算相對縮放比例，然後呼叫 <xref:System.Windows.Forms.Control.Scale%2A> 方法實際縮放表單和其子系。</span><span class="sxs-lookup"><span data-stu-id="b2019-131">This method calculated the relative scale sizes from <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> and <xref:System.Windows.Forms.Control.Font%2A> then called the <xref:System.Windows.Forms.Control.Scale%2A> method to actually scale the form and its children.</span></span>

4. <span data-ttu-id="b2019-132"><xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> 的值已更新，後續對 <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> 的呼叫不會繼續調整表單的大小。</span><span class="sxs-lookup"><span data-stu-id="b2019-132">The value of <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> was updated so that subsequent calls to <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A> did not progressively resize the form.</span></span>

<span data-ttu-id="b2019-133">雖然這項機制在大部分情況下便已足夠，但是仍有下列限制：</span><span class="sxs-lookup"><span data-stu-id="b2019-133">While this mechanism was sufficient for most purposes, it suffered from the following limitations:</span></span>

- <span data-ttu-id="b2019-134">因為<xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A>屬性以整數值表示基準字型大小，會發生捨入錯誤，更為明顯，表單特別是當透過多個解決方法。</span><span class="sxs-lookup"><span data-stu-id="b2019-134">Since the <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> property represents the baseline font size as integer values, rounding errors occur that become evident when a form is cycled through multiple resolutions.</span></span>

- <span data-ttu-id="b2019-135">自動縮放只會在 <xref:System.Windows.Forms.Form> 類別中實作，並不會在 <xref:System.Windows.Forms.ContainerControl> 類別中實作。</span><span class="sxs-lookup"><span data-stu-id="b2019-135">Automatic scaling was implemented in only the <xref:System.Windows.Forms.Form> class, not in the <xref:System.Windows.Forms.ContainerControl> class.</span></span> <span data-ttu-id="b2019-136">因此，只有在使用者控制項是以與表單相同的解析度所設計，並且在設計階段置於表單中時，使用者控制項才能正確縮放。</span><span class="sxs-lookup"><span data-stu-id="b2019-136">As a result, user controls would scale correctly only when the user control was designed at the same resolution as the form, and it was placed in the form at design time.</span></span>

- <span data-ttu-id="b2019-137">多位開發人員只能在其電腦解析度都相同時，才能同時設計表單和其子控制項。</span><span class="sxs-lookup"><span data-stu-id="b2019-137">Forms and their child controls could only be concurrently designed by multiple developers if their machine resolutions were the same.</span></span> <span data-ttu-id="b2019-138">同樣地，它也會根據與父表單關聯的解析度來繼承表單。</span><span class="sxs-lookup"><span data-stu-id="b2019-138">Likewise it also made inheritance of a form dependent on the resolution associated with the parent form.</span></span>

- <span data-ttu-id="b2019-139">它與 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 2.0 版所採用的新版配置管理員不相容，例如 <xref:System.Windows.Forms.FlowLayoutPanel> 和 <xref:System.Windows.Forms.TableLayoutPanel>。</span><span class="sxs-lookup"><span data-stu-id="b2019-139">It is not compatible with the newer layout managers introduced with the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0, such as <xref:System.Windows.Forms.FlowLayoutPanel> and <xref:System.Windows.Forms.TableLayoutPanel>.</span></span>

- <span data-ttu-id="b2019-140">它不支援直接根據顯示解析度進行縮放，但這是與 [!INCLUDE[compact](../../../includes/compact-md.md)] 相容的必要條件。</span><span class="sxs-lookup"><span data-stu-id="b2019-140">It did not support scaling based directly on the display resolution that is required for compatibility to the [!INCLUDE[compact](../../../includes/compact-md.md)].</span></span>

<span data-ttu-id="b2019-141">雖然 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 2.0 版中保留了這項機制，以維持回溯相容性，但是這項機制已經被更強大的縮機制 (下一節會提到) 所取代。</span><span class="sxs-lookup"><span data-stu-id="b2019-141">Although this mechanism is preserved in the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0 to maintain backward compatibility, it has been superseded by the more robust scaling mechanism described next.</span></span> <span data-ttu-id="b2019-142">因此，<xref:System.Windows.Forms.Form.AutoScale%2A>、<xref:System.Windows.Forms.Form.ApplyAutoScaling%2A>、<xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A> 和特定 <xref:System.Windows.Forms.Control.Scale%2A> 多載會標記為已過時。</span><span class="sxs-lookup"><span data-stu-id="b2019-142">As a consequence, the <xref:System.Windows.Forms.Form.AutoScale%2A>, <xref:System.Windows.Forms.Form.ApplyAutoScaling%2A>, <xref:System.Windows.Forms.Form.AutoScaleBaseSize%2A>, and certain <xref:System.Windows.Forms.Control.Scale%2A> overloads are marked as obsolete.</span></span>

> [!NOTE]
> <span data-ttu-id="b2019-143">當您將舊版程式碼升級為 [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 2.0 版時，可安全地刪除這些成員的參考。</span><span class="sxs-lookup"><span data-stu-id="b2019-143">You can safely delete references to these members when you upgrade your legacy code to the [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0.</span></span>

## <a name="current-support-for-automatic-scaling"></a><span data-ttu-id="b2019-144">目前支援自動調整</span><span class="sxs-lookup"><span data-stu-id="b2019-144">Current support for automatic scaling</span></span>

<span data-ttu-id="b2019-145">[!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] 2.0 版為了克服上述限制，引進了 Windows Form 自動縮放功能的下列變更：</span><span class="sxs-lookup"><span data-stu-id="b2019-145">The [!INCLUDE[dnprdnshort](../../../includes/dnprdnshort-md.md)] version 2.0 surmounts previous limitations by introducing the following changes to the automatic scaling of Windows Forms:</span></span>

- <span data-ttu-id="b2019-146">縮放的基礎支援已移至 <xref:System.Windows.Forms.ContainerControl> 類別，因此表單、原生複合控制項和使用者控制項都能獲得一致的縮放支援。</span><span class="sxs-lookup"><span data-stu-id="b2019-146">Base support for scaling has been moved to the <xref:System.Windows.Forms.ContainerControl> class so that forms, native composite controls and user controls all receive uniform scaling support.</span></span> <span data-ttu-id="b2019-147">同時也加入新成員 <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A>、<xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>、<xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> 和 <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>。</span><span class="sxs-lookup"><span data-stu-id="b2019-147">The new members <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A>, <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>, <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> and <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> have been added.</span></span>

- <span data-ttu-id="b2019-148"><xref:System.Windows.Forms.Control> 類別也具有幾個新成員，以便可以參與縮放並支援在相同表單上使用混合縮放比例。</span><span class="sxs-lookup"><span data-stu-id="b2019-148">The <xref:System.Windows.Forms.Control> class also has several new members that allow it to participate in scaling and to support mixed scaling on the same form.</span></span> <span data-ttu-id="b2019-149"><xref:System.Windows.Forms.Control.Scale%2A>、<xref:System.Windows.Forms.Control.ScaleChildren%2A> 和 <xref:System.Windows.Forms.Control.GetScaledBounds%2A> 成員尤其支援縮放比例。</span><span class="sxs-lookup"><span data-stu-id="b2019-149">Specifically the <xref:System.Windows.Forms.Control.Scale%2A>, <xref:System.Windows.Forms.Control.ScaleChildren%2A>, and <xref:System.Windows.Forms.Control.GetScaledBounds%2A> members support scaling.</span></span>

- <span data-ttu-id="b2019-150">補充的系統字型支援已新增根據螢幕解析度進行縮放的支援，如 <xref:System.Windows.Forms.AutoScaleMode> 列舉所定義。</span><span class="sxs-lookup"><span data-stu-id="b2019-150">Support for scaling based upon the screen resolution has been added to complement system font support, as defined by the <xref:System.Windows.Forms.AutoScaleMode> enumeration.</span></span> <span data-ttu-id="b2019-151">這種模式與 [!INCLUDE[compact](../../../includes/compact-md.md)] 支援的自動縮放相容，因此可更輕鬆地進行應用程式移轉。</span><span class="sxs-lookup"><span data-stu-id="b2019-151">This mode is compatible with automatic scaling supported by the [!INCLUDE[compact](../../../includes/compact-md.md)] enabling easier application migration.</span></span>

- <span data-ttu-id="b2019-152">自動縮放實作已新增與配置管理員 (例如 <xref:System.Windows.Forms.FlowLayoutPanel> 和 <xref:System.Windows.Forms.TableLayoutPanel>) 的相容性。</span><span class="sxs-lookup"><span data-stu-id="b2019-152">Compatibility with layout managers such as <xref:System.Windows.Forms.FlowLayoutPanel> and <xref:System.Windows.Forms.TableLayoutPanel> has been added to the implementation of automatic scaling.</span></span>

- <span data-ttu-id="b2019-153">縮放比例現在以浮點值表示 (通常使用 <xref:System.Drawing.SizeF> 結構)，因此已實際減少捨入錯誤。</span><span class="sxs-lookup"><span data-stu-id="b2019-153">Scaling factors are now represented as floating point values, typically using the <xref:System.Drawing.SizeF> structure, so that rounding errors have been practically eliminated.</span></span>

> [!CAUTION]
> <span data-ttu-id="b2019-154">不支援 DPI 和字型縮放模式的任意混合。</span><span class="sxs-lookup"><span data-stu-id="b2019-154">Arbitrary mixtures of DPI and font scaling modes are not supported.</span></span> <span data-ttu-id="b2019-155">雖然您可以使用某種模式 (例如 DPI) 縮放使用者控制項，並使用另一種模式 (字型) 將控制項置於表單上，而不會有任何問題，但是將某種模式中的基底表單與從另一種模式的衍生表單混合，可能會導致無法預期的結果。</span><span class="sxs-lookup"><span data-stu-id="b2019-155">Although you may scale a user control using one mode (for example, DPI) and place it on a form using another mode (Font) with no issues, but mixing a base form in one mode and a derived form in another can lead to unexpected results.</span></span>

### <a name="automatic-scaling-in-action"></a><span data-ttu-id="b2019-156">自動調整規模動作</span><span class="sxs-lookup"><span data-stu-id="b2019-156">Automatic scaling in action</span></span>

<span data-ttu-id="b2019-157">Windows Form 現在使用下列邏輯來自動縮放表單和其內容：</span><span class="sxs-lookup"><span data-stu-id="b2019-157">Windows Forms now uses the following logic to automatically scale forms and their contents:</span></span>

1. <span data-ttu-id="b2019-158">在設計階段，每個 <xref:System.Windows.Forms.ContainerControl> 會記錄縮放模式，以及各自在 <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> 和 <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> 中的目前解析度。</span><span class="sxs-lookup"><span data-stu-id="b2019-158">At design time, each <xref:System.Windows.Forms.ContainerControl> records the scaling mode and it current resolution in the <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> and <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>, respectively.</span></span>

2. <span data-ttu-id="b2019-159">在執行階段，實際的解析度會儲存在 <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> 屬性中。</span><span class="sxs-lookup"><span data-stu-id="b2019-159">At run time, the actual resolution is stored in the <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> property.</span></span> <span data-ttu-id="b2019-160"><xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A> 屬性動態計算執行階段縮放解析和設計階段縮放解析間的比率。</span><span class="sxs-lookup"><span data-stu-id="b2019-160">The <xref:System.Windows.Forms.ContainerControl.AutoScaleFactor%2A> property dynamically calculates the ratio between the run-time and design-time scaling resolution.</span></span>

3. <span data-ttu-id="b2019-161">當表單載入時，如果 <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> 和 <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> 的值不同，則會呼叫 <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> 方法以縮放控制項和其子系。</span><span class="sxs-lookup"><span data-stu-id="b2019-161">When the form loads, if the values of <xref:System.Windows.Forms.ContainerControl.CurrentAutoScaleDimensions%2A> and <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> are different, then the <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> method is called to scale the control and its children.</span></span> <span data-ttu-id="b2019-162">這個方法會暫止配置並呼叫 <xref:System.Windows.Forms.Control.Scale%2A> 方法，以執行實際的縮放。</span><span class="sxs-lookup"><span data-stu-id="b2019-162">This method suspends layout and calls the <xref:System.Windows.Forms.Control.Scale%2A> method to perform the actual scaling.</span></span> <span data-ttu-id="b2019-163">之後，<xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> 的值會更新以避免繼續縮放。</span><span class="sxs-lookup"><span data-stu-id="b2019-163">Afterwards, the value of <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> is updated to avoid progressive scaling.</span></span>

4. <span data-ttu-id="b2019-164">在下列情況下，也會自動叫用 <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>：</span><span class="sxs-lookup"><span data-stu-id="b2019-164"><xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A> is also automatically invoked in the following situations:</span></span>

    - <span data-ttu-id="b2019-165">為了在縮放模式為 <xref:System.Windows.Forms.AutoScaleMode.Font> 時回應 <xref:System.Windows.Forms.Control.OnFontChanged%2A> 事件。</span><span class="sxs-lookup"><span data-stu-id="b2019-165">In response to the <xref:System.Windows.Forms.Control.OnFontChanged%2A> event if the scaling mode is <xref:System.Windows.Forms.AutoScaleMode.Font>.</span></span>

    - <span data-ttu-id="b2019-166">當繼續容器控制項的配置，並在 <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> 或 <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> 屬性中偵測到變更時。</span><span class="sxs-lookup"><span data-stu-id="b2019-166">When the layout of the container control resumes and a change is detected in the <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A> or <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A> properties.</span></span>

    - <span data-ttu-id="b2019-167">如上所指，當縮放父 <xref:System.Windows.Forms.ContainerControl> 時。</span><span class="sxs-lookup"><span data-stu-id="b2019-167">As implied above, when a parent <xref:System.Windows.Forms.ContainerControl> is being scaled.</span></span> <span data-ttu-id="b2019-168">每個容器控制項會負責使用自已的縮放比例 (而非其父容器的縮放比例)，來縮放其子系。</span><span class="sxs-lookup"><span data-stu-id="b2019-168">Each container control is responsible for scaling its children using its own scaling factors and not the one from its parent container.</span></span>

5. <span data-ttu-id="b2019-169">子控制項可以透過幾種方式，修改其縮放行為：</span><span class="sxs-lookup"><span data-stu-id="b2019-169">Child controls can modify their scaling behavior through several means:</span></span>

    - <span data-ttu-id="b2019-170">可以覆寫 <xref:System.Windows.Forms.Control.ScaleChildren%2A> 屬性，以判斷是否應該縮放其子控制項。</span><span class="sxs-lookup"><span data-stu-id="b2019-170">The <xref:System.Windows.Forms.Control.ScaleChildren%2A> property can be overridden to determine if their child controls should be scaled or not.</span></span>

    - <span data-ttu-id="b2019-171">可以覆寫 <xref:System.Windows.Forms.Control.GetScaledBounds%2A> 方法，以調整控制項的縮放範圍，而不是縮放邏輯。</span><span class="sxs-lookup"><span data-stu-id="b2019-171">The <xref:System.Windows.Forms.Control.GetScaledBounds%2A> method can be overridden to adjust the bounds that the control is scaled to, but not the scaling logic.</span></span>

    - <span data-ttu-id="b2019-172">可以覆寫 <xref:System.Windows.Forms.Control.ScaleControl%2A> 方法，以變更目前控制項的縮放邏輯。</span><span class="sxs-lookup"><span data-stu-id="b2019-172">The <xref:System.Windows.Forms.Control.ScaleControl%2A> method can be overridden to change the scaling logic for the current control.</span></span>

## <a name="see-also"></a><span data-ttu-id="b2019-173">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b2019-173">See also</span></span>

- <xref:System.Windows.Forms.ContainerControl.AutoScaleMode%2A>
- <xref:System.Windows.Forms.Control.Scale%2A>
- <xref:System.Windows.Forms.ContainerControl.PerformAutoScale%2A>
- <xref:System.Windows.Forms.ContainerControl.AutoScaleDimensions%2A>
- [<span data-ttu-id="b2019-174">使用視覺化樣式呈現控制項</span><span class="sxs-lookup"><span data-stu-id="b2019-174">Rendering Controls with Visual Styles</span></span>](./controls/rendering-controls-with-visual-styles.md)
- [<span data-ttu-id="b2019-175">如何：避免自動縮放來改善效能</span><span class="sxs-lookup"><span data-stu-id="b2019-175">How to: Improve Performance by Avoiding Automatic Scaling</span></span>](./advanced/how-to-improve-performance-by-avoiding-automatic-scaling.md)