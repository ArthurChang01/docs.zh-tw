---
title: Windows Form 中的拖放功能
ms.date: 03/30/2017
helpviewer_keywords:
- drag and drop [Windows Forms], Windows Forms
- Windows Forms, drag and drop
ms.assetid: 65cd2c03-8782-474e-b958-cbe43eeb902c
ms.openlocfilehash: b1189da9fa0b76ede3261cf6da5305a09147bba5
ms.sourcegitcommit: 3c1c3ba79895335ff3737934e39372555ca7d6d0
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/05/2018
ms.locfileid: "43786220"
---
# <a name="drag-and-drop-functionality-in-windows-forms"></a><span data-ttu-id="de844-102">Windows Form 中的拖放功能</span><span class="sxs-lookup"><span data-stu-id="de844-102">Drag-and-Drop Functionality in Windows Forms</span></span>
<span data-ttu-id="de844-103">Windows Form 包含一組實作拖放行為的方法、事件和類別。</span><span class="sxs-lookup"><span data-stu-id="de844-103">Windows Forms includes a set of methods, events, and classes that implement drag-and-drop behavior.</span></span> <span data-ttu-id="de844-104">本主題提供 Windows Form 中的拖放功能支援概觀。</span><span class="sxs-lookup"><span data-stu-id="de844-104">This topic provides an overview of the drag-and-drop support in Windows Forms.</span></span>  <span data-ttu-id="de844-105">另請參閱[拖放作業和剪貼簿支援](https://msdn.microsoft.com/library/fe5ebfwe\(v=vs.110\))。</span><span class="sxs-lookup"><span data-stu-id="de844-105">Also see [Drag-and-Drop Operations and Clipboard Support](https://msdn.microsoft.com/library/fe5ebfwe\(v=vs.110\)).</span></span>  
  
## <a name="performing-drag-and-drop-operations"></a><span data-ttu-id="de844-106">執行拖放作業</span><span class="sxs-lookup"><span data-stu-id="de844-106">Performing Drag-and-Drop Operations</span></span>  
 <span data-ttu-id="de844-107">若要執行拖放作業時，請使用 <xref:System.Windows.Forms.Control> 類別的 <xref:System.Windows.Forms.Control.DoDragDrop%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="de844-107">To perform a drag-and-drop operation, use the <xref:System.Windows.Forms.Control.DoDragDrop%2A> method of the <xref:System.Windows.Forms.Control> class.</span></span> <span data-ttu-id="de844-108">如需如何執行拖放作業的詳細資訊，請參閱 <xref:System.Windows.Forms.Control.DoDragDrop%2A>。</span><span class="sxs-lookup"><span data-stu-id="de844-108">For more information about how a drag-and-drop operation is performed, see <xref:System.Windows.Forms.Control.DoDragDrop%2A>.</span></span> <span data-ttu-id="de844-109">若要取得必須在開始拖放作業前先將滑鼠指標拖曳到其上的矩形，請使用 <xref:System.Windows.Forms.SystemInformation> 類別的 <xref:System.Windows.Forms.SystemInformation.DragSize%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="de844-109">To get the rectangle that the mouse pointer must be dragged over before a drag-and-drop operation begins, use the <xref:System.Windows.Forms.SystemInformation.DragSize%2A> property of the <xref:System.Windows.Forms.SystemInformation> class.</span></span>  
  
## <a name="events-related-to-drag-and-drop-operations"></a><span data-ttu-id="de844-110">與拖放作業相關的事件</span><span class="sxs-lookup"><span data-stu-id="de844-110">Events Related to Drag-and-Drop Operations</span></span>  
 <span data-ttu-id="de844-111">拖放作業包含兩類事件：拖放作業的目前目標所發生的事件，以及拖放作業的來源所發生的事件。</span><span class="sxs-lookup"><span data-stu-id="de844-111">There are two categories of events in a drag and drop operation: events that occur on the current target of the drag-and-drop operation, and events that occur on the source of the drag and drop operation.</span></span>  
  
### <a name="events-on-the-current-target"></a><span data-ttu-id="de844-112">目前目標所發生的事件</span><span class="sxs-lookup"><span data-stu-id="de844-112">Events on the Current Target</span></span>  
 <span data-ttu-id="de844-113">下表顯示拖放作業的目前目標所發生的事件。</span><span class="sxs-lookup"><span data-stu-id="de844-113">The following table shows the events that occur on the current target of a drag-and-drop operation.</span></span>  
  
|<span data-ttu-id="de844-114">滑鼠事件</span><span class="sxs-lookup"><span data-stu-id="de844-114">Mouse Event</span></span>|<span data-ttu-id="de844-115">描述</span><span class="sxs-lookup"><span data-stu-id="de844-115">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Windows.Forms.Control.DragEnter>|<span data-ttu-id="de844-116">這個事件會在將物件拖曳至控制項的界限內時發生。</span><span class="sxs-lookup"><span data-stu-id="de844-116">This event occurs when an object is dragged into the control's bounds.</span></span> <span data-ttu-id="de844-117">這個事件的處理常式會接收 <xref:System.Windows.Forms.DragEventArgs> 類型的引數。</span><span class="sxs-lookup"><span data-stu-id="de844-117">The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>.</span></span>|  
|<xref:System.Windows.Forms.Control.DragOver>|<span data-ttu-id="de844-118">這個事件會在滑鼠指標位於控制項界限內的情況下拖曳物件時發生。</span><span class="sxs-lookup"><span data-stu-id="de844-118">This event occurs when an object is dragged while the mouse pointer is within the control's bounds.</span></span> <span data-ttu-id="de844-119">這個事件的處理常式會接收 <xref:System.Windows.Forms.DragEventArgs> 類型的引數。</span><span class="sxs-lookup"><span data-stu-id="de844-119">The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>.</span></span>|  
|<xref:System.Windows.Forms.Control.DragDrop>|<span data-ttu-id="de844-120">這個事件會在拖放作業完成時發生。</span><span class="sxs-lookup"><span data-stu-id="de844-120">This event occurs when a drag-and-drop operation is completed.</span></span> <span data-ttu-id="de844-121">這個事件的處理常式會接收 <xref:System.Windows.Forms.DragEventArgs> 類型的引數。</span><span class="sxs-lookup"><span data-stu-id="de844-121">The handler for this event receives an argument of type <xref:System.Windows.Forms.DragEventArgs>.</span></span>|  
|<xref:System.Windows.Forms.Control.DragLeave>|<span data-ttu-id="de844-122">這個事件會在將物件拖曳出控制項的界限時發生。</span><span class="sxs-lookup"><span data-stu-id="de844-122">This event occurs when an object is dragged out of the control's bounds.</span></span> <span data-ttu-id="de844-123">這個事件的處理常式會接收 <xref:System.EventArgs> 類型的引數。</span><span class="sxs-lookup"><span data-stu-id="de844-123">The handler for this event receives an argument of type <xref:System.EventArgs>.</span></span>|  
  
 <span data-ttu-id="de844-124"><xref:System.Windows.Forms.DragEventArgs> 類別提供滑鼠指標的位置、滑鼠按鈕和鍵盤輔助按鍵的目前狀態、正在拖曳的資料，以及可指定拖曳事件來源所允許的作業和作業的目標置放效果的 <xref:System.Windows.Forms.DragDropEffects> 值。</span><span class="sxs-lookup"><span data-stu-id="de844-124">The <xref:System.Windows.Forms.DragEventArgs> class provides the location of the mouse pointer, the current state of the mouse buttons and modifier keys of the keyboard, the data being dragged, and <xref:System.Windows.Forms.DragDropEffects> values that specify the operations allowed by the source of the drag event and the target drop effect for the operation.</span></span>  
  
### <a name="events-on-the-source"></a><span data-ttu-id="de844-125">來源所發生的事件</span><span class="sxs-lookup"><span data-stu-id="de844-125">Events on the Source</span></span>  
 <span data-ttu-id="de844-126">下表顯示拖放作業的來源所發生的事件。</span><span class="sxs-lookup"><span data-stu-id="de844-126">The following table shows the events that occur on the source of the drag-and-drop operation.</span></span>  
  
|<span data-ttu-id="de844-127">滑鼠事件</span><span class="sxs-lookup"><span data-stu-id="de844-127">Mouse Event</span></span>|<span data-ttu-id="de844-128">描述</span><span class="sxs-lookup"><span data-stu-id="de844-128">Description</span></span>|  
|-----------------|-----------------|  
|<xref:System.Windows.Forms.Control.GiveFeedback>|<span data-ttu-id="de844-129">這個事件會在拖曳作業期間發生。</span><span class="sxs-lookup"><span data-stu-id="de844-129">This event occurs during a drag operation.</span></span> <span data-ttu-id="de844-130">它提供了一個可對正在發生拖放作業的使用者顯示視覺提示的機會，例如變更滑鼠指標。</span><span class="sxs-lookup"><span data-stu-id="de844-130">It provides an opportunity to give a visual cue to the user that the drag-and-drop operation is occurring, such as changing the mouse pointer.</span></span> <span data-ttu-id="de844-131">這個事件的處理常式會接收 <xref:System.Windows.Forms.GiveFeedbackEventArgs> 類型的引數。</span><span class="sxs-lookup"><span data-stu-id="de844-131">The handler for this event receives an argument of type <xref:System.Windows.Forms.GiveFeedbackEventArgs>.</span></span>|  
|<xref:System.Windows.Forms.Control.QueryContinueDrag>|<span data-ttu-id="de844-132">這個事件會在拖放作業期間引發，讓拖曳來源能夠決定是否應取消拖放作業。</span><span class="sxs-lookup"><span data-stu-id="de844-132">This event is raised during a drag-and-drop operation and enables the drag source to determine whether the drag-and-drop operation should be canceled.</span></span> <span data-ttu-id="de844-133">這個事件的處理常式會接收 <xref:System.Windows.Forms.QueryContinueDragEventArgs> 類型的引數。</span><span class="sxs-lookup"><span data-stu-id="de844-133">The handler for this event receives an argument of type <xref:System.Windows.Forms.QueryContinueDragEventArgs>.</span></span>|  
  
 <span data-ttu-id="de844-134"><xref:System.Windows.Forms.QueryContinueDragEventArgs> 類別提供滑鼠按鈕和鍵盤輔助按鍵的目前狀態、指定是否已按下 ESC 鍵的值，以及可設定以指定是否應該繼續拖放作業的 <xref:System.Windows.Forms.DragAction> 值。</span><span class="sxs-lookup"><span data-stu-id="de844-134">The <xref:System.Windows.Forms.QueryContinueDragEventArgs> class provides the current state of the mouse buttons and modifier keys of the keyboard, a value specifying whether the ESC key was pressed, and a <xref:System.Windows.Forms.DragAction> value that can be set to specify whether the drag-and-drop operation should continue.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="de844-135">另請參閱</span><span class="sxs-lookup"><span data-stu-id="de844-135">See Also</span></span>  
 [<span data-ttu-id="de844-136">Windows Forms 應用程式中的滑鼠輸入</span><span class="sxs-lookup"><span data-stu-id="de844-136">Mouse Input in a Windows Forms Application</span></span>](../../../docs/framework/winforms/mouse-input-in-a-windows-forms-application.md)
