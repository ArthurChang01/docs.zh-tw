---
title: UI 自動化樹狀目錄概觀
ms.date: 03/30/2017
helpviewer_keywords:
- automation tree
- UI Automation, tree
ms.assetid: 03b98058-bdb3-47a0-8ff7-45e6cdf67166
author: Xansky
ms.author: mhopkins
manager: markl
ms.openlocfilehash: 0823a569b19d46f32c1cb780470a935f20429c11
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33409119"
---
# <a name="ui-automation-tree-overview"></a><span data-ttu-id="3f478-102">UI 自動化樹狀目錄概觀</span><span class="sxs-lookup"><span data-stu-id="3f478-102">UI Automation Tree Overview</span></span>
> [!NOTE]
>  <span data-ttu-id="3f478-103">這份文件適用於想要使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 命名空間中定義之 Managed <xref:System.Windows.Automation> 類別的 .NET Framework 開發人員。</span><span class="sxs-lookup"><span data-stu-id="3f478-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="3f478-104">如需 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的最新資訊，請參閱 [Windows Automation API：使用者介面自動化](http://go.microsoft.com/fwlink/?LinkID=156746)。</span><span class="sxs-lookup"><span data-stu-id="3f478-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](http://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="3f478-105">輔助技術產品和測試指令碼會瀏覽[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀目錄中要收集的資訊[!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)]和其項目。</span><span class="sxs-lookup"><span data-stu-id="3f478-105">Assistive technology products and test scripts navigate the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree to gather information about the [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] and its elements.</span></span>  
  
 <span data-ttu-id="3f478-106">內[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀目錄中有為根元素 (<xref:System.Windows.Automation.AutomationElement.RootElement%2A>)，它代表目前的桌面，而其子項目代表應用程式視窗。</span><span class="sxs-lookup"><span data-stu-id="3f478-106">Within the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree there is a root element (<xref:System.Windows.Automation.AutomationElement.RootElement%2A>) that represents the current desktop and whose child elements represent application windows.</span></span> <span data-ttu-id="3f478-107">每個這些子元素可以包含項目代表項[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]例如功能表、 按鈕、 工具列和清單方塊。</span><span class="sxs-lookup"><span data-stu-id="3f478-107">Each of these child elements can contain elements representing pieces of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] such as menus, buttons, toolbars, and list boxes.</span></span> <span data-ttu-id="3f478-108">接著這些項目可以包含例如清單項目的項目。</span><span class="sxs-lookup"><span data-stu-id="3f478-108">These elements in turn can contain elements such as list items.</span></span>  
  
 <span data-ttu-id="3f478-109">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀結構是固定的結構並不很少完全看到它因為它可能包含數千個項目。</span><span class="sxs-lookup"><span data-stu-id="3f478-109">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree is not a fixed structure and is seldom seen in its totality because it might contain thousands of elements.</span></span> <span data-ttu-id="3f478-110">其中的部分會在需要時建置，且它可能隨著加入、移動或移除項目而發生變更。</span><span class="sxs-lookup"><span data-stu-id="3f478-110">Parts of it are built as they are needed, and it can undergo changes as elements are added, moved, or removed.</span></span>  
  
 <span data-ttu-id="3f478-111">UI 自動化提供者支援[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]所組成 （通常是裝載在視窗中） 的根目錄以及子樹狀結構片段內的項目間實作導覽樹狀目錄。</span><span class="sxs-lookup"><span data-stu-id="3f478-111">UI Automation providers support the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree by implementing navigation among items within a fragment, which consists of a root (usually hosted in a window) and a subtree.</span></span> <span data-ttu-id="3f478-112">不過，提供者並不涉及控制項之間的導覽。</span><span class="sxs-lookup"><span data-stu-id="3f478-112">However, providers are not concerned with navigation from one control to another.</span></span> <span data-ttu-id="3f478-113">這由管理[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]核心使用的預設視窗提供者的資訊。</span><span class="sxs-lookup"><span data-stu-id="3f478-113">This is managed by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] core, using information from the default window providers.</span></span>  
  
<a name="uiautomation_tree_view"></a>   
## <a name="views-of-the-automation-tree"></a><span data-ttu-id="3f478-114">自動化樹狀結構的檢視</span><span class="sxs-lookup"><span data-stu-id="3f478-114">Views of the Automation Tree</span></span>  
 <span data-ttu-id="3f478-115">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀可以進行篩選，建立只包含與檢視<xref:System.Windows.Automation.AutomationElement>特定用戶端相關的物件。</span><span class="sxs-lookup"><span data-stu-id="3f478-115">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree can be filtered to create views that contain only those <xref:System.Windows.Automation.AutomationElement> objects relevant for a particular client.</span></span> <span data-ttu-id="3f478-116">這個方法可讓用戶端自訂透過呈現的結構[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]特定需求。</span><span class="sxs-lookup"><span data-stu-id="3f478-116">This approach allows clients to customize the structure presented through [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to their particular needs.</span></span>  
  
 <span data-ttu-id="3f478-117">用戶端有兩種方式可自訂檢視：藉由範圍和篩選。</span><span class="sxs-lookup"><span data-stu-id="3f478-117">The client has two ways of customizing the view: by scoping and by filtering.</span></span> <span data-ttu-id="3f478-118">範圍會定義檢視的範圍，從基底項目開始：例如，應用程式可能只想要尋找桌面的直接子系，或是應用程式視窗的所有下階。</span><span class="sxs-lookup"><span data-stu-id="3f478-118">Scoping is defining the extent of the view, starting from a base element: for example, the application might want to find only direct children of the desktop, or all descendants of an application window.</span></span> <span data-ttu-id="3f478-119">篩選會定義要包含在檢視中的項目類型。</span><span class="sxs-lookup"><span data-stu-id="3f478-119">Filtering is defining the types of elements that are to be included in the view.</span></span>  
  
 <span data-ttu-id="3f478-120">使用者介面自動化提供者支援藉由在項目，包括定義屬性篩選<xref:System.Windows.Automation.AutomationElementIdentifiers.IsControlElementProperty>和<xref:System.Windows.Automation.AutomationElementIdentifiers.IsContentElementProperty>屬性。</span><span class="sxs-lookup"><span data-stu-id="3f478-120">UI Automation providers support filtering by defining properties on elements, including the <xref:System.Windows.Automation.AutomationElementIdentifiers.IsControlElementProperty> and <xref:System.Windows.Automation.AutomationElementIdentifiers.IsContentElementProperty> properties.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="3f478-121"> 提供三個預設檢視。</span><span class="sxs-lookup"><span data-stu-id="3f478-121"> provides three default views.</span></span> <span data-ttu-id="3f478-122">這些檢視是由執行的篩選類型所定義；任何檢視的範圍是由應用程式定義。</span><span class="sxs-lookup"><span data-stu-id="3f478-122">These views are defined by the type of filtering performed; the scope of any view is defined by the application.</span></span> <span data-ttu-id="3f478-123">此外，應用程式可以在屬性套用其他篩選；例如，只在控制項檢視中包含啟用的控制項。</span><span class="sxs-lookup"><span data-stu-id="3f478-123">In addition, the application can apply other filters on properties; for example, to include only enabled controls in a control view.</span></span>  
  
<a name="uiautomation_raw_view"></a>   
### <a name="raw-view"></a><span data-ttu-id="3f478-124">未經處理的檢視</span><span class="sxs-lookup"><span data-stu-id="3f478-124">Raw View</span></span>  
 <span data-ttu-id="3f478-125">未經處理檢視[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀結構會將完整樹狀結構的<xref:System.Windows.Automation.AutomationElement>桌面為其根目錄的物件。</span><span class="sxs-lookup"><span data-stu-id="3f478-125">The raw view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree is the full tree of <xref:System.Windows.Automation.AutomationElement> objects for which the desktop is the root.</span></span> <span data-ttu-id="3f478-126">未經處理的檢視會密切依循應用程式的原生程式設計結構，因此是最詳細的可用檢視。</span><span class="sxs-lookup"><span data-stu-id="3f478-126">The raw view closely follows the native programmatic structure of an application and therefore is the most detailed view available.</span></span> <span data-ttu-id="3f478-127">它也是樹狀結構其他檢視的建置基底。</span><span class="sxs-lookup"><span data-stu-id="3f478-127">It is also the base on which the other views of the tree are built.</span></span> <span data-ttu-id="3f478-128">因為此檢視相依於基礎[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]架構、 的未經處理檢視[!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)]按鈕會有不同的未經處理檢視比[!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="3f478-128">Because this view depends on the underlying [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] framework, the raw view of a [!INCLUDE[TLA2#tla_winclient](../../../includes/tla2sharptla-winclient-md.md)] button will have a different raw view than a [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] button.</span></span>  
  
 <span data-ttu-id="3f478-129">藉由搜尋未指定屬性的項目或使用取得的未經處理檢視<xref:System.Windows.Automation.TreeWalker.RawViewWalker>來導覽樹狀。</span><span class="sxs-lookup"><span data-stu-id="3f478-129">The raw view is obtained by searching for elements without specifying properties or by using the <xref:System.Windows.Automation.TreeWalker.RawViewWalker> to navigate the tree.</span></span>  
  
<a name="uiautomation_control_view"></a>   
### <a name="control-view"></a><span data-ttu-id="3f478-130">控制項檢視</span><span class="sxs-lookup"><span data-stu-id="3f478-130">Control View</span></span>  
 <span data-ttu-id="3f478-131">控制項檢閱[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀目錄中可簡化輔助技術產品的工作描述[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]以及協助終端使用者互動，與應用程式因為它密切地對應到[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]結構在終端使用者看得見。</span><span class="sxs-lookup"><span data-stu-id="3f478-131">The control view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree simplifies the assistive technology product's task of describing the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to the end user and helping that end user interact with the application because it closely maps to the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] structure perceived by an end user.</span></span>  
  
 <span data-ttu-id="3f478-132">控制項檢視是未經處理檢視的子集。</span><span class="sxs-lookup"><span data-stu-id="3f478-132">The control view is a subset of the raw view.</span></span> <span data-ttu-id="3f478-133">其包含所有[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]終端使用者瞭解為互動式或構成中控制項的邏輯結構的未經處理檢視中的項目[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="3f478-133">It includes all [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items from the raw view that an end user would understand as interactive or contributing to the logical structure of the control in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="3f478-134">範例[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]貢獻的邏輯結構的項目[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]，但不是互動式本身，例如清單檢視標頭、 工具列、 功能表和 [狀態] 列的項目容器。</span><span class="sxs-lookup"><span data-stu-id="3f478-134">Examples of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items that contribute to the logical structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)], but are not interactive themselves, are item containers such as list view headers, toolbars, menus, and the status bar.</span></span> <span data-ttu-id="3f478-135">只用於配置或裝飾性用途的非互動式項目都不會顯示在控制項檢視中。</span><span class="sxs-lookup"><span data-stu-id="3f478-135">Non-interactive items used simply for layout or decorative purposes will not be seen in the control view.</span></span> <span data-ttu-id="3f478-136">例如只用來配置對話方塊中的控制項面板，但是本身不含任何資訊。</span><span class="sxs-lookup"><span data-stu-id="3f478-136">An example is a panel that was used only to lay out the controls in a dialog but does not itself contain any information.</span></span> <span data-ttu-id="3f478-137">控制項檢視中會顯示的非互動式項目是對話方塊中具有資訊和靜態文字的圖形。</span><span class="sxs-lookup"><span data-stu-id="3f478-137">Non-interactive items that will be seen in the control view are graphics with information and static text in a dialog.</span></span> <span data-ttu-id="3f478-138">控制項檢視中所包含的非互動式項目無法接收鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="3f478-138">Non-interactive items that are included in the control view cannot receive keyboard focus.</span></span>  
  
 <span data-ttu-id="3f478-139">控制項檢視藉由搜尋有的項目取得<xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A>屬性設定為`true`，或使用<xref:System.Windows.Automation.TreeWalker.ControlViewWalker>來導覽樹狀。</span><span class="sxs-lookup"><span data-stu-id="3f478-139">The control view is obtained by searching for elements that have the <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsControlElement%2A> property set to `true`, or by using the <xref:System.Windows.Automation.TreeWalker.ControlViewWalker> to navigate the tree.</span></span>  
  
<a name="uiautomation_content_view"></a>   
### <a name="content-view"></a><span data-ttu-id="3f478-140">內容檢視</span><span class="sxs-lookup"><span data-stu-id="3f478-140">Content View</span></span>  
 <span data-ttu-id="3f478-141">內容檢視[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀結構是控制項檢視的子集。</span><span class="sxs-lookup"><span data-stu-id="3f478-141">The content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree is a subset of the control view.</span></span> <span data-ttu-id="3f478-142">它包含[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]傳達真實資訊的使用者介面中的項目包括[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]項目可接收鍵盤焦點時，在不是標籤一些文字[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]項目。</span><span class="sxs-lookup"><span data-stu-id="3f478-142">It contains [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items that convey the true information in a user interface, including [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items that can receive keyboard focus and some text that is not a label on a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] item.</span></span> <span data-ttu-id="3f478-143">例如，下拉式清單方塊中的值會出現在內容檢視中，因為它們代表使用者所使用的資訊。</span><span class="sxs-lookup"><span data-stu-id="3f478-143">For example, the values in a drop-down combo box will appear in the content view because they represent the information being used by an end user.</span></span> <span data-ttu-id="3f478-144">在內容檢視中，下拉式方塊和清單方塊都表示做為集合[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]項目可以在其中選取一個或多個項目。</span><span class="sxs-lookup"><span data-stu-id="3f478-144">In the content view, a combo box and list box are both represented as a collection of [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] items where one, or perhaps more than one, item can be selected.</span></span> <span data-ttu-id="3f478-145">在內容檢視中，一個一律開啟，一個可展開和摺疊的這項事實並沒有關係，因為它是設計來顯示要呈現給使用者的資料，或內容。</span><span class="sxs-lookup"><span data-stu-id="3f478-145">The fact that one is always open and one can expand and collapse is irrelevant in the content view because it is designed to show the data, or content, that is being presented to the user.</span></span>  
  
 <span data-ttu-id="3f478-146">內容檢視藉由搜尋有的項目取得<xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A>屬性設定為`true`，或使用<xref:System.Windows.Automation.TreeWalker.ContentViewWalker>來導覽樹狀。</span><span class="sxs-lookup"><span data-stu-id="3f478-146">The content view is obtained by searching for elements that have the <xref:System.Windows.Automation.AutomationElement.AutomationElementInformation.IsContentElement%2A> property set to `true`, or by using the <xref:System.Windows.Automation.TreeWalker.ContentViewWalker> to navigate the tree.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="3f478-147">另請參閱</span><span class="sxs-lookup"><span data-stu-id="3f478-147">See Also</span></span>  
 <xref:System.Windows.Automation.AutomationElement>  
 [<span data-ttu-id="3f478-148">UI 自動化概觀</span><span class="sxs-lookup"><span data-stu-id="3f478-148">UI Automation Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-overview.md)
