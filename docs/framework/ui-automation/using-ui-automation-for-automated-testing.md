---
title: 使用 UI 自動化進行自動化測試
ms.date: 03/30/2017
helpviewer_keywords:
- automated testing
- testing, UI Automation
- UI Automation, automated testing
ms.assetid: 3a0435c0-a791-4ad7-ba92-a4c1d1231fde
ms.openlocfilehash: 47cba2344071ecf9b85f4b0235e02ea88deb6498
ms.sourcegitcommit: eb9ff6f364cde6f11322e03800d8f5ce302f3c73
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/01/2019
ms.locfileid: "68710242"
---
# <a name="using-ui-automation-for-automated-testing"></a><span data-ttu-id="35d57-102">使用 UI 自動化進行自動化測試</span><span class="sxs-lookup"><span data-stu-id="35d57-102">Using UI Automation for Automated Testing</span></span>
> [!NOTE]
>  <span data-ttu-id="35d57-103">這份文件適用於想要使用 <xref:System.Windows.Automation> 命名空間中定義之 Managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 類別的 .NET Framework 開發人員。</span><span class="sxs-lookup"><span data-stu-id="35d57-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="35d57-104">如需的最新[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]資訊, [請參閱 Windows Automation API:使用者介面](https://go.microsoft.com/fwlink/?LinkID=156746)自動化。</span><span class="sxs-lookup"><span data-stu-id="35d57-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="35d57-105">本概觀說明 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 在自動化測試案例中做為程式設計存取的架構有何幫助。</span><span class="sxs-lookup"><span data-stu-id="35d57-105">This overview describes how [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] can be useful as a framework for programmatic access in automated testing scenarios.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="35d57-106">提供了一致的物件模型，可讓所有 [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] 架構透過可存取、輕鬆自動化的方式來公開複雜、豐富的功能。</span><span class="sxs-lookup"><span data-stu-id="35d57-106">provides a unified object model that enables all [!INCLUDE[TLA#tla_ui](../../../includes/tlasharptla-ui-md.md)] frameworks to expose complex and rich functionality in an accessible and easily automated manner.</span></span>  
  
 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="35d57-107">是做為 Microsoft Active Accessibility 的後繼開發。</span><span class="sxs-lookup"><span data-stu-id="35d57-107">was developed as a successor to Microsoft Active Accessibility.</span></span> <span data-ttu-id="35d57-108">Active Accessibility 是現有的架構, 其設計目的是要提供可存取控制項和應用程式的解決方案。</span><span class="sxs-lookup"><span data-stu-id="35d57-108">Active Accessibility is an existing framework designed to provide a solution for making controls and applications accessible.</span></span> <span data-ttu-id="35d57-109">Active Accessibility 不是以測試自動化為考慮, 即使由於存取性和自動化的需求非常類似, 但它仍會演變為該角色。</span><span class="sxs-lookup"><span data-stu-id="35d57-109">Active Accessibility was not designed with test automation in mind even though it evolved into that role due to the very similar requirements of accessibility and automation.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]<span data-ttu-id="35d57-110">除了提供更精細的協助工具方案之外，還特別設計來提供穩固的自動化測試功能。</span><span class="sxs-lookup"><span data-stu-id="35d57-110">, in addition to providing more refined solutions for accessibility, is also specifically designed to provide robust functionality for automated testing.</span></span> <span data-ttu-id="35d57-111">例如, Active Accessibility 依賴單一介面來公開 UI 的相關資訊, 並收集產品所需的資訊;[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]分隔這兩個模型。</span><span class="sxs-lookup"><span data-stu-id="35d57-111">For example, Active Accessibility relies on a single interface to both expose information about the UI and collect the information needed by AT products; [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] separates the two models.</span></span>  
  
 <span data-ttu-id="35d57-112">若要實作 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 讓它成為跟自動化測試工具一樣有用，就需要有提供者和用戶端。</span><span class="sxs-lookup"><span data-stu-id="35d57-112">Both a provider and client are required to implement [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] for it to be useful as an automated test tool.</span></span> <span data-ttu-id="35d57-113">使用者介面自動化提供者是應用程式，例如 Microsoft Word、Excel 和其他以 [!INCLUDE[TLA#tla_win](../../../includes/tlasharptla-win-md.md)] 作業系統為基礎的協力廠商應用程式或控制項。</span><span class="sxs-lookup"><span data-stu-id="35d57-113">UI Automation providers are applications such as Microsoft Word, Excel, and other third-party applications or controls based on the [!INCLUDE[TLA#tla_win](../../../includes/tlasharptla-win-md.md)] operating system.</span></span> <span data-ttu-id="35d57-114">使用者介面自動化用戶端則包括自動化測試指令碼和輔助技術應用程式。</span><span class="sxs-lookup"><span data-stu-id="35d57-114">UI Automation clients include automated test scripts and assistive technology applications.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="35d57-115">本概觀的用意是展示 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]全新和改善的自動化測試功能，</span><span class="sxs-lookup"><span data-stu-id="35d57-115">The intent of this overview is to showcase the new and improved automated testing capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span> <span data-ttu-id="35d57-116">並不會提供協助工具功能的資訊，除非必要，否則不會說明協助工具。</span><span class="sxs-lookup"><span data-stu-id="35d57-116">This overview is not intended to provide information on accessibility features and will not address accessibility other than where necessary.</span></span>  
  
<a name="Using_UI_Automation_During_Development"></a>   
## <a name="ui-automation-in-a-provider"></a><span data-ttu-id="35d57-117">提供者中的使用者介面自動化</span><span class="sxs-lookup"><span data-stu-id="35d57-117">UI Automation in a Provider</span></span>  
 <span data-ttu-id="35d57-118">若要讓 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 自動化，應用程式或控制項的開發人員必須查看使用者在使用標準鍵盤和滑鼠互動時，可以在 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 物件上執行哪些動作。</span><span class="sxs-lookup"><span data-stu-id="35d57-118">For a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] to be automated, a developer of an application or control must look at what actions an end-user can perform on the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] object using standard keyboard and mouse interaction.</span></span>  
  
 <span data-ttu-id="35d57-119">一旦識別出這些按鍵動作，就應該在控制項上實作對應的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 控制項模式 (也就是可鏡像 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 項目功能和行為的控制項模式)。</span><span class="sxs-lookup"><span data-stu-id="35d57-119">Once these key actions have been identified, the corresponding [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns (that is, the control patterns that mirror the functionality and behavior of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] element) should be implemented on the control.</span></span> <span data-ttu-id="35d57-120">例如，與下拉式方塊控制項 (例如執行對話方塊) 的使用者互動一般會涉及到展開及摺疊下拉式方塊，以隱藏或顯示項目清單、從該清單中選取項目，或透過鍵盤輸入加入新值。</span><span class="sxs-lookup"><span data-stu-id="35d57-120">For example, user interaction with a combo box control (such as the run dialog) typically involves expanding and collapsing the combo box to hide or display a list of items, selecting an item from that list, or adding a new value via keyboard input.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="35d57-121">藉由其他協助工具模式，開發人員必須直接從個別按鈕、功能或其他控制項收集資訊。</span><span class="sxs-lookup"><span data-stu-id="35d57-121">With other accessibility models, developers must gather information directly from individual buttons, menus, or other controls.</span></span> <span data-ttu-id="35d57-122">可惜的是，每種控制項類型都有許多次要變化。</span><span class="sxs-lookup"><span data-stu-id="35d57-122">Unfortunately, every control type comes in dozens of minor variations.</span></span> <span data-ttu-id="35d57-123">換句話說，即使按鈕的十個變化全都以相同方式運作，並執行相同功能，仍必須全都視為唯一的控制項。</span><span class="sxs-lookup"><span data-stu-id="35d57-123">In other words, even though ten variations of a pushbutton may all work the same way and perform the same function, they must all be treated as unique controls.</span></span> <span data-ttu-id="35d57-124">無法得知這些控制項是否功能對等。</span><span class="sxs-lookup"><span data-stu-id="35d57-124">There is no way to know that these controls are functionally equivalent.</span></span> <span data-ttu-id="35d57-125">開發控制項模式的目的就是為了呈現這些常見的控制項行為。</span><span class="sxs-lookup"><span data-stu-id="35d57-125">Control patterns were developed to represent these common control behaviors.</span></span> <span data-ttu-id="35d57-126">如需詳細資訊，請參閱 [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-126">For more information, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>  
  
<a name="Implementing_UI_Automation"></a>   
### <a name="implementing-ui-automation"></a><span data-ttu-id="35d57-127">實作使用者介面自動化</span><span class="sxs-lookup"><span data-stu-id="35d57-127">Implementing UI Automation</span></span>  
 <span data-ttu-id="35d57-128">如上所述，如果沒有 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]所提供的一致模型，測試工具和開發人員就必須知道架構特定的資訊，才能公開該架構中控制項的屬性和行為。</span><span class="sxs-lookup"><span data-stu-id="35d57-128">As mentioned earlier, without the unified model provided by [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], test tools and developers are required to know framework-specific information in order to expose properties and behaviors of controls in that framework.</span></span> <span data-ttu-id="35d57-129">由於 Windows 作業系統中的任何一次可能會有數個不同的 UI 架構, 包括[!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)]、 [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]和 Windows Presentation Foundation (WPF), 因此使用來測試多個應用程式可能是一項艱巨的工作看起來類似的控制項。</span><span class="sxs-lookup"><span data-stu-id="35d57-129">Since there can be several different UI frameworks present at any single time within Windows operating systems, including [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)], [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)], and Windows Presentation Foundation (WPF), it can be a daunting task to test multiple applications with controls that seem similar.</span></span> <span data-ttu-id="35d57-130">例如，下表列出擷取與按鈕控制項相關名稱 (或文字) 時所需的架構特定屬性名稱，並顯示單一對等的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 屬性。</span><span class="sxs-lookup"><span data-stu-id="35d57-130">For example, the following table outlines the framework-specific property names required to retrieve the name (or text) associated with a button control and shows the single equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property.</span></span>  
  
|<span data-ttu-id="35d57-131">使用者介面自動化控制項類型</span><span class="sxs-lookup"><span data-stu-id="35d57-131">UI Automation Control Type</span></span>|<span data-ttu-id="35d57-132">使用者介面架構</span><span class="sxs-lookup"><span data-stu-id="35d57-132">UI Framework</span></span>|<span data-ttu-id="35d57-133">架構特定的屬性</span><span class="sxs-lookup"><span data-stu-id="35d57-133">Framework Specific Property</span></span>|<span data-ttu-id="35d57-134">使用者介面自動化屬性</span><span class="sxs-lookup"><span data-stu-id="35d57-134">UI Automation Property</span></span>|  
|--------------------------------|------------------|---------------------------------|----------------------------|  
|<span data-ttu-id="35d57-135">按鈕</span><span class="sxs-lookup"><span data-stu-id="35d57-135">Button</span></span>|<span data-ttu-id="35d57-136">Windows Presentation Foundation</span><span class="sxs-lookup"><span data-stu-id="35d57-136">Windows Presentation Foundation</span></span>|<span data-ttu-id="35d57-137">內容</span><span class="sxs-lookup"><span data-stu-id="35d57-137">Content</span></span>|<span data-ttu-id="35d57-138">NameProperty</span><span class="sxs-lookup"><span data-stu-id="35d57-138">NameProperty</span></span>|  
|<span data-ttu-id="35d57-139">按鈕</span><span class="sxs-lookup"><span data-stu-id="35d57-139">Button</span></span>|<span data-ttu-id="35d57-140">Win32</span><span class="sxs-lookup"><span data-stu-id="35d57-140">Win32</span></span>|<span data-ttu-id="35d57-141">標題</span><span class="sxs-lookup"><span data-stu-id="35d57-141">Caption</span></span>|<span data-ttu-id="35d57-142">NameProperty</span><span class="sxs-lookup"><span data-stu-id="35d57-142">NameProperty</span></span>|  
|<span data-ttu-id="35d57-143">Image</span><span class="sxs-lookup"><span data-stu-id="35d57-143">Image</span></span>|<span data-ttu-id="35d57-144">HTML</span><span class="sxs-lookup"><span data-stu-id="35d57-144">HTML</span></span>|<span data-ttu-id="35d57-145">alt</span><span class="sxs-lookup"><span data-stu-id="35d57-145">alt</span></span>|<span data-ttu-id="35d57-146">NameProperty</span><span class="sxs-lookup"><span data-stu-id="35d57-146">NameProperty</span></span>|  
  
 <span data-ttu-id="35d57-147">使用者介面自動化提供者會負責將其控制項的架構特定屬性對應至對等的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 屬性。</span><span class="sxs-lookup"><span data-stu-id="35d57-147">UI Automation providers are responsible for mapping the framework-specific properties of their controls to the equivalent [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties.</span></span>  
  
 <span data-ttu-id="35d57-148">如需在提供者中實作 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 的詳細資訊，請參閱 [UI Automation Providers for Managed Code](../../../docs/framework/ui-automation/ui-automation-providers-for-managed-code.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-148">Information on implementing [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] in a provider can be found at [UI Automation Providers for Managed Code](../../../docs/framework/ui-automation/ui-automation-providers-for-managed-code.md).</span></span> <span data-ttu-id="35d57-149">如需實作控制項模式的詳細資訊，請參閱 [UI Automation Control Patterns](../../../docs/framework/ui-automation/ui-automation-control-patterns.md) 和 [UI Automation Text Pattern](../../../docs/framework/ui-automation/ui-automation-text-pattern.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-149">Information on implementing control patterns is available at [UI Automation Control Patterns](../../../docs/framework/ui-automation/ui-automation-control-patterns.md) and [UI Automation Text Pattern](../../../docs/framework/ui-automation/ui-automation-text-pattern.md).</span></span>  
  
<a name="Testing_with_UI_Automation"></a>   
## <a name="ui-automation-in-a-client"></a><span data-ttu-id="35d57-150">用戶端中的使用者介面自動化</span><span class="sxs-lookup"><span data-stu-id="35d57-150">UI Automation in a Client</span></span>  
 <span data-ttu-id="35d57-151">許多自動化測試工具和案例的目標是提供一致、可重複的使用者介面操作。</span><span class="sxs-lookup"><span data-stu-id="35d57-151">The goal of many automated test tools and scenarios is the consistent and repeatable manipulation of the user interface.</span></span> <span data-ttu-id="35d57-152">這可能涉及到特定控制項單元測試，一直到在一組控制項上反覆一連串動作的測試指令碼錄製及播放。</span><span class="sxs-lookup"><span data-stu-id="35d57-152">This can involve unit testing specific controls through to the recording and playback of test scripts that iterate through a series of generic actions on a group of controls.</span></span>  
  
 <span data-ttu-id="35d57-153">自動化應用程式的困難在於測試與動態目標的同步處理。</span><span class="sxs-lookup"><span data-stu-id="35d57-153">A complication that arises from automated applications is the difficulty synchronizing a test with a dynamic target.</span></span> <span data-ttu-id="35d57-154">例如，清單方塊控制項 (例如 Windows 工作管理員中所包含的控制項) 會顯示目前執行中應用程式的清單。</span><span class="sxs-lookup"><span data-stu-id="35d57-154">For example, a list box control, such as one contained in the Windows Task Manager, that displays a list of currently running applications.</span></span> <span data-ttu-id="35d57-155">因為該清單方塊中的項目是在測試應用程式的控制之外動態更新的，所以嘗試以任何一致性來重複清單方塊中的特定項目選取是不可能的。</span><span class="sxs-lookup"><span data-stu-id="35d57-155">Since the items in the list box are dynamically updated outside the control of the test application, attempting to repeat the selection of a specific item in the list box with any consistency is impossible.</span></span> <span data-ttu-id="35d57-156">在測試應用程式控制之外的 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 中嘗試簡單的焦點變更時，也會發生類似問題。</span><span class="sxs-lookup"><span data-stu-id="35d57-156">Similar issues can also arise when attempting to repeat simple focus changes in a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] that is outside the control of the test application.</span></span>  
  
<a name="Programmatic_Access"></a>   
### <a name="programmatic-access"></a><span data-ttu-id="35d57-157">以程式設計方式存取</span><span class="sxs-lookup"><span data-stu-id="35d57-157">Programmatic Access</span></span>  
 <span data-ttu-id="35d57-158">程式設計存取能夠透過程式碼，模擬由傳統滑鼠和鍵盤輸入所公開的任何互動和體驗。</span><span class="sxs-lookup"><span data-stu-id="35d57-158">Programmatic access provides the ability to imitate, through code, any interaction and experience exposed by traditional mouse and keyboard input.</span></span> [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="35d57-159">透過五個元件啟用程式設計存取：</span><span class="sxs-lookup"><span data-stu-id="35d57-159">enables programmatic access through five components:</span></span>  
  
- <span data-ttu-id="35d57-160">[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構有助於巡覽 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]的結構。</span><span class="sxs-lookup"><span data-stu-id="35d57-160">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree facilitates navigation through the structure of the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="35d57-161">此樹狀結構是由 hWnd 的集合建置而成。</span><span class="sxs-lookup"><span data-stu-id="35d57-161">The tree is built from the collection of hWnd's.</span></span> <span data-ttu-id="35d57-162">如需詳細資訊，請參閱 [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-162">For more information, see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)</span></span>  
  
- <span data-ttu-id="35d57-163">自動化項目是 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]中的個別元件。</span><span class="sxs-lookup"><span data-stu-id="35d57-163">Automation elements are individual components in the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="35d57-164">這些元件通常比 hWnd 更細微。</span><span class="sxs-lookup"><span data-stu-id="35d57-164">These can often be more granular than an hWnd.</span></span> <span data-ttu-id="35d57-165">如需詳細資訊，請參閱 [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-165">For more information, see [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md).</span></span>  
  
- <span data-ttu-id="35d57-166">自動化屬性提供了關於 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 項目的特定資訊。</span><span class="sxs-lookup"><span data-stu-id="35d57-166">Automation properties provide specific information about [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] elements.</span></span> <span data-ttu-id="35d57-167">如需詳細資訊，請參閱 [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-167">For more information, see [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).</span></span>  
  
- <span data-ttu-id="35d57-168">控制項模式定義控制項功能的特定層面，可以包含屬性、方法、事件和結構資訊。</span><span class="sxs-lookup"><span data-stu-id="35d57-168">Control patterns define a particular aspect of a control's functionality; they can consist of property, method, event, and structure information.</span></span> <span data-ttu-id="35d57-169">如需詳細資訊，請參閱 [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-169">For more information, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>  
  
- <span data-ttu-id="35d57-170">自動化事件會提供事件通知和資訊。</span><span class="sxs-lookup"><span data-stu-id="35d57-170">Automation events provide event notifications and information.</span></span> <span data-ttu-id="35d57-171">如需詳細資訊，請參閱 [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-171">For more information, see [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md).</span></span>  
  
<a name="Key_properties_critical_to_test_automation"></a>   
### <a name="key-properties-for-test-automation"></a><span data-ttu-id="35d57-172">測試自動化的主要屬性</span><span class="sxs-lookup"><span data-stu-id="35d57-172">Key Properties for Test Automation</span></span>  
 <span data-ttu-id="35d57-173">在 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 中唯一識別並後續找出任何控制項的能力，可以為要在該 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)]上操作的自動化測試應用程式提供基礎。</span><span class="sxs-lookup"><span data-stu-id="35d57-173">The ability to uniquely identify and subsequently locate any control within the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] provides the basis for automated test applications to operate on that [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="35d57-174">用戶端和提供者使用數個 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 屬性來輔助此項功能。</span><span class="sxs-lookup"><span data-stu-id="35d57-174">There are several [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] properties used by clients and providers that assist in this.</span></span>  
  
#### <a name="automationid"></a><span data-ttu-id="35d57-175">AutomationID</span><span class="sxs-lookup"><span data-stu-id="35d57-175">AutomationID</span></span>  
 <span data-ttu-id="35d57-176">在同層級之間以唯一的方式識別自動化項目。</span><span class="sxs-lookup"><span data-stu-id="35d57-176">Uniquely identifies an automation element from its siblings.</span></span> <span data-ttu-id="35d57-177"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> 並未當地語系化，與發行多國語言版本的產品時通常會當地語系化的屬性 (例如 <xref:System.Windows.Automation.AutomationElement.NameProperty> ) 不同。</span><span class="sxs-lookup"><span data-stu-id="35d57-177"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is not localized, unlike a property such as <xref:System.Windows.Automation.AutomationElement.NameProperty> that is typically localized if a product gets shipped in multiple languages.</span></span> <span data-ttu-id="35d57-178">請參閱 [Use the AutomationID Property](../../../docs/framework/ui-automation/use-the-automationid-property.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-178">See [Use the AutomationID Property](../../../docs/framework/ui-automation/use-the-automationid-property.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="35d57-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> 不保證整個自動化樹狀結構中的唯一識別。</span><span class="sxs-lookup"><span data-stu-id="35d57-179"><xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> does not guarantee a unique identity throughout the automation tree.</span></span> <span data-ttu-id="35d57-180">例如，應用程式可能會包含具有多個最上層功能表項目的功能表控制項，而這些項目也有多個子功能表項目。</span><span class="sxs-lookup"><span data-stu-id="35d57-180">For example, an application may contain a menu control with multiple top-level menu items that, in turn, have multiple child menu items.</span></span> <span data-ttu-id="35d57-181">這些次要功能表項目可由「項目 1」、「項目 2」、「項目 3」(依此類推) 之類的一般配置識別，因此最上層功能表項目的子系可以有重複識別項。</span><span class="sxs-lookup"><span data-stu-id="35d57-181">These secondary menu items may be identified by a generic scheme such as "Item1, Item 2, Item3, etc.", allowing duplicate identifiers for children across top-level menu items.</span></span>  
  
#### <a name="controltype"></a><span data-ttu-id="35d57-182">ControlType</span><span class="sxs-lookup"><span data-stu-id="35d57-182">ControlType</span></span>  
 <span data-ttu-id="35d57-183">識別自動化項目所代表的控制項類型。</span><span class="sxs-lookup"><span data-stu-id="35d57-183">Identifies the type of control represented by an automation element.</span></span> <span data-ttu-id="35d57-184">重要的資訊可以從對控制項類型的了解加以推斷。</span><span class="sxs-lookup"><span data-stu-id="35d57-184">Significant information can be inferred from knowledge of the control type.</span></span> <span data-ttu-id="35d57-185">請參閱 [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-185">See [UI Automation Control Types Overview](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md).</span></span>  
  
#### <a name="nameproperty"></a><span data-ttu-id="35d57-186">NameProperty</span><span class="sxs-lookup"><span data-stu-id="35d57-186">NameProperty</span></span>  
 <span data-ttu-id="35d57-187">這是識別或說明控制項的文字字串。</span><span class="sxs-lookup"><span data-stu-id="35d57-187">This is a text string that identifies or explains a control.</span></span> <span data-ttu-id="35d57-188">因為<xref:System.Windows.Automation.AutomationElement.NameProperty> 可以當地語系化，所以應小心使用。</span><span class="sxs-lookup"><span data-stu-id="35d57-188"><xref:System.Windows.Automation.AutomationElement.NameProperty> should be used with caution since it can be localized.</span></span> <span data-ttu-id="35d57-189">請參閱 [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-189">See [UI Automation Properties Overview](../../../docs/framework/ui-automation/ui-automation-properties-overview.md).</span></span>  
  
<a name="Steps_Required_To_Automate_the_UI_in_a_Test_Application"></a>   
### <a name="implementing-ui-automation-in-a-test-application"></a><span data-ttu-id="35d57-190">在測試應用程式中實作使用者介面自動化</span><span class="sxs-lookup"><span data-stu-id="35d57-190">Implementing UI Automation in a Test Application</span></span>  
  
|||  
|-|-|  
|<span data-ttu-id="35d57-191">加入使用者介面自動化參考。</span><span class="sxs-lookup"><span data-stu-id="35d57-191">Add the UI Automation References.</span></span>|<span data-ttu-id="35d57-192">以下列出使用者介面自動化用戶端所需的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] DLL。</span><span class="sxs-lookup"><span data-stu-id="35d57-192">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] dll's necessary for UI Automation clients are listed here.</span></span><br /><br /> <span data-ttu-id="35d57-193">-Uiautomationclient.dll 提供用戶端 api 的[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]存取權。</span><span class="sxs-lookup"><span data-stu-id="35d57-193">-   UIAutomationClient.dll provides access to the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] client-side APIs.</span></span><br /><span data-ttu-id="35d57-194">-Uiautomationclientsideprovider.dll 提供自動化[!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)]控制項的功能。</span><span class="sxs-lookup"><span data-stu-id="35d57-194">-   UIAutomationClientSideProvider.dll provides the ability to automate [!INCLUDE[TLA2#tla_win32](../../../includes/tla2sharptla-win32-md.md)] controls.</span></span> <span data-ttu-id="35d57-195">請參閱 [UI Automation Support for Standard Controls](../../../docs/framework/ui-automation/ui-automation-support-for-standard-controls.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-195">See [UI Automation Support for Standard Controls](../../../docs/framework/ui-automation/ui-automation-support-for-standard-controls.md).</span></span><br /><span data-ttu-id="35d57-196">-UIAutomationTypes 提供對中[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]所定義之特定類型的存取權。</span><span class="sxs-lookup"><span data-stu-id="35d57-196">-   UIAutomationTypes.dll provides access to the specific types defined in [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>|  
|<span data-ttu-id="35d57-197">加入 <xref:System.Windows.Automation> 命名空間。</span><span class="sxs-lookup"><span data-stu-id="35d57-197">Add the <xref:System.Windows.Automation> namespace.</span></span>|<span data-ttu-id="35d57-198">這個命名空間包含使用者介面自動化用戶端使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 功能 (文字處理除外) 時需要的所有要件。</span><span class="sxs-lookup"><span data-stu-id="35d57-198">This namespace contains everything UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] except text handling.</span></span>|  
|<span data-ttu-id="35d57-199">加入 <xref:System.Windows.Automation.Text> 命名空間。</span><span class="sxs-lookup"><span data-stu-id="35d57-199">Add the <xref:System.Windows.Automation.Text> namespace.</span></span>|<span data-ttu-id="35d57-200">這個命名空間包含使用者介面自動化用戶端使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 文字處理時需要的所有要件。</span><span class="sxs-lookup"><span data-stu-id="35d57-200">This namespace contains everything a UI Automation clients need to use the capabilities of [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] text handling.</span></span>|  
|<span data-ttu-id="35d57-201">尋找想要的控制項</span><span class="sxs-lookup"><span data-stu-id="35d57-201">Find controls of interest</span></span>|<span data-ttu-id="35d57-202">自動化測試指令碼會在自動化樹狀結構中尋找代表相關控制項的使用者介面自動化項目。</span><span class="sxs-lookup"><span data-stu-id="35d57-202">Automated test scripts locate UI Automation elements that represent controls of interest within the automation tree.</span></span><br /><br /> <span data-ttu-id="35d57-203">您可透過多種方式使用程式碼取得使用者介面自動化項目。</span><span class="sxs-lookup"><span data-stu-id="35d57-203">There are multiple ways to obtain UI Automation elements with code.</span></span><br /><br /> <span data-ttu-id="35d57-204">[!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] -<xref:System.Windows.Automation.Condition>使用語句來查詢。</span><span class="sxs-lookup"><span data-stu-id="35d57-204">-   Query the [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] using a <xref:System.Windows.Automation.Condition> statement.</span></span> <span data-ttu-id="35d57-205">通常會在此使用語言中性的 <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> 。</span><span class="sxs-lookup"><span data-stu-id="35d57-205">This is typically where the language-neutral <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> is used.</span></span> <span data-ttu-id="35d57-206">**注意：** 可以使用工具 (例如, 可將控制項的[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]屬性一併組成的檢查) 來取得。 <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty></span><span class="sxs-lookup"><span data-stu-id="35d57-206">**Note:**  An <xref:System.Windows.Automation.AutomationElement.AutomationIdProperty> can be obtained using a tool such as Inspect.exe that is able to itemize the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties of a control.</span></span> <br /><br /> <span data-ttu-id="35d57-207">-使用<xref:System.Windows.Automation.TreeWalker>類別來跨越整個[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]樹狀結構或其子集。</span><span class="sxs-lookup"><span data-stu-id="35d57-207">-   Use the <xref:System.Windows.Automation.TreeWalker> class to traverse the entire [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree or a subset thereof.</span></span><br /><span data-ttu-id="35d57-208">-追蹤焦點。</span><span class="sxs-lookup"><span data-stu-id="35d57-208">-   Track focus.</span></span><br /><span data-ttu-id="35d57-209">-使用控制項的 hWnd。</span><span class="sxs-lookup"><span data-stu-id="35d57-209">-   Use the hWnd of the control.</span></span><br /><span data-ttu-id="35d57-210">-使用螢幕位置, 例如滑鼠游標的位置。</span><span class="sxs-lookup"><span data-stu-id="35d57-210">-   Use screen location, such as the location of the mouse cursor.</span></span><br /><br /> <span data-ttu-id="35d57-211">請參閱 [Obtaining UI Automation Elements](../../../docs/framework/ui-automation/obtaining-ui-automation-elements.md)</span><span class="sxs-lookup"><span data-stu-id="35d57-211">See [Obtaining UI Automation Elements](../../../docs/framework/ui-automation/obtaining-ui-automation-elements.md)</span></span>|  
|<span data-ttu-id="35d57-212">取得控制項模式</span><span class="sxs-lookup"><span data-stu-id="35d57-212">Obtain Control Patterns</span></span>|<span data-ttu-id="35d57-213">控制項模式會公開功能類似之控制項的一般行為。</span><span class="sxs-lookup"><span data-stu-id="35d57-213">Control patterns expose common behaviors for functionally similar controls.</span></span><br /><br /> <span data-ttu-id="35d57-214">找到需要測試的控制項之後，自動化測試指令碼會從這些使用者介面自動化項目中取得想要的控制項模式。</span><span class="sxs-lookup"><span data-stu-id="35d57-214">After locating the controls that require testing, automated test scripts obtain the control patterns of interest from those UI Automation elements.</span></span> <span data-ttu-id="35d57-215">例如，代表一般按鈕功能的 <xref:System.Windows.Automation.InvokePattern> 控制項模式，或是代表視窗功能的 <xref:System.Windows.Automation.WindowPattern> 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="35d57-215">For example, the <xref:System.Windows.Automation.InvokePattern> control pattern for typical button functionality or the <xref:System.Windows.Automation.WindowPattern> control pattern for window functionality.</span></span><br /><br /> <span data-ttu-id="35d57-216">請參閱 [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-216">See [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>|  
|<span data-ttu-id="35d57-217">自動化使用者介面</span><span class="sxs-lookup"><span data-stu-id="35d57-217">Automate the UI</span></span>|<span data-ttu-id="35d57-218">自動化測試指令碼現在可以使用 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 控制項模式公開的資訊和功能，從 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 架構中控制想要的任何 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 。</span><span class="sxs-lookup"><span data-stu-id="35d57-218">Automated test scripts can now control any [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] of interest from a [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] framework using the information and functionality exposed by the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] control patterns.</span></span>|  
  
<a name="Supporting_tools"></a>   
## <a name="related-tools-and-technologies"></a><span data-ttu-id="35d57-219">相關工具和技術</span><span class="sxs-lookup"><span data-stu-id="35d57-219">Related Tools and Technologies</span></span>  
 <span data-ttu-id="35d57-220">有一些相關工具和技術會支援使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]來進行自動化測試。</span><span class="sxs-lookup"><span data-stu-id="35d57-220">There are a number of related tools and technologies that support automated testing with [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
- <span data-ttu-id="35d57-221">檢查 .exe 是圖形化使用者介面 (GUI) 應用程式, 可以用來收集[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]提供者和用戶端開發和偵錯工具的資訊。</span><span class="sxs-lookup"><span data-stu-id="35d57-221">Inspect.exe is a graphical user interface (GUI) application that can be used to gather [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information for both provider and client development and debugging.</span></span> <span data-ttu-id="35d57-222">檢查 .exe 已包含在中[!INCLUDE[TLA#tla_winfxsdk](../../../includes/tlasharptla-winfxsdk-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="35d57-222">Inspect.exe is included in the [!INCLUDE[TLA#tla_winfxsdk](../../../includes/tlasharptla-winfxsdk-md.md)].</span></span>  
  
- <span data-ttu-id="35d57-223">MSAABridge 會[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]將資訊公開給 Active Accessibility 的用戶端。</span><span class="sxs-lookup"><span data-stu-id="35d57-223">MSAABridge exposes [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] information to Active Accessibility clients.</span></span> <span data-ttu-id="35d57-224">橋接[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]到 Active Accessibility 的主要目標是要讓現有的 Active Accessibility 用戶端能夠與任何已執行[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]的架構進行互動。</span><span class="sxs-lookup"><span data-stu-id="35d57-224">The primary goal of bridging [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] to Active Accessibility is to allow existing Active Accessibility clients the ability to interact with any framework that has implemented [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)].</span></span>  
  
<a name="Security"></a>   
## <a name="security"></a><span data-ttu-id="35d57-225">安全性</span><span class="sxs-lookup"><span data-stu-id="35d57-225">Security</span></span>  
 <span data-ttu-id="35d57-226">如需安全性資訊，請參閱 [UI Automation Security Overview](../../../docs/framework/ui-automation/ui-automation-security-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="35d57-226">For security information, see [UI Automation Security Overview](../../../docs/framework/ui-automation/ui-automation-security-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="35d57-227">另請參閱</span><span class="sxs-lookup"><span data-stu-id="35d57-227">See also</span></span>

- [<span data-ttu-id="35d57-228">使用者介面自動化基礎觀念</span><span class="sxs-lookup"><span data-stu-id="35d57-228">UI Automation Fundamentals</span></span>](../../../docs/framework/ui-automation/index.md)
