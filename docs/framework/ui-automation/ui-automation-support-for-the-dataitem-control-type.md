---
title: DataItem 控制項類型的 UI 自動化支援
ms.date: 03/30/2017
helpviewer_keywords:
- UI Automation, Data Item control type
- Data Item control type
- control types, Data Item
ms.assetid: 181708fd-2595-4c43-9abd-75811627d64c
ms.openlocfilehash: 6263d7777becc1042cf477503c7f68af29fa7f4c
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/18/2019
ms.locfileid: "59125207"
---
# <a name="ui-automation-support-for-the-dataitem-control-type"></a><span data-ttu-id="63fe9-102">DataItem 控制項類型的 UI 自動化支援</span><span class="sxs-lookup"><span data-stu-id="63fe9-102">UI Automation Support for the DataItem Control Type</span></span>
> [!NOTE]
>  <span data-ttu-id="63fe9-103">這份文件適用於想要使用 <xref:System.Windows.Automation> 命名空間中定義之 Managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 類別的 .NET Framework 開發人員。</span><span class="sxs-lookup"><span data-stu-id="63fe9-103">This documentation is intended for .NET Framework developers who want to use the managed [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] classes defined in the <xref:System.Windows.Automation> namespace.</span></span> <span data-ttu-id="63fe9-104">如需最新資訊[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)]，請參閱[Windows Automation API:使用者介面自動化](https://go.microsoft.com/fwlink/?LinkID=156746)。</span><span class="sxs-lookup"><span data-stu-id="63fe9-104">For the latest information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)], see [Windows Automation API: UI Automation](https://go.microsoft.com/fwlink/?LinkID=156746).</span></span>  
  
 <span data-ttu-id="63fe9-105">本主題提供 DataItem 控制項類型的 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 支援相關資訊。</span><span class="sxs-lookup"><span data-stu-id="63fe9-105">This topic provides information about [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] support for the DataItem control type.</span></span> <span data-ttu-id="63fe9-106">在 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 中，控制項類型是一組控制項條件，控制項必須符合條件才能使用 <xref:System.Windows.Automation.AutomationElement.ControlTypeProperty> 屬性。</span><span class="sxs-lookup"><span data-stu-id="63fe9-106">In [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] a control type is a set of conditions that a control must meet in order to use the <xref:System.Windows.Automation.AutomationElement.ControlTypeProperty> property.</span></span> <span data-ttu-id="63fe9-107">這些條件包括 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構、 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 屬性值和控制項模式的特定方針。</span><span class="sxs-lookup"><span data-stu-id="63fe9-107">The conditions include specific guidelines for [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree structure, [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] property values and control patterns.</span></span>  
  
 <span data-ttu-id="63fe9-108">連絡人清單中的項目即是資料項目控制項的範例。</span><span class="sxs-lookup"><span data-stu-id="63fe9-108">An entry in a Contacts list is an example of a data item control.</span></span> <span data-ttu-id="63fe9-109">資料項目控制項包含與使用者相關的資訊。</span><span class="sxs-lookup"><span data-stu-id="63fe9-109">A data item control contains information that is of interest to an end user.</span></span> <span data-ttu-id="63fe9-110">由於包含更為豐富的資訊，這種控制項比簡單的清單項目複雜。</span><span class="sxs-lookup"><span data-stu-id="63fe9-110">It is more complicated than the simple list item because it contains richer information.</span></span>  
  
 <span data-ttu-id="63fe9-111">下列章節會定義 DataItem 控制項類型所需的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構、屬性、控制項模式和事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-111">The following sections define the required [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree structure, properties, control patterns, and events for the DataItem control type.</span></span> <span data-ttu-id="63fe9-112">無論是 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 、 [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)]或 [!INCLUDE[TLA#tla_win32](../../../includes/tlasharptla-win32-md.md)]， [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)]需求都適用於所有資料項目控制項。</span><span class="sxs-lookup"><span data-stu-id="63fe9-112">The [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] requirements apply to all data item controls, whether [!INCLUDE[TLA#tla_winclient](../../../includes/tlasharptla-winclient-md.md)], [!INCLUDE[TLA#tla_win32](../../../includes/tlasharptla-win32-md.md)], or [!INCLUDE[TLA#tla_winforms](../../../includes/tlasharptla-winforms-md.md)].</span></span>  
  
<a name="Required_UI_Automation_Tree_Structure"></a>   
## <a name="required-ui-automation-tree-structure"></a><span data-ttu-id="63fe9-113">必要的使用者介面自動化樹狀結構</span><span class="sxs-lookup"><span data-stu-id="63fe9-113">Required UI Automation Tree Structure</span></span>  
 <span data-ttu-id="63fe9-114">下表描述與資料項目控制項相關之 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構的控制項檢視和內容檢視，並說明各檢視中可包含的內容。</span><span class="sxs-lookup"><span data-stu-id="63fe9-114">The following table depicts the control view and the content view of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree that pertains to data item controls and describes what can be contained in each view.</span></span> <span data-ttu-id="63fe9-115">如需 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構的詳細資訊，請參閱 [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="63fe9-115">For more information about the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree, see [UI Automation Tree Overview](../../../docs/framework/ui-automation/ui-automation-tree-overview.md).</span></span>  
  
|[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="63fe9-116">樹狀結構 - 控制項檢視</span><span class="sxs-lookup"><span data-stu-id="63fe9-116">Tree - Control View</span></span>|[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="63fe9-117">樹狀結構 - 內容檢視</span><span class="sxs-lookup"><span data-stu-id="63fe9-117">Tree - Content View</span></span>|  
|------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="63fe9-118">DataItem</span><span class="sxs-lookup"><span data-stu-id="63fe9-118">DataItem</span></span><br /><br /> <span data-ttu-id="63fe9-119">-而有所不同 (0 個以上; 可以結構化為階層)</span><span class="sxs-lookup"><span data-stu-id="63fe9-119">-   Varies (0 or more; can be structured in hierarchy)</span></span>|<span data-ttu-id="63fe9-120">DataItem</span><span class="sxs-lookup"><span data-stu-id="63fe9-120">DataItem</span></span><br /><br /> <span data-ttu-id="63fe9-121">-而有所不同 (0 個以上; 可以結構化為階層)</span><span class="sxs-lookup"><span data-stu-id="63fe9-121">-   Varies (0 or more; can be structured in hierarchy)</span></span>|  
  
 <span data-ttu-id="63fe9-122">資料格中資料項目 (Item) 的項目 (Element) 可裝載各種不同的物件，包括另一層資料項目，或是特定資料格項目 (Element) 如文字、影像或編輯控制項。</span><span class="sxs-lookup"><span data-stu-id="63fe9-122">A data item element in a data grid can host a variety of objects, including another layer of data items, or specific grid elements such as text, images, or edit controls.</span></span> <span data-ttu-id="63fe9-123">如果資料項目 (Item) 的項目 (Element) 具備特定物件角色，則該項目 (Element) 應公開為特定控制項類型；例如，資料格中可選資料項目 (Item) 的 ListItem 控制項類型。</span><span class="sxs-lookup"><span data-stu-id="63fe9-123">If the data item element has a specific object role, the element should be exposed as a specific control type; for example, a ListItem control type for a selectable data item in the grid.</span></span>  
  
<a name="Required_UI_Automation_Properties"></a>   
## <a name="required-ui-automation-properties"></a><span data-ttu-id="63fe9-124">必要的使用者介面自動化屬性</span><span class="sxs-lookup"><span data-stu-id="63fe9-124">Required UI Automation Properties</span></span>  
 <span data-ttu-id="63fe9-125">下表列出屬性，其值或定義與資料項目控制項特別有關。</span><span class="sxs-lookup"><span data-stu-id="63fe9-125">The following table lists the properties whose value or definition is especially relevant to data item controls.</span></span> <span data-ttu-id="63fe9-126">如需 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 屬性的詳細資訊，請參閱 [UI Automation Properties for Clients](../../../docs/framework/ui-automation/ui-automation-properties-for-clients.md)。</span><span class="sxs-lookup"><span data-stu-id="63fe9-126">For more information about [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] properties, see [UI Automation Properties for Clients](../../../docs/framework/ui-automation/ui-automation-properties-for-clients.md).</span></span>  
  
|<span data-ttu-id="63fe9-127">屬性</span><span class="sxs-lookup"><span data-stu-id="63fe9-127">Property</span></span>|<span data-ttu-id="63fe9-128">值</span><span class="sxs-lookup"><span data-stu-id="63fe9-128">Value</span></span>|<span data-ttu-id="63fe9-129">注意</span><span class="sxs-lookup"><span data-stu-id="63fe9-129">Notes</span></span>|  
|--------------|-----------|-----------|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.AutomationIdProperty>|<span data-ttu-id="63fe9-130">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-130">See notes.</span></span>|<span data-ttu-id="63fe9-131">此屬性的值在應用程式中的所有控制項都不得重複。</span><span class="sxs-lookup"><span data-stu-id="63fe9-131">The value of this property needs to be unique across all controls in an application.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty>|<span data-ttu-id="63fe9-132">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-132">See notes.</span></span>|<span data-ttu-id="63fe9-133">包含整個控制項的最外層矩形。</span><span class="sxs-lookup"><span data-stu-id="63fe9-133">The outermost rectangle that contains the whole control.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.ClickablePointProperty>|<span data-ttu-id="63fe9-134">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-134">See notes.</span></span>|<span data-ttu-id="63fe9-135">如果有週框即受支援。</span><span class="sxs-lookup"><span data-stu-id="63fe9-135">Supported if there is a bounding rectangle.</span></span> <span data-ttu-id="63fe9-136">如果週框中沒有任何可點選的點，而且您執行的是特殊化點擊測試，則會覆寫並提供可點選的點。</span><span class="sxs-lookup"><span data-stu-id="63fe9-136">If not every point within the bounding rectangle is clickable, and you perform specialized hit testing, then override and provide a clickable point.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.ControlTypeProperty>|<span data-ttu-id="63fe9-137">DataItem</span><span class="sxs-lookup"><span data-stu-id="63fe9-137">DataItem</span></span>|<span data-ttu-id="63fe9-138">此值與所有使用者介面架構的值相同。</span><span class="sxs-lookup"><span data-stu-id="63fe9-138">This value is the same for all UI frameworks.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.IsContentElementProperty>|<span data-ttu-id="63fe9-139">True</span><span class="sxs-lookup"><span data-stu-id="63fe9-139">True</span></span>|<span data-ttu-id="63fe9-140">資料項目控制項必須一律為內容。</span><span class="sxs-lookup"><span data-stu-id="63fe9-140">The data item control must always be content.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.IsControlElementProperty>|<span data-ttu-id="63fe9-141">True</span><span class="sxs-lookup"><span data-stu-id="63fe9-141">True</span></span>|<span data-ttu-id="63fe9-142">資料項目控制項必須一律為控制項。</span><span class="sxs-lookup"><span data-stu-id="63fe9-142">The data item control must always be a control.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.IsKeyboardFocusableProperty>|<span data-ttu-id="63fe9-143">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-143">See notes.</span></span>|<span data-ttu-id="63fe9-144">如果控制項可接收鍵盤焦點，就必定支援此屬性。</span><span class="sxs-lookup"><span data-stu-id="63fe9-144">If the control can receive keyboard focus, it must support this property.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.ItemStatusProperty>|<span data-ttu-id="63fe9-145">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-145">See notes.</span></span>|<span data-ttu-id="63fe9-146">如果控制項包含動態更新的狀態，則必須支援此屬性，使輔助技術得以在項目的狀態變更時接收更新。</span><span class="sxs-lookup"><span data-stu-id="63fe9-146">If the control contains status that is being updated dynamically then this property must be supported so that an assistive technology can receive updates when the status of the element changes.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.ItemTypeProperty>|<span data-ttu-id="63fe9-147">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-147">See notes.</span></span>|<span data-ttu-id="63fe9-148">這個字串值可讓使用者知道項目所代表的物件為何。</span><span class="sxs-lookup"><span data-stu-id="63fe9-148">This is the string value that conveys to the end user the underlying object that the item represents.</span></span> <span data-ttu-id="63fe9-149">例如「媒體檔案」或「連絡人」。</span><span class="sxs-lookup"><span data-stu-id="63fe9-149">Examples are "Media File" or "Contact".</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.LabeledByProperty>|`Null`|<span data-ttu-id="63fe9-150">資料項目控制項沒有靜態文字標籤。</span><span class="sxs-lookup"><span data-stu-id="63fe9-150">Data item controls do not have a static text label.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.LocalizedControlTypeProperty>|<span data-ttu-id="63fe9-151">「資料項目」</span><span class="sxs-lookup"><span data-stu-id="63fe9-151">"data item"</span></span>|<span data-ttu-id="63fe9-152">對應到 DataItem 控制項類型的當地語系化字串。</span><span class="sxs-lookup"><span data-stu-id="63fe9-152">Localized string corresponding to the DataItem control type.</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty>|<span data-ttu-id="63fe9-153">請參閱備註。</span><span class="sxs-lookup"><span data-stu-id="63fe9-153">See notes.</span></span>|<span data-ttu-id="63fe9-154">資料項目控制項一律會包含主要文字項目，這是最富語意的識別項，可讓使用者聯想該項目。</span><span class="sxs-lookup"><span data-stu-id="63fe9-154">The data item control always contains a primary text element that relates to what the user would associate as the most semantic identifier for the item.</span></span>|  
  
<a name="_Required_UI_Automation_Control_Patterns"></a>   
## <a name="required-ui-automation-control-patterns"></a><span data-ttu-id="63fe9-155">必要的使用者介面自動化控制項模式</span><span class="sxs-lookup"><span data-stu-id="63fe9-155">Required UI Automation Control Patterns</span></span>  
 <span data-ttu-id="63fe9-156">下表列出所有資料項目控制項必須支援的 [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="63fe9-156">The following table lists the [!INCLUDE[TLA#tla_uiautomation](../../../includes/tlasharptla-uiautomation-md.md)] control patterns required to be supported by all data item controls.</span></span> <span data-ttu-id="63fe9-157">如需控制項模式的詳細資訊，請參閱 [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="63fe9-157">For more information about control patterns, see [UI Automation Control Patterns Overview](../../../docs/framework/ui-automation/ui-automation-control-patterns-overview.md).</span></span>  
  
|<span data-ttu-id="63fe9-158">控制項模式</span><span class="sxs-lookup"><span data-stu-id="63fe9-158">Control Pattern</span></span>|<span data-ttu-id="63fe9-159">支援</span><span class="sxs-lookup"><span data-stu-id="63fe9-159">Support</span></span>|<span data-ttu-id="63fe9-160">注意</span><span class="sxs-lookup"><span data-stu-id="63fe9-160">Notes</span></span>|  
|---------------------|-------------|-----------|  
|<xref:System.Windows.Automation.Provider.IExpandCollapseProvider>|<span data-ttu-id="63fe9-161">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-161">Depends</span></span>|<span data-ttu-id="63fe9-162">如果資料項目可以展開或摺疊來顯示和隱藏資訊，則必須支援展開摺疊模式。</span><span class="sxs-lookup"><span data-stu-id="63fe9-162">If the data item can be expanded or collapsed to show and hide information, the Expand Collapse pattern must be supported.</span></span>|  
|<xref:System.Windows.Automation.Provider.IGridItemProvider>|<span data-ttu-id="63fe9-163">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-163">Depends</span></span>|<span data-ttu-id="63fe9-164">當容器內包含一組資料項目，可以在空間上逐一巡覽項目時，資料項目將會支援方格項目模式。</span><span class="sxs-lookup"><span data-stu-id="63fe9-164">Data items will support the Grid Item pattern when a collection of data items is available within a container that can be spatially navigated item-to-item.</span></span>|  
|<xref:System.Windows.Automation.Provider.IScrollItemProvider>|<span data-ttu-id="63fe9-165">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-165">Depends</span></span>|<span data-ttu-id="63fe9-166">當資料容器有太多項目，無法一次顯示在螢幕上時，所有資料項目會支援捲動項目模式的捲動檢視功能。</span><span class="sxs-lookup"><span data-stu-id="63fe9-166">All data items support the ability to be scrolled into view with the Scroll Item pattern when their data container has more items than can fit on the screen.</span></span>|  
|<xref:System.Windows.Automation.Provider.ISelectionItemProvider>|<span data-ttu-id="63fe9-167">是</span><span class="sxs-lookup"><span data-stu-id="63fe9-167">Yes</span></span>|<span data-ttu-id="63fe9-168">所有資料項目必須支援選取項目模式，表示已選取項目。</span><span class="sxs-lookup"><span data-stu-id="63fe9-168">All data items must support the Selection Item pattern to indicate when the item is selected.</span></span>|  
|<xref:System.Windows.Automation.Provider.ITableItemProvider>|<span data-ttu-id="63fe9-169">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-169">Depends</span></span>|<span data-ttu-id="63fe9-170">如果資料項目包含在資料格控制項類型內，則會支援此模式。</span><span class="sxs-lookup"><span data-stu-id="63fe9-170">If the data item is contained within a Data Grid control type then it will support this pattern.</span></span>|  
|<xref:System.Windows.Automation.Provider.IToggleProvider>|<span data-ttu-id="63fe9-171">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-171">Depends</span></span>|<span data-ttu-id="63fe9-172">如果資料項目包含可循環的狀態。</span><span class="sxs-lookup"><span data-stu-id="63fe9-172">If the data item contains a state that can be cycled through.</span></span>|  
|<xref:System.Windows.Automation.Provider.IValueProvider>|<span data-ttu-id="63fe9-173">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-173">Depends</span></span>|<span data-ttu-id="63fe9-174">如果資料項目的主要文字可以編輯，則必須支援值模式。</span><span class="sxs-lookup"><span data-stu-id="63fe9-174">If the data item's primary text is editable then the Value pattern must be supported.</span></span>|  
  
<a name="Working_with_Data_Items_in_Large_Lists"></a>   
## <a name="working-with-data-items-in-large-lists"></a><span data-ttu-id="63fe9-175">在大型清單中使用資料項目</span><span class="sxs-lookup"><span data-stu-id="63fe9-175">Working with Data Items in Large Lists</span></span>  
 <span data-ttu-id="63fe9-176">為提高效能，大型清單在 [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] 架構中通常會將資料虛擬化。</span><span class="sxs-lookup"><span data-stu-id="63fe9-176">Large lists are often data virtualized within [!INCLUDE[TLA2#tla_ui](../../../includes/tla2sharptla-ui-md.md)] frameworks to assist in performance.</span></span> <span data-ttu-id="63fe9-177">因此，使用者介面自動化用戶端無法像在其他項目容器一樣，使用 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 查詢功能將完整樹狀結構的內容集中顯示在一起。</span><span class="sxs-lookup"><span data-stu-id="63fe9-177">Due to this, a UI Automation client cannot use the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] query feature to scrape the contents of the full tree in the same way that it can in other item containers.</span></span> <span data-ttu-id="63fe9-178">用戶端應將項目設為捲動檢視 (或展開控制項以顯示所有有用的選項)，才能從資料項目存取完整的資訊。</span><span class="sxs-lookup"><span data-stu-id="63fe9-178">A client should scroll the item into view (or expand the control to show all valuable options)prior to accessing the full set of information from the data item.</span></span>  
  
 <span data-ttu-id="63fe9-179">在資料項目的 `SetFocus` 自動化項目上呼叫 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 時， [!INCLUDE[TLA#tla_winexpl](../../../includes/tlasharptla-winexpl-md.md)] 會將焦點成功傳回資料項目樹狀子目錄中並設為 Edit。</span><span class="sxs-lookup"><span data-stu-id="63fe9-179">When calling `SetFocus` on the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] element for the data item, the [!INCLUDE[TLA#tla_winexpl](../../../includes/tlasharptla-winexpl-md.md)] case will return successfully and cause focus to be set to the Edit within the data item subtree.</span></span>  
  
<a name="Required_UI_Automation_Events"></a>   
## <a name="required-ui-automation-events"></a><span data-ttu-id="63fe9-180">必要的使用者介面自動化事件</span><span class="sxs-lookup"><span data-stu-id="63fe9-180">Required UI Automation Events</span></span>  
 <span data-ttu-id="63fe9-181">下表列出所有資料項目控制項都必須支援的 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-181">The following table lists the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] events required to be supported by all data item controls.</span></span> <span data-ttu-id="63fe9-182">如需事件的詳細資訊，請參閱 [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="63fe9-182">For more information about events, see [UI Automation Events Overview](../../../docs/framework/ui-automation/ui-automation-events-overview.md).</span></span>  
  
|[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="63fe9-183">事件</span><span class="sxs-lookup"><span data-stu-id="63fe9-183">Event</span></span>|<span data-ttu-id="63fe9-184">支援</span><span class="sxs-lookup"><span data-stu-id="63fe9-184">Support</span></span>|<span data-ttu-id="63fe9-185">注意</span><span class="sxs-lookup"><span data-stu-id="63fe9-185">Notes</span></span>|  
|---------------------------------------------------------------------------------|-------------|-----------|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.AutomationFocusChangedEvent>|<span data-ttu-id="63fe9-186">必要項</span><span class="sxs-lookup"><span data-stu-id="63fe9-186">Required</span></span>|<span data-ttu-id="63fe9-187">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-187">None</span></span>|  
|<span data-ttu-id="63fe9-188"><xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-188"><xref:System.Windows.Automation.AutomationElementIdentifiers.BoundingRectangleProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-189">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-189">Required</span></span>|<span data-ttu-id="63fe9-190">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-190">None</span></span>|  
|<span data-ttu-id="63fe9-191"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-191"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsEnabledProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-192">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-192">Required</span></span>|<span data-ttu-id="63fe9-193">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-193">None</span></span>|  
|<span data-ttu-id="63fe9-194"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsOffscreenProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-194"><xref:System.Windows.Automation.AutomationElementIdentifiers.IsOffscreenProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-195">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-195">Required</span></span>|<span data-ttu-id="63fe9-196">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-196">None</span></span>|  
|<span data-ttu-id="63fe9-197"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-197"><xref:System.Windows.Automation.AutomationElementIdentifiers.NameProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-198">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-198">Required</span></span>|<span data-ttu-id="63fe9-199">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-199">None</span></span>|  
|<xref:System.Windows.Automation.AutomationElementIdentifiers.StructureChangedEvent>|<span data-ttu-id="63fe9-200">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-200">Required</span></span>|<span data-ttu-id="63fe9-201">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-201">None</span></span>|  
|<xref:System.Windows.Automation.InvokePatternIdentifiers.InvokedEvent>|<span data-ttu-id="63fe9-202">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-202">Depends</span></span>|<span data-ttu-id="63fe9-203">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-203">None</span></span>|  
|<span data-ttu-id="63fe9-204"><xref:System.Windows.Automation.ExpandCollapsePatternIdentifiers.ExpandCollapseStateProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-204"><xref:System.Windows.Automation.ExpandCollapsePatternIdentifiers.ExpandCollapseStateProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-205">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-205">Depends</span></span>|<span data-ttu-id="63fe9-206">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-206">None</span></span>|  
|<xref:System.Windows.Automation.SelectionItemPatternIdentifiers.ElementAddedToSelectionEvent>|<span data-ttu-id="63fe9-207">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-207">Required</span></span>|<span data-ttu-id="63fe9-208">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-208">None</span></span>|  
|<xref:System.Windows.Automation.SelectionItemPatternIdentifiers.ElementRemovedFromSelectionEvent>|<span data-ttu-id="63fe9-209">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-209">Required</span></span>|<span data-ttu-id="63fe9-210">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-210">None</span></span>|  
|<xref:System.Windows.Automation.SelectionItemPatternIdentifiers.ElementSelectedEvent>|<span data-ttu-id="63fe9-211">必要</span><span class="sxs-lookup"><span data-stu-id="63fe9-211">Required</span></span>|<span data-ttu-id="63fe9-212">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-212">None</span></span>|  
|<span data-ttu-id="63fe9-213"><xref:System.Windows.Automation.TogglePatternIdentifiers.ToggleStateProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-213"><xref:System.Windows.Automation.TogglePatternIdentifiers.ToggleStateProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-214">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-214">Depends</span></span>|<span data-ttu-id="63fe9-215">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-215">None</span></span>|  
|<span data-ttu-id="63fe9-216"><xref:System.Windows.Automation.ValuePatternIdentifiers.ValueProperty> 屬性變更事件。</span><span class="sxs-lookup"><span data-stu-id="63fe9-216"><xref:System.Windows.Automation.ValuePatternIdentifiers.ValueProperty> property-changed event.</span></span>|<span data-ttu-id="63fe9-217">視情況而定</span><span class="sxs-lookup"><span data-stu-id="63fe9-217">Depends</span></span>|<span data-ttu-id="63fe9-218">None</span><span class="sxs-lookup"><span data-stu-id="63fe9-218">None</span></span>|  
  
<a name="Data_Item_Control_Type_Example"></a>   
## <a name="dataitem-control-type-example"></a><span data-ttu-id="63fe9-219">DataItem 控制項類型範例</span><span class="sxs-lookup"><span data-stu-id="63fe9-219">DataItem Control Type Example</span></span>  
 <span data-ttu-id="63fe9-220">下圖顯示在清單檢視控制項中的 DataItem 控制項類型，且包含對資料行中豐富資訊的支援。</span><span class="sxs-lookup"><span data-stu-id="63fe9-220">The following image illustrates a DataItem control type in a List View control with support for rich information for the columns.</span></span>  
  
 <span data-ttu-id="63fe9-221">![包含兩個資料項目之 List View 控制項的圖形](../../../docs/framework/ui-automation/media/uiauto-data-grid-detailed.GIF "uiauto_data_grid_detailed")</span><span class="sxs-lookup"><span data-stu-id="63fe9-221">![Graphic of a List View control with two data items](../../../docs/framework/ui-automation/media/uiauto-data-grid-detailed.GIF "uiauto_data_grid_detailed")</span></span>  
  
 <span data-ttu-id="63fe9-222">與資料項目控制項相關之 [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] 樹狀結構的控制項檢視和內容檢視顯示如下。</span><span class="sxs-lookup"><span data-stu-id="63fe9-222">The Control View and the Content View of the [!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] tree that pertains to the data item control is displayed below.</span></span> <span data-ttu-id="63fe9-223">每個自動化項目的控制項模式顯示在括號中。</span><span class="sxs-lookup"><span data-stu-id="63fe9-223">The control patterns for each automation element are shown in parentheses.</span></span> <span data-ttu-id="63fe9-224">Group "Contoso" 也是資料格主控制項資料格的一部分。</span><span class="sxs-lookup"><span data-stu-id="63fe9-224">The Group "Contoso" is also part of the grid of the Data Grid host control.</span></span>  
  
|[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="63fe9-225">樹狀結構 - 控制項檢視</span><span class="sxs-lookup"><span data-stu-id="63fe9-225">Tree - Control View</span></span>|[!INCLUDE[TLA2#tla_uiautomation](../../../includes/tla2sharptla-uiautomation-md.md)] <span data-ttu-id="63fe9-226">樹狀結構 - 內容檢視</span><span class="sxs-lookup"><span data-stu-id="63fe9-226">Tree - Content View</span></span>|  
|------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------|  
|<span data-ttu-id="63fe9-227">-群組"Contoso"（Table、 格線）</span><span class="sxs-lookup"><span data-stu-id="63fe9-227">-   Group "Contoso" (Table, Grid)</span></span><br /><span data-ttu-id="63fe9-228">-DataItem"帳戶 Receivable.doc"（TableItem GridItem、 SelectionItem，叫用）</span><span class="sxs-lookup"><span data-stu-id="63fe9-228">-   DataItem "Accounts Receivable.doc" (TableItem, GridItem, SelectionItem, Invoke)</span></span><br /><span data-ttu-id="63fe9-229">-映像的"Accounts Receivable.doc"</span><span class="sxs-lookup"><span data-stu-id="63fe9-229">-   Image "Accounts Receivable.doc"</span></span><br /><span data-ttu-id="63fe9-230">-編輯 「 名稱 」 （TableItem，GridItem，值"Accounts Receivable.doc"）</span><span class="sxs-lookup"><span data-stu-id="63fe9-230">-   Edit "Name" (TableItem, GridItem, Value "Accounts Receivable.doc")</span></span><br /><span data-ttu-id="63fe9-231">-編輯 「 修改日期 」 (TableItem，GridItem，值 「 8/25/2006年下午 3 點 29")</span><span class="sxs-lookup"><span data-stu-id="63fe9-231">-   Edit "Date modified" (TableItem, GridItem, Value "8/25/2006 3:29 PM")</span></span><br /><span data-ttu-id="63fe9-232">-編輯 「 大小 」 （GridItem，TableItem，值"11.0 KB）</span><span class="sxs-lookup"><span data-stu-id="63fe9-232">-   Edit "Size" (GridItem, TableItem, Value "11.0 KB)</span></span><br /><span data-ttu-id="63fe9-233">-DataItem"帳戶 Payable.doc"（TableItem GridItem、 SelectionItem，叫用）</span><span class="sxs-lookup"><span data-stu-id="63fe9-233">-   DataItem "Accounts Payable.doc" (TableItem, GridItem, SelectionItem, Invoke)</span></span><br /><span data-ttu-id="63fe9-234">-   ...</span><span class="sxs-lookup"><span data-stu-id="63fe9-234">-   ...</span></span>|<span data-ttu-id="63fe9-235">-群組"Contoso"（Table、 格線）</span><span class="sxs-lookup"><span data-stu-id="63fe9-235">-   Group "Contoso" (Table, Grid)</span></span><br /><span data-ttu-id="63fe9-236">-DataItem"帳戶 Receivable.doc"（TableItem GridItem、 SelectionItem，叫用）</span><span class="sxs-lookup"><span data-stu-id="63fe9-236">-   DataItem "Accounts Receivable.doc" (TableItem, GridItem, SelectionItem, Invoke)</span></span><br /><span data-ttu-id="63fe9-237">-映像的"Accounts Receivable.doc"</span><span class="sxs-lookup"><span data-stu-id="63fe9-237">-   Image "Accounts Receivable.doc"</span></span><br /><span data-ttu-id="63fe9-238">-編輯 「 名稱 」 （TableItem，GridItem，值"Accounts Receivable.doc"）</span><span class="sxs-lookup"><span data-stu-id="63fe9-238">-   Edit "Name" (TableItem, GridItem, Value "Accounts Receivable.doc")</span></span><br /><span data-ttu-id="63fe9-239">-編輯 「 修改日期 」 (TableItem，GridItem，值 「 8/25/2006年下午 3 點 29")</span><span class="sxs-lookup"><span data-stu-id="63fe9-239">-   Edit "Date modified" (TableItem, GridItem, Value "8/25/2006 3:29 PM")</span></span><br /><span data-ttu-id="63fe9-240">-編輯 「 大小 」 （GridItem，TableItem，值"11.0 KB）</span><span class="sxs-lookup"><span data-stu-id="63fe9-240">-   Edit "Size" (GridItem, TableItem, Value "11.0 KB)</span></span><br /><span data-ttu-id="63fe9-241">-DataItem"帳戶 Payable.doc"（TableItem GridItem、 SelectionItem，叫用）</span><span class="sxs-lookup"><span data-stu-id="63fe9-241">-   DataItem "Accounts Payable.doc" (TableItem, GridItem, SelectionItem, Invoke)</span></span><br /><span data-ttu-id="63fe9-242">-   …</span><span class="sxs-lookup"><span data-stu-id="63fe9-242">-   …</span></span>|  
  
 <span data-ttu-id="63fe9-243">如果資料格表示可選取項目的清單，則對應的使用者介面項目可使用 ListItem 控制項類型公開，而不是 DataItem 控制項類型。</span><span class="sxs-lookup"><span data-stu-id="63fe9-243">If a grid represents a list of selectable items, the corresponding UI elements can be exposed with the ListItem control type instead of the DataItem control type.</span></span> <span data-ttu-id="63fe9-244">在前述範例中，Group ("Contoso") 下的 DataItem 項目 ("Accounts Receivable.doc" 和 "Accounts Payable.doc") 可藉由公開為 ListItem 控制項類型的方式獲得改善，因為該類型已支援 SelectionItem 控制項模式。</span><span class="sxs-lookup"><span data-stu-id="63fe9-244">In the preceding example, the DataItem elements ("Accounts Receivable.doc" and "Accounts Payable.doc") under Group ("Contoso") can be improved by exposing them as ListItem control types because that type already supports the SelectionItem control pattern.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="63fe9-245">另請參閱</span><span class="sxs-lookup"><span data-stu-id="63fe9-245">See also</span></span>

- <xref:System.Windows.Automation.ControlType.DataItem>
- [<span data-ttu-id="63fe9-246">UI 自動化控制項類型概觀</span><span class="sxs-lookup"><span data-stu-id="63fe9-246">UI Automation Control Types Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-control-types-overview.md)
- [<span data-ttu-id="63fe9-247">UI 自動化概觀</span><span class="sxs-lookup"><span data-stu-id="63fe9-247">UI Automation Overview</span></span>](../../../docs/framework/ui-automation/ui-automation-overview.md)
