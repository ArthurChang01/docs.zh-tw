---
title: IMetaDataDispenserEx::SetOption 方法
ms.date: 03/30/2017
api_name:
- IMetaDataDispenserEx.SetOption
api_location:
- mscoree.dll
api_type:
- COM
f1_keywords:
- IMetaDataDispenserEx::SetOption
helpviewer_keywords:
- IMetaDataDispenserEx::SetOption method [.NET Framework metadata]
- SetOption method [.NET Framework metadata]
ms.assetid: 9f1c7ccd-7fb2-41d8-aa00-24b823376527
topic_type:
- apiref
ms.openlocfilehash: f8e85a670d04e5825653864484b7ccd9ce747949
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/12/2020
ms.locfileid: "79175898"
---
# <a name="imetadatadispenserexsetoption-method"></a><span data-ttu-id="e7471-102">IMetaDataDispenserEx::SetOption 方法</span><span class="sxs-lookup"><span data-stu-id="e7471-102">IMetaDataDispenserEx::SetOption Method</span></span>
<span data-ttu-id="e7471-103">將指定選項設置為當前中繼資料作用域的給定值。</span><span class="sxs-lookup"><span data-stu-id="e7471-103">Sets the specified option to a given value for the current metadata scope.</span></span> <span data-ttu-id="e7471-104">該選項控制如何處理對當前中繼資料作用域的調用。</span><span class="sxs-lookup"><span data-stu-id="e7471-104">The option controls how calls to the current metadata scope are handled.</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="e7471-105">語法</span><span class="sxs-lookup"><span data-stu-id="e7471-105">Syntax</span></span>  
  
```cpp  
HRESULT SetOption (  
    [in] REFGUID optionId,
    [in] const VARIANT *pValue  
);  
```  
  
## <a name="parameters"></a><span data-ttu-id="e7471-106">參數</span><span class="sxs-lookup"><span data-stu-id="e7471-106">Parameters</span></span>  
 `optionId`  
 <span data-ttu-id="e7471-107">[在]指向 GUID 的指標，用於指定要設置的選項。</span><span class="sxs-lookup"><span data-stu-id="e7471-107">[in] A pointer to a GUID that specifies the option to be set.</span></span>  
  
 `pValue`  
 <span data-ttu-id="e7471-108">[在]用於設置選項的值。</span><span class="sxs-lookup"><span data-stu-id="e7471-108">[in] The value to use to set the option.</span></span> <span data-ttu-id="e7471-109">此值的類型必須是指定選項類型的變體。</span><span class="sxs-lookup"><span data-stu-id="e7471-109">The type of this value must be a variant of the specified option's type.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="e7471-110">備註</span><span class="sxs-lookup"><span data-stu-id="e7471-110">Remarks</span></span>  
 <span data-ttu-id="e7471-111">下表列出了`optionId`參數可以指向的可用 GUID 以及`pValue`參數的相應有效值。</span><span class="sxs-lookup"><span data-stu-id="e7471-111">The following table lists the available GUIDs that the `optionId` parameter can point to and the corresponding valid values for the `pValue` parameter.</span></span>  
  
|<span data-ttu-id="e7471-112">GUID</span><span class="sxs-lookup"><span data-stu-id="e7471-112">GUID</span></span>|<span data-ttu-id="e7471-113">描述</span><span class="sxs-lookup"><span data-stu-id="e7471-113">Description</span></span>|<span data-ttu-id="e7471-114">`pValue`參數</span><span class="sxs-lookup"><span data-stu-id="e7471-114">`pValue` Parameter</span></span>|  
|----------|-----------------|------------------------|  
|<span data-ttu-id="e7471-115">中繼資料檢查重複項</span><span class="sxs-lookup"><span data-stu-id="e7471-115">MetaDataCheckDuplicatesFor</span></span>|<span data-ttu-id="e7471-116">控制檢查哪些項的重複項。</span><span class="sxs-lookup"><span data-stu-id="e7471-116">Controls which items are checked for duplicates.</span></span> <span data-ttu-id="e7471-117">每次調用創建新專案的[IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md)方法時，都可以要求該方法檢查該項是否已存在於當前作用域中。</span><span class="sxs-lookup"><span data-stu-id="e7471-117">Each time you call an [IMetaDataEmit](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-interface.md) method that creates a new item, you can ask the method to check whether the item already exists in the current scope.</span></span> <span data-ttu-id="e7471-118">例如，您可以檢查`mdMethodDef`是否存在專案;例如，可以檢查是否存在專案。在這種情況下，當您調用[IMetaDataEmit：:DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md)時，它將檢查該方法是否不存在在當前作用域中。</span><span class="sxs-lookup"><span data-stu-id="e7471-118">For example, you can check for the existence of `mdMethodDef` items; in this case, when you call [IMetaDataEmit::DefineMethod](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-definemethod-method.md), it will check that the method does not already exist in the current scope.</span></span> <span data-ttu-id="e7471-119">此檢查使用唯一標識給定方法的鍵：父類型、名稱和簽名。</span><span class="sxs-lookup"><span data-stu-id="e7471-119">This check uses the key that uniquely identifies a given method: parent type, name, and signature.</span></span>|<span data-ttu-id="e7471-120">必須是類型 UI4 的變體，並且必須包含[CorCheck 複製項的值的組合。For](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md)枚舉。</span><span class="sxs-lookup"><span data-stu-id="e7471-120">Must be a variant of type UI4, and must contain a combination of the values of the [CorCheckDuplicatesFor](../../../../docs/framework/unmanaged-api/metadata/corcheckduplicatesfor-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="e7471-121">中繼資料參考檢查</span><span class="sxs-lookup"><span data-stu-id="e7471-121">MetaDataRefToDefCheck</span></span>|<span data-ttu-id="e7471-122">引用項的控制項將轉換為定義。</span><span class="sxs-lookup"><span data-stu-id="e7471-122">Controls which referenced items are converted to definitions.</span></span> <span data-ttu-id="e7471-123">預設情況下，如果引用的項實際上是在當前作用域中定義的，中繼資料引擎將通過將引用的項轉換為其定義來優化代碼。</span><span class="sxs-lookup"><span data-stu-id="e7471-123">By default, the metadata engine will optimize the code by converting a referenced item to its definition if the referenced item is actually defined in the current scope.</span></span>|<span data-ttu-id="e7471-124">必須是類型 UI4 的變體，並且必須包含[CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md)枚舉的值的組合。</span><span class="sxs-lookup"><span data-stu-id="e7471-124">Must be a variant of type UI4, and must contain a combination of the values of the [CorRefToDefCheck](../../../../docs/framework/unmanaged-api/metadata/correftodefcheck-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="e7471-125">中繼資料通知權杖移動</span><span class="sxs-lookup"><span data-stu-id="e7471-125">MetaDataNotificationForTokenMovement</span></span>|<span data-ttu-id="e7471-126">控制在中繼資料合併期間發生的權杖重映射生成回檔。</span><span class="sxs-lookup"><span data-stu-id="e7471-126">Controls which token remaps occurring during a metadata merge generate callbacks.</span></span> <span data-ttu-id="e7471-127">使用[IMetaDataEmit：：SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md)方法建立[IMapToken 介面](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md)。</span><span class="sxs-lookup"><span data-stu-id="e7471-127">Use the [IMetaDataEmit::SetHandler](../../../../docs/framework/unmanaged-api/metadata/imetadataemit-sethandler-method.md) method to establish your [IMapToken](../../../../docs/framework/unmanaged-api/metadata/imaptoken-interface.md) interface.</span></span>|<span data-ttu-id="e7471-128">必須是類型 UI4 的變體，並且必須包含[Cor通知ForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md)枚舉的值的組合。</span><span class="sxs-lookup"><span data-stu-id="e7471-128">Must be a variant of type UI4, and must contain a combination of the values of the [CorNotificationForTokenMovement](../../../../docs/framework/unmanaged-api/metadata/cornotificationfortokenmovement-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="e7471-129">元資料集</span><span class="sxs-lookup"><span data-stu-id="e7471-129">MetaDataSetENC</span></span>|<span data-ttu-id="e7471-130">控制編輯和繼續 （ENC） 的行為。</span><span class="sxs-lookup"><span data-stu-id="e7471-130">Controls the behavior of edit-and-continue (ENC).</span></span> <span data-ttu-id="e7471-131">一次只能設置一種行為模式。</span><span class="sxs-lookup"><span data-stu-id="e7471-131">Only one mode of behavior can be set at a time.</span></span>|<span data-ttu-id="e7471-132">必須是類型 UI4 的變體，並且必須包含[CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md)枚舉的值。</span><span class="sxs-lookup"><span data-stu-id="e7471-132">Must be a variant of type UI4, and must contain a value of the [CorSetENC](../../../../docs/framework/unmanaged-api/metadata/corsetenc-enumeration.md) enumeration.</span></span> <span data-ttu-id="e7471-133">該值不是位元遮罩。</span><span class="sxs-lookup"><span data-stu-id="e7471-133">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="e7471-134">中繼資料錯誤，如果已發出命令</span><span class="sxs-lookup"><span data-stu-id="e7471-134">MetaDataErrorIfEmitOutOfOrder</span></span>|<span data-ttu-id="e7471-135">控制發出訂單外錯誤生成回檔。</span><span class="sxs-lookup"><span data-stu-id="e7471-135">Controls which emitted-out-of-order errors generate callbacks.</span></span> <span data-ttu-id="e7471-136">按順序發出中繼資料並非致命;但是，如果按中繼資料引擎青睞的順序發出中繼資料，則中繼資料將更加緊湊，因此可以更有效地搜索中繼資料。</span><span class="sxs-lookup"><span data-stu-id="e7471-136">Emitting metadata out of order is not fatal; however, if you emit metadata in an order that is favored by the metadata engine, the metadata is more compact and therefore can be more efficiently searched.</span></span> <span data-ttu-id="e7471-137">使用`IMetaDataEmit::SetHandler`方法建立[IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md)介面。</span><span class="sxs-lookup"><span data-stu-id="e7471-137">Use the `IMetaDataEmit::SetHandler` method to establish your [IMetaDataError](../../../../docs/framework/unmanaged-api/metadata/imetadataerror-interface.md) interface.</span></span>|<span data-ttu-id="e7471-138">必須是類型 UI4 的變體，並且必須包含[CorErrorIfEmitOutOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md)枚舉的值的組合。</span><span class="sxs-lookup"><span data-stu-id="e7471-138">Must be a variant of type UI4, and must contain a combination of the values of the [CorErrorIfEmitOutOfOrder](../../../../docs/framework/unmanaged-api/metadata/corerrorifemitoutoforder-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="e7471-139">中繼資料導入選項</span><span class="sxs-lookup"><span data-stu-id="e7471-139">MetaDataImportOption</span></span>|<span data-ttu-id="e7471-140">控制枚舉器檢索在 ENC 期間刪除的哪些類型的項。</span><span class="sxs-lookup"><span data-stu-id="e7471-140">Controls which kinds of items that were deleted during an ENC are retrieved by an enumerator.</span></span>|<span data-ttu-id="e7471-141">必須是類型 UI4 的變體，並且必須包含[CorImportOptions 枚舉](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md)枚舉的值的組合。</span><span class="sxs-lookup"><span data-stu-id="e7471-141">Must be a variant of type UI4, and must contain a combination of the values of the [CorImportOptions Enumeration](../../../../docs/framework/unmanaged-api/metadata/corimportoptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="e7471-142">中繼資料執行緒安全選項</span><span class="sxs-lookup"><span data-stu-id="e7471-142">MetaDataThreadSafetyOptions</span></span>|<span data-ttu-id="e7471-143">控制中繼資料引擎是否獲取讀取器/寫入器鎖，從而確保執行緒安全。</span><span class="sxs-lookup"><span data-stu-id="e7471-143">Controls whether the metadata engine obtains reader/writer locks, thereby ensuring thread safety.</span></span> <span data-ttu-id="e7471-144">預設情況下，引擎假定訪問由調用方單線程進行，因此不會獲取鎖。</span><span class="sxs-lookup"><span data-stu-id="e7471-144">By default, the engine assumes that access is single-threaded by the caller, so no locks are obtained.</span></span> <span data-ttu-id="e7471-145">用戶端負責在使用中繼資料 API 時保持正確的執行緒同步。</span><span class="sxs-lookup"><span data-stu-id="e7471-145">Clients are responsible for maintaining proper thread synchronization when using the metadata API.</span></span>|<span data-ttu-id="e7471-146">必須是類型 UI4 的變體，並且必須包含[CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md)枚舉的值。</span><span class="sxs-lookup"><span data-stu-id="e7471-146">Must be a variant of type UI4, and must contain a value of the [CorThreadSafetyOptions](../../../../docs/framework/unmanaged-api/metadata/corthreadsafetyoptions-enumeration.md) enumeration.</span></span> <span data-ttu-id="e7471-147">該值不是位元遮罩。</span><span class="sxs-lookup"><span data-stu-id="e7471-147">The value is not a bitmask.</span></span>|  
|<span data-ttu-id="e7471-148">中繼資料生成配接器</span><span class="sxs-lookup"><span data-stu-id="e7471-148">MetaDataGenerateTCEAdapters</span></span>|<span data-ttu-id="e7471-149">控制型別程式庫導入器是否應為 COM 連接點容器生成緊密耦合的事件 （TCE） 配接器。</span><span class="sxs-lookup"><span data-stu-id="e7471-149">Controls whether the type library importer should generate the tightly coupled event (TCE) adapters for COM connection point containers.</span></span>|<span data-ttu-id="e7471-150">必須是 BOOL 類型的變體。</span><span class="sxs-lookup"><span data-stu-id="e7471-150">Must be a variant of type BOOL.</span></span> <span data-ttu-id="e7471-151">如果`pValue`設置為`true`，型別程式庫導入器將生成 TCE 配接器。</span><span class="sxs-lookup"><span data-stu-id="e7471-151">If `pValue` is set to `true`, the type library importer generates the TCE adapters.</span></span>|  
|<span data-ttu-id="e7471-152">MetaDataTypeLib導入命名空間</span><span class="sxs-lookup"><span data-stu-id="e7471-152">MetaDataTypeLibImportNamespace</span></span>|<span data-ttu-id="e7471-153">為要導入的型別程式庫指定非預設命名空間。</span><span class="sxs-lookup"><span data-stu-id="e7471-153">Specifies a non-default namespace for the type library that is being imported.</span></span>|<span data-ttu-id="e7471-154">必須為空值或 BSTR 類型的變體。</span><span class="sxs-lookup"><span data-stu-id="e7471-154">Must be either a null value or a variant of type BSTR.</span></span> <span data-ttu-id="e7471-155">如果`pValue`為空值，則當前命名空間設置為 null;如果為 null。"如果為空"，則為 null。否則，當前命名空間將設置為在變體的 BSTR 類型中持有的字串。</span><span class="sxs-lookup"><span data-stu-id="e7471-155">If `pValue` is a null value, the current namespace is set to null; otherwise, the current namespace is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="e7471-156">元資料連結器選項</span><span class="sxs-lookup"><span data-stu-id="e7471-156">MetaDataLinkerOptions</span></span>|<span data-ttu-id="e7471-157">控制連結器是生成程式集還是 .NET 框架模組檔。</span><span class="sxs-lookup"><span data-stu-id="e7471-157">Controls whether the linker should generate an assembly or a .NET Framework module file.</span></span>|<span data-ttu-id="e7471-158">必須是類型 UI4 的變體，並且必須包含[CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md)枚舉的值的組合。</span><span class="sxs-lookup"><span data-stu-id="e7471-158">Must be a variant of type UI4, and must contain a combination of the values of the [CorLinkerOptions](../../../../docs/framework/unmanaged-api/metadata/corlinkeroptions-enumeration.md) enumeration.</span></span>|  
|<span data-ttu-id="e7471-159">中繼資料執行階段版本</span><span class="sxs-lookup"><span data-stu-id="e7471-159">MetaDataRuntimeVersion</span></span>|<span data-ttu-id="e7471-160">指定生成此映射的通用語言運行時的版本。</span><span class="sxs-lookup"><span data-stu-id="e7471-160">Specifies the version of the common language runtime against which this image was built.</span></span> <span data-ttu-id="e7471-161">版本存儲為字串，如"v1.0.3705"。</span><span class="sxs-lookup"><span data-stu-id="e7471-161">The version is stored as a string, such as "v1.0.3705".</span></span>|<span data-ttu-id="e7471-162">必須為空值、VT_EMPTY值或 BSTR 類型的變體。</span><span class="sxs-lookup"><span data-stu-id="e7471-162">Must be a null value, a VT_EMPTY value, or a variant of type BSTR.</span></span> <span data-ttu-id="e7471-163">如果`pValue`為 null，則執行階段版本設置為 null。</span><span class="sxs-lookup"><span data-stu-id="e7471-163">If `pValue` is null, the runtime version is set to null.</span></span> <span data-ttu-id="e7471-164">如果`pValue`VT_EMPTY，則版本設置為預設值，該值從運行中繼資料代碼的 Mscorwks.dll 版本中提取。</span><span class="sxs-lookup"><span data-stu-id="e7471-164">If `pValue` is VT_EMPTY, the version is set to a default value, which is drawn from the version of Mscorwks.dll within which the metadata code is running.</span></span> <span data-ttu-id="e7471-165">否則，執行階段版本將設置為在變體的 BSTR 類型中持有的字串。</span><span class="sxs-lookup"><span data-stu-id="e7471-165">Otherwise, the runtime version is set to the string that is held in the variant's BSTR type.</span></span>|  
|<span data-ttu-id="e7471-166">中繼資料合併選項</span><span class="sxs-lookup"><span data-stu-id="e7471-166">MetaDataMergerOptions</span></span>|<span data-ttu-id="e7471-167">指定合併中繼資料的選項。</span><span class="sxs-lookup"><span data-stu-id="e7471-167">Specifies options for merging metadata.</span></span>|<span data-ttu-id="e7471-168">必須是類型 UI4 的變體，並且必須包含枚舉值`MergeFlags`的組合，這在 CorHdr.h 檔中描述。</span><span class="sxs-lookup"><span data-stu-id="e7471-168">Must be a variant of type UI4, and must contain a combination of the values of the `MergeFlags` enumeration, which is described in the CorHdr.h file.</span></span>|  
|<span data-ttu-id="e7471-169">MetaData 保留本地引用</span><span class="sxs-lookup"><span data-stu-id="e7471-169">MetaDataPreserveLocalRefs</span></span>|<span data-ttu-id="e7471-170">禁用將本地引用優化到定義中。</span><span class="sxs-lookup"><span data-stu-id="e7471-170">Disables optimizing local references into definitions.</span></span>|<span data-ttu-id="e7471-171">必須包含[CorLocalRef 保存](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md)枚舉的值的組合。</span><span class="sxs-lookup"><span data-stu-id="e7471-171">Must contain a combination of the values of the [CorLocalRefPreservation](../../../../docs/framework/unmanaged-api/metadata/corlocalrefpreservation-enumeration.md) enumeration.</span></span>|  
  
## <a name="requirements"></a><span data-ttu-id="e7471-172">需求</span><span class="sxs-lookup"><span data-stu-id="e7471-172">Requirements</span></span>  
 <span data-ttu-id="e7471-173">**平臺：** 請參閱[系統要求](../../../../docs/framework/get-started/system-requirements.md)。</span><span class="sxs-lookup"><span data-stu-id="e7471-173">**Platform:** See [System Requirements](../../../../docs/framework/get-started/system-requirements.md).</span></span>  
  
 <span data-ttu-id="e7471-174">**標題：** 科爾赫</span><span class="sxs-lookup"><span data-stu-id="e7471-174">**Header:** Cor.h</span></span>  
  
 <span data-ttu-id="e7471-175">**庫：** 用作 MsCorEE.dll 中的資源</span><span class="sxs-lookup"><span data-stu-id="e7471-175">**Library:** Used as a resource in MsCorEE.dll</span></span>  
  
 <span data-ttu-id="e7471-176">**.NET 框架版本：**[!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span><span class="sxs-lookup"><span data-stu-id="e7471-176">**.NET Framework Versions:** [!INCLUDE[net_current_v10plus](../../../../includes/net-current-v10plus-md.md)]</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="e7471-177">另請參閱</span><span class="sxs-lookup"><span data-stu-id="e7471-177">See also</span></span>

- [<span data-ttu-id="e7471-178">IMetaDataDispenserEx 介面</span><span class="sxs-lookup"><span data-stu-id="e7471-178">IMetaDataDispenserEx Interface</span></span>](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenserex-interface.md)
- [<span data-ttu-id="e7471-179">IMetaDataDispenser 介面</span><span class="sxs-lookup"><span data-stu-id="e7471-179">IMetaDataDispenser Interface</span></span>](../../../../docs/framework/unmanaged-api/metadata/imetadatadispenser-interface.md)
