---
title: WMI 與效能計數器 (非受控 API 參考)
description: 摘要說明適用於 WMI 與效能計數器的 .NET Framework 非受控 API 資訊。
author: rpetrusha
ms.author: ronpet
ms.date: 11/06/2017
---

# <a name="windows-management-instrumentation-wmi-and-performance-counters-unmanaged-api-reference"></a><span data-ttu-id="3be53-103">Windows Management Instrumentation (WMI) 與效能計數器 (非受控 API 參考)</span><span class="sxs-lookup"><span data-stu-id="3be53-103">Windows Management Instrumentation (WMI) and Performance Counters (Unmanaged API Reference)</span></span>

<span data-ttu-id="3be53-104">.NET Framework WMI 與效能計數器非受控 API 是由一組封裝對[原生 Windows Management Instrumentation API](/windows/desktop/WmiSdk/com-api-for-wmi) 之呼叫的函式所組成。</span><span class="sxs-lookup"><span data-stu-id="3be53-104">The .NET Framework WMI and Performance Counters unmanaged API consists of a set of functions that wrap calls to the [native Windows Management Instrumentation API](/windows/desktop/WmiSdk/com-api-for-wmi).</span></span> <span data-ttu-id="3be53-105">它可讓您開發可用來管理及監視遠端電腦系統的工具與程式庫。</span><span class="sxs-lookup"><span data-stu-id="3be53-105">It allows you to develop tools and libraries that manage and monitor remote computer systems.</span></span>

[!INCLUDE[internalonly-unmanaged](../../../../includes/internalonly-unmanaged.md)]

<span data-ttu-id="3be53-106">該 API 包括下列功能：</span><span class="sxs-lookup"><span data-stu-id="3be53-106">The API includes the following functions:</span></span>

| <span data-ttu-id="3be53-107">功能</span><span class="sxs-lookup"><span data-stu-id="3be53-107">Function</span></span> | <span data-ttu-id="3be53-108">說明</span><span class="sxs-lookup"><span data-stu-id="3be53-108">Description</span></span> |
|---------|---------|
| [<span data-ttu-id="3be53-109">BeginEnumeration 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-109">BeginEnumeration function</span></span>](beginenumeration.md) | <span data-ttu-id="3be53-110">將列舉程式設定為開始列舉 WMI 物件屬性的狀態。</span><span class="sxs-lookup"><span data-stu-id="3be53-110">Resets the enumerator to the beginning of an enumeration of WMI object properties.</span></span> |
| [<span data-ttu-id="3be53-111">BeginMethodEnumeration 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-111">BeginMethodEnumeration function</span></span>](beginmethodenumeration.md) |  <span data-ttu-id="3be53-112">開始列舉物件上的可用方法。</span><span class="sxs-lookup"><span data-stu-id="3be53-112">Begins an enumeration of the methods available for an object.</span></span> |
| [<span data-ttu-id="3be53-113">BlessIWbemServices 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-113">BlessIWbemServices function</span></span>](blessiwbemservices.md) | <span data-ttu-id="3be53-114">指出使用者認證是否允許存取指定的 IWbemServices 類別。</span><span class="sxs-lookup"><span data-stu-id="3be53-114">Indicates whether the user credentials permit access to a specified IWbemServices class.</span></span> |
| [<span data-ttu-id="3be53-115">BlessIWbemServicesObject 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-115">BlessIWbemServicesObject function</span></span>](blessiwbemservicesobject.md) | <span data-ttu-id="3be53-116">指出使用者認證是否允許存取指定的 IWbem 服務物件。</span><span class="sxs-lookup"><span data-stu-id="3be53-116">Indicates whether the user credentials permit access to a specified IWbem service object.</span></span> |
| [<span data-ttu-id="3be53-117">Clone 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-117">Clone function</span></span>](clone.md) | <span data-ttu-id="3be53-118">傳回屬於目前物件之完整複製品的新物件。</span><span class="sxs-lookup"><span data-stu-id="3be53-118">Returns a new object that is a complete clone of the current object.</span></span> |
| [<span data-ttu-id="3be53-119">CloneEnumWbemClassObject 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-119">CloneEnumWbemClassObject function</span></span>](cloneenumwbemclassobject.md) | <span data-ttu-id="3be53-120">建立列舉程式的邏輯複本，並保留其在列舉中的目前位置。</span><span class="sxs-lookup"><span data-stu-id="3be53-120">Makes a logical copy of an enumerator, retaining its current position in an enumeration.</span></span> |
| [<span data-ttu-id="3be53-121">CompareTo 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-121">CompareTo function</span></span>](compareto.md) | <span data-ttu-id="3be53-122">將物件與另一個 Windows 管理物件比較。</span><span class="sxs-lookup"><span data-stu-id="3be53-122">Compares an object to another Windows management object.</span></span> |
| [<span data-ttu-id="3be53-123">ConnectServerWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-123">ConnectServerWmi function</span></span>](connectserverwmi.md) | <span data-ttu-id="3be53-124">在指定的電腦上建立從 DCOM 到 WMI 命名空間的連線。</span><span class="sxs-lookup"><span data-stu-id="3be53-124">Creates a connection through DCOM to a WMI namespace on a specified computer.</span></span> |
| [<span data-ttu-id="3be53-125">CreateClassEnumWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-125">CreateClassEnumWmi function</span></span>](createclassenumwmi.md) | <span data-ttu-id="3be53-126">傳回滿足所指定選取條件之所有類別的列舉程式。</span><span class="sxs-lookup"><span data-stu-id="3be53-126">Returns an enumerator for all classes that satisfy the specified selection criteria.</span></span> |
| [<span data-ttu-id="3be53-127">CreateInstanceEnumWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-127">CreateInstanceEnumWmi function</span></span>](createinstanceenumwmi.md) | <span data-ttu-id="3be53-128">傳回會傳回滿足指定選取條件之指定類別執行個體的列舉程式。</span><span class="sxs-lookup"><span data-stu-id="3be53-128">Returns an enumerator that returns the instances of a specified class that meet specified selection criteria.</span></span> |
| [<span data-ttu-id="3be53-129">Delete 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-129">Delete function</span></span>](delete.md) | <span data-ttu-id="3be53-130">從類別定義與其所有限定詞刪除指定的屬性。</span><span class="sxs-lookup"><span data-stu-id="3be53-130">Deletes a specified property from a class definition and all of its qualifiers.</span></span> |
| [<span data-ttu-id="3be53-131">DeleteMethod 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-131">DeleteMethod function</span></span>](deletemethod.md) | <span data-ttu-id="3be53-132">從 CIM 類別定義刪除指定的方法。</span><span class="sxs-lookup"><span data-stu-id="3be53-132">Deletes a specified method from a CIM class definition.</span></span> |
| [<span data-ttu-id="3be53-133">EndEnumeration 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-133">EndEnumeration function</span></span>](endenumeration.md) | <span data-ttu-id="3be53-134">終止列舉序列。</span><span class="sxs-lookup"><span data-stu-id="3be53-134">Terminates an enumeration sequence.</span></span> |
| [<span data-ttu-id="3be53-135">EndMethodEnumeration 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-135">EndMethodEnumeration function</span></span>](endmethodenumeration.md) | <span data-ttu-id="3be53-136">終止透過呼叫 [BeginMethodEnumeration 函式](beginmethodenumeration.md)而開始的列舉序列。</span><span class="sxs-lookup"><span data-stu-id="3be53-136">Terminates an enumeration sequence started by calling the  [BeginMethodEnumeration function](beginmethodenumeration.md).</span></span> |
| [<span data-ttu-id="3be53-137">ExecNotificationQueryWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-137">ExecNotificationQueryWmi function</span></span>](execnotificationquerywmi.md) | <span data-ttu-id="3be53-138">執行查詢以接收事件。</span><span class="sxs-lookup"><span data-stu-id="3be53-138">Executes a query to receive events.</span></span> |
| [<span data-ttu-id="3be53-139">ExecQueryWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-139">ExecQueryWmi function</span></span>](execquerywmi.md) | <span data-ttu-id="3be53-140">執行查詢以擷取物件。</span><span class="sxs-lookup"><span data-stu-id="3be53-140">Executes a query to retrieve objects.</span></span> |
| [<span data-ttu-id="3be53-141">FormatFromRawValue 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-141">FormatFromRawValue function</span></span>](formatfromrawvalue.md) | <span data-ttu-id="3be53-142">將一個原始效能資料值轉換為指定的格式，或轉換為兩個原始效能資料值 (若格式轉換是以時間為基礎)。</span><span class="sxs-lookup"><span data-stu-id="3be53-142">Converts one raw performance data value to the specified format, or two raw performance data values if the format conversion is time-based.</span></span> |
| [<span data-ttu-id="3be53-143">Get 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-143">Get function</span></span>](get.md) | <span data-ttu-id="3be53-144">擷取指定的屬性值 (若它存在的話)。</span><span class="sxs-lookup"><span data-stu-id="3be53-144">Retrieves a specified property value if it exists.</span></span> |
| [<span data-ttu-id="3be53-145">GetCurrentApartmentType 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-145">GetCurrentApartmentType function</span></span>](getcurrentapartmenttype.md) | <span data-ttu-id="3be53-146">擷取呼叫者在其中執行之 Apartment 的型別。</span><span class="sxs-lookup"><span data-stu-id="3be53-146">Retrieves the type of apartment in which the caller is executing.</span></span> |
| [<span data-ttu-id="3be53-147">GetDemultiplexedStub 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-147">GetDemultiplexedStub function</span></span>](getdemultiplexedstub.md) | <span data-ttu-id="3be53-148">建立物件轉寄站接收以協助用戶端從 Windows Management 接收非同步呼叫。</span><span class="sxs-lookup"><span data-stu-id="3be53-148">Creates an object forwarder sink to assist a client in receiving asynchronous calls from Windows Management.</span></span> |
| [<span data-ttu-id="3be53-149">GetErrorInfo 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-149">GetErrorInfo function</span></span>](geterrorinfo.md) | <span data-ttu-id="3be53-150">從上一個函式呼叫擷取錯誤資訊。</span><span class="sxs-lookup"><span data-stu-id="3be53-150">Retrieves error information from the previous function call.</span></span> |
| [<span data-ttu-id="3be53-151">GetMethod 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-151">GetMethod function</span></span>](getmethod.md) | <span data-ttu-id="3be53-152">擷取指定之方法的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="3be53-152">Retrieves information about the specified method.</span></span> |
| [<span data-ttu-id="3be53-153">GetMethodOrigin 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-153">GetMethodOrigin function</span></span>](getmethodorigin.md) | <span data-ttu-id="3be53-154">判斷方法在其中宣告的類別。</span><span class="sxs-lookup"><span data-stu-id="3be53-154">Determines the class in which a method is declared.</span></span> |
| [<span data-ttu-id="3be53-155">GetMethodQualifierSet 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-155">GetMethodQualifierSet function</span></span>](getmethodqualifierset.md) | <span data-ttu-id="3be53-156">擷取特定方法的限定詞集合。</span><span class="sxs-lookup"><span data-stu-id="3be53-156">Retrieves the qualifier set for a particular method.</span></span> |
| [<span data-ttu-id="3be53-157">GetNames 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-157">GetNames function</span></span>](getnames.md) | <span data-ttu-id="3be53-158">擷取物件屬性的子集合或所有名稱。</span><span class="sxs-lookup"><span data-stu-id="3be53-158">Retrieves either a subset or all of the names of the properties of an object.</span></span> |
| [<span data-ttu-id="3be53-159">GetObjectText 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-159">GetObjectText function</span></span>](getobjecttext.md) | <span data-ttu-id="3be53-160">以 MOF 語法傳回物件的文字型轉譯。</span><span class="sxs-lookup"><span data-stu-id="3be53-160">Returns a textual rendering of an object in the MOF syntax.</span></span> |
| [<span data-ttu-id="3be53-161">GetPropertyHandle 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-161">GetPropertyHandle function</span></span>](getpropertyhandle.md) | <span data-ttu-id="3be53-162">傳回識別屬性的唯一控制代碼。</span><span class="sxs-lookup"><span data-stu-id="3be53-162">Returns a unique handle that identifies a property.</span></span> |
| [<span data-ttu-id="3be53-163">GetPropertyOrigin 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-163">GetPropertyOrigin function</span></span>](getpropertyorigin.md) | <span data-ttu-id="3be53-164">判斷屬性在其中宣告的類別。</span><span class="sxs-lookup"><span data-stu-id="3be53-164">Determines the class in which a property is declared.</span></span> |
| [<span data-ttu-id="3be53-165">GetPropertyQualifierSet 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-165">GetPropertyQualifierSet function</span></span>](getpropertyqualifierset.md) | <span data-ttu-id="3be53-166">擷取特定屬性的限定詞集合。</span><span class="sxs-lookup"><span data-stu-id="3be53-166">Retrieves the qualifier set for a particular property.</span></span>  |
| [<span data-ttu-id="3be53-167">GetQualifierSet 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-167">GetQualifierSet function</span></span>](getqualifierset.md) | <span data-ttu-id="3be53-168">擷取類別執行個體或類別定義的限定詞集合。</span><span class="sxs-lookup"><span data-stu-id="3be53-168">Retrieves the qualifier set for a class instance or a class definition.</span></span> |
| [<span data-ttu-id="3be53-169">InheritsFrom 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-169">InheritsFrom function</span></span>](inheritsfrom.md) | <span data-ttu-id="3be53-170">判斷目前類別或執行個體衍生自指定的父類別。</span><span class="sxs-lookup"><span data-stu-id="3be53-170">Determines whether the current class or instance derives from a specified parent class.</span></span> |
| [<span data-ttu-id="3be53-171">Initialize 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-171">Initialize function</span></span>](initialize.md) | <span data-ttu-id="3be53-172">執行 WMI 初始化。</span><span class="sxs-lookup"><span data-stu-id="3be53-172">Performs WMI initialization.</span></span> |
| [<span data-ttu-id="3be53-173">Next 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-173">Next function</span></span>](next.md) | <span data-ttu-id="3be53-174">擷取列舉中的下一個屬性。</span><span class="sxs-lookup"><span data-stu-id="3be53-174">Retrieves the next property in an enumeration.</span></span> |
| [<span data-ttu-id="3be53-175">NextMethod 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-175">NextMethod function</span></span>](nextmethod.md) | <span data-ttu-id="3be53-176">擷取列舉中的下一個方法。</span><span class="sxs-lookup"><span data-stu-id="3be53-176">Retrieves the next method in an enumeration.</span></span> |
| [<span data-ttu-id="3be53-177">Put 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-177">Put function</span></span>](put.md) | <span data-ttu-id="3be53-178">將具名屬性設定為新值。</span><span class="sxs-lookup"><span data-stu-id="3be53-178">Sets a named property to a new value.</span></span> |
| [<span data-ttu-id="3be53-179">PutClassWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-179">PutClassWmi function</span></span>](putclasswmi.md) | <span data-ttu-id="3be53-180">建立新類別或更新現有類別。</span><span class="sxs-lookup"><span data-stu-id="3be53-180">Creates a new class or updates an existing one.</span></span> |
| [<span data-ttu-id="3be53-181">PutInstanceWmi 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-181">PutInstanceWmi function</span></span>](putinstancewmi.md) | <span data-ttu-id="3be53-182">建立或更新現有類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="3be53-182">Creates or updates an instance of an existing class.</span></span> <span data-ttu-id="3be53-183">執行個體是寫入到 WMI 存放庫。</span><span class="sxs-lookup"><span data-stu-id="3be53-183">The instance is written to the WMI repository.</span></span> |
| [<span data-ttu-id="3be53-184">PutMethod 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-184">PutMethod function</span></span>](putmethod.md) | <span data-ttu-id="3be53-185">建立方法。</span><span class="sxs-lookup"><span data-stu-id="3be53-185">Creates a method.</span></span> |
| [<span data-ttu-id="3be53-186">QualifierSet_BeginEnumeration 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-186">QualifierSet_BeginEnumeration function</span></span>](qualifierset-beginenumeration.md) | <span data-ttu-id="3be53-187">將物件限定詞的列舉程式重設為列舉開始時的狀態。</span><span class="sxs-lookup"><span data-stu-id="3be53-187">Resets an enumerator of the qualifiers of an object to the beginning of the enumeration.</span></span> |
| [<span data-ttu-id="3be53-188">QualifierSet_Delete 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-188">QualifierSet_Delete function</span></span>](qualifierset-delete.md) | <span data-ttu-id="3be53-189">依名稱刪除指定的限定詞。</span><span class="sxs-lookup"><span data-stu-id="3be53-189">Deletes a specified qualifier by name.</span></span>  |
| [<span data-ttu-id="3be53-190">QualifierSet_EndEnumeration 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-190">QualifierSet_EndEnumeration function</span></span>](qualifierset-endenumeration.md) | <span data-ttu-id="3be53-191">終止透過呼叫 `QualifierSet_BeginEnumeration` 函式而開始的列舉。</span><span class="sxs-lookup"><span data-stu-id="3be53-191">Terminates the enumeration begun with a call to the `QualifierSet_BeginEnumeration` function.</span></span> |
| [<span data-ttu-id="3be53-192">QualifierSet_Get 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-192">QualifierSet_Get function</span></span>](qualifierset-get.md) | <span data-ttu-id="3be53-193">取得指定的具名限定詞。</span><span class="sxs-lookup"><span data-stu-id="3be53-193">Gets the specified named qualifier.</span></span>  |
| [<span data-ttu-id="3be53-194">QualifierSet_GetNames 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-194">QualifierSet_GetNames function</span></span>](qualifierset-getnames.md) | <span data-ttu-id="3be53-195">擷取可從目前物件或屬性取得之所有限定詞或指定限定詞的名稱。</span><span class="sxs-lookup"><span data-stu-id="3be53-195">Retrieves the names of all qualifiers or of specified qualifiers that are available from the current object or property.</span></span> |
| [<span data-ttu-id="3be53-196">QualifierSet_Next 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-196">QualifierSet_Next function</span></span>](qualifierset-next.md) | <span data-ttu-id="3be53-197">擷取透過呼叫 [QualifierSet_BeginEnumeration](qualifierset-beginenumeration.md) 函式而開始之列舉中的下一個限定詞。</span><span class="sxs-lookup"><span data-stu-id="3be53-197">Retrieves the next qualifier in an enumeration that started with a call to the [QualifierSet_BeginEnumeration](qualifierset-beginenumeration.md) function.</span></span> |
| [<span data-ttu-id="3be53-198">QualifierSet_Put 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-198">QualifierSet_Put function</span></span>](qualifierset-put.md) | <span data-ttu-id="3be53-199">寫入具名限定詞與值。</span><span class="sxs-lookup"><span data-stu-id="3be53-199">Writes the named qualifier and value.</span></span> |
| [<span data-ttu-id="3be53-200">ResetSecurity 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-200">ResetSecurity function</span></span>](resetsecurity.md) | <span data-ttu-id="3be53-201">將提供的模擬權杖指派給目前的執行緒。</span><span class="sxs-lookup"><span data-stu-id="3be53-201">Assigns the supplied impersonation token to the current thread.</span></span> |
| [<span data-ttu-id="3be53-202">SetSecurity 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-202">SetSecurity function</span></span>](setsecurity.md) | <span data-ttu-id="3be53-203">擷取與目前執行緒關聯的模擬權杖。</span><span class="sxs-lookup"><span data-stu-id="3be53-203">Retrieves the impersonation token associated with the current thread.</span></span> |
| [<span data-ttu-id="3be53-204">SpawnDerivedClass 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-204">SpawnDerivedClass function</span></span>](spawnderivedclass.md) | <span data-ttu-id="3be53-205">從指定的物件建立新的衍生類別物件。</span><span class="sxs-lookup"><span data-stu-id="3be53-205">Creates a newly derived class object from a specified object.</span></span> |
| [<span data-ttu-id="3be53-206">SpawnInstance 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-206">SpawnInstance function</span></span>](spawninstance.md) | <span data-ttu-id="3be53-207">建立類別的新執行個體。</span><span class="sxs-lookup"><span data-stu-id="3be53-207">Creates a new instance of a class.</span></span> |
| [<span data-ttu-id="3be53-208">VerifyClient 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-208">VerifyClient function</span></span>](verifyclientkey.md) | <span data-ttu-id="3be53-209">確定用戶端金鑰有正確的安全性。</span><span class="sxs-lookup"><span data-stu-id="3be53-209">Ensures that the client key has the correct security.</span></span> |
| [<span data-ttu-id="3be53-210">WritePropertyValue 函式</span><span class="sxs-lookup"><span data-stu-id="3be53-210">WritePropertyValue function</span></span>](writepropertyvalue.md) | <span data-ttu-id="3be53-211">將指定的位元組數目寫入到屬性控制代碼所指定的屬性中。</span><span class="sxs-lookup"><span data-stu-id="3be53-211">Writes a specified number of bytes to a property identified by a property handle.</span></span> |

## <a name="see-also"></a><span data-ttu-id="3be53-212">另請參閱</span><span class="sxs-lookup"><span data-stu-id="3be53-212">See also</span></span>

- [<span data-ttu-id="3be53-213">非受控 API 參考</span><span class="sxs-lookup"><span data-stu-id="3be53-213">Unmanaged API reference</span></span>](../index.md)
