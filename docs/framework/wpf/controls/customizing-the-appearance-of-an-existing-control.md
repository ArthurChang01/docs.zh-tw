---
title: 透過建立 ControlTemplate 自訂現有控制項的外觀
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- control contract [WPF]
- controls [WPF], visual structure changes
- ControlTemplate [WPF], customizing for existing controls
- skinning controls [WPF]
- controls [WPF], appearance specified by state
- templates [WPF], custom for existing controls
ms.assetid: 678dd116-43a2-4b8c-82b5-6b826f126e31
ms.openlocfilehash: 6d7401f9614e663351968dc6a2f85548735a176d
ms.sourcegitcommit: 944ddc52b7f2632f30c668815f92b378efd38eea
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/03/2019
ms.locfileid: "73460427"
---
# <a name="customizing-the-appearance-of-an-existing-control-by-creating-a-controltemplate"></a><span data-ttu-id="8c5cb-102">透過建立 ControlTemplate 自訂現有控制項的外觀</span><span class="sxs-lookup"><span data-stu-id="8c5cb-102">Customizing the Appearance of an Existing Control by Creating a ControlTemplate</span></span>
<a name="introduction"></a><span data-ttu-id="8c5cb-103"><xref:System.Windows.Controls.ControlTemplate> 指定控制項的視覺化結構和視覺效果行為。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-103">A <xref:System.Windows.Controls.ControlTemplate> specifies the visual structure and visual behavior of a control.</span></span> <span data-ttu-id="8c5cb-104">您可以藉由提供新的 <xref:System.Windows.Controls.ControlTemplate>來自訂控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-104">You can customize the appearance of a control by giving it a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="8c5cb-105">當您建立 <xref:System.Windows.Controls.ControlTemplate>時，您會取代現有控制項的外觀，而不會變更其功能。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-105">When you create a <xref:System.Windows.Controls.ControlTemplate>, you replace the appearance of an existing control without changing its functionality.</span></span> <span data-ttu-id="8c5cb-106">例如，您可以將應用程式中的按鈕改成四捨五入，而不是預設的方形圖形，但是按鈕仍然會引發 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 事件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-106">For example, you can make the buttons in your application round instead of the default square shape, but the button will still raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event.</span></span>

 <span data-ttu-id="8c5cb-107">本主題說明 <xref:System.Windows.Controls.ControlTemplate>的各個部分，示範如何建立 <xref:System.Windows.Controls.Button>的簡單 <xref:System.Windows.Controls.ControlTemplate>，並說明如何瞭解控制項的控制項合約，讓您可以自訂其外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-107">This topic explains the various parts of a <xref:System.Windows.Controls.ControlTemplate>, demonstrates creating a simple <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>, and explains how to understand the control contract of a control so that you can customize its appearance.</span></span> <span data-ttu-id="8c5cb-108">由於您是在 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]中建立 <xref:System.Windows.Controls.ControlTemplate>，因此您可以變更控制項的外觀，而不需要撰寫任何程式碼。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-108">Because you create a <xref:System.Windows.Controls.ControlTemplate> in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], you can change a control's appearance without writing any code.</span></span> <span data-ttu-id="8c5cb-109">您也可以使用設計工具（例如 Blend for Visual Studio）來建立自訂控制項範本。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-109">You can also use a designer, such as Blend for Visual Studio, to create custom control templates.</span></span> <span data-ttu-id="8c5cb-110">本主題顯示 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 中的範例，可自訂 <xref:System.Windows.Controls.Button> 的外觀，並列出主題結尾的完整範例。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-110">This topic shows examples in the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] that customize the appearance of a <xref:System.Windows.Controls.Button> and lists the complete example at the end of the topic.</span></span> <span data-ttu-id="8c5cb-111">如需使用 Blend for Visual Studio 的詳細資訊，請參閱設定[支援範本之控制項的樣式](https://go.microsoft.com/fwlink/?LinkId=161153)。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-111">For more information about using Blend for Visual Studio, see [Styling a control that supports templates](https://go.microsoft.com/fwlink/?LinkId=161153).</span></span>

 <span data-ttu-id="8c5cb-112">下圖顯示使用本主題中所建立之 <xref:System.Windows.Controls.ControlTemplate> 的 <xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-112">The following illustrations show a <xref:System.Windows.Controls.Button> that uses the <xref:System.Windows.Controls.ControlTemplate> that is created in this topic.</span></span>

 <span data-ttu-id="8c5cb-113">![搭配自訂控制項範本的按鈕。](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-113">![A button with a custom control template.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>
<span data-ttu-id="8c5cb-114">使用自訂控制項範本的按鈕</span><span class="sxs-lookup"><span data-stu-id="8c5cb-114">A button that uses a custom control template</span></span>

 <span data-ttu-id="8c5cb-115">![具有紅色外框的按鈕。](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-115">![A button with a red border.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>
<span data-ttu-id="8c5cb-116">使用自訂控制項範本且滑鼠指標移至其上方的按鈕</span><span class="sxs-lookup"><span data-stu-id="8c5cb-116">A button that uses a custom control template and has the mouse pointer over it</span></span>

<a name="prerequisites"></a>
## <a name="prerequisites"></a><span data-ttu-id="8c5cb-117">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="8c5cb-117">Prerequisites</span></span>
 <span data-ttu-id="8c5cb-118">本主題假設您了解如何建立和使用控制項與樣式，如[控制項](index.md)所述。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-118">This topic assumes that you understand how to create and use controls and styles as discussed in [Controls](index.md).</span></span> <span data-ttu-id="8c5cb-119">本主題所討論的概念適用于繼承自 <xref:System.Windows.Controls.Control> 類別的元素，但 <xref:System.Windows.Controls.UserControl>除外。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-119">The concepts discussed in this topic apply to elements that inherit from the <xref:System.Windows.Controls.Control> class, except for the <xref:System.Windows.Controls.UserControl>.</span></span> <span data-ttu-id="8c5cb-120">您無法將 <xref:System.Windows.Controls.ControlTemplate> 套用至 <xref:System.Windows.Controls.UserControl>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-120">You cannot apply a <xref:System.Windows.Controls.ControlTemplate> to a <xref:System.Windows.Controls.UserControl>.</span></span>

<a name="when_you_should_create_a_controltemplate"></a>
## <a name="when-you-should-create-a-controltemplate"></a><span data-ttu-id="8c5cb-121">建立 ControlTemplate 的適當時機</span><span class="sxs-lookup"><span data-stu-id="8c5cb-121">When You Should Create a ControlTemplate</span></span>
 <span data-ttu-id="8c5cb-122">控制項有許多屬性（例如 <xref:System.Windows.Controls.Border.Background%2A>、<xref:System.Windows.Controls.Control.Foreground%2A>和 <xref:System.Windows.Controls.Control.FontFamily%2A>），可讓您設定來指定控制面板的不同層面，但是您可以藉由設定這些屬性所做的變更會受到限制。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-122">Controls have many properties, such as <xref:System.Windows.Controls.Border.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontFamily%2A>, that you can set to specify different aspects of the control's appearance, but the changes that you can make by setting these properties are limited.</span></span> <span data-ttu-id="8c5cb-123">例如，您可以將 [<xref:System.Windows.Controls.Control.Foreground%2A>] 屬性設定為 [藍色]，並在 <xref:System.Windows.Controls.CheckBox>上 <xref:System.Windows.Controls.Control.FontStyle%2A> 為 [斜體]。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-123">For example, you can set the <xref:System.Windows.Controls.Control.Foreground%2A> property to blue and <xref:System.Windows.Controls.Control.FontStyle%2A> to italic on a <xref:System.Windows.Controls.CheckBox>.</span></span>

 <span data-ttu-id="8c5cb-124">如果無法建立控制項的新 <xref:System.Windows.Controls.ControlTemplate>，則每個 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]架構應用程式中的所有控制項都有相同的一般外觀，這會限制使用自訂外觀和風格來建立應用程式的能力。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-124">Without the ability to create a new <xref:System.Windows.Controls.ControlTemplate> for controls, all controls in every [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]-based application would have the same general appearance, which would limit the ability to create an application with a custom look and feel.</span></span> <span data-ttu-id="8c5cb-125">根據預設，每個 <xref:System.Windows.Controls.CheckBox> 都有類似的特性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-125">By default, every <xref:System.Windows.Controls.CheckBox> has similar characteristics.</span></span> <span data-ttu-id="8c5cb-126">例如，<xref:System.Windows.Controls.CheckBox> 的內容一律在選取範圍指標的右邊，而核取記號一律用來表示已選取 <xref:System.Windows.Controls.CheckBox>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-126">For example, the content of the <xref:System.Windows.Controls.CheckBox> is always to the right of the selection indicator, and the check mark is always used to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>

 <span data-ttu-id="8c5cb-127">當您想要自訂控制項的外觀，而不是控制項的其他屬性設定時，您會建立 <xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-127">You create a <xref:System.Windows.Controls.ControlTemplate> when you want to customize the control's appearance beyond what setting the other properties on the control will do.</span></span> <span data-ttu-id="8c5cb-128">在 <xref:System.Windows.Controls.CheckBox>的範例中，假設您想要將核取方塊的內容放在選取指示器上方，而您想要 X 表示已選取 <xref:System.Windows.Controls.CheckBox>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-128">In the example of the <xref:System.Windows.Controls.CheckBox>, suppose that you want the content of the check box to be above the selection indicator and you want an X to indicate that the <xref:System.Windows.Controls.CheckBox> is selected.</span></span> <span data-ttu-id="8c5cb-129">您可以在 <xref:System.Windows.Controls.CheckBox>的 <xref:System.Windows.Controls.ControlTemplate> 中指定這些變更。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-129">You specify these changes in the <xref:System.Windows.Controls.ControlTemplate> of the <xref:System.Windows.Controls.CheckBox>.</span></span>

 <span data-ttu-id="8c5cb-130">下圖顯示使用預設 <xref:System.Windows.Controls.ControlTemplate>的 <xref:System.Windows.Controls.CheckBox>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-130">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a default <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 <span data-ttu-id="8c5cb-131">![搭配預設控制項範本的核取方塊。](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-131">![A checkbox with the default control template.](./media/ndp-checkboxdefault.png "NDP_CheckBoxDefault")</span></span>
<span data-ttu-id="8c5cb-132">使用預設控制項範本的 CheckBox</span><span class="sxs-lookup"><span data-stu-id="8c5cb-132">A CheckBox that uses the default control template</span></span>

 <span data-ttu-id="8c5cb-133">下圖顯示的 <xref:System.Windows.Controls.CheckBox> 會使用自訂 <xref:System.Windows.Controls.ControlTemplate> 將 <xref:System.Windows.Controls.CheckBox> 的內容放在選取指標上方，並在選取 <xref:System.Windows.Controls.CheckBox> 時顯示 X。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-133">The following illustration shows a <xref:System.Windows.Controls.CheckBox> that uses a custom <xref:System.Windows.Controls.ControlTemplate> to place the content of the <xref:System.Windows.Controls.CheckBox> above the selection indicator and displays an X when the <xref:System.Windows.Controls.CheckBox> is selected.</span></span>

 <span data-ttu-id="8c5cb-134">![搭配自訂控制項範本的核取方塊。](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-134">![A checkbox with a custom control template.](./media/ndp-checkboxcustom.png "NDP_CheckBoxCustom")</span></span>
<span data-ttu-id="8c5cb-135">使用自訂控制項範本的 CheckBox</span><span class="sxs-lookup"><span data-stu-id="8c5cb-135">A CheckBox that uses a custom control template</span></span>

 <span data-ttu-id="8c5cb-136">此範例中 <xref:System.Windows.Controls.CheckBox> 的 <xref:System.Windows.Controls.ControlTemplate> 相當複雜，因此本主題會使用更簡單的範例來建立 <xref:System.Windows.Controls.Button>的 <xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-136">The <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.CheckBox> in this sample is relatively complex, so this topic uses a simpler example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button>.</span></span>

<a name="changing_the_visual_structure_of_a_control"></a>
## <a name="changing-the-visual-structure-of-a-control"></a><span data-ttu-id="8c5cb-137">變更控制項的視覺結構</span><span class="sxs-lookup"><span data-stu-id="8c5cb-137">Changing the Visual Structure of a Control</span></span>
 <span data-ttu-id="8c5cb-138">在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]中，控制項通常是複合 <xref:System.Windows.FrameworkElement> 物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-138">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], a control is often a composite <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="8c5cb-139">當您建立 <xref:System.Windows.Controls.ControlTemplate>時，您會結合 <xref:System.Windows.FrameworkElement> 物件來建立單一控制項。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-139">When you create a <xref:System.Windows.Controls.ControlTemplate>, you combine <xref:System.Windows.FrameworkElement> objects to build a single control.</span></span> <span data-ttu-id="8c5cb-140"><xref:System.Windows.Controls.ControlTemplate> 只能有一個 <xref:System.Windows.FrameworkElement> 做為其根項目。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-140">A <xref:System.Windows.Controls.ControlTemplate> must have only one <xref:System.Windows.FrameworkElement> as its root element.</span></span> <span data-ttu-id="8c5cb-141">根項目通常包含其他 <xref:System.Windows.FrameworkElement> 物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-141">The root element usually contains other <xref:System.Windows.FrameworkElement> objects.</span></span> <span data-ttu-id="8c5cb-142">這些物件的組合會構成控制項的視覺結構。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-142">The combination of objects makes up the control's visual structure.</span></span>

 <span data-ttu-id="8c5cb-143">下列範例會建立 <xref:System.Windows.Controls.Button>的自訂 <xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-143">The following example creates a custom <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="8c5cb-144"><xref:System.Windows.Controls.ControlTemplate> 會建立 <xref:System.Windows.Controls.Button>的視覺化結構。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-144">The <xref:System.Windows.Controls.ControlTemplate> creates the visual structure of the <xref:System.Windows.Controls.Button>.</span></span> <span data-ttu-id="8c5cb-145">此範例並不會變更您將滑鼠指標移至按鈕上或按一下按鈕時的按鈕外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-145">This example does not change the button's appearance when you move the mouse pointer over it or click it.</span></span> <span data-ttu-id="8c5cb-146">變更按鈕處於不同狀態時的外觀將在本主題稍後討論。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-146">Changing the button's appearance when it is in a different state is discussed later in this topic.</span></span>

 <span data-ttu-id="8c5cb-147">在此範例中，視覺結構是由下列部分所組成：</span><span class="sxs-lookup"><span data-stu-id="8c5cb-147">In this example, the visual structure consists of the following parts:</span></span>

- <span data-ttu-id="8c5cb-148">名為 `RootElement` 的 <xref:System.Windows.Controls.Border>，可作為範本的根 <xref:System.Windows.FrameworkElement>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-148">A <xref:System.Windows.Controls.Border> named `RootElement` that serves as the template's root <xref:System.Windows.FrameworkElement>.</span></span>

- <span data-ttu-id="8c5cb-149">屬於 `RootElement`子系的 <xref:System.Windows.Controls.Grid>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-149">A <xref:System.Windows.Controls.Grid> that is a child of `RootElement`.</span></span>

- <span data-ttu-id="8c5cb-150">顯示按鈕內容的 <xref:System.Windows.Controls.ContentPresenter>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-150">A <xref:System.Windows.Controls.ContentPresenter> that displays the button's content.</span></span> <span data-ttu-id="8c5cb-151"><xref:System.Windows.Controls.ContentPresenter> 可讓您顯示任何類型的物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-151">The <xref:System.Windows.Controls.ContentPresenter> enables any type of object to be displayed.</span></span>

 [!code-xaml[VSMButtonTemplate#BasicTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#basictemplate)]

### <a name="preserving-the-functionality-of-a-controls-properties-by-using-templatebinding"></a><span data-ttu-id="8c5cb-152">使用 TemplateBinding 來保留控制項屬性的功能</span><span class="sxs-lookup"><span data-stu-id="8c5cb-152">Preserving the Functionality of a Control's Properties by Using TemplateBinding</span></span>
 <span data-ttu-id="8c5cb-153">當您建立新的 <xref:System.Windows.Controls.ControlTemplate>時，您仍然可能會想要使用公用屬性來變更控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-153">When you create a new <xref:System.Windows.Controls.ControlTemplate>, you still might want to use the public properties to change the control's appearance.</span></span> <span data-ttu-id="8c5cb-154">[TemplateBinding](../advanced/templatebinding-markup-extension.md)標記延伸會將 <xref:System.Windows.Controls.ControlTemplate> 中元素的屬性系結至控制項所定義的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-154">The [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension binds a property of an element that is in the <xref:System.Windows.Controls.ControlTemplate> to a public property that is defined by the control.</span></span> <span data-ttu-id="8c5cb-155">當您使用 [TemplateBinding](../advanced/templatebinding-markup-extension.md) 時，會讓控制項上的屬性能夠作為範本的參數。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-155">When you use [TemplateBinding](../advanced/templatebinding-markup-extension.md), you enable properties on the control to act as parameters to the template.</span></span> <span data-ttu-id="8c5cb-156">也就是說，已設定控制項上的屬性時，該值會傳遞給具有 [TemplateBinding](../advanced/templatebinding-markup-extension.md) 的元素。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-156">That is, when a property on a control is set, that value is passed on to the element that has the [TemplateBinding](../advanced/templatebinding-markup-extension.md) on it.</span></span>

 <span data-ttu-id="8c5cb-157">下列範例會重複上述範例中的部分，其中使用[TemplateBinding](../advanced/templatebinding-markup-extension.md)標記延伸，將 <xref:System.Windows.Controls.ControlTemplate> 中的專案屬性系結至按鈕所定義的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-157">The following example repeats the part of the preceding example that uses the [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the button.</span></span>

 [!code-xaml[VSMButtonTemplate#TemplateBinding](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#templatebinding)]

 <span data-ttu-id="8c5cb-158">在此範例中，<xref:System.Windows.Controls.Grid> 的 <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> 屬性範本系結至 <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-158">In this example, the <xref:System.Windows.Controls.Grid> has its <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> property template bound to <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="8c5cb-159">因為 <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> 是範本系結，所以您可以建立多個使用相同 <xref:System.Windows.Controls.ControlTemplate> 的按鈕，並將 <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> 設定為每個按鈕上的不同值。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-159">Because <xref:System.Windows.Controls.Panel.Background%2A?displayProperty=nameWithType> is template bound, you can create multiple buttons that use the same <xref:System.Windows.Controls.ControlTemplate> and set the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> to different values on each button.</span></span> <span data-ttu-id="8c5cb-160">如果 <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> 不是系結至 <xref:System.Windows.Controls.ControlTemplate>中專案屬性的範本，則設定按鈕的 <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> 不會影響按鈕的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-160">If <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> was not template bound to a property of an element in the <xref:System.Windows.Controls.ControlTemplate>, setting the <xref:System.Windows.Controls.Control.Background%2A?displayProperty=nameWithType> of a button would have no impact on the button's appearance.</span></span>

 <span data-ttu-id="8c5cb-161">請注意，兩個屬性的名稱不一定要相同。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-161">Note that the names of the two properties do not need to be identical.</span></span> <span data-ttu-id="8c5cb-162">在上述範例中，<xref:System.Windows.Controls.Button> 的 <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> 屬性是系結至 <xref:System.Windows.Controls.ContentPresenter><xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> 屬性的範本。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-162">In the preceding example, the <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.Button> is template bound to the <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType> property of the <xref:System.Windows.Controls.ContentPresenter>.</span></span> <span data-ttu-id="8c5cb-163">這可讓您以水平方式置放按鈕的內容。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-163">This enables the content of the button to be positioned horizontally.</span></span> <span data-ttu-id="8c5cb-164"><xref:System.Windows.Controls.ContentPresenter> 沒有名為 `HorizontalContentAlignment`的屬性，但是 <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> 可以系結至 <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-164"><xref:System.Windows.Controls.ContentPresenter> does not have a property named `HorizontalContentAlignment`, but <xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A?displayProperty=nameWithType> can be bound to <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A?displayProperty=nameWithType>.</span></span> <span data-ttu-id="8c5cb-165">當您的範本繫結某個屬性時，請確定目標與來源屬性是相同類型。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-165">When you template bind a property, be sure that the target and source properties are the same type.</span></span>

 <span data-ttu-id="8c5cb-166"><xref:System.Windows.Controls.Control> 類別定義數個屬性，控制項範本必須使用這些屬性，才能在設定時對控制項產生影響。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-166">The <xref:System.Windows.Controls.Control> class defines several properties that must be used by the control template to have an effect on the control when they are set.</span></span> <span data-ttu-id="8c5cb-167"><xref:System.Windows.Controls.ControlTemplate> 使用屬性的方式取決於屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-167">How the <xref:System.Windows.Controls.ControlTemplate> uses the property depends on the property.</span></span> <span data-ttu-id="8c5cb-168"><xref:System.Windows.Controls.ControlTemplate> 必須以下列其中一種方式使用屬性：</span><span class="sxs-lookup"><span data-stu-id="8c5cb-168">The <xref:System.Windows.Controls.ControlTemplate> must use the property in one of the following ways:</span></span>

- <span data-ttu-id="8c5cb-169"><xref:System.Windows.Controls.ControlTemplate> 範本中的元素會系結至屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-169">An element in the <xref:System.Windows.Controls.ControlTemplate> template binds to the property.</span></span>

- <span data-ttu-id="8c5cb-170"><xref:System.Windows.Controls.ControlTemplate> 中的元素會繼承父 <xref:System.Windows.FrameworkElement>的屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-170">An element in the <xref:System.Windows.Controls.ControlTemplate> inherits the property from a parent <xref:System.Windows.FrameworkElement>.</span></span>

 <span data-ttu-id="8c5cb-171">下表列出控制項從 <xref:System.Windows.Controls.Control> 類別繼承而來的視覺屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-171">The following table lists the visual properties inherited by a control from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="8c5cb-172">它同時也指出控制項的預設控制項範本是否使用繼承的屬性值，或是否必須以範本方式繫結。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-172">It also indicates whether the default control template of a control uses the inherited property value or if it must be template bound.</span></span>

|<span data-ttu-id="8c5cb-173">屬性</span><span class="sxs-lookup"><span data-stu-id="8c5cb-173">Property</span></span>|<span data-ttu-id="8c5cb-174">使用方式</span><span class="sxs-lookup"><span data-stu-id="8c5cb-174">Usage method</span></span>|
|--------------|------------------|
|<xref:System.Windows.Controls.Control.Background%2A>|<span data-ttu-id="8c5cb-175">範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-175">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.BorderThickness%2A>|<span data-ttu-id="8c5cb-176">範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-176">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.BorderBrush%2A>|<span data-ttu-id="8c5cb-177">範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-177">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontFamily%2A>|<span data-ttu-id="8c5cb-178">屬性繼承或範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-178">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontSize%2A>|<span data-ttu-id="8c5cb-179">屬性繼承或範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-179">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontStretch%2A>|<span data-ttu-id="8c5cb-180">屬性繼承或範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-180">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.FontWeight%2A>|<span data-ttu-id="8c5cb-181">屬性繼承或範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-181">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.Foreground%2A>|<span data-ttu-id="8c5cb-182">屬性繼承或範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-182">Property inheritance or template binding</span></span>|
|<xref:System.Windows.Controls.Control.HorizontalContentAlignment%2A>|<span data-ttu-id="8c5cb-183">範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-183">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.Padding%2A>|<span data-ttu-id="8c5cb-184">範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-184">Template binding</span></span>|
|<xref:System.Windows.Controls.Control.VerticalContentAlignment%2A>|<span data-ttu-id="8c5cb-185">範本繫結</span><span class="sxs-lookup"><span data-stu-id="8c5cb-185">Template binding</span></span>|

 <span data-ttu-id="8c5cb-186">資料表只會列出繼承自 <xref:System.Windows.Controls.Control> 類別的視覺屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-186">The table lists only the visual properties inherited from the <xref:System.Windows.Controls.Control> class.</span></span> <span data-ttu-id="8c5cb-187">除了表格中列出的屬性之外，控制項也可以從父 framework 元素繼承 <xref:System.Windows.FrameworkElement.DataContext%2A>、<xref:System.Windows.FrameworkElement.Language%2A>和 <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-187">Apart from the properties listed in the table, a control may also inherit the <xref:System.Windows.FrameworkElement.DataContext%2A>, <xref:System.Windows.FrameworkElement.Language%2A>, and <xref:System.Windows.Controls.TextBlock.TextDecorations%2A> properties from the parent framework element.</span></span>

 <span data-ttu-id="8c5cb-188">此外，如果 <xref:System.Windows.Controls.ContentPresenter> 是在 <xref:System.Windows.Controls.ContentControl>的 <xref:System.Windows.Controls.ControlTemplate> 中，則 <xref:System.Windows.Controls.ContentPresenter> 會自動系結至 <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> 和 <xref:System.Windows.Controls.ContentControl.Content%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-188">Also, if the <xref:System.Windows.Controls.ContentPresenter> is in the <xref:System.Windows.Controls.ControlTemplate> of a <xref:System.Windows.Controls.ContentControl>, the <xref:System.Windows.Controls.ContentPresenter> will automatically bind to the <xref:System.Windows.Controls.ContentControl.ContentTemplate%2A> and <xref:System.Windows.Controls.ContentControl.Content%2A> properties.</span></span> <span data-ttu-id="8c5cb-189">同樣地，在 <xref:System.Windows.Controls.ItemsControl> <xref:System.Windows.Controls.ControlTemplate> 中的 <xref:System.Windows.Controls.ItemsPresenter> 會自動系結至 <xref:System.Windows.Controls.ItemsControl.Items%2A> 和 <xref:System.Windows.Controls.ItemsPresenter> 屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-189">Likewise, an <xref:System.Windows.Controls.ItemsPresenter> that is in the <xref:System.Windows.Controls.ControlTemplate> of an <xref:System.Windows.Controls.ItemsControl> will automatically bind to the <xref:System.Windows.Controls.ItemsControl.Items%2A> and <xref:System.Windows.Controls.ItemsPresenter> properties.</span></span>

 <span data-ttu-id="8c5cb-190">下列範例會建立兩個按鈕，使用上述範例中所定義的 <xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-190">The following example creates two buttons that use the <xref:System.Windows.Controls.ControlTemplate> defined in the preceding example.</span></span> <span data-ttu-id="8c5cb-191">此範例會在每個按鈕上設定 <xref:System.Windows.Controls.Control.Background%2A>、<xref:System.Windows.Controls.Control.Foreground%2A>和 <xref:System.Windows.Controls.Control.FontSize%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-191">The example sets the <xref:System.Windows.Controls.Control.Background%2A>, <xref:System.Windows.Controls.Control.Foreground%2A>, and <xref:System.Windows.Controls.Control.FontSize%2A> properties on each button.</span></span> <span data-ttu-id="8c5cb-192">設定 <xref:System.Windows.Controls.Control.Background%2A> 屬性會造成影響，因為它是在 <xref:System.Windows.Controls.ControlTemplate>中系結的範本。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-192">Setting the <xref:System.Windows.Controls.Control.Background%2A> property has an effect because it is template bound in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="8c5cb-193">雖然 <xref:System.Windows.Controls.Control.Foreground%2A> 和 <xref:System.Windows.Controls.Control.FontSize%2A> 屬性不是範本系結，但設定它們會有效果，因為它們的值會被繼承。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-193">Even though the <xref:System.Windows.Controls.Control.Foreground%2A> and <xref:System.Windows.Controls.Control.FontSize%2A> properties are not template bound, setting them has an effect because their values are inherited.</span></span>

 [!code-xaml[VSMButtonTemplate#ButtonDeclaration](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#buttondeclaration)]

 <span data-ttu-id="8c5cb-194">上述範例會產生類似下圖的輸出。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-194">The preceding example produces output that is similar to the following illustration.</span></span>

 <span data-ttu-id="8c5cb-195">![兩個按鈕，一個為藍色，一個為紫色。](./media/ndp-buttontwo.png "NDP_ButtonTwo")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-195">![Two buttons, one blue and one purple.](./media/ndp-buttontwo.png "NDP_ButtonTwo")</span></span>
<span data-ttu-id="8c5cb-196">兩個具有不同背景色彩的按鈕</span><span class="sxs-lookup"><span data-stu-id="8c5cb-196">Two buttons with different background colors</span></span>

<a name="changing_the_appearance_of_a_control_depending_on_its_state"></a>
## <a name="changing-the-appearance-of-a-control-depending-on-its-state"></a><span data-ttu-id="8c5cb-197">依控制項的狀態變更其外觀</span><span class="sxs-lookup"><span data-stu-id="8c5cb-197">Changing the Appearance of a Control Depending on Its State</span></span>
 <span data-ttu-id="8c5cb-198">具有預設外觀的按鈕與上述範例中按鈕之間的差異在於，預設按鈕在處於不同狀態時會稍微變更。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-198">The difference between a button with its default appearance and the button in the preceding example is that the default button subtly changes when it is in different states.</span></span> <span data-ttu-id="8c5cb-199">例如，預設按鈕會在使用者按下按鈕時，或當滑鼠指標移至按鈕上時，變更外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-199">For example, the default button's appearance changes when the button is pressed, or when the mouse pointer is over the button.</span></span> <span data-ttu-id="8c5cb-200">雖然 <xref:System.Windows.Controls.ControlTemplate> 不會變更控制項的功能，但它確實會變更控制項的視覺行為。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-200">Although the <xref:System.Windows.Controls.ControlTemplate> does not change the functionality of a control, it does change the control's visual behavior.</span></span> <span data-ttu-id="8c5cb-201">視覺行為會描述控制項處於特定狀態時的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-201">A visual behavior describes the control appearance when it is in a certain state.</span></span> <span data-ttu-id="8c5cb-202">若要了解控制項的功能與視覺行為之間有何差異，請思考一下按鈕範例。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-202">To understand the difference between the functionality and visual behavior of a control, consider the button example.</span></span> <span data-ttu-id="8c5cb-203">按鈕的功能是在按一下時引發 <xref:System.Windows.Controls.Primitives.ButtonBase.Click> 事件，但按鈕的視覺效果行為是在指向或按下時變更其外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-203">The button's functionality is to raise the <xref:System.Windows.Controls.Primitives.ButtonBase.Click> event when it is clicked, but the button's visual behavior is to change its appearance when it is pointed to or pressed.</span></span>

 <span data-ttu-id="8c5cb-204">當控制項處於特定狀態時，您可以使用 <xref:System.Windows.VisualState> 物件來指定控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-204">You use <xref:System.Windows.VisualState> objects to specify the appearance of a control when it is in a certain state.</span></span> <span data-ttu-id="8c5cb-205"><xref:System.Windows.VisualState> 包含變更 <xref:System.Windows.Controls.ControlTemplate>中元素外觀的 <xref:System.Windows.Media.Animation.Storyboard>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-205">A <xref:System.Windows.VisualState> contains a <xref:System.Windows.Media.Animation.Storyboard> that changes the appearance of the elements that are in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="8c5cb-206">您不需要撰寫任何程式碼來進行這項操作，因為控制項的邏輯會使用 <xref:System.Windows.VisualStateManager>來變更狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-206">You do not have to write any code to make this occur because the control's logic changes state by using the <xref:System.Windows.VisualStateManager>.</span></span> <span data-ttu-id="8c5cb-207">當控制項進入 [<xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType>] 屬性所指定的狀態時，<xref:System.Windows.Media.Animation.Storyboard> 就會開始。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-207">When the control enters the state that is specified by the <xref:System.Windows.VisualState.Name%2A?displayProperty=nameWithType> property, the <xref:System.Windows.Media.Animation.Storyboard> begins.</span></span> <span data-ttu-id="8c5cb-208">當控制項離開狀態時，<xref:System.Windows.Media.Animation.Storyboard> 會停止。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-208">When the control exits the state, the <xref:System.Windows.Media.Animation.Storyboard> stops.</span></span>

 <span data-ttu-id="8c5cb-209">下列範例顯示當滑鼠指標移至 <xref:System.Windows.Controls.Button> 時，變更其外觀的 <xref:System.Windows.VisualState>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-209">The following example shows the <xref:System.Windows.VisualState> that changes the appearance of a <xref:System.Windows.Controls.Button> when the mouse pointer is over it.</span></span> <span data-ttu-id="8c5cb-210"><xref:System.Windows.Media.Animation.Storyboard> 藉由變更 `BorderBrush`的色彩來變更按鈕的框線色彩。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-210">The <xref:System.Windows.Media.Animation.Storyboard> changes the button's border color by changing the color of the `BorderBrush`.</span></span> <span data-ttu-id="8c5cb-211">如果您參考本主題開頭的 <xref:System.Windows.Controls.ControlTemplate> 範例，您會記得 `BorderBrush` 是指派給 <xref:System.Windows.Controls.Border>之 <xref:System.Windows.Controls.Border.Background%2A> 的 <xref:System.Windows.Media.SolidColorBrush> 名稱。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-211">If you refer to the <xref:System.Windows.Controls.ControlTemplate> example at the beginning of this topic, you will recall that `BorderBrush` is the name of the <xref:System.Windows.Media.SolidColorBrush> that is assigned to the <xref:System.Windows.Controls.Border.Background%2A> of the <xref:System.Windows.Controls.Border>.</span></span>

 [!code-xaml[VSMButtonTemplate#4](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#4)]

 <span data-ttu-id="8c5cb-212">控制項需負責在定義其控制項合約時一併定義狀態，本主題稍後的[透過了解控制項合約來自訂其他控制項](#customizing_other_controls_by_understanding_the_control_contract)中會詳細討論。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-212">The control is responsible for defining the states as part of its control contract, which is discussed in detail in [Customizing Other Controls by Understanding the Control Contract](#customizing_other_controls_by_understanding_the_control_contract) later in this topic.</span></span> <span data-ttu-id="8c5cb-213">下表列出針對 <xref:System.Windows.Controls.Button>所指定的狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-213">The following table lists the states that are specified for the <xref:System.Windows.Controls.Button>.</span></span>

|<span data-ttu-id="8c5cb-214">VisualState 名稱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-214">VisualState Name</span></span>|<span data-ttu-id="8c5cb-215">VisualStateGroup 名稱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-215">VisualStateGroup Name</span></span>|<span data-ttu-id="8c5cb-216">描述</span><span class="sxs-lookup"><span data-stu-id="8c5cb-216">Description</span></span>|
|----------------------|---------------------------|-----------------|
|<span data-ttu-id="8c5cb-217">一般</span><span class="sxs-lookup"><span data-stu-id="8c5cb-217">Normal</span></span>|<span data-ttu-id="8c5cb-218">CommonStates</span><span class="sxs-lookup"><span data-stu-id="8c5cb-218">CommonStates</span></span>|<span data-ttu-id="8c5cb-219">預設狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-219">The default state.</span></span>|
|<span data-ttu-id="8c5cb-220">MouseOver</span><span class="sxs-lookup"><span data-stu-id="8c5cb-220">MouseOver</span></span>|<span data-ttu-id="8c5cb-221">CommonStates</span><span class="sxs-lookup"><span data-stu-id="8c5cb-221">CommonStates</span></span>|<span data-ttu-id="8c5cb-222">滑鼠指標移到控制項上。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-222">The mouse pointer is positioned over the control.</span></span>|
|<span data-ttu-id="8c5cb-223">按下</span><span class="sxs-lookup"><span data-stu-id="8c5cb-223">Pressed</span></span>|<span data-ttu-id="8c5cb-224">CommonStates</span><span class="sxs-lookup"><span data-stu-id="8c5cb-224">CommonStates</span></span>|<span data-ttu-id="8c5cb-225">已按下控制項。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-225">The control is pressed.</span></span>|
|<span data-ttu-id="8c5cb-226">Disabled</span><span class="sxs-lookup"><span data-stu-id="8c5cb-226">Disabled</span></span>|<span data-ttu-id="8c5cb-227">CommonStates</span><span class="sxs-lookup"><span data-stu-id="8c5cb-227">CommonStates</span></span>|<span data-ttu-id="8c5cb-228">已停用控制項。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-228">The control is disabled.</span></span>|
|<span data-ttu-id="8c5cb-229">已取得焦點</span><span class="sxs-lookup"><span data-stu-id="8c5cb-229">Focused</span></span>|<span data-ttu-id="8c5cb-230">FocusStates</span><span class="sxs-lookup"><span data-stu-id="8c5cb-230">FocusStates</span></span>|<span data-ttu-id="8c5cb-231">控制項已取得焦點。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-231">The control has focus.</span></span>|
|<span data-ttu-id="8c5cb-232">未取得焦點</span><span class="sxs-lookup"><span data-stu-id="8c5cb-232">Unfocused</span></span>|<span data-ttu-id="8c5cb-233">FocusStates</span><span class="sxs-lookup"><span data-stu-id="8c5cb-233">FocusStates</span></span>|<span data-ttu-id="8c5cb-234">控制項未取得焦點。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-234">The control does not have focus.</span></span>|

 <span data-ttu-id="8c5cb-235"><xref:System.Windows.Controls.Button> 會定義兩個狀態群組： `CommonStates` 群組包含 `Normal`、`MouseOver`、`Pressed`和 `Disabled` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-235">The <xref:System.Windows.Controls.Button> defines two state groups: the `CommonStates` group contains the `Normal`, `MouseOver`, `Pressed`, and `Disabled` states.</span></span> <span data-ttu-id="8c5cb-236">`FocusStates` 群組則包含 `Focused` 和 `Unfocused` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-236">The `FocusStates` group contains the `Focused` and `Unfocused` states.</span></span> <span data-ttu-id="8c5cb-237">相同狀態群組中的狀態彼此互斥。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-237">States in the same state group are mutually exclusive.</span></span> <span data-ttu-id="8c5cb-238">控制項就每一群組而言一律僅限處於一種狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-238">The control is always in exactly one state per group.</span></span> <span data-ttu-id="8c5cb-239">例如，即使滑鼠指標不在上方，<xref:System.Windows.Controls.Button> 也可以擁有焦點，因此 `Focused` 狀態中的 <xref:System.Windows.Controls.Button> 可以是 `MouseOver`、`Pressed`或 `Normal` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-239">For example, a <xref:System.Windows.Controls.Button> can have focus even when the mouse pointer is not over it, so a <xref:System.Windows.Controls.Button> in the `Focused` state can be in the `MouseOver`, `Pressed`, or `Normal` state.</span></span>

 <span data-ttu-id="8c5cb-240">您可以將 <xref:System.Windows.VisualState> 物件新增至 <xref:System.Windows.VisualStateGroup> 物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-240">You add <xref:System.Windows.VisualState> objects to <xref:System.Windows.VisualStateGroup> objects.</span></span> <span data-ttu-id="8c5cb-241">您可以將 <xref:System.Windows.VisualStateGroup> 物件加入至 <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> 附加屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-241">You add <xref:System.Windows.VisualStateGroup> objects to the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property.</span></span> <span data-ttu-id="8c5cb-242">下列範例會定義 `Normal`、`MouseOver`和 `Pressed` 狀態的 <xref:System.Windows.VisualState> 物件，這些都是在 `CommonStates` 群組中。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-242">The following example defines the <xref:System.Windows.VisualState> objects for the `Normal`, `MouseOver`, and `Pressed` states, which are all in the `CommonStates` group.</span></span> <span data-ttu-id="8c5cb-243">每個 <xref:System.Windows.VisualState> 的 <xref:System.Windows.VisualState.Name%2A> 符合上表中的名稱。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-243">The <xref:System.Windows.VisualState.Name%2A> of each <xref:System.Windows.VisualState> matches the name in the preceding table.</span></span> <span data-ttu-id="8c5cb-244">為了簡化範例，已省略 `Disabled` 狀態及`FocusStates` 群組中的狀態，但在本主題結尾的完整範例中已將它們都包含在內。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-244">The `Disabled` state and the states in the `FocusStates` group are omitted to keep the example short, but they are included in the entire example at the end of this topic.</span></span>

> [!NOTE]
> <span data-ttu-id="8c5cb-245">請務必在 <xref:System.Windows.Controls.ControlTemplate>的根 <xref:System.Windows.FrameworkElement> 上設定 <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> 附加屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-245">Be sure to set the <xref:System.Windows.VisualStateManager.VisualStateGroups%2A?displayProperty=nameWithType> attached property on the root <xref:System.Windows.FrameworkElement> of the <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 [!code-xaml[VSMButtonTemplate#VisualStates](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualstates)]

 <span data-ttu-id="8c5cb-246">上述範例會產生類似下列圖例的輸出。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-246">The preceding example produces output that is similar to the following illustrations.</span></span>

 <span data-ttu-id="8c5cb-247">![搭配自訂控制項範本的按鈕。](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-247">![A button with a custom control template.](./media/ndp-buttonnormal.png "NDP_ButtonNormal")</span></span>
<span data-ttu-id="8c5cb-248">使用處於正常狀態之自訂控制項範本的按鈕</span><span class="sxs-lookup"><span data-stu-id="8c5cb-248">A button that uses a custom control template in the normal state</span></span>

 <span data-ttu-id="8c5cb-249">![具有紅色外框的按鈕。](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-249">![A button with a red border.](./media/ndp-buttonmouseover.png "NDP_ButtonMouseOver")</span></span>
<span data-ttu-id="8c5cb-250">使用處於滑鼠移至上方狀態之自訂控制項範本的按鈕</span><span class="sxs-lookup"><span data-stu-id="8c5cb-250">A button that uses a custom control template in the mouse over state</span></span>

 <span data-ttu-id="8c5cb-251">![在已按下的按鈕上框線呈現透明。](./media/ndp-buttonpressed.png "NDP_ButtonPressed")</span><span class="sxs-lookup"><span data-stu-id="8c5cb-251">![The border is transparent on a pressed button.](./media/ndp-buttonpressed.png "NDP_ButtonPressed")</span></span>
<span data-ttu-id="8c5cb-252">使用處於已按下狀態之自訂控制項範本的按鈕</span><span class="sxs-lookup"><span data-stu-id="8c5cb-252">A button that uses a custom control template in the pressed state</span></span>

 <span data-ttu-id="8c5cb-253">若要尋找 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 隨附之控制項的視覺狀態，請參閱[控制項的樣式和範本](control-styles-and-templates.md)。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-253">To find the visual states for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](control-styles-and-templates.md).</span></span>

<a name="specifying_the_behavior_of_a_control_when_it_transitions_between_states"></a>
## <a name="specifying-the-behavior-of-a-control-when-it-transitions-between-states"></a><span data-ttu-id="8c5cb-254">指定控制項在狀態之間轉換時的行為</span><span class="sxs-lookup"><span data-stu-id="8c5cb-254">Specifying the Behavior of a Control When It Transitions Between States</span></span>
 <span data-ttu-id="8c5cb-255">在上述範例中，在使用者按一下按鈕時，按鈕的外觀也會變更，但除非按下按鈕整整一秒，否則使用者並不會看到效果。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-255">In the preceding example, the appearance of the button also changes when the user clicks it, but unless the button is pressed for a full second, the user does not see the effect.</span></span> <span data-ttu-id="8c5cb-256">動畫預設要一秒鐘的時間才會產生。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-256">By default, the animation takes one second to occur.</span></span> <span data-ttu-id="8c5cb-257">由於使用者很可能會按一下並放開按鈕，因此如果您將 <xref:System.Windows.Controls.ControlTemplate> 保持在預設狀態，視覺效果的意見反應將無法生效。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-257">Because users are likely to click and release a button in much less time, the visual feedback will not be effective if you leave the <xref:System.Windows.Controls.ControlTemplate> in its default state.</span></span>

 <span data-ttu-id="8c5cb-258">您可以藉由將 <xref:System.Windows.VisualTransition> 物件加入至 <xref:System.Windows.Controls.ControlTemplate>，指定動畫發生的時間量，以順利地將控制項從某個狀態轉換成另一個狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-258">You can specify the amount of time that it takes an animation to occur to smoothly transition a control from one state to another by adding <xref:System.Windows.VisualTransition> objects to the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="8c5cb-259">當您建立 <xref:System.Windows.VisualTransition>時，您可以指定下列一或多個步驟：</span><span class="sxs-lookup"><span data-stu-id="8c5cb-259">When you create a <xref:System.Windows.VisualTransition>, you specify one or more of the following:</span></span>

- <span data-ttu-id="8c5cb-260">狀態之間進行轉換所需的時間。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-260">The time it takes for a transition between states to occur.</span></span>

- <span data-ttu-id="8c5cb-261">在轉換時發生的其他控制項外觀變更。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-261">Additional changes in the control's appearance that occur at the time of the transition.</span></span>

- <span data-ttu-id="8c5cb-262"><xref:System.Windows.VisualTransition> 適用的狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-262">Which states the <xref:System.Windows.VisualTransition> is applied to.</span></span>

### <a name="specifying-the-duration-of-a-transition"></a><span data-ttu-id="8c5cb-263">指定轉換的持續時間</span><span class="sxs-lookup"><span data-stu-id="8c5cb-263">Specifying the Duration of a Transition</span></span>
 <span data-ttu-id="8c5cb-264">您可以藉由設定 <xref:System.Windows.VisualTransition.GeneratedDuration%2A> 屬性來指定轉換所需的時間長度。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-264">You can specify how long a transition takes by setting the <xref:System.Windows.VisualTransition.GeneratedDuration%2A> property.</span></span> <span data-ttu-id="8c5cb-265">上述範例有一個 <xref:System.Windows.VisualState>，指定按鈕的框線在按下按鈕時，會變成透明的，但如果按鈕快速按下並放開，動畫會花太長的時間才會明顯。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-265">The preceding example has a <xref:System.Windows.VisualState> that specifies that the button's border becomes transparent when the button is pressed, but the animation takes too long to be noticeable if the button is quickly pressed and released.</span></span> <span data-ttu-id="8c5cb-266">您可以使用 <xref:System.Windows.VisualTransition> 來指定控制項轉換為按下狀態所需的時間量。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-266">You can use a <xref:System.Windows.VisualTransition> to specify the amount of time it takes the control to transition into the pressed state.</span></span> <span data-ttu-id="8c5cb-267">下列範例會指定控制項需要 1/100 秒的時間來進入已按下狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-267">The following example specifies that the control takes one hundredth of a second to go into the pressed state.</span></span>

 [!code-xaml[VSMButtonTemplate#PressedTransition](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#pressedtransition)]

### <a name="specifying-changes-to-the-controls-appearance-during-a-transition"></a><span data-ttu-id="8c5cb-268">指定轉換時對控制項外觀造成的變更</span><span class="sxs-lookup"><span data-stu-id="8c5cb-268">Specifying Changes to the Control's Appearance During a Transition</span></span>
 <span data-ttu-id="8c5cb-269"><xref:System.Windows.VisualTransition> 包含 <xref:System.Windows.Media.Animation.Storyboard>，會在控制項在狀態之間轉換時開始。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-269">The <xref:System.Windows.VisualTransition> contains a <xref:System.Windows.Media.Animation.Storyboard> that begins when the control transitions between states.</span></span> <span data-ttu-id="8c5cb-270">例如，您可以指定在控制項從 `MouseOver` 狀態轉換到 `Normal` 狀態時產生動畫。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-270">For example, you can specify that a certain animation occurs when the control transitions from the `MouseOver` state to the `Normal` State.</span></span> <span data-ttu-id="8c5cb-271">下列範例會建立一個 <xref:System.Windows.VisualTransition>，指定當使用者將滑鼠指標移開按鈕時，按鈕的框線會變更為藍色，然後變成黃色，而在1.5 秒中則為黑色。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-271">The following example creates a <xref:System.Windows.VisualTransition> that specifies that when the user moves the mouse pointer away from the button, the button's border changes to blue, then to yellow, then to black in 1.5 seconds.</span></span>

 [!code-xaml[VSMButtonTemplate#8](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#8)]

### <a name="specifying-when-a-visualtransition-is-applied"></a><span data-ttu-id="8c5cb-272">指定套用 VisualTransition 的時機</span><span class="sxs-lookup"><span data-stu-id="8c5cb-272">Specifying When a VisualTransition Is Applied</span></span>
 <span data-ttu-id="8c5cb-273"><xref:System.Windows.VisualTransition> 可以限制為僅適用于特定狀態，或可在控制項于狀態之間轉換時套用。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-273">A <xref:System.Windows.VisualTransition> can be restricted to apply to only certain states, or it can be applied any time the control transitions between states.</span></span> <span data-ttu-id="8c5cb-274">在上述範例中，當控制項從 `MouseOver` 狀態變成 `Normal` 狀態時，就會套用 <xref:System.Windows.VisualTransition>;在上述範例中，當控制項進入 `Pressed` 狀態時，就會套用 <xref:System.Windows.VisualTransition>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-274">In the preceding example, the <xref:System.Windows.VisualTransition> is applied when the control goes from the `MouseOver` state to the `Normal` state; in the example before that, the <xref:System.Windows.VisualTransition> is applied when the control goes into the `Pressed` state.</span></span> <span data-ttu-id="8c5cb-275">您可以藉由設定 <xref:System.Windows.VisualTransition.To%2A> 和 <xref:System.Windows.VisualTransition.From%2A> 屬性來限制何時套用 <xref:System.Windows.VisualTransition>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-275">You restrict when a <xref:System.Windows.VisualTransition> is applied by setting the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties.</span></span> <span data-ttu-id="8c5cb-276">下表說明限制的層級 (依最嚴格到最不嚴格的順序排列)。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-276">The following table describes the levels of restriction from most restrictive to least restrictive.</span></span>

|<span data-ttu-id="8c5cb-277">限制的類型</span><span class="sxs-lookup"><span data-stu-id="8c5cb-277">Type of restriction</span></span>|<span data-ttu-id="8c5cb-278">來源的值</span><span class="sxs-lookup"><span data-stu-id="8c5cb-278">Value of From</span></span>|<span data-ttu-id="8c5cb-279">目標的值</span><span class="sxs-lookup"><span data-stu-id="8c5cb-279">Value of To</span></span>|
|-------------------------|-------------------|-----------------|
|<span data-ttu-id="8c5cb-280">從指定的狀態到另一個指定的狀態</span><span class="sxs-lookup"><span data-stu-id="8c5cb-280">From a specified state to another specified state</span></span>|<span data-ttu-id="8c5cb-281"><xref:System.Windows.VisualState> 的名稱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-281">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="8c5cb-282"><xref:System.Windows.VisualState> 的名稱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-282">The name of a <xref:System.Windows.VisualState></span></span>|
|<span data-ttu-id="8c5cb-283">從任何狀態到指定的狀態</span><span class="sxs-lookup"><span data-stu-id="8c5cb-283">From any state to a specified state</span></span>|<span data-ttu-id="8c5cb-284">未設定</span><span class="sxs-lookup"><span data-stu-id="8c5cb-284">Not set</span></span>|<span data-ttu-id="8c5cb-285"><xref:System.Windows.VisualState> 的名稱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-285">The name of a <xref:System.Windows.VisualState></span></span>|
|<span data-ttu-id="8c5cb-286">從指定的狀態到任何狀態</span><span class="sxs-lookup"><span data-stu-id="8c5cb-286">From a specified state to any state</span></span>|<span data-ttu-id="8c5cb-287"><xref:System.Windows.VisualState> 的名稱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-287">The name of a <xref:System.Windows.VisualState></span></span>|<span data-ttu-id="8c5cb-288">未設定</span><span class="sxs-lookup"><span data-stu-id="8c5cb-288">Not set</span></span>|
|<span data-ttu-id="8c5cb-289">從任何狀態到任何其他狀態</span><span class="sxs-lookup"><span data-stu-id="8c5cb-289">From any state to any other state</span></span>|<span data-ttu-id="8c5cb-290">未設定</span><span class="sxs-lookup"><span data-stu-id="8c5cb-290">Not set</span></span>|<span data-ttu-id="8c5cb-291">未設定</span><span class="sxs-lookup"><span data-stu-id="8c5cb-291">Not set</span></span>|

 <span data-ttu-id="8c5cb-292">您可以在 <xref:System.Windows.VisualStateGroup> 中有多個 <xref:System.Windows.VisualTransition> 物件參考相同的狀態，但它們將會依照上一個資料表指定的順序來使用。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-292">You can have multiple <xref:System.Windows.VisualTransition> objects in a <xref:System.Windows.VisualStateGroup> that refer to the same state, but they will be used in the order that the previous table specifies.</span></span> <span data-ttu-id="8c5cb-293">在下列範例中，有兩個 <xref:System.Windows.VisualTransition> 物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-293">In the following example, there are two <xref:System.Windows.VisualTransition> objects.</span></span> <span data-ttu-id="8c5cb-294">當控制項從 `Pressed` 狀態轉換為 `MouseOver` 狀態時，會使用同時具有 <xref:System.Windows.VisualTransition.From%2A> 和 <xref:System.Windows.VisualTransition.To%2A> 集的 <xref:System.Windows.VisualTransition>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-294">When the control transitions from the `Pressed` state to the `MouseOver` state, the <xref:System.Windows.VisualTransition> that has both <xref:System.Windows.VisualTransition.From%2A> and <xref:System.Windows.VisualTransition.To%2A> set is used.</span></span> <span data-ttu-id="8c5cb-295">當控制項從不是 `Pressed` 的狀態轉換到 `MouseOver` 狀態時，則會使用另一個狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-295">When the control transitions from a state that is not `Pressed` to the `MouseOver` state, the other state is used.</span></span>

 [!code-xaml[VSMButtonTemplate#7](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#7)]

 <span data-ttu-id="8c5cb-296"><xref:System.Windows.VisualStateGroup> 具有 <xref:System.Windows.VisualStateGroup.Transitions%2A> 屬性，其中包含適用于 <xref:System.Windows.VisualStateGroup>中 <xref:System.Windows.VisualState> 物件的 <xref:System.Windows.VisualTransition> 物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-296">The <xref:System.Windows.VisualStateGroup> has a <xref:System.Windows.VisualStateGroup.Transitions%2A> property that contains the <xref:System.Windows.VisualTransition> objects that apply to the <xref:System.Windows.VisualState> objects in the <xref:System.Windows.VisualStateGroup>.</span></span> <span data-ttu-id="8c5cb-297">身為 <xref:System.Windows.Controls.ControlTemplate> 的作者，您可以隨意包含任何您想要的 <xref:System.Windows.VisualTransition>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-297">As the <xref:System.Windows.Controls.ControlTemplate> author, you are free to include any <xref:System.Windows.VisualTransition> you want.</span></span> <span data-ttu-id="8c5cb-298">不過，如果 <xref:System.Windows.VisualTransition.To%2A> 和 <xref:System.Windows.VisualTransition.From%2A> 屬性設定為不在 <xref:System.Windows.VisualStateGroup>中的狀態名稱，則會忽略 <xref:System.Windows.VisualTransition>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-298">However, if the <xref:System.Windows.VisualTransition.To%2A> and <xref:System.Windows.VisualTransition.From%2A> properties are set to state names that are not in the <xref:System.Windows.VisualStateGroup>, the <xref:System.Windows.VisualTransition> is ignored.</span></span>

 <span data-ttu-id="8c5cb-299">下列範例顯示 `CommonStates`的 <xref:System.Windows.VisualStateGroup>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-299">The following example shows the <xref:System.Windows.VisualStateGroup> for the `CommonStates`.</span></span> <span data-ttu-id="8c5cb-300">此範例會針對每個按鈕的下列轉換定義 <xref:System.Windows.VisualTransition>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-300">The example defines a <xref:System.Windows.VisualTransition> for each of the button's following transitions.</span></span>

- <span data-ttu-id="8c5cb-301">轉換到 `Pressed` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-301">To the `Pressed` state.</span></span>

- <span data-ttu-id="8c5cb-302">轉換到 `MouseOver` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-302">To the `MouseOver` state.</span></span>

- <span data-ttu-id="8c5cb-303">從 `Pressed` 狀態轉換到 `MouseOver` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-303">From the `Pressed` state to the `MouseOver` state.</span></span>

- <span data-ttu-id="8c5cb-304">從 `MouseOver` 狀態轉換到 `Normal` 狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-304">From the `MouseOver` state to the `Normal` state.</span></span>

 [!code-xaml[VSMButtonTemplate#VisualTransitions](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/buttonstages.xaml#visualtransitions)]

<a name="customizing_other_controls_by_understanding_the_control_contract"></a>
## <a name="customizing-other-controls-by-understanding-the-control-contract"></a><span data-ttu-id="8c5cb-305">透過了解控制項合約來自訂其他控制項</span><span class="sxs-lookup"><span data-stu-id="8c5cb-305">Customizing Other Controls by Understanding the Control Contract</span></span>
 <span data-ttu-id="8c5cb-306">使用 <xref:System.Windows.Controls.ControlTemplate> 來指定其視覺化結構（藉由使用 <xref:System.Windows.FrameworkElement> 物件）和視覺行為（藉由使用 <xref:System.Windows.VisualState> 物件）的控制項會使用元件控制項模型。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-306">A control that uses a <xref:System.Windows.Controls.ControlTemplate> to specify its visual structure (by using <xref:System.Windows.FrameworkElement> objects) and visual behavior (by using <xref:System.Windows.VisualState> objects) uses the parts control model.</span></span> <span data-ttu-id="8c5cb-307">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 隨附的許多控制項都使用此模型。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-307">Many of the controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 4 use this model.</span></span> <span data-ttu-id="8c5cb-308"><xref:System.Windows.Controls.ControlTemplate> 作者必須注意的部分，會透過控制合約進行通訊。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-308">The parts that a <xref:System.Windows.Controls.ControlTemplate> author needs to be aware of are communicated through the control contract.</span></span> <span data-ttu-id="8c5cb-309">在您了解控制項合約的組件之後，即可自訂任何使用組件控制項模型之控制項的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-309">When you understand the parts of a control contract, you can customize the appearance of any control that uses the parts control model.</span></span>

 <span data-ttu-id="8c5cb-310">控制項合約有三個元素：</span><span class="sxs-lookup"><span data-stu-id="8c5cb-310">A control contract has three elements:</span></span>

- <span data-ttu-id="8c5cb-311">控制項邏輯所使用的視覺元素。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-311">The visual elements that the control's logic uses.</span></span>

- <span data-ttu-id="8c5cb-312">控制項的狀態及每個狀態所屬的群組。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-312">The states of the control and the group each state belongs to.</span></span>

- <span data-ttu-id="8c5cb-313">在視覺上影響控制項的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-313">The public properties that visually affect the control.</span></span>

### <a name="visual-elements-in-the-control-contract"></a><span data-ttu-id="8c5cb-314">控制項合約中的視覺元素</span><span class="sxs-lookup"><span data-stu-id="8c5cb-314">Visual Elements in the Control Contract</span></span>
 <span data-ttu-id="8c5cb-315">有時候，控制項的邏輯會與 <xref:System.Windows.Controls.ControlTemplate>中的 <xref:System.Windows.FrameworkElement> 互動。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-315">Sometimes a control's logic interacts with a <xref:System.Windows.FrameworkElement> that is in the <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="8c5cb-316">例如，控制項可能會處理它其中一個元素的事件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-316">For example, the control might handle an event of one of its elements.</span></span> <span data-ttu-id="8c5cb-317">當控制項預期在 <xref:System.Windows.Controls.ControlTemplate>中尋找特定的 <xref:System.Windows.FrameworkElement> 時，必須將該資訊傳達給 <xref:System.Windows.Controls.ControlTemplate> 的作者。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-317">When a control expects to find a particular <xref:System.Windows.FrameworkElement> in the <xref:System.Windows.Controls.ControlTemplate>, it must convey that information to the <xref:System.Windows.Controls.ControlTemplate> author.</span></span> <span data-ttu-id="8c5cb-318">控制項會使用 <xref:System.Windows.TemplatePartAttribute> 來傳達預期的專案類型，以及元素的名稱。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-318">The control uses the <xref:System.Windows.TemplatePartAttribute> to convey the type of element that is expected, and what the name of the element should be.</span></span> <span data-ttu-id="8c5cb-319"><xref:System.Windows.Controls.Button> 在其控制合約中沒有 <xref:System.Windows.FrameworkElement> 部分，但其他控制項（例如 <xref:System.Windows.Controls.ComboBox>）則會這麼做。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-319">The <xref:System.Windows.Controls.Button> does not have <xref:System.Windows.FrameworkElement> parts in its control contract, but other controls, such as the <xref:System.Windows.Controls.ComboBox>, do.</span></span>

 <span data-ttu-id="8c5cb-320">下列範例顯示在 <xref:System.Windows.Controls.ComboBox> 類別上指定的 <xref:System.Windows.TemplatePartAttribute> 物件。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-320">The following example shows the <xref:System.Windows.TemplatePartAttribute> objects that are specified on the <xref:System.Windows.Controls.ComboBox> class.</span></span> <span data-ttu-id="8c5cb-321"><xref:System.Windows.Controls.ComboBox> 的邏輯預期會在其 `PART_Popup` 中尋找名為 `PART_EditableTextBox` 的 <xref:System.Windows.Controls.TextBox> 和名為 <xref:System.Windows.Controls.ControlTemplate>的 <xref:System.Windows.Controls.Primitives.Popup>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-321">The logic of <xref:System.Windows.Controls.ComboBox> expects to find a <xref:System.Windows.Controls.TextBox> named `PART_EditableTextBox` and a <xref:System.Windows.Controls.Primitives.Popup> named `PART_Popup` in its <xref:System.Windows.Controls.ControlTemplate>.</span></span>

 [!code-csharp[VSMButtonTemplate#ComboBoxContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#comboboxcontract)]
 [!code-vb[VSMButtonTemplate#ComboBoxContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#comboboxcontract)]

 <span data-ttu-id="8c5cb-322">下列範例顯示 <xref:System.Windows.Controls.ComboBox> 的簡化 <xref:System.Windows.Controls.ControlTemplate>，其中包含 <xref:System.Windows.Controls.ComboBox> 類別上 <xref:System.Windows.TemplatePartAttribute> 物件所指定的元素。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-322">The following example shows a simplified <xref:System.Windows.Controls.ControlTemplate> for the <xref:System.Windows.Controls.ComboBox> that includes the elements that are specified by the <xref:System.Windows.TemplatePartAttribute> objects on the <xref:System.Windows.Controls.ComboBox> class.</span></span>

 [!code-xaml[VSMButtonTemplate#ComboBoxTemplate](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/window1.xaml#comboboxtemplate)]

### <a name="states-in-the-control-contract"></a><span data-ttu-id="8c5cb-323">控制項合約中的狀態</span><span class="sxs-lookup"><span data-stu-id="8c5cb-323">States in the Control Contract</span></span>
 <span data-ttu-id="8c5cb-324">控制項的狀態也是控制項合約的一部分。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-324">The states of a control are also a part of the control contract.</span></span> <span data-ttu-id="8c5cb-325">建立 <xref:System.Windows.Controls.Button> 之 <xref:System.Windows.Controls.ControlTemplate> 的範例會顯示如何根據其狀態來指定 <xref:System.Windows.Controls.Button> 的外觀。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-325">The example of creating a <xref:System.Windows.Controls.ControlTemplate> for a <xref:System.Windows.Controls.Button> shows how to specify the appearance of a <xref:System.Windows.Controls.Button> depending on its states.</span></span> <span data-ttu-id="8c5cb-326">您會針對每個指定的狀態建立 <xref:System.Windows.VisualState>，並將共用 <xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A> 的所有 <xref:System.Windows.VisualState> 物件放在 <xref:System.Windows.VisualStateGroup>中，如根據本主題稍早的[狀態變更控制項的外觀](#changing_the_appearance_of_a_control_depending_on_its_state)中所述。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-326">You create a <xref:System.Windows.VisualState> for each specified state and put all <xref:System.Windows.VisualState> objects that share a <xref:System.Windows.TemplateVisualStateAttribute.GroupName%2A> in a <xref:System.Windows.VisualStateGroup>, as described in [Changing the Appearance of a Control Depending on Its State](#changing_the_appearance_of_a_control_depending_on_its_state) earlier in this topic.</span></span> <span data-ttu-id="8c5cb-327">協力廠商控制項應該使用 <xref:System.Windows.TemplateVisualStateAttribute>來指定狀態，這樣就能讓設計工具（例如 Visual Studio 和 Blend for Visual Studio 中的[XAML 設計工具](/visualstudio/xaml-tools/designing-xaml-in-visual-studio)）公開控制項的撰寫控制項範本狀態。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-327">Third-party controls should specify states by using the <xref:System.Windows.TemplateVisualStateAttribute>, which enables designer tools, such as the [XAML Designer](/visualstudio/xaml-tools/designing-xaml-in-visual-studio) in Visual Studio and Blend for Visual Studio, to expose the control's states for authoring control templates.</span></span>

 <span data-ttu-id="8c5cb-328">若要尋找 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 隨附之控制項的控制項合約，請參閱[控制項的樣式和範本](control-styles-and-templates.md)。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-328">To find the control contract for controls that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Control Styles and Templates](control-styles-and-templates.md).</span></span>

### <a name="properties-in-the-control-contract"></a><span data-ttu-id="8c5cb-329">控制項合約中的屬性</span><span class="sxs-lookup"><span data-stu-id="8c5cb-329">Properties in the Control Contract</span></span>
 <span data-ttu-id="8c5cb-330">在視覺上影響控制項的公用屬性也包含在控制項合約中。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-330">The public properties that visually affect the control are also included in the control contract.</span></span> <span data-ttu-id="8c5cb-331">您可以設定這些屬性來變更控制項的外觀，而不需要建立新的 <xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-331">You can set these properties to change the appearance of the control without creating a new <xref:System.Windows.Controls.ControlTemplate>.</span></span> <span data-ttu-id="8c5cb-332">您也可以使用[TemplateBinding](../advanced/templatebinding-markup-extension.md)標記延伸，將 <xref:System.Windows.Controls.ControlTemplate> 中的專案屬性系結至 <xref:System.Windows.Controls.Button>所定義的公用屬性。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-332">You can also use the [TemplateBinding](../advanced/templatebinding-markup-extension.md) markup extension to bind properties of elements that are in the <xref:System.Windows.Controls.ControlTemplate> to public properties that are defined by the <xref:System.Windows.Controls.Button>.</span></span>

 <span data-ttu-id="8c5cb-333">下列範例示範按鈕的控制項合約。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-333">The following example shows the control contract for the button.</span></span>

 [!code-csharp[VSMButtonTemplate#ButtonContract](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/controlcontracts.cs#buttoncontract)]
 [!code-vb[VSMButtonTemplate#ButtonContract](~/samples/snippets/visualbasic/VS_Snippets_Wpf/vsmbuttontemplate/visualbasic/window1.xaml.vb#buttoncontract)]

 <span data-ttu-id="8c5cb-334">建立 <xref:System.Windows.Controls.ControlTemplate>時，最簡單的方式是從現有的 <xref:System.Windows.Controls.ControlTemplate> 開始，並對其進行變更。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-334">When creating a <xref:System.Windows.Controls.ControlTemplate>, it is often easiest to begin with an existing <xref:System.Windows.Controls.ControlTemplate> and make changes to it.</span></span> <span data-ttu-id="8c5cb-335">您可以執行下列其中一項動作來變更現有的 <xref:System.Windows.Controls.ControlTemplate>：</span><span class="sxs-lookup"><span data-stu-id="8c5cb-335">You can do one of the following to change an existing <xref:System.Windows.Controls.ControlTemplate>:</span></span>

- <span data-ttu-id="8c5cb-336">使用設計工具（例如 Blend for Visual Studio），提供用來建立控制項範本的圖形化使用者介面。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-336">Use a designer, such as Blend for Visual Studio, that provides a graphical user interface for creating control templates.</span></span> <span data-ttu-id="8c5cb-337">如需詳細資訊，請參閱[設定支援範本之控制項的樣式](https://go.microsoft.com/fwlink/?LinkId=161153)。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-337">For more information, see [Styling a control that supports templates](https://go.microsoft.com/fwlink/?LinkId=161153).</span></span>

- <span data-ttu-id="8c5cb-338">取得預設 <xref:System.Windows.Controls.ControlTemplate> 並加以編輯。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-338">Get the default <xref:System.Windows.Controls.ControlTemplate> and edit it.</span></span> <span data-ttu-id="8c5cb-339">若要尋找 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 隨附的預設控制項範本，請參閱[預設 WPF 佈景主題](https://go.microsoft.com/fwlink/?LinkID=158252)。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-339">To find the default control templates that are included with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], see [Default WPF Themes](https://go.microsoft.com/fwlink/?LinkID=158252).</span></span>

<a name="complete_example"></a>
## <a name="complete-example"></a><span data-ttu-id="8c5cb-340">完整範例</span><span class="sxs-lookup"><span data-stu-id="8c5cb-340">Complete Example</span></span>
 <span data-ttu-id="8c5cb-341">下列範例會顯示本主題中討論的完整 <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate>。</span><span class="sxs-lookup"><span data-stu-id="8c5cb-341">The following example shows the complete <xref:System.Windows.Controls.Button><xref:System.Windows.Controls.ControlTemplate> that is discussed in this topic.</span></span>

 [!code-xaml[VSMButtonTemplate#3](~/samples/snippets/csharp/VS_Snippets_Wpf/vsmbuttontemplate/csharp/skinnedbutton.xaml#3)]

## <a name="see-also"></a><span data-ttu-id="8c5cb-342">請參閱</span><span class="sxs-lookup"><span data-stu-id="8c5cb-342">See also</span></span>

- [<span data-ttu-id="8c5cb-343">設定樣式和範本</span><span class="sxs-lookup"><span data-stu-id="8c5cb-343">Styling and Templating</span></span>](../../../desktop-wpf/fundamentals/styles-templates-overview.md)
