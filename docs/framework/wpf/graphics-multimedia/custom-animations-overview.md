---
title: 自訂動畫概觀
ms.date: 03/30/2017
helpviewer_keywords:
- custom classes [WPF], animation
- key frames [WPF], custom
- custom key frames [WPF]
- animation [WPF], custom classes
- custom animation classes [WPF]
ms.assetid: 9be69d50-3384-4938-886f-08ce00e4a7a6
ms.openlocfilehash: 5a9ca51b87f73a24b90d0bd843ee306f8a1b970a
ms.sourcegitcommit: 700ea803fb06c5ce98de017c7f76463ba33ff4a9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/19/2020
ms.locfileid: "77453087"
---
# <a name="custom-animations-overview"></a><span data-ttu-id="eb13f-102">自訂動畫概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-102">Custom Animations Overview</span></span>
<span data-ttu-id="eb13f-103">本主題說明如何以及何時建立自訂主要畫面格、動畫類別來擴充 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫系統，或使用每一畫面的回呼來略過它。</span><span class="sxs-lookup"><span data-stu-id="eb13f-103">This topic describes how and when to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system by creating custom key frames, animation classes, or by using per-frame callback to bypass it.</span></span>  
  
<a name="prerequisites"></a>   
## <a name="prerequisites"></a><span data-ttu-id="eb13f-104">Prerequisites</span><span class="sxs-lookup"><span data-stu-id="eb13f-104">Prerequisites</span></span>  
 <span data-ttu-id="eb13f-105">若要了解本主題，您應該熟悉 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 所提供的不同動畫類型。</span><span class="sxs-lookup"><span data-stu-id="eb13f-105">To understand this topic, you should be familiar with the different types of animations provided by the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="eb13f-106">如需詳細資訊，請參閱＜From/To/By 動畫概觀＞、[主要畫面格動畫概觀](key-frame-animations-overview.md)以及[路徑動畫概觀](path-animations-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="eb13f-106">For more information, see the From/To/By Animations Overview, the [Key-Frame Animations Overview](key-frame-animations-overview.md), and the [Path Animations Overview](path-animations-overview.md).</span></span>  
  
 <span data-ttu-id="eb13f-107">由於動畫類別是繼承自 <xref:System.Windows.Freezable> 類別，因此您應該熟悉 <xref:System.Windows.Freezable> 物件，以及如何從 <xref:System.Windows.Freezable>繼承。</span><span class="sxs-lookup"><span data-stu-id="eb13f-107">Because the animation classes inherit from the <xref:System.Windows.Freezable> class, you should be familiar with <xref:System.Windows.Freezable> objects and how to inherit from <xref:System.Windows.Freezable>.</span></span> <span data-ttu-id="eb13f-108">如需詳細資訊，請參閱 [Freezable 物件概觀](../advanced/freezable-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="eb13f-108">For more information, see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md).</span></span>  
  
<a name="extendingtheanimationsystem"></a>   
## <a name="extending-the-animation-system"></a><span data-ttu-id="eb13f-109">擴充動畫系統</span><span class="sxs-lookup"><span data-stu-id="eb13f-109">Extending the Animation System</span></span>  
 <span data-ttu-id="eb13f-110">有數種方式可以擴充 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫系統，根據您想要使用的內建功能層級而定。</span><span class="sxs-lookup"><span data-stu-id="eb13f-110">There are a number of ways to extend the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system, depending on the level of built-in functionality you want to use.</span></span>  <span data-ttu-id="eb13f-111">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫引擎中有三個主要擴充點︰</span><span class="sxs-lookup"><span data-stu-id="eb13f-111">There are three primary extensibility points in the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine:</span></span>  
  
- <span data-ttu-id="eb13f-112">藉由繼承自其中一個 *\<類型 >* 主要畫面格類別（例如 <xref:System.Windows.Media.Animation.DoubleKeyFrame>）來建立自訂主要畫面格物件。</span><span class="sxs-lookup"><span data-stu-id="eb13f-112">Create a custom key frame object by inheriting from one of the *\<Type>* KeyFrame classes, such as <xref:System.Windows.Media.Animation.DoubleKeyFrame>.</span></span> <span data-ttu-id="eb13f-113">這個方法可使用大部分的 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫引擎內建功能。</span><span class="sxs-lookup"><span data-stu-id="eb13f-113">This approach uses most of the built-in functionality of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation engine.</span></span>  
  
- <span data-ttu-id="eb13f-114">藉由繼承自 <xref:System.Windows.Media.Animation.AnimationTimeline> 或其中一個 *\<類型 >* AnimationBase 類別，來建立您自己的動畫類別。</span><span class="sxs-lookup"><span data-stu-id="eb13f-114">Create your own animation class by inheriting from <xref:System.Windows.Media.Animation.AnimationTimeline> or one of the *\<Type>* AnimationBase classes.</span></span>  
  
- <span data-ttu-id="eb13f-115">您可以針對每一畫面格使用每一畫面的回呼來產生動畫。</span><span class="sxs-lookup"><span data-stu-id="eb13f-115">Use per-frame callback to generate animations on a per-frame basis.</span></span> <span data-ttu-id="eb13f-116">這個方法完全略過動畫與計時系統。</span><span class="sxs-lookup"><span data-stu-id="eb13f-116">This approach completely bypasses the animation and timing system.</span></span>  
  
 <span data-ttu-id="eb13f-117">下表說明一些擴充動畫系統的案例。</span><span class="sxs-lookup"><span data-stu-id="eb13f-117">The following table describes some the scenarios for extending the animation system.</span></span>  
  
|<span data-ttu-id="eb13f-118">當您要...</span><span class="sxs-lookup"><span data-stu-id="eb13f-118">When you want to...</span></span>|<span data-ttu-id="eb13f-119">使用這個方法</span><span class="sxs-lookup"><span data-stu-id="eb13f-119">Use this approach</span></span>|  
|-------------------------|-----------------------|  
|<span data-ttu-id="eb13f-120">在有對應 *\<Type>* AnimationUsingKeyFrames 的類型值之間自訂內插補點</span><span class="sxs-lookup"><span data-stu-id="eb13f-120">Customize the interpolation between values of a type that has a corresponding *\<Type>* AnimationUsingKeyFrames</span></span>|<span data-ttu-id="eb13f-121">建立自訂主要畫面格。</span><span class="sxs-lookup"><span data-stu-id="eb13f-121">Create a custom key frame.</span></span> <span data-ttu-id="eb13f-122">如需詳細資訊，請參閱[建立自訂主要畫面格](#createacustomkeyframe)一節。</span><span class="sxs-lookup"><span data-stu-id="eb13f-122">For more information, see the [Create a Custom Key Frame](#createacustomkeyframe) section.</span></span>|  
|<span data-ttu-id="eb13f-123">不只是在有對應 *\<Type>* Animation 的類型值之間自訂內插補點。</span><span class="sxs-lookup"><span data-stu-id="eb13f-123">Customize more than just the interpolation between values of a type that has a corresponding *\<Type>* Animation.</span></span>|<span data-ttu-id="eb13f-124">建立自訂動畫類別，其繼承自和您想要以動畫顯示的類型對應的 *\<Type>* AnimationBase 類別。</span><span class="sxs-lookup"><span data-stu-id="eb13f-124">Create a custom animation class that inherits from the *\<Type>* AnimationBase class that corresponds to the type you want to animate.</span></span> <span data-ttu-id="eb13f-125">如需詳細資訊，請參閱[建立自訂動畫類別](#createacustomanimationtype)一節。</span><span class="sxs-lookup"><span data-stu-id="eb13f-125">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="eb13f-126">以動畫顯示沒有對應 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 類型的動畫</span><span class="sxs-lookup"><span data-stu-id="eb13f-126">Animate a type that has no corresponding [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation</span></span>|<span data-ttu-id="eb13f-127">使用 <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> 或建立繼承自 <xref:System.Windows.Media.Animation.AnimationTimeline>的類別。</span><span class="sxs-lookup"><span data-stu-id="eb13f-127">Use an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> or create a class that inherits from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="eb13f-128">如需詳細資訊，請參閱[建立自訂動畫類別](#createacustomanimationtype)一節。</span><span class="sxs-lookup"><span data-stu-id="eb13f-128">For more information, see the [Create a Custom Animation Class](#createacustomanimationtype) section.</span></span>|  
|<span data-ttu-id="eb13f-129">利用每個畫面格都會計算的值，並根據最後一組物件互動的值，以動畫顯示多個物件</span><span class="sxs-lookup"><span data-stu-id="eb13f-129">Animate multiple objects with values that are computed each frame and are based on the last set of object interactions</span></span>|<span data-ttu-id="eb13f-130">使用每一畫面的回呼。</span><span class="sxs-lookup"><span data-stu-id="eb13f-130">Use per-frame callback.</span></span> <span data-ttu-id="eb13f-131">如需詳細資訊，請參閱[使用每一畫面的回呼](#useperframecallback)一節。</span><span class="sxs-lookup"><span data-stu-id="eb13f-131">For more information, see the [Create a Use Per-Frame Callback](#useperframecallback) section.</span></span>|  
  
<a name="createacustomkeyframe"></a>   
## <a name="create-a-custom-key-frame"></a><span data-ttu-id="eb13f-132">建立自訂主要畫面格</span><span class="sxs-lookup"><span data-stu-id="eb13f-132">Create a Custom Key Frame</span></span>  
 <span data-ttu-id="eb13f-133">建立自訂主要畫面格類別是擴充動畫系統最簡單的方式。</span><span class="sxs-lookup"><span data-stu-id="eb13f-133">Creating a custom key frame class is the simplest way to extend the animation system.</span></span> <span data-ttu-id="eb13f-134">當您想要不同的主要畫面格動畫內插補點方法時，請使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-134">Use this approach when you want to a different interpolation method for a key-frame animation.</span></span>  <span data-ttu-id="eb13f-135">如[主要畫面格動畫概觀](key-frame-animations-overview.md)中所述，主要畫面格動畫使用主要畫面格物件來產生其輸出值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-135">As described in the [Key-Frame Animations Overview](key-frame-animations-overview.md), a key-frame animation uses key frame objects to generate its output values.</span></span> <span data-ttu-id="eb13f-136">每個主要畫面格物件都會執行三個函式︰</span><span class="sxs-lookup"><span data-stu-id="eb13f-136">Each key frame object performs three functions:</span></span>  
  
- <span data-ttu-id="eb13f-137">使用其 <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> 屬性來指定目標值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-137">Specifies a target value using its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
- <span data-ttu-id="eb13f-138">使用 <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> 的屬性，指定應達到該值的時間。</span><span class="sxs-lookup"><span data-stu-id="eb13f-138">Specifies the time at which that value should be reached using its <xref:System.Windows.Media.Animation.IKeyFrame.KeyTime%2A> property.</span></span>  
  
- <span data-ttu-id="eb13f-139">藉由實作 InterpolateValueCore 方法，在前一個主要畫面格與其自身的值之間插入。</span><span class="sxs-lookup"><span data-stu-id="eb13f-139">Interpolates between the value of the previous key frame and its own value by implementing the InterpolateValueCore method.</span></span>  
  
 <span data-ttu-id="eb13f-140">**實作指示**</span><span class="sxs-lookup"><span data-stu-id="eb13f-140">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="eb13f-141">衍生自 *\<Type>* KeyFrame 抽象類別並實作 InterpolateValueCore 方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-141">Derive from the *\<Type>* KeyFrame abstract class and implement the InterpolateValueCore method.</span></span> <span data-ttu-id="eb13f-142">InterpolateValueCore 方法會傳回主要畫面格目前的值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-142">The InterpolateValueCore method returns the current value of the key frame.</span></span> <span data-ttu-id="eb13f-143">它接受兩個參數︰前一個主要畫面格的值和範圍從 0 到 1 的進度值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-143">It takes two parameters: the value of the previous key frame and a progress value that ranges from 0 to 1.</span></span> <span data-ttu-id="eb13f-144">進度為0表示主要畫面格剛開始，值為1表示主要畫面格剛完成，且應傳回其 <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> 屬性所指定的值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-144">A progress of 0 indicates the key frame has just started, and a value of 1 indicates that the key frame has just completed and should return the value specified by its <xref:System.Windows.Media.Animation.IKeyFrame.Value%2A> property.</span></span>  
  
 <span data-ttu-id="eb13f-145">由於 *\<類型 >* 主要畫面格類別繼承自 <xref:System.Windows.Freezable> 類別，因此您也必須覆寫 <xref:System.Windows.Freezable.CreateInstanceCore%2A> 核心，以傳回類別的新實例。</span><span class="sxs-lookup"><span data-stu-id="eb13f-145">Because the *\<Type>* KeyFrame classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="eb13f-146">如果類別不使用相依性屬性來儲存其資料或需要在建立之後額外進行初始化，您可能需要覆寫其他方法。如需詳細資訊，請參閱 [Freezable 物件概觀](../advanced/freezable-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="eb13f-146">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="eb13f-147">在您建立自訂 *\<Type>* KeyFrame 動畫後，您可以將它和該類型的 *\<Type>* AnimationUsingKeyFrames 搭配使用。</span><span class="sxs-lookup"><span data-stu-id="eb13f-147">After you've created your custom *\<Type>* KeyFrame animation, you can use it with the *\<Type>* AnimationUsingKeyFrames for that type.</span></span>  
  
<a name="createacustomanimationtype"></a>   
## <a name="create-a-custom-animation-class"></a><span data-ttu-id="eb13f-148">建立自訂動畫類別</span><span class="sxs-lookup"><span data-stu-id="eb13f-148">Create a Custom Animation Class</span></span>  
 <span data-ttu-id="eb13f-149">建立您自己的動畫類型可讓您更充分掌控物件的動畫效果。</span><span class="sxs-lookup"><span data-stu-id="eb13f-149">Creating your own animation type gives you more control over how an object in animated.</span></span> <span data-ttu-id="eb13f-150">有兩種建議的方式可建立您自己的動畫類型：您可以從 <xref:System.Windows.Media.Animation.AnimationTimeline> 類別或 *\<類型 >* AnimationBase 類別衍生。</span><span class="sxs-lookup"><span data-stu-id="eb13f-150">There are two recommended ways to create your own animation type: you can derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class or the *\<Type>* AnimationBase class.</span></span> <span data-ttu-id="eb13f-151">不建議衍生自 *\<Type>* Animation 或 *\<Type>* AnimationUsingKeyFrames 類型。</span><span class="sxs-lookup"><span data-stu-id="eb13f-151">Deriving from the *\<Type>* Animation or *\<Type>* AnimationUsingKeyFrames classes is not recommended.</span></span>  
  
### <a name="derive-from-typeanimationbase"></a><span data-ttu-id="eb13f-152">衍生自 \<Type>AnimationBase</span><span class="sxs-lookup"><span data-stu-id="eb13f-152">Derive from \<Type>AnimationBase</span></span>  
 <span data-ttu-id="eb13f-153">衍生自 *\<Type>* AnimationBase 類別是建立新動畫類型最簡單的方式。</span><span class="sxs-lookup"><span data-stu-id="eb13f-153">Deriving from a *\<Type>* AnimationBase class is the simplest way to create a new animation type.</span></span> <span data-ttu-id="eb13f-154">當您想要對已有對應 *\<Type>* AnimationBase 類別的類型建立新動畫時，使用這個方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-154">Use this approach when you want to create a new animation for type that already has a corresponding *\<Type>* AnimationBase class.</span></span>  
  
 <span data-ttu-id="eb13f-155">**實作指示**</span><span class="sxs-lookup"><span data-stu-id="eb13f-155">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="eb13f-156">衍生自 *\<Type>* Animation 類別並實作 GetCurrentValueCore 方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-156">Derive from a *\<Type>* Animation class and implement the GetCurrentValueCore method.</span></span> <span data-ttu-id="eb13f-157">GetCurrentValueCore 方法會傳回動畫目前的值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-157">The GetCurrentValueCore method returns the current value of the animation.</span></span> <span data-ttu-id="eb13f-158">它會採用三個參數：建議的起始值、建議的結束值，以及用來判斷動畫進度的 <xref:System.Windows.Media.Animation.AnimationClock>。</span><span class="sxs-lookup"><span data-stu-id="eb13f-158">It takes three parameters: a suggested starting value, a suggested ending value, and an <xref:System.Windows.Media.Animation.AnimationClock>, which you use to determine the progress of the animation.</span></span>  
  
 <span data-ttu-id="eb13f-159">由於 *\<類型 >* AnimationBase 類別繼承自 <xref:System.Windows.Freezable> 類別，因此您也必須覆寫 <xref:System.Windows.Freezable.CreateInstanceCore%2A> 核心，以傳回類別的新實例。</span><span class="sxs-lookup"><span data-stu-id="eb13f-159">Because the *\<Type>* AnimationBase classes inherit from the <xref:System.Windows.Freezable> class, you must also override <xref:System.Windows.Freezable.CreateInstanceCore%2A> core to return a new instance of your class.</span></span> <span data-ttu-id="eb13f-160">如果類別不使用相依性屬性來儲存其資料或需要在建立之後額外進行初始化，您可能需要覆寫其他方法。如需詳細資訊，請參閱 [Freezable 物件概觀](../advanced/freezable-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="eb13f-160">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="eb13f-161">如需詳細資訊，請參閱想要以動畫顯示之類型的 *\<Type>* AnimationBase 類別適用的 GetCurrentValueCore 方法文件。</span><span class="sxs-lookup"><span data-stu-id="eb13f-161">For more information, see the GetCurrentValueCore method documentation for the *\<Type>* AnimationBase class for the type that you want to animate.</span></span> <span data-ttu-id="eb13f-162">如需範例，請參閱[自訂動畫範例](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span><span class="sxs-lookup"><span data-stu-id="eb13f-162">For an example, see the [Custom Animation Sample](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)</span></span>  
  
 <span data-ttu-id="eb13f-163">**替代方法**</span><span class="sxs-lookup"><span data-stu-id="eb13f-163">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="eb13f-164">如果您只想要變更插入動畫值的方式，可考慮衍生自 *\<Type>* KeyFrame 類別之一。</span><span class="sxs-lookup"><span data-stu-id="eb13f-164">If you simply want to change how animation values are interpolated, considering deriving from one of the *\<Type>* KeyFrame classes.</span></span> <span data-ttu-id="eb13f-165">您建立的主要畫面格可以與  *所提供的對應 \<* Type>[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]AnimationUsingKeyFrames 一起使用。</span><span class="sxs-lookup"><span data-stu-id="eb13f-165">The key frame you create can be used with the corresponding *\<Type>* AnimationUsingKeyFrames provided by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
### <a name="derive-from-animationtimeline"></a><span data-ttu-id="eb13f-166">衍生自 AnimationTimeline</span><span class="sxs-lookup"><span data-stu-id="eb13f-166">Derive from AnimationTimeline</span></span>  
 <span data-ttu-id="eb13f-167">當您想要為尚未擁有相符 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫的類型建立動畫，或想要建立不是強型別的動畫時，請從 <xref:System.Windows.Media.Animation.AnimationTimeline> 類別衍生。</span><span class="sxs-lookup"><span data-stu-id="eb13f-167">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class when you want to create an animation for a type that doesn't already have a matching [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation, or you want to create an animation that is not strongly typed.</span></span>  
  
 <span data-ttu-id="eb13f-168">**實作指示**</span><span class="sxs-lookup"><span data-stu-id="eb13f-168">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="eb13f-169">衍生自 <xref:System.Windows.Media.Animation.AnimationTimeline> 類別，並覆寫下列成員：</span><span class="sxs-lookup"><span data-stu-id="eb13f-169">Derive from the <xref:System.Windows.Media.Animation.AnimationTimeline> class and override the following members:</span></span>  
  
- <span data-ttu-id="eb13f-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> –如果您的新類別是具體的，您必須覆寫 <xref:System.Windows.Freezable.CreateInstanceCore%2A>，以傳回類別的新實例。</span><span class="sxs-lookup"><span data-stu-id="eb13f-170"><xref:System.Windows.Freezable.CreateInstanceCore%2A> – If your new class is concrete, you must override <xref:System.Windows.Freezable.CreateInstanceCore%2A> to return a new instance of your class.</span></span>  
  
- <span data-ttu-id="eb13f-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> –覆寫這個方法，以傳回您的動畫目前的值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-171"><xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> – Override this method to return the current value of your animation.</span></span> <span data-ttu-id="eb13f-172">它會採用三個參數：預設的原始值、預設的目的地值和 <xref:System.Windows.Media.Animation.AnimationClock>。</span><span class="sxs-lookup"><span data-stu-id="eb13f-172">It takes three parameters: a default origin value, a default destination value, and an <xref:System.Windows.Media.Animation.AnimationClock>.</span></span> <span data-ttu-id="eb13f-173">使用 <xref:System.Windows.Media.Animation.AnimationClock> 來取得動畫的目前時間或進度。</span><span class="sxs-lookup"><span data-stu-id="eb13f-173">Use the <xref:System.Windows.Media.Animation.AnimationClock> to obtain the current time or progress for the animation.</span></span> <span data-ttu-id="eb13f-174">您可以選擇是否要使用預設的來源和目的值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-174">You can choose whether to use the default origin and destination values.</span></span>  
  
- <span data-ttu-id="eb13f-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> –覆寫這個屬性，以指出您的動畫是否使用由 <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> 方法所指定的預設目的地值。</span><span class="sxs-lookup"><span data-stu-id="eb13f-175"><xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> – Override this property to indicate whether your animation uses the default destination value specified by the <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> method.</span></span>  
  
- <span data-ttu-id="eb13f-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> –覆寫這個屬性，以指出動畫所產生的輸出 <xref:System.Type>。</span><span class="sxs-lookup"><span data-stu-id="eb13f-176"><xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> – Override this property to indicate the <xref:System.Type> of output your animation produces.</span></span>  
  
 <span data-ttu-id="eb13f-177">如果類別不使用相依性屬性來儲存其資料或需要在建立之後額外進行初始化，您可能需要覆寫其他方法。如需詳細資訊，請參閱 [Freezable 物件概觀](../advanced/freezable-objects-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="eb13f-177">If the class does not use dependency properties to store its data or it requires extra initialization after creation, you might need to override additional methods; see the [Freezable Objects Overview](../advanced/freezable-objects-overview.md) for more information.</span></span>  
  
 <span data-ttu-id="eb13f-178">建議的範例 (由 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫使用) 是使用兩個繼承層級︰</span><span class="sxs-lookup"><span data-stu-id="eb13f-178">The recommended paradigm (used by [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animations) is to use two inheritance levels:</span></span>  
  
1. <span data-ttu-id="eb13f-179">建立衍生自 <xref:System.Windows.Media.Animation.AnimationTimeline>> AnimationBase 類別的抽象 *\<類型*。</span><span class="sxs-lookup"><span data-stu-id="eb13f-179">Create an abstract *\<Type>* AnimationBase class that derives from <xref:System.Windows.Media.Animation.AnimationTimeline>.</span></span> <span data-ttu-id="eb13f-180">這個類別應該會覆寫 <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-180">This class should override the <xref:System.Windows.Media.Animation.AnimationTimeline.TargetPropertyType%2A> method.</span></span> <span data-ttu-id="eb13f-181">它也應該引進新的抽象方法 GetCurrentValueCore，並覆寫 <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A>，讓它驗證預設原始值和預設目的地值參數的類型，然後呼叫 GetCurrentValueCore。</span><span class="sxs-lookup"><span data-stu-id="eb13f-181">It should also introduce a new abstract method, GetCurrentValueCore, and override <xref:System.Windows.Media.Animation.AnimationTimeline.GetCurrentValue%2A> so that it validates the types of the default origin value and default destination value parameters, then calls GetCurrentValueCore.</span></span>  
  
2. <span data-ttu-id="eb13f-182">建立另一個繼承自新 *\<類型 >* AnimationBase 類別的類別，並覆寫 <xref:System.Windows.Freezable.CreateInstanceCore%2A> 方法、您引進的 GetCurrentValueCore 方法，以及 <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="eb13f-182">Create another class that inherits from your new *\<Type>* AnimationBase class and overrides the <xref:System.Windows.Freezable.CreateInstanceCore%2A> method, the GetCurrentValueCore method that you introduced, and the <xref:System.Windows.Media.Animation.AnimationTimeline.IsDestinationDefault%2A> property.</span></span>  
  
 <span data-ttu-id="eb13f-183">**替代方法**</span><span class="sxs-lookup"><span data-stu-id="eb13f-183">**Alternative Approaches**</span></span>  
  
 <span data-ttu-id="eb13f-184">如果您想要以動畫顯示沒有對應的 From/To/By 動畫或主要畫面格動畫的類型，請考慮使用 <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>。</span><span class="sxs-lookup"><span data-stu-id="eb13f-184">If you want to animate a type that has no corresponding From/To/By animation or key-frame animation, consider using an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames>.</span></span> <span data-ttu-id="eb13f-185">因為它是弱式類型，<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> 可以建立任何類型值的動畫。</span><span class="sxs-lookup"><span data-stu-id="eb13f-185">Because it is weakly typed, an <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> can animate any type of value.</span></span> <span data-ttu-id="eb13f-186">這種方法的缺點是，<xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> 只支援離散插補。</span><span class="sxs-lookup"><span data-stu-id="eb13f-186">The drawback to this approach is that <xref:System.Windows.Media.Animation.ObjectAnimationUsingKeyFrames> only supports discrete interpolation.</span></span>  
  
<a name="useperframecallback"></a>   
## <a name="use-per-frame-callback"></a><span data-ttu-id="eb13f-187">使用每一畫面的回呼</span><span class="sxs-lookup"><span data-stu-id="eb13f-187">Use Per-Frame Callback</span></span>  
 <span data-ttu-id="eb13f-188">當您需要完全略過 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動畫系統時，使用此方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-188">Use this approach when you need to completely bypass the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] animation system.</span></span> <span data-ttu-id="eb13f-189">此方法的一個案例為物理動畫，其中的每個動畫步驟都需要根據最後一組物件互動來重新計算動畫物件的新方向或位置。</span><span class="sxs-lookup"><span data-stu-id="eb13f-189">One scenario for this approach is physics animations, where at each animation step a new direction or position of animated objects needs to be recomputed based on the  last set of object interactions.</span></span>  
  
 <span data-ttu-id="eb13f-190">**實作指示**</span><span class="sxs-lookup"><span data-stu-id="eb13f-190">**Implementation Instructions**</span></span>  
  
 <span data-ttu-id="eb13f-191">和本概觀中所述的其他方法不同，若要使用每一畫面的回呼，您不需要建立自訂動畫或主要畫面格類別。</span><span class="sxs-lookup"><span data-stu-id="eb13f-191">Unlike the other approaches described in this overview, to use per-frame callback you don't need to create a custom animation or key frame class.</span></span>  
  
 <span data-ttu-id="eb13f-192">相反地，您會註冊物件的 <xref:System.Windows.Media.CompositionTarget.Rendering> 事件，其中包含您想要建立動畫的物件。</span><span class="sxs-lookup"><span data-stu-id="eb13f-192">Instead, you register for the <xref:System.Windows.Media.CompositionTarget.Rendering> event of the object that contains the objects you want to animate.</span></span> <span data-ttu-id="eb13f-193">系統會針對每個畫面呼叫一次此事件處理常式方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-193">This event handler method gets called once per frame.</span></span> <span data-ttu-id="eb13f-194">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 每次封送處理視覺化樹狀結構中已保存的轉譯資料，跨越到組合樹狀結構時，就會呼叫您的事件處理常式方法。</span><span class="sxs-lookup"><span data-stu-id="eb13f-194">Each time that [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] marshals the persisted rendering data in the visual tree across to the composition tree, your event handler method is called.</span></span>  
  
 <span data-ttu-id="eb13f-195">在事件處理常式中，執行動畫效果所需的任何計算，並使用這些值設定您想要建立動畫的物件屬性。</span><span class="sxs-lookup"><span data-stu-id="eb13f-195">In your event handler, perform your whatever calculations necessary for your animation effect and set the properties of the objects you want to animate with these values.</span></span>  
  
 <span data-ttu-id="eb13f-196">若要取得目前框架的呈現時間，與這個事件相關聯的 <xref:System.EventArgs> 可以轉換成 <xref:System.Windows.Media.RenderingEventArgs>，這會提供 <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> 屬性，供您用來取得目前框架的呈現時間。</span><span class="sxs-lookup"><span data-stu-id="eb13f-196">To obtain the presentation time of the current frame, the <xref:System.EventArgs> associated with this event can be cast as <xref:System.Windows.Media.RenderingEventArgs>, which provide a <xref:System.Windows.Media.RenderingEventArgs.RenderingTime%2A> property that you can use to obtain the current frame's rendering time.</span></span>  
  
 <span data-ttu-id="eb13f-197">如需詳細資訊，請參閱 <xref:System.Windows.Media.CompositionTarget.Rendering> 頁面。</span><span class="sxs-lookup"><span data-stu-id="eb13f-197">For more information, see the <xref:System.Windows.Media.CompositionTarget.Rendering> page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="eb13f-198">另請參閱</span><span class="sxs-lookup"><span data-stu-id="eb13f-198">See also</span></span>

- <xref:System.Windows.Media.Animation.AnimationTimeline>
- <xref:System.Windows.Media.Animation.IKeyFrame>
- [<span data-ttu-id="eb13f-199">屬性動畫技術概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-199">Property Animation Techniques Overview</span></span>](property-animation-techniques-overview.md)
- [<span data-ttu-id="eb13f-200">Freezable 物件概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-200">Freezable Objects Overview</span></span>](../advanced/freezable-objects-overview.md)
- [<span data-ttu-id="eb13f-201">主要畫面格動畫概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-201">Key-Frame Animations Overview</span></span>](key-frame-animations-overview.md)
- [<span data-ttu-id="eb13f-202">路徑動畫概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-202">Path Animations Overview</span></span>](path-animations-overview.md)
- [<span data-ttu-id="eb13f-203">動畫概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-203">Animation Overview</span></span>](animation-overview.md)
- [<span data-ttu-id="eb13f-204">動畫和計時系統概觀</span><span class="sxs-lookup"><span data-stu-id="eb13f-204">Animation and Timing System Overview</span></span>](animation-and-timing-system-overview.md)
- [<span data-ttu-id="eb13f-205">自訂動畫範例</span><span class="sxs-lookup"><span data-stu-id="eb13f-205">Custom Animation Sample</span></span>](https://github.com/Microsoft/WPF-Samples/tree/master/Animation/CustomAnimation)
