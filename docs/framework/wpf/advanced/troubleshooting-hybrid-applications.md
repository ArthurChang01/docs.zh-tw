---
title: 混合應用程式疑難排解
ms.date: 03/30/2017
helpviewer_keywords:
- overlapping controls [WPF]
- Windows Forms [WPF], interoperability with
- Windows Forms [WPF], WPF interoperation
- interoperability [WPF], Windows Forms
- hybrid applications [WPF interoperability]
- message loops [WPF]
ms.assetid: f440c23f-fa5d-4d5a-852f-ba61150e6405
ms.openlocfilehash: b85a607d2e44d6253359a81118f90e6ee05d2d3f
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187319"
---
# <a name="troubleshooting-hybrid-applications"></a><span data-ttu-id="78699-102">混合應用程式疑難排解</span><span class="sxs-lookup"><span data-stu-id="78699-102">Troubleshooting Hybrid Applications</span></span>
<a name="introduction"></a><span data-ttu-id="78699-103">本主題列出了創作混合應用程式時可能出現的一些常見問題，這些應用程式同時使用 Windows[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]表單技術。</span><span class="sxs-lookup"><span data-stu-id="78699-103">This topic lists some common problems that can occur when authoring hybrid applications, which use both [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Windows Forms technologies.</span></span>  

<a name="overlapping_controls"></a>
## <a name="overlapping-controls"></a><span data-ttu-id="78699-104">重疊控制項</span><span class="sxs-lookup"><span data-stu-id="78699-104">Overlapping Controls</span></span>  
 <span data-ttu-id="78699-105">控制項可能不會以您預期的方式重疊。</span><span class="sxs-lookup"><span data-stu-id="78699-105">Controls may not overlap as you would expect.</span></span> <span data-ttu-id="78699-106">Windows 表單為每個控制項使用單獨的 HWND。</span><span class="sxs-lookup"><span data-stu-id="78699-106">Windows Forms uses a separate HWND for each control.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="78699-107">會針對頁面上的所有內容使用一個 HWND。</span><span class="sxs-lookup"><span data-stu-id="78699-107">uses one HWND for all content on a page.</span></span> <span data-ttu-id="78699-108">這個實作差異導致非預期的重疊行為。</span><span class="sxs-lookup"><span data-stu-id="78699-108">This implementation difference causes unexpected overlapping behaviors.</span></span>  
  
 <span data-ttu-id="78699-109">託管中的[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]Windows 表單控制項始終顯示在內容的頂部[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="78699-109">A Windows Forms control hosted in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] always appears on top of the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="78699-110">託管在控制項中<xref:System.Windows.Forms.Integration.ElementHost>的內容以<xref:System.Windows.Forms.Integration.ElementHost>控制項的 z 順序顯示。</span><span class="sxs-lookup"><span data-stu-id="78699-110">content hosted in an <xref:System.Windows.Forms.Integration.ElementHost> control appears at the z-order of the <xref:System.Windows.Forms.Integration.ElementHost> control.</span></span> <span data-ttu-id="78699-111">可以重疊<xref:System.Windows.Forms.Integration.ElementHost>控制項，但託管[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]內容不組合或交互。</span><span class="sxs-lookup"><span data-stu-id="78699-111">It is possible to overlap <xref:System.Windows.Forms.Integration.ElementHost> controls, but the hosted [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] content does not combine or interact.</span></span>  
  
<a name="child_property"></a>
## <a name="child-property"></a><span data-ttu-id="78699-112">子屬性</span><span class="sxs-lookup"><span data-stu-id="78699-112">Child Property</span></span>  
 <span data-ttu-id="78699-113"><xref:System.Windows.Forms.Integration.WindowsFormsHost>和<xref:System.Windows.Forms.Integration.ElementHost>類只能承載一個子控制項或元素。</span><span class="sxs-lookup"><span data-stu-id="78699-113">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> and <xref:System.Windows.Forms.Integration.ElementHost> classes can host only a single child control or element.</span></span> <span data-ttu-id="78699-114">若要裝載多個控制項或元素，您必須使用容器當做子內容。</span><span class="sxs-lookup"><span data-stu-id="78699-114">To host more than one control or element, you must use a container as the child content.</span></span> <span data-ttu-id="78699-115">例如，您可以將 Windows 表單按鈕和核取方塊控制項添加到<xref:System.Windows.Forms.Panel?displayProperty=nameWithType>控制項，然後將面板分配給<xref:System.Windows.Forms.Integration.WindowsFormsHost>控制項的屬性。 <xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A></span><span class="sxs-lookup"><span data-stu-id="78699-115">For example, you could add Windows Forms button and check box controls to a <xref:System.Windows.Forms.Panel?displayProperty=nameWithType> control, and then assign the panel to a <xref:System.Windows.Forms.Integration.WindowsFormsHost> control's <xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A> property.</span></span> <span data-ttu-id="78699-116">但是，您不能將按鈕和核取方塊控制項單獨添加到同一<xref:System.Windows.Forms.Integration.WindowsFormsHost>控制項。</span><span class="sxs-lookup"><span data-stu-id="78699-116">However, you cannot add the button and check box controls separately to the same <xref:System.Windows.Forms.Integration.WindowsFormsHost> control.</span></span>  
  
<a name="scaling"></a>
## <a name="scaling"></a><span data-ttu-id="78699-117">調整大小</span><span class="sxs-lookup"><span data-stu-id="78699-117">Scaling</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="78699-118">和 Windows 表單具有不同的縮放模型。</span><span class="sxs-lookup"><span data-stu-id="78699-118">and Windows Forms have different scaling models.</span></span> <span data-ttu-id="78699-119">某些[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]縮放轉換對 Windows 表單控制項有意義，但其他擴輾轉換則沒有意義。</span><span class="sxs-lookup"><span data-stu-id="78699-119">Some [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] scaling transformations are meaningful to Windows Forms controls, but others are not.</span></span> <span data-ttu-id="78699-120">例如，將 Windows 表單控制項縮放為 0 將起作用，但如果嘗試將同一控制項縮放回非零值，則控制項的大小仍為 0。</span><span class="sxs-lookup"><span data-stu-id="78699-120">For example, scaling a Windows Forms control to 0 will work, but if you try to scale the same control back to a non-zero value, the control's size remains 0.</span></span> <span data-ttu-id="78699-121">如需詳細資訊，請參閱 [WindowsFormsHost 元素的配置考量](layout-considerations-for-the-windowsformshost-element.md)。</span><span class="sxs-lookup"><span data-stu-id="78699-121">For more information, see [Layout Considerations for the WindowsFormsHost Element](layout-considerations-for-the-windowsformshost-element.md).</span></span>  
  
<a name="adapter"></a>
## <a name="adapter"></a><span data-ttu-id="78699-122">配接器</span><span class="sxs-lookup"><span data-stu-id="78699-122">Adapter</span></span>  
 <span data-ttu-id="78699-123">在 和<xref:System.Windows.Forms.Integration.WindowsFormsHost><xref:System.Windows.Forms.Integration.ElementHost>類工作時可能存在混淆，因為它們包含一個隱藏的容器。</span><span class="sxs-lookup"><span data-stu-id="78699-123">There may be confusion when working the <xref:System.Windows.Forms.Integration.WindowsFormsHost> and <xref:System.Windows.Forms.Integration.ElementHost> classes, because they include a hidden container.</span></span> <span data-ttu-id="78699-124">和 類都有一個隱藏的容器，稱為配接器，它們用於承載內容。 *adapter* <xref:System.Windows.Forms.Integration.WindowsFormsHost> <xref:System.Windows.Forms.Integration.ElementHost></span><span class="sxs-lookup"><span data-stu-id="78699-124">Both the <xref:System.Windows.Forms.Integration.WindowsFormsHost> and <xref:System.Windows.Forms.Integration.ElementHost> classes have a hidden container, called an *adapter*, which they use to host content.</span></span> <span data-ttu-id="78699-125">對於元素<xref:System.Windows.Forms.Integration.WindowsFormsHost>，配接器派生自類<xref:System.Windows.Forms.ContainerControl?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="78699-125">For the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, the adapter derives from the <xref:System.Windows.Forms.ContainerControl?displayProperty=nameWithType> class.</span></span> <span data-ttu-id="78699-126">對於<xref:System.Windows.Forms.Integration.ElementHost>控制項，配接器派生自元素<xref:System.Windows.Controls.DockPanel>。</span><span class="sxs-lookup"><span data-stu-id="78699-126">For the <xref:System.Windows.Forms.Integration.ElementHost> control, the adapter derives from the <xref:System.Windows.Controls.DockPanel> element.</span></span> <span data-ttu-id="78699-127">當您在其他交互操作主題中看見對於配接器的參考資訊時，就是在討論此容器。</span><span class="sxs-lookup"><span data-stu-id="78699-127">When you see references to the adapter in other interoperation topics, this container is what is being discussed.</span></span>  
  
<a name="nesting"></a>
## <a name="nesting"></a><span data-ttu-id="78699-128">巢狀</span><span class="sxs-lookup"><span data-stu-id="78699-128">Nesting</span></span>  
 <span data-ttu-id="78699-129">不支援將<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素嵌套在<xref:System.Windows.Forms.Integration.ElementHost>控制項中。</span><span class="sxs-lookup"><span data-stu-id="78699-129">Nesting a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element inside an <xref:System.Windows.Forms.Integration.ElementHost> control is not supported.</span></span> <span data-ttu-id="78699-130">不支援在<xref:System.Windows.Forms.Integration.ElementHost><xref:System.Windows.Forms.Integration.WindowsFormsHost>元素內嵌套控制項。</span><span class="sxs-lookup"><span data-stu-id="78699-130">Nesting an <xref:System.Windows.Forms.Integration.ElementHost> control inside a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element is also not supported.</span></span>  
  
<a name="focus"></a>
## <a name="focus"></a><span data-ttu-id="78699-131">Focus</span><span class="sxs-lookup"><span data-stu-id="78699-131">Focus</span></span>  
 <span data-ttu-id="78699-132">焦點在 和[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]Windows 表單中的工作方式不同，這意味著焦點問題可能發生在混合應用程式中。</span><span class="sxs-lookup"><span data-stu-id="78699-132">Focus works differently in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Windows Forms, which means that focus issues may occur in a hybrid application.</span></span> <span data-ttu-id="78699-133">例如，如果<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素內部具有焦點，並且最小化並還原頁面或顯示模式對話方塊，則元素內部的焦點<xref:System.Windows.Forms.Integration.WindowsFormsHost>可能會丟失。</span><span class="sxs-lookup"><span data-stu-id="78699-133">For example, if you have focus inside a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, and you either minimize and restore the page or show a modal dialog box, focus inside the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element may be lost.</span></span> <span data-ttu-id="78699-134">元素<xref:System.Windows.Forms.Integration.WindowsFormsHost>仍有焦點，但元素內的控制項可能沒有。</span><span class="sxs-lookup"><span data-stu-id="78699-134">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element still has focus, but the control inside it may not.</span></span>  
  
 <span data-ttu-id="78699-135">資料驗證也會受到焦點影響。</span><span class="sxs-lookup"><span data-stu-id="78699-135">Data validation is also affected by focus.</span></span> <span data-ttu-id="78699-136">驗證在<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素中工作，但它不能像從<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素中選項卡出來或在兩個不同的<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素之間工作。</span><span class="sxs-lookup"><span data-stu-id="78699-136">Validation works in a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, but it does not work as you tab out of the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, or between two different <xref:System.Windows.Forms.Integration.WindowsFormsHost> elements.</span></span>  
  
<a name="property_mapping"></a>
## <a name="property-mapping"></a><span data-ttu-id="78699-137">屬性對應</span><span class="sxs-lookup"><span data-stu-id="78699-137">Property Mapping</span></span>  
 <span data-ttu-id="78699-138">某些屬性對應需要大量解釋，以在[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]和 Windows 表單技術之間橋接不同的實現。</span><span class="sxs-lookup"><span data-stu-id="78699-138">Some property mappings require extensive interpretation to bridge dissimilar implementations between the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Windows Forms technologies.</span></span> <span data-ttu-id="78699-139">屬性對應可讓您的程式碼回應字型、色彩和其他屬性的變更。</span><span class="sxs-lookup"><span data-stu-id="78699-139">Property mappings enable your code to react to changes in fonts, colors, and other properties.</span></span> <span data-ttu-id="78699-140">通常，屬性對應是透過接聽 *Property*Changed 事件或 On*Property*Changed 呼叫，並在子控制項或其介面卡上設定適當的屬性來運作。</span><span class="sxs-lookup"><span data-stu-id="78699-140">In general, property mappings work by listening for either *Property*Changed events or On*Property*Changed calls, and setting appropriate properties on either the child control or its adapter.</span></span> <span data-ttu-id="78699-141">如需詳細資訊，請參閱 [Windows Form 和 WPF 屬性對應](windows-forms-and-wpf-property-mapping.md)。</span><span class="sxs-lookup"><span data-stu-id="78699-141">For more information, see [Windows Forms and WPF Property Mapping](windows-forms-and-wpf-property-mapping.md).</span></span>  
  
<a name="layoutrelated_properties_on_hosted_content"></a>
## <a name="layout-related-properties-on-hosted-content"></a><span data-ttu-id="78699-142">裝載內容上配置相關的屬性</span><span class="sxs-lookup"><span data-stu-id="78699-142">Layout-related Properties on Hosted Content</span></span>  
 <span data-ttu-id="78699-143">分配<xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A?displayProperty=nameWithType>或<xref:System.Windows.Forms.Integration.ElementHost.Child%2A?displayProperty=nameWithType>屬性時，將自動設置託管內容上的多個與佈局相關的屬性。</span><span class="sxs-lookup"><span data-stu-id="78699-143">When the <xref:System.Windows.Forms.Integration.WindowsFormsHost.Child%2A?displayProperty=nameWithType> or <xref:System.Windows.Forms.Integration.ElementHost.Child%2A?displayProperty=nameWithType> property is assigned, several layout-related properties on the hosted content are set automatically.</span></span> <span data-ttu-id="78699-144">變更這些內容屬性會導致未預期的配置行為。</span><span class="sxs-lookup"><span data-stu-id="78699-144">Changing these content properties can cause unexpected layout behaviors.</span></span>  
  
 <span data-ttu-id="78699-145">託管內容停靠以填充<xref:System.Windows.Forms.Integration.WindowsFormsHost>和<xref:System.Windows.Forms.Integration.ElementHost>父內容。</span><span class="sxs-lookup"><span data-stu-id="78699-145">Your hosted content is docked to fill the <xref:System.Windows.Forms.Integration.WindowsFormsHost> and <xref:System.Windows.Forms.Integration.ElementHost> parent.</span></span> <span data-ttu-id="78699-146">若要啟用這個填滿行為，您需要在設定子屬性時設定數個屬性。</span><span class="sxs-lookup"><span data-stu-id="78699-146">To enable this fill behavior, several properties are set when you set the child property.</span></span> <span data-ttu-id="78699-147">下表列出了 和<xref:System.Windows.Forms.Integration.ElementHost><xref:System.Windows.Forms.Integration.WindowsFormsHost>類設置的內容屬性。</span><span class="sxs-lookup"><span data-stu-id="78699-147">The following table lists which content properties are set by the <xref:System.Windows.Forms.Integration.ElementHost> and <xref:System.Windows.Forms.Integration.WindowsFormsHost> classes.</span></span>  
  
|<span data-ttu-id="78699-148">裝載類別</span><span class="sxs-lookup"><span data-stu-id="78699-148">Host Class</span></span>|<span data-ttu-id="78699-149">內容屬性</span><span class="sxs-lookup"><span data-stu-id="78699-149">Content Properties</span></span>|  
|----------------|------------------------|  
|<xref:System.Windows.Forms.Integration.ElementHost>|<xref:System.Windows.FrameworkElement.Height%2A><br /><br /> <xref:System.Windows.FrameworkElement.Width%2A><br /><br /> <xref:System.Windows.FrameworkElement.Margin%2A><br /><br /> <xref:System.Windows.FrameworkElement.VerticalAlignment%2A><br /><br /> <xref:System.Windows.FrameworkElement.HorizontalAlignment%2A>|  
|<xref:System.Windows.Forms.Integration.WindowsFormsHost>|<xref:System.Windows.Forms.Control.Margin%2A><br /><br /> <xref:System.Windows.Forms.Control.Dock%2A><br /><br /> <xref:System.Windows.Forms.Control.AutoSize%2A><br /><br /> <xref:System.Windows.Forms.Control.Location%2A><br /><br /> <xref:System.Windows.Forms.Control.MaximumSize%2A>|  
  
 <span data-ttu-id="78699-150">請勿直接在裝載的內容上設定這些屬性。</span><span class="sxs-lookup"><span data-stu-id="78699-150">Do not set these properties directly on the hosted content.</span></span> <span data-ttu-id="78699-151">如需詳細資訊，請參閱 [WindowsFormsHost 元素的配置考量](layout-considerations-for-the-windowsformshost-element.md)。</span><span class="sxs-lookup"><span data-stu-id="78699-151">For more information, see [Layout Considerations for the WindowsFormsHost Element](layout-considerations-for-the-windowsformshost-element.md).</span></span>  
  
<a name="navigation_applications"></a>
## <a name="navigation-applications"></a><span data-ttu-id="78699-152">瀏覽應用程式</span><span class="sxs-lookup"><span data-stu-id="78699-152">Navigation Applications</span></span>  
 <span data-ttu-id="78699-153">瀏覽應用程式可能不會保留使用者狀態。</span><span class="sxs-lookup"><span data-stu-id="78699-153">Navigation applications may not maintain user state.</span></span> <span data-ttu-id="78699-154">當<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素在導航應用程式中使用時，它重新創建其控制項。</span><span class="sxs-lookup"><span data-stu-id="78699-154">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element recreates its controls when it is used in a navigation application.</span></span> <span data-ttu-id="78699-155">當使用者從承載元素的頁面導航，然後返回到該元素時，<xref:System.Windows.Forms.Integration.WindowsFormsHost>將重新創建子控制項。</span><span class="sxs-lookup"><span data-stu-id="78699-155">Recreating child controls occurs when the user navigates away from the page hosting the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element and then returns to it.</span></span> <span data-ttu-id="78699-156">使用者已輸入的任何內容都將遺失。</span><span class="sxs-lookup"><span data-stu-id="78699-156">Any content that has been typed in by the user will be lost.</span></span>  
  
<a name="message_loop_interoperation"></a>
## <a name="message-loop-interoperation"></a><span data-ttu-id="78699-157">訊息迴圈交互操作</span><span class="sxs-lookup"><span data-stu-id="78699-157">Message Loop Interoperation</span></span>  
 <span data-ttu-id="78699-158">使用 Windows 表單消息迴圈時，郵件可能無法按預期方式處理。</span><span class="sxs-lookup"><span data-stu-id="78699-158">When working with Windows Forms message loops, messages may not be processed as expected.</span></span> <span data-ttu-id="78699-159">該方法<xref:System.Windows.Forms.Integration.WindowsFormsHost.EnableWindowsFormsInterop%2A>由<xref:System.Windows.Forms.Integration.WindowsFormsHost>建構函式調用。</span><span class="sxs-lookup"><span data-stu-id="78699-159">The <xref:System.Windows.Forms.Integration.WindowsFormsHost.EnableWindowsFormsInterop%2A> method is called by the <xref:System.Windows.Forms.Integration.WindowsFormsHost> constructor.</span></span> <span data-ttu-id="78699-160">這個方法會將訊息篩選器加入至 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 訊息迴圈。</span><span class="sxs-lookup"><span data-stu-id="78699-160">This method adds a message filter to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] message loop.</span></span> <span data-ttu-id="78699-161">如果 是消息<xref:System.Windows.Forms.Control.PreProcessMessage%2A?displayProperty=nameWithType>的目標，<xref:System.Windows.Forms.Control?displayProperty=nameWithType>則此篩選器調用 方法，並轉換/調度消息。</span><span class="sxs-lookup"><span data-stu-id="78699-161">This filter calls the <xref:System.Windows.Forms.Control.PreProcessMessage%2A?displayProperty=nameWithType> method if a <xref:System.Windows.Forms.Control?displayProperty=nameWithType> was the target of the message and translates/dispatches the message.</span></span>  
  
 <span data-ttu-id="78699-162">如果在 Windows<xref:System.Windows.Window>表單消息迴圈中顯示 ，<xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>則除非調用 方法，<xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A>否則無法鍵入任何內容。</span><span class="sxs-lookup"><span data-stu-id="78699-162">If you show a <xref:System.Windows.Window> in a Windows Forms message loop with <xref:System.Windows.Forms.Application.Run%2A?displayProperty=nameWithType>, you cannot type anything unless you call the <xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A> method.</span></span> <span data-ttu-id="78699-163">該方法<xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A>採用 和<xref:System.Windows.Window>添加<xref:System.Windows.Forms.IMessageFilter?displayProperty=nameWithType>，將與鍵相關的消息重新路由到[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]消息迴圈。</span><span class="sxs-lookup"><span data-stu-id="78699-163">The <xref:System.Windows.Forms.Integration.ElementHost.EnableModelessKeyboardInterop%2A> method takes a <xref:System.Windows.Window> and adds a <xref:System.Windows.Forms.IMessageFilter?displayProperty=nameWithType>, which reroutes key-related messages to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] message loop.</span></span> <span data-ttu-id="78699-164">如需詳細資訊，請參閱 [Windows Form 和 WPF 互通性輸入架構](windows-forms-and-wpf-interoperability-input-architecture.md)。</span><span class="sxs-lookup"><span data-stu-id="78699-164">For more information, see [Windows Forms and WPF Interoperability Input Architecture](windows-forms-and-wpf-interoperability-input-architecture.md).</span></span>  
  
<a name="opacity_and_layering"></a>
## <a name="opacity-and-layering"></a><span data-ttu-id="78699-165">不透明度與分層</span><span class="sxs-lookup"><span data-stu-id="78699-165">Opacity and Layering</span></span>  
 <span data-ttu-id="78699-166">類<xref:System.Windows.Interop.HwndHost>不支援分層。</span><span class="sxs-lookup"><span data-stu-id="78699-166">The <xref:System.Windows.Interop.HwndHost> class does not support layering.</span></span> <span data-ttu-id="78699-167"><xref:System.Windows.UIElement.Opacity%2A>這意味著在<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素上設置屬性不起作用，並且不會與設置為[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<xref:System.Windows.Window.AllowsTransparency%2A>`true`的其他視窗進行混合。</span><span class="sxs-lookup"><span data-stu-id="78699-167">This means that setting the <xref:System.Windows.UIElement.Opacity%2A> property on the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element has no effect, and no blending will occur with other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] windows which have <xref:System.Windows.Window.AllowsTransparency%2A> set to `true`.</span></span>  
  
<a name="dispose"></a>
## <a name="dispose"></a><span data-ttu-id="78699-168">處置</span><span class="sxs-lookup"><span data-stu-id="78699-168">Dispose</span></span>  
 <span data-ttu-id="78699-169">未正確處置類別可能造成流失資源。</span><span class="sxs-lookup"><span data-stu-id="78699-169">Not disposing classes properly can leak resources.</span></span> <span data-ttu-id="78699-170">在混合應用程式中，請確保 已釋放<xref:System.Windows.Forms.Integration.WindowsFormsHost>和<xref:System.Windows.Forms.Integration.ElementHost>類，否則可能會洩漏資源。</span><span class="sxs-lookup"><span data-stu-id="78699-170">In your hybrid applications, make sure that the <xref:System.Windows.Forms.Integration.WindowsFormsHost> and <xref:System.Windows.Forms.Integration.ElementHost> classes are disposed, or you could leak resources.</span></span> <span data-ttu-id="78699-171">Windows 表單在其<xref:System.Windows.Forms.Integration.ElementHost>非模式<xref:System.Windows.Forms.Form>父表單關閉時釋放控制項。</span><span class="sxs-lookup"><span data-stu-id="78699-171">Windows Forms disposes <xref:System.Windows.Forms.Integration.ElementHost> controls when its non-modal <xref:System.Windows.Forms.Form> parent closes.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]<span data-ttu-id="78699-172">當應用程式<xref:System.Windows.Forms.Integration.WindowsFormsHost>關閉時釋放元素。</span><span class="sxs-lookup"><span data-stu-id="78699-172">disposes <xref:System.Windows.Forms.Integration.WindowsFormsHost> elements when your application shuts down.</span></span> <span data-ttu-id="78699-173">可以在 Windows 表單消息<xref:System.Windows.Forms.Integration.WindowsFormsHost>迴圈<xref:System.Windows.Window>中顯示 元素。</span><span class="sxs-lookup"><span data-stu-id="78699-173">It is possible to show a <xref:System.Windows.Forms.Integration.WindowsFormsHost> element in a <xref:System.Windows.Window> in a Windows Forms message loop.</span></span> <span data-ttu-id="78699-174">在此情況下，您的程式碼可能不會收到應用程式正在關閉的通知。</span><span class="sxs-lookup"><span data-stu-id="78699-174">In this case, your code may not receive notification that your application is shutting down.</span></span>  
  
<a name="enabling_visual_styles"></a>
## <a name="enabling-visual-styles"></a><span data-ttu-id="78699-175">啟用視覺化樣式</span><span class="sxs-lookup"><span data-stu-id="78699-175">Enabling Visual Styles</span></span>  
 <span data-ttu-id="78699-176">可能無法啟用 Windows 表單控制項上的 Microsoft Windows XP 可視樣式。</span><span class="sxs-lookup"><span data-stu-id="78699-176">Microsoft Windows XP visual styles on a Windows Forms control may not be enabled.</span></span> <span data-ttu-id="78699-177">該方法<xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType>在 Windows 表單應用程式的範本中調用。</span><span class="sxs-lookup"><span data-stu-id="78699-177">The <xref:System.Windows.Forms.Application.EnableVisualStyles%2A?displayProperty=nameWithType> method is called in the template for a Windows Forms application.</span></span> <span data-ttu-id="78699-178">儘管預設情況下不調用此方法，但如果使用 Visual Studio 創建專案，如果 Comctl32.dll 的版本 6.0 可用，則將為控制項獲取 Microsoft Windows XP 可視樣式。</span><span class="sxs-lookup"><span data-stu-id="78699-178">Although this method is not called by default, if you use Visual Studio to create a project, you will get Microsoft Windows XP visual styles for controls, if version 6.0 of Comctl32.dll is available.</span></span> <span data-ttu-id="78699-179">線上程上創建<xref:System.Windows.Forms.Application.EnableVisualStyles%2A>控制碼之前，必須調用 方法。</span><span class="sxs-lookup"><span data-stu-id="78699-179">You must call the <xref:System.Windows.Forms.Application.EnableVisualStyles%2A> method before handles are created on the thread.</span></span> <span data-ttu-id="78699-180">如需詳細資訊，請參閱[如何：在混合應用程式中啟用視覺化樣式](how-to-enable-visual-styles-in-a-hybrid-application.md)。</span><span class="sxs-lookup"><span data-stu-id="78699-180">For more information, see [How to: Enable Visual Styles in a Hybrid Application](how-to-enable-visual-styles-in-a-hybrid-application.md).</span></span>  
  
<a name="licensed_controls"></a>
## <a name="licensed-controls"></a><span data-ttu-id="78699-181">授權的控制項</span><span class="sxs-lookup"><span data-stu-id="78699-181">Licensed Controls</span></span>  
 <span data-ttu-id="78699-182">向使用者顯示訊息方塊中許可資訊的許可 Windows 表單控制項可能會導致混合應用程式的意外行為。</span><span class="sxs-lookup"><span data-stu-id="78699-182">Licensed Windows Forms controls that display licensing information in a message box to the user might cause unexpected behavior for a hybrid application.</span></span> <span data-ttu-id="78699-183">某些授權的控制項會顯示對話方塊，以回應控制代碼的建立。</span><span class="sxs-lookup"><span data-stu-id="78699-183">Some licensed controls show a dialog box in response to handle creation.</span></span> <span data-ttu-id="78699-184">例如，授權的控制項可能會通知使用者，必須具有授權，或者使用者還剩三次機會來試用控制項。</span><span class="sxs-lookup"><span data-stu-id="78699-184">For example, a licensed control might inform the user that a license is required, or that the user has three remaining trial uses of the control.</span></span>  
  
 <span data-ttu-id="78699-185">元素<xref:System.Windows.Forms.Integration.WindowsFormsHost>派生自 類<xref:System.Windows.Interop.HwndHost>，並在<xref:System.Windows.Forms.Integration.WindowsFormsHost.BuildWindowCore%2A>方法內創建子控制項的控制碼。</span><span class="sxs-lookup"><span data-stu-id="78699-185">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element derives from the <xref:System.Windows.Interop.HwndHost> class, and the child control’s handle is created inside the <xref:System.Windows.Forms.Integration.WindowsFormsHost.BuildWindowCore%2A> method.</span></span> <span data-ttu-id="78699-186">類<xref:System.Windows.Interop.HwndHost>不允許在<xref:System.Windows.Forms.Integration.WindowsFormsHost.BuildWindowCore%2A>方法中處理消息，但顯示對話方塊會導致發送消息。</span><span class="sxs-lookup"><span data-stu-id="78699-186">The <xref:System.Windows.Interop.HwndHost> class does not allow messages to be processed in the <xref:System.Windows.Forms.Integration.WindowsFormsHost.BuildWindowCore%2A> method, but displaying a dialog box causes messages to be sent.</span></span> <span data-ttu-id="78699-187">要啟用此許可方案，請<xref:System.Windows.Forms.Control.CreateControl%2A?displayProperty=nameWithType>先調用控制項上的方法，然後再將其指定為<xref:System.Windows.Forms.Integration.WindowsFormsHost>元素的子級。</span><span class="sxs-lookup"><span data-stu-id="78699-187">To enable this licensing scenario, call the <xref:System.Windows.Forms.Control.CreateControl%2A?displayProperty=nameWithType> method on the control before assigning it as the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element's child.</span></span>  
  
<a name="wpf_designer"></a>
## <a name="wpf-designer"></a><span data-ttu-id="78699-188">WPF 設計工具</span><span class="sxs-lookup"><span data-stu-id="78699-188">WPF Designer</span></span>  
 <span data-ttu-id="78699-189">您可以使用視覺化工作室的 WPF 設計器來設計 WPF 內容。</span><span class="sxs-lookup"><span data-stu-id="78699-189">You can design your WPF content by using the WPF Designer for Visual Studio.</span></span> <span data-ttu-id="78699-190">以下各節列出了使用 WPF 設計器創作混合應用程式時可能出現的一些常見問題。</span><span class="sxs-lookup"><span data-stu-id="78699-190">The following sections list some common problems that can occur when authoring hybrid applications with the WPF Designer.</span></span>  
  
### <a name="backcolortransparent-is-ignored-at-design-time"></a><span data-ttu-id="78699-191">BackColorTransparent 會在設計階段被略過</span><span class="sxs-lookup"><span data-stu-id="78699-191">BackColorTransparent is ignored at design time</span></span>  
 <span data-ttu-id="78699-192">在<xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A>設計時，該屬性可能無法按預期工作。</span><span class="sxs-lookup"><span data-stu-id="78699-192">The <xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A> property might not work as expected at design time.</span></span>  
  
 <span data-ttu-id="78699-193">如果 WPF 控制項不在可見的父級上，則 WPF 運行時將忽略<xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A>該值。</span><span class="sxs-lookup"><span data-stu-id="78699-193">If a WPF control is not on a visible parent, the WPF runtime ignores the <xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A> value.</span></span> <span data-ttu-id="78699-194"><xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A>可能忽略的原因是物件<xref:System.Windows.Forms.Integration.ElementHost>是在單獨的<xref:System.AppDomain>中創建的。</span><span class="sxs-lookup"><span data-stu-id="78699-194">The reason that <xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A> might be ignored is because <xref:System.Windows.Forms.Integration.ElementHost> object is created in a separate <xref:System.AppDomain>.</span></span> <span data-ttu-id="78699-195">但是，當您運行應用程式時，<xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A>確實按預期工作。</span><span class="sxs-lookup"><span data-stu-id="78699-195">However, when you run the application, <xref:System.Windows.Forms.Integration.ElementHost.BackColorTransparent%2A> does work as expected.</span></span>  
  
### <a name="design-time-error-list-appears-when-the-obj-folder-is-deleted"></a><span data-ttu-id="78699-196">刪除 obj 資料夾時，出現設計階段錯誤清單</span><span class="sxs-lookup"><span data-stu-id="78699-196">Design-time Error List appears when the obj folder is deleted</span></span>  
 <span data-ttu-id="78699-197">如果刪除了 obj 資料夾，就會出現設計階段錯誤清單。</span><span class="sxs-lookup"><span data-stu-id="78699-197">If the obj folder is deleted, the Design-time Error List appears.</span></span>  
  
 <span data-ttu-id="78699-198">使用 時，Windows<xref:System.Windows.Forms.Integration.ElementHost>表單設計器使用專案 obj 資料夾中的"調試"或"釋放"資料夾中生成的檔。</span><span class="sxs-lookup"><span data-stu-id="78699-198">When you design using <xref:System.Windows.Forms.Integration.ElementHost>, the Windows Forms Designer uses generated files in the Debug or Release folder within your project's obj folder.</span></span> <span data-ttu-id="78699-199">如果您刪除這些檔案，就會出現設計階段錯誤清單。</span><span class="sxs-lookup"><span data-stu-id="78699-199">If you delete these files, the Design-time Error List appears.</span></span> <span data-ttu-id="78699-200">若要修正此問題，請重建專案。</span><span class="sxs-lookup"><span data-stu-id="78699-200">To fix this problem, rebuild your project.</span></span> <span data-ttu-id="78699-201">如需詳細資訊，請參閱 [Windows Forms 設計工具的設計階段錯誤](../../winforms/controls/design-time-errors-in-the-windows-forms-designer.md)。</span><span class="sxs-lookup"><span data-stu-id="78699-201">For more information, see [Design-Time Errors in the Windows Forms Designer](../../winforms/controls/design-time-errors-in-the-windows-forms-designer.md).</span></span>  
  
<a name="elementhost_and_ime"></a>
## <a name="elementhost-and-ime"></a><span data-ttu-id="78699-202">ElementHost 和 IME</span><span class="sxs-lookup"><span data-stu-id="78699-202">ElementHost and IME</span></span>  
 <span data-ttu-id="78699-203">當前託管在 的<xref:System.Windows.Forms.Integration.ElementHost>WPF 控制項不支援<xref:System.Windows.Forms.Control.ImeMode%2A>該屬性。</span><span class="sxs-lookup"><span data-stu-id="78699-203">WPF controls hosted in an <xref:System.Windows.Forms.Integration.ElementHost> currently do not support the <xref:System.Windows.Forms.Control.ImeMode%2A> property.</span></span> <span data-ttu-id="78699-204">託管控制項<xref:System.Windows.Forms.Control.ImeMode%2A>將忽略 對 的更改。</span><span class="sxs-lookup"><span data-stu-id="78699-204">Changes to <xref:System.Windows.Forms.Control.ImeMode%2A> will be ignored by the hosted controls.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="78699-205">另請參閱</span><span class="sxs-lookup"><span data-stu-id="78699-205">See also</span></span>

- <xref:System.Windows.Forms.Integration.ElementHost>
- <xref:System.Windows.Forms.Integration.WindowsFormsHost>
- <span data-ttu-id="78699-206">[WPF 設計工具中的互通性](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb628658(v=vs.100))</span><span class="sxs-lookup"><span data-stu-id="78699-206">[Interoperability in the WPF Designer](https://docs.microsoft.com/previous-versions/visualstudio/visual-studio-2010/bb628658(v=vs.100))</span></span>
- [<span data-ttu-id="78699-207">Windows Form 和 WPF 互通性輸入架構</span><span class="sxs-lookup"><span data-stu-id="78699-207">Windows Forms and WPF Interoperability Input Architecture</span></span>](windows-forms-and-wpf-interoperability-input-architecture.md)
- [<span data-ttu-id="78699-208">如何：在混合應用程式中啟用視覺化樣式</span><span class="sxs-lookup"><span data-stu-id="78699-208">How to: Enable Visual Styles in a Hybrid Application</span></span>](how-to-enable-visual-styles-in-a-hybrid-application.md)
- [<span data-ttu-id="78699-209">WindowsFormsHost 元素的配置考量</span><span class="sxs-lookup"><span data-stu-id="78699-209">Layout Considerations for the WindowsFormsHost Element</span></span>](layout-considerations-for-the-windowsformshost-element.md)
- [<span data-ttu-id="78699-210">Windows Form 和 WPF 屬性對應</span><span class="sxs-lookup"><span data-stu-id="78699-210">Windows Forms and WPF Property Mapping</span></span>](windows-forms-and-wpf-property-mapping.md)
- [<span data-ttu-id="78699-211">Windows Forms 設計工具的設計階段錯誤</span><span class="sxs-lookup"><span data-stu-id="78699-211">Design-Time Errors in the Windows Forms Designer</span></span>](../../winforms/controls/design-time-errors-in-the-windows-forms-designer.md)
- [<span data-ttu-id="78699-212">移轉和互通性</span><span class="sxs-lookup"><span data-stu-id="78699-212">Migration and Interoperability</span></span>](migration-and-interoperability.md)
