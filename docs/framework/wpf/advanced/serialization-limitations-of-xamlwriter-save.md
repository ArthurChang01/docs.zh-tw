---
title: XamlWriter.Save 的序列化限制
ms.date: 03/30/2017
helpviewer_keywords:
- XamlWriter.Save [WPF], serialization limitations of
- limitations of XamlWriter.Save
- serialization limitations of XamlWriter.Save
ms.assetid: f86acc91-2b67-4039-8555-505734491d36
ms.openlocfilehash: 89cb36dba63dccdf7e52b7fcafbe3d9fc2fea1e5
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "62053427"
---
# <a name="serialization-limitations-of-xamlwritersave"></a><span data-ttu-id="0d21b-102">XamlWriter.Save 的序列化限制</span><span class="sxs-lookup"><span data-stu-id="0d21b-102">Serialization Limitations of XamlWriter.Save</span></span>
<span data-ttu-id="0d21b-103">[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] <xref:System.Windows.Markup.XamlWriter.Save%2A>可以用來序列化的內容[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]應用程式中[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]檔案。</span><span class="sxs-lookup"><span data-stu-id="0d21b-103">The [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] <xref:System.Windows.Markup.XamlWriter.Save%2A> can be used to serialize the contents of a [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] application as a [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] file.</span></span> <span data-ttu-id="0d21b-104">不過，究竟要將哪些項目序列化，則有一些值得注意的限制。</span><span class="sxs-lookup"><span data-stu-id="0d21b-104">However, there are some notable limitations in exactly what is serialized.</span></span> <span data-ttu-id="0d21b-105">本主題將說明這些限制及一些一般考量。</span><span class="sxs-lookup"><span data-stu-id="0d21b-105">These limitations and some general considerations are documented in this topic.</span></span>  

<a name="Run_Time__Not_Design_Time_Representation"></a>   
## <a name="run-time-not-design-time-representation"></a><span data-ttu-id="0d21b-106">執行階段而非設計階段的表示法</span><span class="sxs-lookup"><span data-stu-id="0d21b-106">Run-Time, Not Design-Time Representation</span></span>  
 <span data-ttu-id="0d21b-107">藉由呼叫項目序列化的基本原理<xref:System.Windows.Markup.XamlWriter.Save%2A>結果就是要序列化的在執行階段物件的表示法。</span><span class="sxs-lookup"><span data-stu-id="0d21b-107">The basic philosophy of what is serialized by a call to <xref:System.Windows.Markup.XamlWriter.Save%2A> is that the result will be a representation of the object being serialized, at run-time.</span></span> <span data-ttu-id="0d21b-108">許多設計階段屬性的原始[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]檔案可能已最佳化或遺失時，[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]載入為記憶體中的物件，並呼叫時，不會保留<xref:System.Windows.Markup.XamlWriter.Save%2A>序列化。</span><span class="sxs-lookup"><span data-stu-id="0d21b-108">Many design-time properties of the original [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file may already be optimized or lost by the time that the [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] is loaded as in-memory objects, and are not preserved when you call <xref:System.Windows.Markup.XamlWriter.Save%2A> to serialize.</span></span> <span data-ttu-id="0d21b-109">序列化的結果是有效呈現應用程式建構的邏輯樹狀結構，但不一定是產生它的原始 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0d21b-109">The serialized result is an effective representation of the constructed logical tree of the application, but not necessarily of the original [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] that produced it.</span></span> <span data-ttu-id="0d21b-110">這些問題會變得使用非常難<xref:System.Windows.Markup.XamlWriter.Save%2A>一部分非常龐大的序列化[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]設計介面。</span><span class="sxs-lookup"><span data-stu-id="0d21b-110">These issues make it extremely difficult to use the <xref:System.Windows.Markup.XamlWriter.Save%2A> serialization as part of an extensive [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] design surface.</span></span>  
  
<a name="Serialization_is_Self_Contained"></a>   
## <a name="serialization-is-self-contained"></a><span data-ttu-id="0d21b-111">序列化是獨立的</span><span class="sxs-lookup"><span data-stu-id="0d21b-111">Serialization is Self-Contained</span></span>  
 <span data-ttu-id="0d21b-112">序列化的輸出<xref:System.Windows.Markup.XamlWriter.Save%2A>是獨立; 內部所包含的所有項目會序列化[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]單一頁面上，具有單一根項目和以外沒有外部參考[!INCLUDE[TLA2#tla_uri#plural](../../../../includes/tla2sharptla-urisharpplural-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0d21b-112">The serialized output of <xref:System.Windows.Markup.XamlWriter.Save%2A> is self-contained; everything that is serialized is contained inside a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] single page, with a single root element, and no external references other than [!INCLUDE[TLA2#tla_uri#plural](../../../../includes/tla2sharptla-urisharpplural-md.md)].</span></span> <span data-ttu-id="0d21b-113">例如，如果您的頁面會參考來自應用程式資源的資源，這些資源的顯示方式，就像它們是要序列化的頁面元件一樣。</span><span class="sxs-lookup"><span data-stu-id="0d21b-113">For instance, if your page referenced resources from application resources, these will appear as if they were a component of the page being serialized.</span></span>  
  
<a name="Extension_References_are_Dereferenced"></a>   
## <a name="extension-references-are-dereferenced"></a><span data-ttu-id="0d21b-114">延伸模組參考已取值</span><span class="sxs-lookup"><span data-stu-id="0d21b-114">Extension References are Dereferenced</span></span>  
 <span data-ttu-id="0d21b-115">透過各種不同標記延伸格式 (例如 `StaticResource` 或 `Binding`) 對物件所做的一般參考，將透過序列化程序來取值。</span><span class="sxs-lookup"><span data-stu-id="0d21b-115">Common references to objects made by various markup extension formats, such as `StaticResource` or `Binding`, will be dereferenced by the serialization process.</span></span> <span data-ttu-id="0d21b-116">這些已取值的時間，記憶體中的物件所建立的應用程式執行階段中，而<xref:System.Windows.Markup.XamlWriter.Save%2A>邏輯不會重新瀏覽原始[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]還原序列化輸出的這類參考。</span><span class="sxs-lookup"><span data-stu-id="0d21b-116">These were already dereferenced at the time that in-memory objects were created by the application runtime, and the <xref:System.Windows.Markup.XamlWriter.Save%2A> logic does not revisit the original [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] to restore such references to the serialized output.</span></span> <span data-ttu-id="0d21b-117">這可能會凍結任何資料繫結或資源取得的值，以做為執行階段表示法上一次使用的值，只透過有限或間接的方式來區分這類值與本機設定的任何其他值。</span><span class="sxs-lookup"><span data-stu-id="0d21b-117">This potentially freezes any databound or resource obtained value to be the value last used by the run-time representation, with only limited or indirect ability to distinguish such a value from any other value set locally.</span></span> <span data-ttu-id="0d21b-118">映像也會序列化為對映像的物件參考 (當它們存在於專案中，而不是原始來源參考)，會遺失原本所參考的任何檔名或 [!INCLUDE[TLA2#tla_uri](../../../../includes/tla2sharptla-uri-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0d21b-118">Images are also serialized as object references to images as they exist in the project, rather than as original source references, losing whatever filename or [!INCLUDE[TLA2#tla_uri](../../../../includes/tla2sharptla-uri-md.md)] was originally referenced.</span></span> <span data-ttu-id="0d21b-119">實際上已將在同一個頁面內宣告的資源序列化至參考它們的點，而不是保留為資源集合的關鍵字。</span><span class="sxs-lookup"><span data-stu-id="0d21b-119">Even resources declared within the same page are seen serialized into the point where they were referenced, rather than being preserved as a key of a resource collection.</span></span>  
  
<a name="Event_Handling_is_Not_Preserved"></a>   
## <a name="event-handling-is-not-preserved"></a><span data-ttu-id="0d21b-120">不會保留事件處理</span><span class="sxs-lookup"><span data-stu-id="0d21b-120">Event Handling is Not Preserved</span></span>  
 <span data-ttu-id="0d21b-121">透過 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 加入的事件處理常式均已序列化，不會保留它們。</span><span class="sxs-lookup"><span data-stu-id="0d21b-121">When event handlers that are added through [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] are serialized, they are not preserved.</span></span> <span data-ttu-id="0d21b-122">不具程式碼後置 (而且沒有相關的 x:Code 機制) 的 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]，無法序列化執行階段程序邏輯。</span><span class="sxs-lookup"><span data-stu-id="0d21b-122">[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] without code-behind (and also without the related x:Code mechanism) has no way of serializing runtime procedural logic.</span></span> <span data-ttu-id="0d21b-123">由於序列化是獨立且受限於邏輯樹狀結構，所以，沒有任何功能可用來儲存事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="0d21b-123">Because serialization is self-contained and limited to the logical tree, there is no facility for storing the event handlers.</span></span> <span data-ttu-id="0d21b-124">因此，會從輸出 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 中移除事件處理常式屬性 (屬性本身以及為處理常式命名的字串值)。</span><span class="sxs-lookup"><span data-stu-id="0d21b-124">As a result, event handler attributes, both the attribute itself and the string value that names the handler, are removed from the output [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)].</span></span>  
  
<a name="Realistic_Scenarios_for_Use_of_XAMLWriter_Save"></a>   
## <a name="realistic-scenarios-for-use-of-xamlwritersave"></a><span data-ttu-id="0d21b-125">使用 XAMLWriter.Save 的真實案例</span><span class="sxs-lookup"><span data-stu-id="0d21b-125">Realistic Scenarios for Use of XAMLWriter.Save</span></span>  
 <span data-ttu-id="0d21b-126">雖然限制列出如下相當多，還有數個使用的適當案例<xref:System.Windows.Markup.XamlWriter.Save%2A>進行序列化。</span><span class="sxs-lookup"><span data-stu-id="0d21b-126">While the limitations listed here are fairly substantial, there are still several appropriate scenarios for using <xref:System.Windows.Markup.XamlWriter.Save%2A> for serialization.</span></span>  
  
- <span data-ttu-id="0d21b-127">向量或圖形輸出：轉譯區域的輸出可用來重新產生相同的向量或圖形時重新載入。</span><span class="sxs-lookup"><span data-stu-id="0d21b-127">Vector or graphical output: The output of the rendered area can be used to reproduce the same vector or graphics when reloaded.</span></span>  
  
- <span data-ttu-id="0d21b-128">豐富的文字和非固定格式文件：文字和所有項目格式設定和項目內含項目內會保留在輸出中。</span><span class="sxs-lookup"><span data-stu-id="0d21b-128">Rich text and flow documents: Text and all element formatting and element containment within it is preserved in the output.</span></span> <span data-ttu-id="0d21b-129">這適用於估計剪貼簿功能的機制。</span><span class="sxs-lookup"><span data-stu-id="0d21b-129">This can be useful for mechanisms that approximate a clipboard functionality.</span></span>  
  
- <span data-ttu-id="0d21b-130">保留商務物件資料：如果您將資料儲存在自訂的項目，例如[!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)]資料，只要您的商務物件遵循基本[!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]等提供自訂建構函式和傳址屬性值的轉換規則，這些商務物件可以是永久存在於透過序列化。</span><span class="sxs-lookup"><span data-stu-id="0d21b-130">Preserving business object data: If you have stored data in custom elements, such as [!INCLUDE[TLA2#tla_xml](../../../../includes/tla2sharptla-xml-md.md)] data, so long as your business objects follow basic [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] rules such as providing custom constructors and conversion for by-reference property values, these business objects can be perpetuated through serialization.</span></span>
