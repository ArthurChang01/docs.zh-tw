---
title: 合併的資源字典
ms.date: 03/30/2017
helpviewer_keywords:
- merged resource dictionaries [WPF]
- dictionaries [WPF], merged resources
ms.assetid: d159531f-05d4-49fd-b951-c332de51e5bc
ms.openlocfilehash: 899955a9f3302e67de4efa0ce0cb6baf6bf0ec5d
ms.sourcegitcommit: f8c36054eab877de4d40a705aacafa2552ce70e9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/31/2019
ms.locfileid: "75559777"
---
# <a name="merged-resource-dictionaries"></a><span data-ttu-id="6c288-102">合併的資源字典</span><span class="sxs-lookup"><span data-stu-id="6c288-102">Merged Resource Dictionaries</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] <span data-ttu-id="6c288-103">資源支援合併的資源字典功能。</span><span class="sxs-lookup"><span data-stu-id="6c288-103">resources support a merged resource dictionary feature.</span></span> <span data-ttu-id="6c288-104">這項功能提供一種方法，定義已編譯之 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 應用程式之外的 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 應用程式的資源部分。</span><span class="sxs-lookup"><span data-stu-id="6c288-104">This feature provides a way to define the resources portion of a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] application outside of the compiled [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] application.</span></span> <span data-ttu-id="6c288-105">然後，資源可在應用程式間共用，也更方便隔離進行當地語系化。</span><span class="sxs-lookup"><span data-stu-id="6c288-105">Resources can then be shared across applications and are also more conveniently isolated for localization.</span></span>  
  
## <a name="introducing-a-merged-resource-dictionary"></a><span data-ttu-id="6c288-106">簡介合併的資源字典</span><span class="sxs-lookup"><span data-stu-id="6c288-106">Introducing a Merged Resource Dictionary</span></span>  
 <span data-ttu-id="6c288-107">在標記中，您使用下列語法將合併的資源字典引入頁面︰</span><span class="sxs-lookup"><span data-stu-id="6c288-107">In markup, you use the following syntax to introduce a merged resource dictionary into a page:</span></span>  
  
 [!code-xaml[ResourceMergeDictionary#MergedXAML](~/samples/snippets/csharp/VS_Snippets_Wpf/ResourceMergeDictionary/CS/default.xaml#mergedxaml)]  
  
 <span data-ttu-id="6c288-108">請注意，<xref:System.Windows.ResourceDictionary> 元素並沒有[x：Key](../../../desktop-wpf/xaml-services/xkey-directive.md)指示詞，資源集合中的所有專案通常都需要此指示詞。</span><span class="sxs-lookup"><span data-stu-id="6c288-108">Note that the <xref:System.Windows.ResourceDictionary> element does not have an [x:Key Directive](../../../desktop-wpf/xaml-services/xkey-directive.md), which is generally required for all items in a resource collection.</span></span> <span data-ttu-id="6c288-109">但是，<xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> 集合內的另一個 <xref:System.Windows.ResourceDictionary> 參考是特殊案例，保留給這個合併的資源字典案例。</span><span class="sxs-lookup"><span data-stu-id="6c288-109">But another <xref:System.Windows.ResourceDictionary> reference within the <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> collection is a special case, reserved for this merged resource dictionary scenario.</span></span> <span data-ttu-id="6c288-110">引進合併資源字典的 <xref:System.Windows.ResourceDictionary> 不能有[x：Key](../../../desktop-wpf/xaml-services/xkey-directive.md)指示詞。</span><span class="sxs-lookup"><span data-stu-id="6c288-110">The <xref:System.Windows.ResourceDictionary> that introduces a merged resource dictionary cannot have an [x:Key Directive](../../../desktop-wpf/xaml-services/xkey-directive.md).</span></span> <span data-ttu-id="6c288-111">一般來說，<xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> 集合中的每個 <xref:System.Windows.ResourceDictionary> 都會指定一個 <xref:System.Windows.ResourceDictionary.Source%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="6c288-111">Typically, each <xref:System.Windows.ResourceDictionary> within the <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> collection specifies a <xref:System.Windows.ResourceDictionary.Source%2A> attribute.</span></span> <span data-ttu-id="6c288-112"><xref:System.Windows.ResourceDictionary.Source%2A> 的值應該是統一資源識別元（URI），它會解析為要合併之資源檔的位置。</span><span class="sxs-lookup"><span data-stu-id="6c288-112">The value of <xref:System.Windows.ResourceDictionary.Source%2A> should be a uniform resource identifier (URI) that resolves to the location of the resources file to be merged.</span></span> <span data-ttu-id="6c288-113">該 URI 的目的地必須是另一個 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 檔案，並以 <xref:System.Windows.ResourceDictionary> 作為其根項目。</span><span class="sxs-lookup"><span data-stu-id="6c288-113">The destination of that URI must be another [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file, with <xref:System.Windows.ResourceDictionary> as its root element.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6c288-114">在指定為合併字典的 <xref:System.Windows.ResourceDictionary> 中定義資源是合法的，這可以做為指定 <xref:System.Windows.ResourceDictionary.Source%2A>的替代方法，或是除了指定的來源所包含的任何資源之外。</span><span class="sxs-lookup"><span data-stu-id="6c288-114">It is legal to define resources within a <xref:System.Windows.ResourceDictionary> that is specified as a merged dictionary, either as an alternative to specifying <xref:System.Windows.ResourceDictionary.Source%2A>, or in addition to whatever resources are included from the specified source.</span></span> <span data-ttu-id="6c288-115">不過，這不是常見的案例。合併字典的主要案例是合併來自外部檔案位置的資源。</span><span class="sxs-lookup"><span data-stu-id="6c288-115">However, this is not a common scenario; the main scenario for merged dictionaries is to merge resources from external file locations.</span></span> <span data-ttu-id="6c288-116">如果您想要在頁面的標記內指定資源，通常應該在主要 <xref:System.Windows.ResourceDictionary> 中定義，而不是在合併的字典中。</span><span class="sxs-lookup"><span data-stu-id="6c288-116">If you want to specify resources within the markup for a page, you should typically define these in the main <xref:System.Windows.ResourceDictionary> and not in the merged dictionaries.</span></span>  
  
## <a name="merged-dictionary-behavior"></a><span data-ttu-id="6c288-117">合併的字典行為</span><span class="sxs-lookup"><span data-stu-id="6c288-117">Merged Dictionary Behavior</span></span>  
 <span data-ttu-id="6c288-118">合併字典中的資源佔用資源查閱範圍中的位置，就在它們合併所在的主要資源字典範圍後面。</span><span class="sxs-lookup"><span data-stu-id="6c288-118">Resources in a merged dictionary occupy a location in the resource lookup scope that is just after the scope of the main resource dictionary they are merged into.</span></span> <span data-ttu-id="6c288-119">雖然資源索引鍵在任何個別的字典中必須是唯一的，但合併字典集合中可有多個索引鍵。</span><span class="sxs-lookup"><span data-stu-id="6c288-119">Although a resource key must be unique within any individual dictionary, a key can exist multiple times in a set of merged dictionaries.</span></span> <span data-ttu-id="6c288-120">在此情況下，傳回的資源會來自 <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> 集合中順序的最後一個字典。</span><span class="sxs-lookup"><span data-stu-id="6c288-120">In this case, the resource that is returned will come from the last dictionary found sequentially in the <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> collection.</span></span> <span data-ttu-id="6c288-121">如果 <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> 集合是在 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]中定義，則集合中合併字典的順序就是標記中所提供專案的順序。</span><span class="sxs-lookup"><span data-stu-id="6c288-121">If the <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> collection was defined in [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], then the order of the merged dictionaries in the collection is the order of the elements as provided in the markup.</span></span> <span data-ttu-id="6c288-122">如果主要字典和合併的字典中都定義了索引鍵，則傳回的資源會來自主要字典。</span><span class="sxs-lookup"><span data-stu-id="6c288-122">If a key is defined in the primary dictionary and also in a dictionary that was merged, then the resource that is returned will come from the primary dictionary.</span></span> <span data-ttu-id="6c288-123">這些範圍規則同樣適用於靜態資源參考和動態資源參考。</span><span class="sxs-lookup"><span data-stu-id="6c288-123">These scoping rules apply equally for both static resource references and dynamic resource references.</span></span>  
  
### <a name="merged-dictionaries-and-code"></a><span data-ttu-id="6c288-124">合併的字典和程式碼</span><span class="sxs-lookup"><span data-stu-id="6c288-124">Merged Dictionaries and Code</span></span>  
 <span data-ttu-id="6c288-125">合併的字典可以透過程式碼新增至 `Resources` 字典。</span><span class="sxs-lookup"><span data-stu-id="6c288-125">Merged dictionaries can be added to a `Resources` dictionary through code.</span></span> <span data-ttu-id="6c288-126">任何 `Resources` 屬性的預設 <xref:System.Windows.ResourceDictionary>，一開始都會有一個預設的空 <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> 集合屬性。</span><span class="sxs-lookup"><span data-stu-id="6c288-126">The default, initially empty <xref:System.Windows.ResourceDictionary> that exists for any `Resources` property also has a default, initially empty <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> collection property.</span></span> <span data-ttu-id="6c288-127">若要透過程式碼加入合併的字典，您可以取得所需主要 <xref:System.Windows.ResourceDictionary>的參考、取得其 <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> 屬性值，並在 <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A>所包含的泛型 `Collection` 上呼叫 `Add`。</span><span class="sxs-lookup"><span data-stu-id="6c288-127">To add a merged dictionary through code, you obtain a reference to the desired primary <xref:System.Windows.ResourceDictionary>, get its <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A> property value, and call `Add` on the generic `Collection` that is contained in <xref:System.Windows.ResourceDictionary.MergedDictionaries%2A>.</span></span> <span data-ttu-id="6c288-128">您加入的物件必須是新的 <xref:System.Windows.ResourceDictionary>。</span><span class="sxs-lookup"><span data-stu-id="6c288-128">The object you add must be a new <xref:System.Windows.ResourceDictionary>.</span></span> <span data-ttu-id="6c288-129">在程式碼中，您不會設定 <xref:System.Windows.ResourceDictionary.Source%2A> 屬性。</span><span class="sxs-lookup"><span data-stu-id="6c288-129">In code, you do not set the <xref:System.Windows.ResourceDictionary.Source%2A> property.</span></span> <span data-ttu-id="6c288-130">相反地，您必須建立一個或載入一個 <xref:System.Windows.ResourceDictionary> 物件來取得。</span><span class="sxs-lookup"><span data-stu-id="6c288-130">Instead, you must obtain a <xref:System.Windows.ResourceDictionary> object by either creating one or loading one.</span></span> <span data-ttu-id="6c288-131">載入現有 <xref:System.Windows.ResourceDictionary> 以在具有 <xref:System.Windows.ResourceDictionary> 根的現有 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 檔案資料流程上呼叫 <xref:System.Windows.Markup.XamlReader.Load%2A?displayProperty=nameWithType>，然後將 <xref:System.Windows.Markup.XamlReader.Load%2A?displayProperty=nameWithType> 傳回值轉換為 <xref:System.Windows.ResourceDictionary>的其中一種方式。</span><span class="sxs-lookup"><span data-stu-id="6c288-131">One way to load an existing <xref:System.Windows.ResourceDictionary> to call <xref:System.Windows.Markup.XamlReader.Load%2A?displayProperty=nameWithType> on an existing [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file stream that has a <xref:System.Windows.ResourceDictionary> root, then casting the <xref:System.Windows.Markup.XamlReader.Load%2A?displayProperty=nameWithType> return value to <xref:System.Windows.ResourceDictionary>.</span></span>  
  
### <a name="merged-resource-dictionary-uris"></a><span data-ttu-id="6c288-132">合併的資源字典 URI</span><span class="sxs-lookup"><span data-stu-id="6c288-132">Merged Resource Dictionary URIs</span></span>  
 <span data-ttu-id="6c288-133">有幾種方法可讓您加入合併的資源字典，這會以您將使用的統一資源識別項（URI）格式來表示。</span><span class="sxs-lookup"><span data-stu-id="6c288-133">There are several techniques for how to include a merged resource dictionary, which are indicated by the uniform resource identifier (URI) format that you will use.</span></span> <span data-ttu-id="6c288-134">廣泛而言，這些技巧可分為兩類︰編譯為專案一部分的資源，和不編譯為專案一部分的資源。</span><span class="sxs-lookup"><span data-stu-id="6c288-134">Broadly speaking, these techniques can be divided into two categories: resources that are compiled as part of the project, and resources that are not compiled as part of the project.</span></span>  
  
 <span data-ttu-id="6c288-135">若為編譯為專案一部分的資源，您可以使用參照資源位置的相對路徑。</span><span class="sxs-lookup"><span data-stu-id="6c288-135">For resources that are compiled as part of the project, you can use a relative path that refers to the resource location.</span></span> <span data-ttu-id="6c288-136">在編譯期間評估相對路徑。</span><span class="sxs-lookup"><span data-stu-id="6c288-136">The relative path is evaluated during compilation.</span></span> <span data-ttu-id="6c288-137">您的資源必須定義為專案的一部分，作為資源建置動作。</span><span class="sxs-lookup"><span data-stu-id="6c288-137">Your resource must be defined as part of the project as a Resource build action.</span></span> <span data-ttu-id="6c288-138">如果您在專案中將資源 .xaml 檔案包含為資源，就不需要將資源檔複製到輸出目錄，該資源已包含在已編譯的應用程式中。</span><span class="sxs-lookup"><span data-stu-id="6c288-138">If you include a resource .xaml file in the project as Resource, you do not need to copy the resource file to the output directory, the resource is already included within the compiled application.</span></span> <span data-ttu-id="6c288-139">您也可以使用內容建置動作，但您必須接著將檔案複製到輸出目錄，也將資源檔部署在與可執行檔有關的同一路徑。</span><span class="sxs-lookup"><span data-stu-id="6c288-139">You can also use Content build action, but you must then copy the files to the output directory and also deploy the resource files in the same path relationship to the executable.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="6c288-140">請勿使用內嵌資源建置動作。</span><span class="sxs-lookup"><span data-stu-id="6c288-140">Do not use the Embedded Resource build action.</span></span> <span data-ttu-id="6c288-141">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 的應用程式支援組建動作本身，但 <xref:System.Windows.ResourceDictionary.Source%2A> 的解決方式不會納入 <xref:System.Resources.ResourceManager>，因此無法將個別資源從資料流程中分離出來。</span><span class="sxs-lookup"><span data-stu-id="6c288-141">The build action itself is supported for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] applications, but the resolution of <xref:System.Windows.ResourceDictionary.Source%2A> does not incorporate <xref:System.Resources.ResourceManager>, and thus cannot separate the individual resource out of the stream.</span></span> <span data-ttu-id="6c288-142">您仍然可以使用內嵌資源來進行其他目的，只要您也使用 <xref:System.Resources.ResourceManager> 來存取資源。</span><span class="sxs-lookup"><span data-stu-id="6c288-142">You could still use Embedded Resource for other purposes so long as you also used <xref:System.Resources.ResourceManager> to access the resources.</span></span>  
  
 <span data-ttu-id="6c288-143">相關技術是使用 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] 檔案的 Pack URI，並參考為來源。</span><span class="sxs-lookup"><span data-stu-id="6c288-143">A related technique is to use a Pack URI to a [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)] file, and refer to it as Source.</span></span> <span data-ttu-id="6c288-144">Pack URI 可以參考參考組件的元件和其他技術。</span><span class="sxs-lookup"><span data-stu-id="6c288-144">Pack URI enables references to components of referenced assemblies and other techniques.</span></span> <span data-ttu-id="6c288-145">如需 Pack URI 的詳細資訊，請參閱 [WPF 應用程式資源、內容和資料檔案](../app-development/wpf-application-resource-content-and-data-files.md)。</span><span class="sxs-lookup"><span data-stu-id="6c288-145">For more information on Pack URIs, see [WPF Application Resource, Content, and Data Files](../app-development/wpf-application-resource-content-and-data-files.md).</span></span>  
  
 <span data-ttu-id="6c288-146">若為不編譯為專案一部分的資源，則會在執行階段評估 URI。</span><span class="sxs-lookup"><span data-stu-id="6c288-146">For resources that are not compiled as part of the project, the URI is evaluated at run time.</span></span> <span data-ttu-id="6c288-147">您可以使用一般的 URI 傳輸，例如 file: 或 http:，參考資源檔。</span><span class="sxs-lookup"><span data-stu-id="6c288-147">You can use a common URI transport such as file: or http: to refer to the resource file.</span></span> <span data-ttu-id="6c288-148">使用未編譯資源方法的缺點是 file: 存取需要額外的部署步驟，以及 http: 存取表示網際網路安全性區域。</span><span class="sxs-lookup"><span data-stu-id="6c288-148">The disadvantage of using the noncompiled resource approach is that file: access requires additional deployment steps, and http: access implies the Internet security zone.</span></span>  
  
### <a name="reusing-merged-dictionaries"></a><span data-ttu-id="6c288-149">重複使用合併的字典</span><span class="sxs-lookup"><span data-stu-id="6c288-149">Reusing Merged Dictionaries</span></span>  
 <span data-ttu-id="6c288-150">您可以在應用程式之間重複使用或共用合併的資源字典，因為要合併的資源字典可以透過任何有效的統一資源識別元（URI）來參考。</span><span class="sxs-lookup"><span data-stu-id="6c288-150">You can reuse or share merged resource dictionaries between applications, because the resource dictionary to merge can be referenced through any valid uniform resource identifier (URI).</span></span> <span data-ttu-id="6c288-151">至於確實該如何做，取決於您的應用程式部署策略以及您遵循的應用程式模型。</span><span class="sxs-lookup"><span data-stu-id="6c288-151">Exactly how you do this will depend on your application deployment strategy and which application model you follow.</span></span> <span data-ttu-id="6c288-152">前述的 Pack URI 策略提供了一個常見的方法，在開發期間透過共用組件參考，在多個專案中取得合併的資源。</span><span class="sxs-lookup"><span data-stu-id="6c288-152">The aforementioned Pack URI strategy provides a way to commonly source a merged resource across multiple projects during development by sharing an assembly reference.</span></span> <span data-ttu-id="6c288-153">在此案例中，資源仍由用戶端散發，至少一個應用程式必須部署參考的組件。</span><span class="sxs-lookup"><span data-stu-id="6c288-153">In this scenario the resources are still distributed by the client, and at least one of the applications must deploy the referenced assembly.</span></span> <span data-ttu-id="6c288-154">也可以透過使用 http 通訊協定的分散式 URI 參考合併的資源。</span><span class="sxs-lookup"><span data-stu-id="6c288-154">It is also possible to reference merged resources through a distributed URI that uses the http protocol.</span></span>  
  
 <span data-ttu-id="6c288-155">將合併的字典撰寫為本機應用程式檔案，或寫入本機的共用存放裝置，是另一個可行的合併字典/應用程式部署案例。</span><span class="sxs-lookup"><span data-stu-id="6c288-155">Writing merged dictionaries as local application files or to local shared storage is another possible merged dictionary / application deployment scenario.</span></span>  
  
### <a name="localization"></a><span data-ttu-id="6c288-156">當地語系化</span><span class="sxs-lookup"><span data-stu-id="6c288-156">Localization</span></span>  
 <span data-ttu-id="6c288-157">如果需要當地語系化的資源隔離至合併到主要字典的字典，並保持鬆散如 [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)]，則這些檔案可以分別進行當地語系化。</span><span class="sxs-lookup"><span data-stu-id="6c288-157">If resources that need to be localized are isolated to dictionaries that are merged into primary dictionaries, and kept as loose [!INCLUDE[TLA2#tla_xaml](../../../../includes/tla2sharptla-xaml-md.md)], these files can be localized separately.</span></span> <span data-ttu-id="6c288-158">這項技術是當地語系化附屬資源組件的輕量型替代方案。</span><span class="sxs-lookup"><span data-stu-id="6c288-158">This technique is a lightweight alternative to localizing  the satellite resource assemblies.</span></span> <span data-ttu-id="6c288-159">如需詳細資訊，請參閱 [WPF 全球化和當地語系化概觀](wpf-globalization-and-localization-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="6c288-159">For details, see [WPF Globalization and Localization Overview](wpf-globalization-and-localization-overview.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="6c288-160">請參閱</span><span class="sxs-lookup"><span data-stu-id="6c288-160">See also</span></span>

- <xref:System.Windows.ResourceDictionary>
- [<span data-ttu-id="6c288-161">XAML 資源</span><span class="sxs-lookup"><span data-stu-id="6c288-161">XAML Resources</span></span>](../../../desktop-wpf/fundamentals/xaml-resources-define.md)
- [<span data-ttu-id="6c288-162">資源和程式碼</span><span class="sxs-lookup"><span data-stu-id="6c288-162">Resources and Code</span></span>](resources-and-code.md)
- [<span data-ttu-id="6c288-163">WPF 應用程式資源、內容和資料檔案</span><span class="sxs-lookup"><span data-stu-id="6c288-163">WPF Application Resource, Content, and Data Files</span></span>](../app-development/wpf-application-resource-content-and-data-files.md)
