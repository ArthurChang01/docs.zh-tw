---
title: WindowsFormsHost 項目的配置考量
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Forms [WPF], interoperability with
- Windows Forms [WPF], WPF interoperation
- interoperability [WPF], Windows Forms
- WindowsFormsHost element layout considerations [WPF]
- dynamic layout [WPF interoperability]
- device-independent pixels
ms.assetid: 3c574597-bbde-440f-95cc-01371f1a5d9d
ms.openlocfilehash: 9f97639447284b792d52cf4aa25b81f584d7291a
ms.sourcegitcommit: 13e79efdbd589cad6b1de634f5d6b1262b12ab01
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/28/2020
ms.locfileid: "76787897"
---
# <a name="layout-considerations-for-the-windowsformshost-element"></a><span data-ttu-id="425b7-102">WindowsFormsHost 項目的配置考量</span><span class="sxs-lookup"><span data-stu-id="425b7-102">Layout Considerations for the WindowsFormsHost Element</span></span>
<span data-ttu-id="425b7-103">本主題描述 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素如何與 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 版面配置系統互動。</span><span class="sxs-lookup"><span data-stu-id="425b7-103">This topic describes how the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element interacts with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout system.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="425b7-104">和 Windows Forms 支援在表單或頁面上調整大小和定位元素的不同但類似的邏輯。</span><span class="sxs-lookup"><span data-stu-id="425b7-104">and Windows Forms support different, but similar, logic for sizing and positioning elements on a form or page.</span></span> <span data-ttu-id="425b7-105">當您建立在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]中裝載 Windows Forms 控制項的混合式使用者介面（UI）時，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會整合兩個配置配置。</span><span class="sxs-lookup"><span data-stu-id="425b7-105">When you create a hybrid user interface (UI) that hosts Windows Forms controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element integrates the two layout schemes.</span></span>  
  
## <a name="differences-in-layout-between-wpf-and-windows-forms"></a><span data-ttu-id="425b7-106">WPF 與 Windows Forms 之間的版面配置差異</span><span class="sxs-lookup"><span data-stu-id="425b7-106">Differences in Layout Between WPF and Windows Forms</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="425b7-107">使用與解析度無關的版面配置。</span><span class="sxs-lookup"><span data-stu-id="425b7-107">uses resolution-independent layout.</span></span> <span data-ttu-id="425b7-108">所有 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 的版面配置維度都是使用*與裝置無關的圖元*來指定。</span><span class="sxs-lookup"><span data-stu-id="425b7-108">All [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout dimensions are specified using *device-independent pixels*.</span></span> <span data-ttu-id="425b7-109">與裝置無關的圖元是大小與解析度無關的 90-6，因此不論您是轉譯為 72 DPI 的監視器或 19200 DPI 的印表機，您都會得到類似的結果。</span><span class="sxs-lookup"><span data-stu-id="425b7-109">A device-independent pixel is one ninety-sixth of an inch in size and resolution-independent, so you get similar results regardless of whether you are rendering to a 72-dpi monitor or a 19,200-dpi printer.</span></span>  
  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="425b7-110">也是以*動態版面*配置為基礎。</span><span class="sxs-lookup"><span data-stu-id="425b7-110">is also based on *dynamic layout*.</span></span> <span data-ttu-id="425b7-111">這表示 UI 元素會根據其內容、其父系版面配置容器和可用的螢幕大小，在表單或頁面上排列本身。</span><span class="sxs-lookup"><span data-stu-id="425b7-111">This means that a UI element arranges itself on a form or page according to its content, its parent layout container, and the available screen size.</span></span> <span data-ttu-id="425b7-112">動態配置會在其包含的字串變更長度時，自動調整 UI 元素的大小和位置，藉此協助當地語系化。</span><span class="sxs-lookup"><span data-stu-id="425b7-112">Dynamic layout facilitates localization by automatically adjusting the size and position of UI elements when the strings they contain change length.</span></span>  
  
 <span data-ttu-id="425b7-113">Windows Forms 中的配置與裝置相關，而且較可能是靜態的。</span><span class="sxs-lookup"><span data-stu-id="425b7-113">Layout in Windows Forms is device-dependent and more likely to be static.</span></span> <span data-ttu-id="425b7-114">一般來說，Windows Forms 控制項都是以硬體圖元中指定的維度，絕對放在表單上。</span><span class="sxs-lookup"><span data-stu-id="425b7-114">Typically, Windows Forms controls are positioned absolutely on a form using dimensions specified in hardware pixels.</span></span> <span data-ttu-id="425b7-115">不過，Windows Forms 支援一些動態版面配置功能，如下表摘要所示。</span><span class="sxs-lookup"><span data-stu-id="425b7-115">However, Windows Forms does support some dynamic layout features, as summarized in the following table.</span></span>  
  
|<span data-ttu-id="425b7-116">版面配置功能</span><span class="sxs-lookup"><span data-stu-id="425b7-116">Layout feature</span></span>|<span data-ttu-id="425b7-117">描述</span><span class="sxs-lookup"><span data-stu-id="425b7-117">Description</span></span>|  
|--------------------|-----------------|  
|<span data-ttu-id="425b7-118">自動調整大小</span><span class="sxs-lookup"><span data-stu-id="425b7-118">Autosizing</span></span>|<span data-ttu-id="425b7-119">有些 Windows Forms 控制項會調整自己的大小，以適當地顯示其內容。</span><span class="sxs-lookup"><span data-stu-id="425b7-119">Some Windows Forms controls resize themselves to display their contents properly.</span></span> <span data-ttu-id="425b7-120">如需詳細資訊，請參閱[AutoSize 屬性總覽](../../winforms/controls/autosize-property-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="425b7-120">For more information, see [AutoSize Property Overview](../../winforms/controls/autosize-property-overview.md).</span></span>|  
|<span data-ttu-id="425b7-121">錨定和停駐</span><span class="sxs-lookup"><span data-stu-id="425b7-121">Anchoring and docking</span></span>|<span data-ttu-id="425b7-122">Windows Forms 控制項支援根據父容器的定位和調整大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-122">Windows Forms controls support positioning and sizing based on the parent container.</span></span> <span data-ttu-id="425b7-123">如需詳細資訊，請參閱<xref:System.Windows.Forms.Control.Anchor%2A?displayProperty=nameWithType>和<xref:System.Windows.Forms.Control.Dock%2A?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="425b7-123">For more information, see <xref:System.Windows.Forms.Control.Anchor%2A?displayProperty=nameWithType> and <xref:System.Windows.Forms.Control.Dock%2A?displayProperty=nameWithType>.</span></span>|  
|<span data-ttu-id="425b7-124">自動調整規模</span><span class="sxs-lookup"><span data-stu-id="425b7-124">Autoscaling</span></span>|<span data-ttu-id="425b7-125">容器控制項會根據輸出裝置的解析度或預設容器字型的大小（以圖元為單位），來調整自己及其子系的大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-125">Container controls resize themselves and their children based on the resolution of the output device or the size, in pixels, of the default container font.</span></span> <span data-ttu-id="425b7-126">如需詳細資訊，請參閱[Windows Forms 中的自動縮放](../../winforms/automatic-scaling-in-windows-forms.md)。</span><span class="sxs-lookup"><span data-stu-id="425b7-126">For more information, see [Automatic Scaling in Windows Forms](../../winforms/automatic-scaling-in-windows-forms.md).</span></span>|  
|<span data-ttu-id="425b7-127">版面配置容器</span><span class="sxs-lookup"><span data-stu-id="425b7-127">Layout containers</span></span>|<span data-ttu-id="425b7-128"><xref:System.Windows.Forms.FlowLayoutPanel> 和 <xref:System.Windows.Forms.TableLayoutPanel> 控制項會根據其內容，排列其子控制項和本身的大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-128">The <xref:System.Windows.Forms.FlowLayoutPanel> and <xref:System.Windows.Forms.TableLayoutPanel> controls arrange their child controls and size themselves according to their contents.</span></span>|  
  
## <a name="layout-limitations"></a><span data-ttu-id="425b7-129">版面配置限制</span><span class="sxs-lookup"><span data-stu-id="425b7-129">Layout Limitations</span></span>  
 <span data-ttu-id="425b7-130">一般來說，Windows Forms 控制項無法縮放並轉換成 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]中的可能程度。</span><span class="sxs-lookup"><span data-stu-id="425b7-130">In general, Windows Forms controls cannot be scaled and transformed to the extent possible in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span> <span data-ttu-id="425b7-131">下列清單描述當 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素嘗試將其裝載的 Windows Forms 控制項整合到 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 版面配置系統時的已知限制。</span><span class="sxs-lookup"><span data-stu-id="425b7-131">The following list describes the known limitations when the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element attempts to integrate its hosted Windows Forms control into the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout system.</span></span>  
  
- <span data-ttu-id="425b7-132">在某些情況下，Windows Forms 控制項無法調整大小，或只能調整為特定維度。</span><span class="sxs-lookup"><span data-stu-id="425b7-132">In some cases, Windows Forms controls cannot be resized, or can be sized only to specific dimensions.</span></span> <span data-ttu-id="425b7-133">例如，Windows Forms <xref:System.Windows.Forms.ComboBox> 控制項僅支援單一高度，這是由控制項的字型大小所定義。</span><span class="sxs-lookup"><span data-stu-id="425b7-133">For example, a Windows Forms <xref:System.Windows.Forms.ComboBox> control supports only a single height, which is defined by the control's font size.</span></span> <span data-ttu-id="425b7-134">在專案可以垂直延展的 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 動態配置中，主控的 <xref:System.Windows.Forms.ComboBox> 控制項不會如預期般延展。</span><span class="sxs-lookup"><span data-stu-id="425b7-134">In a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] dynamic layout where elements can stretch vertically, a hosted <xref:System.Windows.Forms.ComboBox> control will not stretch as expected.</span></span>  
  
- <span data-ttu-id="425b7-135">Windows Forms 控制項無法旋轉或扭曲。</span><span class="sxs-lookup"><span data-stu-id="425b7-135">Windows Forms controls cannot be rotated or skewed.</span></span> <span data-ttu-id="425b7-136">如果您套用扭曲或旋轉轉換，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會引發 <xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError> 事件。</span><span class="sxs-lookup"><span data-stu-id="425b7-136">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element raises the <xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError> event if you apply a skew or rotation transformation.</span></span> <span data-ttu-id="425b7-137">如果您未處理 <xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError> 事件，則會引發 <xref:System.InvalidOperationException>。</span><span class="sxs-lookup"><span data-stu-id="425b7-137">If you do not handle the <xref:System.Windows.Forms.Integration.WindowsFormsHost.LayoutError> event, an <xref:System.InvalidOperationException> is raised.</span></span>  
  
- <span data-ttu-id="425b7-138">在大多數情況下，Windows Forms 控制項不支援比例調整。</span><span class="sxs-lookup"><span data-stu-id="425b7-138">In most cases, Windows Forms controls do not support proportional scaling.</span></span> <span data-ttu-id="425b7-139">雖然會縮放控制項的整體維度，但是可能無法如預期調整控制項的子控制項和元件大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-139">Although the overall dimensions of the control will scale, child controls and component elements of the control may not resize as expected.</span></span> <span data-ttu-id="425b7-140">這項限制取決於每個 Windows Forms 控制項支援調整的程度。</span><span class="sxs-lookup"><span data-stu-id="425b7-140">This limitation depends on how well each Windows Forms control supports scaling.</span></span> <span data-ttu-id="425b7-141">此外，您無法將 Windows Forms 控制項相應縮小為0圖元的大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-141">In addition, you cannot scale Windows Forms controls down to a size of 0 pixels.</span></span>  
  
- <span data-ttu-id="425b7-142">Windows Forms 控制項支援自動調整，表單將會根據字型大小自動調整其本身及其控制項的大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-142">Windows Forms controls support autoscaling, in which the form will automatically resize itself and its controls based on the font size.</span></span> <span data-ttu-id="425b7-143">在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 使用者介面中，變更字型大小並不會調整整個版面配置大小，雖然可能會動態調整個別項目。</span><span class="sxs-lookup"><span data-stu-id="425b7-143">In a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] user interface, changing the font size does not resize the entire layout, although individual elements may dynamically resize.</span></span>  
  
### <a name="z-order"></a><span data-ttu-id="425b7-144">迭置順序</span><span class="sxs-lookup"><span data-stu-id="425b7-144">Z-order</span></span>  
 <span data-ttu-id="425b7-145">在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 使用者介面中，您可以變更項目的 Z 順序以控制重疊行為。</span><span class="sxs-lookup"><span data-stu-id="425b7-145">In a [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] user interface, you can change the z-order of elements to control overlapping behavior.</span></span> <span data-ttu-id="425b7-146">主控的 Windows Forms 控制項會在個別的 HWND 中繪製，因此一律會在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 元素的頂端繪製。</span><span class="sxs-lookup"><span data-stu-id="425b7-146">A hosted Windows Forms control is drawn in a separate HWND, so it is always drawn on top of [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements.</span></span>  
  
 <span data-ttu-id="425b7-147">主控的 Windows Forms 控制項也會在任何 <xref:System.Windows.Documents.Adorner> 元素的上方繪製。</span><span class="sxs-lookup"><span data-stu-id="425b7-147">A hosted Windows Forms control is also drawn on top of any <xref:System.Windows.Documents.Adorner> elements.</span></span>  
  
## <a name="layout-behavior"></a><span data-ttu-id="425b7-148">版面配置行為</span><span class="sxs-lookup"><span data-stu-id="425b7-148">Layout Behavior</span></span>  
 <span data-ttu-id="425b7-149">下列各節說明在 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]中裝載 Windows Forms 控制項時的版面配置行為的特定層面。</span><span class="sxs-lookup"><span data-stu-id="425b7-149">The following sections describe specific aspects of layout behavior when hosting Windows Forms controls in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
### <a name="scaling-unit-conversion-and-device-independence"></a><span data-ttu-id="425b7-150">縮放、單位轉換和裝置獨立性</span><span class="sxs-lookup"><span data-stu-id="425b7-150">Scaling, Unit Conversion, and Device Independence</span></span>  
 <span data-ttu-id="425b7-151">每當 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素執行涉及 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 和 Windows Forms 維度的作業時，就會牽涉到兩個座標系統： Windows Forms 的 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 和硬體圖元的裝置獨立圖元。</span><span class="sxs-lookup"><span data-stu-id="425b7-151">Whenever the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element performs operations involving [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and Windows Forms dimensions, two coordinate systems are involved: device-independent pixels for [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] and hardware pixels for Windows Forms.</span></span> <span data-ttu-id="425b7-152">因此，您必須套用適當的單位和縮放轉換，以達成一致的版面配置。</span><span class="sxs-lookup"><span data-stu-id="425b7-152">Therefore, you must apply proper unit and scaling conversions to achieve a consistent layout.</span></span>  
  
 <span data-ttu-id="425b7-153">座標系統之間的轉換取決於目前的裝置解析，以及套用至 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 專案或其祖系的任何版面配置或轉譯轉換。</span><span class="sxs-lookup"><span data-stu-id="425b7-153">Conversion between the coordinate systems depends on the current device resolution and any layout or rendering transforms applied to the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element or to its ancestors.</span></span>  
  
 <span data-ttu-id="425b7-154">如果輸出裝置為 96 DPI，而且未將縮放比例套用至 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素，則一個裝置獨立圖元等於一個硬體圖元。</span><span class="sxs-lookup"><span data-stu-id="425b7-154">If the output device is 96 dpi and no scaling has been applied to the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element, one device-independent pixel is equal to one hardware pixel.</span></span>  
  
 <span data-ttu-id="425b7-155">所有其他情況都需要座標系統調整。</span><span class="sxs-lookup"><span data-stu-id="425b7-155">All other cases require coordinate system scaling.</span></span> <span data-ttu-id="425b7-156">裝載的控制項不會調整大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-156">The hosted control is not resized.</span></span> <span data-ttu-id="425b7-157">相反地，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會嘗試調整裝載的控制項及其所有子控制項。</span><span class="sxs-lookup"><span data-stu-id="425b7-157">Instead, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element attempts to scale the hosted control and all of its child controls.</span></span> <span data-ttu-id="425b7-158">因為 Windows Forms 不完全支援縮放，所以 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會調整為特定控制項所支援的程度。</span><span class="sxs-lookup"><span data-stu-id="425b7-158">Because Windows Forms does not fully support scaling, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element scales to the degree supported by particular controls.</span></span>  
  
 <span data-ttu-id="425b7-159">覆寫 <xref:System.Windows.Forms.Integration.WindowsFormsHost.ScaleChild%2A> 方法，為裝載的 Windows Forms 控制項提供自訂調整行為。</span><span class="sxs-lookup"><span data-stu-id="425b7-159">Override the <xref:System.Windows.Forms.Integration.WindowsFormsHost.ScaleChild%2A> method to provide custom scaling behavior for the hosted Windows Forms control.</span></span>  
  
 <span data-ttu-id="425b7-160">除了調整之外，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 專案也會處理進位和溢位案例，如下表所述。</span><span class="sxs-lookup"><span data-stu-id="425b7-160">In addition to scaling, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element handles rounding and overflow cases as described in the following table.</span></span>  
  
|<span data-ttu-id="425b7-161">轉換問題</span><span class="sxs-lookup"><span data-stu-id="425b7-161">Conversion issue</span></span>|<span data-ttu-id="425b7-162">描述</span><span class="sxs-lookup"><span data-stu-id="425b7-162">Description</span></span>|  
|----------------------|-----------------|  
|<span data-ttu-id="425b7-163">捨入</span><span class="sxs-lookup"><span data-stu-id="425b7-163">Rounding</span></span>|[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="425b7-164">裝置獨立圖元維度會指定為 `double`，Windows Forms 硬體圖元維度則指定為 `int`。</span><span class="sxs-lookup"><span data-stu-id="425b7-164">device-independent pixel dimensions are specified as `double`, and Windows Forms hardware pixel dimensions are specified as `int`.</span></span> <span data-ttu-id="425b7-165">在以 `double`為基礎的維度轉換成 `int`型維度的情況下，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會使用標準舍入，因此小於0.5 的小數值會四捨五入為0。</span><span class="sxs-lookup"><span data-stu-id="425b7-165">In cases where `double`-based dimensions are converted to `int`-based dimensions, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element uses standard rounding, so that fractional values less than 0.5 are rounded down to 0.</span></span>|  
|<span data-ttu-id="425b7-166">溢位</span><span class="sxs-lookup"><span data-stu-id="425b7-166">Overflow</span></span>|<span data-ttu-id="425b7-167">當 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素從 `double` 值轉換成 `int` 值時，可能會發生溢位。</span><span class="sxs-lookup"><span data-stu-id="425b7-167">When the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element converts from `double` values to `int` values, overflow is possible.</span></span> <span data-ttu-id="425b7-168">大於 <xref:System.Int32.MaxValue> 的值會設定為 <xref:System.Int32.MaxValue>。</span><span class="sxs-lookup"><span data-stu-id="425b7-168">Values that are larger than <xref:System.Int32.MaxValue> are set to <xref:System.Int32.MaxValue>.</span></span>|  
  
### <a name="layout-related-properties"></a><span data-ttu-id="425b7-169">版面配置相關屬性</span><span class="sxs-lookup"><span data-stu-id="425b7-169">Layout-related Properties</span></span>  
 <span data-ttu-id="425b7-170">控制 Windows Forms 控制項和 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 專案之配置行為的屬性會由 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素適當地對應。</span><span class="sxs-lookup"><span data-stu-id="425b7-170">Properties that control layout behavior in Windows Forms controls and [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] elements are mapped appropriately by the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element.</span></span> <span data-ttu-id="425b7-171">如需詳細資訊，請參閱 [Windows Form 和 WPF 屬性對應](windows-forms-and-wpf-property-mapping.md)。</span><span class="sxs-lookup"><span data-stu-id="425b7-171">For more information, see [Windows Forms and WPF Property Mapping](windows-forms-and-wpf-property-mapping.md).</span></span>  
  
### <a name="layout-changes-in-the-hosted-control"></a><span data-ttu-id="425b7-172">裝載控制項中的版面配置變更</span><span class="sxs-lookup"><span data-stu-id="425b7-172">Layout Changes in the Hosted Control</span></span>  
 <span data-ttu-id="425b7-173">主控的 Windows Forms 控制項中的配置變更會傳播至 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 以觸發版面配置更新。</span><span class="sxs-lookup"><span data-stu-id="425b7-173">Layout changes in the hosted Windows Forms control are propagated to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] to trigger layout updates.</span></span> <span data-ttu-id="425b7-174"><xref:System.Windows.Forms.Integration.WindowsFormsHost> 上的 <xref:System.Windows.UIElement.InvalidateMeasure%2A> 方法可確保主控控制項中的版面配置變更會導致 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 配置引擎執行。</span><span class="sxs-lookup"><span data-stu-id="425b7-174">The <xref:System.Windows.UIElement.InvalidateMeasure%2A> method on <xref:System.Windows.Forms.Integration.WindowsFormsHost> ensures that layout changes in the hosted control cause the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout engine to run.</span></span>  
  
### <a name="continuously-sized-windows-forms-controls"></a><span data-ttu-id="425b7-175">持續調整 Windows Forms 控制項的大小</span><span class="sxs-lookup"><span data-stu-id="425b7-175">Continuously Sized Windows Forms Controls</span></span>  
 <span data-ttu-id="425b7-176">支援連續調整的 Windows Forms 控制項，與 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 版面配置系統完全互動。</span><span class="sxs-lookup"><span data-stu-id="425b7-176">Windows Forms controls that support continuous scaling fully interact with the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout system.</span></span> <span data-ttu-id="425b7-177"><xref:System.Windows.Forms.Integration.WindowsFormsHost> 專案會如往常般使用 <xref:System.Windows.FrameworkElement.MeasureOverride%2A> 和 <xref:System.Windows.FrameworkElement.ArrangeOverride%2A> 方法來調整主控 Windows Forms 控制項的大小並加以排列。</span><span class="sxs-lookup"><span data-stu-id="425b7-177">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element uses the <xref:System.Windows.FrameworkElement.MeasureOverride%2A> and <xref:System.Windows.FrameworkElement.ArrangeOverride%2A> methods as usual to size and arrange the hosted Windows Forms control.</span></span>  
  
### <a name="sizing-algorithm"></a><span data-ttu-id="425b7-178">調整大小演算法</span><span class="sxs-lookup"><span data-stu-id="425b7-178">Sizing Algorithm</span></span>  
 <span data-ttu-id="425b7-179"><xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會使用下列程式來調整裝載控制項的大小：</span><span class="sxs-lookup"><span data-stu-id="425b7-179">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element uses the following procedure to size the hosted control:</span></span>  
  
1. <span data-ttu-id="425b7-180"><xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會覆寫 <xref:System.Windows.FrameworkElement.MeasureOverride%2A> 和 <xref:System.Windows.FrameworkElement.ArrangeOverride%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="425b7-180">The <xref:System.Windows.Forms.Integration.WindowsFormsHost> element overrides the <xref:System.Windows.FrameworkElement.MeasureOverride%2A> and <xref:System.Windows.FrameworkElement.ArrangeOverride%2A> methods.</span></span>  
  
2. <span data-ttu-id="425b7-181">為了判斷裝載控制項的大小，<xref:System.Windows.FrameworkElement.MeasureOverride%2A> 方法會呼叫裝載控制項的 <xref:System.Windows.Forms.Control.GetPreferredSize%2A> 方法，並將條件約束從傳遞給 <xref:System.Windows.FrameworkElement.MeasureOverride%2A> 方法的條件約束轉譯。</span><span class="sxs-lookup"><span data-stu-id="425b7-181">To determine the size of the hosted control, the <xref:System.Windows.FrameworkElement.MeasureOverride%2A> method calls the hosted control's <xref:System.Windows.Forms.Control.GetPreferredSize%2A> method with a constraint translated from the constraint passed to the <xref:System.Windows.FrameworkElement.MeasureOverride%2A> method.</span></span>  
  
3. <span data-ttu-id="425b7-182"><xref:System.Windows.FrameworkElement.ArrangeOverride%2A> 方法會嘗試將主控的控制項設定為指定的大小條件約束。</span><span class="sxs-lookup"><span data-stu-id="425b7-182">The <xref:System.Windows.FrameworkElement.ArrangeOverride%2A> method attempts to set the hosted control to the given size constraint.</span></span>  
  
4. <span data-ttu-id="425b7-183">如果裝載控制項的 <xref:System.Windows.Forms.Control.Size%2A> 屬性符合指定的條件約束，則裝載控制項的大小會調整為條件約束。</span><span class="sxs-lookup"><span data-stu-id="425b7-183">If the hosted control's <xref:System.Windows.Forms.Control.Size%2A> property matches the specified constraint, the hosted control is sized to the constraint.</span></span>  
  
 <span data-ttu-id="425b7-184">如果 <xref:System.Windows.Forms.Control.Size%2A> 屬性不符合指定的條件約束，裝載的控制項就不支援連續調整大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-184">If the <xref:System.Windows.Forms.Control.Size%2A> property does not match the specified constraint, the hosted control does not support continuous sizing.</span></span> <span data-ttu-id="425b7-185">例如，<xref:System.Windows.Forms.MonthCalendar> 控制項只允許離散大小。</span><span class="sxs-lookup"><span data-stu-id="425b7-185">For example, the <xref:System.Windows.Forms.MonthCalendar> control allows only discrete sizes.</span></span> <span data-ttu-id="425b7-186">此控制項允許的大小是由整數（代表月數）的高度和寬度所組成。</span><span class="sxs-lookup"><span data-stu-id="425b7-186">The permitted sizes for this control consist of integers (representing the number of months) for both height and width.</span></span> <span data-ttu-id="425b7-187">在這種情況下，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素的行為如下所示：</span><span class="sxs-lookup"><span data-stu-id="425b7-187">In cases such as this, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element behaves as follows:</span></span>  
  
- <span data-ttu-id="425b7-188">如果 <xref:System.Windows.Forms.Control.Size%2A> 屬性傳回的大小大於指定的條件約束，則 <xref:System.Windows.Forms.Integration.WindowsFormsHost> 元素會裁剪裝載的控制項。</span><span class="sxs-lookup"><span data-stu-id="425b7-188">If the <xref:System.Windows.Forms.Control.Size%2A> property returns a larger size than the specified constraint, the <xref:System.Windows.Forms.Integration.WindowsFormsHost> element clips the hosted control.</span></span> <span data-ttu-id="425b7-189">高度和寬度會分別處理，因此裝載的控制項可能會以任一方向裁剪。</span><span class="sxs-lookup"><span data-stu-id="425b7-189">Height and width are handled separately, so the hosted control may be clipped in either direction.</span></span>  
  
- <span data-ttu-id="425b7-190">如果 <xref:System.Windows.Forms.Control.Size%2A> 屬性傳回的大小小於指定的條件約束，<xref:System.Windows.Forms.Integration.WindowsFormsHost> 會接受此大小值，並將值傳回至 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 配置系統。</span><span class="sxs-lookup"><span data-stu-id="425b7-190">If the <xref:System.Windows.Forms.Control.Size%2A> property returns a smaller size than the specified constraint, <xref:System.Windows.Forms.Integration.WindowsFormsHost> accepts this size value and returns the value to the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] layout system.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="425b7-191">請參閱</span><span class="sxs-lookup"><span data-stu-id="425b7-191">See also</span></span>

- <xref:System.Windows.Forms.Integration.ElementHost>
- <xref:System.Windows.Forms.Integration.WindowsFormsHost>
- [<span data-ttu-id="425b7-192">逐步解說：在 WPF 中排列 Windows Forms 控制項</span><span class="sxs-lookup"><span data-stu-id="425b7-192">Walkthrough: Arranging Windows Forms Controls in WPF</span></span>](walkthrough-arranging-windows-forms-controls-in-wpf.md)
- [<span data-ttu-id="425b7-193">在 WPF 範例中排列 Windows Forms 控制項</span><span class="sxs-lookup"><span data-stu-id="425b7-193">Arranging Windows Forms Controls in WPF Sample</span></span>](https://go.microsoft.com/fwlink/?LinkID=159971)
- [<span data-ttu-id="425b7-194">Windows Forms 和 WPF 屬性對應</span><span class="sxs-lookup"><span data-stu-id="425b7-194">Windows Forms and WPF Property Mapping</span></span>](windows-forms-and-wpf-property-mapping.md)
- [<span data-ttu-id="425b7-195">移轉和互通性</span><span class="sxs-lookup"><span data-stu-id="425b7-195">Migration and Interoperability</span></span>](migration-and-interoperability.md)
