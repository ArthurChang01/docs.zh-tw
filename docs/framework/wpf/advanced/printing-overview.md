---
title: 列印概觀
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: d578b9834ca39a33e284d3066eef85890c224a2f
ms.sourcegitcommit: 22be09204266253d45ece46f51cc6f080f2b3fd6
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/07/2019
ms.locfileid: "73740806"
---
# <a name="printing-overview"></a><span data-ttu-id="cd178-102">列印概觀</span><span class="sxs-lookup"><span data-stu-id="cd178-102">Printing Overview</span></span>
<span data-ttu-id="cd178-103">透過 Microsoft .NET Framework，使用 Windows Presentation Foundation （WPF）的應用程式開發人員有一組豐富的列印和列印系統管理 Api。</span><span class="sxs-lookup"><span data-stu-id="cd178-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="cd178-104">藉由 [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)]，某些列印系統增強功能也可供建立 [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] 應用程式的開發人員和使用 Unmanaged 程式碼的開發人員使用。</span><span class="sxs-lookup"><span data-stu-id="cd178-104">With [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)], some of these print system enhancements are also available to developers creating [!INCLUDE[TLA#tla_winforms](../../../../includes/tlasharptla-winforms-md.md)] applications and developers using unmanaged code.</span></span> <span data-ttu-id="cd178-105">這項新功能的核心是新的 XML 論文規格（XPS）檔案格式和 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="cd178-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="cd178-106">此主題包括下列章節。</span><span class="sxs-lookup"><span data-stu-id="cd178-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>   
## <a name="about-xps"></a><span data-ttu-id="cd178-107">關於 XPS</span><span class="sxs-lookup"><span data-stu-id="cd178-107">About XPS</span></span>  
 <span data-ttu-id="cd178-108">XPS 是一種電子檔案格式，也就是多工緩衝處理檔案格式和分頁描述語言。</span><span class="sxs-lookup"><span data-stu-id="cd178-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="cd178-109">這是一種開放檔案格式，其使用 XML、開放式封裝慣例（OPC）以及其他業界標準來建立跨平臺檔。</span><span class="sxs-lookup"><span data-stu-id="cd178-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="cd178-110">XPS 簡化了建立、共用、列印、查看和封存數位檔的程式。</span><span class="sxs-lookup"><span data-stu-id="cd178-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="cd178-111">如需有關 XPS 的其他資訊，請參閱[Xps 檔](/windows/desktop/printdocs/documents)。</span><span class="sxs-lookup"><span data-stu-id="cd178-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="cd178-112">以程式設計[方式列印 xps](how-to-programmatically-print-xps-files.md)檔案中，有數種使用 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 列印 xps 內容的技巧。</span><span class="sxs-lookup"><span data-stu-id="cd178-112">Several techniques for printing XPS-based content using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="cd178-113">在檢閱本主題所包含內容期間，您會發現參考這些範例相當有用。</span><span class="sxs-lookup"><span data-stu-id="cd178-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="cd178-114">（非受控程式碼開發人員應該會看到[MXDC_ESCAPE 功能](/windows/desktop/printdocs/mxdc-escape)的檔。</span><span class="sxs-lookup"><span data-stu-id="cd178-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="cd178-115">Windows Forms 開發人員必須在不支援完整 XPS 列印路徑的 <xref:System.Drawing.Printing> 命名空間中使用 API，但支援混合式 GDI 到 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="cd178-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="cd178-116">請參閱下方的**列印路徑架構**)。</span><span class="sxs-lookup"><span data-stu-id="cd178-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>   
## <a name="xps-print-path"></a><span data-ttu-id="cd178-117">XPS 列印路徑</span><span class="sxs-lookup"><span data-stu-id="cd178-117">XPS Print Path</span></span>  
 <span data-ttu-id="cd178-118">XML 檔規格（XPS）列印路徑是新的 Windows 功能，可重新定義在 Windows 應用程式中處理列印的方式。</span><span class="sxs-lookup"><span data-stu-id="cd178-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="cd178-119">因為 XPS 可以取代檔呈現語言（例如 RTF）、列印多工緩衝處理器格式（例如 WMF），以及分頁描述語言（例如 PCL 或 Postscript）;新的列印路徑會維護從應用程式發行到列印驅動程式或裝置最後處理的 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="cd178-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="cd178-120">XPS 列印路徑是以 XPS 印表機驅動程式模型（XPSDrv）為基礎，可為開發人員提供數個優點，例如「您看到的是什麼」（WYSIWYG）列印、改良的色彩支援，以及大幅改進的列印效能。</span><span class="sxs-lookup"><span data-stu-id="cd178-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="cd178-121">（如需 XPSDrv 的詳細資訊，請參閱[Windows 驅動程式套件檔](/windows-hardware/drivers/)。）</span><span class="sxs-lookup"><span data-stu-id="cd178-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="cd178-122">XPS 檔列印多工緩衝處理器的操作，基本上與舊版 Windows 相同。</span><span class="sxs-lookup"><span data-stu-id="cd178-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="cd178-123">不過，它已經過增強，可支援現有的 GDI 列印路徑以外的 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="cd178-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="cd178-124">新的列印路徑原本就會使用 XPS 多工緩衝處理檔案。</span><span class="sxs-lookup"><span data-stu-id="cd178-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="cd178-125">雖然為舊版 Windows 撰寫的使用者模式印表機驅動程式仍可繼續使用，但還是需要 XPS 印表機驅動程式（XPSDrv）才能使用 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="cd178-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="cd178-126">XPS 列印路徑的優點很重要，其中包括：</span><span class="sxs-lookup"><span data-stu-id="cd178-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="cd178-127">WYSIWYG 列印支援</span><span class="sxs-lookup"><span data-stu-id="cd178-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="cd178-128">進階色彩設定檔的原生支援，其中包含每個通道 32 位元 (bpc)、CMYK、具名色彩、n-inks 和透明及漸層效果的原生支援。</span><span class="sxs-lookup"><span data-stu-id="cd178-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="cd178-129">改善 .NET Framework 和 [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] 應用程式的列印效能。</span><span class="sxs-lookup"><span data-stu-id="cd178-129">Improved print performance for both .NET Framework and [!INCLUDE[TLA#tla_win32](../../../../includes/tlasharptla-win32-md.md)] based applications.</span></span>  
  
- <span data-ttu-id="cd178-130">業界標準 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="cd178-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="cd178-131">在基本的列印案例中，有一個簡單且直覺的 API 可供使用者介面、設定和作業提交的單一進入點使用。</span><span class="sxs-lookup"><span data-stu-id="cd178-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="cd178-132">進階案例中，對於 [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] 自訂 (或根本沒有 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)])、同步或非同步列印及批次列印功能，加入額外支援。</span><span class="sxs-lookup"><span data-stu-id="cd178-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="cd178-133">這兩個選項都提供完整或部分信任模式中的列印支援。</span><span class="sxs-lookup"><span data-stu-id="cd178-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="cd178-134">XPS 是以擴充性為考慮而設計的。</span><span class="sxs-lookup"><span data-stu-id="cd178-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="cd178-135">藉由使用擴充性架構，可以透過模組化方式將特性和功能新增至 XPS。</span><span class="sxs-lookup"><span data-stu-id="cd178-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="cd178-136">擴充性功能包括：</span><span class="sxs-lookup"><span data-stu-id="cd178-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="cd178-137">列印結構描述。</span><span class="sxs-lookup"><span data-stu-id="cd178-137">Print Schema.</span></span> <span data-ttu-id="cd178-138">會定期更新公用結構描述，並讓裝置功能可快速擴充。</span><span class="sxs-lookup"><span data-stu-id="cd178-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="cd178-139">(請參閱下方的 **PrintTicket 和 PrintCapabilities**)。</span><span class="sxs-lookup"><span data-stu-id="cd178-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="cd178-140">可擴充的篩選管線。</span><span class="sxs-lookup"><span data-stu-id="cd178-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="cd178-141">XPS 印表機驅動程式（XPSDrv）篩選器管線的設計，是為了啟用 XPS 檔的直接與可調整列印。</span><span class="sxs-lookup"><span data-stu-id="cd178-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="cd178-142">如需詳細資訊，請參閱[XPSDrv 印表機驅動程式](/windows-hardware/drivers/print/xpsdrv-printer-drivers)。</span><span class="sxs-lookup"><span data-stu-id="cd178-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span> 
  
### <a name="print-path-architecture"></a><span data-ttu-id="cd178-143">列印路徑架構</span><span class="sxs-lookup"><span data-stu-id="cd178-143">Print Path Architecture</span></span>  
 <span data-ttu-id="cd178-144">雖然 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 和 .NET Framework 應用程式都支援 XPS，[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 和 Windows Forms 應用程式會使用 GDI 進行 XPS 轉換，以便為 XPS 印表機驅動程式（XPSDrv）建立 XPS 格式的內容。</span><span class="sxs-lookup"><span data-stu-id="cd178-144">While both [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and .NET Framework applications support XPS, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="cd178-145">這些應用程式不需要使用 XPS 列印路徑，而且可以繼續使用增強型中繼檔（EMF）為基礎的列印。</span><span class="sxs-lookup"><span data-stu-id="cd178-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="cd178-146">不過，大部分的 XPS 功能和增強僅適用于以 XPS 列印路徑為目標的應用程式。</span><span class="sxs-lookup"><span data-stu-id="cd178-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="cd178-147">XPS 印表機驅動程式（XPSDrv）支援將 GDI 轉換成 XPS 格式，以啟用使用 XPSDrv 印表機的 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 和 Windows Forms 應用程式。</span><span class="sxs-lookup"><span data-stu-id="cd178-147">To enable the use of XPSDrv-based printers by [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="cd178-148">XPSDrv 模型也提供 XPS 到 GDI 格式的轉換器，讓 [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 應用程式可以列印 XPS 檔。</span><span class="sxs-lookup"><span data-stu-id="cd178-148">The XPSDrv model also provides a converter for XPS to GDI format so that [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] applications can print XPS Documents.</span></span> <span data-ttu-id="cd178-149">針對 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 應用程式，每當寫入作業的目標列印佇列沒有 XPSDrv 驅動程式時，<xref:System.Windows.Xps.XpsDocumentWriter> 類別的 <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> 和 <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> 方法會自動完成 XPS 到 GDI 格式的轉換。</span><span class="sxs-lookup"><span data-stu-id="cd178-149">For [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="cd178-150">（Windows Forms 應用程式無法列印 XPS 檔。）</span><span class="sxs-lookup"><span data-stu-id="cd178-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="cd178-151">下圖說明列印子系統，並定義 Microsoft 所提供的部分，以及軟體和硬體廠商所定義的部分：</span><span class="sxs-lookup"><span data-stu-id="cd178-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![螢幕擷取畫面：顯示 XPS 列印系統。](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="cd178-153">基本 XPS 列印</span><span class="sxs-lookup"><span data-stu-id="cd178-153">Basic XPS Printing</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="cd178-154">會同時定義基本和 advanced API。</span><span class="sxs-lookup"><span data-stu-id="cd178-154">defines both a basic and advanced API.</span></span> <span data-ttu-id="cd178-155">對於不需要大量列印自訂或存取完整 XPS 功能集的應用程式，可以使用基本列印支援。</span><span class="sxs-lookup"><span data-stu-id="cd178-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="cd178-156">基本列印支援由需要最少組態的列印對話方塊控制項公開，並具有類似 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 的功能。</span><span class="sxs-lookup"><span data-stu-id="cd178-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="cd178-157">許多 XPS 功能都可以使用這個簡化的列印模型來取得。</span><span class="sxs-lookup"><span data-stu-id="cd178-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="cd178-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="cd178-158">PrintDialog</span></span>  
 <span data-ttu-id="cd178-159"><xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> 控制項提供 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]、設定和 XPS 工作提交的單一進入點。</span><span class="sxs-lookup"><span data-stu-id="cd178-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="cd178-160">如需如何具現化及使用控制項的相關資訊，請參閱[叫用列印對話方塊](how-to-invoke-a-print-dialog.md)。</span><span class="sxs-lookup"><span data-stu-id="cd178-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="cd178-161">進階的 XPS 列印</span><span class="sxs-lookup"><span data-stu-id="cd178-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="cd178-162">若要存取一組完整的 XPS 功能，必須使用 advanced print API。</span><span class="sxs-lookup"><span data-stu-id="cd178-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="cd178-163">下面會更詳細說明數個相關的 API。</span><span class="sxs-lookup"><span data-stu-id="cd178-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="cd178-164">如需 XPS 列印路徑 Api 的完整清單，請參閱 <xref:System.Windows.Xps> 和 <xref:System.Printing> 命名空間參考。</span><span class="sxs-lookup"><span data-stu-id="cd178-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="cd178-165">PrintTicket 和 PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="cd178-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="cd178-166"><xref:System.Printing.PrintTicket> 和 <xref:System.Printing.PrintCapabilities> 類別是 advanced XPS 功能的基礎。</span><span class="sxs-lookup"><span data-stu-id="cd178-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="cd178-167">這兩種類型的物件都是列印導向功能的 XML 格式結構，例如定序、雙面列印、裝訂等等。這些結構是由列印架構所定義。</span><span class="sxs-lookup"><span data-stu-id="cd178-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="cd178-168"><xref:System.Printing.PrintTicket> 會指示印表機該如何處理列印工作。</span><span class="sxs-lookup"><span data-stu-id="cd178-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="cd178-169"><xref:System.Printing.PrintCapabilities> 類別會定義印表機的功能。</span><span class="sxs-lookup"><span data-stu-id="cd178-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="cd178-170">藉由查詢印表機的功能，可以建立 <xref:System.Printing.PrintTicket> 來完整利用印表機支援的功能。</span><span class="sxs-lookup"><span data-stu-id="cd178-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="cd178-171">同樣地，您也可避免不支援的功能。</span><span class="sxs-lookup"><span data-stu-id="cd178-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="cd178-172">下列範例示範如何查詢印表機的 <xref:System.Printing.PrintCapabilities>，並使用程式碼建立 <xref:System.Printing.PrintTicket>。</span><span class="sxs-lookup"><span data-stu-id="cd178-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="cd178-173">PrintServer 和 PrintQueue</span><span class="sxs-lookup"><span data-stu-id="cd178-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="cd178-174"><xref:System.Printing.PrintServer> 類別代表網路列印伺服器，且 <xref:System.Printing.PrintQueue> 類別代表印表機以及相關聯的輸出工作佇列。</span><span class="sxs-lookup"><span data-stu-id="cd178-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="cd178-175">這些 Api 一起使用，可讓您進行伺服器列印工作的先進管理。</span><span class="sxs-lookup"><span data-stu-id="cd178-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="cd178-176"><xref:System.Printing.PrintServer> 或其中一個衍生的類別，會用來管理 <xref:System.Printing.PrintQueue>。</span><span class="sxs-lookup"><span data-stu-id="cd178-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="cd178-177"><xref:System.Printing.PrintQueue.AddJob%2A> 方法會用來將新的列印工作插入佇列。</span><span class="sxs-lookup"><span data-stu-id="cd178-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="cd178-178">下列範例示範如何建立 <xref:System.Printing.LocalPrintServer> 及使用程式碼存取其預設的 <xref:System.Printing.PrintQueue>。</span><span class="sxs-lookup"><span data-stu-id="cd178-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="cd178-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="cd178-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="cd178-180"><xref:System.Windows.Xps.XpsDocumentWriter>，其具有許多 <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> 和 <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> 方法，可用來將 XPS 檔寫入 <xref:System.Printing.PrintQueue>。</span><span class="sxs-lookup"><span data-stu-id="cd178-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="cd178-181">例如，<xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> 方法是用來輸出 XPS 檔並同步 <xref:System.Printing.PrintTicket>。</span><span class="sxs-lookup"><span data-stu-id="cd178-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="cd178-182"><xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> 方法是用來輸出 XPS 檔，並以非同步方式 <xref:System.Printing.PrintTicket>。</span><span class="sxs-lookup"><span data-stu-id="cd178-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="cd178-183">下列範例示範如何使用程式碼建立 <xref:System.Windows.Xps.XpsDocumentWriter>。</span><span class="sxs-lookup"><span data-stu-id="cd178-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="cd178-184"><xref:System.Printing.PrintQueue.AddJob%2A> 方法也會提供列印的方式。</span><span class="sxs-lookup"><span data-stu-id="cd178-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="cd178-185">請參閱[以程式設計方式列印 XPS 檔](how-to-programmatically-print-xps-files.md)。</span><span class="sxs-lookup"><span data-stu-id="cd178-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="cd178-186">。</span><span class="sxs-lookup"><span data-stu-id="cd178-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>   
## <a name="gdi-print-path"></a><span data-ttu-id="cd178-187">GDI 列印路徑</span><span class="sxs-lookup"><span data-stu-id="cd178-187">GDI Print Path</span></span>  
 <span data-ttu-id="cd178-188">雖然 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 應用程式原本就支援 XPS 列印路徑，[!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] 和 Windows Forms 應用程式也可以利用某些 XPS 功能。</span><span class="sxs-lookup"><span data-stu-id="cd178-188">While [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications natively support the XPS print path, [!INCLUDE[TLA2#tla_win32](../../../../includes/tla2sharptla-win32-md.md)] and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="cd178-189">XPS 印表機驅動程式（XPSDrv）可以將 GDI 型輸出轉換成 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="cd178-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="cd178-190">針對先進的案例，使用[MICROSOFT XPS 檔轉換子（MXDC）](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)可支援內容的自訂轉換。</span><span class="sxs-lookup"><span data-stu-id="cd178-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="cd178-191">同樣地，[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] 應用程式也可以藉由呼叫 <xref:System.Windows.Xps.XpsDocumentWriter> 類別的其中一個 <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> 或 <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> 方法，並將非 XpsDrv 印表機指定為目標列印佇列，輸出至 GDI 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="cd178-191">Similarly, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="cd178-192">對於不需要 XPS 功能或支援的應用程式，目前的 GDI 列印路徑會保持不變。</span><span class="sxs-lookup"><span data-stu-id="cd178-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="cd178-193">如需 GDI 列印路徑和各種 XPS 轉換選項的其他參考資料，請參閱[MICROSOFT XPS 檔轉換器（MXDC）](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)和[XPSDrv 印表機驅動程式](/windows-hardware/drivers/print/xpsdrv-printer-drivers)。</span><span class="sxs-lookup"><span data-stu-id="cd178-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>   
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="cd178-194">XPSDrv 驅動程式模型</span><span class="sxs-lookup"><span data-stu-id="cd178-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="cd178-195">XPS 列印路徑可在列印到啟用 XPS 的印表機或驅動程式時，使用 XPS 作為原生列印多工緩衝處理格式，藉此改善多工緩衝處理器的效率。</span><span class="sxs-lookup"><span data-stu-id="cd178-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="cd178-196">簡化的多工緩衝處理常式不需要產生中繼多工緩衝檔案（例如 EMF 資料檔案），就能將檔進行多工緩衝處理。</span><span class="sxs-lookup"><span data-stu-id="cd178-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="cd178-197">透過較小的多工緩衝處理檔案大小，XPS 列印路徑可以減少網路流量並改善列印效能。</span><span class="sxs-lookup"><span data-stu-id="cd178-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="cd178-198">EMF 是一種關閉的格式，代表應用程式輸出，做為轉譯服務的 GDI 的一系列呼叫。</span><span class="sxs-lookup"><span data-stu-id="cd178-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="cd178-199">與 EMF 不同的是，XPS 多工緩衝處理格式代表實際的檔，而不需要在輸出至 XPS 型印表機驅動程式（XPSDrv）時進一步轉譯。</span><span class="sxs-lookup"><span data-stu-id="cd178-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="cd178-200">驅動程式可以直接在格式中的資料上運作。</span><span class="sxs-lookup"><span data-stu-id="cd178-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="cd178-201">當您使用 EMF 檔案和以 GDI 為基礎的列印驅動程式時，這項功能可排除所需的資料和色彩空間轉換。</span><span class="sxs-lookup"><span data-stu-id="cd178-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="cd178-202">當您使用以 XPS 印表機驅動程式（XPSDrv）為目標的 XPS 檔（相較于其 EMF 對應專案）時，多工緩衝處理檔案大小通常會降低不過，有一些例外狀況：</span><span class="sxs-lookup"><span data-stu-id="cd178-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="cd178-203">非常複雜、多層或無效率寫入的向量圖形可能大於相同圖形的點陣圖版本。</span><span class="sxs-lookup"><span data-stu-id="cd178-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="cd178-204">供螢幕顯示之用，XPS 檔內嵌裝置字型，以及以電腦為基礎的字型；而 GDI 多工緩衝處理檔案則不會內嵌裝置字型。</span><span class="sxs-lookup"><span data-stu-id="cd178-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="cd178-205">但是這兩種字型為部分內嵌的字型 (如下所示)，而且印表機驅動程式可以移除裝置字型，然後再將檔案傳輸至印表機。</span><span class="sxs-lookup"><span data-stu-id="cd178-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="cd178-206">多工緩衝處理大小縮減會透過數種機制執行：</span><span class="sxs-lookup"><span data-stu-id="cd178-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="cd178-207">**字型部分內嵌**。</span><span class="sxs-lookup"><span data-stu-id="cd178-207">**Font subsetting**.</span></span> <span data-ttu-id="cd178-208">只有在實際檔中使用的字元會儲存在 XPS 檔案中。</span><span class="sxs-lookup"><span data-stu-id="cd178-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="cd178-209">**進階圖形支援**。</span><span class="sxs-lookup"><span data-stu-id="cd178-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="cd178-210">透明度和漸層基本類型的原生支援可避免 XPS 檔中的內容點陣化。</span><span class="sxs-lookup"><span data-stu-id="cd178-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="cd178-211">**識別通用資源**。</span><span class="sxs-lookup"><span data-stu-id="cd178-211">**Identification of common resources**.</span></span> <span data-ttu-id="cd178-212">多次使用的資源 (例如代表公司標誌的影像) 會被視為共用資源，並只會載入一次。</span><span class="sxs-lookup"><span data-stu-id="cd178-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="cd178-213">**ZIP 壓縮**。</span><span class="sxs-lookup"><span data-stu-id="cd178-213">**ZIP compression**.</span></span> <span data-ttu-id="cd178-214">所有 XPS 檔都使用 ZIP 壓縮。</span><span class="sxs-lookup"><span data-stu-id="cd178-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cd178-215">請參閱</span><span class="sxs-lookup"><span data-stu-id="cd178-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="cd178-216">「如何」主題</span><span class="sxs-lookup"><span data-stu-id="cd178-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="cd178-217">WPF 中的文件</span><span class="sxs-lookup"><span data-stu-id="cd178-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="cd178-218">XPS 檔</span><span class="sxs-lookup"><span data-stu-id="cd178-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="cd178-219">文件序列化與儲存</span><span class="sxs-lookup"><span data-stu-id="cd178-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="cd178-220">Microsoft XPS 檔轉換子（MXDC）</span><span class="sxs-lookup"><span data-stu-id="cd178-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
