---
title: 列印概觀
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
- cpp
helpviewer_keywords:
- print path [WPF], XPS
- printers [WPF], XPSDrv-based
- printing [WPF]
- PrintQueue class PrintServer class [WPF]
- XML Paper Specification (XPS) file format
- XPS (XML Paper Specification) file format
- XPSDrv-based printers
- GDI print path [WPF]
ms.assetid: 0de8ac41-9aa6-413d-a121-7aa6f41539b1
ms.openlocfilehash: 902d51341850b5245b9fa6410b1954b2ab373bbc
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/12/2020
ms.locfileid: "79187206"
---
# <a name="printing-overview"></a><span data-ttu-id="a109b-102">列印概觀</span><span class="sxs-lookup"><span data-stu-id="a109b-102">Printing Overview</span></span>
<span data-ttu-id="a109b-103">使用 Microsoft .NET 框架，使用 Windows 演示基礎 （WPF） 的應用程式開發人員具有一套豐富的新列印和列印系統管理 API。</span><span class="sxs-lookup"><span data-stu-id="a109b-103">With Microsoft .NET Framework, application developers using Windows Presentation Foundation (WPF) have a rich new set of printing and print system management APIs.</span></span> <span data-ttu-id="a109b-104">使用 Windows Vista，這些列印系統增強功能中的一些也可用於創建 Windows 表單應用程式的開發人員和使用非託管代碼的開發人員。</span><span class="sxs-lookup"><span data-stu-id="a109b-104">With Windows Vista, some of these print system enhancements are also available to developers creating Windows Forms applications and developers using unmanaged code.</span></span> <span data-ttu-id="a109b-105">此新功能的核心是新的 XML 文件規格 （XPS） 檔案格式和 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="a109b-105">At the core of this new functionality is the new XML Paper Specification (XPS) file format and the XPS print path.</span></span>  
  
 <span data-ttu-id="a109b-106">本主題包含下列各節。</span><span class="sxs-lookup"><span data-stu-id="a109b-106">This topic contains the following sections.</span></span>  
  
<a name="introduction_to_XPS"></a>
## <a name="about-xps"></a><span data-ttu-id="a109b-107">關於 XPS</span><span class="sxs-lookup"><span data-stu-id="a109b-107">About XPS</span></span>  
 <span data-ttu-id="a109b-108">XPS 是一種電子文檔格式、周邊同作檔案格式和分頁描述語言。</span><span class="sxs-lookup"><span data-stu-id="a109b-108">XPS is an electronic document format, a spool file format and a page description language.</span></span> <span data-ttu-id="a109b-109">它是一種開放文檔格式，使用 XML、開放打包約定 （OPC） 和其他行業標準來創建跨平臺文檔。</span><span class="sxs-lookup"><span data-stu-id="a109b-109">It is an open document format that uses XML, Open Packaging Conventions (OPC), and other industry standards to create cross-platform documents.</span></span> <span data-ttu-id="a109b-110">XPS 簡化了數位文檔的創建、共用、列印、查看和存檔過程。</span><span class="sxs-lookup"><span data-stu-id="a109b-110">XPS simplifies the process by which digital documents are created, shared, printed, viewed, and archived.</span></span> <span data-ttu-id="a109b-111">有關 XPS 的其他資訊，請參閱[XPS 文檔](/windows/desktop/printdocs/documents)。</span><span class="sxs-lookup"><span data-stu-id="a109b-111">For additional information on XPS, see [XPS Documents](/windows/desktop/printdocs/documents).</span></span>  
  
 <span data-ttu-id="a109b-112">使用 WPF 列印基於 XPS 的內容的幾種技術在[程式設計列印 XPS 檔中](how-to-programmatically-print-xps-files.md)進行了演示。</span><span class="sxs-lookup"><span data-stu-id="a109b-112">Several techniques for printing XPS-based content using WPF are demonstrated in [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="a109b-113">在檢閱本主題所包含內容期間，您會發現參考這些範例相當有用。</span><span class="sxs-lookup"><span data-stu-id="a109b-113">You may find it useful to reference these samples during review of content contained in this topic.</span></span> <span data-ttu-id="a109b-114">（非託管代碼開發人員應查看[MXDC_ESCAPE函數](/windows/desktop/printdocs/mxdc-escape)的文檔。</span><span class="sxs-lookup"><span data-stu-id="a109b-114">(Unmanaged code developers should see documentation for the [MXDC_ESCAPE function](/windows/desktop/printdocs/mxdc-escape).</span></span> <span data-ttu-id="a109b-115">Windows 表單開發人員必須在不支援完整<xref:System.Drawing.Printing>XPS 列印路徑但支援混合 GDI 到 XPS 列印路徑的命名空間中使用 API。</span><span class="sxs-lookup"><span data-stu-id="a109b-115">Windows Forms developers must use the API in the <xref:System.Drawing.Printing> namespace which does not support the full XPS print path, but does support a hybrid GDI-to-XPS print path.</span></span> <span data-ttu-id="a109b-116">請參閱下方的**列印路徑架構**)。</span><span class="sxs-lookup"><span data-stu-id="a109b-116">See **Print Path Architecture** below.)</span></span>  
  
<a name="XPS_print_path_intro"></a>
## <a name="xps-print-path"></a><span data-ttu-id="a109b-117">XPS 列印路徑</span><span class="sxs-lookup"><span data-stu-id="a109b-117">XPS Print Path</span></span>  
 <span data-ttu-id="a109b-118">XML 文件規格 （XPS） 列印路徑是一項新 Windows 功能，可重新定義在 Windows 應用程式中處理列印的方式。</span><span class="sxs-lookup"><span data-stu-id="a109b-118">The XML Paper Specification (XPS) print path is a new Windows feature that redefines how printing is handled in Windows applications.</span></span> <span data-ttu-id="a109b-119">因為 XPS 可以替換文檔演示語言（如 RTF）、列印幕後列印器格式（如 WMF）和分頁描述語言（如 PCL 或後記）;新的列印路徑在列印驅動程式或設備中維護從應用程式發佈到最終處理的 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="a109b-119">Because XPS can replace a document presentation language (such as RTF), a print spooler format (such as WMF), and a page description language (such as PCL or Postscript); the new print path maintains the XPS format from application publication to the final processing in the print driver or device.</span></span>  
  
 <span data-ttu-id="a109b-120">XPS 列印路徑基於 XPS 印表機驅動程式模型 （XPSDrv） 構建，它為開發人員提供了多種好處，例如"您所看到的就是您得到的"（WYSIWYG）列印、改進了顏色支援以及顯著提高了列印性能。</span><span class="sxs-lookup"><span data-stu-id="a109b-120">The XPS print path is built upon the XPS printer driver model (XPSDrv), which provides several benefits for developers such as "what you see is what you get" (WYSIWYG) printing, improved color support, and significantly improved print performance.</span></span> <span data-ttu-id="a109b-121">（有關 XPSDrv 的更多資訊，請參閱[Windows 驅動程式工具組文檔](/windows-hardware/drivers/)。</span><span class="sxs-lookup"><span data-stu-id="a109b-121">(For more on XPSDrv, see the [Windows Driver Kit documentation](/windows-hardware/drivers/).)</span></span>  
  
 <span data-ttu-id="a109b-122">XPS 文檔的列印幕後程式的操作與早期版本的 Windows 基本相同。</span><span class="sxs-lookup"><span data-stu-id="a109b-122">The operation of the print spooler for XPS documents is essentially the same as in previous versions of Windows.</span></span> <span data-ttu-id="a109b-123">但是，除了現有的 GDI 列印路徑之外，它還增強了 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="a109b-123">However, it has been enhanced to support the XPS print path in addition to the existing GDI print path.</span></span> <span data-ttu-id="a109b-124">新的列印路徑本機使用 XPS 周邊同作檔。</span><span class="sxs-lookup"><span data-stu-id="a109b-124">The new print path natively consumes an XPS spool file.</span></span> <span data-ttu-id="a109b-125">雖然為早期版本的 Windows 編寫的使用者模式印表機驅動程式將繼續工作，但 XPS 印表機驅動程式 （XPSDrv） 需要一個才能使用 XPS 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="a109b-125">While user-mode printer drivers written for previous versions of Windows will continue to work, an XPS printer driver (XPSDrv) is required in order to use the XPS print path.</span></span>  
  
 <span data-ttu-id="a109b-126">XPS 列印路徑的優勢非常重要，包括：</span><span class="sxs-lookup"><span data-stu-id="a109b-126">The benefits of the XPS print path are significant, and include:</span></span>  
  
- <span data-ttu-id="a109b-127">威西威格列印支援</span><span class="sxs-lookup"><span data-stu-id="a109b-127">WYSIWYG print support</span></span>  
  
- <span data-ttu-id="a109b-128">進階色彩設定檔的原生支援，其中包含每個通道 32 位元 (bpc)、CMYK、具名色彩、n-inks 和透明及漸層效果的原生支援。</span><span class="sxs-lookup"><span data-stu-id="a109b-128">Native support of advanced color profiles, which include 32 bits per channel (bpc), CMYK, named-colors, n-inks, and native support of transparency and gradients.</span></span>  
  
- <span data-ttu-id="a109b-129">提高了 .NET 框架和基於 Win32 的應用程式的列印性能。</span><span class="sxs-lookup"><span data-stu-id="a109b-129">Improved print performance for both .NET Framework and Win32 based applications.</span></span>  
  
- <span data-ttu-id="a109b-130">行業標準 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="a109b-130">Industry standard XPS format.</span></span>  
  
 <span data-ttu-id="a109b-131">對於基本列印方案，提供簡單直觀的 API，並帶有一個進入點，用於使用者介面、配置和作業提交。</span><span class="sxs-lookup"><span data-stu-id="a109b-131">For basic print scenarios, a simple and intuitive API is available with a single entry point for user interface, configuration and job submission.</span></span> <span data-ttu-id="a109b-132">進階案例中，對於 [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] 自訂 (或根本沒有 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)])、同步或非同步列印及批次列印功能，加入額外支援。</span><span class="sxs-lookup"><span data-stu-id="a109b-132">For advanced scenarios, an additional support is added for [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] customization (or no [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] at all), synchronous or asynchronous printing, and batch printing capabilities.</span></span> <span data-ttu-id="a109b-133">這兩個選項都提供完整或部分信任模式中的列印支援。</span><span class="sxs-lookup"><span data-stu-id="a109b-133">Both options provide print support in full or partial trust mode.</span></span>  
  
 <span data-ttu-id="a109b-134">XPS 的設計考慮到了可擴充性。</span><span class="sxs-lookup"><span data-stu-id="a109b-134">XPS was designed with extensibility in mind.</span></span> <span data-ttu-id="a109b-135">通過使用可擴充性框架，可以模組化地將特性和功能添加到 XPS 中。</span><span class="sxs-lookup"><span data-stu-id="a109b-135">By using the extensibility framework, features and capabilities can be added to XPS in a modular manner.</span></span> <span data-ttu-id="a109b-136">擴充性功能包括：</span><span class="sxs-lookup"><span data-stu-id="a109b-136">Extensibility features include:</span></span>  
  
- <span data-ttu-id="a109b-137">列印結構描述。</span><span class="sxs-lookup"><span data-stu-id="a109b-137">Print Schema.</span></span> <span data-ttu-id="a109b-138">會定期更新公用結構描述，並讓裝置功能可快速擴充。</span><span class="sxs-lookup"><span data-stu-id="a109b-138">The public schema is updated regularly and enables rapid extension of device capabilities.</span></span> <span data-ttu-id="a109b-139">(請參閱下方的 **PrintTicket 和 PrintCapabilities**)。</span><span class="sxs-lookup"><span data-stu-id="a109b-139">(See **PrintTicket and PrintCapabilities** below.)</span></span>  
  
- <span data-ttu-id="a109b-140">可擴充的篩選管線。</span><span class="sxs-lookup"><span data-stu-id="a109b-140">Extensible Filter Pipeline.</span></span> <span data-ttu-id="a109b-141">XPS 印表機驅動程式 （XPSDrv） 過濾管道旨在支援直接和可擴展地列印 XPS 文檔。</span><span class="sxs-lookup"><span data-stu-id="a109b-141">The XPS printer driver (XPSDrv) filter pipeline was designed to enable both direct and scalable printing of XPS documents.</span></span> <span data-ttu-id="a109b-142">有關詳細資訊，請參閱[XPSDrv 印表機驅動程式](/windows-hardware/drivers/print/xpsdrv-printer-drivers)。</span><span class="sxs-lookup"><span data-stu-id="a109b-142">For more information, see [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>
  
### <a name="print-path-architecture"></a><span data-ttu-id="a109b-143">列印路徑架構</span><span class="sxs-lookup"><span data-stu-id="a109b-143">Print Path Architecture</span></span>  
 <span data-ttu-id="a109b-144">雖然 Win32 和 .NET 框架應用程式都支援 XPS，但 Win32 和 Windows 表單應用程式使用 GDI 到 XPS 轉換，以便為 XPS 印表機驅動程式 （XPSDrv） 創建 XPS 格式化的內容。</span><span class="sxs-lookup"><span data-stu-id="a109b-144">While both Win32 and .NET Framework applications support XPS, Win32 and Windows Forms applications use a GDI to XPS conversion in order to create XPS formatted content for the XPS printer driver (XPSDrv).</span></span> <span data-ttu-id="a109b-145">這些應用程式不需要使用 XPS 列印路徑，並且可以繼續使用基於增強的中繼檔 （EMF） 列印。</span><span class="sxs-lookup"><span data-stu-id="a109b-145">These applications are not required to use the XPS print path, and can continue to use Enhanced Metafile (EMF) based printing.</span></span> <span data-ttu-id="a109b-146">但是，大多數 XPS 功能和增強功能僅對面向 XPS 列印路徑的應用程式可用。</span><span class="sxs-lookup"><span data-stu-id="a109b-146">However, most XPS features and enhancements are only available to applications that target the XPS print path.</span></span>  
  
 <span data-ttu-id="a109b-147">為了啟用 Win32 和 Windows 表單應用程式使用基於 XPSDrv 的印表機，XPS 印表機驅動程式 （XPSDrv） 支援將 GDI 轉換為 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="a109b-147">To enable the use of XPSDrv-based printers by Win32 and Windows Forms applications, the XPS printer driver (XPSDrv) supports conversion of GDI to XPS format.</span></span> <span data-ttu-id="a109b-148">XPSDrv 型號還為 XPS 到 GDI 格式提供了轉換器，以便 Win32 應用程式可以列印 XPS 文檔。</span><span class="sxs-lookup"><span data-stu-id="a109b-148">The XPSDrv model also provides a converter for XPS to GDI format so that Win32 applications can print XPS Documents.</span></span> <span data-ttu-id="a109b-149">對於 WPF 應用程式，只要寫入操作的目標列印佇列沒有 XPSDrv<xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A>驅動程式，XPS 格式轉換為 GDI 格式由<xref:System.Windows.Xps.XpsDocumentWriter>類<xref:System.Windows.Xps.XpsDocumentWriter.Write%2A>和方法自動完成。</span><span class="sxs-lookup"><span data-stu-id="a109b-149">For WPF applications, conversion of XPS to GDI format is done automatically by the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class whenever the target print queue of the write operation does not have an XPSDrv driver.</span></span> <span data-ttu-id="a109b-150">（Windows 表單應用程式無法列印 XPS 文檔。</span><span class="sxs-lookup"><span data-stu-id="a109b-150">(Windows Forms applications cannot print XPS Documents.)</span></span>  
  
 <span data-ttu-id="a109b-151">下圖描述了列印子系統，並定義了 Microsoft 提供的部分以及軟體和硬體供應商定義的部分：</span><span class="sxs-lookup"><span data-stu-id="a109b-151">The following illustration depicts the print subsystem and defines the portions provided by Microsoft, and the portions defined by software and hardware vendors:</span></span>  
  
 ![螢幕截圖顯示了 XPS 列印系統。](./media/printing-overview/xml-paper-specification-print-system.png)  
  
### <a name="basic-xps-printing"></a><span data-ttu-id="a109b-153">基本 XPS 列印</span><span class="sxs-lookup"><span data-stu-id="a109b-153">Basic XPS Printing</span></span>  
 <span data-ttu-id="a109b-154">WPF 同時定義基本和高級 API。</span><span class="sxs-lookup"><span data-stu-id="a109b-154">WPF defines both a basic and advanced API.</span></span> <span data-ttu-id="a109b-155">對於不需要大量列印自訂或訪問完整 XPS 功能集的應用程式，可提供基本列印支援。</span><span class="sxs-lookup"><span data-stu-id="a109b-155">For those applications that do not require extensive print customization or access to the complete XPS feature set, basic print support is available.</span></span> <span data-ttu-id="a109b-156">基本列印支援由需要最少組態的列印對話方塊控制項公開，並具有類似 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 的功能。</span><span class="sxs-lookup"><span data-stu-id="a109b-156">Basic print support is exposed through a print dialog control that requires minimal configuration and features a familiar [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="a109b-157">許多 XPS 功能都可用於使用此簡化的列印模型。</span><span class="sxs-lookup"><span data-stu-id="a109b-157">Many XPS features are available using this simplified print model.</span></span>  
  
#### <a name="printdialog"></a><span data-ttu-id="a109b-158">PrintDialog</span><span class="sxs-lookup"><span data-stu-id="a109b-158">PrintDialog</span></span>  
 <span data-ttu-id="a109b-159">該<xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType>控制項為[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]、配置和 XPS 作業提交提供單個進入點。</span><span class="sxs-lookup"><span data-stu-id="a109b-159">The <xref:System.Windows.Controls.PrintDialog?displayProperty=nameWithType> control provides a single entry point for [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], configuration, and XPS job submission.</span></span> <span data-ttu-id="a109b-160">如需如何具現化及使用控制項的相關資訊，請參閱[叫用列印對話方塊](how-to-invoke-a-print-dialog.md)。</span><span class="sxs-lookup"><span data-stu-id="a109b-160">For information about how to instantiate and use the control, see [Invoke a Print Dialog](how-to-invoke-a-print-dialog.md).</span></span>  
  
### <a name="advanced-xps-printing"></a><span data-ttu-id="a109b-161">進階的 XPS 列印</span><span class="sxs-lookup"><span data-stu-id="a109b-161">Advanced XPS Printing</span></span>  
 <span data-ttu-id="a109b-162">要訪問完整的 XPS 功能集，必須使用高級列印 API。</span><span class="sxs-lookup"><span data-stu-id="a109b-162">To access the complete set of XPS features, the advanced print API must be used.</span></span> <span data-ttu-id="a109b-163">下面將更詳細地介紹幾個相關的 API。</span><span class="sxs-lookup"><span data-stu-id="a109b-163">Several relevant API are described in greater detail below.</span></span> <span data-ttu-id="a109b-164">有關 XPS 列印路徑 API 的完整清單，請參閱<xref:System.Windows.Xps><xref:System.Printing>和 命名空間引用。</span><span class="sxs-lookup"><span data-stu-id="a109b-164">For a complete list of XPS print path APIs, see the <xref:System.Windows.Xps> and <xref:System.Printing> namespace references.</span></span>  
  
#### <a name="printticket-and-printcapabilities"></a><span data-ttu-id="a109b-165">PrintTicket 和 PrintCapabilities</span><span class="sxs-lookup"><span data-stu-id="a109b-165">PrintTicket and PrintCapabilities</span></span>  
 <span data-ttu-id="a109b-166"><xref:System.Printing.PrintTicket>和<xref:System.Printing.PrintCapabilities>類是高級 XPS 功能的基礎。</span><span class="sxs-lookup"><span data-stu-id="a109b-166">The <xref:System.Printing.PrintTicket> and <xref:System.Printing.PrintCapabilities> classes are the foundation of the advanced XPS features.</span></span> <span data-ttu-id="a109b-167">這兩種類型的物件都是面向列印的功能（如排序、雙面列印、裝訂等）的 XML 格式結構。這些結構由列印架構定義。</span><span class="sxs-lookup"><span data-stu-id="a109b-167">Both types of objects are XML formatted structures of print-oriented features such as collation, two-sided printing, stapling, etc. These structures are defined by the print schema.</span></span> <span data-ttu-id="a109b-168"><xref:System.Printing.PrintTicket> 會指示印表機該如何處理列印工作。</span><span class="sxs-lookup"><span data-stu-id="a109b-168">A <xref:System.Printing.PrintTicket> instructs a printer how to process a print job.</span></span> <span data-ttu-id="a109b-169"><xref:System.Printing.PrintCapabilities> 類別會定義印表機的功能。</span><span class="sxs-lookup"><span data-stu-id="a109b-169">The <xref:System.Printing.PrintCapabilities> class defines the capabilities of a printer.</span></span> <span data-ttu-id="a109b-170">藉由查詢印表機的功能，可以建立 <xref:System.Printing.PrintTicket> 來完整利用印表機支援的功能。</span><span class="sxs-lookup"><span data-stu-id="a109b-170">By querying the capabilities of a printer, a <xref:System.Printing.PrintTicket> can be created that takes full advantage of a printer's supported features.</span></span> <span data-ttu-id="a109b-171">同樣地，您也可避免不支援的功能。</span><span class="sxs-lookup"><span data-stu-id="a109b-171">Similarly, unsupported features can be avoided.</span></span>  
  
 <span data-ttu-id="a109b-172">下列範例示範如何查詢印表機的 <xref:System.Printing.PrintCapabilities>，並使用程式碼建立 <xref:System.Printing.PrintTicket>。</span><span class="sxs-lookup"><span data-stu-id="a109b-172">The following example demonstrates how to query the <xref:System.Printing.PrintCapabilities> of a printer and create a <xref:System.Printing.PrintTicket> using code.</span></span>  
  
 [!code-cpp[xpscreate#PrinterCapabilities](~/samples/snippets/cpp/VS_Snippets_Wpf/XpsCreate/CPP/XpsCreate.cpp#printercapabilities)]
 [!code-csharp[xpscreate#PrinterCapabilities](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsCreate/CSharp/XpsCreate.cs#printercapabilities)]
 [!code-vb[xpscreate#PrinterCapabilities](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsCreate/visualbasic/xpscreate.vb#printercapabilities)]  
  
#### <a name="printserver-and-printqueue"></a><span data-ttu-id="a109b-173">PrintServer 和 PrintQueue</span><span class="sxs-lookup"><span data-stu-id="a109b-173">PrintServer and PrintQueue</span></span>  
 <span data-ttu-id="a109b-174"><xref:System.Printing.PrintServer> 類別代表網路列印伺服器，且 <xref:System.Printing.PrintQueue> 類別代表印表機以及相關聯的輸出工作佇列。</span><span class="sxs-lookup"><span data-stu-id="a109b-174">The <xref:System.Printing.PrintServer> class represents a network print server and the <xref:System.Printing.PrintQueue> class represents a printer and the output job queue associated with it.</span></span> <span data-ttu-id="a109b-175">總之，這些 API 允許對伺服器的列印工作進行高級管理。</span><span class="sxs-lookup"><span data-stu-id="a109b-175">Together, these APIs allow advanced management of a server's print jobs.</span></span> <span data-ttu-id="a109b-176"><xref:System.Printing.PrintServer> 或其中一個衍生的類別，會用來管理 <xref:System.Printing.PrintQueue>。</span><span class="sxs-lookup"><span data-stu-id="a109b-176">A <xref:System.Printing.PrintServer>, or one of its derived classes, is used to manage a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="a109b-177"><xref:System.Printing.PrintQueue.AddJob%2A> 方法會用來將新的列印工作插入佇列。</span><span class="sxs-lookup"><span data-stu-id="a109b-177">The <xref:System.Printing.PrintQueue.AddJob%2A> method is used to insert a new print job into the queue.</span></span>  
  
 <span data-ttu-id="a109b-178">下列範例示範如何建立 <xref:System.Printing.LocalPrintServer> 及使用程式碼存取其預設的 <xref:System.Printing.PrintQueue>。</span><span class="sxs-lookup"><span data-stu-id="a109b-178">The following example demonstrates how to create a <xref:System.Printing.LocalPrintServer> and access its default <xref:System.Printing.PrintQueue> by using code.</span></span>  
  
 [!code-csharp[xpsprint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[xpsprint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
#### <a name="xpsdocumentwriter"></a><span data-ttu-id="a109b-179">XpsDocumentWriter</span><span class="sxs-lookup"><span data-stu-id="a109b-179">XpsDocumentWriter</span></span>  
 <span data-ttu-id="a109b-180">A<xref:System.Windows.Xps.XpsDocumentWriter>及其許多<xref:System.Windows.Xps.XpsDocumentWriter.Write%2A>和<xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A>方法用於將 XPS 文檔寫入 。 <xref:System.Printing.PrintQueue></span><span class="sxs-lookup"><span data-stu-id="a109b-180">An <xref:System.Windows.Xps.XpsDocumentWriter>, with its many the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> and <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods, is used to write XPS documents to a <xref:System.Printing.PrintQueue>.</span></span> <span data-ttu-id="a109b-181">例如，<xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29>該方法用於輸出 XPS 文檔並<xref:System.Printing.PrintTicket>同步輸出。</span><span class="sxs-lookup"><span data-stu-id="a109b-181">For example, the <xref:System.Windows.Xps.XpsDocumentWriter.Write%28System.Windows.Documents.FixedPage%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> synchronously.</span></span> <span data-ttu-id="a109b-182">該方法<xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29>用於輸出 XPS 文檔並<xref:System.Printing.PrintTicket>非同步輸出。</span><span class="sxs-lookup"><span data-stu-id="a109b-182">The <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%28System.Windows.Documents.FixedDocument%2CSystem.Printing.PrintTicket%29> method is used to output an XPS document and <xref:System.Printing.PrintTicket> asynchronously.</span></span>  
  
 <span data-ttu-id="a109b-183">下列範例示範如何使用程式碼建立 <xref:System.Windows.Xps.XpsDocumentWriter>。</span><span class="sxs-lookup"><span data-stu-id="a109b-183">The following example demonstrates how to create an <xref:System.Windows.Xps.XpsDocumentWriter> using code.</span></span>  
  
 [!code-csharp[XpsPrint#PrintQueueSnip](~/samples/snippets/csharp/VS_Snippets_Wpf/XpsPrint/CSharp/XpsPrintHelper.cs#printqueuesnip)]
 [!code-vb[XpsPrint#PrintQueueSnip](~/samples/snippets/visualbasic/VS_Snippets_Wpf/XpsPrint/visualbasic/xpsprinthelper.vb#printqueuesnip)]  
  
 <span data-ttu-id="a109b-184"><xref:System.Printing.PrintQueue.AddJob%2A> 方法也會提供列印的方式。</span><span class="sxs-lookup"><span data-stu-id="a109b-184">The <xref:System.Printing.PrintQueue.AddJob%2A> methods also provide ways to print.</span></span> <span data-ttu-id="a109b-185">請參閱[以程式設計方式列印 XPS 檔](how-to-programmatically-print-xps-files.md)。</span><span class="sxs-lookup"><span data-stu-id="a109b-185">See [Programmatically Print XPS Files](how-to-programmatically-print-xps-files.md).</span></span> <span data-ttu-id="a109b-186">。</span><span class="sxs-lookup"><span data-stu-id="a109b-186">for details.</span></span>  
  
<a name="GDI_Print_Path_intro"></a>
## <a name="gdi-print-path"></a><span data-ttu-id="a109b-187">GDI 列印路徑</span><span class="sxs-lookup"><span data-stu-id="a109b-187">GDI Print Path</span></span>  
 <span data-ttu-id="a109b-188">雖然 WPF 應用程式本機支援 XPS 列印路徑，但 Win32 和 Windows 表單應用程式也可以利用某些 XPS 功能。</span><span class="sxs-lookup"><span data-stu-id="a109b-188">While WPF applications natively support the XPS print path, Win32 and Windows Forms applications can also take advantage of some XPS features.</span></span> <span data-ttu-id="a109b-189">XPS 印表機驅動程式 （XPSDrv） 可將基於 GDI 的輸出轉換為 XPS 格式。</span><span class="sxs-lookup"><span data-stu-id="a109b-189">The XPS printer driver (XPSDrv) can convert GDI based output to XPS format.</span></span> <span data-ttu-id="a109b-190">對於高級方案，支援使用[Microsoft XPS 文檔轉換器 （MXDC）](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)自訂內容轉換。</span><span class="sxs-lookup"><span data-stu-id="a109b-190">For advanced scenarios, custom conversion of content is supported using the [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-).</span></span> <span data-ttu-id="a109b-191">同樣，WPF 應用程式還可以通過調用<xref:System.Windows.Xps.XpsDocumentWriter.Write%2A><xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A><xref:System.Windows.Xps.XpsDocumentWriter>類的或方法之一併將非 XpsDrv 印表機指定為目標列印佇列，輸出到 GDI 列印路徑。</span><span class="sxs-lookup"><span data-stu-id="a109b-191">Similarly, WPF applications can also output to the GDI print path by calling one of the <xref:System.Windows.Xps.XpsDocumentWriter.Write%2A> or <xref:System.Windows.Xps.XpsDocumentWriter.WriteAsync%2A> methods of the <xref:System.Windows.Xps.XpsDocumentWriter> class and designating a non-XpsDrv printer as the target print queue.</span></span>  

<span data-ttu-id="a109b-192">對於不需要 XPS 功能或支援的應用程式，當前 GDI 列印路徑保持不變。</span><span class="sxs-lookup"><span data-stu-id="a109b-192">For applications that do not require XPS functionality or support, the current GDI print path remains unchanged.</span></span>  
  
- <span data-ttu-id="a109b-193">有關 GDI 列印路徑和各種 XPS 轉換選項的其他參考資料，請參閱[Microsoft XPS 文檔轉換器 （MXDC）](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)和[XPSDrv 印表機驅動程式](/windows-hardware/drivers/print/xpsdrv-printer-drivers)。</span><span class="sxs-lookup"><span data-stu-id="a109b-193">For additional reference material on the GDI print path and the various XPS conversion options, see [Microsoft XPS Document Converter (MXDC)](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-) and [XPSDrv Printer Drivers](/windows-hardware/drivers/print/xpsdrv-printer-drivers).</span></span>  
  
<a name="XPS_Driver_Model_intro"></a>
## <a name="xpsdrv-driver-model"></a><span data-ttu-id="a109b-194">XPSDrv 驅動程式模型</span><span class="sxs-lookup"><span data-stu-id="a109b-194">XPSDrv Driver Model</span></span>  
 <span data-ttu-id="a109b-195">在列印到啟用 XPS 的印表機或驅動程式時，XPS 列印路徑使用 XPS 作為本機列印周邊同作格式，從而提高了幕後程式的效率。</span><span class="sxs-lookup"><span data-stu-id="a109b-195">The XPS print path improves spooler efficiency by using XPS as the native print spool format when printing to an XPS -enabled printer or driver.</span></span> <span data-ttu-id="a109b-196">簡化的幕後列印過程消除了在文檔後臺化之前生成中間周邊同作檔（如 EMF 資料檔案）的需要。</span><span class="sxs-lookup"><span data-stu-id="a109b-196">The simplified spooling process eliminates the need to generate an intermediate spool file, such as an EMF data file, before the document is spooled.</span></span> <span data-ttu-id="a109b-197">通過更小的周邊同作檔案大小，XPS 列印路徑可以減少網路流量並提高列印性能。</span><span class="sxs-lookup"><span data-stu-id="a109b-197">Through smaller spool file sizes, the XPS print path can reduce network traffic and improve print performance.</span></span>  
  
 <span data-ttu-id="a109b-198">EMF 是一種封閉格式，表示應用程式輸出為一系列對 GDI 的調用，用於呈現服務。</span><span class="sxs-lookup"><span data-stu-id="a109b-198">EMF is a closed format that represents application output as a series of calls into GDI for rendering services.</span></span> <span data-ttu-id="a109b-199">與 EMF 不同，XPS 周邊同作格式表示實際文檔，無需在輸出到基於 XPS 的印表機驅動程式 （XPSDrv） 時需要進一步解釋。</span><span class="sxs-lookup"><span data-stu-id="a109b-199">Unlike EMF, the XPS spool format represents the actual document without requiring further interpretation when output to an XPS-based printer driver (XPSDrv).</span></span> <span data-ttu-id="a109b-200">驅動程式可以直接在格式中的資料上運作。</span><span class="sxs-lookup"><span data-stu-id="a109b-200">The drivers can operate directly on the data in the format.</span></span> <span data-ttu-id="a109b-201">此功能消除了使用 EMF 檔和基於 GDI 的列印驅動程式所需的資料和色彩空間轉換。</span><span class="sxs-lookup"><span data-stu-id="a109b-201">This capability eliminates the data and color space conversions required when you use EMF files and GDI-based print drivers.</span></span>  
  
 <span data-ttu-id="a109b-202">與 EMF 等效項相比，當您使用針對 XPS 印表機驅動程式 （XPSDrv） 的 XPS 文檔時，Spool 檔案大小通常會減小;但是，也有例外：</span><span class="sxs-lookup"><span data-stu-id="a109b-202">Spool file sizes are usually reduced when you use XPS Documents that target an XPS printer driver (XPSDrv) compared with their EMF equivalents; however, there are exceptions:</span></span>  
  
- <span data-ttu-id="a109b-203">非常複雜、多層或無效率寫入的向量圖形可能大於相同圖形的點陣圖版本。</span><span class="sxs-lookup"><span data-stu-id="a109b-203">A vector graphic that is very complex, multi-layered, or inefficiently written can be larger than a bitmapped version of the same graphic.</span></span>  
  
- <span data-ttu-id="a109b-204">供螢幕顯示之用，XPS 檔內嵌裝置字型，以及以電腦為基礎的字型；而 GDI 多工緩衝處理檔案則不會內嵌裝置字型。</span><span class="sxs-lookup"><span data-stu-id="a109b-204">For screen display purposes, XPS files embed device fonts as well as computer-based fonts; whereas GDI spool files do not embed device fonts.</span></span> <span data-ttu-id="a109b-205">但是這兩種字型為部分內嵌的字型 (如下所示)，而且印表機驅動程式可以移除裝置字型，然後再將檔案傳輸至印表機。</span><span class="sxs-lookup"><span data-stu-id="a109b-205">But both kinds of fonts are subsetted (see below) and printer drivers can remove the device fonts before transmitting the file to the printer.</span></span>  
  
 <span data-ttu-id="a109b-206">多工緩衝處理大小縮減會透過數種機制執行：</span><span class="sxs-lookup"><span data-stu-id="a109b-206">Spool size reduction is performed through several mechanisms:</span></span>  
  
- <span data-ttu-id="a109b-207">**字型部分內嵌**。</span><span class="sxs-lookup"><span data-stu-id="a109b-207">**Font subsetting**.</span></span> <span data-ttu-id="a109b-208">XPS 檔中僅存儲實際文檔中使用的字元。</span><span class="sxs-lookup"><span data-stu-id="a109b-208">Only characters used within the actual document are stored in the XPS file.</span></span>  
  
- <span data-ttu-id="a109b-209">**進階圖形支援**。</span><span class="sxs-lookup"><span data-stu-id="a109b-209">**Advanced Graphics Support**.</span></span> <span data-ttu-id="a109b-210">對透明度和梯度基元的本機支援可避免 XPS 文檔中內容的柵格化。</span><span class="sxs-lookup"><span data-stu-id="a109b-210">Native support for transparency and gradient primitives avoids rasterization of content in the XPS Document.</span></span>  
  
- <span data-ttu-id="a109b-211">**識別通用資源**。</span><span class="sxs-lookup"><span data-stu-id="a109b-211">**Identification of common resources**.</span></span> <span data-ttu-id="a109b-212">多次使用的資源 (例如代表公司標誌的影像) 會被視為共用資源，並只會載入一次。</span><span class="sxs-lookup"><span data-stu-id="a109b-212">Resources that are used multiple times (such as an image that represents a corporate logo) are treated as shared resources and are loaded only once.</span></span>  
  
- <span data-ttu-id="a109b-213">**ZIP 壓縮**。</span><span class="sxs-lookup"><span data-stu-id="a109b-213">**ZIP compression**.</span></span> <span data-ttu-id="a109b-214">所有 XPS 文檔都使用 ZIP 壓縮。</span><span class="sxs-lookup"><span data-stu-id="a109b-214">All XPS documents use ZIP compression.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a109b-215">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a109b-215">See also</span></span>

- <xref:System.Windows.Controls.PrintDialog>
- <xref:System.Windows.Xps.XpsDocumentWriter>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.Printing.PrintTicket>
- <xref:System.Printing.PrintCapabilities>
- <xref:System.Printing.PrintServer>
- <xref:System.Printing.PrintQueue>
- [<span data-ttu-id="a109b-216">如何使用主題</span><span class="sxs-lookup"><span data-stu-id="a109b-216">How-to Topics</span></span>](printing-how-to-topics.md)
- [<span data-ttu-id="a109b-217">WPF 中的文件</span><span class="sxs-lookup"><span data-stu-id="a109b-217">Documents in WPF</span></span>](documents-in-wpf.md)
- [<span data-ttu-id="a109b-218">XPS 文件</span><span class="sxs-lookup"><span data-stu-id="a109b-218">XPS Documents</span></span>](/windows/desktop/printdocs/documents)
- [<span data-ttu-id="a109b-219">文件序列化與儲存</span><span class="sxs-lookup"><span data-stu-id="a109b-219">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
- [<span data-ttu-id="a109b-220">微軟XPS文檔轉換器（MXDC）</span><span class="sxs-lookup"><span data-stu-id="a109b-220">Microsoft XPS Document Converter (MXDC)</span></span>](/windows/desktop/printdocs/microsoft-xps-document-converter--mxdc-)
