---
title: "進階文字格式化"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-wpf
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords:
- formatting [WPF]
- text [WPF]
- typography [WPF], text formatting
ms.assetid: f0a7986e-f5b2-485c-a27d-f8e922022212
caps.latest.revision: "16"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 9bb2664b267301fdf1e3a67e385595a5d28212bc
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/22/2017
---
# <a name="advanced-text-formatting"></a><span data-ttu-id="7c11f-102">進階文字格式化</span><span class="sxs-lookup"><span data-stu-id="7c11f-102">Advanced Text Formatting</span></span>
<span data-ttu-id="7c11f-103">[!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)]提供一組強固的[!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)]在您的應用程式中包含文字。</span><span class="sxs-lookup"><span data-stu-id="7c11f-103">The [!INCLUDE[TLA#tla_wpf](../../../../includes/tlasharptla-wpf-md.md)] provides a robust set of [!INCLUDE[TLA#tla_api#plural](../../../../includes/tlasharptla-apisharpplural-md.md)] for including text in your application.</span></span> <span data-ttu-id="7c11f-104">版面配置和[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]，例如<xref:System.Windows.Controls.TextBlock>、 提供最常見和一般使用的文字表示的項目。</span><span class="sxs-lookup"><span data-stu-id="7c11f-104">Layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)][!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], such as <xref:System.Windows.Controls.TextBlock>, provide the most common and general use elements for text presentation.</span></span> <span data-ttu-id="7c11f-105">繪製[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]，例如<xref:System.Windows.Media.GlyphRunDrawing>和<xref:System.Windows.Media.FormattedText>，提供一種機制，在 繪圖中包含格式化的文字。</span><span class="sxs-lookup"><span data-stu-id="7c11f-105">Drawing [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], such as <xref:System.Windows.Media.GlyphRunDrawing> and <xref:System.Windows.Media.FormattedText>, provide a means for including formatted text in drawings.</span></span> <span data-ttu-id="7c11f-106">在最進階級[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]提供可延伸的文字格式設定引擎來控制每個層面的文字表示，例如文字存放區管理、 執行文字格式設定管理，以及內嵌的物件管理。</span><span class="sxs-lookup"><span data-stu-id="7c11f-106">At the most advanced level, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] provides an extensible text formatting engine to control every aspect of text presentation, such as text store management, text run formatting management, and embedded object management.</span></span>  
  
 <span data-ttu-id="7c11f-107">本主題提供簡介[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]文字格式設定。</span><span class="sxs-lookup"><span data-stu-id="7c11f-107">This topic provides an introduction to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] text formatting.</span></span> <span data-ttu-id="7c11f-108">它著重在用戶端實作及使用[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]文字格式設定引擎。</span><span class="sxs-lookup"><span data-stu-id="7c11f-108">It focuses on client implementation and use of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] text formatting engine.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="7c11f-109">此文件中的所有程式碼範例可以在[進階文字格式範例](http://go.microsoft.com/fwlink/?LinkID=159965)。</span><span class="sxs-lookup"><span data-stu-id="7c11f-109">All code examples within this document can be found in the [Advanced Text Formatting Sample](http://go.microsoft.com/fwlink/?LinkID=159965).</span></span>  
  

  
<a name="prereq"></a>   
## <a name="prerequisites"></a><span data-ttu-id="7c11f-110">必要條件</span><span class="sxs-lookup"><span data-stu-id="7c11f-110">Prerequisites</span></span>  
 <span data-ttu-id="7c11f-111">本主題假設您已熟悉高的層級[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]用於文字的呈現。</span><span class="sxs-lookup"><span data-stu-id="7c11f-111">This topic assumes that you are familiar with the higher level [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] used for text presentation.</span></span> <span data-ttu-id="7c11f-112">大部分使用者案例不需要進階的文字格式[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]本主題中討論。</span><span class="sxs-lookup"><span data-stu-id="7c11f-112">Most user scenarios will not require the advanced text formatting [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)] discussed in this topic.</span></span> <span data-ttu-id="7c11f-113">如需不同的文字的介紹[!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)]，請參閱[WPF 中文件](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)。</span><span class="sxs-lookup"><span data-stu-id="7c11f-113">For an introduction to the different text [!INCLUDE[TLA2#tla_api#plural](../../../../includes/tla2sharptla-apisharpplural-md.md)], see [Documents in WPF](../../../../docs/framework/wpf/advanced/documents-in-wpf.md).</span></span>  
  
<a name="section1"></a>   
## <a name="advanced-text-formatting"></a><span data-ttu-id="7c11f-114">進階文字格式化</span><span class="sxs-lookup"><span data-stu-id="7c11f-114">Advanced Text Formatting</span></span>  
 <span data-ttu-id="7c11f-115">文字版面配置和[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]控制項[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]提供可讓您輕鬆地在應用程式中包含格式化的文字格式設定屬性。</span><span class="sxs-lookup"><span data-stu-id="7c11f-115">The text layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] controls in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] provide formatting properties that allow you to easily include formatted text in your application.</span></span> <span data-ttu-id="7c11f-116">這些控制項會公開一些屬性來處理文字的呈現方式，包括其字體、大小和色彩。</span><span class="sxs-lookup"><span data-stu-id="7c11f-116">These controls expose a number of properties to handle the presentation of text, which includes its typeface, size, and color.</span></span> <span data-ttu-id="7c11f-117">在一般情況下，這些控制項可以處理您應用程式中大部分的文字呈現。</span><span class="sxs-lookup"><span data-stu-id="7c11f-117">Under ordinary circumstances, these controls can handle the majority of text presentation in your application.</span></span> <span data-ttu-id="7c11f-118">不過，某些進階的情節需要控制文字儲存以及文字呈現。</span><span class="sxs-lookup"><span data-stu-id="7c11f-118">However, some advanced scenarios require the control of text storage as well as text presentation.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="7c11f-119"> 針對這個用途提供可延伸的文字格式設定引擎。</span><span class="sxs-lookup"><span data-stu-id="7c11f-119"> provides an extensible text formatting engine for this purpose.</span></span>  
  
 <span data-ttu-id="7c11f-120">格式化功能的進階的文字中找到[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]組成的文字格式設定引擎、 文字往返的文字存放區和格式化屬性。</span><span class="sxs-lookup"><span data-stu-id="7c11f-120">The advanced text formatting features found in [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] consist of a text formatting engine, a text store, text runs, and formatting properties.</span></span> <span data-ttu-id="7c11f-121">文字格式設定引擎， <xref:System.Windows.Media.TextFormatting.TextFormatter>，建立要用來呈現的文字行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-121">The text formatting engine, <xref:System.Windows.Media.TextFormatting.TextFormatter>, creates lines of text to be used for presentation.</span></span> <span data-ttu-id="7c11f-122">這起始行格式化的過程，和呼叫的文字格式器所達成<xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-122">This is achieved by initiating the line formatting process and calling the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span></span> <span data-ttu-id="7c11f-123">文字格式子的呼叫的存放區從您的文字存放區擷取文字往返<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-123">The text formatter retrieves text runs from your text store by calling the store's <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="7c11f-124"><xref:System.Windows.Media.TextFormatting.TextRun>物件然後形成<xref:System.Windows.Media.TextFormatting.TextLine>文字格式子的物件，且提供給您的應用程式用來檢查或顯示。</span><span class="sxs-lookup"><span data-stu-id="7c11f-124">The <xref:System.Windows.Media.TextFormatting.TextRun> objects are then formed into <xref:System.Windows.Media.TextFormatting.TextLine> objects by the text formatter and given to your application for inspection or display.</span></span>  
  
<a name="section2"></a>   
## <a name="using-the-text-formatter"></a><span data-ttu-id="7c11f-125">使用文字格式子</span><span class="sxs-lookup"><span data-stu-id="7c11f-125">Using the Text Formatter</span></span>  
 <span data-ttu-id="7c11f-126"><xref:System.Windows.Media.TextFormatting.TextFormatter>是[!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]文字格式設定引擎，並提供服務的格式和分隔文字行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> is the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] text formatting engine and provides services for formatting and breaking text lines.</span></span> <span data-ttu-id="7c11f-127">文字格式子可處理不同的文字字元格式和段落樣式，且包含國際文字版面配置的支援。</span><span class="sxs-lookup"><span data-stu-id="7c11f-127">The text formatter can handle different text character formats and paragraph styles, and includes support for international text layout.</span></span>  
  
 <span data-ttu-id="7c11f-128">不同於傳統文字[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]、<xref:System.Windows.Media.TextFormatting.TextFormatter>與透過回呼方法的一組文字配置用戶端互動。</span><span class="sxs-lookup"><span data-stu-id="7c11f-128">Unlike a traditional text [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)], the <xref:System.Windows.Media.TextFormatting.TextFormatter> interacts with a text layout client through a set of callback methods.</span></span> <span data-ttu-id="7c11f-129">它需要用戶端提供這些方法的實作中<xref:System.Windows.Media.TextFormatting.TextSource>類別。</span><span class="sxs-lookup"><span data-stu-id="7c11f-129">It requires the client to provide these methods in an implementation of the <xref:System.Windows.Media.TextFormatting.TextSource> class.</span></span> <span data-ttu-id="7c11f-130">下圖說明文字版面配置之間互動的用戶端應用程式和<xref:System.Windows.Media.TextFormatting.TextFormatter>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-130">The following diagram illustrates the text layout interaction between the client application and <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span></span>  
  
 <span data-ttu-id="7c11f-131">![文字配置用戶端和 TextFormatter 的圖表](../../../../docs/framework/wpf/advanced/media/textformatter01.png "TextFormatter01")</span><span class="sxs-lookup"><span data-stu-id="7c11f-131">![Diagram of text layout client and TextFormatter](../../../../docs/framework/wpf/advanced/media/textformatter01.png "TextFormatter01")</span></span>  
<span data-ttu-id="7c11f-132">應用程式和 TextFormatter 之間的互動</span><span class="sxs-lookup"><span data-stu-id="7c11f-132">Interaction between application and TextFormatter</span></span>  
  
 <span data-ttu-id="7c11f-133">文字格式器用來擷取格式化的文字行從文字存放區中，這是實作<xref:System.Windows.Media.TextFormatting.TextSource>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-133">The text formatter is used to retrieve formatted text lines from the text store, which is an implementation of <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="7c11f-134">這樣做，第一個建立的文字格式器執行個體使用<xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-134">This is done by first creating an instance of the text formatter by using the <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A> method.</span></span> <span data-ttu-id="7c11f-135">這個方法會建立文字格式子的執行個體，並設定最大線條高度和寬度的值。</span><span class="sxs-lookup"><span data-stu-id="7c11f-135">This method creates an instance of the text formatter and sets the maximum line height and width values.</span></span> <span data-ttu-id="7c11f-136">一旦建立文字格式器的執行個體時，啟動列的建立程序呼叫<xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-136">As soon as an instance of the text formatter is created, the line creation process is started by calling the <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span> <span data-ttu-id="7c11f-137"><xref:System.Windows.Media.TextFormatting.TextFormatter>回撥到擷取的文字和格式設定參數的文字執行的文字來源該表單一條線。</span><span class="sxs-lookup"><span data-stu-id="7c11f-137"><xref:System.Windows.Media.TextFormatting.TextFormatter> calls back to the text source to retrieve the text and formatting parameters for the runs of text that form a line.</span></span>  
  
 <span data-ttu-id="7c11f-138">在下列範例中，會顯示格式設定文字存放區的程序。</span><span class="sxs-lookup"><span data-stu-id="7c11f-138">In the following example, the process of formatting a text store is shown.</span></span> <span data-ttu-id="7c11f-139"><xref:System.Windows.Media.TextFormatting.TextFormatter>物件用來將文字存放區擷取文字行，然後再格式化成繪製的文字行<xref:System.Windows.Media.DrawingContext>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-139">The <xref:System.Windows.Media.TextFormatting.TextFormatter> object is used to retrieve text lines from the text store and then format the text line for drawing into the <xref:System.Windows.Media.DrawingContext>.</span></span>  
  
 [!code-csharp[TextFormatterExample#100](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/Window1.xaml.cs#100)]
 [!code-vb[TextFormatterExample#100](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/Window1.xaml.vb#100)]  
  
<a name="section3"></a>   
## <a name="implementing-the-client-text-store"></a><span data-ttu-id="7c11f-140">實作用戶端文字存放區</span><span class="sxs-lookup"><span data-stu-id="7c11f-140">Implementing the Client Text Store</span></span>  
 <span data-ttu-id="7c11f-141">當您延伸文字格式設定引擎時，您必須實作與管理文字存放區的所有層面。</span><span class="sxs-lookup"><span data-stu-id="7c11f-141">When you extend the text formatting engine, you are required to implement and manage all aspects of the text store.</span></span> <span data-ttu-id="7c11f-142">這不是簡單的工作。</span><span class="sxs-lookup"><span data-stu-id="7c11f-142">This is not a trivial task.</span></span> <span data-ttu-id="7c11f-143">文字存放區負責追蹤文字執行屬性、段落屬性、內嵌的物件，以及其他類似的內容。</span><span class="sxs-lookup"><span data-stu-id="7c11f-143">The text store is responsible for tracking text run properties, paragraph properties, embedded objects, and other similar content.</span></span> <span data-ttu-id="7c11f-144">它也提供個別文字格式子<xref:System.Windows.Media.TextFormatting.TextRun>文字格式器會使用來建立物件<xref:System.Windows.Media.TextFormatting.TextLine>物件。</span><span class="sxs-lookup"><span data-stu-id="7c11f-144">It also provides the text formatter with individual <xref:System.Windows.Media.TextFormatting.TextRun> objects which the text formatter uses to create <xref:System.Windows.Media.TextFormatting.TextLine> objects.</span></span>  
  
 <span data-ttu-id="7c11f-145">若要處理的文字存放區的虛擬化，文字存放區必須衍生自<xref:System.Windows.Media.TextFormatting.TextSource>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-145">To handle the virtualization of the text store, the text store must be derived from <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="7c11f-146"><xref:System.Windows.Media.TextFormatting.TextSource>定義用來將文字存放區擷取文字往返的文字格式子的方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-146"><xref:System.Windows.Media.TextFormatting.TextSource> defines the method the text formatter uses to retrieve text runs from the text store.</span></span> <span data-ttu-id="7c11f-147"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>是用來擷取文字的文字格式器方法會執行，用於線條格式。</span><span class="sxs-lookup"><span data-stu-id="7c11f-147"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is the method used by the text formatter to retrieve text runs used in line formatting.</span></span> <span data-ttu-id="7c11f-148">若要呼叫<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>重複會由文字格式器到發生以下條件之一為止：</span><span class="sxs-lookup"><span data-stu-id="7c11f-148">The call to <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is repeatedly made by the text formatter until one of the following conditions occurs:</span></span>  
  
-   <span data-ttu-id="7c11f-149">A<xref:System.Windows.Media.TextFormatting.TextEndOfLine>或子類別會傳回。</span><span class="sxs-lookup"><span data-stu-id="7c11f-149">A <xref:System.Windows.Media.TextFormatting.TextEndOfLine> or a subclass is returned.</span></span>  
  
-   <span data-ttu-id="7c11f-150">文字往返的累積的寬度超過任一建立文字格式子的呼叫或文字格式子的呼叫中指定的最大線條寬度<xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-150">The accumulated width of text runs exceeds the maximum line width specified in either the call to create the text formatter or the call to the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span>  
  
-   <span data-ttu-id="7c11f-151">A[!INCLUDE[TLA#tla_unicode](../../../../includes/tlasharptla-unicode-md.md)]新行字元序列，例如"CF"、"LF"或"CRLF"，就會傳回。</span><span class="sxs-lookup"><span data-stu-id="7c11f-151">A [!INCLUDE[TLA#tla_unicode](../../../../includes/tlasharptla-unicode-md.md)] newline sequence, such as "CF", "LF", or "CRLF", is returned.</span></span>  
  
<a name="section4"></a>   
## <a name="providing-text-runs"></a><span data-ttu-id="7c11f-152">提供文字執行</span><span class="sxs-lookup"><span data-stu-id="7c11f-152">Providing Text Runs</span></span>  
 <span data-ttu-id="7c11f-153">文字格式設定程序的核心是文字格式子與文字存放區之間的互動。</span><span class="sxs-lookup"><span data-stu-id="7c11f-153">The core of the text formatting process is the interaction between the text formatter and the text store.</span></span> <span data-ttu-id="7c11f-154">實作<xref:System.Windows.Media.TextFormatting.TextSource>提供文字格式器與<xref:System.Windows.Media.TextFormatting.TextRun>物件以及用來格式化文字往返的屬性。</span><span class="sxs-lookup"><span data-stu-id="7c11f-154">Your implementation of <xref:System.Windows.Media.TextFormatting.TextSource> provides the text formatter with the <xref:System.Windows.Media.TextFormatting.TextRun> objects and the properties with which to format the text runs.</span></span> <span data-ttu-id="7c11f-155">這個互動由<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>文字格式器所呼叫的方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-155">This interaction is handled by the <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method, which is called by the text formatter.</span></span>  
  
 <span data-ttu-id="7c11f-156">下表顯示一些預先定義之<xref:System.Windows.Media.TextFormatting.TextRun>物件。</span><span class="sxs-lookup"><span data-stu-id="7c11f-156">The following table shows some of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects.</span></span>  
  
|<span data-ttu-id="7c11f-157">TextRun 類型</span><span class="sxs-lookup"><span data-stu-id="7c11f-157">TextRun Type</span></span>|<span data-ttu-id="7c11f-158">使用量</span><span class="sxs-lookup"><span data-stu-id="7c11f-158">Usage</span></span>|  
|------------------|-----------|  
|<xref:System.Windows.Media.TextFormatting.TextCharacters>|<span data-ttu-id="7c11f-159">用來將字元圖像 (glyph) 的表示法傳回文字格式子的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-159">The specialized text run used to pass a representation of character glyphs back to the text formatter.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEmbeddedObject>|<span data-ttu-id="7c11f-160">用來提供內容的特殊文字執行，在這些內容中會整體進行測量、點擊測試和繪製，例如文字內的按鈕或影像。</span><span class="sxs-lookup"><span data-stu-id="7c11f-160">The specialized text run used to provide content in which measuring, hit testing, and drawing is done in whole, such as a button or image within the text.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfLine>|<span data-ttu-id="7c11f-161">用來標記行尾的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-161">The specialized text run used to mark the end of a line.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>|<span data-ttu-id="7c11f-162">用來標記段落結尾的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-162">The specialized text run used to mark the end of a paragraph.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>|<span data-ttu-id="7c11f-163">用來結束先前受影響的範圍，例如標記在區段中，結尾的特定的文字執行<xref:System.Windows.Media.TextFormatting.TextModifier>執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-163">The specialized text run used to mark the end of a segment, such as to end the scope affected by a previous <xref:System.Windows.Media.TextFormatting.TextModifier> run.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextHidden>|<span data-ttu-id="7c11f-164">用來標記隱藏字元範圍的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-164">The specialized text run used to mark a range of hidden characters.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextModifier>|<span data-ttu-id="7c11f-165">用來在文字執行範圍中修改其屬性的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-165">The specialized text run used to modify properties of text runs in its scope.</span></span> <span data-ttu-id="7c11f-166">範圍會延伸到下一個符合<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>文字執行或在下一個<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-166">The scope extends to the next matching <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> text run, or the next <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span></span>|  
  
 <span data-ttu-id="7c11f-167">預先定義的任何<xref:System.Windows.Media.TextFormatting.TextRun>物件可以進行子類別化。</span><span class="sxs-lookup"><span data-stu-id="7c11f-167">Any of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects can be subclassed.</span></span> <span data-ttu-id="7c11f-168">這可讓文字來源提供文字格式子包含自訂資料的文字執行。</span><span class="sxs-lookup"><span data-stu-id="7c11f-168">This allows your text source to provide the text formatter with text runs that include custom data.</span></span>  
  
 <span data-ttu-id="7c11f-169">下列範例會示範<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="7c11f-169">The following example demonstrates a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="7c11f-170">此文字存放區傳回<xref:System.Windows.Media.TextFormatting.TextRun>要處理的文字格式子物件。</span><span class="sxs-lookup"><span data-stu-id="7c11f-170">This text store returns <xref:System.Windows.Media.TextFormatting.TextRun> objects to the text formatter for processing.</span></span>  
  
 [!code-csharp[TextFormatterExample#101](../../../../samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/CustomTextSource.cs#101)]
 [!code-vb[TextFormatterExample#101](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/CustomTextSource.vb#101)]  
  
> [!NOTE]
>  <span data-ttu-id="7c11f-171">在此範例中，文字存放區提供相同的文字屬性給所有文字。</span><span class="sxs-lookup"><span data-stu-id="7c11f-171">In this example, the text store provides the same text properties to all of the text.</span></span> <span data-ttu-id="7c11f-172">進階的文字存放區必須實作自己的範圍管理，以允許個別字元可以有不同的屬性。</span><span class="sxs-lookup"><span data-stu-id="7c11f-172">Advanced text stores would need to implement their own span management to allow individual characters to have different properties.</span></span>  
  
<a name="section5"></a>   
## <a name="specifying-formatting-properties"></a><span data-ttu-id="7c11f-173">指定格式設定屬性</span><span class="sxs-lookup"><span data-stu-id="7c11f-173">Specifying Formatting Properties</span></span>  
 <span data-ttu-id="7c11f-174"><xref:System.Windows.Media.TextFormatting.TextRun>物件使用來格式化的文字存放區所提供的屬性。</span><span class="sxs-lookup"><span data-stu-id="7c11f-174"><xref:System.Windows.Media.TextFormatting.TextRun> objects are formatted by using properties provided by the text store.</span></span> <span data-ttu-id="7c11f-175">這些屬性有兩種類型，<xref:System.Windows.Media.TextFormatting.TextParagraphProperties>和<xref:System.Windows.Media.TextFormatting.TextRunProperties>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-175">These properties come in two types, <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span></span> <span data-ttu-id="7c11f-176"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties>處理段落 （含） 的屬性，例如<xref:System.Windows.TextAlignment>和<xref:System.Windows.FlowDirection>。</span><span class="sxs-lookup"><span data-stu-id="7c11f-176"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> handle paragraph inclusive properties such as <xref:System.Windows.TextAlignment> and <xref:System.Windows.FlowDirection>.</span></span> <span data-ttu-id="7c11f-177"><xref:System.Windows.Media.TextFormatting.TextRunProperties>是可以執行例如前景筆刷，段落中的每個文字不同的屬性<xref:System.Windows.Media.Typeface>，和字型大小。</span><span class="sxs-lookup"><span data-stu-id="7c11f-177"><xref:System.Windows.Media.TextFormatting.TextRunProperties> are properties that can be different for each text run within a paragraph, such as foreground brush, <xref:System.Windows.Media.Typeface>, and font size.</span></span> <span data-ttu-id="7c11f-178">若要實作自訂的段落，並執行屬性類型的自訂文字，您的應用程式必須建立衍生自的<xref:System.Windows.Media.TextFormatting.TextParagraphProperties>和<xref:System.Windows.Media.TextFormatting.TextRunProperties>分別。</span><span class="sxs-lookup"><span data-stu-id="7c11f-178">To implement custom paragraph and custom text run property types, your application must create classes that derive from <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties> respectively.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="7c11f-179">請參閱</span><span class="sxs-lookup"><span data-stu-id="7c11f-179">See Also</span></span>  
 [<span data-ttu-id="7c11f-180">WPF 中的印刷樣式</span><span class="sxs-lookup"><span data-stu-id="7c11f-180">Typography in WPF</span></span>](../../../../docs/framework/wpf/advanced/typography-in-wpf.md)  
 [<span data-ttu-id="7c11f-181">WPF 中的文件</span><span class="sxs-lookup"><span data-stu-id="7c11f-181">Documents in WPF</span></span>](../../../../docs/framework/wpf/advanced/documents-in-wpf.md)
