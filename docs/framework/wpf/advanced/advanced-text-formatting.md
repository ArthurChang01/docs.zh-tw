---
title: 進階文字格式化
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- formatting [WPF]
- text [WPF]
- typography [WPF], text formatting
ms.assetid: f0a7986e-f5b2-485c-a27d-f8e922022212
ms.openlocfilehash: 745d20e0bd4f877f9d4559f9fc7829b56689d35c
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/12/2020
ms.locfileid: "79185934"
---
# <a name="advanced-text-formatting"></a><span data-ttu-id="63af0-102">進階文字格式化</span><span class="sxs-lookup"><span data-stu-id="63af0-102">Advanced Text Formatting</span></span>
<span data-ttu-id="63af0-103">Windows 演示基礎 （WPF） 提供了一組強大的 API，用於在應用程式中包含文本。</span><span class="sxs-lookup"><span data-stu-id="63af0-103">Windows Presentation Foundation (WPF) provides a robust set of APIs for including text in your application.</span></span> <span data-ttu-id="63af0-104">佈局和[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]API（如<xref:System.Windows.Controls.TextBlock>）為文本表示提供了最常用和最常用的元素。</span><span class="sxs-lookup"><span data-stu-id="63af0-104">Layout and [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)] APIs, such as <xref:System.Windows.Controls.TextBlock>, provide the most common and general-use elements for text presentation.</span></span> <span data-ttu-id="63af0-105">繪圖 API（如<xref:System.Windows.Media.GlyphRunDrawing>和<xref:System.Windows.Media.FormattedText>）提供了一種在圖形中包含格式化文字的方法。</span><span class="sxs-lookup"><span data-stu-id="63af0-105">Drawing APIs, such as <xref:System.Windows.Media.GlyphRunDrawing> and <xref:System.Windows.Media.FormattedText>, provide a means for including formatted text in drawings.</span></span> <span data-ttu-id="63af0-106">在最先進的級別上，WPF 提供了一個可擴展的文本格式引擎來控制文本表示的各個方面，如文本存儲管理、文本運行格式管理和內嵌物件管理。</span><span class="sxs-lookup"><span data-stu-id="63af0-106">At the most advanced level, WPF provides an extensible text formatting engine to control every aspect of text presentation, such as text store management, text run formatting management, and embedded object management.</span></span>  
  
 <span data-ttu-id="63af0-107">本主題介紹了 WPF 文本格式。</span><span class="sxs-lookup"><span data-stu-id="63af0-107">This topic provides an introduction to WPF text formatting.</span></span> <span data-ttu-id="63af0-108">它側重于用戶端實現和使用 WPF 文本格式引擎。</span><span class="sxs-lookup"><span data-stu-id="63af0-108">It focuses on client implementation and use of the WPF text formatting engine.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="63af0-109">本文檔中的所有代碼示例都可以在[高級文本格式示例](https://github.com/Microsoft/WPF-Samples/tree/master/PerMonitorDPI/TextFormatting)中找到。</span><span class="sxs-lookup"><span data-stu-id="63af0-109">All code examples within this document can be found in the [Advanced Text Formatting Sample](https://github.com/Microsoft/WPF-Samples/tree/master/PerMonitorDPI/TextFormatting).</span></span>  

<a name="prereq"></a>
## <a name="prerequisites"></a><span data-ttu-id="63af0-110">必要條件</span><span class="sxs-lookup"><span data-stu-id="63af0-110">Prerequisites</span></span>  
 <span data-ttu-id="63af0-111">本主題假定您熟悉用於文本表示的更高級別 API。</span><span class="sxs-lookup"><span data-stu-id="63af0-111">This topic assumes that you are familiar with the higher level APIs used for text presentation.</span></span> <span data-ttu-id="63af0-112">大多數使用者方案不需要本主題中討論的高級文本格式 API。</span><span class="sxs-lookup"><span data-stu-id="63af0-112">Most user scenarios will not require the advanced text formatting APIs discussed in this topic.</span></span> <span data-ttu-id="63af0-113">有關不同文本 API 的介紹，請參閱[WPF 中的文檔](documents-in-wpf.md)。</span><span class="sxs-lookup"><span data-stu-id="63af0-113">For an introduction to the different text APIs, see [Documents in WPF](documents-in-wpf.md).</span></span>  
  
<a name="section1"></a>
## <a name="advanced-text-formatting"></a><span data-ttu-id="63af0-114">進階文字格式化</span><span class="sxs-lookup"><span data-stu-id="63af0-114">Advanced Text Formatting</span></span>  
 <span data-ttu-id="63af0-115">WPF 中[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]的文本佈局和控制項提供格式屬性，允許您輕鬆地在應用程式中包含格式化文字。</span><span class="sxs-lookup"><span data-stu-id="63af0-115">The text layout and [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] controls in WPF provide formatting properties that allow you to easily include formatted text in your application.</span></span> <span data-ttu-id="63af0-116">這些控制項會公開一些屬性來處理文字的呈現方式，包括其字體、大小和色彩。</span><span class="sxs-lookup"><span data-stu-id="63af0-116">These controls expose a number of properties to handle the presentation of text, which includes its typeface, size, and color.</span></span> <span data-ttu-id="63af0-117">在一般情況下，這些控制項可以處理您應用程式中大部分的文字呈現。</span><span class="sxs-lookup"><span data-stu-id="63af0-117">Under ordinary circumstances, these controls can handle the majority of text presentation in your application.</span></span> <span data-ttu-id="63af0-118">不過，某些進階的情節需要控制文字儲存以及文字呈現。</span><span class="sxs-lookup"><span data-stu-id="63af0-118">However, some advanced scenarios require the control of text storage as well as text presentation.</span></span> <span data-ttu-id="63af0-119">為此，WPF 提供了可擴展的文本格式引擎。</span><span class="sxs-lookup"><span data-stu-id="63af0-119">WPF provides an extensible text formatting engine for this purpose.</span></span>  
  
 <span data-ttu-id="63af0-120">WPF 中的高級文本格式設置功能包括文本格式引擎、文本存儲、文本運行和格式設置屬性。</span><span class="sxs-lookup"><span data-stu-id="63af0-120">The advanced text formatting features found in WPF consist of a text formatting engine, a text store, text runs, and formatting properties.</span></span> <span data-ttu-id="63af0-121">文本格式引擎 ，<xref:System.Windows.Media.TextFormatting.TextFormatter>創建要用於表示的文本行。</span><span class="sxs-lookup"><span data-stu-id="63af0-121">The text formatting engine, <xref:System.Windows.Media.TextFormatting.TextFormatter>, creates lines of text to be used for presentation.</span></span> <span data-ttu-id="63af0-122">這是通過啟動行格式設置過程並調用文本格式化的 來實現的<xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>。</span><span class="sxs-lookup"><span data-stu-id="63af0-122">This is achieved by initiating the line formatting process and calling the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>.</span></span> <span data-ttu-id="63af0-123">文本 formatter 通過調用存儲<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>的方法檢索文本存儲運行的文本。</span><span class="sxs-lookup"><span data-stu-id="63af0-123">The text formatter retrieves text runs from your text store by calling the store's <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="63af0-124">然後<xref:System.Windows.Media.TextFormatting.TextRun>，物件由文本物質<xref:System.Windows.Media.TextFormatting.TextLine>組成物件，並提供給應用程式進行檢查或顯示。</span><span class="sxs-lookup"><span data-stu-id="63af0-124">The <xref:System.Windows.Media.TextFormatting.TextRun> objects are then formed into <xref:System.Windows.Media.TextFormatting.TextLine> objects by the text formatter and given to your application for inspection or display.</span></span>  
  
<a name="section2"></a>
## <a name="using-the-text-formatter"></a><span data-ttu-id="63af0-125">使用文字格式子</span><span class="sxs-lookup"><span data-stu-id="63af0-125">Using the Text Formatter</span></span>  
 <span data-ttu-id="63af0-126"><xref:System.Windows.Media.TextFormatting.TextFormatter>是 WPF 文本格式設置引擎，並提供格式化和斷開文本行的服務。</span><span class="sxs-lookup"><span data-stu-id="63af0-126"><xref:System.Windows.Media.TextFormatting.TextFormatter> is the WPF text formatting engine and provides services for formatting and breaking text lines.</span></span> <span data-ttu-id="63af0-127">文字格式子可處理不同的文字字元格式和段落樣式，且包含國際文字版面配置的支援。</span><span class="sxs-lookup"><span data-stu-id="63af0-127">The text formatter can handle different text character formats and paragraph styles, and includes support for international text layout.</span></span>  
  
 <span data-ttu-id="63af0-128">與傳統文本 API 不同，<xref:System.Windows.Media.TextFormatting.TextFormatter>通過一組回檔方法與文本佈局用戶端進行交互。</span><span class="sxs-lookup"><span data-stu-id="63af0-128">Unlike a traditional text API, the <xref:System.Windows.Media.TextFormatting.TextFormatter> interacts with a text layout client through a set of callback methods.</span></span> <span data-ttu-id="63af0-129">它要求用戶端在<xref:System.Windows.Media.TextFormatting.TextSource>類的實現中提供這些方法。</span><span class="sxs-lookup"><span data-stu-id="63af0-129">It requires the client to provide these methods in an implementation of the <xref:System.Windows.Media.TextFormatting.TextSource> class.</span></span> <span data-ttu-id="63af0-130">下圖說明瞭用戶端應用程式和<xref:System.Windows.Media.TextFormatting.TextFormatter>之間的文本佈局交互。</span><span class="sxs-lookup"><span data-stu-id="63af0-130">The following diagram illustrates the text layout interaction between the client application and <xref:System.Windows.Media.TextFormatting.TextFormatter>.</span></span>  
  
 ![文字配置用戶端和 TextFormatter 的圖表](./media/advanced-text-formatting/text-layout-textformatter-interaction.png)  
  
 <span data-ttu-id="63af0-132">文本格式化用於從文本存儲檢索格式化的文本行，文本存儲是 的<xref:System.Windows.Media.TextFormatting.TextSource>實現。</span><span class="sxs-lookup"><span data-stu-id="63af0-132">The text formatter is used to retrieve formatted text lines from the text store, which is an implementation of <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="63af0-133">這是首先使用 方法創建文本前物質的實例來實現的<xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A>。</span><span class="sxs-lookup"><span data-stu-id="63af0-133">This is done by first creating an instance of the text formatter by using the <xref:System.Windows.Media.TextFormatting.TextFormatter.Create%2A> method.</span></span> <span data-ttu-id="63af0-134">這個方法會建立文字格式子的執行個體，並設定最大線條高度和寬度的值。</span><span class="sxs-lookup"><span data-stu-id="63af0-134">This method creates an instance of the text formatter and sets the maximum line height and width values.</span></span> <span data-ttu-id="63af0-135">一旦創建了文本前物質的實例，行創建過程就會通過調用<xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>方法啟動。</span><span class="sxs-lookup"><span data-stu-id="63af0-135">As soon as an instance of the text formatter is created, the line creation process is started by calling the <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span> <span data-ttu-id="63af0-136"><xref:System.Windows.Media.TextFormatting.TextFormatter>調用回文本源以檢索構成行的文本運行的文本和格式參數。</span><span class="sxs-lookup"><span data-stu-id="63af0-136"><xref:System.Windows.Media.TextFormatting.TextFormatter> calls back to the text source to retrieve the text and formatting parameters for the runs of text that form a line.</span></span>  
  
 <span data-ttu-id="63af0-137">在下列範例中，會顯示格式設定文字存放區的程序。</span><span class="sxs-lookup"><span data-stu-id="63af0-137">In the following example, the process of formatting a text store is shown.</span></span> <span data-ttu-id="63af0-138">該<xref:System.Windows.Media.TextFormatting.TextFormatter>物件用於從文本存儲中檢索文本行，然後格式化文字行以繪製到 中<xref:System.Windows.Media.DrawingContext>。</span><span class="sxs-lookup"><span data-stu-id="63af0-138">The <xref:System.Windows.Media.TextFormatting.TextFormatter> object is used to retrieve text lines from the text store and then format the text line for drawing into the <xref:System.Windows.Media.DrawingContext>.</span></span>  
  
 [!code-csharp[TextFormatterExample#100](~/samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/Window1.xaml.cs#100)]
 [!code-vb[TextFormatterExample#100](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/Window1.xaml.vb#100)]  
  
<a name="section3"></a>
## <a name="implementing-the-client-text-store"></a><span data-ttu-id="63af0-139">實作用戶端文字存放區</span><span class="sxs-lookup"><span data-stu-id="63af0-139">Implementing the Client Text Store</span></span>  
 <span data-ttu-id="63af0-140">當您延伸文字格式設定引擎時，您必須實作與管理文字存放區的所有層面。</span><span class="sxs-lookup"><span data-stu-id="63af0-140">When you extend the text formatting engine, you are required to implement and manage all aspects of the text store.</span></span> <span data-ttu-id="63af0-141">這不是簡單的工作。</span><span class="sxs-lookup"><span data-stu-id="63af0-141">This is not a trivial task.</span></span> <span data-ttu-id="63af0-142">文字存放區負責追蹤文字執行屬性、段落屬性、內嵌的物件，以及其他類似的內容。</span><span class="sxs-lookup"><span data-stu-id="63af0-142">The text store is responsible for tracking text run properties, paragraph properties, embedded objects, and other similar content.</span></span> <span data-ttu-id="63af0-143">它還為文本前物質用於創建<xref:System.Windows.Media.TextFormatting.TextRun><xref:System.Windows.Media.TextFormatting.TextLine>物件的單個物件提供文本前身。</span><span class="sxs-lookup"><span data-stu-id="63af0-143">It also provides the text formatter with individual <xref:System.Windows.Media.TextFormatting.TextRun> objects which the text formatter uses to create <xref:System.Windows.Media.TextFormatting.TextLine> objects.</span></span>  
  
 <span data-ttu-id="63af0-144">要處理文本存儲的虛擬化，文本存儲必須派生自<xref:System.Windows.Media.TextFormatting.TextSource>。</span><span class="sxs-lookup"><span data-stu-id="63af0-144">To handle the virtualization of the text store, the text store must be derived from <xref:System.Windows.Media.TextFormatting.TextSource>.</span></span> <span data-ttu-id="63af0-145"><xref:System.Windows.Media.TextFormatting.TextSource>定義文本前物質用於檢索文本存儲中運行的文本的方法。</span><span class="sxs-lookup"><span data-stu-id="63af0-145"><xref:System.Windows.Media.TextFormatting.TextSource> defines the method the text formatter uses to retrieve text runs from the text store.</span></span> <span data-ttu-id="63af0-146"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>是文本格式化用於檢索行格式中使用的文本運行的方法。</span><span class="sxs-lookup"><span data-stu-id="63af0-146"><xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is the method used by the text formatter to retrieve text runs used in line formatting.</span></span> <span data-ttu-id="63af0-147">調用<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>由文本事件重複進行，直到出現以下情況之一：</span><span class="sxs-lookup"><span data-stu-id="63af0-147">The call to <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> is repeatedly made by the text formatter until one of the following conditions occurs:</span></span>  
  
- <span data-ttu-id="63af0-148">返回<xref:System.Windows.Media.TextFormatting.TextEndOfLine>a 或子類。</span><span class="sxs-lookup"><span data-stu-id="63af0-148">A <xref:System.Windows.Media.TextFormatting.TextEndOfLine> or a subclass is returned.</span></span>  
  
- <span data-ttu-id="63af0-149">文本運行的累積寬度超過調用中指定的最大行寬，以創建文本 formatter 或對文本 formatter 方法的<xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A>調用。</span><span class="sxs-lookup"><span data-stu-id="63af0-149">The accumulated width of text runs exceeds the maximum line width specified in either the call to create the text formatter or the call to the text formatter's <xref:System.Windows.Media.TextFormatting.TextFormatter.FormatLine%2A> method.</span></span>  
  
- <span data-ttu-id="63af0-150">返回 Unicode newline 序列，如"CF"、"LF"或"CRLF"。</span><span class="sxs-lookup"><span data-stu-id="63af0-150">A Unicode newline sequence, such as "CF", "LF", or "CRLF", is returned.</span></span>  
  
<a name="section4"></a>
## <a name="providing-text-runs"></a><span data-ttu-id="63af0-151">提供文字執行</span><span class="sxs-lookup"><span data-stu-id="63af0-151">Providing Text Runs</span></span>  
 <span data-ttu-id="63af0-152">文字格式設定程序的核心是文字格式子與文字存放區之間的互動。</span><span class="sxs-lookup"><span data-stu-id="63af0-152">The core of the text formatting process is the interaction between the text formatter and the text store.</span></span> <span data-ttu-id="63af0-153">的<xref:System.Windows.Media.TextFormatting.TextSource>實現為文本格式化提供了<xref:System.Windows.Media.TextFormatting.TextRun>物件和用於設置文本運行格式的屬性。</span><span class="sxs-lookup"><span data-stu-id="63af0-153">Your implementation of <xref:System.Windows.Media.TextFormatting.TextSource> provides the text formatter with the <xref:System.Windows.Media.TextFormatting.TextRun> objects and the properties with which to format the text runs.</span></span> <span data-ttu-id="63af0-154">此交互由<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>方法處理，該方法由文本前物質調用。</span><span class="sxs-lookup"><span data-stu-id="63af0-154">This interaction is handled by the <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method, which is called by the text formatter.</span></span>  
  
 <span data-ttu-id="63af0-155">下表顯示了一些預定義<xref:System.Windows.Media.TextFormatting.TextRun>物件。</span><span class="sxs-lookup"><span data-stu-id="63af0-155">The following table shows some of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects.</span></span>  
  
|<span data-ttu-id="63af0-156">TextRun 類型</span><span class="sxs-lookup"><span data-stu-id="63af0-156">TextRun Type</span></span>|<span data-ttu-id="63af0-157">使用量</span><span class="sxs-lookup"><span data-stu-id="63af0-157">Usage</span></span>|  
|------------------|-----------|  
|<xref:System.Windows.Media.TextFormatting.TextCharacters>|<span data-ttu-id="63af0-158">用來將字元圖像 (glyph) 的表示法傳回文字格式子的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="63af0-158">The specialized text run used to pass a representation of character glyphs back to the text formatter.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEmbeddedObject>|<span data-ttu-id="63af0-159">用來提供內容的特殊文字執行，在這些內容中會整體進行測量、點擊測試和繪製，例如文字內的按鈕或影像。</span><span class="sxs-lookup"><span data-stu-id="63af0-159">The specialized text run used to provide content in which measuring, hit testing, and drawing is done in whole, such as a button or image within the text.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfLine>|<span data-ttu-id="63af0-160">用來標記行尾的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="63af0-160">The specialized text run used to mark the end of a line.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>|<span data-ttu-id="63af0-161">用來標記段落結尾的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="63af0-161">The specialized text run used to mark the end of a paragraph.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>|<span data-ttu-id="63af0-162">用於標記段末尾的專用文本運行，例如結束受上一次<xref:System.Windows.Media.TextFormatting.TextModifier>運行影響的範圍。</span><span class="sxs-lookup"><span data-stu-id="63af0-162">The specialized text run used to mark the end of a segment, such as to end the scope affected by a previous <xref:System.Windows.Media.TextFormatting.TextModifier> run.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextHidden>|<span data-ttu-id="63af0-163">用來標記隱藏字元範圍的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="63af0-163">The specialized text run used to mark a range of hidden characters.</span></span>|  
|<xref:System.Windows.Media.TextFormatting.TextModifier>|<span data-ttu-id="63af0-164">用來在文字執行範圍中修改其屬性的特殊文字執行。</span><span class="sxs-lookup"><span data-stu-id="63af0-164">The specialized text run used to modify properties of text runs in its scope.</span></span> <span data-ttu-id="63af0-165">範圍擴展到下一個匹配<xref:System.Windows.Media.TextFormatting.TextEndOfSegment>的文本運行或下一個<xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>。</span><span class="sxs-lookup"><span data-stu-id="63af0-165">The scope extends to the next matching <xref:System.Windows.Media.TextFormatting.TextEndOfSegment> text run, or the next <xref:System.Windows.Media.TextFormatting.TextEndOfParagraph>.</span></span>|  
  
 <span data-ttu-id="63af0-166">可以對任何預定義<xref:System.Windows.Media.TextFormatting.TextRun>的物件進行子分類。</span><span class="sxs-lookup"><span data-stu-id="63af0-166">Any of the predefined <xref:System.Windows.Media.TextFormatting.TextRun> objects can be subclassed.</span></span> <span data-ttu-id="63af0-167">這可讓文字來源提供文字格式子包含自訂資料的文字執行。</span><span class="sxs-lookup"><span data-stu-id="63af0-167">This allows your text source to provide the text formatter with text runs that include custom data.</span></span>  
  
 <span data-ttu-id="63af0-168">下面的示例演示了一<xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A>種方法。</span><span class="sxs-lookup"><span data-stu-id="63af0-168">The following example demonstrates a <xref:System.Windows.Media.TextFormatting.TextSource.GetTextRun%2A> method.</span></span> <span data-ttu-id="63af0-169">此文本存儲將<xref:System.Windows.Media.TextFormatting.TextRun>物件返回到文本事件進行處理。</span><span class="sxs-lookup"><span data-stu-id="63af0-169">This text store returns <xref:System.Windows.Media.TextFormatting.TextRun> objects to the text formatter for processing.</span></span>  
  
 [!code-csharp[TextFormatterExample#101](~/samples/snippets/csharp/VS_Snippets_Wpf/TextFormatterExample/CSharp/CustomTextSource.cs#101)]
 [!code-vb[TextFormatterExample#101](~/samples/snippets/visualbasic/VS_Snippets_Wpf/TextFormatterExample/VisualBasic/CustomTextSource.vb#101)]  
  
> [!NOTE]
> <span data-ttu-id="63af0-170">在此範例中，文字存放區提供相同的文字屬性給所有文字。</span><span class="sxs-lookup"><span data-stu-id="63af0-170">In this example, the text store provides the same text properties to all of the text.</span></span> <span data-ttu-id="63af0-171">進階的文字存放區必須實作自己的範圍管理，以允許個別字元可以有不同的屬性。</span><span class="sxs-lookup"><span data-stu-id="63af0-171">Advanced text stores would need to implement their own span management to allow individual characters to have different properties.</span></span>  
  
<a name="section5"></a>
## <a name="specifying-formatting-properties"></a><span data-ttu-id="63af0-172">指定格式設定屬性</span><span class="sxs-lookup"><span data-stu-id="63af0-172">Specifying Formatting Properties</span></span>  
 <span data-ttu-id="63af0-173"><xref:System.Windows.Media.TextFormatting.TextRun>物件使用文本存儲提供的屬性進行格式化。</span><span class="sxs-lookup"><span data-stu-id="63af0-173"><xref:System.Windows.Media.TextFormatting.TextRun> objects are formatted by using properties provided by the text store.</span></span> <span data-ttu-id="63af0-174">這些屬性有兩種類型，<xref:System.Windows.Media.TextFormatting.TextParagraphProperties>和<xref:System.Windows.Media.TextFormatting.TextRunProperties>。</span><span class="sxs-lookup"><span data-stu-id="63af0-174">These properties come in two types, <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties>.</span></span> <span data-ttu-id="63af0-175"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties>處理段落包含屬性，如<xref:System.Windows.TextAlignment><xref:System.Windows.FlowDirection>和 。</span><span class="sxs-lookup"><span data-stu-id="63af0-175"><xref:System.Windows.Media.TextFormatting.TextParagraphProperties> handle paragraph inclusive properties such as <xref:System.Windows.TextAlignment> and <xref:System.Windows.FlowDirection>.</span></span> <span data-ttu-id="63af0-176"><xref:System.Windows.Media.TextFormatting.TextRunProperties>對於在段落中運行的每個文本（如前景畫筆和<xref:System.Windows.Media.Typeface>字體大小）可以不同的屬性。</span><span class="sxs-lookup"><span data-stu-id="63af0-176"><xref:System.Windows.Media.TextFormatting.TextRunProperties> are properties that can be different for each text run within a paragraph, such as foreground brush, <xref:System.Windows.Media.Typeface>, and font size.</span></span> <span data-ttu-id="63af0-177">要實現自訂段落和自訂文本運行屬性類型，應用程式必須創建派生自<xref:System.Windows.Media.TextFormatting.TextParagraphProperties>和<xref:System.Windows.Media.TextFormatting.TextRunProperties>派生的類。</span><span class="sxs-lookup"><span data-stu-id="63af0-177">To implement custom paragraph and custom text run property types, your application must create classes that derive from <xref:System.Windows.Media.TextFormatting.TextParagraphProperties> and <xref:System.Windows.Media.TextFormatting.TextRunProperties> respectively.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="63af0-178">另請參閱</span><span class="sxs-lookup"><span data-stu-id="63af0-178">See also</span></span>

- [<span data-ttu-id="63af0-179">WPF 中的印刷樣式</span><span class="sxs-lookup"><span data-stu-id="63af0-179">Typography in WPF</span></span>](typography-in-wpf.md)
- [<span data-ttu-id="63af0-180">WPF 中的文件</span><span class="sxs-lookup"><span data-stu-id="63af0-180">Documents in WPF</span></span>](documents-in-wpf.md)
