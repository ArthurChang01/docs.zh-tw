---
title: WPF 中的文件
ms.date: 03/30/2017
helpviewer_keywords:
- documents [WPF], packaging
- documents [WPF], text layout
- documents [WPF], XPS
- 'XPS documents [WPF], , '
- documents [WPF], controls
- documents [WPF], types of
- documents [WPF], browser-viewable
ms.assetid: 6e8db7bc-050a-4070-aa72-bb8c46e87ff8
ms.openlocfilehash: 9fac4e1a98f67c6d5d946ade1b7f2115ce0d5f8e
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/22/2019
ms.locfileid: "69964869"
---
# <a name="documents-in-wpf"></a><span data-ttu-id="0c68f-102">WPF 中的文件</span><span class="sxs-lookup"><span data-stu-id="0c68f-102">Documents in WPF</span></span>
[!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)]<span data-ttu-id="0c68f-103">提供廣泛的檔功能, 可讓您建立更容易存取和讀取的高精確度內容, 而不是在舊版的 Windows 中。</span><span class="sxs-lookup"><span data-stu-id="0c68f-103">offers a wide range of document features that enable the creation of high-fidelity content that is designed to be more easily accessed and read than in previous generations of Windows.</span></span> <span data-ttu-id="0c68f-104">除了增強功能和品質，[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 也針對文件顯示、封裝和安全性提供整合式服務。</span><span class="sxs-lookup"><span data-stu-id="0c68f-104">In addition to enhanced capabilities and quality, [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] also provides integrated services for document display, packaging, and security.</span></span> <span data-ttu-id="0c68f-105">本主題提供 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 文件類型和文件封裝的簡介。</span><span class="sxs-lookup"><span data-stu-id="0c68f-105">This topic provides an introduction to [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] document types and document packaging.</span></span>  

<a name="types_of_documents"></a>   
## <a name="types-of-documents"></a><span data-ttu-id="0c68f-106">文件的類型</span><span class="sxs-lookup"><span data-stu-id="0c68f-106">Types of Documents</span></span>  
 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="0c68f-107">根據文件的預期用途將文件分為兩大類，這兩種文件分類稱為「固定格式文件」與「非固定格式文件」。</span><span class="sxs-lookup"><span data-stu-id="0c68f-107">divides documents into two broad categories based on their intended use; these document categories are termed "fixed documents" and "flow documents."</span></span>  
  
 <span data-ttu-id="0c68f-108">固定格式文件適用於需要精確 [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)] 呈現方式的應用程式，與所使用的顯示器或印表機硬體無關。</span><span class="sxs-lookup"><span data-stu-id="0c68f-108">Fixed documents are intended for applications that require a precise [!INCLUDE[TLA#tla_wys](../../../../includes/tlasharptla-wys-md.md)] presentation, independent of the display or printer hardware used.</span></span> <span data-ttu-id="0c68f-109">固定格式文件一般用於桌上出版、文書處理和表單配置，必須嚴格遵循原始頁面設計。</span><span class="sxs-lookup"><span data-stu-id="0c68f-109">Typical uses for fixed documents include desktop publishing, word processing, and form layout, where adherence to the original page design is critical.</span></span> <span data-ttu-id="0c68f-110">固定格式文件會在其配置中維持內容項目的精確位置，不受使用中的顯示器或列印裝置影響。</span><span class="sxs-lookup"><span data-stu-id="0c68f-110">As part of its layout, a fixed document maintains the precise positional placement of content elements independent of the display or print device in use.</span></span> <span data-ttu-id="0c68f-111">例如，在 96 dpi 顯示器上檢視的固定格式文件頁面，不論是輸出到 600 dpi 雷射印表機或輸出到 4800 dpi 相紙輸出機，看起來都完全一樣。</span><span class="sxs-lookup"><span data-stu-id="0c68f-111">For example, a fixed document page viewed on 96 dpi display will appear exactly the same when it is output to a 600 dpi laser printer as when it is output to a 4800 dpi phototypesetter.</span></span> <span data-ttu-id="0c68f-112">文件品質會充分發揮各裝置的性能，但頁面配置永遠相同。</span><span class="sxs-lookup"><span data-stu-id="0c68f-112">The page layout remains the same in all cases, while the document quality maximizes to the capabilities of each device.</span></span>  
  
 <span data-ttu-id="0c68f-113">相較之下，非固定格式文件的設計用意是為了將檢視及可讀性最佳化；如果容易閱讀是主要的文件使用考量，則最適合使用非固定格式文件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-113">By comparison, flow documents are designed to optimize viewing and readability and are best utilized when ease of reading is the primary document consumption scenario.</span></span> <span data-ttu-id="0c68f-114">非固定格式文件並不會設為某種預先定義的配置，而是會根據執行階段變數 (例如視窗大小、裝置解析度和選擇性的使用者喜好設定)，動態調整及自動重排其內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-114">Rather than being set to one predefined layout, flow documents dynamically adjust and reflow their content based on run-time variables such as window size, device resolution, and optional user preferences.</span></span> <span data-ttu-id="0c68f-115">網頁即是一個簡單的非固定格式文件範例，其中的頁面內容會動態進行格式化，以符合目前視窗大小。</span><span class="sxs-lookup"><span data-stu-id="0c68f-115">A Web page is a simple example of a flow document where the page content is dynamically formatted to fit the current window.</span></span> <span data-ttu-id="0c68f-116">非固定格式文件會根據執行階段環境，讓使用者擁有最佳的檢視和閱讀體驗。</span><span class="sxs-lookup"><span data-stu-id="0c68f-116">Flow documents optimize the viewing and reading experience for the user, based on the runtime environment.</span></span> <span data-ttu-id="0c68f-117">例如，同一份非固定格式文件在高解析度 19 吋顯示器或小型 2x3 吋 PDA 螢幕上都會動態重新格式化，以獲得最佳可讀性。</span><span class="sxs-lookup"><span data-stu-id="0c68f-117">For example, the same flow document will dynamically reformat for optimal readability on either high-resolution 19-inch display or a small 2x3-inch PDA screen.</span></span> <span data-ttu-id="0c68f-118">此外，非固定格式文件具備許多內建功能，包括搜尋、將可讀性最佳化的檢視模式，以及變更字型大小與外觀的能力。</span><span class="sxs-lookup"><span data-stu-id="0c68f-118">In addition, flow documents have a number of built in features including search, viewing modes that optimize readability, and the ability to change the size and appearance of fonts.</span></span>  <span data-ttu-id="0c68f-119">如需非固定格式文件的說明、範例和深入資訊，請參閱[非固定格式文件概觀](flow-document-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="0c68f-119">See [Flow Document Overview](flow-document-overview.md) for illustrations, examples, and in-depth information on flow documents.</span></span>  
  
<a name="document_viewer"></a>   
## <a name="document-controls-and-text-layout"></a><span data-ttu-id="0c68f-120">文件控制項和文字配置</span><span class="sxs-lookup"><span data-stu-id="0c68f-120">Document Controls and Text Layout</span></span>  
 <span data-ttu-id="0c68f-121">.NET Framework 提供一組預先建立的控制項, 可簡化在您的應用程式中使用固定檔、非固定格式檔和一般文字。</span><span class="sxs-lookup"><span data-stu-id="0c68f-121">The .NET Framework provides a set of pre-built controls that simplify using fixed documents, flow documents, and general text within your application.</span></span>  <span data-ttu-id="0c68f-122">使用<xref:System.Windows.Controls.DocumentViewer>控制項可支援顯示固定的檔內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-122">The display of fixed document content is supported using the <xref:System.Windows.Controls.DocumentViewer> control.</span></span>  <span data-ttu-id="0c68f-123">顯示非固定格式檔內容是由三個不同的<xref:System.Windows.Controls.FlowDocumentReader>控制項<xref:System.Windows.Controls.FlowDocumentPageViewer>所支援<xref:System.Windows.Controls.FlowDocumentScrollViewer> :、和, 其對應至不同的使用者案例 (請參閱以下各節)。</span><span class="sxs-lookup"><span data-stu-id="0c68f-123">Display of flow document content is supported by three different controls: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer>, and <xref:System.Windows.Controls.FlowDocumentScrollViewer> which map to different user scenarios (see sections below).</span></span>  <span data-ttu-id="0c68f-124">其他 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 控制項提供簡化的配置，以支援一般文字用途 (請參閱下方的[使用者介面中的文字](#text_in_the_user_interface))。</span><span class="sxs-lookup"><span data-stu-id="0c68f-124">Other [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls provide simplified layout to support general text uses (see [Text in the User Interface](#text_in_the_user_interface), below).</span></span>  
  
### <a name="fixed-document-control---documentviewer"></a><span data-ttu-id="0c68f-125">固定格式文件控制項 - DocumentViewer</span><span class="sxs-lookup"><span data-stu-id="0c68f-125">Fixed Document Control - DocumentViewer</span></span>  
 <span data-ttu-id="0c68f-126">控制項<xref:System.Windows.Controls.DocumentViewer>的設計目的是要<xref:System.Windows.Documents.FixedDocument>顯示內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-126">The <xref:System.Windows.Controls.DocumentViewer> control is designed to display <xref:System.Windows.Documents.FixedDocument> content.</span></span> <span data-ttu-id="0c68f-127"><xref:System.Windows.Controls.DocumentViewer>控制項提供直覺的使用者介面, 可提供內建的支援, 包括列印輸出、複製到剪貼簿、縮放和文字搜尋功能。</span><span class="sxs-lookup"><span data-stu-id="0c68f-127">The <xref:System.Windows.Controls.DocumentViewer> control provides an intuitive user interface that provides built-in support for common operations including print output, copy to clipboard, zoom, and text search features.</span></span> <span data-ttu-id="0c68f-128">此控制項可透過常見的捲動機制，來存取多頁內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-128">The control provides access to pages of content through a familiar scrolling mechanism.</span></span> <span data-ttu-id="0c68f-129">就像[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]所有控制項<xref:System.Windows.Controls.DocumentViewer>一樣, 支援完整或部分 restyling, 可讓控制項視覺化地整合到幾乎任何應用程式或環境中。</span><span class="sxs-lookup"><span data-stu-id="0c68f-129">Like all [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] controls, <xref:System.Windows.Controls.DocumentViewer> supports complete or partial restyling, which enables the control to be visually integrated into virtually any application or environment.</span></span>  
  
 <span data-ttu-id="0c68f-130"><xref:System.Windows.Controls.DocumentViewer>的設計目的是要以唯讀方式顯示內容;內容的編輯或修改無法使用, 且不受支援。</span><span class="sxs-lookup"><span data-stu-id="0c68f-130"><xref:System.Windows.Controls.DocumentViewer> is designed to display content in a read-only manner; editing or modification of content is not available and is not supported.</span></span>  
  
<a name="flow_document"></a>   
### <a name="flow-document-controls"></a><span data-ttu-id="0c68f-131">非固定格式文件控制項</span><span class="sxs-lookup"><span data-stu-id="0c68f-131">Flow Document Controls</span></span>  

> [!NOTE]
> <span data-ttu-id="0c68f-132">如需非固定格式檔功能及其建立方式的詳細資訊, 請參閱非固定格式[檔總覽](flow-document-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="0c68f-132">For more detailed information on flow document features and how to create them, see [Flow Document Overview](flow-document-overview.md).</span></span>  
  
 <span data-ttu-id="0c68f-133">顯示非固定格式檔內容是由三個控制項<xref:System.Windows.Controls.FlowDocumentReader>所<xref:System.Windows.Controls.FlowDocumentPageViewer>支援: <xref:System.Windows.Controls.FlowDocumentScrollViewer>、和。</span><span class="sxs-lookup"><span data-stu-id="0c68f-133">Display of flow document content is supported by three controls: <xref:System.Windows.Controls.FlowDocumentReader>, <xref:System.Windows.Controls.FlowDocumentPageViewer>, and <xref:System.Windows.Controls.FlowDocumentScrollViewer>.</span></span>  
  
#### <a name="flowdocumentreader"></a><span data-ttu-id="0c68f-134">FlowDocumentReader</span><span class="sxs-lookup"><span data-stu-id="0c68f-134">FlowDocumentReader</span></span>  
 <span data-ttu-id="0c68f-135"><xref:System.Windows.Controls.FlowDocumentReader>包含的功能可讓使用者在各種不同的視圖模式之間進行動態選擇, 包括單頁 (一次一頁) 的瀏覽模式、兩頁的一次性 (書籍閱讀格式) 觀賞模式, 以及連續滾動 (無底邊) 查看模式。</span><span class="sxs-lookup"><span data-stu-id="0c68f-135"><xref:System.Windows.Controls.FlowDocumentReader> includes features that enable the user to dynamically choose between various viewing modes, including a single-page (page-at-a-time) viewing mode, a two-page-at-a-time (book reading format) viewing mode, and a continuous scrolling (bottomless) viewing mode.</span></span>  <span data-ttu-id="0c68f-136">如需這些查看模式的詳細資訊, <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>請參閱。</span><span class="sxs-lookup"><span data-stu-id="0c68f-136">For more information about these viewing modes, see <xref:System.Windows.Controls.FlowDocumentReaderViewingMode>.</span></span>  <span data-ttu-id="0c68f-137">如果您不需要在不同的視圖模式之間進行動態切換的功能<xref:System.Windows.Controls.FlowDocumentPageViewer> , <xref:System.Windows.Controls.FlowDocumentScrollViewer>並提供在特定的瀏覽模式中固定的較輕量流程內容檢視器。</span><span class="sxs-lookup"><span data-stu-id="0c68f-137">If you do not need the ability to dynamically switch between different viewing modes, <xref:System.Windows.Controls.FlowDocumentPageViewer> and <xref:System.Windows.Controls.FlowDocumentScrollViewer> provide lighter-weight flow content viewers that are fixed in a particular viewing mode.</span></span>  
  
#### <a name="flowdocumentpageviewer-and-flowdocumentscrollviewer"></a><span data-ttu-id="0c68f-138">FlowDocumentPageViewer 和 FlowDocumentScrollViewer</span><span class="sxs-lookup"><span data-stu-id="0c68f-138">FlowDocumentPageViewer and FlowDocumentScrollViewer</span></span>  
 <span data-ttu-id="0c68f-139"><xref:System.Windows.Controls.FlowDocumentPageViewer>在頁面一次的瀏覽模式中顯示內容, 同時<xref:System.Windows.Controls.FlowDocumentScrollViewer>以連續滾動模式顯示內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-139"><xref:System.Windows.Controls.FlowDocumentPageViewer> shows content in page-at-a-time viewing mode, while <xref:System.Windows.Controls.FlowDocumentScrollViewer> shows content in continuous scrolling mode.</span></span>  <span data-ttu-id="0c68f-140"><xref:System.Windows.Controls.FlowDocumentPageViewer> 和<xref:System.Windows.Controls.FlowDocumentScrollViewer>都固定于特定的瀏覽模式。</span><span class="sxs-lookup"><span data-stu-id="0c68f-140">Both <xref:System.Windows.Controls.FlowDocumentPageViewer> and <xref:System.Windows.Controls.FlowDocumentScrollViewer> are fixed to a particular viewing mode.</span></span> <span data-ttu-id="0c68f-141">相較<xref:System.Windows.Controls.FlowDocumentReader>于, 其中包含的功能可讓使用者在各種不同的瀏覽模式 (由列舉所<xref:System.Windows.Controls.FlowDocumentReaderViewingMode>提供) 之間進行動態選擇, 代價是比<xref:System.Windows.Controls.FlowDocumentPageViewer>或<xref:System.Windows.Controls.FlowDocumentScrollViewer>更耗費資源的成本。</span><span class="sxs-lookup"><span data-stu-id="0c68f-141">Compare to <xref:System.Windows.Controls.FlowDocumentReader>, which includes features that enable the user to dynamically choose between various viewing modes (as provided by the <xref:System.Windows.Controls.FlowDocumentReaderViewingMode> enumeration), at the cost of being more resource intensive than <xref:System.Windows.Controls.FlowDocumentPageViewer> or <xref:System.Windows.Controls.FlowDocumentScrollViewer>.</span></span>  
  
 <span data-ttu-id="0c68f-142">預設一定會顯示垂直捲軸，而水平捲動則會視需要顯示。</span><span class="sxs-lookup"><span data-stu-id="0c68f-142">By default, a vertical scrollbar is always shown, and a horizontal scrollbar becomes visible if needed.</span></span> <span data-ttu-id="0c68f-143">的預設[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]值<xref:System.Windows.Controls.FlowDocumentScrollViewer>不包含<xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A>工具列, 但是屬性可以用來啟用內建工具列。</span><span class="sxs-lookup"><span data-stu-id="0c68f-143">The default [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for <xref:System.Windows.Controls.FlowDocumentScrollViewer> does not include a toolbar; however, the <xref:System.Windows.Controls.FlowDocumentScrollViewer.IsToolBarVisible%2A> property can be used to enable a built-in toolbar.</span></span>  
  
<a name="text_in_the_user_interface"></a>   
### <a name="text-in-the-user-interface"></a><span data-ttu-id="0c68f-144">使用者介面中的文字</span><span class="sxs-lookup"><span data-stu-id="0c68f-144">Text in the User Interface</span></span>  
 <span data-ttu-id="0c68f-145">除了將文字新增至文件，您顯然也能在表單等應用程式 UI 中使用文字。</span><span class="sxs-lookup"><span data-stu-id="0c68f-145">Besides adding text to documents, text can obviously be used in application UI such as forms.</span></span> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] <span data-ttu-id="0c68f-146">包含多個將文字繪製到螢幕的控制項。</span><span class="sxs-lookup"><span data-stu-id="0c68f-146">includes multiple controls for drawing text to the screen.</span></span> <span data-ttu-id="0c68f-147">每個控制項都是不同案例的目標，且有自己的功能與限制清單。</span><span class="sxs-lookup"><span data-stu-id="0c68f-147">Each control is targeted to a different scenario and has its own list of features and limitations.</span></span> <span data-ttu-id="0c68f-148">一般而言, 需要有限<xref:System.Windows.Controls.TextBlock>的文字支援時 (例如[!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)]中的簡短句子), 應使用元素。</span><span class="sxs-lookup"><span data-stu-id="0c68f-148">In general, the <xref:System.Windows.Controls.TextBlock> element should be used when limited text support is required, such as a brief sentence in a [!INCLUDE[TLA#tla_ui](../../../../includes/tlasharptla-ui-md.md)].</span></span> <span data-ttu-id="0c68f-149"><xref:System.Windows.Controls.Label>當需要最少的文字支援時, 可以使用。</span><span class="sxs-lookup"><span data-stu-id="0c68f-149"><xref:System.Windows.Controls.Label> can be used when minimal text support is required.</span></span> <span data-ttu-id="0c68f-150">如需詳細資訊，請參閱 [TextBlock 概觀](../controls/textblock-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="0c68f-150">For more information, see [TextBlock Overview](../controls/textblock-overview.md).</span></span>  
  
<a name="packaging"></a>   
## <a name="document-packaging"></a><span data-ttu-id="0c68f-151">文件封裝</span><span class="sxs-lookup"><span data-stu-id="0c68f-151">Document Packaging</span></span>  
 <span data-ttu-id="0c68f-152"><xref:System.IO.Packaging> Api 提供有效率的方法, 在單一容器中組織應用程式資料、檔內容和相關資源, 這種方式可輕鬆存取、攜帶和輕鬆散發。</span><span class="sxs-lookup"><span data-stu-id="0c68f-152">The <xref:System.IO.Packaging> APIs provide an efficient means to organize application data, document content, and related resources in a single container that is simple to access, portable, and easy to distribute.</span></span> <span data-ttu-id="0c68f-153">ZIP 檔案是能夠將多個物件<xref:System.IO.Packaging.Package>當做單一單位來保存之類型的範例。</span><span class="sxs-lookup"><span data-stu-id="0c68f-153">A ZIP file is an example of a <xref:System.IO.Packaging.Package> type capable of holding multiple objects as a single unit.</span></span> <span data-ttu-id="0c68f-154">封裝 api 提供了使用開放式<xref:System.IO.Packaging.ZipPackage>封裝慣例標準搭配 XML 和 ZIP 檔案架構所設計的預設實體系。</span><span class="sxs-lookup"><span data-stu-id="0c68f-154">The packaging APIs provide a default <xref:System.IO.Packaging.ZipPackage> implementation designed using an Open Packaging Conventions standard with XML and ZIP file architecture.</span></span> <span data-ttu-id="0c68f-155">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]封裝 api 可讓您輕鬆建立封裝, 並在其中儲存和存取物件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-155">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] packaging APIs make it simple to create packages, and to store and access objects within them.</span></span> <span data-ttu-id="0c68f-156">儲存在中<xref:System.IO.Packaging.Package>的物件稱為<xref:System.IO.Packaging.PackagePart> (「元件」)。</span><span class="sxs-lookup"><span data-stu-id="0c68f-156">An object stored in a <xref:System.IO.Packaging.Package> is referred to as a <xref:System.IO.Packaging.PackagePart> ("part").</span></span> <span data-ttu-id="0c68f-157">封裝也可以包含簽署的數位憑證，該憑證可用來識別組件的建立者，以及驗證封裝內容是否未遭修改。</span><span class="sxs-lookup"><span data-stu-id="0c68f-157">Packages can also include signed digital certificates that can be used to identify the originator of a part and to validate that the contents of a package have not been modified.</span></span>  <span data-ttu-id="0c68f-158">套件也包含一<xref:System.IO.Packaging.PackageRelationship>項功能, 可讓您將其他資訊新增至封裝或與特定元件相關聯, 而不需要實際修改現有元件的內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-158">Packages also include a <xref:System.IO.Packaging.PackageRelationship> feature that allows additional information to be added to a package or associated with specific parts without actually modifying the content of existing parts.</span></span>  <span data-ttu-id="0c68f-159">封裝服務也支援 [!INCLUDE[TLA#tla_rm](../../../../includes/tlasharptla-rm-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="0c68f-159">Package services also support [!INCLUDE[TLA#tla_rm](../../../../includes/tlasharptla-rm-md.md)].</span></span>  
  
 <span data-ttu-id="0c68f-160">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 封裝架構是下列幾個重要技術的基礎：</span><span class="sxs-lookup"><span data-stu-id="0c68f-160">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] Package architecture serves as the foundation for a number of key technologies:</span></span>  
  
- <span data-ttu-id="0c68f-161">符合 [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] 的 [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] 文件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-161">[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] documents conforming to the [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)].</span></span>  
  
- <span data-ttu-id="0c68f-162">Microsoft Office "12" Open XML 格式文件 (.docx)。</span><span class="sxs-lookup"><span data-stu-id="0c68f-162">Microsoft Office "12" open XML format documents (.docx).</span></span>  
  
- <span data-ttu-id="0c68f-163">適用於您自己應用程式設計的自訂儲存格式。</span><span class="sxs-lookup"><span data-stu-id="0c68f-163">Custom storage formats for your own application design.</span></span>  
  
 <span data-ttu-id="0c68f-164">根據封裝 api, <xref:System.Windows.Xps.Packaging.XpsDocument>是特別設計來儲存[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]固定的內容檔。</span><span class="sxs-lookup"><span data-stu-id="0c68f-164">Based on the packaging APIs, an <xref:System.Windows.Xps.Packaging.XpsDocument> is specifically designed for storing [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] fixed content documents.</span></span> <span data-ttu-id="0c68f-165"><xref:System.Windows.Xps.Packaging.XpsDocument>是獨立的文件，可以在檢視器 中顯示開啟<xref:System.Windows.Controls.DocumentViewer>控制項來列印多工緩衝處理，路由或輸出直接[!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]-相容的印表機。</span><span class="sxs-lookup"><span data-stu-id="0c68f-165">An <xref:System.Windows.Xps.Packaging.XpsDocument> is a self-contained document that can be opened in a viewer, displayed in a <xref:System.Windows.Controls.DocumentViewer> control, routed to a print spool, or output directly to an [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]-compatible printer.</span></span>  
  
 <span data-ttu-id="0c68f-166">下列各節提供有關提供<xref:System.IO.Packaging.Package> [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]之和<xref:System.Windows.Xps.Packaging.XpsDocument> api 的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="0c68f-166">The following sections provide additional information on the <xref:System.IO.Packaging.Package> and <xref:System.Windows.Xps.Packaging.XpsDocument> APIs provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  
  
<a name="packages"></a>   
### <a name="package-components"></a><span data-ttu-id="0c68f-167">封裝元件</span><span class="sxs-lookup"><span data-stu-id="0c68f-167">Package Components</span></span>  
 <span data-ttu-id="0c68f-168">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 封裝 API 可將應用程式資料和文件組織成單一可攜式單位。</span><span class="sxs-lookup"><span data-stu-id="0c68f-168">The [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] packaging APIs allow application data and documents to be organized into a single portable unit.</span></span> <span data-ttu-id="0c68f-169">ZIP 檔案就是其中一種最常見的封裝類型，而且是 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 隨附的預設封裝類型。</span><span class="sxs-lookup"><span data-stu-id="0c68f-169">A ZIP file is one of the most common types of packages and is the default package type provided with [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)].</span></span>  <span data-ttu-id="0c68f-170"><xref:System.IO.Packaging.Package>本身是抽象類別, 使用開放式<xref:System.IO.Packaging.ZipPackage>標準 XML 和 ZIP 檔案架構來執行。</span><span class="sxs-lookup"><span data-stu-id="0c68f-170"><xref:System.IO.Packaging.Package> itself is an abstract class from which <xref:System.IO.Packaging.ZipPackage> is implemented using an open standard XML and ZIP file architecture.</span></span>  <span data-ttu-id="0c68f-171">根據預設, <xref:System.IO.Packaging.ZipPackage>方法會使用來建立和使用 ZIP 檔案。 <xref:System.IO.Packaging.Package.Open%2A></span><span class="sxs-lookup"><span data-stu-id="0c68f-171">The <xref:System.IO.Packaging.Package.Open%2A> method uses <xref:System.IO.Packaging.ZipPackage> to create and use ZIP files by default.</span></span> <span data-ttu-id="0c68f-172">一個封裝可以包含三種基本項目類型：</span><span class="sxs-lookup"><span data-stu-id="0c68f-172">A package can contain three basic types of items:</span></span>  
  
|||  
|-|-|  
|<xref:System.IO.Packaging.PackagePart>|<span data-ttu-id="0c68f-173">應用程式內容、資料、文件和資源檔。</span><span class="sxs-lookup"><span data-stu-id="0c68f-173">Application content, data, documents, and resource files.</span></span>|  
|<xref:System.IO.Packaging.PackageDigitalSignature>|<span data-ttu-id="0c68f-174">用於識別、驗證 (Authentication 和 Validation) 的 [X.509 憑證]。</span><span class="sxs-lookup"><span data-stu-id="0c68f-174">[X.509 Certificate] for identification, authentication and validation.</span></span>|  
|<xref:System.IO.Packaging.PackageRelationship>|<span data-ttu-id="0c68f-175">與封裝或特定組件相關的新增資訊。</span><span class="sxs-lookup"><span data-stu-id="0c68f-175">Added information related to the package or a specific part.</span></span>|  
  
<a name="PackageParts"></a>   
#### <a name="packageparts"></a><span data-ttu-id="0c68f-176">PackageParts</span><span class="sxs-lookup"><span data-stu-id="0c68f-176">PackageParts</span></span>  
 <span data-ttu-id="0c68f-177">A <xref:System.IO.Packaging.PackagePart> ("part") 是參考儲存<xref:System.IO.Packaging.Package>在中之物件的抽象類別。</span><span class="sxs-lookup"><span data-stu-id="0c68f-177">A <xref:System.IO.Packaging.PackagePart> ("part") is an abstract class that refers to an object stored in a <xref:System.IO.Packaging.Package>.</span></span> <span data-ttu-id="0c68f-178">在 ZIP 檔案中，封裝組件會對應至儲存在 ZIP 檔案中的個別檔案。</span><span class="sxs-lookup"><span data-stu-id="0c68f-178">In a ZIP file, the package parts correspond to the individual files stored within the ZIP file.</span></span>  <span data-ttu-id="0c68f-179"><xref:System.IO.Packaging.ZipPackagePart>提供儲存在中<xref:System.IO.Packaging.ZipPackage>之 serializable 物件的預設執行。</span><span class="sxs-lookup"><span data-stu-id="0c68f-179"><xref:System.IO.Packaging.ZipPackagePart> provides the default implementation for serializable objects stored in a <xref:System.IO.Packaging.ZipPackage>.</span></span>  <span data-ttu-id="0c68f-180">就像檔案系統，封裝中包含的組件會儲存在階層式目錄或「資料夾樣式」的組織中。</span><span class="sxs-lookup"><span data-stu-id="0c68f-180">Like a file system, parts contained in the package are stored in hierarchical directory or "folder-style" organization.</span></span>  <span data-ttu-id="0c68f-181">使用封裝 api, 應用程式可以使用單一 ZIP 檔案容器來撰寫<xref:System.IO.Packaging.PackagePart> 、儲存和讀取多個物件。 [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]</span><span class="sxs-lookup"><span data-stu-id="0c68f-181">Using the [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] packaging APIs, applications can write, store, and read multiple <xref:System.IO.Packaging.PackagePart> objects using a single ZIP file container.</span></span>  
  
<a name="PackageDigitalSignatures"></a>   
#### <a name="packagedigitalsignatures"></a><span data-ttu-id="0c68f-182">PackageDigitalSignatures</span><span class="sxs-lookup"><span data-stu-id="0c68f-182">PackageDigitalSignatures</span></span>  
 <span data-ttu-id="0c68f-183">基於安全性, <xref:System.IO.Packaging.PackageDigitalSignature>可以將 (「數位簽章」) 與封裝內的元件產生關聯。</span><span class="sxs-lookup"><span data-stu-id="0c68f-183">For security, a <xref:System.IO.Packaging.PackageDigitalSignature> ("digital signature") can be associated with parts within a package.</span></span> <span data-ttu-id="0c68f-184">會<xref:System.IO.Packaging.PackageDigitalSignature>合併提供兩個功能的 [509]:</span><span class="sxs-lookup"><span data-stu-id="0c68f-184">A <xref:System.IO.Packaging.PackageDigitalSignature> incorporates a [509] that provides two features:</span></span>  
  
1. <span data-ttu-id="0c68f-185">識別並驗證組件的建立者。</span><span class="sxs-lookup"><span data-stu-id="0c68f-185">Identifies and authenticates the originator of the part.</span></span>  
  
2. <span data-ttu-id="0c68f-186">驗證組件未遭修改。</span><span class="sxs-lookup"><span data-stu-id="0c68f-186">Validates that the part has not been modified.</span></span>  
  
 <span data-ttu-id="0c68f-187">數位簽章不會防止組件遭到修改，但如果組件有任何改變，對於數位簽章的驗證檢查就會失敗。</span><span class="sxs-lookup"><span data-stu-id="0c68f-187">The digital signature does not preclude a part from being modified, but a validation check against the digital signature will fail if the part is altered in any way.</span></span> <span data-ttu-id="0c68f-188">應用程式可以做出一些適當的回應，像是防止開啟組件，或通知使用者該組件已遭修改，因此並不安全。</span><span class="sxs-lookup"><span data-stu-id="0c68f-188">The application can then take appropriate action—for example, block opening the part or notify the user that the part has been modified and is not secure.</span></span>  
  
<a name="PackageRelationships"></a>   
#### <a name="packagerelationships"></a><span data-ttu-id="0c68f-189">PackageRelationships</span><span class="sxs-lookup"><span data-stu-id="0c68f-189">PackageRelationships</span></span>  
 <span data-ttu-id="0c68f-190">A <xref:System.IO.Packaging.PackageRelationship> (「關聯性」) 提供了一種機制, 可讓其他資訊與封裝或封裝內的元件產生關聯。</span><span class="sxs-lookup"><span data-stu-id="0c68f-190">A <xref:System.IO.Packaging.PackageRelationship> ("relationship") provides a mechanism for associating additional information with the package or a part within the package.</span></span> <span data-ttu-id="0c68f-191">關聯性是封裝層級功能，可將其他資訊與組件產生關聯，而不需要修改實際組件內容。</span><span class="sxs-lookup"><span data-stu-id="0c68f-191">A relationship is a package-level facility that can associate additional information with a part without modifying the actual part content.</span></span> <span data-ttu-id="0c68f-192">直接將新資料插入組件內容，在許多情況下通常並不可行：</span><span class="sxs-lookup"><span data-stu-id="0c68f-192">Inserting new data directly into the part content of is usually not practical in many cases:</span></span>  
  
- <span data-ttu-id="0c68f-193">不知道組件及其內容結構描述的實際類型。</span><span class="sxs-lookup"><span data-stu-id="0c68f-193">The actual type of the part and its content schema is not known.</span></span>  
  
- <span data-ttu-id="0c68f-194">即使知道，內容結構描述也可能不會提供新增資訊的方法。</span><span class="sxs-lookup"><span data-stu-id="0c68f-194">Even if known, the content schema might not provide a means for adding new information.</span></span>  
  
- <span data-ttu-id="0c68f-195">組件可能會進行數位簽署或加密，以免遭到任何修改。</span><span class="sxs-lookup"><span data-stu-id="0c68f-195">The part might be digitally signed or encrypted, precluding any modification.</span></span>  
  
 <span data-ttu-id="0c68f-196">封裝關聯性提供一個顯而易見的方法，來新增其他資訊，並將此資訊與個別組件或整個封裝產生關聯。</span><span class="sxs-lookup"><span data-stu-id="0c68f-196">Package relationships provide a discoverable means for adding and associating additional information with individual parts or with the entire package.</span></span> <span data-ttu-id="0c68f-197">封裝關聯性可用於兩項主要功能：</span><span class="sxs-lookup"><span data-stu-id="0c68f-197">Package relationships are used for two primary functions:</span></span>  
  
1. <span data-ttu-id="0c68f-198">定義某個組件與另一個組件的相依性關聯性。</span><span class="sxs-lookup"><span data-stu-id="0c68f-198">Defining dependency relationships from one part to another part.</span></span>  
  
2. <span data-ttu-id="0c68f-199">定義新增附註或組件之其他相關資料的資訊關聯性。</span><span class="sxs-lookup"><span data-stu-id="0c68f-199">Defining information relationships that add notes or other data related to the part.</span></span>  
  
 <span data-ttu-id="0c68f-200"><xref:System.IO.Packaging.PackageRelationship>提供快速且可探索的方法來定義相依性, 並加入與封裝或整個封裝相關聯的其他資訊。</span><span class="sxs-lookup"><span data-stu-id="0c68f-200">A <xref:System.IO.Packaging.PackageRelationship> provides a quick, discoverable means to define dependencies and add other information associated with a part of the package or the package as a whole.</span></span>  
  
<a name="Dependency_Relationships"></a>   
##### <a name="dependency-relationships"></a><span data-ttu-id="0c68f-201">相依性關聯性</span><span class="sxs-lookup"><span data-stu-id="0c68f-201">Dependency Relationships</span></span>  
 <span data-ttu-id="0c68f-202">相依性關聯性可用來描述某個組件與其他組件的相依性。</span><span class="sxs-lookup"><span data-stu-id="0c68f-202">Dependency relationships are used to describe dependencies that one part makes to other parts.</span></span> <span data-ttu-id="0c68f-203">例如，一個封裝可能包含具有一或多個 \<img> 影像標記的 HTML 組件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-203">For example, a package might contain an HTML part that includes one or more \<img> image tags.</span></span> <span data-ttu-id="0c68f-204">影像標記所參考的影像，就是位於封裝內部或外部 (例如可透過網際網路存取) 的其他組件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-204">The image tags refer to images that are located either as other parts internal to the package or external to the package (such as accessible over the Internet).</span></span> <span data-ttu-id="0c68f-205">建立與<xref:System.IO.Packaging.PackageRelationship> HTML 檔案相關聯的, 可讓您快速輕鬆地探索和存取相依的資源。</span><span class="sxs-lookup"><span data-stu-id="0c68f-205">Creating a <xref:System.IO.Packaging.PackageRelationship> associated with HTML file makes discovering and accessing the dependent resources quick and easy.</span></span> <span data-ttu-id="0c68f-206">瀏覽器或檢視器應用程式可以直接存取組件關聯性，並立即開始組合相依資源，而不需要知道結構描述或剖析文件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-206">A browser or viewer application can directly access the part relationships and immediately begin assembling the dependent resources without knowing the schema or parsing the document.</span></span>  
  
<a name="Information_Relationships"></a>   
##### <a name="information-relationships"></a><span data-ttu-id="0c68f-207">資訊關聯性</span><span class="sxs-lookup"><span data-stu-id="0c68f-207">Information Relationships</span></span>  
 <span data-ttu-id="0c68f-208">類似于便箋或批註, 也<xref:System.IO.Packaging.PackageRelationship>可以用來儲存其他類型的資訊, 使其與元件相關聯, 而不需要實際修改元件內容本身。</span><span class="sxs-lookup"><span data-stu-id="0c68f-208">Similar to a note or annotation, a <xref:System.IO.Packaging.PackageRelationship> can also be used to store other types of information to be associated with a part without having to actually modify the part content itself.</span></span>  
  
<a name="XPS_Documents"></a>   
## <a name="xps-documents"></a><span data-ttu-id="0c68f-209">XPS 文件</span><span class="sxs-lookup"><span data-stu-id="0c68f-209">XPS Documents</span></span>  
 [!INCLUDE[TLA#tla_xps](../../../../includes/tlasharptla-xps-md.md)] <span data-ttu-id="0c68f-210">文件是一種封裝，其中包含一或多份固定格式文件，以及進行呈現所需的所有資源和資訊。</span><span class="sxs-lookup"><span data-stu-id="0c68f-210">document is a package that contains one or more fixed-documents along with all the resources and information required for rendering.</span></span>  [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] <span data-ttu-id="0c68f-211">也是原生 [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] 列印多工緩衝檔案格式。</span><span class="sxs-lookup"><span data-stu-id="0c68f-211">is also the native [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] print spool file format.</span></span>  <span data-ttu-id="0c68f-212"><xref:System.Windows.Xps.Packaging.XpsDocument>會儲存在標準 ZIP 資料集中, 而且可以包含 XML 和二進位元件的組合, 例如影像和字型檔案。</span><span class="sxs-lookup"><span data-stu-id="0c68f-212">An <xref:System.Windows.Xps.Packaging.XpsDocument> is stored in standard ZIP dataset, and can include a combination of XML and binary components, such as image and font files.</span></span> <span data-ttu-id="0c68f-213">[PackageRelationships](#PackageRelationships) 可用來定義完整呈現文件所需的內容和資源之間的相依性。</span><span class="sxs-lookup"><span data-stu-id="0c68f-213">[PackageRelationships](#PackageRelationships) are used to define the dependencies between the content and the resources required to fully render the document.</span></span>  <span data-ttu-id="0c68f-214">此<xref:System.Windows.Xps.Packaging.XpsDocument>設計提供單一、高精確度的檔解決方案, 可支援多個用途:</span><span class="sxs-lookup"><span data-stu-id="0c68f-214">The <xref:System.Windows.Xps.Packaging.XpsDocument> design provides a single, high-fidelity document solution that supports multiple uses:</span></span>  
  
- <span data-ttu-id="0c68f-215">將固定格式文件內容和資源當做單一可攜式且容易散發的檔案，進行讀取、寫入及儲存。</span><span class="sxs-lookup"><span data-stu-id="0c68f-215">Reading, writing, and storing fixed-document content and resources as a single, portable, and easy-to-distribute file.</span></span>  
  
- <span data-ttu-id="0c68f-216">使用 [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] 檢視器應用程式顯示文件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-216">Displaying documents with the [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] Viewer application.</span></span>  
  
- <span data-ttu-id="0c68f-217">以 [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)] 的原生列印多工緩衝處理輸出格式來輸出文件。</span><span class="sxs-lookup"><span data-stu-id="0c68f-217">Outputting documents in the native print spool output format of [!INCLUDE[TLA#tla_winvista](../../../../includes/tlasharptla-winvista-md.md)].</span></span>  
  
- <span data-ttu-id="0c68f-218">將文件直接路由傳送至 [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)] 相容的印表機。</span><span class="sxs-lookup"><span data-stu-id="0c68f-218">Routing documents directly to an [!INCLUDE[TLA2#tla_xps](../../../../includes/tla2sharptla-xps-md.md)]-compatible printer.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="0c68f-219">另請參閱</span><span class="sxs-lookup"><span data-stu-id="0c68f-219">See also</span></span>

- <xref:System.Windows.Documents.FixedDocument>
- <xref:System.Windows.Documents.FlowDocument>
- <xref:System.Windows.Xps.Packaging.XpsDocument>
- <xref:System.IO.Packaging.ZipPackage>
- <xref:System.IO.Packaging.ZipPackagePart>
- <xref:System.IO.Packaging.PackageRelationship>
- <xref:System.Windows.Controls.DocumentViewer>
- [<span data-ttu-id="0c68f-220">Text</span><span class="sxs-lookup"><span data-stu-id="0c68f-220">Text</span></span>](optimizing-performance-text.md)
- [<span data-ttu-id="0c68f-221">非固定格式文件概觀</span><span class="sxs-lookup"><span data-stu-id="0c68f-221">Flow Document Overview</span></span>](flow-document-overview.md)
- [<span data-ttu-id="0c68f-222">列印概觀</span><span class="sxs-lookup"><span data-stu-id="0c68f-222">Printing Overview</span></span>](printing-overview.md)
- [<span data-ttu-id="0c68f-223">文件序列化與儲存</span><span class="sxs-lookup"><span data-stu-id="0c68f-223">Document Serialization and Storage</span></span>](document-serialization-and-storage.md)
