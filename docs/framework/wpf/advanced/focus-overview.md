---
title: 焦點概觀
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- applications [WPF], focus
- focus in applications [WPF]
ms.assetid: 0230c4eb-0c8a-462b-ac4b-ae3e511659f4
ms.openlocfilehash: 620839a0060469604d0affa6637c3cafac0f62c2
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33548106"
---
# <a name="focus-overview"></a><span data-ttu-id="d5f34-102">焦點概觀</span><span class="sxs-lookup"><span data-stu-id="d5f34-102">Focus Overview</span></span>
<span data-ttu-id="d5f34-103">[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] 中有兩個關於焦點的主要概念︰鍵盤焦點和邏輯焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-103">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] there are two main concepts that pertain to focus: keyboard focus and logical focus.</span></span>  <span data-ttu-id="d5f34-104">鍵盤焦點是指接收鍵盤輸入的項目，邏輯焦點是指焦點範圍中具有焦點的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-104">Keyboard focus refers to the element that receives keyboard input and logical focus refers to the element in a focus scope that has focus.</span></span>  <span data-ttu-id="d5f34-105">本概觀會詳細討論這些概念。</span><span class="sxs-lookup"><span data-stu-id="d5f34-105">These concepts are discussed in detail in this overview.</span></span>  <span data-ttu-id="d5f34-106">了解這些概念的差異對建立複雜的應用程式很重要，這些應用程式有多個可取得焦點的區域。</span><span class="sxs-lookup"><span data-stu-id="d5f34-106">Understanding the difference in these concepts is important for creating complex applications that have multiple regions where focus can be obtained.</span></span>  
  
 <span data-ttu-id="d5f34-107">參與焦點管理的主要類別是<xref:System.Windows.Input.Keyboard>類別<xref:System.Windows.Input.FocusManager>類別和基底的項目類別，例如<xref:System.Windows.UIElement>和<xref:System.Windows.ContentElement>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-107">The major classes that participate in focus management are the <xref:System.Windows.Input.Keyboard> class, the <xref:System.Windows.Input.FocusManager> class, and the base element classes, such as <xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement>.</span></span>  <span data-ttu-id="d5f34-108">如需基底項目的詳細資訊，請參閱[基底項目概觀](../../../../docs/framework/wpf/advanced/base-elements-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="d5f34-108">For more information about the base elements, see the [Base Elements Overview](../../../../docs/framework/wpf/advanced/base-elements-overview.md).</span></span>  
  
 <span data-ttu-id="d5f34-109"><xref:System.Windows.Input.Keyboard>類別主要有關鍵盤焦點，<xref:System.Windows.Input.FocusManager>是著重於邏輯焦點，但這不是絕對的差異。</span><span class="sxs-lookup"><span data-stu-id="d5f34-109">The <xref:System.Windows.Input.Keyboard> class is concerned primarily with keyboard focus and the <xref:System.Windows.Input.FocusManager> is concerned primarily with logical focus, but this is not an absolute distinction.</span></span>  <span data-ttu-id="d5f34-110">具有鍵盤焦點的項目也會有邏輯焦點，但具有邏輯焦點的項目不一定有鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-110">An element that has keyboard focus will also have logical focus, but an element that has logical focus does not necessarily have keyboard focus.</span></span>  <span data-ttu-id="d5f34-111">當您使用時，這會出現<xref:System.Windows.Input.Keyboard>類別來設定的項目具有鍵盤焦點，它也會設定邏輯焦點在項目上。</span><span class="sxs-lookup"><span data-stu-id="d5f34-111">This is apparent when you use the <xref:System.Windows.Input.Keyboard> class to set the element that has keyboard focus, for it also sets logical focus on the element.</span></span>  
  

  
<a name="Keyboard_Focus"></a>   
## <a name="keyboard-focus"></a><span data-ttu-id="d5f34-112">鍵盤焦點</span><span class="sxs-lookup"><span data-stu-id="d5f34-112">Keyboard Focus</span></span>  
 <span data-ttu-id="d5f34-113">鍵盤焦點是指目前接收鍵盤輸入的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-113">Keyboard focus refers to the element that is currently receiving keyboard input.</span></span>  <span data-ttu-id="d5f34-114">整個桌面只能有一個項目有鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-114">There can be only one element on the whole desktop that has keyboard focus.</span></span>  <span data-ttu-id="d5f34-115">在[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]，具有鍵盤焦點的項目會有<xref:System.Windows.IInputElement.IsKeyboardFocused%2A>設`true`。</span><span class="sxs-lookup"><span data-stu-id="d5f34-115">In [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)], the element that has keyboard focus will have <xref:System.Windows.IInputElement.IsKeyboardFocused%2A> set to `true`.</span></span>  <span data-ttu-id="d5f34-116">靜態屬性<xref:System.Windows.Input.Keyboard.FocusedElement%2A>上<xref:System.Windows.Input.Keyboard>類別，取得目前具有鍵盤焦點的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-116">The static property <xref:System.Windows.Input.Keyboard.FocusedElement%2A> on the <xref:System.Windows.Input.Keyboard> class gets the element that currently has keyboard focus.</span></span>  
  
 <span data-ttu-id="d5f34-117">若要取得鍵盤焦點的項目順序<xref:System.Windows.UIElement.Focusable%2A>和<xref:System.Windows.UIElement.IsVisible%2A>基底的項目上的屬性必須設為`true`。</span><span class="sxs-lookup"><span data-stu-id="d5f34-117">In order for an element to obtain keyboard focus, the <xref:System.Windows.UIElement.Focusable%2A> and the <xref:System.Windows.UIElement.IsVisible%2A> properties on the base elements must be set to `true`.</span></span>  <span data-ttu-id="d5f34-118">部分類別，例如<xref:System.Windows.Controls.Panel>基底類別，具有<xref:System.Windows.UIElement.Focusable%2A>設`false`根據預設值; 因此，您必須設定<xref:System.Windows.UIElement.Focusable%2A>至`true`如果您想要能夠取得鍵盤焦點的這類項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-118">Some classes, such as the <xref:System.Windows.Controls.Panel> base class, have <xref:System.Windows.UIElement.Focusable%2A> set to `false` by default; therefore, you must set <xref:System.Windows.UIElement.Focusable%2A> to `true` if you want such an element to be able to obtain keyboard focus.</span></span>  
  
 <span data-ttu-id="d5f34-119">鍵盤焦點可以透過使用者與 [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] 的互動取得，例如項目的定位處理，或以滑鼠按一下某些項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-119">Keyboard focus can be obtained through user interaction with the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], such as tabbing to an element or clicking the mouse on certain elements.</span></span>  <span data-ttu-id="d5f34-120">鍵盤焦點，還可以取得以程式設計方式使用<xref:System.Windows.Input.Keyboard.Focus%2A>方法<xref:System.Windows.Input.Keyboard>類別。</span><span class="sxs-lookup"><span data-stu-id="d5f34-120">Keyboard focus can also be obtained programmatically by using the <xref:System.Windows.Input.Keyboard.Focus%2A> method on the <xref:System.Windows.Input.Keyboard> class.</span></span>  <span data-ttu-id="d5f34-121"><xref:System.Windows.Input.Keyboard.Focus%2A>方法會嘗試以提供指定的項目鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-121">The <xref:System.Windows.Input.Keyboard.Focus%2A> method attempts to give the specified element keyboard focus.</span></span>  <span data-ttu-id="d5f34-122">傳回的項目是具有鍵盤焦點的項目，如果舊或新的焦點物件封鎖要求，這可能是不同於要求的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-122">The returned element is the element that has keyboard focus, which might be a different element than requested if either the old or new focus object block the request.</span></span>  
  
 <span data-ttu-id="d5f34-123">下列範例會使用<xref:System.Windows.Input.Keyboard.Focus%2A>方法上設定鍵盤焦點<xref:System.Windows.Controls.Button>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-123">The following example uses the <xref:System.Windows.Input.Keyboard.Focus%2A> method to set keyboard focus on a <xref:System.Windows.Controls.Button>.</span></span>  
  
 [!code-csharp[focussample#FocusSampleSetFocus](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FocusSample/CSharp/Window1.xaml.cs#focussamplesetfocus)]
 [!code-vb[focussample#FocusSampleSetFocus](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSample/visualbasic/window1.xaml.vb#focussamplesetfocus)]  
  
 <span data-ttu-id="d5f34-124"><xref:System.Windows.UIElement.IsKeyboardFocused%2A>基底項目類別上的屬性會取得值，指出項目是否具有鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-124">The <xref:System.Windows.UIElement.IsKeyboardFocused%2A> property on the base element classes gets a value indicating whether the element has keyboard focus.</span></span>  <span data-ttu-id="d5f34-125"><xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A>基底項目類別上的屬性會取得值，指出是否在項目，或其中一個 visual 其子項目具有鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-125">The <xref:System.Windows.UIElement.IsKeyboardFocusWithin%2A> property on the base element classes gets a value indicating whether the element or any one of its visual child elements has keyboard focus.</span></span>  
  
 <span data-ttu-id="d5f34-126">當初始焦點設定在應用程式啟動時，要接收焦點的項目必須在初始載入應用程式視窗的視覺化樹狀結構和元素必須有<xref:System.Windows.UIElement.Focusable%2A>和<xref:System.Windows.UIElement.IsVisible%2A>設`true`。</span><span class="sxs-lookup"><span data-stu-id="d5f34-126">When setting initial focus at application startup, the element to receive focus must be in the visual tree of the initial window loaded by the application, and the element must have <xref:System.Windows.UIElement.Focusable%2A> and <xref:System.Windows.UIElement.IsVisible%2A> set to `true`.</span></span>  <span data-ttu-id="d5f34-127">建議設定初始焦點是在<xref:System.Windows.FrameworkElement.Loaded>事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="d5f34-127">The recommended place to set initial focus is in the <xref:System.Windows.FrameworkElement.Loaded> event handler.</span></span>  <span data-ttu-id="d5f34-128">A<xref:System.Windows.Threading.Dispatcher>回呼也可以藉由呼叫用<xref:System.Windows.Threading.Dispatcher.Invoke%2A>或<xref:System.Windows.Threading.Dispatcher.BeginInvoke%2A>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-128">A <xref:System.Windows.Threading.Dispatcher> callback can also be used by calling <xref:System.Windows.Threading.Dispatcher.Invoke%2A> or <xref:System.Windows.Threading.Dispatcher.BeginInvoke%2A>.</span></span>  
  
<a name="Logical_Focus"></a>   
## <a name="logical-focus"></a><span data-ttu-id="d5f34-129">邏輯焦點</span><span class="sxs-lookup"><span data-stu-id="d5f34-129">Logical Focus</span></span>  
 <span data-ttu-id="d5f34-130">邏輯焦點是指<xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType>焦點領域中。</span><span class="sxs-lookup"><span data-stu-id="d5f34-130">Logical focus refers to the <xref:System.Windows.Input.FocusManager.FocusedElement%2A?displayProperty=nameWithType> in a focus scope.</span></span>  <span data-ttu-id="d5f34-131">焦點範圍則是項目，可追蹤的<xref:System.Windows.Input.FocusManager.FocusedElement%2A>其範圍內。</span><span class="sxs-lookup"><span data-stu-id="d5f34-131">A focus scope is an element that keeps track of the <xref:System.Windows.Input.FocusManager.FocusedElement%2A> within its scope.</span></span>  <span data-ttu-id="d5f34-132">當鍵盤焦點離開焦點範圍時，焦點項目就會失去鍵盤焦點，但卻仍然保有邏輯焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-132">When keyboard focus leaves a focus scope, the focused element will lose keyboard focus but will retain logical focus.</span></span>  <span data-ttu-id="d5f34-133">當鍵盤焦點回到焦點範圍時，焦點項目就會取得鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-133">When keyboard focus returns to the focus scope, the focused element will obtain keyboard focus.</span></span>  <span data-ttu-id="d5f34-134">這讓鍵盤焦點能在多個焦點範圍間變更，但確保當焦點回到集點範圍內時，焦點範圍內的焦點項目會重新取得鍵盤焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-134">This allows for keyboard focus to be changed between multiple focus scopes but ensures that the focused element in the focus scope regains keyboard focus when focus returns to the focus scope.</span></span>  
  
 <span data-ttu-id="d5f34-135">應用程式中可以有多個具有邏輯焦點的項目，但特定的焦點範圍中只能有一個有邏輯焦點的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-135">There can be multiple elements that have logical focus in an application, but there may only be one element that has logical focus in a particular focus scope.</span></span>  
  
 <span data-ttu-id="d5f34-136">具有鍵盤焦點的項目有其所屬焦點範圍的邏輯焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-136">An element that has keyboard focus has logical focus for the focus scope it belongs to.</span></span>  
  
 <span data-ttu-id="d5f34-137">項目可以變成焦點領域中[!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)]藉由設定<xref:System.Windows.Input.FocusManager>附加屬性<xref:System.Windows.Input.FocusManager.IsFocusScope%2A>至`true`。</span><span class="sxs-lookup"><span data-stu-id="d5f34-137">An element can be turned into a focus scope in [!INCLUDE[TLA#tla_xaml](../../../../includes/tlasharptla-xaml-md.md)] by setting the <xref:System.Windows.Input.FocusManager> attached property <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> to `true`.</span></span>  <span data-ttu-id="d5f34-138">程式碼中，項目可以變成焦點領域藉由呼叫<xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-138">In code, an element can be turned into a focus scope by calling <xref:System.Windows.Input.FocusManager.SetIsFocusScope%2A>.</span></span>  
  
 <span data-ttu-id="d5f34-139">下列範例使<xref:System.Windows.Controls.StackPanel>焦點領域設定成<xref:System.Windows.Input.FocusManager.IsFocusScope%2A>附加屬性。</span><span class="sxs-lookup"><span data-stu-id="d5f34-139">The following example makes a <xref:System.Windows.Controls.StackPanel> into a focus scope by setting the <xref:System.Windows.Input.FocusManager.IsFocusScope%2A> attached property.</span></span>  
  
 [!code-xaml[MarkupSnippets#MarkupIsFocusScopeXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/MarkupSnippets/CSharp/Window1.xaml#markupisfocusscopexaml)]  
  
 [!code-csharp[FocusSnippets#FocusSetIsFocusScope](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FocusSnippets/CSharp/Window1.xaml.cs#focussetisfocusscope)]
 [!code-vb[FocusSnippets#FocusSetIsFocusScope](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSnippets/visualbasic/window1.xaml.vb#focussetisfocusscope)]  
  
 <span data-ttu-id="d5f34-140"><xref:System.Windows.Input.FocusManager.GetFocusScope%2A> 傳回指定之項目的焦點領域。</span><span class="sxs-lookup"><span data-stu-id="d5f34-140"><xref:System.Windows.Input.FocusManager.GetFocusScope%2A> returns the focus scope for the specified element.</span></span>  
  
 <span data-ttu-id="d5f34-141">中的類別[!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)]這是預設的焦點領域是<xref:System.Windows.Window>， <xref:System.Windows.Controls.MenuItem>， <xref:System.Windows.Controls.ToolBar>，和<xref:System.Windows.Controls.ContextMenu>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-141">Classes in [!INCLUDE[TLA2#tla_winclient](../../../../includes/tla2sharptla-winclient-md.md)] which are focus scopes by default are <xref:System.Windows.Window>, <xref:System.Windows.Controls.MenuItem>, <xref:System.Windows.Controls.ToolBar>, and <xref:System.Windows.Controls.ContextMenu>.</span></span>  
  
 <span data-ttu-id="d5f34-142"><xref:System.Windows.Input.FocusManager.GetFocusedElement%2A> 取得焦點的項目指定的焦點領域。</span><span class="sxs-lookup"><span data-stu-id="d5f34-142"><xref:System.Windows.Input.FocusManager.GetFocusedElement%2A> gets the focused element for the specified focus scope.</span></span>  <span data-ttu-id="d5f34-143"><xref:System.Windows.Input.FocusManager.SetFocusedElement%2A> 設定焦點的項目中指定的焦點領域。</span><span class="sxs-lookup"><span data-stu-id="d5f34-143"><xref:System.Windows.Input.FocusManager.SetFocusedElement%2A> sets the focused element in the specified focus scope.</span></span>  <span data-ttu-id="d5f34-144"><xref:System.Windows.Input.FocusManager.SetFocusedElement%2A> 通常用來設定初始焦點的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-144"><xref:System.Windows.Input.FocusManager.SetFocusedElement%2A> is typically used to set the initial focused element.</span></span>  
  
 <span data-ttu-id="d5f34-145">下例在焦點範圍中設定焦點項目，並取得焦點範圍的焦點項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-145">The following example sets the focused element on a focus scope and gets the focused element of a focus scope.</span></span>  
  
 [!code-csharp[FocusSnippets#FocusGetSetFocusedElement](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FocusSnippets/CSharp/Window1.xaml.cs#focusgetsetfocusedelement)]
 [!code-vb[FocusSnippets#FocusGetSetFocusedElement](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSnippets/visualbasic/window1.xaml.vb#focusgetsetfocusedelement)]  
  
<a name="Keyboard_Navigation"></a>   
## <a name="keyboard-navigation"></a><span data-ttu-id="d5f34-146">鍵盤導覽</span><span class="sxs-lookup"><span data-stu-id="d5f34-146">Keyboard Navigation</span></span>  
 <span data-ttu-id="d5f34-147"><xref:System.Windows.Input.KeyboardNavigation>類別會負責實作其中一個瀏覽鍵按下時的預設鍵盤焦點瀏覽。</span><span class="sxs-lookup"><span data-stu-id="d5f34-147">The <xref:System.Windows.Input.KeyboardNavigation> class is responsible for implementing default keyboard focus navigation when one of the navigation keys is pressed.</span></span>  <span data-ttu-id="d5f34-148">導覽鍵是︰TAB、SHIFT+TAB、CTRL+TAB、CTRL+SHIFT+TAB、UPARROW、DOWNARROW、LEFTARROW 和 RIGHTARROW 等鍵。</span><span class="sxs-lookup"><span data-stu-id="d5f34-148">The navigation keys are: TAB, SHIFT+TAB, CTRL+TAB, CTRL+SHIFT+TAB, UPARROW, DOWNARROW, LEFTARROW, and RIGHTARROW keys.</span></span>  
  
 <span data-ttu-id="d5f34-149">瀏覽容器的導覽行為可以藉由設定附加變更<xref:System.Windows.Input.KeyboardNavigation>屬性<xref:System.Windows.Input.KeyboardNavigation.TabNavigation%2A>， <xref:System.Windows.Input.KeyboardNavigation.ControlTabNavigation%2A>，和<xref:System.Windows.Input.KeyboardNavigation.DirectionalNavigation%2A>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-149">The navigation behavior of a navigation container can be changed by setting the attached <xref:System.Windows.Input.KeyboardNavigation> properties <xref:System.Windows.Input.KeyboardNavigation.TabNavigation%2A>, <xref:System.Windows.Input.KeyboardNavigation.ControlTabNavigation%2A>, and <xref:System.Windows.Input.KeyboardNavigation.DirectionalNavigation%2A>.</span></span>  <span data-ttu-id="d5f34-150">這些屬性屬於類型<xref:System.Windows.Input.KeyboardNavigationMode>和可能的值為<xref:System.Windows.Input.KeyboardNavigationMode.Continue>， <xref:System.Windows.Input.KeyboardNavigationMode.Local>， <xref:System.Windows.Input.KeyboardNavigationMode.Contained>， <xref:System.Windows.Input.KeyboardNavigationMode.Cycle>， <xref:System.Windows.Input.KeyboardNavigationMode.Once>，和<xref:System.Windows.Input.KeyboardNavigationMode.None>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-150">These properties are of type <xref:System.Windows.Input.KeyboardNavigationMode> and the possible values are <xref:System.Windows.Input.KeyboardNavigationMode.Continue>, <xref:System.Windows.Input.KeyboardNavigationMode.Local>, <xref:System.Windows.Input.KeyboardNavigationMode.Contained>, <xref:System.Windows.Input.KeyboardNavigationMode.Cycle>, <xref:System.Windows.Input.KeyboardNavigationMode.Once>, and <xref:System.Windows.Input.KeyboardNavigationMode.None>.</span></span>  <span data-ttu-id="d5f34-151">預設值是<xref:System.Windows.Input.KeyboardNavigationMode.Continue>，這表示項目不是瀏覽容器。</span><span class="sxs-lookup"><span data-stu-id="d5f34-151">The default value is <xref:System.Windows.Input.KeyboardNavigationMode.Continue>, which means the element is not a navigation container.</span></span>  
  
 <span data-ttu-id="d5f34-152">下列範例會建立<xref:System.Windows.Controls.Menu>數目<xref:System.Windows.Controls.MenuItem>物件。</span><span class="sxs-lookup"><span data-stu-id="d5f34-152">The following example creates a <xref:System.Windows.Controls.Menu> with a number of <xref:System.Windows.Controls.MenuItem> objects.</span></span>  <span data-ttu-id="d5f34-153"><xref:System.Windows.Input.KeyboardNavigation.TabNavigation%2A>附加的屬性設定為<xref:System.Windows.Input.KeyboardNavigationMode.Cycle>上<xref:System.Windows.Controls.Menu>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-153">The <xref:System.Windows.Input.KeyboardNavigation.TabNavigation%2A> attached property is set to <xref:System.Windows.Input.KeyboardNavigationMode.Cycle> on the <xref:System.Windows.Controls.Menu>.</span></span>  <span data-ttu-id="d5f34-154">使用 tab 鍵內變更焦點時<xref:System.Windows.Controls.Menu>、 從每個項目會將焦點移和焦點到達最後一個項目會傳回第一個項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-154">When focus is changed using the tab key within the <xref:System.Windows.Controls.Menu>, focus will move from each element and when the last element is reached focus will return to the first element.</span></span>  
  
 [!code-xaml[MarkupSnippets#MarkupKeyboardNavigationTabNavigationXAML](../../../../samples/snippets/csharp/VS_Snippets_Wpf/MarkupSnippets/CSharp/Window1.xaml#markupkeyboardnavigationtabnavigationxaml)]  
  
 [!code-csharp[MarkupSnippets#MarkupKeyboardNavigationTabNavigationCODE](../../../../samples/snippets/csharp/VS_Snippets_Wpf/MarkupSnippets/CSharp/Window1.xaml.cs#markupkeyboardnavigationtabnavigationcode)]
 [!code-vb[MarkupSnippets#MarkupKeyboardNavigationTabNavigationCODE](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/MarkupSnippets/visualbasic/window1.xaml.vb#markupkeyboardnavigationtabnavigationcode)]  
  
<a name="Manipulating_Focus_Programmatically"></a>   
## <a name="navigating-focus-programmatically"></a><span data-ttu-id="d5f34-155">以程式設計方式巡覽焦點</span><span class="sxs-lookup"><span data-stu-id="d5f34-155">Navigating Focus Programmatically</span></span>  
 <span data-ttu-id="d5f34-156">其他[!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)]焦點會使用<xref:System.Windows.UIElement.MoveFocus%2A>和<xref:System.Windows.UIElement.PredictFocus%2A>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-156">Additional [!INCLUDE[TLA#tla_api](../../../../includes/tlasharptla-api-md.md)] to work with focus are <xref:System.Windows.UIElement.MoveFocus%2A> and <xref:System.Windows.UIElement.PredictFocus%2A>.</span></span>  
  
 <span data-ttu-id="d5f34-157"><xref:System.Windows.FrameworkElement.MoveFocus%2A> 將焦點變更至應用程式中的下一個項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-157"><xref:System.Windows.FrameworkElement.MoveFocus%2A> changes focus to the next element in the application.</span></span>  <span data-ttu-id="d5f34-158">A<xref:System.Windows.Input.TraversalRequest>用來指定的方向。</span><span class="sxs-lookup"><span data-stu-id="d5f34-158">A <xref:System.Windows.Input.TraversalRequest> is used to specify the direction.</span></span>   <span data-ttu-id="d5f34-159"><xref:System.Windows.Input.FocusNavigationDirection>傳遞至<xref:System.Windows.UIElement.MoveFocus%2A>指定不同的方向焦點可以移動，例如<xref:System.Windows.Input.FocusNavigationDirection.First>， <xref:System.Windows.Input.FocusNavigationDirection.Last>，<xref:System.Windows.Input.FocusNavigationDirection.Up>和<xref:System.Windows.Input.FocusNavigationDirection.Down>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-159">The <xref:System.Windows.Input.FocusNavigationDirection> passed to <xref:System.Windows.UIElement.MoveFocus%2A> specifies the different directions focus can be moved, such as <xref:System.Windows.Input.FocusNavigationDirection.First>, <xref:System.Windows.Input.FocusNavigationDirection.Last>, <xref:System.Windows.Input.FocusNavigationDirection.Up> and <xref:System.Windows.Input.FocusNavigationDirection.Down>.</span></span>  
  
 <span data-ttu-id="d5f34-160">下列範例會使用<xref:System.Windows.FrameworkElement.MoveFocus%2A>變更焦點的項目。</span><span class="sxs-lookup"><span data-stu-id="d5f34-160">The following example uses <xref:System.Windows.FrameworkElement.MoveFocus%2A> to change the focused element.</span></span>  
  
 [!code-csharp[focussample#FocusSampleMoveFocus](../../../../samples/snippets/csharp/VS_Snippets_Wpf/FocusSample/CSharp/Window1.xaml.cs#focussamplemovefocus)]
 [!code-vb[focussample#FocusSampleMoveFocus](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/FocusSample/visualbasic/window1.xaml.vb#focussamplemovefocus)]  
  
 <span data-ttu-id="d5f34-161"><xref:System.Windows.FrameworkElement.PredictFocus%2A> 傳回變更焦點時接收焦點的物件。</span><span class="sxs-lookup"><span data-stu-id="d5f34-161"><xref:System.Windows.FrameworkElement.PredictFocus%2A> returns the object which would receive focus if focus were to be changed.</span></span>  <span data-ttu-id="d5f34-162">目前，只有<xref:System.Windows.Input.FocusNavigationDirection.Up>， <xref:System.Windows.Input.FocusNavigationDirection.Down>， <xref:System.Windows.Input.FocusNavigationDirection.Left>，和<xref:System.Windows.Input.FocusNavigationDirection.Right>支援<xref:System.Windows.FrameworkElement.PredictFocus%2A>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-162">Currently, only <xref:System.Windows.Input.FocusNavigationDirection.Up>, <xref:System.Windows.Input.FocusNavigationDirection.Down>, <xref:System.Windows.Input.FocusNavigationDirection.Left>, and <xref:System.Windows.Input.FocusNavigationDirection.Right> are supported by <xref:System.Windows.FrameworkElement.PredictFocus%2A>.</span></span>  
  
<a name="Focus_Events"></a>   
## <a name="focus-events"></a><span data-ttu-id="d5f34-163">焦點事件</span><span class="sxs-lookup"><span data-stu-id="d5f34-163">Focus Events</span></span>  
 <span data-ttu-id="d5f34-164">與鍵盤焦點相關的事件是<xref:System.Windows.Input.Keyboard.PreviewGotKeyboardFocus>，<xref:System.Windows.Input.Keyboard.GotKeyboardFocus>和<xref:System.Windows.Input.Keyboard.PreviewLostKeyboardFocus>， <xref:System.Windows.Input.Keyboard.LostKeyboardFocus>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-164">The events related to keyboard focus are <xref:System.Windows.Input.Keyboard.PreviewGotKeyboardFocus>, <xref:System.Windows.Input.Keyboard.GotKeyboardFocus> and <xref:System.Windows.Input.Keyboard.PreviewLostKeyboardFocus>, <xref:System.Windows.Input.Keyboard.LostKeyboardFocus>.</span></span>  <span data-ttu-id="d5f34-165">為附加事件上定義之事件<xref:System.Windows.Input.Keyboard>類別，但更容易存取做為基底項目類別上的對等路由事件。</span><span class="sxs-lookup"><span data-stu-id="d5f34-165">The events are defined as attached events on the <xref:System.Windows.Input.Keyboard> class, but are more readily accessible as equivalent routed events on the base element classes.</span></span>  <span data-ttu-id="d5f34-166">如需事件的詳細資訊，請參閱[路由事件概觀](../../../../docs/framework/wpf/advanced/routed-events-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="d5f34-166">For more information about events, see the [Routed Events Overview](../../../../docs/framework/wpf/advanced/routed-events-overview.md).</span></span>  
  
 <span data-ttu-id="d5f34-167"><xref:System.Windows.Input.Keyboard.GotKeyboardFocus> 當項目取得鍵盤焦點時引發。</span><span class="sxs-lookup"><span data-stu-id="d5f34-167"><xref:System.Windows.Input.Keyboard.GotKeyboardFocus> is raised when the element obtains keyboard focus.</span></span>  <span data-ttu-id="d5f34-168"><xref:System.Windows.Input.Keyboard.LostKeyboardFocus> 項目失去鍵盤焦點時引發。</span><span class="sxs-lookup"><span data-stu-id="d5f34-168"><xref:System.Windows.Input.Keyboard.LostKeyboardFocus> is raised when the element loses keyboard focus.</span></span>  <span data-ttu-id="d5f34-169">如果<xref:System.Windows.Input.Keyboard.PreviewGotKeyboardFocus>事件或<xref:System.Windows.Input.Keyboard.PreviewLostKeyboardFocusEvent>處理事件和<xref:System.Windows.RoutedEventArgs.Handled%2A>設`true`，則不會變更焦點。</span><span class="sxs-lookup"><span data-stu-id="d5f34-169">If the <xref:System.Windows.Input.Keyboard.PreviewGotKeyboardFocus> event or the <xref:System.Windows.Input.Keyboard.PreviewLostKeyboardFocusEvent> event is handled and <xref:System.Windows.RoutedEventArgs.Handled%2A> is set to `true`, then focus will not change.</span></span>  
  
 <span data-ttu-id="d5f34-170">下列範例會附加<xref:System.Windows.UIElement.GotKeyboardFocus>和<xref:System.Windows.UIElement.LostKeyboardFocus>事件處理常式， <xref:System.Windows.Controls.TextBox>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-170">The following example attaches <xref:System.Windows.UIElement.GotKeyboardFocus> and <xref:System.Windows.UIElement.LostKeyboardFocus> event handlers to a <xref:System.Windows.Controls.TextBox>.</span></span>  
  
 [!code-xaml[keyboardsample#KeyboardSampleXAMLHandlerHookup](../../../../samples/snippets/csharp/VS_Snippets_Wpf/KeyboardSample/CSharp/Window1.xaml#keyboardsamplexamlhandlerhookup)]  
  
 <span data-ttu-id="d5f34-171">當<xref:System.Windows.Controls.TextBox>取得鍵盤焦點<xref:System.Windows.Controls.Control.Background%2A>屬性<xref:System.Windows.Controls.TextBox>變更為<xref:System.Windows.Media.Brushes.LightBlue%2A>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-171">When the <xref:System.Windows.Controls.TextBox> obtains keyboard focus, the <xref:System.Windows.Controls.Control.Background%2A> property of the <xref:System.Windows.Controls.TextBox> is changed to <xref:System.Windows.Media.Brushes.LightBlue%2A>.</span></span>  
  
 [!code-csharp[keyboardsample#KeyboardSampleGotFocus](../../../../samples/snippets/csharp/VS_Snippets_Wpf/KeyboardSample/CSharp/Window1.xaml.cs#keyboardsamplegotfocus)]
 [!code-vb[keyboardsample#KeyboardSampleGotFocus](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/KeyboardSample/visualbasic/window1.xaml.vb#keyboardsamplegotfocus)]  
  
 <span data-ttu-id="d5f34-172">當<xref:System.Windows.Controls.TextBox>失去鍵盤焦點、<xref:System.Windows.Controls.Control.Background%2A>屬性<xref:System.Windows.Controls.TextBox>變更回為白色。</span><span class="sxs-lookup"><span data-stu-id="d5f34-172">When the <xref:System.Windows.Controls.TextBox> loses keyboard focus, the <xref:System.Windows.Controls.Control.Background%2A> property of the <xref:System.Windows.Controls.TextBox> is changed back to white.</span></span>  
  
 [!code-csharp[keyboardsample#KeyboardSampleLostFocus](../../../../samples/snippets/csharp/VS_Snippets_Wpf/KeyboardSample/CSharp/Window1.xaml.cs#keyboardsamplelostfocus)]
 [!code-vb[keyboardsample#KeyboardSampleLostFocus](../../../../samples/snippets/visualbasic/VS_Snippets_Wpf/KeyboardSample/visualbasic/window1.xaml.vb#keyboardsamplelostfocus)]  
  
 <span data-ttu-id="d5f34-173">邏輯焦點與相關的事件是<xref:System.Windows.UIElement.GotFocus>和<xref:System.Windows.UIElement.LostFocus>。</span><span class="sxs-lookup"><span data-stu-id="d5f34-173">The events related to logical focus are <xref:System.Windows.UIElement.GotFocus> and <xref:System.Windows.UIElement.LostFocus>.</span></span>  <span data-ttu-id="d5f34-174">這些事件上定義<xref:System.Windows.Input.FocusManager>為附加的事件，但<xref:System.Windows.Input.FocusManager>不會公開 CLR 事件包裝函式。</span><span class="sxs-lookup"><span data-stu-id="d5f34-174">These events are defined on the <xref:System.Windows.Input.FocusManager> as attached events, but the <xref:System.Windows.Input.FocusManager> does not expose CLR event wrappers.</span></span>  <span data-ttu-id="d5f34-175"><xref:System.Windows.UIElement> 和<xref:System.Windows.ContentElement>更方便地公開 （expose) 這些事件。</span><span class="sxs-lookup"><span data-stu-id="d5f34-175"><xref:System.Windows.UIElement> and <xref:System.Windows.ContentElement> expose these events more conveniently.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d5f34-176">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d5f34-176">See Also</span></span>  
 <xref:System.Windows.Input.FocusManager>  
 <xref:System.Windows.UIElement>  
 <xref:System.Windows.ContentElement>  
 [<span data-ttu-id="d5f34-177">輸入概觀</span><span class="sxs-lookup"><span data-stu-id="d5f34-177">Input Overview</span></span>](../../../../docs/framework/wpf/advanced/input-overview.md)  
 [<span data-ttu-id="d5f34-178">基底項目概觀</span><span class="sxs-lookup"><span data-stu-id="d5f34-178">Base Elements Overview</span></span>](../../../../docs/framework/wpf/advanced/base-elements-overview.md)
