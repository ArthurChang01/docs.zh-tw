---
title: 安全性 (WPF)
ms.date: 03/30/2017
helpviewer_keywords:
- XAML files [WPF], sandbox behavior
- browser-hosted application security [WPF]
- application security [WPF]
- navigation security [WPF]
- loose XAML files [WPF], sandbox behavior
- WPF security [WPF]
- WebBrowser control [WPF], security
- feature controls [WPF], security
- XBAP security [WPF]
- Internet Explorer security settings [WPF]
ms.assetid: ee1baea0-3611-4e36-9ad6-fcd5205376fb
ms.openlocfilehash: 019035247b1316eb236b025d4527c42bb6ef526c
ms.sourcegitcommit: 68653db98c5ea7744fd438710248935f70020dfb
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 08/22/2019
ms.locfileid: "69962814"
---
# <a name="security-wpf"></a><span data-ttu-id="87e2d-102">安全性 (WPF)</span><span class="sxs-lookup"><span data-stu-id="87e2d-102">Security (WPF)</span></span>
<a name="introduction"></a><span data-ttu-id="87e2d-103">開發 Windows Presentation Foundation (WPF) 獨立和瀏覽器裝載的應用程式時, 您必須考慮安全性模型。</span><span class="sxs-lookup"><span data-stu-id="87e2d-103">When developing Windows Presentation Foundation (WPF) standalone and browser-hosted applications, you must consider the security model.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="87e2d-104">獨立應用程式會以不受限制的許可權 (CAS**FullTrust**許可權集合) 執行, 不論是使用 Windows Installer (.msi)、XCopy 或 ClickOnce 部署。</span><span class="sxs-lookup"><span data-stu-id="87e2d-104">standalone applications execute with unrestricted permissions ( CAS**FullTrust** permission set), whether deployed using Windows Installer (.msi), XCopy, or ClickOnce.</span></span> <span data-ttu-id="87e2d-105">不支援使用 ClickOnce 部署部分信任的獨立 WPF 應用程式。</span><span class="sxs-lookup"><span data-stu-id="87e2d-105">Deploying partial-trust, standalone WPF applications with ClickOnce is unsupported.</span></span> <span data-ttu-id="87e2d-106">不過, 完全信任的主應用程式可以使用 .NET Framework 增益集模型<xref:System.AppDomain>來建立部分信任。</span><span class="sxs-lookup"><span data-stu-id="87e2d-106">However, a full-trust host application can create a partial-trust <xref:System.AppDomain> using the .NET Framework Add-in model.</span></span> <span data-ttu-id="87e2d-107">如需詳細資訊, 請參閱[WPF 增益集總覽](./app-development/wpf-add-ins-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-107">For more information, see [WPF Add-Ins Overview](./app-development/wpf-add-ins-overview.md).</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="87e2d-108">瀏覽器裝載的應用程式是由 Windows Internet Explorer 或 Firefox 主控, 而且可以[!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)]是或[!INCLUDE[TLA#tla_xaml](../../../includes/tlasharptla-xaml-md.md)]鬆散檔以取得詳細資訊, 請參閱[WPF XAML 瀏覽器應用程式總覽](./app-development/wpf-xaml-browser-applications-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-108">browser-hosted applications are hosted by Windows Internet Explorer or Firefox, and can be either [!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)] or loose [!INCLUDE[TLA#tla_xaml](../../../includes/tlasharptla-xaml-md.md)] documents For more information, see [WPF XAML Browser Applications Overview](./app-development/wpf-xaml-browser-applications-overview.md).</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="87e2d-109">瀏覽器裝載的應用程式預設會在部分信任安全性沙箱中執行, 其限制為預設的 CAS**網際網路**區域許可權集合。</span><span class="sxs-lookup"><span data-stu-id="87e2d-109">browser-hosted applications execute within a partial trust security sandbox, by default, which is limited to the default CAS**Internet** zone permission set.</span></span> <span data-ttu-id="87e2d-110">這可有效[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]地將瀏覽器裝載的應用程式與用戶端電腦隔離, 使其與一般 Web 應用程式隔離的方式相同。</span><span class="sxs-lookup"><span data-stu-id="87e2d-110">This effectively isolates [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] browser-hosted applications from the client computer in the same way that you would expect typical Web applications to be isolated.</span></span> <span data-ttu-id="87e2d-111">XBAP 可以根據部署 URL 的安全性區域以及用戶端的安全性組態來提高權限，而最高為「完全信任」。</span><span class="sxs-lookup"><span data-stu-id="87e2d-111">An XBAP can elevate privileges, up to Full Trust, depending on the security zone of the deployment URL and the client's security configuration.</span></span> <span data-ttu-id="87e2d-112">如需詳細資訊，請參閱 [WPF 部分信任安全性](wpf-partial-trust-security.md)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-112">For more information, see [WPF Partial Trust Security](wpf-partial-trust-security.md).</span></span>  
  
 <span data-ttu-id="87e2d-113">本主題討論 Windows Presentation Foundation (WPF) 獨立和瀏覽器裝載應用程式的安全性模型。</span><span class="sxs-lookup"><span data-stu-id="87e2d-113">This topic discusses the security model for Windows Presentation Foundation (WPF) standalone and browser-hosted applications.</span></span>  
  
 <span data-ttu-id="87e2d-114">本主題包含下列幾節：</span><span class="sxs-lookup"><span data-stu-id="87e2d-114">This topic contains the following sections:</span></span>  
  
- [<span data-ttu-id="87e2d-115">安全巡覽</span><span class="sxs-lookup"><span data-stu-id="87e2d-115">Safe Navigation</span></span>](#SafeTopLevelNavigation)  
  
- [<span data-ttu-id="87e2d-116">Web 瀏覽軟體安全性設定</span><span class="sxs-lookup"><span data-stu-id="87e2d-116">Web Browsing Software Security Settings</span></span>](#InternetExplorerSecuritySettings)  
  
- [<span data-ttu-id="87e2d-117">WebBrowser 控制項和功能控制項</span><span class="sxs-lookup"><span data-stu-id="87e2d-117">WebBrowser Control and Feature Controls</span></span>](#webbrowser_control_and_feature_controls)  
  
- [<span data-ttu-id="87e2d-118">停用部分信任用戶端應用程式的 APTCA 組件</span><span class="sxs-lookup"><span data-stu-id="87e2d-118">Disabling APTCA Assemblies for Partially Trusted Client Applications</span></span>](#APTCA)  
  
- [<span data-ttu-id="87e2d-119">鬆散 XAML 檔案的沙箱行為</span><span class="sxs-lookup"><span data-stu-id="87e2d-119">Sandbox Behavior for Loose XAML Files</span></span>](#LooseContentSandboxing)  
  
- [<span data-ttu-id="87e2d-120">用於開發可提高安全性的 WPF 應用程式的資源</span><span class="sxs-lookup"><span data-stu-id="87e2d-120">Resources for Developing WPF Applications that Promote Security</span></span>](#BestPractices)  
  
<a name="SafeTopLevelNavigation"></a>   
## <a name="safe-navigation"></a><span data-ttu-id="87e2d-121">安全巡覽</span><span class="sxs-lookup"><span data-stu-id="87e2d-121">Safe Navigation</span></span>  
 <span data-ttu-id="87e2d-122">針對[!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)] ,[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]區分兩種類型的流覽: 應用程式和瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="87e2d-122">For [!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] distinguishes two types of navigation: application and browser.</span></span>  
  
 <span data-ttu-id="87e2d-123">「應用程式巡覽」是瀏覽器所裝載之應用程式的內容項目間的巡覽。</span><span class="sxs-lookup"><span data-stu-id="87e2d-123">*Application navigation* is navigation between items of content within an application that is hosted by a browser.</span></span> <span data-ttu-id="87e2d-124">「瀏覽器巡覽」是變更瀏覽器本身的內容和位置 URL 的巡覽。</span><span class="sxs-lookup"><span data-stu-id="87e2d-124">*Browser navigation* is navigation that changes the content and location URL of a browser itself.</span></span> <span data-ttu-id="87e2d-125">下圖顯示應用程式導覽 (通常是 XAML) 和瀏覽器導覽 (通常是 HTML) 之間的關聯性:</span><span class="sxs-lookup"><span data-stu-id="87e2d-125">The relationship between application navigation (typically XAML) and browser navigation (typically HTML) is shown in the following illustration:</span></span>
  
 ![應用程式導覽與瀏覽器導覽之間的關聯性。](./media/security-wpf/application-browser-navigation-relationship.png)  
  
 <span data-ttu-id="87e2d-127">視為[!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)]要流覽至安全的內容類型主要取決於是否使用應用程式導覽或瀏覽器導覽。</span><span class="sxs-lookup"><span data-stu-id="87e2d-127">The type of content that is considered safe for an [!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)] to navigate to is primarily determined by whether application navigation or browser navigation is used.</span></span>  
  
<a name="Application_Navigation_Security"></a>   
### <a name="application-navigation-security"></a><span data-ttu-id="87e2d-128">應用程式巡覽安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-128">Application Navigation Security</span></span>  
 <span data-ttu-id="87e2d-129">如果可以使用支援四種內容類型的套件[!INCLUDE[TLA2#tla_uri](../../../includes/tla2sharptla-uri-md.md)]識別應用程式, 則會將它視為安全:</span><span class="sxs-lookup"><span data-stu-id="87e2d-129">Application navigation is considered safe if it can be identified with a pack [!INCLUDE[TLA2#tla_uri](../../../includes/tla2sharptla-uri-md.md)], which supports four types of content:</span></span>  
  
|<span data-ttu-id="87e2d-130">內容類型</span><span class="sxs-lookup"><span data-stu-id="87e2d-130">Content Type</span></span>|<span data-ttu-id="87e2d-131">描述</span><span class="sxs-lookup"><span data-stu-id="87e2d-131">Description</span></span>|<span data-ttu-id="87e2d-132">URI 範例</span><span class="sxs-lookup"><span data-stu-id="87e2d-132">URI Example</span></span>|  
|------------------|-----------------|-----------------|  
|<span data-ttu-id="87e2d-133">Resource</span><span class="sxs-lookup"><span data-stu-id="87e2d-133">Resource</span></span>|<span data-ttu-id="87e2d-134">新增至組建類型為**資源**之專案的檔案。</span><span class="sxs-lookup"><span data-stu-id="87e2d-134">Files that are added to a project with a build type of **Resource**.</span></span>|`pack://application:,,,/MyResourceFile.xaml`|  
|<span data-ttu-id="87e2d-135">內容</span><span class="sxs-lookup"><span data-stu-id="87e2d-135">Content</span></span>|<span data-ttu-id="87e2d-136">新增至專案的檔案, 其組建類型為**Content**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-136">Files that are added to a project with a build type of **Content**.</span></span>|`pack://application:,,,/MyContentFile.xaml`|  
|<span data-ttu-id="87e2d-137">Site of origin</span><span class="sxs-lookup"><span data-stu-id="87e2d-137">Site of origin</span></span>|<span data-ttu-id="87e2d-138">新增至組建類型為**None**之專案的檔案。</span><span class="sxs-lookup"><span data-stu-id="87e2d-138">Files that are added to a project with a build type of **None**.</span></span>|`pack://siteoforigin:,,,/MySiteOfOriginFile.xaml`|  
|<span data-ttu-id="87e2d-139">應用程式程式碼</span><span class="sxs-lookup"><span data-stu-id="87e2d-139">Application code</span></span>|<span data-ttu-id="87e2d-140">具有已編譯程式碼後置的 XAML 資源。</span><span class="sxs-lookup"><span data-stu-id="87e2d-140">XAML resources that have a compiled code-behind.</span></span><br /><br /> <span data-ttu-id="87e2d-141">-或-</span><span class="sxs-lookup"><span data-stu-id="87e2d-141">-or-</span></span><br /><br /> <span data-ttu-id="87e2d-142">加入至組建類型為**Page**之專案的 XAML 檔案。</span><span class="sxs-lookup"><span data-stu-id="87e2d-142">XAML files that are added to a project with a build type of **Page**.</span></span>|<span data-ttu-id="87e2d-143">`pack://application:,,,/MyResourceFile` `.xaml`</span><span class="sxs-lookup"><span data-stu-id="87e2d-143">`pack://application:,,,/MyResourceFile` `.xaml`</span></span>|  
  
> [!NOTE]
> <span data-ttu-id="87e2d-144">如需有關應用程式資料檔案和套件[!INCLUDE[TLA2#tla_uri#plural](../../../includes/tla2sharptla-urisharpplural-md.md)]的詳細資訊, 請參閱[WPF 應用程式資源、內容和資料檔案](./app-development/wpf-application-resource-content-and-data-files.md)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-144">For more information about application data files and pack [!INCLUDE[TLA2#tla_uri#plural](../../../includes/tla2sharptla-urisharpplural-md.md)], see [WPF Application Resource, Content, and Data Files](./app-development/wpf-application-resource-content-and-data-files.md).</span></span>  
  
 <span data-ttu-id="87e2d-145">使用者或透過程式設計方式可以巡覽到這些內容類型的檔案︰</span><span class="sxs-lookup"><span data-stu-id="87e2d-145">Files of these content types can be navigated to by either the user or programmatically:</span></span>  
  
- <span data-ttu-id="87e2d-146">**使用者巡覽**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-146">**User Navigation**.</span></span> <span data-ttu-id="87e2d-147">使用者可以按一下<xref:System.Windows.Documents.Hyperlink>專案來流覽。</span><span class="sxs-lookup"><span data-stu-id="87e2d-147">The user navigates by clicking a <xref:System.Windows.Documents.Hyperlink> element.</span></span>  
  
- <span data-ttu-id="87e2d-148">**程式設計巡覽**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-148">**Programmatic Navigation**.</span></span> <span data-ttu-id="87e2d-149">應用程式流覽時不會涉及使用者, 例如, 藉由設定<xref:System.Windows.Navigation.NavigationWindow.Source%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="87e2d-149">The application navigates without involving the user, for example, by setting the <xref:System.Windows.Navigation.NavigationWindow.Source%2A?displayProperty=nameWithType> property.</span></span>  
  
<a name="Browser_Navigation_Security"></a>   
### <a name="browser-navigation-security"></a><span data-ttu-id="87e2d-150">瀏覽器巡覽安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-150">Browser Navigation Security</span></span>  
 <span data-ttu-id="87e2d-151">只有在下列情況下，才會將瀏覽器巡覽視為安全：</span><span class="sxs-lookup"><span data-stu-id="87e2d-151">Browser navigation is considered safe only under the following conditions:</span></span>  
  
- <span data-ttu-id="87e2d-152">**使用者巡覽**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-152">**User Navigation**.</span></span> <span data-ttu-id="87e2d-153">使用者藉由按一下<xref:System.Windows.Documents.Hyperlink>主要<xref:System.Windows.Navigation.NavigationWindow>內的專案, 而不是在嵌套<xref:System.Windows.Controls.Frame>的中, 來進行流覽。</span><span class="sxs-lookup"><span data-stu-id="87e2d-153">The user navigates by clicking a <xref:System.Windows.Documents.Hyperlink> element that is within the main <xref:System.Windows.Navigation.NavigationWindow>, not in a nested <xref:System.Windows.Controls.Frame>.</span></span>  
  
- <span data-ttu-id="87e2d-154">**區域**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-154">**Zone**.</span></span> <span data-ttu-id="87e2d-155">所要巡覽的內容位在網際網路或近端內部網路。</span><span class="sxs-lookup"><span data-stu-id="87e2d-155">The content being navigated to is located on the Internet or the local intranet.</span></span>  
  
- <span data-ttu-id="87e2d-156">**通訊協定**.</span><span class="sxs-lookup"><span data-stu-id="87e2d-156">**Protocol**.</span></span> <span data-ttu-id="87e2d-157">所使用的通訊協定為**HTTP**、 **HTTPs**、 **file**或**mailto**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-157">The protocol being used is either **http**, **https**, **file**, or **mailto**.</span></span>  
  
 <span data-ttu-id="87e2d-158">如果嘗試以不符合這些條件的方式流覽至內容<xref:System.Security.SecurityException> , 就會擲回。 [!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)]</span><span class="sxs-lookup"><span data-stu-id="87e2d-158">If an [!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)] attempts to navigate to content in a manner that does not comply with these conditions, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
<a name="InternetExplorerSecuritySettings"></a>   
## <a name="web-browsing-software-security-settings"></a><span data-ttu-id="87e2d-159">Web 瀏覽軟體安全性設定</span><span class="sxs-lookup"><span data-stu-id="87e2d-159">Web Browsing Software Security Settings</span></span>  
 <span data-ttu-id="87e2d-160">電腦上的安全性設定決定授與任何 Web 瀏覽軟體的存取權。</span><span class="sxs-lookup"><span data-stu-id="87e2d-160">The security settings on your computer determine the access that any Web browsing software is granted.</span></span> <span data-ttu-id="87e2d-161">Web 流覽套裝軟體含任何使用[WinINet](https://go.microsoft.com/fwlink/?LinkId=179379)或[urlmon.dll](https://go.microsoft.com/fwlink/?LinkId=179383) Api (包括 Internet Explorer 和 presentationhost.exe) 的應用程式或元件。</span><span class="sxs-lookup"><span data-stu-id="87e2d-161">Web browsing software includes any application or component that uses the [WinINet](https://go.microsoft.com/fwlink/?LinkId=179379) or [UrlMon](https://go.microsoft.com/fwlink/?LinkId=179383) APIs, including Internet Explorer and PresentationHost.exe.</span></span>  
  
 <span data-ttu-id="87e2d-162">Internet Explorer 提供一種機制, 可讓您設定允許或從 Internet Explorer 執行的功能, 包括下列各項:</span><span class="sxs-lookup"><span data-stu-id="87e2d-162">Internet Explorer provides a mechanism by which you can configure the functionality that is allowed to be executed by or from Internet Explorer, including the following:</span></span>  
  
- <span data-ttu-id="87e2d-163">.NET Framework 相依元件</span><span class="sxs-lookup"><span data-stu-id="87e2d-163">.NET Framework-reliant components</span></span>  
  
- <span data-ttu-id="87e2d-164">ActiveX 控制項和外掛程式</span><span class="sxs-lookup"><span data-stu-id="87e2d-164">ActiveX controls and plug-ins</span></span>  
  
- <span data-ttu-id="87e2d-165">下載</span><span class="sxs-lookup"><span data-stu-id="87e2d-165">Downloads</span></span>  
  
- <span data-ttu-id="87e2d-166">正在處理指令碼</span><span class="sxs-lookup"><span data-stu-id="87e2d-166">Scripting</span></span>  
  
- <span data-ttu-id="87e2d-167">使用者驗證</span><span class="sxs-lookup"><span data-stu-id="87e2d-167">User Authentication</span></span>  
  
 <span data-ttu-id="87e2d-168">以這種方式受到保護的功能集合, 是針對網際網路、**內部** **網路**、**信任的網站**和**受限制的網站**區域, 以每個區域為基礎進行設定。</span><span class="sxs-lookup"><span data-stu-id="87e2d-168">The collection of functionality that can be secured in this way is configured on a per-zone basis for the **Internet**, **Intranet**, **Trusted Sites**, and **Restricted Sites** zones.</span></span> <span data-ttu-id="87e2d-169">下列步驟描述如何設定安全性設定：</span><span class="sxs-lookup"><span data-stu-id="87e2d-169">The following steps describe how to configure your security settings:</span></span>  
  
1. <span data-ttu-id="87e2d-170">開啟 [**控制台**]。</span><span class="sxs-lookup"><span data-stu-id="87e2d-170">Open **Control Panel**.</span></span>  
  
2. <span data-ttu-id="87e2d-171">按一下 [**網路和網際網路**], 然後按一下 [**網際網路選項**]。</span><span class="sxs-lookup"><span data-stu-id="87e2d-171">Click **Network and Internet** and then click **Internet Options**.</span></span>  
  
     <span data-ttu-id="87e2d-172">[網際網路選項] 對話方塊隨即出現。</span><span class="sxs-lookup"><span data-stu-id="87e2d-172">The Internet Options dialog box appears.</span></span>  
  
3. <span data-ttu-id="87e2d-173">在 [**安全性**] 索引標籤上, 選取要設定安全性設定的區域。</span><span class="sxs-lookup"><span data-stu-id="87e2d-173">On the **Security** tab, select the zone to configure the security settings for.</span></span>  
  
4. <span data-ttu-id="87e2d-174">按一下 [**自訂層級**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="87e2d-174">Click the **Custom Level** button.</span></span>  
  
     <span data-ttu-id="87e2d-175">[**安全性設定**] 對話方塊隨即出現, 您可以設定所選區域的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="87e2d-175">The **Security Settings** dialog box appears and you can configure the security settings for the selected zone.</span></span>  
  
     ![顯示 [安全性設定] 對話方塊的螢幕擷取畫面。](./media/security-wpf/windows-presentation-foundation-security-settings.png)  
  
> [!NOTE]
> <span data-ttu-id="87e2d-177">您也可以從 Internet Explorer 到達 [網際網路選項] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="87e2d-177">You can also get to the Internet Options dialog box from Internet Explorer.</span></span> <span data-ttu-id="87e2d-178">按一下 [**工具**], 然後按一下 [**網際網路選項**]。</span><span class="sxs-lookup"><span data-stu-id="87e2d-178">Click **Tools** and then click **Internet Options**.</span></span>  
  
 <span data-ttu-id="87e2d-179">從 Windows Internet Explorer 7 開始, 會包含下列專為 .NET Framework 所提供的安全性設定:</span><span class="sxs-lookup"><span data-stu-id="87e2d-179">Starting with Windows Internet Explorer 7, the following security settings specifically for .NET Framework are included:</span></span>  
  
- <span data-ttu-id="87e2d-180">**鬆散 XAML**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-180">**Loose XAML**.</span></span> <span data-ttu-id="87e2d-181">控制 Internet Explorer 是否可以導覽至檔案或[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]鬆散檔案。</span><span class="sxs-lookup"><span data-stu-id="87e2d-181">Controls whether Internet Explorer can navigate to and loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files.</span></span> <span data-ttu-id="87e2d-182">([啟用]、[停用] 和 [提示] 選項)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-182">(Enable, Disable, and Prompt options).</span></span>  
  
- <span data-ttu-id="87e2d-183">**XAML 瀏覽器應用程式**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-183">**XAML browser applications**.</span></span> <span data-ttu-id="87e2d-184">控制 Internet Explorer 是否可以導覽並執行[!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="87e2d-184">Controls whether Internet Explorer can navigate to and run [!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)].</span></span> <span data-ttu-id="87e2d-185">([啟用]、[停用] 和 [提示] 選項)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-185">(Enable, Disable, and Prompt options).</span></span>  
  
 <span data-ttu-id="87e2d-186">根據預設, 這些設定都會針對 [**網際網路**]、[近端**內部**網路] 和 [**信任**的網站] 區域啟用, 並針對 [**限制的網站**] 區域停用。</span><span class="sxs-lookup"><span data-stu-id="87e2d-186">By default, these settings are all enabled for the **Internet**, **Local intranet**, and **Trusted sites** zones, and disabled for the **Restricted sites** zone.</span></span>  
  
<a name="Security_Settings_for_IE6_and_Below"></a>   
### <a name="security-related-wpf-registry-settings"></a><span data-ttu-id="87e2d-187">安全性相關 WPF 登錄設定</span><span class="sxs-lookup"><span data-stu-id="87e2d-187">Security-related WPF Registry Settings</span></span>  
 <span data-ttu-id="87e2d-188">除了透過 [網際網路選項] 取得的安全性設定之外，還提供下列登錄值可選擇性地封鎖許多有安全性顧慮的 WPF 功能。</span><span class="sxs-lookup"><span data-stu-id="87e2d-188">In addition to the security settings available through the Internet Options, the following registry values are available for selectively blocking a number of security-sensitive WPF features.</span></span> <span data-ttu-id="87e2d-189">值會定義在下列機碼下方︰</span><span class="sxs-lookup"><span data-stu-id="87e2d-189">The values are defined under the following key:</span></span>  
  
 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\Windows Presentation Foundation\Features`  
  
 <span data-ttu-id="87e2d-190">下表列出可設定的值。</span><span class="sxs-lookup"><span data-stu-id="87e2d-190">The following table lists the values that can be set.</span></span>  
  
|<span data-ttu-id="87e2d-191">數值名稱</span><span class="sxs-lookup"><span data-stu-id="87e2d-191">Value Name</span></span>|<span data-ttu-id="87e2d-192">實值類型</span><span class="sxs-lookup"><span data-stu-id="87e2d-192">Value Type</span></span>|<span data-ttu-id="87e2d-193">數值資料</span><span class="sxs-lookup"><span data-stu-id="87e2d-193">Value Data</span></span>|  
|----------------|----------------|----------------|  
|<span data-ttu-id="87e2d-194">XBAPDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-194">XBAPDisallow</span></span>|<span data-ttu-id="87e2d-195">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-195">REG_DWORD</span></span>|<span data-ttu-id="87e2d-196">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-196">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="87e2d-197">LooseXamlDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-197">LooseXamlDisallow</span></span>|<span data-ttu-id="87e2d-198">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-198">REG_DWORD</span></span>|<span data-ttu-id="87e2d-199">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-199">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="87e2d-200">WebBrowserDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-200">WebBrowserDisallow</span></span>|<span data-ttu-id="87e2d-201">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-201">REG_DWORD</span></span>|<span data-ttu-id="87e2d-202">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-202">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="87e2d-203">MediaAudioDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-203">MediaAudioDisallow</span></span>|<span data-ttu-id="87e2d-204">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-204">REG_DWORD</span></span>|<span data-ttu-id="87e2d-205">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-205">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="87e2d-206">MediaImageDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-206">MediaImageDisallow</span></span>|<span data-ttu-id="87e2d-207">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-207">REG_DWORD</span></span>|<span data-ttu-id="87e2d-208">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-208">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="87e2d-209">MediaVideoDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-209">MediaVideoDisallow</span></span>|<span data-ttu-id="87e2d-210">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-210">REG_DWORD</span></span>|<span data-ttu-id="87e2d-211">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-211">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="87e2d-212">ScriptInteropDisallow</span><span class="sxs-lookup"><span data-stu-id="87e2d-212">ScriptInteropDisallow</span></span>|<span data-ttu-id="87e2d-213">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="87e2d-213">REG_DWORD</span></span>|<span data-ttu-id="87e2d-214">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="87e2d-214">1 to disallow; 0 to allow.</span></span>|  
  
<a name="webbrowser_control_and_feature_controls"></a>   
## <a name="webbrowser-control-and-feature-controls"></a><span data-ttu-id="87e2d-215">WebBrowser 控制項和功能控制項</span><span class="sxs-lookup"><span data-stu-id="87e2d-215">WebBrowser Control and Feature Controls</span></span>  
 <span data-ttu-id="87e2d-216">WPF <xref:System.Windows.Controls.WebBrowser>控制項可以用來裝載 Web 內容。</span><span class="sxs-lookup"><span data-stu-id="87e2d-216">The WPF <xref:System.Windows.Controls.WebBrowser> control can be used to host Web content.</span></span> <span data-ttu-id="87e2d-217">WPF <xref:System.Windows.Controls.WebBrowser>控制項會包裝基礎 WebBrowser ActiveX 控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-217">The WPF <xref:System.Windows.Controls.WebBrowser> control wraps the underlying WebBrowser ActiveX control.</span></span> <span data-ttu-id="87e2d-218">當您使用 wpf <xref:System.Windows.Controls.WebBrowser>控制項來裝載不受信任的 Web 內容時, wpf 會提供一些保護應用程式的支援。</span><span class="sxs-lookup"><span data-stu-id="87e2d-218">WPF provides some support for securing your application when you use the WPF <xref:System.Windows.Controls.WebBrowser> control to host untrusted Web content.</span></span> <span data-ttu-id="87e2d-219">不過, 某些安全性功能必須由使用<xref:System.Windows.Controls.WebBrowser>控制項的應用程式直接套用。</span><span class="sxs-lookup"><span data-stu-id="87e2d-219">However, some security features must be applied directly by the applications using the <xref:System.Windows.Controls.WebBrowser> control.</span></span> <span data-ttu-id="87e2d-220">如需 WebBrowser ActiveX 控制項的詳細資訊, 請參閱[Webbrowser 控制項總覽和教學](https://go.microsoft.com/fwlink/?LinkId=179388)課程。</span><span class="sxs-lookup"><span data-stu-id="87e2d-220">For more information about the WebBrowser ActiveX control, see [WebBrowser Control Overviews and Tutorials](https://go.microsoft.com/fwlink/?LinkId=179388).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="87e2d-221">本節也適用<xref:System.Windows.Controls.Frame>于控制項, 因為它會<xref:System.Windows.Controls.WebBrowser>使用來流覽至 HTML 內容。</span><span class="sxs-lookup"><span data-stu-id="87e2d-221">This section also applies to the <xref:System.Windows.Controls.Frame> control since it uses the <xref:System.Windows.Controls.WebBrowser> to navigate to HTML content.</span></span>  
  
 <span data-ttu-id="87e2d-222">如果 WPF <xref:System.Windows.Controls.WebBrowser>控制項是用來裝載不受信任的 Web 內容, 您的應用程式應該使用<xref:System.AppDomain>部分信任, 協助將您的應用程式程式碼與可能惡意的 HTML 腳本隔離。</span><span class="sxs-lookup"><span data-stu-id="87e2d-222">If the WPF <xref:System.Windows.Controls.WebBrowser> control is used to host untrusted Web content, your application should use a partial-trust <xref:System.AppDomain> to help insulate your application code from potentially malicious HTML script code.</span></span> <span data-ttu-id="87e2d-223">特別是當您的應用程式使用<xref:System.Windows.Controls.WebBrowser.InvokeScript%2A>方法<xref:System.Windows.Controls.WebBrowser.ObjectForScripting%2A>和屬性與裝載的腳本互動時, 更是如此。</span><span class="sxs-lookup"><span data-stu-id="87e2d-223">This is especially true if your application is interacting with the hosted script by using the <xref:System.Windows.Controls.WebBrowser.InvokeScript%2A> method and the <xref:System.Windows.Controls.WebBrowser.ObjectForScripting%2A> property.</span></span> <span data-ttu-id="87e2d-224">如需詳細資訊, 請參閱[WPF 增益集總覽](./app-development/wpf-add-ins-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-224">For more information, see [WPF Add-Ins Overview](./app-development/wpf-add-ins-overview.md).</span></span>  
  
 <span data-ttu-id="87e2d-225">如果您的應用程式使用<xref:System.Windows.Controls.WebBrowser> WPF 控制項, 另一個增加安全性和緩和攻擊的方法, 就是啟用 Internet Explorer 功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-225">If your application uses the WPF <xref:System.Windows.Controls.WebBrowser> control, another way to increase security and mitigate attacks is to enable Internet Explorer feature controls.</span></span> <span data-ttu-id="87e2d-226">功能控制是 internet explorer 的新增專案, 可讓系統管理員和開發人員設定 internet explorer 的功能, 以及裝載 WebBrowser ActiveX 控制項的應用程式<xref:System.Windows.Controls.WebBrowser> (WPF 控制項會包裝此控制項)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-226">Feature controls are additions to Internet Explorer that allow administrators and developers to configure features of Internet Explorer and applications that host the WebBrowser ActiveX control, which the WPF <xref:System.Windows.Controls.WebBrowser> control wraps.</span></span> <span data-ttu-id="87e2d-227">您可以使用[CoInternetSetFeatureEnabled](https://go.microsoft.com/fwlink/?LinkId=179394)函數或變更登錄中的值, 來設定功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-227">Feature controls can be configured by using the [CoInternetSetFeatureEnabled](https://go.microsoft.com/fwlink/?LinkId=179394) function or by changing values in the registry.</span></span> <span data-ttu-id="87e2d-228">如需功能控制項的詳細資訊, 請參閱[功能控制項簡介](https://go.microsoft.com/fwlink/?LinkId=179390)和[網際網路功能控制項](https://go.microsoft.com/fwlink/?LinkId=179392)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-228">For more information about feature controls, see [Introduction to Feature Controls](https://go.microsoft.com/fwlink/?LinkId=179390) and [Internet Feature Controls](https://go.microsoft.com/fwlink/?LinkId=179392).</span></span>  
  
 <span data-ttu-id="87e2d-229">如果您要開發使用 wpf <xref:System.Windows.Controls.WebBrowser>控制項的獨立 WPF 應用程式, WPF 會自動為您的應用程式啟用下列功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-229">If you are developing a standalone WPF application that uses the WPF <xref:System.Windows.Controls.WebBrowser> control, WPF automatically enables the following feature controls for your application.</span></span>  
  
|<span data-ttu-id="87e2d-230">功能控制項</span><span class="sxs-lookup"><span data-stu-id="87e2d-230">Feature Control</span></span>|  
|---------------------|  
|<span data-ttu-id="87e2d-231">FEATURE_MIME_HANDLING</span><span class="sxs-lookup"><span data-stu-id="87e2d-231">FEATURE_MIME_HANDLING</span></span>|  
|<span data-ttu-id="87e2d-232">FEATURE_MIME_SNIFFING</span><span class="sxs-lookup"><span data-stu-id="87e2d-232">FEATURE_MIME_SNIFFING</span></span>|  
|<span data-ttu-id="87e2d-233">FEATURE_OBJECT_CACHING</span><span class="sxs-lookup"><span data-stu-id="87e2d-233">FEATURE_OBJECT_CACHING</span></span>|  
|<span data-ttu-id="87e2d-234">FEATURE_SAFE_BINDTOOBJECT</span><span class="sxs-lookup"><span data-stu-id="87e2d-234">FEATURE_SAFE_BINDTOOBJECT</span></span>|  
|<span data-ttu-id="87e2d-235">FEATURE_WINDOW_RESTRICTIONS</span><span class="sxs-lookup"><span data-stu-id="87e2d-235">FEATURE_WINDOW_RESTRICTIONS</span></span>|  
|<span data-ttu-id="87e2d-236">FEATURE_ZONE_ELEVATION</span><span class="sxs-lookup"><span data-stu-id="87e2d-236">FEATURE_ZONE_ELEVATION</span></span>|  
|<span data-ttu-id="87e2d-237">FEATURE_RESTRICT_FILEDOWNLOAD</span><span class="sxs-lookup"><span data-stu-id="87e2d-237">FEATURE_RESTRICT_FILEDOWNLOAD</span></span>|  
|<span data-ttu-id="87e2d-238">FEATURE_RESTRICT_ACTIVEXINSTALL</span><span class="sxs-lookup"><span data-stu-id="87e2d-238">FEATURE_RESTRICT_ACTIVEXINSTALL</span></span>|  
|<span data-ttu-id="87e2d-239">FEATURE_ADDON_MANAGEMENT</span><span class="sxs-lookup"><span data-stu-id="87e2d-239">FEATURE_ADDON_MANAGEMENT</span></span>|  
|<span data-ttu-id="87e2d-240">FEATURE_HTTP_USERNAME_PASSWORD_DISABLE</span><span class="sxs-lookup"><span data-stu-id="87e2d-240">FEATURE_HTTP_USERNAME_PASSWORD_DISABLE</span></span>|  
|<span data-ttu-id="87e2d-241">FEATURE_SECURITYBAND</span><span class="sxs-lookup"><span data-stu-id="87e2d-241">FEATURE_SECURITYBAND</span></span>|  
|<span data-ttu-id="87e2d-242">FEATURE_UNC_SAVEDFILECHECK</span><span class="sxs-lookup"><span data-stu-id="87e2d-242">FEATURE_UNC_SAVEDFILECHECK</span></span>|  
|<span data-ttu-id="87e2d-243">FEATURE_VALIDATE_NAVIGATE_URL</span><span class="sxs-lookup"><span data-stu-id="87e2d-243">FEATURE_VALIDATE_NAVIGATE_URL</span></span>|  
|<span data-ttu-id="87e2d-244">FEATURE_DISABLE_TELNET_PROTOCOL</span><span class="sxs-lookup"><span data-stu-id="87e2d-244">FEATURE_DISABLE_TELNET_PROTOCOL</span></span>|  
|<span data-ttu-id="87e2d-245">FEATURE_WEBOC_POPUPMANAGEMENT</span><span class="sxs-lookup"><span data-stu-id="87e2d-245">FEATURE_WEBOC_POPUPMANAGEMENT</span></span>|  
|<span data-ttu-id="87e2d-246">FEATURE_DISABLE_LEGACY_COMPRESSION</span><span class="sxs-lookup"><span data-stu-id="87e2d-246">FEATURE_DISABLE_LEGACY_COMPRESSION</span></span>|  
|<span data-ttu-id="87e2d-247">FEATURE_SSLUX</span><span class="sxs-lookup"><span data-stu-id="87e2d-247">FEATURE_SSLUX</span></span>|  
  
 <span data-ttu-id="87e2d-248">因為會無條件地啟用這些功能控制項，所以它們可能會損害完全信任應用程式。</span><span class="sxs-lookup"><span data-stu-id="87e2d-248">Since these feature controls are enabled unconditionally, a full-trust application might be impaired by them.</span></span> <span data-ttu-id="87e2d-249">在此情況下，如果特定應用程式和其所裝載的內容沒有安全性風險，則可以停用對應的功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-249">In this case, if there is no security risk for the specific application and the content it is hosting, the corresponding feature control can be disabled.</span></span>  
  
 <span data-ttu-id="87e2d-250">功能控制項是由具現化 WebBrowser ActiveX 物件的進程所套用。</span><span class="sxs-lookup"><span data-stu-id="87e2d-250">Feature controls are applied by the process instantiating the WebBrowser ActiveX object.</span></span> <span data-ttu-id="87e2d-251">因此，如果您要建立的獨立應用程式會巡覽到不受信任的內容，則應該認真考慮啟用其他功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-251">Therefore, if you are creating a stand-alone application that can navigate to untrusted content, you should seriously consider enabling additional feature controls.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="87e2d-252">這項建議根據 MSHTML 和 SHDOCVW 主機安全性的一般建議。</span><span class="sxs-lookup"><span data-stu-id="87e2d-252">This recommendation is based on general recommendations for MSHTML and SHDOCVW host security.</span></span> <span data-ttu-id="87e2d-253">如需詳細資訊, [請參閱 MSHTML 主機安全性常見問題:第 I](https://go.microsoft.com/fwlink/?LinkId=179396)部分和[MSHTML 主機安全性常見問題:II](https://go.microsoft.com/fwlink/?LinkId=179415)的第二部分。</span><span class="sxs-lookup"><span data-stu-id="87e2d-253">For more information, see [The MSHTML Host Security FAQ: Part I of II](https://go.microsoft.com/fwlink/?LinkId=179396) and [The MSHTML Host Security FAQ: Part II of II](https://go.microsoft.com/fwlink/?LinkId=179415).</span></span>  
  
 <span data-ttu-id="87e2d-254">針對可執行檔，請考慮將登錄值設定為 1 來啟用下列功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-254">For your executable, consider enabling the following feature controls by setting the registry value to 1.</span></span>  
  
|<span data-ttu-id="87e2d-255">功能控制項</span><span class="sxs-lookup"><span data-stu-id="87e2d-255">Feature Control</span></span>|  
|---------------------|  
|<span data-ttu-id="87e2d-256">FEATURE_ACTIVEX_REPURPOSEDETECTION</span><span class="sxs-lookup"><span data-stu-id="87e2d-256">FEATURE_ACTIVEX_REPURPOSEDETECTION</span></span>|  
|<span data-ttu-id="87e2d-257">FEATURE_BLOCK_LMZ_IMG</span><span class="sxs-lookup"><span data-stu-id="87e2d-257">FEATURE_BLOCK_LMZ_IMG</span></span>|  
|<span data-ttu-id="87e2d-258">FEATURE_BLOCK_LMZ_OBJECT</span><span class="sxs-lookup"><span data-stu-id="87e2d-258">FEATURE_BLOCK_LMZ_OBJECT</span></span>|  
|<span data-ttu-id="87e2d-259">FEATURE_BLOCK_LMZ_SCRIPT</span><span class="sxs-lookup"><span data-stu-id="87e2d-259">FEATURE_BLOCK_LMZ_SCRIPT</span></span>|  
|<span data-ttu-id="87e2d-260">FEATURE_RESTRICT_RES_TO_LMZ</span><span class="sxs-lookup"><span data-stu-id="87e2d-260">FEATURE_RESTRICT_RES_TO_LMZ</span></span>|  
|<span data-ttu-id="87e2d-261">FEATURE_RESTRICT_ABOUT_PROTOCOL_IE7</span><span class="sxs-lookup"><span data-stu-id="87e2d-261">FEATURE_RESTRICT_ABOUT_PROTOCOL_IE7</span></span>|  
|<span data-ttu-id="87e2d-262">FEATURE_SHOW_APP_PROTOCOL_WARN_DIALOG</span><span class="sxs-lookup"><span data-stu-id="87e2d-262">FEATURE_SHOW_APP_PROTOCOL_WARN_DIALOG</span></span>|  
|<span data-ttu-id="87e2d-263">FEATURE_LOCALMACHINE_LOCKDOWN</span><span class="sxs-lookup"><span data-stu-id="87e2d-263">FEATURE_LOCALMACHINE_LOCKDOWN</span></span>|  
|<span data-ttu-id="87e2d-264">FEATURE_FORCE_ADDR_AND_STATUS</span><span class="sxs-lookup"><span data-stu-id="87e2d-264">FEATURE_FORCE_ADDR_AND_STATUS</span></span>|  
|<span data-ttu-id="87e2d-265">FEATURE_RESTRICTED_ZONE_WHEN_FILE_NOT_FOUND</span><span class="sxs-lookup"><span data-stu-id="87e2d-265">FEATURE_RESTRICTED_ZONE_WHEN_FILE_NOT_FOUND</span></span>|  
  
 <span data-ttu-id="87e2d-266">針對可執行檔，請考慮將登錄值設定為 0 來停用下列功能控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-266">For your executable, consider disabling the following feature control by setting the registry value to 0.</span></span>  
  
|<span data-ttu-id="87e2d-267">功能控制項</span><span class="sxs-lookup"><span data-stu-id="87e2d-267">Feature Control</span></span>|  
|---------------------|  
|<span data-ttu-id="87e2d-268">FEATURE_ENABLE_SCRIPT_PASTE_URLACTION_IF_PROMPT</span><span class="sxs-lookup"><span data-stu-id="87e2d-268">FEATURE_ENABLE_SCRIPT_PASTE_URLACTION_IF_PROMPT</span></span>|  
  
 <span data-ttu-id="87e2d-269">如果您在 Windows internet explorer 中[!INCLUDE[TLA#tla_xbap](../../../includes/tlasharptla-xbap-md.md)]執行包含 WPF <xref:System.Windows.Controls.WebBrowser>控制項的部分信任, WPF 會在 Internet explorer 進程的位址空間中裝載 WebBrowser ActiveX 控制項。</span><span class="sxs-lookup"><span data-stu-id="87e2d-269">If you run a partial-trust [!INCLUDE[TLA#tla_xbap](../../../includes/tlasharptla-xbap-md.md)] that includes a WPF <xref:System.Windows.Controls.WebBrowser> control in Windows Internet Explorer, WPF hosts the WebBrowser ActiveX control in the address space of the Internet Explorer process.</span></span> <span data-ttu-id="87e2d-270">由於 WebBrowser ActiveX 控制項裝載于 Internet Explorer 進程中, 因此 Internet Explorer 的所有功能控制也會針對 WebBrowser ActiveX 控制項啟用。</span><span class="sxs-lookup"><span data-stu-id="87e2d-270">Since the WebBrowser ActiveX control is hosted in the Internet Explorer process, all of the feature controls for Internet Explorer are also enabled for the WebBrowser ActiveX control.</span></span>  
  
 <span data-ttu-id="87e2d-271">與一般獨立應用程式相較之下，在 Internet Explorer 中執行的 XBAP 也會取得額外層級的安全性。</span><span class="sxs-lookup"><span data-stu-id="87e2d-271">XBAPs running in Internet Explorer also get an additional level of security compared to normal standalone applications.</span></span> <span data-ttu-id="87e2d-272">這項額外的安全性是因為 Internet Explorer (因此 WebBrowser ActiveX 控制項) 預設會在和[!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] [!INCLUDE[win7](../../../includes/win7-md.md)]上以受保護模式執行。</span><span class="sxs-lookup"><span data-stu-id="87e2d-272">This additional security is because Internet Explorer, and therefore the WebBrowser ActiveX control, runs in protected mode by default on [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] and [!INCLUDE[win7](../../../includes/win7-md.md)].</span></span> <span data-ttu-id="87e2d-273">如需受保護模式的詳細資訊, 請參閱[瞭解及使用受保護模式的 Internet Explorer](https://go.microsoft.com/fwlink/?LinkId=179393)。</span><span class="sxs-lookup"><span data-stu-id="87e2d-273">For more information about protected mode, see [Understanding and Working in Protected Mode Internet Explorer](https://go.microsoft.com/fwlink/?LinkId=179393).</span></span>  
  
> [!NOTE]
> <span data-ttu-id="87e2d-274">如果您嘗試在 Firefox 中執行包含 WPF <xref:System.Windows.Controls.WebBrowser>控制項的 XBAP, 而在網際網路區域中<xref:System.Security.SecurityException> , 則會擲回。</span><span class="sxs-lookup"><span data-stu-id="87e2d-274">If you try to run an XBAP that includes a WPF <xref:System.Windows.Controls.WebBrowser> control in Firefox, while in the Internet zone, a <xref:System.Security.SecurityException> will be thrown.</span></span> <span data-ttu-id="87e2d-275">這是因為 WPF 安全性原則。</span><span class="sxs-lookup"><span data-stu-id="87e2d-275">This is due to WPF security policy.</span></span>  
  
<a name="APTCA"></a>   
## <a name="disabling-aptca-assemblies-for-partially-trusted-client-applications"></a><span data-ttu-id="87e2d-276">停用部分信任用戶端應用程式的 APTCA 組件</span><span class="sxs-lookup"><span data-stu-id="87e2d-276">Disabling APTCA Assemblies for Partially Trusted Client Applications</span></span>  
 <span data-ttu-id="87e2d-277">當 managed 元件安裝到全域組件快取 (GAC) 時, 它們會變成完全信任, 因為使用者必須提供明確的許可權才能進行安裝。</span><span class="sxs-lookup"><span data-stu-id="87e2d-277">When managed assemblies are installed into the global assembly cache (GAC), they become fully trusted because the user must provide explicit permission to install them.</span></span> <span data-ttu-id="87e2d-278">因為它們完全受信任，所以只有完全受信任的受管理用戶端應用程式才能使用它們。</span><span class="sxs-lookup"><span data-stu-id="87e2d-278">Because they are fully trusted, only fully trusted managed client applications can use them.</span></span> <span data-ttu-id="87e2d-279">若要允許部分信任的應用程式使用它們, 則必須以<xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA) 標記。</span><span class="sxs-lookup"><span data-stu-id="87e2d-279">To allow partially trusted applications to use them, they must be marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA).</span></span> <span data-ttu-id="87e2d-280">只有經過測試可在部分信任中安全執行的組件才應該標記這個屬性。</span><span class="sxs-lookup"><span data-stu-id="87e2d-280">Only assemblies that have been tested to be safe for execution in partial trust should be marked with this attribute.</span></span>  
  
 <span data-ttu-id="87e2d-281">不過, APTCA 元件可能會在安裝到 GAC 後出現安全性缺陷。</span><span class="sxs-lookup"><span data-stu-id="87e2d-281">However, it is possible for an APTCA assembly to exhibit a security flaw after being installed into the  GAC .</span></span> <span data-ttu-id="87e2d-282">發現安全性缺陷之後，組件發行者可以產生安全性更新來修正現有安裝上的問題，以及防止在發現問題之後可能進行的安裝。</span><span class="sxs-lookup"><span data-stu-id="87e2d-282">Once a security flaw is discovered, assembly publishers can produce a security update to fix the problem on existing installations, and to protect against installations that may occur after the problem is discovered.</span></span> <span data-ttu-id="87e2d-283">雖然解除安裝組件可能會中斷其他使用組件的完全信任用戶端應用程式，但是更新的其中一個選項是解除安裝組件。</span><span class="sxs-lookup"><span data-stu-id="87e2d-283">One option for the update is to uninstall the assembly, although that may break other fully trusted client applications that use the assembly.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="87e2d-284">提供一種機制, 可讓 aptca 元件停用部分信任[!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)] , 而不需要卸載 aptca 元件。</span><span class="sxs-lookup"><span data-stu-id="87e2d-284">provides a mechanism by which an APTCA assembly can be disabled for partially trusted [!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)] without uninstalling the APTCA assembly.</span></span>  
  
 <span data-ttu-id="87e2d-285">若要停用 APTCA 組件，您必須建立特殊登錄機碼︰</span><span class="sxs-lookup"><span data-stu-id="87e2d-285">To disable an APTCA assembly, you have to create a special registry key:</span></span>  
  
 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\policy\APTCA\<AssemblyFullName>, FileVersion=<AssemblyFileVersion>`  
  
 <span data-ttu-id="87e2d-286">下列示範範例：</span><span class="sxs-lookup"><span data-stu-id="87e2d-286">The following shows an example:</span></span>  
  
 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\policy\APTCA\aptcagac, Version=1.0.0.0, Culture=neutral, PublicKeyToken=215e3ac809a0fea7, FileVersion=1.0.0.0`  
  
 <span data-ttu-id="87e2d-287">此機碼會為 APTCA 組件建立一個項目。</span><span class="sxs-lookup"><span data-stu-id="87e2d-287">This key establishes an entry for the APTCA assembly.</span></span> <span data-ttu-id="87e2d-288">您也必須在這個機碼中建立啟用或停用組件的數值。</span><span class="sxs-lookup"><span data-stu-id="87e2d-288">You also have to create a value in this key that enables or disables the assembly.</span></span> <span data-ttu-id="87e2d-289">數值的詳細資料如下︰</span><span class="sxs-lookup"><span data-stu-id="87e2d-289">The following are the details of the value:</span></span>  
  
- <span data-ttu-id="87e2d-290">值名稱:**APTCA_FLAG**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-290">Value Name: **APTCA_FLAG**.</span></span>  
  
- <span data-ttu-id="87e2d-291">數值型別:**REG_DWORD**。</span><span class="sxs-lookup"><span data-stu-id="87e2d-291">Value Type: **REG_DWORD**.</span></span>  
  
- <span data-ttu-id="87e2d-292">數值資料:**1**表示停用;**0**表示啟用。</span><span class="sxs-lookup"><span data-stu-id="87e2d-292">Value Data: **1** to disable; **0** to enable.</span></span>  
  
 <span data-ttu-id="87e2d-293">如果必須停用部分信任用戶端應用程式的組件，您可以撰寫可建立登錄機碼和值的更新。</span><span class="sxs-lookup"><span data-stu-id="87e2d-293">If an assembly has to be disabled for partially trusted client applications, you can write an update that creates the registry key and value.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="87e2d-294">核心 .NET Framework 元件不會受到以這種方式停用的影響, 因為受控應用程式必須執行它們。</span><span class="sxs-lookup"><span data-stu-id="87e2d-294">Core .NET Framework assemblies are not affected by disabling them in this way because they are required for managed applications to run.</span></span> <span data-ttu-id="87e2d-295">停用 APTCA 組件的支援主要是針對協力廠商應用程式。</span><span class="sxs-lookup"><span data-stu-id="87e2d-295">Support for disabling APTCA assemblies is primarily targeted to third-party applications.</span></span>  
  
<a name="LooseContentSandboxing"></a>   
## <a name="sandbox-behavior-for-loose-xaml-files"></a><span data-ttu-id="87e2d-296">鬆散 XAML 檔案的沙箱行為</span><span class="sxs-lookup"><span data-stu-id="87e2d-296">Sandbox Behavior for Loose XAML Files</span></span>  
 <span data-ttu-id="87e2d-297">鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案是僅限標記的 XAML 檔案, 不相依于任何程式碼後置、事件處理常式或應用程式特定的元件。</span><span class="sxs-lookup"><span data-stu-id="87e2d-297">Loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files are markup-only XAML files that do not depend on any code-behind, event handler, or application-specific assembly.</span></span> <span data-ttu-id="87e2d-298">直接從[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]瀏覽器導覽到鬆散檔案時, 會根據預設的網際網路區域許可權集合, 將它們載入至安全性沙箱。</span><span class="sxs-lookup"><span data-stu-id="87e2d-298">When loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files are navigated to directly from the browser, they are loaded in a security sandbox based on the default Internet zone permission set.</span></span>  
  
 <span data-ttu-id="87e2d-299">不過, 當從或[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] <xref:System.Windows.Controls.Frame>獨立應用程式中的<xref:System.Windows.Navigation.NavigationWindow>鬆散檔案流覽至時, 安全性行為會有所不同。</span><span class="sxs-lookup"><span data-stu-id="87e2d-299">However, the security behavior is different when loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files are navigated to from either a <xref:System.Windows.Navigation.NavigationWindow> or <xref:System.Windows.Controls.Frame> in a standalone application.</span></span>  
  
 <span data-ttu-id="87e2d-300">在這兩種情況下[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] , 流覽至的鬆散檔案會繼承其主應用程式的許可權。</span><span class="sxs-lookup"><span data-stu-id="87e2d-300">In both cases, the loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] file that is navigated to inherits the permissions of its host application.</span></span> <span data-ttu-id="87e2d-301">不過, 此行為可能會因為安全性的觀點而不需要, 特別是[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]如果鬆散檔案是由不受信任或未知的實體所產生。</span><span class="sxs-lookup"><span data-stu-id="87e2d-301">However, this behavior may be undesirable from a security perspective, particularly if a loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] file was produced by an entity that is either not trusted or unknown.</span></span> <span data-ttu-id="87e2d-302">這種類型的內容稱為*外部內容*, 而且和<xref:System.Windows.Controls.Frame> <xref:System.Windows.Navigation.NavigationWindow>都可以設定為在流覽至時加以隔離。</span><span class="sxs-lookup"><span data-stu-id="87e2d-302">This type of content is known as *external content*, and both <xref:System.Windows.Controls.Frame> and <xref:System.Windows.Navigation.NavigationWindow> can be configured to isolate it when navigated to.</span></span> <span data-ttu-id="87e2d-303">藉由將**SandboxExternalContent**屬性設為 true 來達成隔離, 如下列<xref:System.Windows.Controls.Frame>和<xref:System.Windows.Navigation.NavigationWindow>的範例所示:</span><span class="sxs-lookup"><span data-stu-id="87e2d-303">Isolation is achieved by setting the **SandboxExternalContent** property to true, as shown in the following examples for <xref:System.Windows.Controls.Frame> and <xref:System.Windows.Navigation.NavigationWindow>:</span></span>  
  
 [!code-xaml[SecurityOverviewSnippets#FrameMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/SecurityOverviewSnippets/CS/Window2.xaml#framemarkup)]  
  
 [!code-xaml[SecurityOverviewSnippets#NavigationWindowMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/SecurityOverviewSnippets/CS/Window1.xaml#navigationwindowmarkup)]  
  
 <span data-ttu-id="87e2d-304">使用此設定，會將外部內容載入與裝載應用程式的程序不同的程序。</span><span class="sxs-lookup"><span data-stu-id="87e2d-304">With this setting, external content will be loaded into a process that is separate from the process that is hosting the application.</span></span> <span data-ttu-id="87e2d-305">此程序僅限於預設網際網路區域權限集，可有效地隔離它與裝載應用程式和用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="87e2d-305">This process is restricted to the default Internet zone permission set, effectively isolating it from the hosting application and the client computer.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="87e2d-306">即使從[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] <xref:System.Windows.Navigation.NavigationWindow>或在獨立應用程式中流覽到鬆散檔案,也是根據WPF瀏覽器裝載基礎結構(涉及presentationhost.exe程式)來執行,安全性層級是<xref:System.Windows.Controls.Frame>將內容直接載入到 Internet Explorer 的[!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)]和[!INCLUDE[win7](../../../includes/win7-md.md)] (仍然是透過 presentationhost.exe) 時稍微小於。</span><span class="sxs-lookup"><span data-stu-id="87e2d-306">Even though navigation to loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files from either a <xref:System.Windows.Navigation.NavigationWindow> or <xref:System.Windows.Controls.Frame> in a standalone application is implemented based on the WPF browser hosting infrastructure, involving the PresentationHost process, the security level is slightly less than when the content is loaded directly in Internet Explorer on [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] and [!INCLUDE[win7](../../../includes/win7-md.md)] (which would still be through PresentationHost).</span></span> <span data-ttu-id="87e2d-307">這是因為使用 Web 瀏覽器的獨立 WPF 應用程式不會提供 Internet Explorer 的額外受保護模式安全性功能。</span><span class="sxs-lookup"><span data-stu-id="87e2d-307">This is because a standalone WPF application using a Web browser does not provide the additional Protected Mode security feature of Internet Explorer.</span></span>  
  
<a name="BestPractices"></a>   
## <a name="resources-for-developing-wpf-applications-that-promote-security"></a><span data-ttu-id="87e2d-308">用於開發可提高安全性的 WPF 應用程式的資源</span><span class="sxs-lookup"><span data-stu-id="87e2d-308">Resources for Developing WPF Applications that Promote Security</span></span>  
 <span data-ttu-id="87e2d-309">以下是一些額外的資源, 可協助[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]開發提升安全性的應用程式:</span><span class="sxs-lookup"><span data-stu-id="87e2d-309">The following are some additional resources to help develop [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications that promote security:</span></span>  
  
|<span data-ttu-id="87e2d-310">區域</span><span class="sxs-lookup"><span data-stu-id="87e2d-310">Area</span></span>|<span data-ttu-id="87e2d-311">Resource</span><span class="sxs-lookup"><span data-stu-id="87e2d-311">Resource</span></span>|  
|----------|--------------|  
|<span data-ttu-id="87e2d-312">Managed 程式碼</span><span class="sxs-lookup"><span data-stu-id="87e2d-312">Managed code</span></span>|<span data-ttu-id="87e2d-313">[Patterns and Practices Security Guidance for Applications](https://go.microsoft.com/fwlink/?LinkId=117426) (應用程式的模式和實務安全性指南)</span><span class="sxs-lookup"><span data-stu-id="87e2d-313">[Patterns and Practices Security Guidance for Applications](https://go.microsoft.com/fwlink/?LinkId=117426)</span></span>|  
|<span data-ttu-id="87e2d-314">CAS</span><span class="sxs-lookup"><span data-stu-id="87e2d-314">CAS</span></span>|[<span data-ttu-id="87e2d-315">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-315">Code Access Security</span></span>](../misc/code-access-security.md)|  
|<span data-ttu-id="87e2d-316">ClickOnce</span><span class="sxs-lookup"><span data-stu-id="87e2d-316">ClickOnce</span></span>|[<span data-ttu-id="87e2d-317">ClickOnce 安全性和部署</span><span class="sxs-lookup"><span data-stu-id="87e2d-317">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)|  
|[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]|[<span data-ttu-id="87e2d-318">WPF 部分信任安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-318">WPF Partial Trust Security</span></span>](wpf-partial-trust-security.md)|  
  
## <a name="see-also"></a><span data-ttu-id="87e2d-319">另請參閱</span><span class="sxs-lookup"><span data-stu-id="87e2d-319">See also</span></span>

- [<span data-ttu-id="87e2d-320">WPF 部分信任安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-320">WPF Partial Trust Security</span></span>](wpf-partial-trust-security.md)
- [<span data-ttu-id="87e2d-321">WPF 安全性策略 – 平台安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-321">WPF Security Strategy - Platform Security</span></span>](wpf-security-strategy-platform-security.md)
- [<span data-ttu-id="87e2d-322">WPF 安全性策略 – 安全性工程</span><span class="sxs-lookup"><span data-stu-id="87e2d-322">WPF Security Strategy - Security Engineering</span></span>](wpf-security-strategy-security-engineering.md)
- <span data-ttu-id="87e2d-323">[Patterns and Practices Security Guidance for Applications](https://go.microsoft.com/fwlink/?LinkId=117426) (應用程式的模式和實務安全性指南)</span><span class="sxs-lookup"><span data-stu-id="87e2d-323">[Patterns and Practices Security Guidance for Applications](https://go.microsoft.com/fwlink/?LinkId=117426)</span></span>
- [<span data-ttu-id="87e2d-324">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="87e2d-324">Code Access Security</span></span>](../misc/code-access-security.md)
- [<span data-ttu-id="87e2d-325">ClickOnce 安全性和部署</span><span class="sxs-lookup"><span data-stu-id="87e2d-325">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)
- [<span data-ttu-id="87e2d-326">XAML 概觀 (WPF)</span><span class="sxs-lookup"><span data-stu-id="87e2d-326">XAML Overview (WPF)</span></span>](./advanced/xaml-overview-wpf.md)
