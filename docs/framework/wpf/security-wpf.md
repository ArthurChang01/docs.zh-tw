---
title: 安全性 (WPF)
ms.date: 03/30/2017
helpviewer_keywords:
- XAML files [WPF], sandbox behavior
- browser-hosted application security [WPF]
- application security [WPF]
- navigation security [WPF]
- loose XAML files [WPF], sandbox behavior
- WPF security [WPF]
- WebBrowser control [WPF], security
- feature controls [WPF], security
- XBAP security [WPF]
- Internet Explorer security settings [WPF]
ms.assetid: ee1baea0-3611-4e36-9ad6-fcd5205376fb
ms.openlocfilehash: 968913a52a1d86746498aed7c97b63594d346a31
ms.sourcegitcommit: 558d78d2a68acd4c95ef23231c8b4e4c7bac3902
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/09/2019
ms.locfileid: "59313563"
---
# <a name="security-wpf"></a><span data-ttu-id="37979-102">安全性 (WPF)</span><span class="sxs-lookup"><span data-stu-id="37979-102">Security (WPF)</span></span>
<a name="introduction"></a> <span data-ttu-id="37979-103">在開發 Windows Presentation Foundation (WPF) 獨立和瀏覽器裝載的應用程式時，您必須考量的安全性模型。</span><span class="sxs-lookup"><span data-stu-id="37979-103">When developing Windows Presentation Foundation (WPF) standalone and browser-hosted applications, you must consider the security model.</span></span> [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="37979-104">獨立應用程式使用不受限制的權限執行 ( [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)] **FullTrust**權限集合)，不論部署使用 Windows Installer (.msi)、 XCopy 或[!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="37979-104">standalone applications execute with unrestricted permissions ( [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]**FullTrust** permission set), whether deployed using Windows Installer (.msi), XCopy, or [!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)].</span></span> <span data-ttu-id="37979-105">不支援使用 ClickOnce 部署部分信任的獨立 WPF 應用程式。</span><span class="sxs-lookup"><span data-stu-id="37979-105">Deploying partial-trust, standalone WPF applications with ClickOnce is unsupported.</span></span> <span data-ttu-id="37979-106">不過，完全信任主應用程式可以建立部分信任<xref:System.AppDomain>使用.NET Framework 增益集模型。</span><span class="sxs-lookup"><span data-stu-id="37979-106">However, a full-trust host application can create a partial-trust <xref:System.AppDomain> using the .NET Framework Add-in model.</span></span> <span data-ttu-id="37979-107">如需詳細資訊，請參閱 < [WPF 增益集概觀](./app-development/wpf-add-ins-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="37979-107">For more information, see [WPF Add-Ins Overview](./app-development/wpf-add-ins-overview.md).</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="37979-108">瀏覽器裝載的應用程式所裝載的[!INCLUDE[TLA#tla_iegeneric](../../../includes/tlasharptla-iegeneric-md.md)]或 Firefox，而且可以是[!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)]或鬆散[!INCLUDE[TLA#tla_xaml](../../../includes/tlasharptla-xaml-md.md)]文件，如需詳細資訊，請參閱[WPF XAML 瀏覽器應用程式概觀](./app-development/wpf-xaml-browser-applications-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="37979-108">browser-hosted applications are hosted by [!INCLUDE[TLA#tla_iegeneric](../../../includes/tlasharptla-iegeneric-md.md)] or Firefox, and can be either [!INCLUDE[TLA#tla_xbap#plural](../../../includes/tlasharptla-xbapsharpplural-md.md)] or loose [!INCLUDE[TLA#tla_xaml](../../../includes/tlasharptla-xaml-md.md)] documents For more information, see [WPF XAML Browser Applications Overview](./app-development/wpf-xaml-browser-applications-overview.md).</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="37979-109">瀏覽器裝載的應用程式執行部分信任安全性沙箱內，根據預設，預設值僅限於[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]**網際網路**區域的權限集。</span><span class="sxs-lookup"><span data-stu-id="37979-109">browser-hosted applications execute within a partial trust security sandbox, by default, which is limited to the default [!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]**Internet** zone permission set.</span></span> <span data-ttu-id="37979-110">這會有效地隔離[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]瀏覽器裝載的應用程式從用戶端電腦，您會預期隔離一般 Web 應用程式的方式相同。</span><span class="sxs-lookup"><span data-stu-id="37979-110">This effectively isolates [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] browser-hosted applications from the client computer in the same way that you would expect typical Web applications to be isolated.</span></span> <span data-ttu-id="37979-111">XBAP 可以根據部署 URL 的安全性區域以及用戶端的安全性組態來提高權限，而最高為「完全信任」。</span><span class="sxs-lookup"><span data-stu-id="37979-111">An XBAP can elevate privileges, up to Full Trust, depending on the security zone of the deployment URL and the client's security configuration.</span></span> <span data-ttu-id="37979-112">如需詳細資訊，請參閱 [WPF 部分信任安全性](wpf-partial-trust-security.md)。</span><span class="sxs-lookup"><span data-stu-id="37979-112">For more information, see [WPF Partial Trust Security](wpf-partial-trust-security.md).</span></span>  
  
 <span data-ttu-id="37979-113">本主題討論 Windows Presentation Foundation (WPF) 獨立和瀏覽器裝載的應用程式的安全性模型。</span><span class="sxs-lookup"><span data-stu-id="37979-113">This topic discusses the security model for Windows Presentation Foundation (WPF) standalone and browser-hosted applications.</span></span>  
  
 <span data-ttu-id="37979-114">此主題包括下列章節：</span><span class="sxs-lookup"><span data-stu-id="37979-114">This topic contains the following sections:</span></span>  
  
-   [<span data-ttu-id="37979-115">安全巡覽</span><span class="sxs-lookup"><span data-stu-id="37979-115">Safe Navigation</span></span>](#SafeTopLevelNavigation)  
  
-   [<span data-ttu-id="37979-116">Web 瀏覽軟體安全性設定</span><span class="sxs-lookup"><span data-stu-id="37979-116">Web Browsing Software Security Settings</span></span>](#InternetExplorerSecuritySettings)  
  
-   [<span data-ttu-id="37979-117">WebBrowser 控制項和功能控制項</span><span class="sxs-lookup"><span data-stu-id="37979-117">WebBrowser Control and Feature Controls</span></span>](#webbrowser_control_and_feature_controls)  
  
-   [<span data-ttu-id="37979-118">停用部分信任用戶端應用程式的 APTCA 組件</span><span class="sxs-lookup"><span data-stu-id="37979-118">Disabling APTCA Assemblies for Partially Trusted Client Applications</span></span>](#APTCA)  
  
-   [<span data-ttu-id="37979-119">鬆散 XAML 檔案的沙箱行為</span><span class="sxs-lookup"><span data-stu-id="37979-119">Sandbox Behavior for Loose XAML Files</span></span>](#LooseContentSandboxing)  
  
-   [<span data-ttu-id="37979-120">用於開發可提高安全性的 WPF 應用程式的資源</span><span class="sxs-lookup"><span data-stu-id="37979-120">Resources for Developing WPF Applications that Promote Security</span></span>](#BestPractices)  
  
<a name="SafeTopLevelNavigation"></a>   
## <a name="safe-navigation"></a><span data-ttu-id="37979-121">安全巡覽</span><span class="sxs-lookup"><span data-stu-id="37979-121">Safe Navigation</span></span>  
 <span data-ttu-id="37979-122">針對[!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)]，[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]區分兩種類型的 瀏覽： 應用程式和瀏覽器。</span><span class="sxs-lookup"><span data-stu-id="37979-122">For [!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)], [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] distinguishes two types of navigation: application and browser.</span></span>  
  
 <span data-ttu-id="37979-123">「應用程式巡覽」是瀏覽器所裝載之應用程式的內容項目間的巡覽。</span><span class="sxs-lookup"><span data-stu-id="37979-123">*Application navigation* is navigation between items of content within an application that is hosted by a browser.</span></span> <span data-ttu-id="37979-124">「瀏覽器巡覽」是變更瀏覽器本身的內容和位置 URL 的巡覽。</span><span class="sxs-lookup"><span data-stu-id="37979-124">*Browser navigation* is navigation that changes the content and location URL of a browser itself.</span></span> <span data-ttu-id="37979-125">應用程式巡覽 (通常是 XAML) 與瀏覽器巡覽 (通常是 HTML) 之間的關聯性是由下列圖所示：</span><span class="sxs-lookup"><span data-stu-id="37979-125">The relationship between application navigation (typically XAML) and browser navigation (typically HTML) is shown in the following illustration:</span></span>
  
 ![應用程式瀏覽和瀏覽器巡覽關聯性。](./media/security-wpf/application-browser-navigation-relationship.png)  
  
 <span data-ttu-id="37979-127">會被視為安全的內容類型[!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)]瀏覽至主要取決於是否使用應用程式巡覽還是瀏覽器瀏覽。</span><span class="sxs-lookup"><span data-stu-id="37979-127">The type of content that is considered safe for an [!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)] to navigate to is primarily determined by whether application navigation or browser navigation is used.</span></span>  
  
<a name="Application_Navigation_Security"></a>   
### <a name="application-navigation-security"></a><span data-ttu-id="37979-128">應用程式巡覽安全性</span><span class="sxs-lookup"><span data-stu-id="37979-128">Application Navigation Security</span></span>  
 <span data-ttu-id="37979-129">應用程式巡覽視為安全，如果可以用來識別它的組件[!INCLUDE[TLA2#tla_uri](../../../includes/tla2sharptla-uri-md.md)]，可支援四種類型的內容：</span><span class="sxs-lookup"><span data-stu-id="37979-129">Application navigation is considered safe if it can be identified with a pack [!INCLUDE[TLA2#tla_uri](../../../includes/tla2sharptla-uri-md.md)], which supports four types of content:</span></span>  
  
|<span data-ttu-id="37979-130">內容類型</span><span class="sxs-lookup"><span data-stu-id="37979-130">Content Type</span></span>|<span data-ttu-id="37979-131">描述</span><span class="sxs-lookup"><span data-stu-id="37979-131">Description</span></span>|<span data-ttu-id="37979-132">URI 範例</span><span class="sxs-lookup"><span data-stu-id="37979-132">URI Example</span></span>|  
|------------------|-----------------|-----------------|  
|<span data-ttu-id="37979-133">資源</span><span class="sxs-lookup"><span data-stu-id="37979-133">Resource</span></span>|<span data-ttu-id="37979-134">新增至組建類型為專案的檔案**資源**。</span><span class="sxs-lookup"><span data-stu-id="37979-134">Files that are added to a project with a build type of **Resource**.</span></span>|`pack://application:,,,/MyResourceFile.xaml`|  
|<span data-ttu-id="37979-135">內容</span><span class="sxs-lookup"><span data-stu-id="37979-135">Content</span></span>|<span data-ttu-id="37979-136">新增至組建類型為專案的檔案**內容**。</span><span class="sxs-lookup"><span data-stu-id="37979-136">Files that are added to a project with a build type of **Content**.</span></span>|`pack://application:,,,/MyContentFile.xaml`|  
|<span data-ttu-id="37979-137">Site of origin</span><span class="sxs-lookup"><span data-stu-id="37979-137">Site of origin</span></span>|<span data-ttu-id="37979-138">新增至組建類型為專案的檔案**無**。</span><span class="sxs-lookup"><span data-stu-id="37979-138">Files that are added to a project with a build type of **None**.</span></span>|`pack://siteoforigin:,,,/MySiteOfOriginFile.xaml`|  
|<span data-ttu-id="37979-139">應用程式程式碼</span><span class="sxs-lookup"><span data-stu-id="37979-139">Application code</span></span>|<span data-ttu-id="37979-140">具有已編譯程式碼後置的 XAML 資源。</span><span class="sxs-lookup"><span data-stu-id="37979-140">XAML resources that have a compiled code-behind.</span></span><br /><br /> <span data-ttu-id="37979-141">-或-</span><span class="sxs-lookup"><span data-stu-id="37979-141">-or-</span></span><br /><br /> <span data-ttu-id="37979-142">新增至組建類型為專案的 XAML 檔案**網頁**。</span><span class="sxs-lookup"><span data-stu-id="37979-142">XAML files that are added to a project with a build type of **Page**.</span></span>|`pack://application:,,,/MyResourceFile` `.xaml`|  
  
> [!NOTE]
>  <span data-ttu-id="37979-143">如需應用程式資料檔案和組件的詳細資訊[!INCLUDE[TLA2#tla_uri#plural](../../../includes/tla2sharptla-urisharpplural-md.md)]，請參閱 < [WPF 應用程式資源、 內容和資料檔案](./app-development/wpf-application-resource-content-and-data-files.md)。</span><span class="sxs-lookup"><span data-stu-id="37979-143">For more information about application data files and pack [!INCLUDE[TLA2#tla_uri#plural](../../../includes/tla2sharptla-urisharpplural-md.md)], see [WPF Application Resource, Content, and Data Files](./app-development/wpf-application-resource-content-and-data-files.md).</span></span>  
  
 <span data-ttu-id="37979-144">使用者或透過程式設計方式可以巡覽到這些內容類型的檔案︰</span><span class="sxs-lookup"><span data-stu-id="37979-144">Files of these content types can be navigated to by either the user or programmatically:</span></span>  
  
-   <span data-ttu-id="37979-145">**使用者巡覽**。</span><span class="sxs-lookup"><span data-stu-id="37979-145">**User Navigation**.</span></span> <span data-ttu-id="37979-146">使用者瀏覽，即可<xref:System.Windows.Documents.Hyperlink>項目。</span><span class="sxs-lookup"><span data-stu-id="37979-146">The user navigates by clicking a <xref:System.Windows.Documents.Hyperlink> element.</span></span>  
  
-   <span data-ttu-id="37979-147">**程式設計巡覽**。</span><span class="sxs-lookup"><span data-stu-id="37979-147">**Programmatic Navigation**.</span></span> <span data-ttu-id="37979-148">應用程式即可在不需要使用者，例如，藉由設定<xref:System.Windows.Navigation.NavigationWindow.Source%2A?displayProperty=nameWithType>屬性。</span><span class="sxs-lookup"><span data-stu-id="37979-148">The application navigates without involving the user, for example, by setting the <xref:System.Windows.Navigation.NavigationWindow.Source%2A?displayProperty=nameWithType> property.</span></span>  
  
<a name="Browser_Navigation_Security"></a>   
### <a name="browser-navigation-security"></a><span data-ttu-id="37979-149">瀏覽器巡覽安全性</span><span class="sxs-lookup"><span data-stu-id="37979-149">Browser Navigation Security</span></span>  
 <span data-ttu-id="37979-150">只有在下列情況下，才會將瀏覽器巡覽視為安全：</span><span class="sxs-lookup"><span data-stu-id="37979-150">Browser navigation is considered safe only under the following conditions:</span></span>  
  
-   <span data-ttu-id="37979-151">**使用者巡覽**。</span><span class="sxs-lookup"><span data-stu-id="37979-151">**User Navigation**.</span></span> <span data-ttu-id="37979-152">使用者瀏覽，即可<xref:System.Windows.Documents.Hyperlink>項目，位於主要<xref:System.Windows.Navigation.NavigationWindow>而不是巢狀<xref:System.Windows.Controls.Frame>。</span><span class="sxs-lookup"><span data-stu-id="37979-152">The user navigates by clicking a <xref:System.Windows.Documents.Hyperlink> element that is within the main <xref:System.Windows.Navigation.NavigationWindow>, not in a nested <xref:System.Windows.Controls.Frame>.</span></span>  
  
-   <span data-ttu-id="37979-153">**區域**。</span><span class="sxs-lookup"><span data-stu-id="37979-153">**Zone**.</span></span> <span data-ttu-id="37979-154">所要巡覽的內容位在網際網路或近端內部網路。</span><span class="sxs-lookup"><span data-stu-id="37979-154">The content being navigated to is located on the Internet or the local intranet.</span></span>  
  
-   <span data-ttu-id="37979-155">**通訊協定**.</span><span class="sxs-lookup"><span data-stu-id="37979-155">**Protocol**.</span></span> <span data-ttu-id="37979-156">可能是正在使用的通訊協定**http**， **https**，**檔案**，或**mailto**。</span><span class="sxs-lookup"><span data-stu-id="37979-156">The protocol being used is either **http**, **https**, **file**, or **mailto**.</span></span>  
  
 <span data-ttu-id="37979-157">如果[!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)]嘗試瀏覽至內容的方式不符合這些條件，<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="37979-157">If an [!INCLUDE[TLA2#tla_xbap](../../../includes/tla2sharptla-xbap-md.md)] attempts to navigate to content in a manner that does not comply with these conditions, a <xref:System.Security.SecurityException> is thrown.</span></span>  
  
<a name="InternetExplorerSecuritySettings"></a>   
## <a name="web-browsing-software-security-settings"></a><span data-ttu-id="37979-158">Web 瀏覽軟體安全性設定</span><span class="sxs-lookup"><span data-stu-id="37979-158">Web Browsing Software Security Settings</span></span>  
 <span data-ttu-id="37979-159">電腦上的安全性設定決定授與任何 Web 瀏覽軟體的存取權。</span><span class="sxs-lookup"><span data-stu-id="37979-159">The security settings on your computer determine the access that any Web browsing software is granted.</span></span> <span data-ttu-id="37979-160">Web 瀏覽軟體包括任何應用程式或元件，它使用[WinINet](https://go.microsoft.com/fwlink/?LinkId=179379)或是[UrlMon](https://go.microsoft.com/fwlink/?LinkId=179383) Api，包括 Internet Explorer 和 PresentationHost.exe。</span><span class="sxs-lookup"><span data-stu-id="37979-160">Web browsing software includes any application or component that uses the [WinINet](https://go.microsoft.com/fwlink/?LinkId=179379) or [UrlMon](https://go.microsoft.com/fwlink/?LinkId=179383) APIs, including Internet Explorer and PresentationHost.exe.</span></span>  
  
 [!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)] <span data-ttu-id="37979-161">提供一個機制，您可以設定的功能，允許或從中執行[!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)]，包括下列：</span><span class="sxs-lookup"><span data-stu-id="37979-161">provides a mechanism by which you can configure the functionality that is allowed to be executed by or from [!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)], including the following:</span></span>  
  
-   <span data-ttu-id="37979-162">.NET framework 相依元件</span><span class="sxs-lookup"><span data-stu-id="37979-162">.NET Framework-reliant components</span></span>  
  
-   <span data-ttu-id="37979-163">ActiveX 控制項和外掛程式</span><span class="sxs-lookup"><span data-stu-id="37979-163">ActiveX controls and plug-ins</span></span>  
  
-   <span data-ttu-id="37979-164">下載</span><span class="sxs-lookup"><span data-stu-id="37979-164">Downloads</span></span>  
  
-   <span data-ttu-id="37979-165">正在處理指令碼</span><span class="sxs-lookup"><span data-stu-id="37979-165">Scripting</span></span>  
  
-   <span data-ttu-id="37979-166">使用者驗證</span><span class="sxs-lookup"><span data-stu-id="37979-166">User Authentication</span></span>  
  
 <span data-ttu-id="37979-167">您可以在這種方式保護的功能集合已設定為針對每個區域為基礎**網際網路**，**內部網路**，**信任的網站**，和**限制的網站**區域。</span><span class="sxs-lookup"><span data-stu-id="37979-167">The collection of functionality that can be secured in this way is configured on a per-zone basis for the **Internet**, **Intranet**, **Trusted Sites**, and **Restricted Sites** zones.</span></span> <span data-ttu-id="37979-168">下列步驟描述如何設定安全性設定：</span><span class="sxs-lookup"><span data-stu-id="37979-168">The following steps describe how to configure your security settings:</span></span>  
  
1. <span data-ttu-id="37979-169">開啟**控制台中**。</span><span class="sxs-lookup"><span data-stu-id="37979-169">Open **Control Panel**.</span></span>  
  
2. <span data-ttu-id="37979-170">按一下 **網路和網際網路**，然後按一下**網際網路選項**。</span><span class="sxs-lookup"><span data-stu-id="37979-170">Click **Network and Internet** and then click **Internet Options**.</span></span>  
  
     <span data-ttu-id="37979-171">[網際網路選項] 對話方塊隨即出現。</span><span class="sxs-lookup"><span data-stu-id="37979-171">The Internet Options dialog box appears.</span></span>  
  
3. <span data-ttu-id="37979-172">在 **安全性**索引標籤上，選取要設定的安全性設定區域。</span><span class="sxs-lookup"><span data-stu-id="37979-172">On the **Security** tab, select the zone to configure the security settings for.</span></span>  
  
4. <span data-ttu-id="37979-173">按一下 [**自訂層級**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="37979-173">Click the **Custom Level** button.</span></span>  
  
     <span data-ttu-id="37979-174">**安全性設定** 對話方塊隨即出現，而且您可以設定所選區域的安全性設定。</span><span class="sxs-lookup"><span data-stu-id="37979-174">The **Security Settings** dialog box appears and you can configure the security settings for the selected zone.</span></span>  
  
     ![如果螢幕擷取畫面顯示 [安全性設定] 對話方塊。](./media/security-wpf/windows-presentation-foundation-security-settings.png)  
  
> [!NOTE]
>  <span data-ttu-id="37979-176">您也可以從 Internet Explorer 到達 [網際網路選項] 對話方塊。</span><span class="sxs-lookup"><span data-stu-id="37979-176">You can also get to the Internet Options dialog box from Internet Explorer.</span></span> <span data-ttu-id="37979-177">按一下 **工具**，然後按一下**網際網路選項**。</span><span class="sxs-lookup"><span data-stu-id="37979-177">Click **Tools** and then click **Internet Options**.</span></span>  
  
 <span data-ttu-id="37979-178">從開始[!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)]，特別針對.NET Framework 的下列安全性設定會包含：</span><span class="sxs-lookup"><span data-stu-id="37979-178">Starting with [!INCLUDE[TLA#tla_ie7](../../../includes/tlasharptla-ie7-md.md)], the following security settings specifically for .NET Framework are included:</span></span>  
  
-   <span data-ttu-id="37979-179">**鬆散 XAML**。</span><span class="sxs-lookup"><span data-stu-id="37979-179">**Loose XAML**.</span></span> <span data-ttu-id="37979-180">控制項是否[!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)]可以瀏覽至並鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案。</span><span class="sxs-lookup"><span data-stu-id="37979-180">Controls whether [!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)] can navigate to and loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files.</span></span> <span data-ttu-id="37979-181">([啟用]、[停用] 和 [提示] 選項)。</span><span class="sxs-lookup"><span data-stu-id="37979-181">(Enable, Disable, and Prompt options).</span></span>  
  
-   <span data-ttu-id="37979-182">**XAML 瀏覽器應用程式**。</span><span class="sxs-lookup"><span data-stu-id="37979-182">**XAML browser applications**.</span></span> <span data-ttu-id="37979-183">控制項是否[!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)]可以瀏覽至並執行[!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="37979-183">Controls whether [!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)] can navigate to and run [!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)].</span></span> <span data-ttu-id="37979-184">([啟用]、[停用] 和 [提示] 選項)。</span><span class="sxs-lookup"><span data-stu-id="37979-184">(Enable, Disable, and Prompt options).</span></span>  
  
 <span data-ttu-id="37979-185">根據預設，這些設定所有啟用**網際網路**，**近端內部網路**，並**信任的網站**區域，並停用**限制的網站**區域。</span><span class="sxs-lookup"><span data-stu-id="37979-185">By default, these settings are all enabled for the **Internet**, **Local intranet**, and **Trusted sites** zones, and disabled for the **Restricted sites** zone.</span></span>  
  
<a name="Security_Settings_for_IE6_and_Below"></a>   
### <a name="security-related-wpf-registry-settings"></a><span data-ttu-id="37979-186">安全性相關 WPF 登錄設定</span><span class="sxs-lookup"><span data-stu-id="37979-186">Security-related WPF Registry Settings</span></span>  
 <span data-ttu-id="37979-187">除了透過 [網際網路選項] 取得的安全性設定之外，還提供下列登錄值可選擇性地封鎖許多有安全性顧慮的 WPF 功能。</span><span class="sxs-lookup"><span data-stu-id="37979-187">In addition to the security settings available through the Internet Options, the following registry values are available for selectively blocking a number of security-sensitive WPF features.</span></span> <span data-ttu-id="37979-188">值會定義在下列機碼下方︰</span><span class="sxs-lookup"><span data-stu-id="37979-188">The values are defined under the following key:</span></span>  
  
 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\Windows Presentation Foundation\Features`  
  
 <span data-ttu-id="37979-189">下表列出可設定的值。</span><span class="sxs-lookup"><span data-stu-id="37979-189">The following table lists the values that can be set.</span></span>  
  
|<span data-ttu-id="37979-190">數值名稱</span><span class="sxs-lookup"><span data-stu-id="37979-190">Value Name</span></span>|<span data-ttu-id="37979-191">實值類型</span><span class="sxs-lookup"><span data-stu-id="37979-191">Value Type</span></span>|<span data-ttu-id="37979-192">數值資料</span><span class="sxs-lookup"><span data-stu-id="37979-192">Value Data</span></span>|  
|----------------|----------------|----------------|  
|<span data-ttu-id="37979-193">XBAPDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-193">XBAPDisallow</span></span>|<span data-ttu-id="37979-194">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-194">REG_DWORD</span></span>|<span data-ttu-id="37979-195">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-195">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="37979-196">LooseXamlDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-196">LooseXamlDisallow</span></span>|<span data-ttu-id="37979-197">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-197">REG_DWORD</span></span>|<span data-ttu-id="37979-198">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-198">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="37979-199">WebBrowserDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-199">WebBrowserDisallow</span></span>|<span data-ttu-id="37979-200">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-200">REG_DWORD</span></span>|<span data-ttu-id="37979-201">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-201">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="37979-202">MediaAudioDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-202">MediaAudioDisallow</span></span>|<span data-ttu-id="37979-203">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-203">REG_DWORD</span></span>|<span data-ttu-id="37979-204">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-204">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="37979-205">MediaImageDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-205">MediaImageDisallow</span></span>|<span data-ttu-id="37979-206">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-206">REG_DWORD</span></span>|<span data-ttu-id="37979-207">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-207">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="37979-208">MediaVideoDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-208">MediaVideoDisallow</span></span>|<span data-ttu-id="37979-209">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-209">REG_DWORD</span></span>|<span data-ttu-id="37979-210">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-210">1 to disallow; 0 to allow.</span></span>|  
|<span data-ttu-id="37979-211">ScriptInteropDisallow</span><span class="sxs-lookup"><span data-stu-id="37979-211">ScriptInteropDisallow</span></span>|<span data-ttu-id="37979-212">REG_DWORD</span><span class="sxs-lookup"><span data-stu-id="37979-212">REG_DWORD</span></span>|<span data-ttu-id="37979-213">1 表示不允許；0 表示允許。</span><span class="sxs-lookup"><span data-stu-id="37979-213">1 to disallow; 0 to allow.</span></span>|  
  
<a name="webbrowser_control_and_feature_controls"></a>   
## <a name="webbrowser-control-and-feature-controls"></a><span data-ttu-id="37979-214">WebBrowser 控制項和功能控制項</span><span class="sxs-lookup"><span data-stu-id="37979-214">WebBrowser Control and Feature Controls</span></span>  
 <span data-ttu-id="37979-215">WPF<xref:System.Windows.Controls.WebBrowser>控制項可用來裝載 Web 內容。</span><span class="sxs-lookup"><span data-stu-id="37979-215">The WPF <xref:System.Windows.Controls.WebBrowser> control can be used to host Web content.</span></span> <span data-ttu-id="37979-216">WPF<xref:System.Windows.Controls.WebBrowser>控制項包裝基礎 WebBrowser ActiveX 控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-216">The WPF <xref:System.Windows.Controls.WebBrowser> control wraps the underlying WebBrowser ActiveX control.</span></span> <span data-ttu-id="37979-217">WPF 提供一些支援來保護您的應用程式，當您使用 WPF<xref:System.Windows.Controls.WebBrowser>控制項來裝載未受信任的 Web 內容。</span><span class="sxs-lookup"><span data-stu-id="37979-217">WPF provides some support for securing your application when you use the WPF <xref:System.Windows.Controls.WebBrowser> control to host untrusted Web content.</span></span> <span data-ttu-id="37979-218">不過，必須套用一些安全性功能使用的應用程式來直接<xref:System.Windows.Controls.WebBrowser>控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-218">However, some security features must be applied directly by the applications using the <xref:System.Windows.Controls.WebBrowser> control.</span></span> <span data-ttu-id="37979-219">如需 WebBrowser ActiveX 控制項的詳細資訊，請參閱[WebBrowser 控制項概觀與教學課程](https://go.microsoft.com/fwlink/?LinkId=179388)。</span><span class="sxs-lookup"><span data-stu-id="37979-219">For more information about the WebBrowser ActiveX control, see [WebBrowser Control Overviews and Tutorials](https://go.microsoft.com/fwlink/?LinkId=179388).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37979-220">本節也適用於<xref:System.Windows.Controls.Frame>控制，因為它會使用<xref:System.Windows.Controls.WebBrowser>來巡覽至 HTML 內容。</span><span class="sxs-lookup"><span data-stu-id="37979-220">This section also applies to the <xref:System.Windows.Controls.Frame> control since it uses the <xref:System.Windows.Controls.WebBrowser> to navigate to HTML content.</span></span>  
  
 <span data-ttu-id="37979-221">如果 WPF<xref:System.Windows.Controls.WebBrowser>控制項用來裝載不受信任的 Web 內容，您的應用程式應該使用部分信任<xref:System.AppDomain>來協助隔離您的應用程式程式碼，從可能是惡意的 HTML 指令碼。</span><span class="sxs-lookup"><span data-stu-id="37979-221">If the WPF <xref:System.Windows.Controls.WebBrowser> control is used to host untrusted Web content, your application should use a partial-trust <xref:System.AppDomain> to help insulate your application code from potentially malicious HTML script code.</span></span> <span data-ttu-id="37979-222">這是特別有用，如果您的應用程式，會使用互動使用裝載的指令碼<xref:System.Windows.Controls.WebBrowser.InvokeScript%2A>方法和<xref:System.Windows.Controls.WebBrowser.ObjectForScripting%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="37979-222">This is especially true if your application is interacting with the hosted script by using the <xref:System.Windows.Controls.WebBrowser.InvokeScript%2A> method and the <xref:System.Windows.Controls.WebBrowser.ObjectForScripting%2A> property.</span></span> <span data-ttu-id="37979-223">如需詳細資訊，請參閱 < [WPF 增益集概觀](./app-development/wpf-add-ins-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="37979-223">For more information, see [WPF Add-Ins Overview](./app-development/wpf-add-ins-overview.md).</span></span>  
  
 <span data-ttu-id="37979-224">如果您的應用程式使用 WPF<xref:System.Windows.Controls.WebBrowser>控制項，以提高安全性並降低攻擊的另一個方法是啟用 Internet Explorer 功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-224">If your application uses the WPF <xref:System.Windows.Controls.WebBrowser> control, another way to increase security and mitigate attacks is to enable Internet Explorer feature controls.</span></span> <span data-ttu-id="37979-225">功能控制項是 Internet Explorer 可讓系統管理員和開發人員設定 Internet Explorer 和 WebBrowser ActiveX 控制項中，裝載的應用程式功能的新增功能的 WPF<xref:System.Windows.Controls.WebBrowser>控制包裝。</span><span class="sxs-lookup"><span data-stu-id="37979-225">Feature controls are additions to Internet Explorer that allow administrators and developers to configure features of Internet Explorer and applications that host the WebBrowser ActiveX control, which the WPF <xref:System.Windows.Controls.WebBrowser> control wraps.</span></span> <span data-ttu-id="37979-226">可以使用設定功能控制項[CoInternetSetFeatureEnabled](https://go.microsoft.com/fwlink/?LinkId=179394)函式，或變更登錄中的值。</span><span class="sxs-lookup"><span data-stu-id="37979-226">Feature controls can be configured by using the [CoInternetSetFeatureEnabled](https://go.microsoft.com/fwlink/?LinkId=179394) function or by changing values in the registry.</span></span> <span data-ttu-id="37979-227">如需功能控制項的詳細資訊，請參閱[功能控制項簡介](https://go.microsoft.com/fwlink/?LinkId=179390)並[網際網路功能控制項](https://go.microsoft.com/fwlink/?LinkId=179392)。</span><span class="sxs-lookup"><span data-stu-id="37979-227">For more information about feature controls, see [Introduction to Feature Controls](https://go.microsoft.com/fwlink/?LinkId=179390) and [Internet Feature Controls](https://go.microsoft.com/fwlink/?LinkId=179392).</span></span>  
  
 <span data-ttu-id="37979-228">如果您正在開發使用 WPF 的獨立 WPF 應用程式<xref:System.Windows.Controls.WebBrowser>控制項，WPF 會自動啟用您的應用程式的下列功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-228">If you are developing a standalone WPF application that uses the WPF <xref:System.Windows.Controls.WebBrowser> control, WPF automatically enables the following feature controls for your application.</span></span>  
  
|<span data-ttu-id="37979-229">功能控制項</span><span class="sxs-lookup"><span data-stu-id="37979-229">Feature Control</span></span>|  
|---------------------|  
|<span data-ttu-id="37979-230">FEATURE_MIME_HANDLING</span><span class="sxs-lookup"><span data-stu-id="37979-230">FEATURE_MIME_HANDLING</span></span>|  
|<span data-ttu-id="37979-231">FEATURE_MIME_SNIFFING</span><span class="sxs-lookup"><span data-stu-id="37979-231">FEATURE_MIME_SNIFFING</span></span>|  
|<span data-ttu-id="37979-232">FEATURE_OBJECT_CACHING</span><span class="sxs-lookup"><span data-stu-id="37979-232">FEATURE_OBJECT_CACHING</span></span>|  
|<span data-ttu-id="37979-233">FEATURE_SAFE_BINDTOOBJECT</span><span class="sxs-lookup"><span data-stu-id="37979-233">FEATURE_SAFE_BINDTOOBJECT</span></span>|  
|<span data-ttu-id="37979-234">FEATURE_WINDOW_RESTRICTIONS</span><span class="sxs-lookup"><span data-stu-id="37979-234">FEATURE_WINDOW_RESTRICTIONS</span></span>|  
|<span data-ttu-id="37979-235">FEATURE_ZONE_ELEVATION</span><span class="sxs-lookup"><span data-stu-id="37979-235">FEATURE_ZONE_ELEVATION</span></span>|  
|<span data-ttu-id="37979-236">FEATURE_RESTRICT_FILEDOWNLOAD</span><span class="sxs-lookup"><span data-stu-id="37979-236">FEATURE_RESTRICT_FILEDOWNLOAD</span></span>|  
|<span data-ttu-id="37979-237">FEATURE_RESTRICT_ACTIVEXINSTALL</span><span class="sxs-lookup"><span data-stu-id="37979-237">FEATURE_RESTRICT_ACTIVEXINSTALL</span></span>|  
|<span data-ttu-id="37979-238">FEATURE_ADDON_MANAGEMENT</span><span class="sxs-lookup"><span data-stu-id="37979-238">FEATURE_ADDON_MANAGEMENT</span></span>|  
|<span data-ttu-id="37979-239">FEATURE_HTTP_USERNAME_PASSWORD_DISABLE</span><span class="sxs-lookup"><span data-stu-id="37979-239">FEATURE_HTTP_USERNAME_PASSWORD_DISABLE</span></span>|  
|<span data-ttu-id="37979-240">FEATURE_SECURITYBAND</span><span class="sxs-lookup"><span data-stu-id="37979-240">FEATURE_SECURITYBAND</span></span>|  
|<span data-ttu-id="37979-241">FEATURE_UNC_SAVEDFILECHECK</span><span class="sxs-lookup"><span data-stu-id="37979-241">FEATURE_UNC_SAVEDFILECHECK</span></span>|  
|<span data-ttu-id="37979-242">FEATURE_VALIDATE_NAVIGATE_URL</span><span class="sxs-lookup"><span data-stu-id="37979-242">FEATURE_VALIDATE_NAVIGATE_URL</span></span>|  
|<span data-ttu-id="37979-243">FEATURE_DISABLE_TELNET_PROTOCOL</span><span class="sxs-lookup"><span data-stu-id="37979-243">FEATURE_DISABLE_TELNET_PROTOCOL</span></span>|  
|<span data-ttu-id="37979-244">FEATURE_WEBOC_POPUPMANAGEMENT</span><span class="sxs-lookup"><span data-stu-id="37979-244">FEATURE_WEBOC_POPUPMANAGEMENT</span></span>|  
|<span data-ttu-id="37979-245">FEATURE_DISABLE_LEGACY_COMPRESSION</span><span class="sxs-lookup"><span data-stu-id="37979-245">FEATURE_DISABLE_LEGACY_COMPRESSION</span></span>|  
|<span data-ttu-id="37979-246">FEATURE_SSLUX</span><span class="sxs-lookup"><span data-stu-id="37979-246">FEATURE_SSLUX</span></span>|  
  
 <span data-ttu-id="37979-247">因為會無條件地啟用這些功能控制項，所以它們可能會損害完全信任應用程式。</span><span class="sxs-lookup"><span data-stu-id="37979-247">Since these feature controls are enabled unconditionally, a full-trust application might be impaired by them.</span></span> <span data-ttu-id="37979-248">在此情況下，如果特定應用程式和其所裝載的內容沒有安全性風險，則可以停用對應的功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-248">In this case, if there is no security risk for the specific application and the content it is hosting, the corresponding feature control can be disabled.</span></span>  
  
 <span data-ttu-id="37979-249">具現化 WebBrowser ActiveX 物件的程序會套用功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-249">Feature controls are applied by the process instantiating the WebBrowser ActiveX object.</span></span> <span data-ttu-id="37979-250">因此，如果您要建立的獨立應用程式會巡覽到不受信任的內容，則應該認真考慮啟用其他功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-250">Therefore, if you are creating a stand-alone application that can navigate to untrusted content, you should seriously consider enabling additional feature controls.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37979-251">這項建議根據 MSHTML 和 SHDOCVW 主機安全性的一般建議。</span><span class="sxs-lookup"><span data-stu-id="37979-251">This recommendation is based on general recommendations for MSHTML and SHDOCVW host security.</span></span> <span data-ttu-id="37979-252">如需詳細資訊，請參閱[MSHTML 主機安全性常見問題集：第 II 一部分](https://go.microsoft.com/fwlink/?LinkId=179396)和[MSHTML 主機安全性常見問題集：第二部 of II](https://go.microsoft.com/fwlink/?LinkId=179415)。</span><span class="sxs-lookup"><span data-stu-id="37979-252">For more information, see [The MSHTML Host Security FAQ: Part I of II](https://go.microsoft.com/fwlink/?LinkId=179396) and [The MSHTML Host Security FAQ: Part II of II](https://go.microsoft.com/fwlink/?LinkId=179415).</span></span>  
  
 <span data-ttu-id="37979-253">針對可執行檔，請考慮將登錄值設定為 1 來啟用下列功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-253">For your executable, consider enabling the following feature controls by setting the registry value to 1.</span></span>  
  
|<span data-ttu-id="37979-254">功能控制項</span><span class="sxs-lookup"><span data-stu-id="37979-254">Feature Control</span></span>|  
|---------------------|  
|<span data-ttu-id="37979-255">FEATURE_ACTIVEX_REPURPOSEDETECTION</span><span class="sxs-lookup"><span data-stu-id="37979-255">FEATURE_ACTIVEX_REPURPOSEDETECTION</span></span>|  
|<span data-ttu-id="37979-256">FEATURE_BLOCK_LMZ_IMG</span><span class="sxs-lookup"><span data-stu-id="37979-256">FEATURE_BLOCK_LMZ_IMG</span></span>|  
|<span data-ttu-id="37979-257">FEATURE_BLOCK_LMZ_OBJECT</span><span class="sxs-lookup"><span data-stu-id="37979-257">FEATURE_BLOCK_LMZ_OBJECT</span></span>|  
|<span data-ttu-id="37979-258">FEATURE_BLOCK_LMZ_SCRIPT</span><span class="sxs-lookup"><span data-stu-id="37979-258">FEATURE_BLOCK_LMZ_SCRIPT</span></span>|  
|<span data-ttu-id="37979-259">FEATURE_RESTRICT_RES_TO_LMZ</span><span class="sxs-lookup"><span data-stu-id="37979-259">FEATURE_RESTRICT_RES_TO_LMZ</span></span>|  
|<span data-ttu-id="37979-260">FEATURE_RESTRICT_ABOUT_PROTOCOL_IE7</span><span class="sxs-lookup"><span data-stu-id="37979-260">FEATURE_RESTRICT_ABOUT_PROTOCOL_IE7</span></span>|  
|<span data-ttu-id="37979-261">FEATURE_SHOW_APP_PROTOCOL_WARN_DIALOG</span><span class="sxs-lookup"><span data-stu-id="37979-261">FEATURE_SHOW_APP_PROTOCOL_WARN_DIALOG</span></span>|  
|<span data-ttu-id="37979-262">FEATURE_LOCALMACHINE_LOCKDOWN</span><span class="sxs-lookup"><span data-stu-id="37979-262">FEATURE_LOCALMACHINE_LOCKDOWN</span></span>|  
|<span data-ttu-id="37979-263">FEATURE_FORCE_ADDR_AND_STATUS</span><span class="sxs-lookup"><span data-stu-id="37979-263">FEATURE_FORCE_ADDR_AND_STATUS</span></span>|  
|<span data-ttu-id="37979-264">FEATURE_RESTRICTED_ZONE_WHEN_FILE_NOT_FOUND</span><span class="sxs-lookup"><span data-stu-id="37979-264">FEATURE_RESTRICTED_ZONE_WHEN_FILE_NOT_FOUND</span></span>|  
  
 <span data-ttu-id="37979-265">針對可執行檔，請考慮將登錄值設定為 0 來停用下列功能控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-265">For your executable, consider disabling the following feature control by setting the registry value to 0.</span></span>  
  
|<span data-ttu-id="37979-266">功能控制項</span><span class="sxs-lookup"><span data-stu-id="37979-266">Feature Control</span></span>|  
|---------------------|  
|<span data-ttu-id="37979-267">FEATURE_ENABLE_SCRIPT_PASTE_URLACTION_IF_PROMPT</span><span class="sxs-lookup"><span data-stu-id="37979-267">FEATURE_ENABLE_SCRIPT_PASTE_URLACTION_IF_PROMPT</span></span>|  
  
 <span data-ttu-id="37979-268">如果您執行部分信任[!INCLUDE[TLA#tla_xbap](../../../includes/tlasharptla-xbap-md.md)]包含 WPF<xref:System.Windows.Controls.WebBrowser>控制中[!INCLUDE[TLA#tla_iegeneric](../../../includes/tlasharptla-iegeneric-md.md)]，WPF 中裝載 WebBrowser ActiveX 控制項，Internet Explorer 處理序的位址空間中。</span><span class="sxs-lookup"><span data-stu-id="37979-268">If you run a partial-trust [!INCLUDE[TLA#tla_xbap](../../../includes/tlasharptla-xbap-md.md)] that includes a WPF <xref:System.Windows.Controls.WebBrowser> control in [!INCLUDE[TLA#tla_iegeneric](../../../includes/tlasharptla-iegeneric-md.md)], WPF hosts the WebBrowser ActiveX control in the address space of the Internet Explorer process.</span></span> <span data-ttu-id="37979-269">因為 WebBrowser ActiveX 控制項裝載於[!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)]處理序中，所有的 Internet Explorer 功能控制項也會啟用 WebBrowser ActiveX 控制項。</span><span class="sxs-lookup"><span data-stu-id="37979-269">Since the WebBrowser ActiveX control is hosted in the [!INCLUDE[TLA2#tla_iegeneric](../../../includes/tla2sharptla-iegeneric-md.md)] process, all of the feature controls for Internet Explorer are also enabled for the WebBrowser ActiveX control.</span></span>  
  
 <span data-ttu-id="37979-270">與一般獨立應用程式相較之下，在 Internet Explorer 中執行的 XBAP 也會取得額外層級的安全性。</span><span class="sxs-lookup"><span data-stu-id="37979-270">XBAPs running in Internet Explorer also get an additional level of security compared to normal standalone applications.</span></span> <span data-ttu-id="37979-271">這個額外的安全性是因為 Internet Explorer 中，因此 WebBrowser ActiveX 控制項，會執行受保護模式上的預設[!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)]和[!INCLUDE[win7](../../../includes/win7-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="37979-271">This additional security is because Internet Explorer, and therefore the WebBrowser ActiveX control, runs in protected mode by default on [!INCLUDE[TLA#tla_winvista](../../../includes/tlasharptla-winvista-md.md)] and [!INCLUDE[win7](../../../includes/win7-md.md)].</span></span> <span data-ttu-id="37979-272">如需有關受保護模式的詳細資訊，請參閱 <<c0> [ 了解及使用受保護模式 Internet Explorer 中](https://go.microsoft.com/fwlink/?LinkId=179393)。</span><span class="sxs-lookup"><span data-stu-id="37979-272">For more information about protected mode, see [Understanding and Working in Protected Mode Internet Explorer](https://go.microsoft.com/fwlink/?LinkId=179393).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37979-273">如果您嘗試執行包含 WPF XBAP <xref:System.Windows.Controls.WebBrowser> Firefox，在 [網際網路] 區域中的控制項<xref:System.Security.SecurityException>就會擲回。</span><span class="sxs-lookup"><span data-stu-id="37979-273">If you try to run an XBAP that includes a WPF <xref:System.Windows.Controls.WebBrowser> control in Firefox, while in the Internet zone, a <xref:System.Security.SecurityException> will be thrown.</span></span> <span data-ttu-id="37979-274">這是因為 WPF 安全性原則。</span><span class="sxs-lookup"><span data-stu-id="37979-274">This is due to WPF security policy.</span></span>  
  
<a name="APTCA"></a>   
## <a name="disabling-aptca-assemblies-for-partially-trusted-client-applications"></a><span data-ttu-id="37979-275">停用部分信任用戶端應用程式的 APTCA 組件</span><span class="sxs-lookup"><span data-stu-id="37979-275">Disabling APTCA Assemblies for Partially Trusted Client Applications</span></span>  
 <span data-ttu-id="37979-276">當 managed 組件安裝到[!INCLUDE[TLA#tla_gac](../../../includes/tlasharptla-gac-md.md)]，它們變成完全受信任的因為使用者必須提供明確的權限，才能進行安裝。</span><span class="sxs-lookup"><span data-stu-id="37979-276">When managed assemblies are installed into the [!INCLUDE[TLA#tla_gac](../../../includes/tlasharptla-gac-md.md)], they become fully trusted because the user must provide explicit permission to install them.</span></span> <span data-ttu-id="37979-277">因為它們完全受信任，所以只有完全受信任的受管理用戶端應用程式才能使用它們。</span><span class="sxs-lookup"><span data-stu-id="37979-277">Because they are fully trusted, only fully trusted managed client applications can use them.</span></span> <span data-ttu-id="37979-278">若要允許部分信任的應用程式使用它們，它們必須標示為<xref:System.Security.AllowPartiallyTrustedCallersAttribute>(APTCA)。</span><span class="sxs-lookup"><span data-stu-id="37979-278">To allow partially trusted applications to use them, they must be marked with the <xref:System.Security.AllowPartiallyTrustedCallersAttribute> (APTCA).</span></span> <span data-ttu-id="37979-279">只有經過測試可在部分信任中安全執行的組件才應該標記這個屬性。</span><span class="sxs-lookup"><span data-stu-id="37979-279">Only assemblies that have been tested to be safe for execution in partial trust should be marked with this attribute.</span></span>  
  
 <span data-ttu-id="37979-280">不過，就可能 APTCA 組件安裝到之後出現安全性缺陷[!INCLUDE[TLA2#tla_gac](../../../includes/tla2sharptla-gac-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="37979-280">However, it is possible for an APTCA assembly to exhibit a security flaw after being installed into the [!INCLUDE[TLA2#tla_gac](../../../includes/tla2sharptla-gac-md.md)].</span></span> <span data-ttu-id="37979-281">發現安全性缺陷之後，組件發行者可以產生安全性更新來修正現有安裝上的問題，以及防止在發現問題之後可能進行的安裝。</span><span class="sxs-lookup"><span data-stu-id="37979-281">Once a security flaw is discovered, assembly publishers can produce a security update to fix the problem on existing installations, and to protect against installations that may occur after the problem is discovered.</span></span> <span data-ttu-id="37979-282">雖然解除安裝組件可能會中斷其他使用組件的完全信任用戶端應用程式，但是更新的其中一個選項是解除安裝組件。</span><span class="sxs-lookup"><span data-stu-id="37979-282">One option for the update is to uninstall the assembly, although that may break other fully trusted client applications that use the assembly.</span></span>  
  
 [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] <span data-ttu-id="37979-283">提供一個機制，用 APTCA 組件可以停用部分信任[!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)]沒有解除安裝 APTCA 組件。</span><span class="sxs-lookup"><span data-stu-id="37979-283">provides a mechanism by which an APTCA assembly can be disabled for partially trusted [!INCLUDE[TLA2#tla_xbap#plural](../../../includes/tla2sharptla-xbapsharpplural-md.md)] without uninstalling the APTCA assembly.</span></span>  
  
 <span data-ttu-id="37979-284">若要停用 APTCA 組件，您必須建立特殊登錄機碼︰</span><span class="sxs-lookup"><span data-stu-id="37979-284">To disable an APTCA assembly, you have to create a special registry key:</span></span>  
  
 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\policy\APTCA\<AssemblyFullName>, FileVersion=<AssemblyFileVersion>`  
  
 <span data-ttu-id="37979-285">下列示範範例：</span><span class="sxs-lookup"><span data-stu-id="37979-285">The following shows an example:</span></span>  
  
 `HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\.NETFramework\policy\APTCA\aptcagac, Version=1.0.0.0, Culture=neutral, PublicKeyToken=215e3ac809a0fea7, FileVersion=1.0.0.0`  
  
 <span data-ttu-id="37979-286">此機碼會為 APTCA 組件建立一個項目。</span><span class="sxs-lookup"><span data-stu-id="37979-286">This key establishes an entry for the APTCA assembly.</span></span> <span data-ttu-id="37979-287">您也必須在這個機碼中建立啟用或停用組件的數值。</span><span class="sxs-lookup"><span data-stu-id="37979-287">You also have to create a value in this key that enables or disables the assembly.</span></span> <span data-ttu-id="37979-288">數值的詳細資料如下︰</span><span class="sxs-lookup"><span data-stu-id="37979-288">The following are the details of the value:</span></span>  
  
-   <span data-ttu-id="37979-289">值名稱：**APTCA_FLAG**。</span><span class="sxs-lookup"><span data-stu-id="37979-289">Value Name: **APTCA_FLAG**.</span></span>  
  
-   <span data-ttu-id="37979-290">實值型別：**REG_DWORD**。</span><span class="sxs-lookup"><span data-stu-id="37979-290">Value Type: **REG_DWORD**.</span></span>  
  
-   <span data-ttu-id="37979-291">數值資料：**1**停用;**0**啟用。</span><span class="sxs-lookup"><span data-stu-id="37979-291">Value Data: **1** to disable; **0** to enable.</span></span>  
  
 <span data-ttu-id="37979-292">如果必須停用部分信任用戶端應用程式的組件，您可以撰寫可建立登錄機碼和值的更新。</span><span class="sxs-lookup"><span data-stu-id="37979-292">If an assembly has to be disabled for partially trusted client applications, you can write an update that creates the registry key and value.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37979-293">核心.NET Framework 組件不會受到停用它們以這種方式因為所需要的受管理的應用程式執行。</span><span class="sxs-lookup"><span data-stu-id="37979-293">Core .NET Framework assemblies are not affected by disabling them in this way because they are required for managed applications to run.</span></span> <span data-ttu-id="37979-294">停用 APTCA 組件的支援主要是針對協力廠商應用程式。</span><span class="sxs-lookup"><span data-stu-id="37979-294">Support for disabling APTCA assemblies is primarily targeted to third-party applications.</span></span>  
  
<a name="LooseContentSandboxing"></a>   
## <a name="sandbox-behavior-for-loose-xaml-files"></a><span data-ttu-id="37979-295">鬆散 XAML 檔案的沙箱行為</span><span class="sxs-lookup"><span data-stu-id="37979-295">Sandbox Behavior for Loose XAML Files</span></span>  
 <span data-ttu-id="37979-296">鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案是純標記 XAML 檔案，不依賴任何程式碼後置、 事件處理常式或特定應用程式的組件。</span><span class="sxs-lookup"><span data-stu-id="37979-296">Loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files are markup-only XAML files that do not depend on any code-behind, event handler, or application-specific assembly.</span></span> <span data-ttu-id="37979-297">當鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案直接從瀏覽器巡覽到，它們會在預設網際網路區域權限集合為基礎的安全性沙箱中載入。</span><span class="sxs-lookup"><span data-stu-id="37979-297">When loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files are navigated to directly from the browser, they are loaded in a security sandbox based on the default Internet zone permission set.</span></span>  
  
 <span data-ttu-id="37979-298">不過，安全性行為是不同時鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案從巡覽到<xref:System.Windows.Navigation.NavigationWindow>或<xref:System.Windows.Controls.Frame>獨立應用程式。</span><span class="sxs-lookup"><span data-stu-id="37979-298">However, the security behavior is different when loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files are navigated to from either a <xref:System.Windows.Navigation.NavigationWindow> or <xref:System.Windows.Controls.Frame> in a standalone application.</span></span>  
  
 <span data-ttu-id="37979-299">在這兩種情況下，鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]巡覽到的檔案會繼承其主應用程式的權限。</span><span class="sxs-lookup"><span data-stu-id="37979-299">In both cases, the loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] file that is navigated to inherits the permissions of its host application.</span></span> <span data-ttu-id="37979-300">不過，這種行為可能不想要從安全性觀點來看，尤其是鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案由受信任或未知的實體。</span><span class="sxs-lookup"><span data-stu-id="37979-300">However, this behavior may be undesirable from a security perspective, particularly if a loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] file was produced by an entity that is either not trusted or unknown.</span></span> <span data-ttu-id="37979-301">這種類型的內容稱為*外部內容*，並同時<xref:System.Windows.Controls.Frame>和<xref:System.Windows.Navigation.NavigationWindow>可以設定為巡覽時予以隔離。</span><span class="sxs-lookup"><span data-stu-id="37979-301">This type of content is known as *external content*, and both <xref:System.Windows.Controls.Frame> and <xref:System.Windows.Navigation.NavigationWindow> can be configured to isolate it when navigated to.</span></span> <span data-ttu-id="37979-302">隔離的方式設定**SandboxExternalContent**屬性設定為 true，如下列範例所示<xref:System.Windows.Controls.Frame>和<xref:System.Windows.Navigation.NavigationWindow>:</span><span class="sxs-lookup"><span data-stu-id="37979-302">Isolation is achieved by setting the **SandboxExternalContent** property to true, as shown in the following examples for <xref:System.Windows.Controls.Frame> and <xref:System.Windows.Navigation.NavigationWindow>:</span></span>  
  
 [!code-xaml[SecurityOverviewSnippets#FrameMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/SecurityOverviewSnippets/CS/Window2.xaml#framemarkup)]  
  
 [!code-xaml[SecurityOverviewSnippets#NavigationWindowMARKUP](~/samples/snippets/csharp/VS_Snippets_Wpf/SecurityOverviewSnippets/CS/Window1.xaml#navigationwindowmarkup)]  
  
 <span data-ttu-id="37979-303">使用此設定，會將外部內容載入與裝載應用程式的程序不同的程序。</span><span class="sxs-lookup"><span data-stu-id="37979-303">With this setting, external content will be loaded into a process that is separate from the process that is hosting the application.</span></span> <span data-ttu-id="37979-304">此程序僅限於預設網際網路區域權限集，可有效地隔離它與裝載應用程式和用戶端電腦。</span><span class="sxs-lookup"><span data-stu-id="37979-304">This process is restricted to the default Internet zone permission set, effectively isolating it from the hosting application and the client computer.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="37979-305">即使巡覽到鬆散[!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)]檔案，從<xref:System.Windows.Navigation.NavigationWindow>或<xref:System.Windows.Controls.Frame>在獨立的應用程式會實作根據 WPF 瀏覽器裝載基礎結構，包含 PresentationHost 處理序的安全性層級是稍微小於載入內容時直接在 Internet Explorer 上[!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)]和[!INCLUDE[win7](../../../includes/win7-md.md)]（仍是透過 PresentationHost）。</span><span class="sxs-lookup"><span data-stu-id="37979-305">Even though navigation to loose [!INCLUDE[TLA2#tla_xaml](../../../includes/tla2sharptla-xaml-md.md)] files from either a <xref:System.Windows.Navigation.NavigationWindow> or <xref:System.Windows.Controls.Frame> in a standalone application is implemented based on the WPF browser hosting infrastructure, involving the PresentationHost process, the security level is slightly less than when the content is loaded directly in Internet Explorer on [!INCLUDE[wiprlhext](../../../includes/wiprlhext-md.md)] and [!INCLUDE[win7](../../../includes/win7-md.md)] (which would still be through PresentationHost).</span></span> <span data-ttu-id="37979-306">這是因為使用 Web 瀏覽器的獨立 WPF 應用程式不會提供 Internet Explorer 的額外受保護模式安全性功能。</span><span class="sxs-lookup"><span data-stu-id="37979-306">This is because a standalone WPF application using a Web browser does not provide the additional Protected Mode security feature of Internet Explorer.</span></span>  
  
<a name="BestPractices"></a>   
## <a name="resources-for-developing-wpf-applications-that-promote-security"></a><span data-ttu-id="37979-307">用於開發可提高安全性的 WPF 應用程式的資源</span><span class="sxs-lookup"><span data-stu-id="37979-307">Resources for Developing WPF Applications that Promote Security</span></span>  
 <span data-ttu-id="37979-308">以下是一些額外的資源，以協助開發[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]提高安全性的應用程式：</span><span class="sxs-lookup"><span data-stu-id="37979-308">The following are some additional resources to help develop [!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)] applications that promote security:</span></span>  
  
|<span data-ttu-id="37979-309">區域</span><span class="sxs-lookup"><span data-stu-id="37979-309">Area</span></span>|<span data-ttu-id="37979-310">資源</span><span class="sxs-lookup"><span data-stu-id="37979-310">Resource</span></span>|  
|----------|--------------|  
|<span data-ttu-id="37979-311">Managed 程式碼</span><span class="sxs-lookup"><span data-stu-id="37979-311">Managed code</span></span>|[<span data-ttu-id="37979-312">模式和實務應用程式的安全性指導方針</span><span class="sxs-lookup"><span data-stu-id="37979-312">Patterns and Practices Security Guidance for Applications</span></span>](https://go.microsoft.com/fwlink/?LinkId=117426)|  
|[!INCLUDE[TLA2#tla_cas](../../../includes/tla2sharptla-cas-md.md)]|[<span data-ttu-id="37979-313">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="37979-313">Code Access Security</span></span>](../misc/code-access-security.md)|  
|[!INCLUDE[TLA2#tla_clickonce](../../../includes/tla2sharptla-clickonce-md.md)]|[<span data-ttu-id="37979-314">ClickOnce 安全性和部署</span><span class="sxs-lookup"><span data-stu-id="37979-314">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)|  
|[!INCLUDE[TLA2#tla_wpf](../../../includes/tla2sharptla-wpf-md.md)]|[<span data-ttu-id="37979-315">WPF 部分信任安全性</span><span class="sxs-lookup"><span data-stu-id="37979-315">WPF Partial Trust Security</span></span>](wpf-partial-trust-security.md)|  
  
## <a name="see-also"></a><span data-ttu-id="37979-316">另請參閱</span><span class="sxs-lookup"><span data-stu-id="37979-316">See also</span></span>

- [<span data-ttu-id="37979-317">WPF 部分信任安全性</span><span class="sxs-lookup"><span data-stu-id="37979-317">WPF Partial Trust Security</span></span>](wpf-partial-trust-security.md)
- [<span data-ttu-id="37979-318">WPF 安全性策略 – 平台安全性</span><span class="sxs-lookup"><span data-stu-id="37979-318">WPF Security Strategy - Platform Security</span></span>](wpf-security-strategy-platform-security.md)
- [<span data-ttu-id="37979-319">WPF 安全性策略 – 安全性工程</span><span class="sxs-lookup"><span data-stu-id="37979-319">WPF Security Strategy - Security Engineering</span></span>](wpf-security-strategy-security-engineering.md)
- [<span data-ttu-id="37979-320">模式和實務應用程式的安全性指導方針</span><span class="sxs-lookup"><span data-stu-id="37979-320">Patterns and Practices Security Guidance for Applications</span></span>](https://go.microsoft.com/fwlink/?LinkId=117426)
- [<span data-ttu-id="37979-321">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="37979-321">Code Access Security</span></span>](../misc/code-access-security.md)
- [<span data-ttu-id="37979-322">ClickOnce 安全性和部署</span><span class="sxs-lookup"><span data-stu-id="37979-322">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)
- [<span data-ttu-id="37979-323">XAML 概觀 (WPF)</span><span class="sxs-lookup"><span data-stu-id="37979-323">XAML Overview (WPF)</span></span>](./advanced/xaml-overview-wpf.md)
