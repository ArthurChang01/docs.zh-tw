---
title: WPF 4.5 版的新功能
titleSuffix: ''
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Presentation Foundation [WPF], what's new
- WPF [WPF], what's new
ms.assetid: db086ae4-70bb-4862-95db-2eaca5216bc3
ms.openlocfilehash: 8eff8da7746047c450b2e23af63d43b13f3b970c
ms.sourcegitcommit: de17a7a0a37042f0d4406f5ae5393531caeb25ba
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/24/2020
ms.locfileid: "76746927"
---
# <a name="whats-new-in-wpf-version-45"></a><span data-ttu-id="1f5cf-102">WPF 4.5 版的新功能</span><span class="sxs-lookup"><span data-stu-id="1f5cf-102">What's New in WPF Version 4.5</span></span>
<a name="introduction"></a><span data-ttu-id="1f5cf-103">本主題包含 [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] 版本4.5 中新增和增強功能的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-103">This topic contains information about new and enhanced features in [!INCLUDE[TLA#tla_winclient](../../../../includes/tlasharptla-winclient-md.md)] version 4.5.</span></span>  
  
 <span data-ttu-id="1f5cf-104">此主題包括下列章節：</span><span class="sxs-lookup"><span data-stu-id="1f5cf-104">This topic contains the following sections:</span></span>  
  
- [<span data-ttu-id="1f5cf-105">功能區控制項</span><span class="sxs-lookup"><span data-stu-id="1f5cf-105">Ribbon control</span></span>](#ribbon_control)  
  
- [<span data-ttu-id="1f5cf-106">顯示大型群組資料集合時改善效能</span><span class="sxs-lookup"><span data-stu-id="1f5cf-106">Improved performance when displaying large sets of grouped data</span></span>](#grouped_virtualization)  
  
- [<span data-ttu-id="1f5cf-107">VirtualizingPanel 的新功能</span><span class="sxs-lookup"><span data-stu-id="1f5cf-107">New features for the VirtualizingPanel</span></span>](#VirtualizingPanel)  
  
- [<span data-ttu-id="1f5cf-108">繫結至靜態屬性</span><span class="sxs-lookup"><span data-stu-id="1f5cf-108">Binding to static properties</span></span>](#static_properties)  
  
- [<span data-ttu-id="1f5cf-109">存取非 UI 執行緒上的集合</span><span class="sxs-lookup"><span data-stu-id="1f5cf-109">Accessing collections on non-UI Threads</span></span>](#xthread_access)  
  
- [<span data-ttu-id="1f5cf-110">同步和非同步驗證資料</span><span class="sxs-lookup"><span data-stu-id="1f5cf-110">Synchronously and Asynchronously validating data</span></span>](#INotifyDataErrorInfo)  
  
- [<span data-ttu-id="1f5cf-111">自動更新資料繫結的來源</span><span class="sxs-lookup"><span data-stu-id="1f5cf-111">Automatically updating the source of a data binding</span></span>](#delay)  
  
- [<span data-ttu-id="1f5cf-112">繫結至實作 ICustomTypeProvider 的型別</span><span class="sxs-lookup"><span data-stu-id="1f5cf-112">Binding to types that Implement ICustomTypeProvider</span></span>](#ICustomTypeProvider)  
  
- [<span data-ttu-id="1f5cf-113">從繫結運算式擷取資料繫結資訊</span><span class="sxs-lookup"><span data-stu-id="1f5cf-113">Retrieving data binding information from a binding expression</span></span>](#binding_state)  
  
- [<span data-ttu-id="1f5cf-114">檢查有效的 DataContext 物件</span><span class="sxs-lookup"><span data-stu-id="1f5cf-114">Checking for a valid DataContext object</span></span>](#DisconnectedSource)  
  
- [<span data-ttu-id="1f5cf-115">隨著資料值變更重新調整資料的位置 (即時繪圖)</span><span class="sxs-lookup"><span data-stu-id="1f5cf-115">Repositioning data as the data's values change (Live shaping)</span></span>](#live_shaping)  
  
- [<span data-ttu-id="1f5cf-116">建立事件弱式參考的加強支援</span><span class="sxs-lookup"><span data-stu-id="1f5cf-116">Improved Support for Establishing a Weak Reference to an Event</span></span>](#weak_event_pattern)  
  
- [<span data-ttu-id="1f5cf-117">Dispatcher 類別的新方法</span><span class="sxs-lookup"><span data-stu-id="1f5cf-117">New methods for the Dispatcher class</span></span>](#async)  
  
- [<span data-ttu-id="1f5cf-118">事件的標記延伸</span><span class="sxs-lookup"><span data-stu-id="1f5cf-118">Markup Extensions for Events</span></span>](#events_markup_extenions)  
  
<a name="ribbon_control"></a>   
## <a name="ribbon-control"></a><span data-ttu-id="1f5cf-119">功能區控制項</span><span class="sxs-lookup"><span data-stu-id="1f5cf-119">Ribbon control</span></span>  
 <span data-ttu-id="1f5cf-120">WPF 4.5 隨附一個 <xref:System.Windows.Controls.Ribbon.Ribbon> 控制項，它會裝載快速存取工具列、應用程式功能表和索引標籤。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-120">WPF 4.5 ships with a <xref:System.Windows.Controls.Ribbon.Ribbon> control that hosts a Quick Access Toolbar, Application Menu, and tabs.</span></span>  <span data-ttu-id="1f5cf-121">如需詳細資訊，請參閱[功能區概觀](/visualstudio/vsto/ribbon-overview)。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-121">For more information, see the [Ribbon Overview](/visualstudio/vsto/ribbon-overview).</span></span>  
  
<a name="grouped_virtualization"></a>   
## <a name="improved-performance-when-displaying-large-sets-of-grouped-data"></a><span data-ttu-id="1f5cf-122">顯示大型群組資料集合時改善效能</span><span class="sxs-lookup"><span data-stu-id="1f5cf-122">Improved performance when displaying large sets of grouped data</span></span>  
 <span data-ttu-id="1f5cf-123">UI 虛擬化會在使用者介面 (UI) 元素的子集從大量資料項目，根據可在畫面上看到的項目來產生時發生。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-123">UI virtualization occurs when  a subset of user interface (UI) elements are generated from a larger number of data items based on which items are visible on the screen.</span></span> <span data-ttu-id="1f5cf-124"><xref:System.Windows.Controls.VirtualizingPanel> 會定義 <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> 附加屬性，以啟用群組資料的 UI 虛擬化。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-124">The <xref:System.Windows.Controls.VirtualizingPanel> defines the <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> attached property that enables UI Virtualization for grouped data.</span></span>  <span data-ttu-id="1f5cf-125">如需群組資料的詳細資訊，請參閱「如何：使用 XAML 中的檢視排序和分組資料」。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-125">For more information about grouping data, see How to: Sort and Group Data Using a View in XAML.</span></span>  <span data-ttu-id="1f5cf-126">如需虛擬化群組資料的詳細資訊，請參閱 <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> 附加屬性。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-126">For more information about virtualizing grouped data, see the <xref:System.Windows.Controls.VirtualizingPanel.IsVirtualizingWhenGrouping%2A> attached property.</span></span>  
  
<a name="VirtualizingPanel"></a>   
## <a name="new-features-for-the-virtualizingpanel"></a><span data-ttu-id="1f5cf-127">VirtualizingPanel 的新功能</span><span class="sxs-lookup"><span data-stu-id="1f5cf-127">New features for the VirtualizingPanel</span></span>  
  
1. <span data-ttu-id="1f5cf-128">您可以使用 <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> 附加屬性來指定 <xref:System.Windows.Controls.VirtualizingPanel>（例如 <xref:System.Windows.Controls.VirtualizingStackPanel>）是否會顯示部分專案。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-128">You can specify whether a <xref:System.Windows.Controls.VirtualizingPanel>, such as the <xref:System.Windows.Controls.VirtualizingStackPanel>, displays partial items by using the <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> attached property.</span></span> <span data-ttu-id="1f5cf-129">如果 <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> 設定為 [<xref:System.Windows.Controls.ScrollUnit.Item>]，則 <xref:System.Windows.Controls.VirtualizingPanel> 只會顯示完全可見的專案。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-129">If <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> is set to <xref:System.Windows.Controls.ScrollUnit.Item>, the <xref:System.Windows.Controls.VirtualizingPanel> will only display items that are completely visible.</span></span> <span data-ttu-id="1f5cf-130">如果 <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> 設定為 [<xref:System.Windows.Controls.ScrollUnit.Pixel>]，<xref:System.Windows.Controls.VirtualizingPanel> 可以顯示部分可見的專案。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-130">If <xref:System.Windows.Controls.VirtualizingPanel.ScrollUnit%2A> is set to <xref:System.Windows.Controls.ScrollUnit.Pixel>, the <xref:System.Windows.Controls.VirtualizingPanel> can display partially visible items.</span></span>  
  
2. <span data-ttu-id="1f5cf-131">您可以使用 <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A> 附加屬性，在 <xref:System.Windows.Controls.VirtualizingPanel> 進行虛擬化時，指定視口前後的快取大小。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-131">You can specify the  size of the cache before and after the viewport when the <xref:System.Windows.Controls.VirtualizingPanel> is virtualizing by using the <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A> attached property.</span></span>  <span data-ttu-id="1f5cf-132">快取是不虛擬化項目之高於或低於檢視區的空間量。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-132">The cache is the amount of space above or below the viewport in which items are not virtualized.</span></span>  <span data-ttu-id="1f5cf-133">使用快取以避免產生 UI 元素，因為它們捲動至檢視中可以改善效能。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-133">Using a cache to avoid generating UI elements as they’re scrolled into view can improve performance.</span></span> <span data-ttu-id="1f5cf-134">填入快取的優先順序較低，讓應用程式在作業期間不會變成沒有回應。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-134">The cache is populated at a lower priority so that the application does not become unresponsive during the operation.</span></span> <span data-ttu-id="1f5cf-135"><xref:System.Windows.Controls.VirtualizingPanel.CacheLengthUnit%2A?displayProperty=nameWithType> 屬性會決定 <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A?displayProperty=nameWithType>所使用的度量單位。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-135">The <xref:System.Windows.Controls.VirtualizingPanel.CacheLengthUnit%2A?displayProperty=nameWithType> property determines the unit of measurement that is used by <xref:System.Windows.Controls.VirtualizingPanel.CacheLength%2A?displayProperty=nameWithType>.</span></span>  
  
<a name="static_properties"></a>   
## <a name="binding-to-static-properties"></a><span data-ttu-id="1f5cf-136">繫結至靜態屬性</span><span class="sxs-lookup"><span data-stu-id="1f5cf-136">Binding to static properties</span></span>  
 <span data-ttu-id="1f5cf-137">您可以使用靜態屬性做為資料繫結的來源。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-137">You can use static properties as the source of a data binding.</span></span> <span data-ttu-id="1f5cf-138">資料繫結引擎會辨識當引發靜態事件時，屬性的值何時變更。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-138">The data binding engine recognizes when the property's value changes if a static event is raised.</span></span>  <span data-ttu-id="1f5cf-139">例如，如果類別 `SomeClass` 定義靜態屬性，稱為 `MyProperty`，`SomeClass` 可以定義為靜態事件，該事件在 `MyProperty` 的值變更時引發。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-139">For example, if the class `SomeClass` defines a static property called `MyProperty`, `SomeClass` can define a static event that is raised when the value of `MyProperty` changes.</span></span>  <span data-ttu-id="1f5cf-140">靜態事件可以使用下列簽章。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-140">The static event can use either of the following signatures.</span></span>  
  
- `public static event EventHandler MyPropertyChanged;`  
  
- `public static event EventHandler<PropertyChangedEventArgs> StaticPropertyChanged;`  
  
 <span data-ttu-id="1f5cf-141">請注意，在第一個案例中，類別會公開名為*PropertyName*`Changed` 的靜態事件，將 <xref:System.EventArgs> 傳遞給事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-141">Note that in the first case, the class exposes a static event named *PropertyName*`Changed` that passes <xref:System.EventArgs> to the event handler.</span></span>  <span data-ttu-id="1f5cf-142">在第二個案例中，類別會公開名為 `StaticPropertyChanged` 的靜態事件，將 <xref:System.ComponentModel.PropertyChangedEventArgs> 傳遞給事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-142">In the second case, the class exposes a static event named `StaticPropertyChanged` that passes <xref:System.ComponentModel.PropertyChangedEventArgs> to the event handler.</span></span> <span data-ttu-id="1f5cf-143">實作靜態屬性的類別，可以選擇使用任一種方法引發屬性變更通知。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-143">A class that implements the static property can choose to raise property-change notifications using either method.</span></span>  
  
<a name="xthread_access"></a>   
## <a name="accessing-collections-on-non-ui-threads"></a><span data-ttu-id="1f5cf-144">存取非 UI 執行緒上的集合</span><span class="sxs-lookup"><span data-stu-id="1f5cf-144">Accessing collections on non-UI Threads</span></span>  
 <span data-ttu-id="1f5cf-145">WPF 可讓您存取和修改在執行緒上的資料集合，不是建立集合的執行緒。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-145">WPF enables you to access and modify data collections on threads other than the one that created the collection.</span></span>  <span data-ttu-id="1f5cf-146">這可讓您使用背景執行緒從外部來源 (例如資料庫) 接收資料，並且在 UI 執行緒上顯示資料。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-146">This enables you to use a background thread to receive data from an external source, such as a database, and display the data on the UI thread.</span></span>  <span data-ttu-id="1f5cf-147">藉由使用另一個執行緒來修改集合，您的使用者介面仍然能夠保持對使用者互動回應。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-147">By using another thread to modify the collection, your user interface remains responsive to user interaction.</span></span>  
  
<a name="INotifyDataErrorInfo"></a>   
## <a name="synchronously-and-asynchronously-validating-data"></a><span data-ttu-id="1f5cf-148">同步和非同步驗證資料</span><span class="sxs-lookup"><span data-stu-id="1f5cf-148">Synchronously and Asynchronously validating data</span></span>  
 <span data-ttu-id="1f5cf-149"><xref:System.ComponentModel.INotifyDataErrorInfo> 介面可讓資料實體類別執行自訂驗證規則，並以非同步方式公開驗證結果。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-149">The <xref:System.ComponentModel.INotifyDataErrorInfo> interface enables data entity classes to implement custom validation rules and expose validation results asynchronously.</span></span> <span data-ttu-id="1f5cf-150">此介面也支援自訂錯誤物件、每個屬性多個錯誤、跨屬性錯誤，以及實體層級錯誤。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-150">This interface also supports custom error objects, multiple errors per property, cross-property errors, and entity-level errors.</span></span>  <span data-ttu-id="1f5cf-151">如需詳細資訊，請參閱<xref:System.ComponentModel.INotifyDataErrorInfo>。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-151">For more information, see <xref:System.ComponentModel.INotifyDataErrorInfo>.</span></span>  
  
<a name="delay"></a>   
## <a name="automatically-updating-the-source-of-a-data-binding"></a><span data-ttu-id="1f5cf-152">自動更新資料繫結的來源</span><span class="sxs-lookup"><span data-stu-id="1f5cf-152">Automatically updating the source of a data binding</span></span>  
 <span data-ttu-id="1f5cf-153">如果您使用資料系結來更新資料來源，您可以使用 [<xref:System.Windows.Data.BindingBase.Delay%2A>] 屬性，指定在來源更新之前，在目標上進行屬性變更之後所要傳遞的時間量。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-153">If you use a data binding to update a data source, you can use the <xref:System.Windows.Data.BindingBase.Delay%2A> property to specify an amount of time to pass after the property changes on the target before the source updates.</span></span>  <span data-ttu-id="1f5cf-154">例如，假設您有一個 <xref:System.Windows.Controls.Slider>，其 <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> 屬性資料雙向系結至資料物件的屬性，且 <xref:System.Windows.Data.Binding.UpdateSourceTrigger%2A> 屬性設定為 <xref:System.Windows.Data.UpdateSourceTrigger.PropertyChanged>。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-154">For example, suppose that you have a <xref:System.Windows.Controls.Slider> that has its <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> property data two-way bound to a property of a data object and the <xref:System.Windows.Data.Binding.UpdateSourceTrigger%2A> property is set to <xref:System.Windows.Data.UpdateSourceTrigger.PropertyChanged>.</span></span>  <span data-ttu-id="1f5cf-155">在此範例中，當使用者移動 <xref:System.Windows.Controls.Slider>時，<xref:System.Windows.Controls.Slider> 所移動之每個圖元的來源會更新。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-155">In this example, when the user moves the <xref:System.Windows.Controls.Slider>, the source updates for each pixel that the <xref:System.Windows.Controls.Slider> moves.</span></span>  <span data-ttu-id="1f5cf-156">來源物件通常只有在滑杆的 <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> 停止變更時，才需要滑杆的值。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-156">The source object typically needs the value of the slider only when the slider's <xref:System.Windows.Controls.Primitives.RangeBase.Value%2A> stops changing.</span></span>  <span data-ttu-id="1f5cf-157">若要防止經常更新來源，請使用 <xref:System.Windows.Data.BindingBase.Delay%2A> 指定來源不應更新，直到捲動方塊停止移動之後的特定時間量過期為止。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-157">To prevent updating the source too often, use <xref:System.Windows.Data.BindingBase.Delay%2A> to specify that the source should not be updated until a certain amount of time elapses after the thumb stops moving.</span></span>  
  
<a name="ICustomTypeProvider"></a>   
## <a name="binding-to-types-that-implement-icustomtypeprovider"></a><span data-ttu-id="1f5cf-158">繫結至實作 ICustomTypeProvider 的型別</span><span class="sxs-lookup"><span data-stu-id="1f5cf-158">Binding to types that Implement ICustomTypeProvider</span></span>  
 <span data-ttu-id="1f5cf-159">WPF 支援將資料系結至執行 <xref:System.Reflection.ICustomTypeProvider>的物件，也稱為自訂類型。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-159">WPF supports data binding to objects that implement <xref:System.Reflection.ICustomTypeProvider>, also known as custom types.</span></span>  <span data-ttu-id="1f5cf-160">您可以在下列情況下使用自訂型別。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-160">You can use custom types in the following cases.</span></span>  
  
1. <span data-ttu-id="1f5cf-161">做為資料系結中的 <xref:System.Windows.PropertyPath>。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-161">As a <xref:System.Windows.PropertyPath> in a data binding.</span></span> <span data-ttu-id="1f5cf-162">例如，<xref:System.Windows.Data.Binding> 的 <xref:System.Windows.Data.Binding.Path%2A> 屬性可以參考自訂類型的屬性。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-162">For example, the <xref:System.Windows.Data.Binding.Path%2A> property of a <xref:System.Windows.Data.Binding> can reference a property of a custom type.</span></span>  
  
2. <span data-ttu-id="1f5cf-163">做為 <xref:System.Windows.DataTemplate.DataType%2A> 屬性的值。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-163">As the value of the <xref:System.Windows.DataTemplate.DataType%2A> property.</span></span>  
  
3. <span data-ttu-id="1f5cf-164">做為決定 <xref:System.Windows.Controls.DataGrid>中自動產生之資料行的類型。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-164">As a type that determines the automatically generated columns in a <xref:System.Windows.Controls.DataGrid>.</span></span>  
  
<a name="binding_state"></a>   
## <a name="retrieving-data-binding-information-from-a-binding-expression"></a><span data-ttu-id="1f5cf-165">從繫結運算式擷取資料繫結資訊</span><span class="sxs-lookup"><span data-stu-id="1f5cf-165">Retrieving data binding information from a binding expression</span></span>  
 <span data-ttu-id="1f5cf-166">在某些情況下，您可能會取得 <xref:System.Windows.Data.Binding> 的 <xref:System.Windows.Data.BindingExpression>，而且需要系結之來源和目標物件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-166">In certain cases, you might get the <xref:System.Windows.Data.BindingExpression> of a <xref:System.Windows.Data.Binding> and need information about the source and target objects of the binding.</span></span>  <span data-ttu-id="1f5cf-167">新的 API 已新增，可讓您取得來源或目標物件或相關聯的屬性。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-167">New APIs have been added to enable you to get the source or target object or the associated property.</span></span>  <span data-ttu-id="1f5cf-168">當您有 <xref:System.Windows.Data.BindingExpression>時，請使用下列 Api 來取得目標和來源的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-168">When you have a <xref:System.Windows.Data.BindingExpression>, use the following APIs to get information about the target and source.</span></span>  
  
|<span data-ttu-id="1f5cf-169">若要尋找繫結的此值</span><span class="sxs-lookup"><span data-stu-id="1f5cf-169">To find this value of the binding</span></span>|<span data-ttu-id="1f5cf-170">使用此 API</span><span class="sxs-lookup"><span data-stu-id="1f5cf-170">Use this API</span></span>|  
|---------------------------------------|------------------|  
|<span data-ttu-id="1f5cf-171">目標物件</span><span class="sxs-lookup"><span data-stu-id="1f5cf-171">The target object</span></span>|<xref:System.Windows.Data.BindingExpressionBase.Target%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="1f5cf-172">目標屬性</span><span class="sxs-lookup"><span data-stu-id="1f5cf-172">The target property</span></span>|<xref:System.Windows.Data.BindingExpressionBase.TargetProperty%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="1f5cf-173">來源物件</span><span class="sxs-lookup"><span data-stu-id="1f5cf-173">The source object</span></span>|<xref:System.Windows.Data.BindingExpression.ResolvedSource%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="1f5cf-174">來源屬性</span><span class="sxs-lookup"><span data-stu-id="1f5cf-174">The source property</span></span>|<xref:System.Windows.Data.BindingExpression.ResolvedSourcePropertyName%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="1f5cf-175"><xref:System.Windows.Data.BindingExpression> 是否屬於 <xref:System.Windows.Data.BindingGroup></span><span class="sxs-lookup"><span data-stu-id="1f5cf-175">Whether the <xref:System.Windows.Data.BindingExpression> belongs to a <xref:System.Windows.Data.BindingGroup></span></span>|<xref:System.Windows.Data.BindingExpressionBase.BindingGroup%2A?displayProperty=nameWithType>|  
|<span data-ttu-id="1f5cf-176"><xref:System.Windows.Data.BindingGroup> 的擁有者</span><span class="sxs-lookup"><span data-stu-id="1f5cf-176">The owner of a <xref:System.Windows.Data.BindingGroup></span></span>|<xref:System.Windows.Data.BindingGroup.Owner%2A>|  
  
<a name="DisconnectedSource"></a>   
## <a name="checking-for-a-valid-datacontext-object"></a><span data-ttu-id="1f5cf-177">檢查有效的 DataContext 物件</span><span class="sxs-lookup"><span data-stu-id="1f5cf-177">Checking for a valid DataContext object</span></span>  
 <span data-ttu-id="1f5cf-178">在某些情況下，<xref:System.Windows.Controls.ItemsControl> 中的專案容器 <xref:System.Windows.FrameworkElement.DataContext%2A> 會中斷連接。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-178">There are cases where the <xref:System.Windows.FrameworkElement.DataContext%2A> of an item container in an <xref:System.Windows.Controls.ItemsControl> becomes disconnected.</span></span>  <span data-ttu-id="1f5cf-179">專案容器是在 <xref:System.Windows.Controls.ItemsControl>中顯示專案的 UI 元素。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-179">An item container is the UI element that displays an item in an <xref:System.Windows.Controls.ItemsControl>.</span></span>  <span data-ttu-id="1f5cf-180">當 <xref:System.Windows.Controls.ItemsControl> 系結至集合的資料時，會針對每個專案產生專案容器。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-180">When an <xref:System.Windows.Controls.ItemsControl> is data bound to a collection, an item container is generated for each item.</span></span> <span data-ttu-id="1f5cf-181">在某些情況下，項目容器會從視覺化樹狀結構移除。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-181">In some cases, item containers are removed from the visual tree.</span></span> <span data-ttu-id="1f5cf-182">從基礎集合中移除專案，以及在 <xref:System.Windows.Controls.ItemsControl>上啟用虛擬化時，會移除專案容器的兩個典型案例。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-182">Two typical cases where an item container is removed are when an item is removed from the underlying collection and when virtualization is enabled on the <xref:System.Windows.Controls.ItemsControl>.</span></span> <span data-ttu-id="1f5cf-183">在這些情況下，專案容器的 <xref:System.Windows.FrameworkElement.DataContext%2A> 屬性會設定為 <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A?displayProperty=nameWithType> 靜態屬性所傳回的 sentinel 物件。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-183">In these cases, the <xref:System.Windows.FrameworkElement.DataContext%2A> property of the item container will be set to the sentinel object that is returned by the <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A?displayProperty=nameWithType> static property.</span></span>  <span data-ttu-id="1f5cf-184">在存取專案容器的 <xref:System.Windows.FrameworkElement.DataContext%2A> 之前，您應該先檢查 <xref:System.Windows.FrameworkElement.DataContext%2A> 是否等於 <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A> 物件。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-184">You should check whether the <xref:System.Windows.FrameworkElement.DataContext%2A> is equal to the <xref:System.Windows.Data.BindingOperations.DisconnectedSource%2A> object before accessing the <xref:System.Windows.FrameworkElement.DataContext%2A> of an item container.</span></span>  
  
<a name="live_shaping"></a>   
## <a name="repositioning-data-as-the-datas-values-change-live-shaping"></a><span data-ttu-id="1f5cf-185">隨著資料值變更重新調整資料的位置 (即時繪圖)</span><span class="sxs-lookup"><span data-stu-id="1f5cf-185">Repositioning data as the data's values change (Live shaping)</span></span>  
 <span data-ttu-id="1f5cf-186">資料的集合可以分組、排序或篩選。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-186">A collection of data can be grouped, sorted, or filtered.</span></span> <span data-ttu-id="1f5cf-187">WPF 4.5 可讓資料在修改時重新排列。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-187">WPF 4.5 enables the data to be rearranged when the data is modified.</span></span> <span data-ttu-id="1f5cf-188">例如，假設應用程式使用 <xref:System.Windows.Controls.DataGrid> 來列出股票市場中的股票，而股票則依股票值排序。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-188">For example, suppose that an application uses a <xref:System.Windows.Controls.DataGrid> to list stocks in a stock market and the stocks are sorted by stock value.</span></span> <span data-ttu-id="1f5cf-189">若在股票的 <xref:System.Windows.Data.CollectionView>上啟用即時排序，則庫存的 <xref:System.Windows.Controls.DataGrid> 位置會在庫存的值變得大於或小於另一個股票值時移動。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-189">If live sorting is enabled on the stocks' <xref:System.Windows.Data.CollectionView>, a stock's position in the <xref:System.Windows.Controls.DataGrid> moves when the value of the stock becomes greater or less than another stock's value.</span></span>   <span data-ttu-id="1f5cf-190">如需詳細資訊，請參閱 <xref:System.ComponentModel.ICollectionViewLiveShaping> 介面。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-190">For more information, see the <xref:System.ComponentModel.ICollectionViewLiveShaping> interface.</span></span>  
  
<a name="weak_event_pattern"></a>   
## <a name="improved-support-for-establishing-a-weak-reference-to-an-event"></a><span data-ttu-id="1f5cf-191">建立事件弱式參考的加強支援</span><span class="sxs-lookup"><span data-stu-id="1f5cf-191">Improved Support for Establishing a Weak Reference to an Event</span></span>  
 <span data-ttu-id="1f5cf-192">實作弱式事件模式現在更加容易，因為事件訂閱者可以參與它而不用實作額外的介面。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-192">Implementing the weak event pattern is now easier because subscribers to events can participate in it without implementing an extra interface.</span></span>  <span data-ttu-id="1f5cf-193">一般 <xref:System.Windows.WeakEventManager> 類別也可以讓訂閱者參與弱式事件模式（如果特定的 <xref:System.Windows.WeakEventManager> 不存在於某個事件）。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-193">The generic <xref:System.Windows.WeakEventManager> class also enables subscribers to participate in the weak event pattern if a dedicated <xref:System.Windows.WeakEventManager> does not exist for a certain event.</span></span>  <span data-ttu-id="1f5cf-194">如需詳細資訊，請參閱[弱式事件模式](../advanced/weak-event-patterns.md)。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-194">For more information, see [Weak Event Patterns](../advanced/weak-event-patterns.md).</span></span>  
  
<a name="async"></a>   
## <a name="new-methods-for-the-dispatcher-class"></a><span data-ttu-id="1f5cf-195">Dispatcher 類別的新方法</span><span class="sxs-lookup"><span data-stu-id="1f5cf-195">New methods for the Dispatcher class</span></span>  
 <span data-ttu-id="1f5cf-196">Dispatcher 類別會定義同步和非同步作業的新方法。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-196">The Dispatcher class defines new methods for synchronous and asynchronous operations.</span></span>  <span data-ttu-id="1f5cf-197">同步 <xref:System.Windows.Threading.Dispatcher.Invoke%2A> 方法會定義接受 <xref:System.Action> 或 <xref:System.Func%601> 參數的多載。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-197">The synchronous <xref:System.Windows.Threading.Dispatcher.Invoke%2A> method defines overloads that take an <xref:System.Action> or <xref:System.Func%601> parameter.</span></span> <span data-ttu-id="1f5cf-198">新的非同步方法 <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>也會採用 <xref:System.Action> 或 <xref:System.Func%601> 做為回呼參數，並傳回 <xref:System.Windows.Threading.DispatcherOperation> 或 <xref:System.Windows.Threading.DispatcherOperation%601>。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-198">The new asynchronous method, <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>, also takes an <xref:System.Action> or <xref:System.Func%601> as the callback parameter and returns a <xref:System.Windows.Threading.DispatcherOperation> or <xref:System.Windows.Threading.DispatcherOperation%601>.</span></span>   <span data-ttu-id="1f5cf-199"><xref:System.Windows.Threading.DispatcherOperation> 和 <xref:System.Windows.Threading.DispatcherOperation%601> 類別會定義 <xref:System.Threading.Tasks.Task> 屬性。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-199">The <xref:System.Windows.Threading.DispatcherOperation> and <xref:System.Windows.Threading.DispatcherOperation%601> classes define a <xref:System.Threading.Tasks.Task> property.</span></span>  <span data-ttu-id="1f5cf-200">當您呼叫 <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>時，您可以使用 `await` 關鍵字搭配 <xref:System.Windows.Threading.DispatcherOperation> 或相關聯的 <xref:System.Threading.Tasks.Task>。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-200">When you call <xref:System.Windows.Threading.Dispatcher.InvokeAsync%2A>, you can use the `await` keyword with either the <xref:System.Windows.Threading.DispatcherOperation> or the associated <xref:System.Threading.Tasks.Task>.</span></span> <span data-ttu-id="1f5cf-201">如果您需要以同步方式等候 <xref:System.Windows.Threading.DispatcherOperation> 或 <xref:System.Windows.Threading.DispatcherOperation%601>所傳回的 <xref:System.Threading.Tasks.Task>，請呼叫 <xref:System.Windows.Threading.TaskExtensions.DispatcherOperationWait%2A> 擴充方法。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-201">If you need to wait synchronously for the <xref:System.Threading.Tasks.Task> that is returned by a <xref:System.Windows.Threading.DispatcherOperation> or <xref:System.Windows.Threading.DispatcherOperation%601>, call the <xref:System.Windows.Threading.TaskExtensions.DispatcherOperationWait%2A> extension method.</span></span> <span data-ttu-id="1f5cf-202">如果作業在呼叫執行緒上排入佇列，則呼叫 <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> 將會導致鎖死。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-202">Calling <xref:System.Threading.Tasks.Task.Wait%2A?displayProperty=nameWithType> will result in a deadlock if the operation is queued on a calling thread.</span></span> <span data-ttu-id="1f5cf-203">如需使用 <xref:System.Threading.Tasks.Task> 執行非同步作業的詳細資訊，請參閱工作平行處理原則[（工作平行程式庫）](../../../standard/parallel-programming/task-based-asynchronous-programming.md)。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-203">For more information about using a <xref:System.Threading.Tasks.Task> to perform asynchronous operations, see [Task Parallelism (Task Parallel Library)](../../../standard/parallel-programming/task-based-asynchronous-programming.md).</span></span>  
  
<a name="events_markup_extenions"></a>   
## <a name="markup-extensions-for-events"></a><span data-ttu-id="1f5cf-204">事件的標記延伸</span><span class="sxs-lookup"><span data-stu-id="1f5cf-204">Markup Extensions for Events</span></span>  
 <span data-ttu-id="1f5cf-205">WPF 4.5 支援事件的標記延伸。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-205">WPF 4.5 supports markup extensions for events.</span></span>  <span data-ttu-id="1f5cf-206">WPF 不會定義要用於事件的標記延伸，協力廠商可以建立可與事件一起使用的標記延伸。</span><span class="sxs-lookup"><span data-stu-id="1f5cf-206">While WPF does not define a markup extension to be used for events, third parties are able to create a markup extension that can be used with events.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1f5cf-207">請參閱</span><span class="sxs-lookup"><span data-stu-id="1f5cf-207">See also</span></span>

- [<span data-ttu-id="1f5cf-208">.NET Framework 的新功能</span><span class="sxs-lookup"><span data-stu-id="1f5cf-208">What's New in the .NET Framework</span></span>](../../whats-new/index.md)
