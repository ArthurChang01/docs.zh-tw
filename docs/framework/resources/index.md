---
title: .NET 應用程式中的資源
ms.date: 07/25/2018
helpviewer_keywords:
- deploying applications [.NET Framework], resources
- deploying applications [.NET Core], resources
- application resources
- resource files
- satellite assemblies
- localization
- packaging application resources
- localizing resources
ms.assetid: 8ad495d4-2941-40cf-bf64-e82e85825890
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 889158aebb70de20b4e64044b5fa61dc3494ed73
ms.sourcegitcommit: 41c0637e894fbcd0713d46d6ef1866f08dc321a2
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/01/2019
ms.locfileid: "57203359"
---
# <a name="resources-in-net-apps"></a><span data-ttu-id="8b223-102">.NET 應用程式中的資源</span><span class="sxs-lookup"><span data-stu-id="8b223-102">Resources in .NET Apps</span></span>
<span data-ttu-id="8b223-103">幾乎每個實際執行品質應用程式都必須使用資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-103">Nearly every production-quality app has to use resources.</span></span> <span data-ttu-id="8b223-104">資源是任何使用應用程式以邏輯方式部署的非執行檔資料。</span><span class="sxs-lookup"><span data-stu-id="8b223-104">A resource is any nonexecutable data that is logically deployed with an app.</span></span> <span data-ttu-id="8b223-105">資源可能在應用程式中顯示作錯誤訊息，或做為使用者介面的一部分。</span><span class="sxs-lookup"><span data-stu-id="8b223-105">A resource might be displayed in an app as error messages or as part of the user interface.</span></span> <span data-ttu-id="8b223-106">資源可以含有一些表單中的資料，包括字串、影像和永續性物件。</span><span class="sxs-lookup"><span data-stu-id="8b223-106">Resources can contain data in a number of forms, including strings, images, and persisted objects.</span></span> <span data-ttu-id="8b223-107">(若要將保留物件寫入資源檔，物件必須是可序列化的)。將資料儲存在資源檔中，可讓您不需要重新編譯整個應用程式即可變更資料。</span><span class="sxs-lookup"><span data-stu-id="8b223-107">(To write persisted objects to a resource file, the objects must be serializable.) Storing your data in a resource file enables you to change the data without recompiling your entire app.</span></span> <span data-ttu-id="8b223-108">也可讓您將資料儲存在單一位置，不需要依賴儲存在多個位置的硬式編碼資料。</span><span class="sxs-lookup"><span data-stu-id="8b223-108">It also enables you to store data in a single location, and eliminates the need to rely on hard-coded data that is stored in multiple locations.</span></span>  
  
 <span data-ttu-id="8b223-109">.NET Framework 與 .NET Core 提供桌建立和當地語系化資源的完整支援。</span><span class="sxs-lookup"><span data-stu-id="8b223-109">The .NET Framework and .NET Core provide comprehensive support for the creation and localization of resources.</span></span> <span data-ttu-id="8b223-110">此外，.NET 也支援簡單的模型以封裝及部署當地語系化資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-110">In addition, .NET supports a simple model for packaging and deploying localized resources.</span></span>  
  
 <span data-ttu-id="8b223-111">如需 ASP.NET 中資源的詳細資訊，請參閱 [ASP.NET 網頁資源概觀](https://docs.microsoft.com/previous-versions/aspnet/ms227427(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="8b223-111">For information about resources in ASP.NET, see [ASP.NET Web Page Resources Overview](https://docs.microsoft.com/previous-versions/aspnet/ms227427(v=vs.100)).</span></span>  
  
## <a name="creating-and-localizing-resources"></a><span data-ttu-id="8b223-112">建立和當地語系化資源</span><span class="sxs-lookup"><span data-stu-id="8b223-112">Creating and Localizing Resources</span></span>  

<span data-ttu-id="8b223-113">在非當地語系化的應用程式中，您可以使用資源檔做為應用程式資料的存放庫，特別是針對原始程式碼中多個位置的硬式編碼字串。</span><span class="sxs-lookup"><span data-stu-id="8b223-113">In a non-localized app, you can use resource files as a repository for app data, particularly for strings that might otherwise be hard-coded in multiple locations in source code.</span></span> <span data-ttu-id="8b223-114">大多數情況下，您建立的資源是文字 (.txt) 或 XML (.resx) 檔案，並且使用 [Resgen.exe (資源檔產生器)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md) 將它們編譯成二進位 .resources 檔。</span><span class="sxs-lookup"><span data-stu-id="8b223-114">Most commonly, you create resources as either text (.txt) or XML (.resx) files, and use [Resgen.exe (Resource File Generator)](../../../docs/framework/tools/resgen-exe-resource-file-generator.md) to compile them into binary .resources files.</span></span> <span data-ttu-id="8b223-115">然後這些檔案會由語言編譯器內嵌在應用程式的可執行檔。</span><span class="sxs-lookup"><span data-stu-id="8b223-115">These files can then be embedded in the app's executable file by a language compiler.</span></span> <span data-ttu-id="8b223-116">如需有關建立資源檔的詳細資訊，請參閱[建立資源檔](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md)。</span><span class="sxs-lookup"><span data-stu-id="8b223-116">For more information about creating resources, see [Creating Resource Files](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md).</span></span>  

<span data-ttu-id="8b223-117">您也可以針對特定文化特性當地語系化應用程式的資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-117">You can also localize your app's resources for specific cultures.</span></span> <span data-ttu-id="8b223-118">這可讓您建置應用程式的當地語系化 (轉譯) 版本。</span><span class="sxs-lookup"><span data-stu-id="8b223-118">This enables you to build localized (translated) versions of your apps.</span></span> <span data-ttu-id="8b223-119">當您開發使用當地語系化資源的應用程式時，如果沒有適當的資源可供使用，您會指定文化特性做為其資源使用的中性或後援文化特性。</span><span class="sxs-lookup"><span data-stu-id="8b223-119">When you develop an app that uses localized resources, you designate a culture that serves as the neutral or fallback culture whose resources are used if no suitable resources are available.</span></span> <span data-ttu-id="8b223-120">一般而言，中性文化特性的資源是儲存在應用程式的可執行檔中。</span><span class="sxs-lookup"><span data-stu-id="8b223-120">Typically, the resources of the neutral culture are stored in the app's executable.</span></span> <span data-ttu-id="8b223-121">個別當地語系化文化特性的其餘資源會儲存在獨立的附屬組件。</span><span class="sxs-lookup"><span data-stu-id="8b223-121">The remaining resources for individual localized cultures are stored in standalone satellite assemblies.</span></span> <span data-ttu-id="8b223-122">如需詳細資訊，請參閱[建立附屬組件](../../../docs/framework/resources/creating-satellite-assemblies-for-desktop-apps.md)。</span><span class="sxs-lookup"><span data-stu-id="8b223-122">For more information, see [Creating Satellite Assemblies](../../../docs/framework/resources/creating-satellite-assemblies-for-desktop-apps.md).</span></span>  
  
## <a name="packaging-and-deploying-resources"></a><span data-ttu-id="8b223-123">封裝和部署資源</span><span class="sxs-lookup"><span data-stu-id="8b223-123">Packaging and Deploying Resources</span></span>  
 <span data-ttu-id="8b223-124">您在[附屬組件](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)中部署當地語系化應用程式資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-124">You deploy localized app resources in [satellite assemblies](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md).</span></span> <span data-ttu-id="8b223-125">附屬組件包含單一文化特性的資源。它不包含任何應用程式程式碼。</span><span class="sxs-lookup"><span data-stu-id="8b223-125">A satellite assembly contains the resources of a single culture; it does not contain any app code.</span></span> <span data-ttu-id="8b223-126">在附屬組件部署模型中，您會建立應用程式，具有一個預設組件 (通常是主要組件) 和應用程式支援之每個文化特性的一個附屬組件。</span><span class="sxs-lookup"><span data-stu-id="8b223-126">In the satellite assembly deployment model, you create an app with one default assembly (which is typically the main assembly) and one satellite assembly for each culture that the app supports.</span></span> <span data-ttu-id="8b223-127">因為附屬組件不是主要組件的一部分，您可以輕鬆地取代或更新對應至特定文化特性的資源，而不需要取代應用程式的主要組件。</span><span class="sxs-lookup"><span data-stu-id="8b223-127">Because the satellite assemblies are not part of the main assembly, you can easily replace or update resources corresponding to a specific culture without replacing the app's main assembly.</span></span>  
  
 <span data-ttu-id="8b223-128">謹慎地決定哪些資源將組成應用程式的預設資源組件。</span><span class="sxs-lookup"><span data-stu-id="8b223-128">Carefully determine which resources will make up your app's default resource assembly.</span></span> <span data-ttu-id="8b223-129">因為它是主要組件的一部分，它的任何變更需要您取代主要組件。</span><span class="sxs-lookup"><span data-stu-id="8b223-129">Because it is a part of the main assembly, any changes to it will require you to replace the main assembly.</span></span> <span data-ttu-id="8b223-130">如果您未提供預設資源，當[資源後援處理序](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)嘗試尋找它時，將會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="8b223-130">If you do not provide a default resource, an exception will be thrown when the [resource fallback process](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md) attempts to find it.</span></span> <span data-ttu-id="8b223-131">在設計良好的應用程式中，使用資源應該永遠不會擲回例外狀況。</span><span class="sxs-lookup"><span data-stu-id="8b223-131">In a well-designed app, using resources should never throw an exception.</span></span>  
  
 <span data-ttu-id="8b223-132">如需詳細資訊，請參閱[封裝和部署資源](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)文章。</span><span class="sxs-lookup"><span data-stu-id="8b223-132">For more information, see the [Packaging and Deploying Resources](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md) article.</span></span>  
  
## <a name="retrieving-resources"></a><span data-ttu-id="8b223-133">擷取資源</span><span class="sxs-lookup"><span data-stu-id="8b223-133">Retrieving Resources</span></span>  
 <span data-ttu-id="8b223-134">在執行階段，應用程式會根據 <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType> 屬性所指定的文化特性，針對每個執行緒載入適當的當地語系化資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-134">At run time, an app loads the appropriate localized resources on a per-thread basis, based on the culture specified by the <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="8b223-135">這個屬性值被衍生，如下所示︰</span><span class="sxs-lookup"><span data-stu-id="8b223-135">This property value is derived as follows:</span></span>  
  
-   <span data-ttu-id="8b223-136">藉由直接將代表當地語系化文化特性的 <xref:System.Globalization.CultureInfo> 物件指派至 <xref:System.Threading.Thread.CurrentUICulture%2A?displayProperty=nameWithType> 屬性。</span><span class="sxs-lookup"><span data-stu-id="8b223-136">By directly assigning a <xref:System.Globalization.CultureInfo> object that represents the localized culture to the <xref:System.Threading.Thread.CurrentUICulture%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="8b223-137">如果未明確指派文化特性，則會從 <xref:System.Globalization.CultureInfo.DefaultThreadCurrentUICulture%2A?displayProperty=nameWithType> 屬性擷取預設執行緒 UI 文化特性。</span><span class="sxs-lookup"><span data-stu-id="8b223-137">If a culture is not explicitly assigned, by retrieving the default thread UI culture from the <xref:System.Globalization.CultureInfo.DefaultThreadCurrentUICulture%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="8b223-138">如果未明確指派預設執行緒 UI 文化特性 (透過在本機電腦上擷取目前使用者的文化特性)。</span><span class="sxs-lookup"><span data-stu-id="8b223-138">If a default thread UI culture is not explicitly assigned, by retrieving the culture for the current user on the local computer.</span></span> <span data-ttu-id="8b223-139">在 Windows 上執行的 .NET 實作透過呼叫 Windows [`GetUserDefaultUILanguage`](/windows/desktop/api/winnls/nf-winnls-getuserdefaultuilanguage) 函式來執行此動作。</span><span class="sxs-lookup"><span data-stu-id="8b223-139">.NET implementations running on Windows do this  by calling the Windows [`GetUserDefaultUILanguage`](/windows/desktop/api/winnls/nf-winnls-getuserdefaultuilanguage) function.</span></span>  
  
 <span data-ttu-id="8b223-140">如需如何設定目前 UI 文化特性的詳細資訊，請參閱 <xref:System.Globalization.CultureInfo> 和 <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType> 參考頁面。</span><span class="sxs-lookup"><span data-stu-id="8b223-140">For more information about how the current UI culture is set, see the <xref:System.Globalization.CultureInfo> and <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType> reference pages.</span></span>  
  
 <span data-ttu-id="8b223-141">然後，您可以使用 <xref:System.Resources.ResourceManager?displayProperty=nameWithType> 類別，針對目前 UI 文化特性或特定文化特性擷取資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-141">You can then retrieve resources for the current UI culture or for a specific culture by using the <xref:System.Resources.ResourceManager?displayProperty=nameWithType> class.</span></span> <span data-ttu-id="8b223-142">雖然 <xref:System.Resources.ResourceManager> 類別最常用於擷取資源，<xref:System.Resources?displayProperty=nameWithType> 命名空間包含您可以用來擷取資源的額外類型。</span><span class="sxs-lookup"><span data-stu-id="8b223-142">Although the <xref:System.Resources.ResourceManager> class is most commonly used for retrieving resources, the <xref:System.Resources?displayProperty=nameWithType> namespace contains additional types that you can use to retrieve resources.</span></span> <span data-ttu-id="8b223-143">它們包括：</span><span class="sxs-lookup"><span data-stu-id="8b223-143">These include:</span></span>  
  
-   <span data-ttu-id="8b223-144"><xref:System.Resources.ResourceReader> 類別，可讓您列舉內嵌在組件中，或儲存在獨立二進位 .resources 檔中的資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-144">The <xref:System.Resources.ResourceReader> class, which enables you to enumerate resources embedded in an assembly or stored in a standalone binary .resources file.</span></span> <span data-ttu-id="8b223-145">當您不知道資源在執行階段可用的確切名稱時，這個項目很有用。</span><span class="sxs-lookup"><span data-stu-id="8b223-145">It is useful when you don't know the precise names of the resources that are available at run time.</span></span>  
  
-   <span data-ttu-id="8b223-146"><xref:System.Resources.ResXResourceReader> 類別，可讓您從 XML (.resx) 檔擷取資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-146">The <xref:System.Resources.ResXResourceReader> class, which enables you to retrieve resources from an XML (.resx) file.</span></span>  
  
-   <span data-ttu-id="8b223-147"><xref:System.Resources.ResourceSet> 類別，可讓您擷取特定文化特性的資源，而不需要觀察後援規則。</span><span class="sxs-lookup"><span data-stu-id="8b223-147">The <xref:System.Resources.ResourceSet> class, which enables you to retrieve the resources of a specific culture without observing fallback rules.</span></span> <span data-ttu-id="8b223-148">資源可以儲存在組件或獨立二進位 .resources 檔中。</span><span class="sxs-lookup"><span data-stu-id="8b223-148">The resources can be stored in an assembly or a standalone binary .resources file.</span></span> <span data-ttu-id="8b223-149">您也可以開發 <xref:System.Resources.IResourceReader> 實作，以使用 <xref:System.Resources.ResourceSet> 類別從其他來源擷取資源。</span><span class="sxs-lookup"><span data-stu-id="8b223-149">You can also develop an <xref:System.Resources.IResourceReader> implementation that enables you to use the <xref:System.Resources.ResourceSet> class to retrieve resources from some other source.</span></span>  
  
-   <span data-ttu-id="8b223-150"><xref:System.Resources.ResXResourceSet> 類別，可讓您將 XML 資源檔中的所有項目擷取至記憶體。</span><span class="sxs-lookup"><span data-stu-id="8b223-150">The <xref:System.Resources.ResXResourceSet> class, which enables you to retrieve all the items in an XML resource file into memory.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8b223-151">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8b223-151">See also</span></span>
- <xref:System.Globalization.CultureInfo>
- <xref:System.Globalization.CultureInfo.CurrentUICulture%2A?displayProperty=nameWithType>
- [<span data-ttu-id="8b223-152">應用程式基本概念</span><span class="sxs-lookup"><span data-stu-id="8b223-152">Application Essentials</span></span>](../../../docs/standard/application-essentials.md)
- [<span data-ttu-id="8b223-153">建立資源檔</span><span class="sxs-lookup"><span data-stu-id="8b223-153">Creating Resource Files</span></span>](../../../docs/framework/resources/creating-resource-files-for-desktop-apps.md)
- [<span data-ttu-id="8b223-154">封裝和部署資源</span><span class="sxs-lookup"><span data-stu-id="8b223-154">Packaging and Deploying Resources</span></span>](../../../docs/framework/resources/packaging-and-deploying-resources-in-desktop-apps.md)
- [<span data-ttu-id="8b223-155">建立附屬組件</span><span class="sxs-lookup"><span data-stu-id="8b223-155">Creating Satellite Assemblies</span></span>](../../../docs/framework/resources/creating-satellite-assemblies-for-desktop-apps.md)
- [<span data-ttu-id="8b223-156">擷取資源</span><span class="sxs-lookup"><span data-stu-id="8b223-156">Retrieving Resources</span></span>](../../../docs/framework/resources/retrieving-resources-in-desktop-apps.md)
