---
title: SQL Server 中的應用程式安全性案例
ms.date: 03/30/2017
ms.assetid: 0164f3a4-406e-4693-bec3-03c8e18b46d7
ms.openlocfilehash: bf4f4adfd5f49bd210026e40bd5fa4e67da10d75
ms.sourcegitcommit: 2eceb05f1a5bb261291a1f6a91c5153727ac1c19
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/04/2018
ms.locfileid: "43535985"
---
# <a name="application-security-scenarios-in-sql-server"></a><span data-ttu-id="8154b-102">SQL Server 中的應用程式安全性案例</span><span class="sxs-lookup"><span data-stu-id="8154b-102">Application Security Scenarios in SQL Server</span></span>
<span data-ttu-id="8154b-103">並不只有一種正確方式可以建立安全的 SQL Server 用戶端應用程式。</span><span class="sxs-lookup"><span data-stu-id="8154b-103">There is no single correct way to create a secure SQL Server client application.</span></span> <span data-ttu-id="8154b-104">每個應用程式的需求、部署環境及使用者對象都有其獨特性。</span><span class="sxs-lookup"><span data-stu-id="8154b-104">Every application is unique in its requirements, deployment environment, and user population.</span></span> <span data-ttu-id="8154b-105">初次部署時還相當安全的應用程式，隨著時間流逝，也可能變得不再那麼安全。</span><span class="sxs-lookup"><span data-stu-id="8154b-105">An application that is reasonably secure when it is initially deployed can become less secure over time.</span></span> <span data-ttu-id="8154b-106">要精確預測未來可能發生什麼威脅是不可能的事。</span><span class="sxs-lookup"><span data-stu-id="8154b-106">It is impossible to predict with any accuracy what threats may emerge in the future.</span></span>  
  
 <span data-ttu-id="8154b-107">SQL Server 這項產品已經歷經多個版本的演變，納入了最新的安全性功能，可以讓開發人員建立安全的資料庫應用程式。</span><span class="sxs-lookup"><span data-stu-id="8154b-107">SQL Server, as a product, has evolved over many versions to incorporate the latest security features that enable developers to create secure database applications.</span></span> <span data-ttu-id="8154b-108">不過，安全性並沒有單純的解決方案，而是需要持續的監控和更新。</span><span class="sxs-lookup"><span data-stu-id="8154b-108">However, security doesn't come in the box; it requires continual monitoring and updating.</span></span>  
  
## <a name="common-threats"></a><span data-ttu-id="8154b-109">常見威脅</span><span class="sxs-lookup"><span data-stu-id="8154b-109">Common Threats</span></span>  
 <span data-ttu-id="8154b-110">開發人員需要了解安全性威脅、針對防禦這些威脅而提供的工具，以及如何避免自身造成的安全性漏洞。</span><span class="sxs-lookup"><span data-stu-id="8154b-110">Developers need to understand security threats, the tools provided to counter them, and how to avoid self-inflicted security holes.</span></span> <span data-ttu-id="8154b-111">安全性如同鏈結，任何環節的中斷都會危及整體的強度。</span><span class="sxs-lookup"><span data-stu-id="8154b-111">Security can best be thought of as a chain, where a break in any one link compromises the strength of the whole.</span></span> <span data-ttu-id="8154b-112">下列清單包含一些常見的安全性威脅，在本節的主題中將加以詳細討論。</span><span class="sxs-lookup"><span data-stu-id="8154b-112">The following list includes some common security threats that are discussed in more detail in the topics in this section.</span></span>  
  
### <a name="sql-injection"></a><span data-ttu-id="8154b-113">SQL 插入</span><span class="sxs-lookup"><span data-stu-id="8154b-113">SQL Injection</span></span>  
 <span data-ttu-id="8154b-114">「SQL 插入」(SQL Injection) 是指惡意的使用者用來輸入 Transact-SQL 陳述式 (而非有效輸入) 的流程。</span><span class="sxs-lookup"><span data-stu-id="8154b-114">SQL Injection is the process by which a malicious user enters Transact-SQL statements instead of valid input.</span></span> <span data-ttu-id="8154b-115">如果該輸入未經驗證而直接傳遞至伺服器，而且應用程式不慎而執行了插入的程式碼，則攻擊就可能會危及或損毀資料。</span><span class="sxs-lookup"><span data-stu-id="8154b-115">If the input is passed directly to the server without being validated and if the application inadvertently executes the injected code, then the attack has the potential to damage or destroy data.</span></span> <span data-ttu-id="8154b-116">您可以藉由使用預存程序 (Stored Procedure) 和參數化命令、避免動態 SQL 以及限制所有使用者的權限，來防堵 SQL Server 插入式攻擊。</span><span class="sxs-lookup"><span data-stu-id="8154b-116">You can thwart SQL Server injection attacks by using stored procedures and parameterized commands, avoiding dynamic SQL, and restricting permissions on all users.</span></span>  
  
### <a name="elevation-of-privilege"></a><span data-ttu-id="8154b-117">權限提高</span><span class="sxs-lookup"><span data-stu-id="8154b-117">Elevation of Privilege</span></span>  
 <span data-ttu-id="8154b-118">權限提高攻擊會發生在使用者能夠取得受信任帳戶 (例如擁有者或系統管理員) 的權限時。</span><span class="sxs-lookup"><span data-stu-id="8154b-118">Elevation of privilege attacks occur when a user is able to assume the privileges of a trusted account, such as an owner or administrator.</span></span> <span data-ttu-id="8154b-119">請務必在最小權限的帳戶下執行，並只指派必要的權限。</span><span class="sxs-lookup"><span data-stu-id="8154b-119">Always run under least-privileged user accounts and assign only needed permissions.</span></span> <span data-ttu-id="8154b-120">請避免使用系統管理員或擁有者帳戶執行程式碼。</span><span class="sxs-lookup"><span data-stu-id="8154b-120">Avoid using administrative or owner accounts for executing code.</span></span> <span data-ttu-id="8154b-121">如此就算攻擊成功，也可限制造成的傷害。</span><span class="sxs-lookup"><span data-stu-id="8154b-121">This limits the amount of damage that can occur if an attack succeeds.</span></span> <span data-ttu-id="8154b-122">在執行需要其他權限的工作時，請只在工作期間才使用程序簽章或模擬。</span><span class="sxs-lookup"><span data-stu-id="8154b-122">When performing tasks that require additional permissions, use procedure signing or impersonation only for the duration of the task.</span></span> <span data-ttu-id="8154b-123">您可以使用憑證來簽署預存程序，或使用模擬來暫時指派權限。</span><span class="sxs-lookup"><span data-stu-id="8154b-123">You can sign stored procedures with certificates or use impersonation to temporarily assign permissions.</span></span>  
  
### <a name="probing-and-intelligent-observation"></a><span data-ttu-id="8154b-124">探查和智慧型觀測</span><span class="sxs-lookup"><span data-stu-id="8154b-124">Probing and Intelligent Observation</span></span>  
 <span data-ttu-id="8154b-125">探查攻擊可能會使用應用程式產生的錯誤訊息來搜尋安全性漏洞。</span><span class="sxs-lookup"><span data-stu-id="8154b-125">A probing attack can use error messages generated by an application to search for security vulnerabilities.</span></span> <span data-ttu-id="8154b-126">在所有程序性程式碼中實作錯誤處理，以避免 SQL Server 錯誤資訊傳回給使用者。</span><span class="sxs-lookup"><span data-stu-id="8154b-126">Implement error handling in all procedural code to prevent SQL Server error information from being returned to the end user.</span></span>  
  
### <a name="authentication"></a><span data-ttu-id="8154b-127">驗證</span><span class="sxs-lookup"><span data-stu-id="8154b-127">Authentication</span></span>  
 <span data-ttu-id="8154b-128">如果以使用者輸入為基礎的連接字串是在執行階段建構，則在使用 SQL Server 登入時可能會發生連接字串插入攻擊。</span><span class="sxs-lookup"><span data-stu-id="8154b-128">A connection string injection attack can occur when using SQL Server logins if a connection string based on user input is constructed at run time.</span></span> <span data-ttu-id="8154b-129">如果沒有檢查連接字串是否具有有效的關鍵字字組，則攻擊者可以插入多餘的字元，而可能得以存取伺服器上的機密資料或其他資源。</span><span class="sxs-lookup"><span data-stu-id="8154b-129">If the connection string is not checked for valid keyword pairs, an attacker can insert extra characters, potentially accessing sensitive data or other resources on the server.</span></span> <span data-ttu-id="8154b-130">請盡量使用 Windows 驗證。</span><span class="sxs-lookup"><span data-stu-id="8154b-130">Use Windows authentication wherever possible.</span></span> <span data-ttu-id="8154b-131">如果必須使用 SQL Server 登入，請使用 <xref:System.Data.SqlClient.SqlConnectionStringBuilder> 在執行階段建立及驗證連接字串。</span><span class="sxs-lookup"><span data-stu-id="8154b-131">If you must use SQL Server logins, use the <xref:System.Data.SqlClient.SqlConnectionStringBuilder> to create and validate connection strings at run time.</span></span>  
  
### <a name="passwords"></a><span data-ttu-id="8154b-132">密碼</span><span class="sxs-lookup"><span data-stu-id="8154b-132">Passwords</span></span>  
 <span data-ttu-id="8154b-133">許多攻擊之所以成功，都是因為侵入者得以取得或猜出授權使用者的密碼。</span><span class="sxs-lookup"><span data-stu-id="8154b-133">Many attacks succeed because an intruder was able to obtain or guess a password for a privileged user.</span></span> <span data-ttu-id="8154b-134">密碼是在面對侵入者時的第一道防線，所以設定強式密碼對於系統安全性而言十分關鍵。</span><span class="sxs-lookup"><span data-stu-id="8154b-134">Passwords are your first line of defense against intruders, so setting strong passwords is essential to the security of your system.</span></span> <span data-ttu-id="8154b-135">針對混合模式驗證建立密碼原則並加以強制執行。</span><span class="sxs-lookup"><span data-stu-id="8154b-135">Create and enforce password policies for mixed mode authentication.</span></span>  
  
 <span data-ttu-id="8154b-136">即使在使用「Windows 驗證」時，也請務必為 `sa` 帳戶指派強式密碼。</span><span class="sxs-lookup"><span data-stu-id="8154b-136">Always assign a strong password to the `sa` account, even when using Windows Authentication.</span></span>  
  
## <a name="in-this-section"></a><span data-ttu-id="8154b-137">本節內容</span><span class="sxs-lookup"><span data-stu-id="8154b-137">In This Section</span></span>  
 [<span data-ttu-id="8154b-138">在 SQL Server 中使用預存程序來管理權限</span><span class="sxs-lookup"><span data-stu-id="8154b-138">Managing Permissions with Stored Procedures in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/managing-permissions-with-stored-procedures-in-sql-server.md)  
 <span data-ttu-id="8154b-139">說明如何使用預存程序 (Stored Procedure) 管理權限並控制資料存取。</span><span class="sxs-lookup"><span data-stu-id="8154b-139">Describes how to use stored procedures to manage permissions and control data access.</span></span> <span data-ttu-id="8154b-140">使用預存程序是許多安全性威脅的有效回應方式。</span><span class="sxs-lookup"><span data-stu-id="8154b-140">Using stored procedures is an effective way to respond to many security threats.</span></span>  
  
 [<span data-ttu-id="8154b-141">在 SQL Server 中撰寫安全的動態 SQL</span><span class="sxs-lookup"><span data-stu-id="8154b-141">Writing Secure Dynamic SQL in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/writing-secure-dynamic-sql-in-sql-server.md)  
 <span data-ttu-id="8154b-142">說明使用預存程序撰寫安全動態 SQL 的技巧。</span><span class="sxs-lookup"><span data-stu-id="8154b-142">Describes techniques for writing secure dynamic SQL using stored procedures.</span></span>  
  
 [<span data-ttu-id="8154b-143">在 SQL Server 中簽署預存程序</span><span class="sxs-lookup"><span data-stu-id="8154b-143">Signing Stored Procedures in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/signing-stored-procedures-in-sql-server.md)  
 <span data-ttu-id="8154b-144">說明如何使用憑證簽署預存程序，讓使用者可以使用不能直接存取的資料。</span><span class="sxs-lookup"><span data-stu-id="8154b-144">Describes how to sign a stored procedure with a certificate to enable users to work with data they do not have direct access to.</span></span> <span data-ttu-id="8154b-145">如此預存程序就可以執行呼叫端並無直接執行權限的作業。</span><span class="sxs-lookup"><span data-stu-id="8154b-145">This enables stored procedures to perform operations that the caller does not have permissions to perform directly.</span></span>  
  
 [<span data-ttu-id="8154b-146">在 SQL Server 中使用模擬來自訂權限</span><span class="sxs-lookup"><span data-stu-id="8154b-146">Customizing Permissions with Impersonation in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/customizing-permissions-with-impersonation-in-sql-server.md)  
 <span data-ttu-id="8154b-147">說明如何使用 EXECUTE AS 子句模擬其他使用者。</span><span class="sxs-lookup"><span data-stu-id="8154b-147">Describes how to use the EXECUTE AS clause to impersonate another user.</span></span> <span data-ttu-id="8154b-148">模擬會將執行內容從呼叫端切換到指定的使用者。</span><span class="sxs-lookup"><span data-stu-id="8154b-148">Impersonation switches the execution context from the caller to the specified user.</span></span>  
  
 [<span data-ttu-id="8154b-149">在 SQL Server 中授與資料列層級權限</span><span class="sxs-lookup"><span data-stu-id="8154b-149">Granting Row-Level Permissions in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/granting-row-level-permissions-in-sql-server.md)  
 <span data-ttu-id="8154b-150">說明如何實作資料列層級權限以限制資料存取。</span><span class="sxs-lookup"><span data-stu-id="8154b-150">Describes how to implement row-level permissions to restrict data access.</span></span>  
  
 [<span data-ttu-id="8154b-151">在 SQL Server 中建立應用程式角色</span><span class="sxs-lookup"><span data-stu-id="8154b-151">Creating Application Roles in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/creating-application-roles-in-sql-server.md)  
 <span data-ttu-id="8154b-152">說明應用程式角色的功能。</span><span class="sxs-lookup"><span data-stu-id="8154b-152">Describes features and functionality of application roles.</span></span>  
  
 [<span data-ttu-id="8154b-153">在 SQL Server 中啟用跨資料庫存取</span><span class="sxs-lookup"><span data-stu-id="8154b-153">Enabling Cross-Database Access in SQL Server</span></span>](../../../../../docs/framework/data/adonet/sql/enabling-cross-database-access-in-sql-server.md)  
 <span data-ttu-id="8154b-154">說明如何在不危及安全性的前提下啟用跨資料庫存取。</span><span class="sxs-lookup"><span data-stu-id="8154b-154">Describes how to enable cross-database access without jeopardizing security.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8154b-155">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8154b-155">See Also</span></span>  
 [<span data-ttu-id="8154b-156">SQL Server 安全性</span><span class="sxs-lookup"><span data-stu-id="8154b-156">SQL Server Security</span></span>](../../../../../docs/framework/data/adonet/sql/sql-server-security.md)  
 [<span data-ttu-id="8154b-157">SQL Server 安全性概觀</span><span class="sxs-lookup"><span data-stu-id="8154b-157">Overview of SQL Server Security</span></span>](../../../../../docs/framework/data/adonet/sql/overview-of-sql-server-security.md)  
 [<span data-ttu-id="8154b-158">設定 ADO.NET 應用程式的安全性</span><span class="sxs-lookup"><span data-stu-id="8154b-158">Securing ADO.NET Applications</span></span>](../../../../../docs/framework/data/adonet/securing-ado-net-applications.md)  
 [<span data-ttu-id="8154b-159">ADO.NET Managed 提供者和 DataSet 開發人員中心</span><span class="sxs-lookup"><span data-stu-id="8154b-159">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
