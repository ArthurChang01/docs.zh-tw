---
title: 日期及時間函式
ms.date: 03/30/2017
ms.assetid: 971762d0-663b-4b64-8c61-352a8e6d3949
ms.openlocfilehash: dbde1a2d19e9cf1559129adf8fe3dcc4fadddf0a
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/03/2018
---
# <a name="date-and-time-functions"></a><span data-ttu-id="ae26b-102">日期及時間函式</span><span class="sxs-lookup"><span data-stu-id="ae26b-102">Date and Time Functions</span></span>
<span data-ttu-id="ae26b-103">.NET Framework Data Provider for SQL Server (SqlClient) 提供了日期和時間函式，這些函式會在 `System.DateTime` 輸入值上執行作業，並傳回 `string`、數值或 `System.DateTime` 值結果。</span><span class="sxs-lookup"><span data-stu-id="ae26b-103">The .NET Framework Data Provider for SQL Server (SqlClient) provides date and time functions that perform operations on a `System.DateTime` input value and return a `string`, numeric, or `System.DateTime` value result.</span></span> <span data-ttu-id="ae26b-104">這些函式位於您使用 SqlClient 時可以使用的 SqlServer 命名空間 (Namespace) 內。</span><span class="sxs-lookup"><span data-stu-id="ae26b-104">These functions are in the SqlServer namespace, which is available when you use SqlClient.</span></span> <span data-ttu-id="ae26b-105">提供者命名空間屬性可以讓 Entity Framework 了解此提供者對特定建構 (例如型別和函式) 所使用的前置詞。下表將顯示 SqlClient 日期和時間函式。</span><span class="sxs-lookup"><span data-stu-id="ae26b-105">A provider's namespace property allows the Entity Framework to discover which prefix is used by this provider for specific constructs, such as types and functions.The following table shows the SqlClient date and time functions.</span></span>  
  
|<span data-ttu-id="ae26b-106">函式</span><span class="sxs-lookup"><span data-stu-id="ae26b-106">Function</span></span>|<span data-ttu-id="ae26b-107">描述</span><span class="sxs-lookup"><span data-stu-id="ae26b-107">Description</span></span>|  
|--------------|-----------------|  
|<span data-ttu-id="ae26b-108">`DATEADD(` `datepart`, `number`, `date``)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-108">`DATEADD(` `datepart`, `number`, `date``)`</span></span>|<span data-ttu-id="ae26b-109">傳回新的 `DateTime` 值，這個值是以加入間隔至指定的日期為根據。</span><span class="sxs-lookup"><span data-stu-id="ae26b-109">Returns a new `DateTime` value that is based on adding an interval to the specified date.</span></span><br /><br /> <span data-ttu-id="ae26b-110">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-110">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-111">`datepart`：代表要傳回新值之日期部分的 `String`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-111">`datepart`: A `String` that represents the part of the date on which to return a new value.</span></span><br /><br /> <span data-ttu-id="ae26b-112">`number`：用來遞增 `Int32` 的 `Int64`、`Decimal`、`Double` 或 `datepart` 值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-112">`number`: The `Int32`, `Int64`, `Decimal`, or `Double` value used to increment `datepart`.</span></span><br /><br /> <span data-ttu-id="ae26b-113">`date:` 傳回的運算式`DateTime`，或`DateTimeOffset`，或`Time`精確度 = [0-7]，或日期格式之字元字串。</span><span class="sxs-lookup"><span data-stu-id="ae26b-113">`date:` An expression that returns a `DateTime`, or `DateTimeOffset`, or `Time` with precision = [0-7], or a character string in a date format.</span></span><br /><br /> <span data-ttu-id="ae26b-114">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-114">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-115">新的 `DateTime`、`DateTimeOffset` 或 `Time` 值 (精確度 = [0-7])。</span><span class="sxs-lookup"><span data-stu-id="ae26b-115">A new `DateTime`, or `DateTimeOffset`, or `Time` value with precision = [0-7].</span></span><br /><br /> <span data-ttu-id="ae26b-116">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-116">**Example**</span></span><br /><br /> `SqlServer.DATEADD('day', 22, cast('6/9/2006' as DateTime))`|  
|<span data-ttu-id="ae26b-117">`DATEDIFF(` `datepart`, `startdate`, `enddate``)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-117">`DATEDIFF(` `datepart`, `startdate`, `enddate``)`</span></span>|<span data-ttu-id="ae26b-118">傳回跨越兩個指定之日期的日期和時間界線數目。</span><span class="sxs-lookup"><span data-stu-id="ae26b-118">Returns the number of date and time boundaries crossed between two specified dates.</span></span><br /><br /> <span data-ttu-id="ae26b-119">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-119">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-120">`datepart`：代表要計算差異之日期部分的 `String`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-120">`datepart`: A `String` that represents the part of the date to calculate the difference.</span></span><br /><br /> <span data-ttu-id="ae26b-121">`startdate`：計算的開始日期是傳回 `DateTime`、`DateTimeOffset`、`Time` 值 (精確度 = [0-7]) 或日期格式之字元字串的運算式。</span><span class="sxs-lookup"><span data-stu-id="ae26b-121">`startdate`: A starting date for the calculation is an expression that returns a `DateTime`, or `DateTimeOffset`, or `Time` value with precision = [0-7], or a character string in a date format.</span></span><br /><br /> <span data-ttu-id="ae26b-122">`enddate:` 計算結束日期是傳回的運算式`DateTime`，或`DateTimeOffset`，或`Time`值與精確度 = [0-7]，或日期格式之字元字串。</span><span class="sxs-lookup"><span data-stu-id="ae26b-122">`enddate:` An ending date for the calculation is an expression that returns a `DateTime`, or `DateTimeOffset`, or `Time` value with precision = [0-7], or a character string in a date format.</span></span><br /><br /> <span data-ttu-id="ae26b-123">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-123">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-124">`Int32`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-124">An `Int32`.</span></span><br /><br /> <span data-ttu-id="ae26b-125">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-125">**Example**</span></span><br /><br /> `SqlServer.DATEDIFF('day', cast('6/9/2006' as DateTime),`<br /><br /> `cast('6/20/2006' as DateTime))`|  
|<span data-ttu-id="ae26b-126">`DATENAME(` `datepart`, `date``)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-126">`DATENAME(` `datepart`, `date``)`</span></span>|<span data-ttu-id="ae26b-127">傳回一個字元字串，代表指定日期的指定日期部分。</span><span class="sxs-lookup"><span data-stu-id="ae26b-127">Returns a character string representing the specified datepart of the specified date.</span></span><br /><br /> <span data-ttu-id="ae26b-128">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-128">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-129">`datepart`：代表要傳回新值之日期部分的 `String`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-129">`datepart`: A `String` that represents the part of the date on which to return a new value.</span></span><br /><br /> <span data-ttu-id="ae26b-130">`date`：這是傳回 `DateTime,`、`DateTimeOffset`、`Time` 值 (精確度 = [0-7]) 或日期格式之字元字串的運算式。</span><span class="sxs-lookup"><span data-stu-id="ae26b-130">`date`: An expression that returns a `DateTime,` or `DateTimeOffset`, or `Time` value with precision = [0-7], or a character string in a date format.</span></span><br /><br /> <span data-ttu-id="ae26b-131">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-131">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-132">代表指定日期之指定日期部分的字元字串。</span><span class="sxs-lookup"><span data-stu-id="ae26b-132">The character string representing the specified datepart of the specified date.</span></span><br /><br /> <span data-ttu-id="ae26b-133">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-133">**Example**</span></span><br /><br /> `SqlServer.DATENAME('year', cast('6/9/2006' as DateTime))`|  
|<span data-ttu-id="ae26b-134">`DATEPART(` `datepart`, `date``)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-134">`DATEPART(` `datepart`, `date``)`</span></span>|<span data-ttu-id="ae26b-135">傳回一個整數來代表指定之日期的指定日期部分。</span><span class="sxs-lookup"><span data-stu-id="ae26b-135">Returns an integer that represents the specified datepart of the specified date.</span></span><br /><br /> <span data-ttu-id="ae26b-136">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-136">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-137">`datepart`：代表要傳回新值之日期部分的 `String`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-137">`datepart`: A `String` that represents the part of the date on which to return a new value.</span></span><br /><br /> <span data-ttu-id="ae26b-138">`date`：這是傳回 `DateTime,`、`DateTimeOffset,`、`Time` 值 (精確度 = [0-7]) 或日期格式之字元字串的運算式。</span><span class="sxs-lookup"><span data-stu-id="ae26b-138">`date`: An expression that returns a `DateTime,` or `DateTimeOffset,` or `Time` value with precision = [0-7], or a character string in a date format.</span></span><br /><br /> <span data-ttu-id="ae26b-139">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-139">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-140">指定日期的指定日期部分，當做 `Int32`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-140">The specified datepart of the specified date, as an `Int32`.</span></span><br /><br /> <span data-ttu-id="ae26b-141">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-141">**Example**</span></span><br /><br /> `SqlServer.DATEPART('year', cast('6/9/2006' as DateTime))`|  
|<span data-ttu-id="ae26b-142">`DAY(` `date` `)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-142">`DAY(` `date` `)`</span></span>|<span data-ttu-id="ae26b-143">以整數形式傳回指定之日期的日。</span><span class="sxs-lookup"><span data-stu-id="ae26b-143">Rreturns the day of the specified date as an integer.</span></span><br /><br /> <span data-ttu-id="ae26b-144">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-144">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-145">`date`： 類型的運算式`DateTime`或`DateTimeOffset`精確度 = 0-7。</span><span class="sxs-lookup"><span data-stu-id="ae26b-145">`date`:An expression of type `DateTime` or `DateTimeOffset` with precision = 0-7.</span></span><br /><br /> <span data-ttu-id="ae26b-146">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-146">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-147">指定之日期的日，當做 `Int32`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-147">The day of the specified date as an `Int32`.</span></span><br /><br /> <span data-ttu-id="ae26b-148">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-148">**Example**</span></span><br /><br /> `SqlServer.DAY(cast('6/9/2006' as DateTime))`|  
|`GETDATE()`|<span data-ttu-id="ae26b-149">採用 SQL Server 的內部格式，為日期時間值產生目前的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="ae26b-149">Produces the current date and time in SQL Server internal format for datetime values.</span></span><br /><br /> <span data-ttu-id="ae26b-150">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-150">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-151">當成 `DateTime` 的目前系統日期和時間，精確度為 3。</span><span class="sxs-lookup"><span data-stu-id="ae26b-151">The current system date and time as a `DateTime` with a precision of 3.</span></span><br /><br /> <span data-ttu-id="ae26b-152">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-152">**Example**</span></span><br /><br /> `SqlServer.GETDATE()`|  
|`GETUTCDATE()`|<span data-ttu-id="ae26b-153">以 UTC (國際標準時間或格林威治標準時間) 格式產生日期時間值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-153">Produces the datetime value in UTC (Coordinated Universal Time or Greenwich Mean Time) format.</span></span><br /><br /> <span data-ttu-id="ae26b-154">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-154">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-155">採用 UTC 格式且精確度為 3 的 `DateTime` 值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-155">The `DateTime` value with a precision of 3 in UTC format.</span></span><br /><br /> <span data-ttu-id="ae26b-156">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-156">**Example**</span></span><br /><br /> `SqlServer.GETUTCDATE()`|  
|<span data-ttu-id="ae26b-157">`MONTH(` `date` `)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-157">`MONTH(` `date` `)`</span></span>|<span data-ttu-id="ae26b-158">以整數形式傳回指定日期的月份。</span><span class="sxs-lookup"><span data-stu-id="ae26b-158">Returns the month of the specified date as an integer.</span></span><br /><br /> <span data-ttu-id="ae26b-159">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-159">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-160">`date`： 類型的運算式`DateTime`或`DateTimeOffset`精確度 = 0-7。</span><span class="sxs-lookup"><span data-stu-id="ae26b-160">`date`:An expression of type `DateTime` or `DateTimeOffset` with precision = 0-7.</span></span><br /><br /> <span data-ttu-id="ae26b-161">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-161">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-162">指定之日期的月份，當做 `Int32`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-162">The month of the specified date as an `Int32`.</span></span><br /><br /> <span data-ttu-id="ae26b-163">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-163">**Example**</span></span><br /><br /> `SqlServer.MONTH(cast('6/9/2006' as DateTime))`|  
|<span data-ttu-id="ae26b-164">`YEAR(` `date` `)`</span><span class="sxs-lookup"><span data-stu-id="ae26b-164">`YEAR(` `date` `)`</span></span>|<span data-ttu-id="ae26b-165">以整數形式傳回指定日期的年份。</span><span class="sxs-lookup"><span data-stu-id="ae26b-165">Returns the year of the specified date as an integer.</span></span><br /><br /> <span data-ttu-id="ae26b-166">**引數**</span><span class="sxs-lookup"><span data-stu-id="ae26b-166">**Arguments**</span></span><br /><br /> <span data-ttu-id="ae26b-167">`date`： 類型的運算式`DateTime`或`DateTimeOffset`精確度 = 0-7。</span><span class="sxs-lookup"><span data-stu-id="ae26b-167">`date`:An expression of type `DateTime` or `DateTimeOffset` with precision = 0-7.</span></span><br /><br /> <span data-ttu-id="ae26b-168">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-168">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-169">指定之日期的年份，當做 `Int32`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-169">The year of the specified date as an `Int32`.</span></span><br /><br /> <span data-ttu-id="ae26b-170">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-170">**Example**</span></span><br /><br /> `SqlServer.YEAR(cast('6/9/2006' as DateTime))`|  
|`SYSDATETIME()`|<span data-ttu-id="ae26b-171">傳回精確度為 7 的 `DateTime` 值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-171">Returns a `DateTime` value with a precision of 7.</span></span><br /><br /> <span data-ttu-id="ae26b-172">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-172">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-173">精確度為 7 的 `DateTime` 值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-173">A `DateTime` value with a precision of 7.</span></span><br /><br /> <span data-ttu-id="ae26b-174">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-174">**Example**</span></span><br /><br /> `SqlServer.SYSDATETIME()`|  
|`SYSUTCDATE()`|<span data-ttu-id="ae26b-175">以 UTC (國際標準時間或格林威治標準時間) 格式產生日期時間值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-175">Produces the datetime value in UTC (Coordinated Universal Time or Greenwich Mean Time) format.</span></span><br /><br /> <span data-ttu-id="ae26b-176">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-176">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-177">採用 UTC 格式且精確度 = 7 的 `DateTime` 值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-177">The `DateTime` value with precision = 7 in UTC format.</span></span><br /><br /> <span data-ttu-id="ae26b-178">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-178">**Example**</span></span><br /><br /> `SqlServer.SYSUTCDATE()`|  
|`SYSDATETIMEOFFSET()`|<span data-ttu-id="ae26b-179">傳回精確度為 7 的 `DateTimeOffset`。</span><span class="sxs-lookup"><span data-stu-id="ae26b-179">Returns a `DateTimeOffset` with a precision of 7.</span></span><br /><br /> <span data-ttu-id="ae26b-180">**傳回值**</span><span class="sxs-lookup"><span data-stu-id="ae26b-180">**Return Value**</span></span><br /><br /> <span data-ttu-id="ae26b-181">採用 UTC 格式且精確度為 7 的 `DateTimeOffset` 值。</span><span class="sxs-lookup"><span data-stu-id="ae26b-181">A `DateTimeOffset` value with precision of 7 in UTC format.</span></span><br /><br /> <span data-ttu-id="ae26b-182">**範例**</span><span class="sxs-lookup"><span data-stu-id="ae26b-182">**Example**</span></span><br /><br /> `SqlServer.SYSDATETIMEOFFSET()`|  
  
 <span data-ttu-id="ae26b-183">如需 SqlClient 所支援日期和時間函式的詳細資訊，請參閱 SqlClient 提供者資訊清單中所指定 SQL Server 版本的說明文件：</span><span class="sxs-lookup"><span data-stu-id="ae26b-183">For more information about the date and time functions that SqlClient supports, see the documentation for the SQL Server version that you specified in the SqlClient provider manifest:</span></span>  
  
|<span data-ttu-id="ae26b-184">SQL Server 2000</span><span class="sxs-lookup"><span data-stu-id="ae26b-184">SQL Server 2000</span></span>|<span data-ttu-id="ae26b-185">SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="ae26b-185">SQL Server 2005</span></span>|<span data-ttu-id="ae26b-186">SQL Server 2008</span><span class="sxs-lookup"><span data-stu-id="ae26b-186">SQL Server 2008</span></span>|  
|---------------------|---------------------|---------------------|  
|[<span data-ttu-id="ae26b-187">日期和時間函數 (TRANSACT-SQL)</span><span class="sxs-lookup"><span data-stu-id="ae26b-187">Date and Time Functions (Transact-SQL)</span></span>](http://go.microsoft.com/fwlink/?LinkId=115908)|[<span data-ttu-id="ae26b-188">日期和時間函數 (TRANSACT-SQL)</span><span class="sxs-lookup"><span data-stu-id="ae26b-188">Date and Time Functions (Transact-SQL)</span></span>](http://go.microsoft.com/fwlink/?LinkId=115909)|[<span data-ttu-id="ae26b-189">日期和時間函數 (TRANSACT-SQL)</span><span class="sxs-lookup"><span data-stu-id="ae26b-189">Date and Time Functions (Transact-SQL)</span></span>](http://go.microsoft.com/fwlink/?LinkId=98360)|  
  
## <a name="see-also"></a><span data-ttu-id="ae26b-190">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ae26b-190">See Also</span></span>  
 [<span data-ttu-id="ae26b-191">適用於 Entity Framework 的 SqlClient 函式</span><span class="sxs-lookup"><span data-stu-id="ae26b-191">SqlClient for Entity Framework Functions</span></span>](../../../../../docs/framework/data/adonet/ef/sqlclient-for-ef-functions.md)
