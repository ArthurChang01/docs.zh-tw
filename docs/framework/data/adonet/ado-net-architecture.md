---
title: ADO.NET 架構
ms.date: 03/30/2017
ms.assetid: fcd45b99-ae8f-45ab-8b97-d887beda734e
ms.openlocfilehash: 2e91077287c051d871eb61f83ec77b7baf90b2d8
ms.sourcegitcommit: c7a7e1468bf0fa7f7065de951d60dfc8d5ba89f5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/14/2019
ms.locfileid: "65584571"
---
# <a name="adonet-architecture"></a><span data-ttu-id="cc93c-102">ADO.NET 架構</span><span class="sxs-lookup"><span data-stu-id="cc93c-102">ADO.NET Architecture</span></span>
<span data-ttu-id="cc93c-103">傳統的資料處理主要是依賴相互連接的雙層式模型。</span><span class="sxs-lookup"><span data-stu-id="cc93c-103">Data processing has traditionally relied primarily on a connection-based, two-tier model.</span></span> <span data-ttu-id="cc93c-104">隨著資料處理朝多層式架構發展，程式設計人員也逐漸改用中斷連接的方式，使應用程式更具延展性 (Scalability)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-104">As data processing increasingly uses multi-tier architectures, programmers are switching to a disconnected approach to provide better scalability for their applications.</span></span>  
  
## <a name="adonet-components"></a><span data-ttu-id="cc93c-105">ADO.NET 元件</span><span class="sxs-lookup"><span data-stu-id="cc93c-105">ADO.NET Components</span></span>  
 <span data-ttu-id="cc93c-106">兩個主要元件[!INCLUDE[ado_orcas_long](../../../../includes/ado-orcas-long-md.md)]存取和管理資料的.NET Framework 資料提供者和<xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="cc93c-106">The two main components of [!INCLUDE[ado_orcas_long](../../../../includes/ado-orcas-long-md.md)] for accessing and manipulating data are the .NET Framework data providers and the <xref:System.Data.DataSet>.</span></span>  
  
### <a name="net-framework-data-providers"></a><span data-ttu-id="cc93c-107">.NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="cc93c-107">.NET Framework Data Providers</span></span>  
 <span data-ttu-id="cc93c-108">.NET Framework 資料提供者是一種明確設計用於管理資料以及快速存取順向唯讀資料的元件。</span><span class="sxs-lookup"><span data-stu-id="cc93c-108">The .NET Framework Data Providers are components that have been explicitly designed for data manipulation and fast, forward-only, read-only access to data.</span></span> <span data-ttu-id="cc93c-109">`Connection` 物件會提供資料來源的連接。</span><span class="sxs-lookup"><span data-stu-id="cc93c-109">The `Connection` object provides connectivity to a data source.</span></span> <span data-ttu-id="cc93c-110">`Command` 物件可讓您存取資料庫命令，以便傳回資料、修改資料、執行預存程序 (Stored Procedure)，並且傳送或擷取參數資訊。</span><span class="sxs-lookup"><span data-stu-id="cc93c-110">The `Command` object enables access to database commands to return data, modify data, run stored procedures, and send or retrieve parameter information.</span></span> <span data-ttu-id="cc93c-111">`DataReader` 則可提供來自資料來源的高效能資料流。</span><span class="sxs-lookup"><span data-stu-id="cc93c-111">The `DataReader` provides a high-performance stream of data from the data source.</span></span> <span data-ttu-id="cc93c-112">最後，`DataAdapter` 會提供 `DataSet` 物件與資料來源之間的橋接器 (Bridge)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-112">Finally, the `DataAdapter` provides the bridge between the `DataSet` object and the data source.</span></span> <span data-ttu-id="cc93c-113">`DataAdapter` 會使用 `Command` 物件於資料來源處執行 SQL 命令，以便將資料載入 `DataSet`，並且將 `DataSet` 內的資料變更調節回資料來源。</span><span class="sxs-lookup"><span data-stu-id="cc93c-113">The `DataAdapter` uses `Command` objects to execute SQL commands at the data source to both load the `DataSet` with data and reconcile changes that were made to the data in the `DataSet` back to the data source.</span></span> <span data-ttu-id="cc93c-114">如需詳細資訊，請參閱 < [.NET Framework 資料提供者](../../../../docs/framework/data/adonet/data-providers.md)並[擷取和修改 ADO.NET 中的資料](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-114">For more information, see [.NET Framework Data Providers](../../../../docs/framework/data/adonet/data-providers.md) and [Retrieving and Modifying Data in ADO.NET](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md).</span></span>  
  
### <a name="the-dataset"></a><span data-ttu-id="cc93c-115">DataSet</span><span class="sxs-lookup"><span data-stu-id="cc93c-115">The DataSet</span></span>  
 <span data-ttu-id="cc93c-116">ADO.NET `DataSet` 的設計已明確指出它可獨立於任何資料來源外而存取資料。</span><span class="sxs-lookup"><span data-stu-id="cc93c-116">The ADO.NET `DataSet` is explicitly designed for data access independent of any data source.</span></span> <span data-ttu-id="cc93c-117">因此，它可與多個不同的資料來源搭配使用、與 XML 資料搭配使用，或用來管理應用程式的本機資料。</span><span class="sxs-lookup"><span data-stu-id="cc93c-117">As a result, it can be used with multiple and differing data sources, used with XML data, or used to manage data local to the application.</span></span> <span data-ttu-id="cc93c-118">`DataSet` 包含一或多個由資料列和資料行所組成的 <xref:System.Data.DataTable> 物件集合，以及 `DataTable` 物件中的主索引鍵、外部索引鍵、條件約束 (Constraint) 及資料的關聯資訊。</span><span class="sxs-lookup"><span data-stu-id="cc93c-118">The `DataSet` contains a collection of one or more <xref:System.Data.DataTable> objects consisting of rows and columns of data, and also primary key, foreign key, constraint, and relation information about the data in the `DataTable` objects.</span></span> <span data-ttu-id="cc93c-119">如需詳細資訊，請參閱 < [Dataset、 Datatable 和 Dataview](../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-119">For more information, see [DataSets, DataTables, and DataViews](../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md).</span></span>  
  
 <span data-ttu-id="cc93c-120">下圖說明.NET Framework 資料提供者之間的關聯性和`DataSet`。</span><span class="sxs-lookup"><span data-stu-id="cc93c-120">The following diagram illustrates the relationship between a .NET Framework data provider and a `DataSet`.</span></span>  
  
 <span data-ttu-id="cc93c-121">![ADO.Net 圖形](../../../../docs/framework/data/adonet/media/ado-1-bpuedev11.png "ado_1_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="cc93c-121">![ADO.Net graphic](../../../../docs/framework/data/adonet/media/ado-1-bpuedev11.png "ado_1_bpuedev11")</span></span>  
<span data-ttu-id="cc93c-122">ADO.NET 架構</span><span class="sxs-lookup"><span data-stu-id="cc93c-122">ADO.NET architecture</span></span>  
  
### <a name="choosing-a-datareader-or-a-dataset"></a><span data-ttu-id="cc93c-123">選擇 DataReader 或 DataSet</span><span class="sxs-lookup"><span data-stu-id="cc93c-123">Choosing a DataReader or a DataSet</span></span>  
 <span data-ttu-id="cc93c-124">當您決定是否應該使用您的應用程式`DataReader`(請參閱[擷取的資料使用 DataReader](../../../../docs/framework/data/adonet/retrieving-data-using-a-datareader.md)) 或`DataSet`(請參閱[Dataset、 Datatable 和 Dataview](../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md))，請考慮的型別應用程式所需的功能。</span><span class="sxs-lookup"><span data-stu-id="cc93c-124">When you decide whether your application should use a `DataReader` (see [Retrieving Data Using a DataReader](../../../../docs/framework/data/adonet/retrieving-data-using-a-datareader.md)) or a `DataSet` (see [DataSets, DataTables, and DataViews](../../../../docs/framework/data/adonet/dataset-datatable-dataview/index.md)), consider the type of functionality that your application requires.</span></span> <span data-ttu-id="cc93c-125">請使用 `DataSet` 來進行下列作業：</span><span class="sxs-lookup"><span data-stu-id="cc93c-125">Use a `DataSet` to do the following:</span></span>  
  
- <span data-ttu-id="cc93c-126">請快取應用程式本機的資料，如此您才能夠管理它。</span><span class="sxs-lookup"><span data-stu-id="cc93c-126">Cache data locally in your application so that you can manipulate it.</span></span> <span data-ttu-id="cc93c-127">若您只需要讀取查詢結果，`DataReader` 將是比較理想的選擇。</span><span class="sxs-lookup"><span data-stu-id="cc93c-127">If you only need to read the results of a query, the `DataReader` is the better choice.</span></span>  
  
- <span data-ttu-id="cc93c-128">在各層間或從 XML Web Service 遠端處理資料。</span><span class="sxs-lookup"><span data-stu-id="cc93c-128">Remote data between tiers or from an XML Web service.</span></span>  
  
- <span data-ttu-id="cc93c-129">與資料動態互動 (例如繫結 Windows Form 控制項)，或是將來自多個來源的資料合併和關聯。</span><span class="sxs-lookup"><span data-stu-id="cc93c-129">Interact with data dynamically such as binding to a Windows Forms control or combining and relating data from multiple sources.</span></span>  
  
- <span data-ttu-id="cc93c-130">針對資料進行廣泛處理，並不需要與資料來源間有開放連接，如此便可將連接釋放給其他用戶端使用。</span><span class="sxs-lookup"><span data-stu-id="cc93c-130">Perform extensive processing on data without requiring an open connection to the data source, which frees the connection to be used by other clients.</span></span>  
  
 <span data-ttu-id="cc93c-131">如果您不需要 `DataSet` 所提供的功能，則可採用 `DataReader` 以順向、唯讀的方式來傳回資料，藉以提升應用程式的效能。</span><span class="sxs-lookup"><span data-stu-id="cc93c-131">If you do not require the functionality provided by the `DataSet`, you can improve the performance of your application by using the `DataReader` to return your data in a forward-only, read-only manner.</span></span> <span data-ttu-id="cc93c-132">雖然`DataAdapter`會使用`DataReader`來填滿的內容`DataSet`(請參閱[從 DataAdapter 填入 DataSet](../../../../docs/framework/data/adonet/populating-a-dataset-from-a-dataadapter.md))，使用`DataReader`，可以提升效能，因為您將節省記憶體會由`DataSet`，並避免所需建立和填入的內容處理`DataSet`。</span><span class="sxs-lookup"><span data-stu-id="cc93c-132">Although the `DataAdapter` uses the `DataReader` to fill the contents of a `DataSet` (see [Populating a DataSet from a DataAdapter](../../../../docs/framework/data/adonet/populating-a-dataset-from-a-dataadapter.md)), by using the `DataReader`, you can boost performance because you will save memory that would be consumed by the `DataSet`, and avoid the processing that is required to create and fill the contents of the `DataSet`.</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="cc93c-133">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="cc93c-133">LINQ to DataSet</span></span>  
 <span data-ttu-id="cc93c-134">LINQ to DataSet 會針對在 DataSet 物件中快取的資料提供查詢功能和編譯時間型別檢查。</span><span class="sxs-lookup"><span data-stu-id="cc93c-134">LINQ to DataSet provides query capabilities and compile-time type checking over data cached in a DataSet object.</span></span> <span data-ttu-id="cc93c-135">它可讓您使用其中一種 .NET Framework 開發語言 (例如 C# 或 Visual Basic) 來撰寫查詢。</span><span class="sxs-lookup"><span data-stu-id="cc93c-135">It allows you to write queries in one of the .NET Framework development language, such as C# or Visual Basic.</span></span> <span data-ttu-id="cc93c-136">如需詳細資訊，請參閱 [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-136">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="cc93c-137">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="cc93c-137">LINQ to SQL</span></span>  
 <span data-ttu-id="cc93c-138">LINQ to SQL 可針對對應到關聯式資料庫資料結構的物件模型進行查詢，而不必使用中繼的概念模型。</span><span class="sxs-lookup"><span data-stu-id="cc93c-138">LINQ to SQL supports queries against an object model that is mapped to the data structures of a relational database without using an intermediate conceptual model.</span></span> <span data-ttu-id="cc93c-139">每個資料表都是由個別的類別表示，將物件模型與關聯式資料庫結構描述緊密結合。</span><span class="sxs-lookup"><span data-stu-id="cc93c-139">Each table is represented by a separate class, tightly coupling the object model to the relational database schema.</span></span> <span data-ttu-id="cc93c-140">LINQ to SQL 會將物件模型中的 Language-Integrated Query 轉譯成 Transact-SQL，然後將其傳送至資料庫進行執行。</span><span class="sxs-lookup"><span data-stu-id="cc93c-140">LINQ to SQL translates language-integrated queries in the object model into Transact-SQL and sends them to the database for execution.</span></span> <span data-ttu-id="cc93c-141">當資料庫傳回結果時，LINQ to SQL 會將結果轉譯回物件。</span><span class="sxs-lookup"><span data-stu-id="cc93c-141">When the database returns the results, LINQ to SQL translates the results back into objects.</span></span> <span data-ttu-id="cc93c-142">如需詳細資訊，請參閱 [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-142">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="adonet-entity-framework"></a><span data-ttu-id="cc93c-143">ADO.NET Entity Framework</span><span class="sxs-lookup"><span data-stu-id="cc93c-143">ADO.NET Entity Framework</span></span>  
 <span data-ttu-id="cc93c-144">ADO.NET Entity Framework 的設計目標是要讓開發人員針對概念應用程式模型進行程式設計來建立資料存取應用程式，而不用直接對關聯式儲存結構描述進行程式設計。</span><span class="sxs-lookup"><span data-stu-id="cc93c-144">The ADO.NET Entity Framework is designed to enable developers to create data access applications by programming against a conceptual application model instead of programming directly against a relational storage schema.</span></span> <span data-ttu-id="cc93c-145">其目的是要減少資料導向應用程式所需程式碼和維護的工作量。</span><span class="sxs-lookup"><span data-stu-id="cc93c-145">The goal is to decrease the amount of code and maintenance required for data-oriented applications.</span></span> <span data-ttu-id="cc93c-146">如需詳細資訊，請參閱 < [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-146">For more information, see [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md).</span></span>  
  
## <a name="wcf-data-services"></a><span data-ttu-id="cc93c-147">WCF 資料服務</span><span class="sxs-lookup"><span data-stu-id="cc93c-147">WCF Data Services</span></span>  
 [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)] <span data-ttu-id="cc93c-148">是用於在 Web 或內部網路上部署資料服務。</span><span class="sxs-lookup"><span data-stu-id="cc93c-148">is used to deploy data services on the Web or an intranet.</span></span> <span data-ttu-id="cc93c-149">系統會根據實體資料模型的規格，讓資料結構化成實體與關聯性。</span><span class="sxs-lookup"><span data-stu-id="cc93c-149">The data is structured as entities and relationships according to the specifications of the Entity Data Model.</span></span> <span data-ttu-id="cc93c-150">部署在這個模型上的資料可由標準 HTTP 通訊協定定址。</span><span class="sxs-lookup"><span data-stu-id="cc93c-150">Data deployed on this model is addressable by standard HTTP protocol.</span></span> <span data-ttu-id="cc93c-151">如需詳細資訊，請參閱 [WCF Data Services 4.5](../../../../docs/framework/data/wcf/index.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-151">For more information, see [WCF Data Services 4.5](../../../../docs/framework/data/wcf/index.md).</span></span>  
  
## <a name="xml-and-adonet"></a><span data-ttu-id="cc93c-152">XML 和 ADO.NET</span><span class="sxs-lookup"><span data-stu-id="cc93c-152">XML and ADO.NET</span></span>  
 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <span data-ttu-id="cc93c-153">會利用 XML 的功能，以中斷連接的方式存取資料。</span><span class="sxs-lookup"><span data-stu-id="cc93c-153">leverages the power of XML to provide disconnected access to data.</span></span> [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <span data-ttu-id="cc93c-154">已設計的手盈餘和 XML 類別在.NET Framework 中;兩者都是單一架構的元件。</span><span class="sxs-lookup"><span data-stu-id="cc93c-154">was designed hand-in-hand with the XML classes in the .NET Framework; both are components of a single architecture.</span></span>  
  
 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] <span data-ttu-id="cc93c-155">和.NET Framework 中的 XML 類別交集在於`DataSet`物件。</span><span class="sxs-lookup"><span data-stu-id="cc93c-155">and the XML classes in the .NET Framework converge in the `DataSet` object.</span></span> <span data-ttu-id="cc93c-156">`DataSet` 可以填入 XML 來源的資料，無論它是檔案或 XML 資料流都一樣。</span><span class="sxs-lookup"><span data-stu-id="cc93c-156">The `DataSet` can be populated with data from an XML source, whether it is a file or an XML stream.</span></span> <span data-ttu-id="cc93c-157">不管 `DataSet` 的資料來源為何，`DataSet` 都可組合成與全球資訊網協會 (W3C) 相容的 XML，而且包含其結構描述當做 XML 結構描述定義語言 (XSD) 結構描述。</span><span class="sxs-lookup"><span data-stu-id="cc93c-157">The `DataSet` can be written as World-Wide Web Consortium (W3C) compliant XML that includes its schema as XML schema definition language (XSD) schema, regardless of the source of the data in the `DataSet`.</span></span> <span data-ttu-id="cc93c-158">由於 `DataSet` 的原生序列化格式是 XML，所以相當適合當做在各層之間移動資料的媒體，如此當需要在遠端對 XML Web Service 來回傳送資料和結構描述內容時，`DataSet` 將會是最佳選擇。</span><span class="sxs-lookup"><span data-stu-id="cc93c-158">Because of the native serialization format of the `DataSet` is XML, it is an excellent medium for moving data between tiers, making the `DataSet` an optimal choice for remoting data and schema context to and from an XML Web service.</span></span> <span data-ttu-id="cc93c-159">如需詳細資訊，請參閱 [XML 文件和資料](../../../../docs/standard/data/xml/index.md)。</span><span class="sxs-lookup"><span data-stu-id="cc93c-159">For more information, see [XML Documents and Data](../../../../docs/standard/data/xml/index.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cc93c-160">另請參閱</span><span class="sxs-lookup"><span data-stu-id="cc93c-160">See also</span></span>

- [<span data-ttu-id="cc93c-161">ADO.NET 概觀</span><span class="sxs-lookup"><span data-stu-id="cc93c-161">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)
- [<span data-ttu-id="cc93c-162">ADO.NET Managed 提供者和 DataSet 開發人員中心</span><span class="sxs-lookup"><span data-stu-id="cc93c-162">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
