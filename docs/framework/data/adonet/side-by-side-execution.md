---
title: ADO.NET 中的並存執行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: 0ada258f74338fc7cbc9435fdea8fc896bd2efd6
ms.sourcegitcommit: d2e1dfa7ef2d4e9ffae3d431cf6a4ffd9c8d378f
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/07/2019
ms.locfileid: "70782706"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="b12e3-102">ADO.NET 中的並存執行</span><span class="sxs-lookup"><span data-stu-id="b12e3-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="b12e3-103">.NET Framework 中的並存執行是在已安裝多個版本之 .NET Framework 的電腦上執行應用程式的能力，以獨佔方式使用已編譯應用程式的版本。</span><span class="sxs-lookup"><span data-stu-id="b12e3-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="b12e3-104">如需設定並存執行的詳細資訊，請參閱[並存執行](../../deployment/side-by-side-execution.md)。</span><span class="sxs-lookup"><span data-stu-id="b12e3-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="b12e3-105">使用其中一個版本的 .NET Framework 所編譯的應用程式，可以在不同版本的 .NET Framework 上執行。</span><span class="sxs-lookup"><span data-stu-id="b12e3-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="b12e3-106">不過，我們建議您針對每個已安裝的 .NET Framework 版本編譯應用程式的版本，並分別執行它們。</span><span class="sxs-lookup"><span data-stu-id="b12e3-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="b12e3-107">在任一情況下，您都應該留意可能會影響應用程式向前相容性或回溯相容性的版本之間的 ADO.NET 變更。</span><span class="sxs-lookup"><span data-stu-id="b12e3-107">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="b12e3-108">向前相容性和回溯相容性</span><span class="sxs-lookup"><span data-stu-id="b12e3-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="b12e3-109">向前相容性表示可以使用舊版的 .NET Framework 來編譯應用程式，但仍可在較新版本的 .NET Framework 上順利執行。</span><span class="sxs-lookup"><span data-stu-id="b12e3-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="b12e3-110">針對 .NET Framework 1.1 版所撰寫的 ADO.NET 程式碼會向前相容于較新的版本。</span><span class="sxs-lookup"><span data-stu-id="b12e3-110">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="b12e3-111">回溯相容性表示會針對較新版本的 .NET Framework 編譯應用程式，但會繼續在舊版的 .NET Framework 上執行，而不會遺失任何功能。</span><span class="sxs-lookup"><span data-stu-id="b12e3-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="b12e3-112">當然，新版本的 .NET Framework 中引進的功能並不是這種情況。</span><span class="sxs-lookup"><span data-stu-id="b12e3-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="b12e3-113">ODBC 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="b12e3-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="b12e3-114">從1.1 版開始，ODBC （<xref:System.Data.Odbc>）的 .NET Framework Data Provider 會包含為 .NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="b12e3-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="b12e3-115">ODBC 資料提供者可從[資料存取和儲存開發人員中心](https://go.microsoft.com/fwlink/?linkid=4173)，.NET Framework 版本1.0 開發人員做為 Web 下載。</span><span class="sxs-lookup"><span data-stu-id="b12e3-115">The ODBC data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="b12e3-116">針對 ODBC 下載的 .NET Framework Data Provider 的命名空間是**Microsoft. Data. odbc**。</span><span class="sxs-lookup"><span data-stu-id="b12e3-116">The namespace for the downloaded .NET Framework Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="b12e3-117">如果您的應用程式是針對使用 ODBC 資料提供者連接到資料來源的 .NET Framework 1.0 版所開發，而您想要在 .NET Framework 版本1.1 或更新版本上執行該應用程式，您必須更新 ODBC dat 的命名空間**system.object**的提供者。</span><span class="sxs-lookup"><span data-stu-id="b12e3-117">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="b12e3-118">接著，您必須針對較新版本的 .NET Framework 重新編譯它。</span><span class="sxs-lookup"><span data-stu-id="b12e3-118">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="b12e3-119">如果您的應用程式是針對使用 ODBC 資料提供者連接至資料來源的 .NET Framework 2.0 版或更新版本所開發，而您想要在 .NET Framework 1.0 版上執行該應用程式，則必須下載 ODBC 資料提供者並加以安裝在 .NET Framework 版本1.0 系統上。</span><span class="sxs-lookup"><span data-stu-id="b12e3-119">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="b12e3-120">接著，您必須將 ODBC 資料提供者的命名空間變更為**Microsoft. data**，然後重新編譯應用程式，以取得 .NET Framework 版本1.0。</span><span class="sxs-lookup"><span data-stu-id="b12e3-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="b12e3-121">Oracle 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="b12e3-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="b12e3-122">從1.1 版開始，Oracle （<xref:System.Data.OracleClient>）的 .NET Framework Data Provider 會納入做為 .NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="b12e3-122">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="b12e3-123">資料提供者可從[資料存取和儲存開發人員中心](https://go.microsoft.com/fwlink/?linkid=4173)，.NET Framework 版本1.0 開發人員做為 Web 下載。</span><span class="sxs-lookup"><span data-stu-id="b12e3-123">The data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="b12e3-124">如果您的應用程式是針對使用資料提供者連接至資料來源的 .NET Framework 2.0 版或更新版本所開發，而您想要在 .NET Framework 1.0 版上執行該應用程式，則必須下載資料提供者，並將它安裝在 NE 上T Framework 版本1.0 系統。</span><span class="sxs-lookup"><span data-stu-id="b12e3-124">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="b12e3-125">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="b12e3-125">Code Access Security</span></span>  
 <span data-ttu-id="b12e3-126">.NET Framework 1.0 版（<xref:System.Data.SqlClient>， <xref:System.Data.OleDb>）中的 .NET Framework 資料提供者必須以 FullTrust 許可權執行。</span><span class="sxs-lookup"><span data-stu-id="b12e3-126">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="b12e3-127">嘗試在許可權低於 FullTrust 的區域中，使用來自 .NET Framework 1.0 版的 .NET Framework k 資料提供者，會導致<xref:System.Security.SecurityException>。</span><span class="sxs-lookup"><span data-stu-id="b12e3-127">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="b12e3-128">不過，從 .NET Framework 版本2.0 開始，所有 .NET Framework 資料提供者都可以在部分信任的區域中使用。</span><span class="sxs-lookup"><span data-stu-id="b12e3-128">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="b12e3-129">此外，新的安全性功能已新增至 .NET Framework 版本1.1 中的 .NET Framework 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="b12e3-129">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="b12e3-130">這個功能可讓您限制能在特定安全性區域中使用的連接字串。</span><span class="sxs-lookup"><span data-stu-id="b12e3-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="b12e3-131">您也可以在特定安全性地區內停用空白密碼。</span><span class="sxs-lookup"><span data-stu-id="b12e3-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="b12e3-132">如需詳細資訊，請參閱 [Code Access Security and ADO.NET](code-access-security.md)。</span><span class="sxs-lookup"><span data-stu-id="b12e3-132">For more information, see [Code Access Security and ADO.NET](code-access-security.md).</span></span>  
  
 <span data-ttu-id="b12e3-133">因為 .NET Framework 的每個安裝都有個別的安全性設定檔，所以安全性設定沒有任何相容性問題。</span><span class="sxs-lookup"><span data-stu-id="b12e3-133">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="b12e3-134">不過，如果您的應用程式相依于 .NET Framework 1.1 版和更新版本中所包含的其他 ADO.NET 安全性功能，您將無法將它散發至1.0 版系統。</span><span class="sxs-lookup"><span data-stu-id="b12e3-134">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="b12e3-135">SqlCommand 之執行</span><span class="sxs-lookup"><span data-stu-id="b12e3-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="b12e3-136">從 .NET Framework 版本1.1 開始，在資料來源<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>執行命令的方式已變更。</span><span class="sxs-lookup"><span data-stu-id="b12e3-136">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="b12e3-137">在 .NET Framework 版本1.0 中， <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>會在**sp_executesql**預存程式的內容中執行所有命令。</span><span class="sxs-lookup"><span data-stu-id="b12e3-137">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="b12e3-138">結果，凡是會影響連接狀態的命令 (例如，SET NOCOUNT ON) 只適用於目前命令的執行。</span><span class="sxs-lookup"><span data-stu-id="b12e3-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="b12e3-139">若連接已開啟，連接狀態就不會因為任何後續命令的執行而被修改。</span><span class="sxs-lookup"><span data-stu-id="b12e3-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="b12e3-140">在 .NET Framework 1.1 版和更新版本中<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> ，只有當命令包含參數時，才會在**sp_executesql**預存程式的內容中執行命令，以提供效能優勢。</span><span class="sxs-lookup"><span data-stu-id="b12e3-140">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="b12e3-141">這樣的結果是，若連接已開啟，凡是會影響連接狀態的命令 (它包含於非參數化命令中) 都會修改已執行之所有後續命令的連接狀態。</span><span class="sxs-lookup"><span data-stu-id="b12e3-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="b12e3-142">請考慮使用下列在 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 呼叫中執行的命令批次。</span><span class="sxs-lookup"><span data-stu-id="b12e3-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="b12e3-143">在 .NET Framework 1.1 版和更新版本中，在開啟連接時，NOCOUNT 將會針對任何後續執行的命令維持開啟狀態。</span><span class="sxs-lookup"><span data-stu-id="b12e3-143">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="b12e3-144">在 .NET Framework 版本1.0 中，NOCOUNT 只會在目前命令執行的上開啟。</span><span class="sxs-lookup"><span data-stu-id="b12e3-144">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="b12e3-145">這項變更可能會影響應用程式的向前和回溯相容性（如果您相依于任一<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>版本的 .NET Framework 的行為）。</span><span class="sxs-lookup"><span data-stu-id="b12e3-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="b12e3-146">對於在舊版和更新版本的 .NET Framework 上執行的應用程式，您可以撰寫程式碼，以確保不論您執行的版本為何，行為都相同。</span><span class="sxs-lookup"><span data-stu-id="b12e3-146">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="b12e3-147">如果您想要確保某個命令會針對所有後續命令修改連接的狀態，我們建議您使用 <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> 來執行命令。</span><span class="sxs-lookup"><span data-stu-id="b12e3-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="b12e3-148">如果您想要確保命令不會針對所有後續命令修改連接，則我們建議您在命令中加入要重設連接狀態的命令。</span><span class="sxs-lookup"><span data-stu-id="b12e3-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="b12e3-149">例如：</span><span class="sxs-lookup"><span data-stu-id="b12e3-149">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="b12e3-150">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b12e3-150">See also</span></span>

- [<span data-ttu-id="b12e3-151">ADO.NET 概觀</span><span class="sxs-lookup"><span data-stu-id="b12e3-151">ADO.NET Overview</span></span>](ado-net-overview.md)
- [<span data-ttu-id="b12e3-152">在 ADO.NET 中擷取和修改資料</span><span class="sxs-lookup"><span data-stu-id="b12e3-152">Retrieving and Modifying Data in ADO.NET</span></span>](retrieving-and-modifying-data.md)
