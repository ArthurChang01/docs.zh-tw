---
title: ADO.NET 中的並存執行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: 793a48966192326e2a1273c6ea4b9c9eddda76fa
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33365445"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="e6e8e-102">ADO.NET 中的並存執行</span><span class="sxs-lookup"><span data-stu-id="e6e8e-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="e6e8e-103">在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 中，並存執行是指在安裝多個 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 版本的電腦上執行應用程式 (單獨使用針對編譯該應用程式所用的版本) 的能力。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-103">Side-by-side execution in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] is the ability to execute an application on a computer that has multiple versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="e6e8e-104">如需設定來並行執行的詳細資訊，請參閱[-並存執行](../../../../docs/framework/deployment/side-by-side-execution.md)。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="e6e8e-105">使用某個 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 版本所編譯的應用程式可在不同的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 版本上執行。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-105">An application compiled by using one version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] can run on a different version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="e6e8e-106">但是，我們建議您最好先針對已安裝的每個 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 版本編譯應用程式版本，然後再個別執行。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-106">However, we recommend that you compile a version of the application for each installed version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], and run them separately.</span></span> <span data-ttu-id="e6e8e-107">不論是上述哪一種狀況，您都應該了解 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 各版本間的差異，因為它會影響應用程式的向前相容性或回溯相容性 (Backward Compatibility)。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-107">In either scenario, you should be aware of changes in [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="e6e8e-108">向前相容性和回溯相容性</span><span class="sxs-lookup"><span data-stu-id="e6e8e-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="e6e8e-109">所謂向前相容性是指應用程式可以使用舊版的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 編譯，但仍可順利在新版的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 上執行。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-109">Forward compatibility means that an application can be compiled with an earlier version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but will still run successfully on a later version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="e6e8e-110">針對 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 1.1 版所撰寫的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 程式碼可向前相容於更新版本。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-110">[!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] code written for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="e6e8e-111">所謂回溯相容性是指針對新版 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 所編譯的應用程式，但仍可在舊版 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 上繼續執行，而不會減損任何功能。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-111">Backward compatibility means that an application is compiled for a newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], but continues to run on earlier versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] without any loss of functionality.</span></span> <span data-ttu-id="e6e8e-112">當然，這不適用於新版的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 所引入的功能。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-112">Of course, this will not be the case for features introduced in a new version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="e6e8e-113">ODBC 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="e6e8e-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="e6e8e-114">從 1.1 版開始，[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC (<xref:System.Data.Odbc>) 就包含在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 中。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-114">Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="e6e8e-115">ODBC 資料提供者是否能夠[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]Web 1.0 版開發人員可以從下載[資料存取和存放開發人員中心](http://go.microsoft.com/fwlink/?linkid=4173)。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-115">The ODBC data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](http://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="e6e8e-116">下載的命名空間[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]Data Provider for ODBC 會**Microsoft.Data.Odbc**。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-116">The namespace for the downloaded [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="e6e8e-117">如果您的應用程式開發的[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]1.0 版，使用 ODBC 資料提供者連接到資料來源，而您想要執行該應用程式[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]1.1 版或更新版本，您必須將 odbc 更新命名空間資料提供者**System.Data.Odbc**。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-117">If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="e6e8e-118">然後，您還要為新版的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 重新編譯該程式。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-118">You then must recompile it for the newer version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span>  
  
 <span data-ttu-id="e6e8e-119">如果您的應用程式是針對 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 2.0 版或更新版本開發的，並且使用 ODBC 資料提供者來連接至資料來源，而您想在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.0 版上執行這個應用程式，則必須下載 ODBC 資料提供者並將它安裝在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.0 版的系統上。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-119">If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the ODBC data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system.</span></span> <span data-ttu-id="e6e8e-120">您接著必須變更命名空間的 ODBC 資料提供者**Microsoft.Data.Odbc**，並重新編譯的應用程式[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]1.0 版。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="e6e8e-121">Oracle 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="e6e8e-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="e6e8e-122">從 1.1 版開始，[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for Oracle (<xref:System.Data.OracleClient>) 就包含在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 中。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-122">Starting with version 1.1, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span> <span data-ttu-id="e6e8e-123">資料提供者是否能夠[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]Web 1.0 版開發人員可以從下載[資料存取和存放開發人員中心](http://go.microsoft.com/fwlink/?linkid=4173)。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-123">The data provider is available to [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](http://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="e6e8e-124">如果您的應用程式開發的[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]2.0 版或更新版本會使用資料提供者連接至您的資料來源，而您想要執行該應用程式[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]1.0 版中，您必須下載的資料提供者，並將它安裝在 <c4 > [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]  1.0 版的系統。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-124">If you have an application developed for the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, you must download the data provider and install it on the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="e6e8e-125">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="e6e8e-125">Code Access Security</span></span>  
 <span data-ttu-id="e6e8e-126">[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.0 版中的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 資料提供者 (<xref:System.Data.SqlClient> 和 <xref:System.Data.OleDb>) 是以 FullTrust 權限執行的必要項目。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-126">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="e6e8e-127">如果您想在權限小於 FullTrust 的區域中嘗試使用 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.0 版的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 資料提供者，結果就會出現 <xref:System.Security.SecurityException>。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-127">Any attempt to use the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] k data providers from the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="e6e8e-128">不過，從 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 2.0 版開始，您就可以在部分信任的區域中使用所有 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-128">However, starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 2.0, all of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="e6e8e-129">此外，系統會將新的安全性功能加入到 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.1 版的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-129">In addition, a new security feature was added to the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] data providers in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1.</span></span> <span data-ttu-id="e6e8e-130">這個功能可讓您限制能在特定安全性區域中使用的連接字串。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="e6e8e-131">您也可以在特定安全性地區內停用空白密碼。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="e6e8e-132">如需詳細資訊，請參閱 [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md)。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-132">For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 <span data-ttu-id="e6e8e-133">因為安裝的每個 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 都有個別的 Security.config 檔，所以安全性設定沒有相容性問題。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-133">Because each installation of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="e6e8e-134">但是，如果您的應用程式有使用 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 1.1 (含) 以後版本所包含之 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 的其他安全性功能，您就無法將應用程式散發到 1.0 版系統上。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-134">However, if your application depends on the additional security capabilities of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] included in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="e6e8e-135">SqlCommand 之執行</span><span class="sxs-lookup"><span data-stu-id="e6e8e-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="e6e8e-136">從 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.1 版開始，<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 在資料來源執行命令的方式就已變更。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-136">Starting with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="e6e8e-137">在[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]1.0 版，<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>的內容中執行所有命令**sp_executesql**預存程序。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-137">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="e6e8e-138">結果，凡是會影響連接狀態的命令 (例如，SET NOCOUNT ON) 只適用於目前命令的執行。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="e6e8e-139">若連接已開啟，連接狀態就不會因為任何後續命令的執行而被修改。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="e6e8e-140">在[!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)]版本 1.1 及更新版本、<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>才會執行命令的內容中**sp_executesql**預存程序，當命令包含參數，可提供效能優勢。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-140">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="e6e8e-141">這樣的結果是，若連接已開啟，凡是會影響連接狀態的命令 (它包含於非參數化命令中) 都會修改已執行之所有後續命令的連接狀態。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="e6e8e-142">請考慮使用下列在 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 呼叫中執行的命令批次。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```  
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="e6e8e-143">在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.1 (含) 以後版本中，若連接已開啟，則 NOCOUNT 對於所執行的所有後續命令都會保持為 ON。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-143">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="e6e8e-144">而在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 1.0 版中，NOCOUNT 只有對目前執行的命令才會是 ON。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-144">In the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="e6e8e-145">如果您有使用任一 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 版本的 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 行為，這個變更會影響應用程式的向前和回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span></span>  
  
 <span data-ttu-id="e6e8e-146">若應用程式會在 [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] 的之前和以後版本上執行，則您可以撰寫程式碼來確保它在不同版本上的行為是相同的。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-146">For applications that run on both earlier and later versions of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="e6e8e-147">如果您想要確保某個命令會針對所有後續命令修改連接的狀態，我們建議您使用 <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> 來執行命令。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="e6e8e-148">如果您想要確保命令不會針對所有後續命令修改連接，則我們建議您在命令中加入要重設連接狀態的命令。</span><span class="sxs-lookup"><span data-stu-id="e6e8e-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="e6e8e-149">例如: </span><span class="sxs-lookup"><span data-stu-id="e6e8e-149">For example:</span></span>  
  
```  
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="e6e8e-150">另請參閱</span><span class="sxs-lookup"><span data-stu-id="e6e8e-150">See Also</span></span>  
 [<span data-ttu-id="e6e8e-151">ADO.NET 概觀</span><span class="sxs-lookup"><span data-stu-id="e6e8e-151">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)  
 [<span data-ttu-id="e6e8e-152">在 ADO.NET 中擷取和修改資料</span><span class="sxs-lookup"><span data-stu-id="e6e8e-152">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)  
 [<span data-ttu-id="e6e8e-153">ADO.NET Managed 提供者和 DataSet 開發人員中心</span><span class="sxs-lookup"><span data-stu-id="e6e8e-153">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
