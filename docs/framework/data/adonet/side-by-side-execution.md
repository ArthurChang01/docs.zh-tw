---
title: ADO.NET 中的並存執行
ms.date: 03/30/2017
ms.assetid: 9f9ba96d-9f89-4f65-bb2f-6860879f4393
ms.openlocfilehash: d20d8e81d76284509d6fe733e4f283a9ab39cb00
ms.sourcegitcommit: c4e9d05644c9cb89de5ce6002723de107ea2e2c4
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/19/2019
ms.locfileid: "65877099"
---
# <a name="side-by-side-execution-in-adonet"></a><span data-ttu-id="b8ca2-102">ADO.NET 中的並存執行</span><span class="sxs-lookup"><span data-stu-id="b8ca2-102">Side-by-Side Execution in ADO.NET</span></span>
<span data-ttu-id="b8ca2-103">並排顯示執行.NET Framework 中的是有多個版本的.NET Framework 安裝，以獨佔方式使用的已編譯的應用程式版本的電腦上執行應用程式的能力。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-103">Side-by-side execution in the .NET Framework is the ability to execute an application on a computer that has multiple versions of the .NET Framework installed, exclusively using the version for which the application was compiled.</span></span> <span data-ttu-id="b8ca2-104">如需設定並排顯示執行的詳細資訊，請參閱[並排顯示執行](../../../../docs/framework/deployment/side-by-side-execution.md)。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-104">For detailed information about configuring side-by-side execution, see [Side-by-Side Execution](../../../../docs/framework/deployment/side-by-side-execution.md).</span></span>  
  
 <span data-ttu-id="b8ca2-105">藉由使用一種.NET Framework 版本所編譯的應用程式可以執行不同版本的.NET framework。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-105">An application compiled by using one version of the .NET Framework can run on a different version of the .NET Framework.</span></span> <span data-ttu-id="b8ca2-106">不過，我們建議您編譯的.NET Framework 中，每個已安裝版本的應用程式的版本，然後再個別執行。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-106">However, we recommend that you compile a version of the application for each installed version of the .NET Framework, and run them separately.</span></span> <span data-ttu-id="b8ca2-107">在任一情況下，您應該注意在 ADO.NET 中可能會影響往後相容性或您的應用程式的回溯相容性的版本之間的變更。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-107">In either scenario, you should be aware of changes in ADO.NET between releases that can affect the forward compatibility or backward compatibility of your application.</span></span>  
  
## <a name="forward-compatibility-and-backward-compatibility"></a><span data-ttu-id="b8ca2-108">向前相容性和回溯相容性</span><span class="sxs-lookup"><span data-stu-id="b8ca2-108">Forward Compatibility and Backward Compatibility</span></span>  
 <span data-ttu-id="b8ca2-109">正向相容性是指應用程式可以使用舊版.NET Framework 中，進行編譯，但仍會在更新的.NET framework 版本上順利執行。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-109">Forward compatibility means that an application can be compiled with an earlier version of the .NET Framework, but will still run successfully on a later version of the .NET Framework.</span></span> <span data-ttu-id="b8ca2-110">針對.NET Framework 1.1 版所撰寫 ADO.NET 程式碼是向前相容於更新版本。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-110">ADO.NET code written for the .NET Framework version 1.1 is forward compatible with later versions.</span></span>  
  
 <span data-ttu-id="b8ca2-111">回溯相容性表示應用程式針對較新版的.NET Framework 中，編譯，但仍會繼續執行舊版的.NET Framework 不會遺失任何的功能。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-111">Backward compatibility means that an application is compiled for a newer version of the .NET Framework, but continues to run on earlier versions of the .NET Framework without any loss of functionality.</span></span> <span data-ttu-id="b8ca2-112">當然，這不是所引進的新版本的.NET framework 功能的情況。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-112">Of course, this will not be the case for features introduced in a new version of the .NET Framework.</span></span>  
  
## <a name="the-net-framework-data-provider-for-odbc"></a><span data-ttu-id="b8ca2-113">ODBC 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="b8ca2-113">The .NET Framework Data Provider for ODBC</span></span>  
 <span data-ttu-id="b8ca2-114">從版本 1.1 中，.NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) 就會包含.NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-114">Starting with version 1.1, the .NET Framework Data Provider for ODBC (<xref:System.Data.Odbc>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="b8ca2-115">ODBC 資料提供者的.NET Framework 1.0 版開發人員從 Web 下載[Data Access 和 Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173)。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-115">The ODBC data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span> <span data-ttu-id="b8ca2-116">下載.NET Framework Data Provider for ODBC 的命名空間是**Microsoft.Data.Odbc**。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-116">The namespace for the downloaded .NET Framework Data Provider for ODBC is **Microsoft.Data.Odbc**.</span></span>  
  
 <span data-ttu-id="b8ca2-117">如果您有適用於.NET Framework 1.0 版來連接到資料來源時，使用 ODBC 資料提供者所開發的應用程式，而且您想要在.NET Framework 1.1 版或更新版本上執行該應用程式，您必須更新 ODBC dat 的命名空間提供者**System.Data.Odbc**。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-117">If you have an application developed for the .NET Framework version 1.0 that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.1 or a later version, you must update the namespace for the ODBC data provider to **System.Data.Odbc**.</span></span> <span data-ttu-id="b8ca2-118">您接著必須重新編譯它較新版本的.NET Framework。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-118">You then must recompile it for the newer version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="b8ca2-119">如果您有適用於使用 ODBC 資料提供者來連接到資料來源時，.NET Framework 2.0 版或更新版本開發的應用程式，而且您想要在.NET Framework 1.0 版上執行該應用程式，您必須下載 ODBC 資料提供者，並將它安裝在.NET Framework 1.0 版的系統。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-119">If you have an application developed for the .NET Framework version 2.0 or later that uses the ODBC data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the ODBC data provider and install it on the .NET Framework version 1.0 system.</span></span> <span data-ttu-id="b8ca2-120">您接著必須變更命名空間的 ODBC 資料提供者**Microsoft.Data.Odbc**，並重新編譯.NET Framework 1.0 版的應用程式。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-120">You then must change the namespace for the ODBC data provider to **Microsoft.Data.Odbc**, and recompile the application for the .NET Framework version 1.0.</span></span>  
  
## <a name="the-net-framework-data-provider-for-oracle"></a><span data-ttu-id="b8ca2-121">Oracle 的 .NET Framework 資料提供者</span><span class="sxs-lookup"><span data-stu-id="b8ca2-121">The .NET Framework Data Provider for Oracle</span></span>  
 <span data-ttu-id="b8ca2-122">從版本 1.1 中，.NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) 就會包含.NET Framework 的一部分。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-122">Starting with version 1.1, the .NET Framework Data Provider for Oracle (<xref:System.Data.OracleClient>) is included as a part of the .NET Framework.</span></span> <span data-ttu-id="b8ca2-123">資料提供者的.NET Framework 1.0 版開發人員從 Web 下載[Data Access 和 Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173)。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-123">The data provider is available to .NET Framework version 1.0 developers as a Web download from the [Data Access and Storage Developer Center](https://go.microsoft.com/fwlink/?linkid=4173).</span></span>  
  
 <span data-ttu-id="b8ca2-124">如果您有連接到資料來源時，會使用此資料提供者的.NET framework 2.0 版或更新版本開發的應用程式，而且您想要在.NET Framework 1.0 版上執行該應用程式，您必須下載此資料提供者，並將它安裝在.NET Framework 1.0 版的系統。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-124">If you have an application developed for the .NET Framework version 2.0 or later that uses the data provider to connect to your data source, and you want to run that application on the .NET Framework version 1.0, you must download the data provider and install it on the .NET Framework version 1.0 system.</span></span>  
  
## <a name="code-access-security"></a><span data-ttu-id="b8ca2-125">程式碼存取安全性</span><span class="sxs-lookup"><span data-stu-id="b8ca2-125">Code Access Security</span></span>  
 <span data-ttu-id="b8ca2-126">在.NET Framework 1.0 版的.NET Framework 資料提供者 (<xref:System.Data.SqlClient>， <xref:System.Data.OleDb>)，才能執行以 FullTrust 權限。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-126">The .NET Framework data providers in the .NET Framework version 1.0 (<xref:System.Data.SqlClient>, <xref:System.Data.OleDb>) are required to run with FullTrust permission.</span></span> <span data-ttu-id="b8ca2-127">嘗試使用小於 FullTrust 權限的原因與區域中的.NET Framework 資料提供者從.NET Framework 1.0 版<xref:System.Security.SecurityException>。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-127">Any attempt to use the .NET Framework k data providers from the .NET Framework version 1.0 in a zone with less than FullTrust permission causes a <xref:System.Security.SecurityException>.</span></span>  
  
 <span data-ttu-id="b8ca2-128">不過，從.NET Framework 2.0 版開始，所有.NET Framework 資料提供者可以用於部分信任的區域。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-128">However, starting with the .NET Framework version 2.0, all of the .NET Framework data providers can be used in partially trusted zones.</span></span> <span data-ttu-id="b8ca2-129">此外，新的安全性功能已加入.NET Framework 1.1 版中的.NET Framework 資料提供者。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-129">In addition, a new security feature was added to the .NET Framework data providers in the .NET Framework version 1.1.</span></span> <span data-ttu-id="b8ca2-130">這個功能可讓您限制能在特定安全性區域中使用的連接字串。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-130">This feature enables you to restrict what connection strings can be used in a particular security zone.</span></span> <span data-ttu-id="b8ca2-131">您也可以在特定安全性地區內停用空白密碼。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-131">You can also disable the use of blank passwords for a particular security zone.</span></span> <span data-ttu-id="b8ca2-132">如需詳細資訊，請參閱 [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md)。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-132">For more information, see [Code Access Security and ADO.NET](../../../../docs/framework/data/adonet/code-access-security.md).</span></span>  
  
 <span data-ttu-id="b8ca2-133">每個安裝的.NET framework 有個別的 Security.config 檔，因為有安全性設定沒有相容性問題。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-133">Because each installation of the .NET Framework has a separate Security.config file, there are no compatibility issues with security settings.</span></span> <span data-ttu-id="b8ca2-134">不過，如果您的應用程式相依於 ADO.NET 包含在.NET Framework 1.1 版或更新版本的其他安全性功能，您將無法將它散發給 1.0 版的系統。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-134">However, if your application depends on the additional security capabilities of ADO.NET included in the .NET Framework version 1.1 and later, you will not be able to distribute it to a version 1.0 system.</span></span>  
  
## <a name="sqlcommand-execution"></a><span data-ttu-id="b8ca2-135">SqlCommand 之執行</span><span class="sxs-lookup"><span data-stu-id="b8ca2-135">SqlCommand Execution</span></span>  
 <span data-ttu-id="b8ca2-136">從.NET Framework 1.1 版的方式開始，<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>執行命令，在資料來源已變更。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-136">Starting with the .NET Framework version 1.1, the way that <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executes commands at the data source was changed.</span></span>  
  
 <span data-ttu-id="b8ca2-137">在.NET Framework 1.0 版<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>的內容中執行所有命令**sp_executesql**預存程序。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-137">In the .NET Framework version 1.0, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> executed all commands in the context of the **sp_executesql** stored procedure.</span></span> <span data-ttu-id="b8ca2-138">結果，凡是會影響連接狀態的命令 (例如，SET NOCOUNT ON) 只適用於目前命令的執行。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-138">As a result, commands that affect the state of the connection (for example, SET NOCOUNT ON), only apply to the execution of the current command.</span></span> <span data-ttu-id="b8ca2-139">若連接已開啟，連接狀態就不會因為任何後續命令的執行而被修改。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-139">The state of the connection is not modified for any subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="b8ca2-140">在.NET Framework 1.1 版及更新版本<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>只有在內容中執行命令**sp_executesql**預存程序，當命令包含參數，可提供效能優勢。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-140">In the .NET Framework version 1.1 and later, <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> only executes a command in the context of the **sp_executesql** stored procedure if the command contains parameters, which provides a performance benefit.</span></span> <span data-ttu-id="b8ca2-141">這樣的結果是，若連接已開啟，凡是會影響連接狀態的命令 (它包含於非參數化命令中) 都會修改已執行之所有後續命令的連接狀態。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-141">As a result, if a command affecting the state of the connection is included in a non-parameterized command, it modifies the state of the connection for all subsequent commands executed while the connection is open.</span></span>  
  
 <span data-ttu-id="b8ca2-142">請考慮使用下列在 <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> 呼叫中執行的命令批次。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-142">Consider the following batch of commands executed in a call to <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>.</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
```  
  
 <span data-ttu-id="b8ca2-143">在.NET Framework 1.1 和更新版本中，NOCOUNT 會保持開啟狀態的任何後續的命令執行時，連接已開啟。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-143">In the .NET Framework version 1.1 and later, NOCOUNT will remain ON for any subsequent commands executed while the connection is open.</span></span> <span data-ttu-id="b8ca2-144">在.NET Framework 1.0 版中，NOCOUNT 是只有 ON 目前執行的命令。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-144">In the .NET Framework version 1.0, NOCOUNT is only ON for the current command execution.</span></span>  
  
 <span data-ttu-id="b8ca2-145">這項變更可能會影響您的應用程式的向前及向後相容，如果您依賴的行為<xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A>任一版本的.NET framework。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-145">This change can affect both the forward and backward compatibility of your application if you depend on the behavior of <xref:System.Data.SqlClient.SqlCommand.ExecuteReader%2A> for either version of the .NET Framework.</span></span>  
  
 <span data-ttu-id="b8ca2-146">在之前和以後版本的.NET framework 上執行的應用程式，您可以撰寫您的程式碼，並確定行為是不論您在執行的版本相同。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-146">For applications that run on both earlier and later versions of the .NET Framework, you can write your code to make sure that the behavior is the same regardless of the version you are running on.</span></span> <span data-ttu-id="b8ca2-147">如果您想要確保某個命令會針對所有後續命令修改連接的狀態，我們建議您使用 <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A> 來執行命令。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-147">If you want to make sure that a command modifies the state of the connection for all subsequent commands, we recommend that you execute your command using <xref:System.Data.SqlClient.SqlCommand.ExecuteNonQuery%2A>.</span></span> <span data-ttu-id="b8ca2-148">如果您想要確保命令不會針對所有後續命令修改連接，則我們建議您在命令中加入要重設連接狀態的命令。</span><span class="sxs-lookup"><span data-stu-id="b8ca2-148">If you want to make sure that a command does not modify the connection for all subsequent commands, we recommend that you include the commands to reset the state of the connection in your command.</span></span> <span data-ttu-id="b8ca2-149">例如：</span><span class="sxs-lookup"><span data-stu-id="b8ca2-149">For example:</span></span>  
  
```sql
SET NOCOUNT ON;  
SELECT * FROM dbo.Customers;  
SET NOCOUNT OFF;  
```  
  
## <a name="see-also"></a><span data-ttu-id="b8ca2-150">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b8ca2-150">See also</span></span>

- [<span data-ttu-id="b8ca2-151">ADO.NET 概觀</span><span class="sxs-lookup"><span data-stu-id="b8ca2-151">ADO.NET Overview</span></span>](../../../../docs/framework/data/adonet/ado-net-overview.md)
- [<span data-ttu-id="b8ca2-152">在 ADO.NET 中擷取和修改資料</span><span class="sxs-lookup"><span data-stu-id="b8ca2-152">Retrieving and Modifying Data in ADO.NET</span></span>](../../../../docs/framework/data/adonet/retrieving-and-modifying-data.md)
- [<span data-ttu-id="b8ca2-153">ADO.NET Managed 提供者和 DataSet 開發人員中心</span><span class="sxs-lookup"><span data-stu-id="b8ca2-153">ADO.NET Managed Providers and DataSet Developer Center</span></span>](https://go.microsoft.com/fwlink/?LinkId=217917)
