---
title: LINQ to DataSet 概觀
ms.date: 03/30/2017
ms.assetid: dc20a8fb-03f6-4b68-9c2b-7f7299e3070b
ms.openlocfilehash: 43c3aa081bd934202bd3a7831741054115d7a6d5
ms.sourcegitcommit: 8c2ece71e54f46aef9a2153540d0bda7e74b19a9
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/12/2018
ms.locfileid: "44508487"
---
# <a name="linq-to-dataset-overview"></a><span data-ttu-id="c5174-102">LINQ to DataSet 概觀</span><span class="sxs-lookup"><span data-stu-id="c5174-102">LINQ to DataSet Overview</span></span>
<span data-ttu-id="c5174-103"><xref:System.Data.DataSet> 是其中一個常用的 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 元件。</span><span class="sxs-lookup"><span data-stu-id="c5174-103">The <xref:System.Data.DataSet> is one of the more widely used components of [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)].</span></span> <span data-ttu-id="c5174-104">它是 [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] 所依據之中斷連接程式撰寫模型 (Programming Model) 的重要項目，而且可讓您明確快取來自不同資料來源的資料。</span><span class="sxs-lookup"><span data-stu-id="c5174-104">It is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is based on, and it enables you to explicitly cache data from different data sources.</span></span> <span data-ttu-id="c5174-105">若為展示層，<xref:System.Data.DataSet> 會與 GUI 控制項緊密整合，以便進行資料繫結 (Data Binding)。</span><span class="sxs-lookup"><span data-stu-id="c5174-105">For the presentation tier, the <xref:System.Data.DataSet> is tightly integrated with GUI controls for data-binding.</span></span> <span data-ttu-id="c5174-106">若為中介層 (Middle Tier)，它會提供保留關聯式資料圖案的快取，而且包含快速簡易查詢和階層導覽服務。</span><span class="sxs-lookup"><span data-stu-id="c5174-106">For the middle-tier, it provides a cache that preserves the relational shape of data, and includes fast simple query and hierarchy navigation services.</span></span> <span data-ttu-id="c5174-107">較低的資料庫上的要求數目常用的技巧是使用<xref:System.Data.DataSet>的中介層中的快取。</span><span class="sxs-lookup"><span data-stu-id="c5174-107">A common technique used to lower the number of requests on a database is to use the <xref:System.Data.DataSet> for caching in the middle-tier.</span></span> <span data-ttu-id="c5174-108">例如，請考慮資料驅動[!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]Web 應用程式。</span><span class="sxs-lookup"><span data-stu-id="c5174-108">For example, consider a data-driven [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] Web application.</span></span> <span data-ttu-id="c5174-109">通常，應用程式資料的重要部分不會經常變更，而且在工作階段 (Session) 或使用者之間是通用的。</span><span class="sxs-lookup"><span data-stu-id="c5174-109">Often, a significant portion of the application data does not change frequently and is common across sessions or users.</span></span> <span data-ttu-id="c5174-110">這項資料可以保留在 Web 伺服器的記憶體中，以便減少針對資料庫所進行的要求數目並加快使用者互動的速度。</span><span class="sxs-lookup"><span data-stu-id="c5174-110">This data can be kept in memory on the Web server, which reduces the number of requests against the database and speeds up the user’s interactions.</span></span> <span data-ttu-id="c5174-111">另一個有用的層面<xref:System.Data.DataSet>是它可讓應用程式從一或多個資料來源的資料子集帶入應用程式空間。</span><span class="sxs-lookup"><span data-stu-id="c5174-111">Another useful aspect of the <xref:System.Data.DataSet> is that it allows an application to bring subsets of data from one or more data source into the application space.</span></span> <span data-ttu-id="c5174-112">然後，此應用程式就可以管理記憶體中資料，同時保留其關聯式圖案。</span><span class="sxs-lookup"><span data-stu-id="c5174-112">The application can then manipulate the data in-memory, while retaining its relational shape.</span></span>  
  
 <span data-ttu-id="c5174-113">雖然 <xref:System.Data.DataSet> 具有上述優點，但是它的查詢功能仍然有限。</span><span class="sxs-lookup"><span data-stu-id="c5174-113">Despite its prominence, the <xref:System.Data.DataSet> has limited query capabilities.</span></span> <span data-ttu-id="c5174-114"><xref:System.Data.DataTable.Select%2A> 方法可用於篩選和排序，而 <xref:System.Data.DataRow.GetChildRows%2A> 和 <xref:System.Data.DataRow.GetParentRow%2A> 方法可用於階層導覽。</span><span class="sxs-lookup"><span data-stu-id="c5174-114">The <xref:System.Data.DataTable.Select%2A> method can be used for filtering and sorting, and the <xref:System.Data.DataRow.GetChildRows%2A> and <xref:System.Data.DataRow.GetParentRow%2A> methods can be used for hierarchy navigation.</span></span> <span data-ttu-id="c5174-115">不過，若要進行更複雜的作業，開發人員就必須撰寫自訂查詢。</span><span class="sxs-lookup"><span data-stu-id="c5174-115">For anything more complex, however, the developer must write a custom query.</span></span> <span data-ttu-id="c5174-116">這樣做可能會產生執行效能較低而且難以維護的應用程式。</span><span class="sxs-lookup"><span data-stu-id="c5174-116">This can result in applications that perform poorly and are difficult to maintain.</span></span>  
  
 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="c5174-117"> 可讓您更方便且更快速地查詢在 <xref:System.Data.DataSet> 物件中快取的資料。</span><span class="sxs-lookup"><span data-stu-id="c5174-117"> makes it easier and faster to query over data cached in a <xref:System.Data.DataSet> object.</span></span> <span data-ttu-id="c5174-118">這些查詢是以程式語言本身表示，而非以內嵌於應用程式程式碼中的字串常值 (String Literal) 表示。</span><span class="sxs-lookup"><span data-stu-id="c5174-118">These queries are expressed in the programming language itself, rather than as string literals embedded in the application code.</span></span> <span data-ttu-id="c5174-119">這表示，開發人員不需要學習不同的查詢語言。</span><span class="sxs-lookup"><span data-stu-id="c5174-119">This means that developers do not have to learn a separate query language.</span></span> <span data-ttu-id="c5174-120">此外，[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]可讓 Visual Studio 開發人員更有效率地工作，因為 Visual Studio IDE 提供編譯時間語法檢查、 靜態型別和 IntelliSense 支援[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="c5174-120">Additionally, [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] enables Visual Studio developers to work more productively, because the Visual Studio IDE provides compile-time syntax checking, static typing, and IntelliSense support for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="c5174-121"> 也可用來查詢已經從一個或多個資料來源合併的資料。</span><span class="sxs-lookup"><span data-stu-id="c5174-121"> can also be used to query over data that has been consolidated from one or more data sources.</span></span> <span data-ttu-id="c5174-122">這點可以實現許多資料表示和處理方式需要彈性的案例。</span><span class="sxs-lookup"><span data-stu-id="c5174-122">This enables many scenarios that require flexibility in how data is represented and handled.</span></span> <span data-ttu-id="c5174-123">尤其，一般報表、分析和商務智慧應用程式都需要這種管理方法。</span><span class="sxs-lookup"><span data-stu-id="c5174-123">In particular, generic reporting, analysis, and business intelligence applications require this method of manipulation.</span></span>  
  
## <a name="querying-datasets-using-linq-to-dataset"></a><span data-ttu-id="c5174-124">使用 LINQ to DataSet 來查詢 DataSet</span><span class="sxs-lookup"><span data-stu-id="c5174-124">Querying DataSets Using LINQ to DataSet</span></span>  
 <span data-ttu-id="c5174-125">您必須先填入 (Populate) <xref:System.Data.DataSet>，然後才能開始使用 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 來查詢 <xref:System.Data.DataSet> 物件。</span><span class="sxs-lookup"><span data-stu-id="c5174-125">Before you can begin querying a <xref:System.Data.DataSet> object using [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], you must populate the <xref:System.Data.DataSet>.</span></span> <span data-ttu-id="c5174-126">有數種方式將資料載入<xref:System.Data.DataSet>，例如使用<xref:System.Data.Common.DataAdapter>類別或[LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md)。</span><span class="sxs-lookup"><span data-stu-id="c5174-126">There are several ways to load data into a <xref:System.Data.DataSet>, such as using the <xref:System.Data.Common.DataAdapter> class or [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span> <span data-ttu-id="c5174-127">將資料載入之後<xref:System.Data.DataSet>物件時，您可以開始查詢它。</span><span class="sxs-lookup"><span data-stu-id="c5174-127">After the data has been loaded into a <xref:System.Data.DataSet> object, you can begin to query it.</span></span> <span data-ttu-id="c5174-128">使用來編寫查詢[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]類似於使用[!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]針對其他[!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]-已啟用資料來源。</span><span class="sxs-lookup"><span data-stu-id="c5174-128">Formulating queries using [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] is similar to using [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] against other [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]-enabled data sources.</span></span> [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]<span data-ttu-id="c5174-129"> 可以針對單一資料表中執行查詢<xref:System.Data.DataSet>或針對一個以上的資料表，使用<xref:System.Linq.Enumerable.Join%2A>和<xref:System.Linq.Enumerable.GroupJoin%2A>標準查詢運算子。</span><span class="sxs-lookup"><span data-stu-id="c5174-129"> queries can be performed against single tables in a <xref:System.Data.DataSet> or against more than one table by using the <xref:System.Linq.Enumerable.Join%2A> and <xref:System.Linq.Enumerable.GroupJoin%2A> standard query operators.</span></span>  
  
 [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)]<span data-ttu-id="c5174-130"> 支援針對具型別和不具類型的查詢<xref:System.Data.DataSet>物件。</span><span class="sxs-lookup"><span data-stu-id="c5174-130"> queries are supported against both typed and untyped <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="c5174-131">如果在應用程式設計階段中便已知 <xref:System.Data.DataSet> 的結構描述，建議您使用具型別 <xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="c5174-131">If the schema of the <xref:System.Data.DataSet> is known at application design time, a typed <xref:System.Data.DataSet> is recommended.</span></span> <span data-ttu-id="c5174-132">在具型別 <xref:System.Data.DataSet> 中，資料表和資料列會具有每個資料行的具型別成員，進而讓查詢更簡單且更方便讀取。</span><span class="sxs-lookup"><span data-stu-id="c5174-132">In a typed <xref:System.Data.DataSet>, the tables and rows have typed members for each of the columns, which makes queries simpler and more readable.</span></span>  
  
 <span data-ttu-id="c5174-133">除了標準查詢運算子中 system.core.dll 的參考，實作[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]加入了許多<xref:System.Data.DataSet>-可讓您更輕鬆地查詢資料集的特定延伸模組<xref:System.Data.DataRow>物件。</span><span class="sxs-lookup"><span data-stu-id="c5174-133">In addition to the standard query operators implemented in System.Core.dll, [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] adds several <xref:System.Data.DataSet>-specific extensions that make it easier to query over a set of <xref:System.Data.DataRow> objects.</span></span> <span data-ttu-id="c5174-134">這些 <xref:System.Data.DataSet> 專用的延伸模組包括比較資料列序列的運算子，以及可讓您存取 <xref:System.Data.DataRow> 之資料行值的方法。</span><span class="sxs-lookup"><span data-stu-id="c5174-134">These <xref:System.Data.DataSet>-specific extensions include operators for comparing sequences of rows, as well as methods that provide access to the column values of a <xref:System.Data.DataRow>.</span></span>  
  
## <a name="n-tier-applications-and-linq-to-dataset"></a><span data-ttu-id="c5174-135">N-Tier 應用程式和 LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="c5174-135">N-tier Applications and LINQ to DataSet</span></span>  
 <span data-ttu-id="c5174-136">N-Tier 資料應用程式是指分隔成多個邏輯層 (或層級) 的資料中心應用程式。</span><span class="sxs-lookup"><span data-stu-id="c5174-136">N-tier data applications are data-centric applications that are separated into multiple logical layers (or tiers).</span></span> <span data-ttu-id="c5174-137">一般的 N-Tier 應用程式包含展示層、中介層和資料層。</span><span class="sxs-lookup"><span data-stu-id="c5174-137">A typical N-tier application includes a presentation tier, a middle tier, and a data tier.</span></span> <span data-ttu-id="c5174-138">將應用程式元件分隔成不同的層級會提升應用程式的可維護性和延展性 (Scalability)。</span><span class="sxs-lookup"><span data-stu-id="c5174-138">Separating application components into separate tiers increases the maintainability and scalability of the application.</span></span> <span data-ttu-id="c5174-139">如需有關多層式架構資料應用程式的詳細資訊，請參閱 <<c0> [ 使用多層式架構應用程式中的資料集](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications)。</span><span class="sxs-lookup"><span data-stu-id="c5174-139">For more information about N-tier data applications, see [Work with datasets in n-tier applications](/visualstudio/data-tools/work-with-datasets-in-n-tier-applications).</span></span>  
  
 <span data-ttu-id="c5174-140">在 N-Tier 應用程式中，<xref:System.Data.DataSet> 通常會用於中介層，以便快取 Web 應用程式的資訊。</span><span class="sxs-lookup"><span data-stu-id="c5174-140">In N-tier applications, the <xref:System.Data.DataSet> is often used in the middle-tier to cache information for a Web application.</span></span> <span data-ttu-id="c5174-141">[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]查詢功能透過擴充方法實作，並擴充現有的 ADO.NET 2.0 <xref:System.Data.DataSet>。</span><span class="sxs-lookup"><span data-stu-id="c5174-141">The [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] querying functionality is implemented through extension methods and extends the existing ADO.NET 2.0 <xref:System.Data.DataSet>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c5174-142">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c5174-142">See Also</span></span>  
 [<span data-ttu-id="c5174-143">查詢資料集</span><span class="sxs-lookup"><span data-stu-id="c5174-143">Querying DataSets</span></span>](../../../../docs/framework/data/adonet/querying-datasets-linq-to-dataset.md)  
 [<span data-ttu-id="c5174-144">LINQ (Language-Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="c5174-144">LINQ (Language-Integrated Query)</span></span>](https://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d)  
 [<span data-ttu-id="c5174-145">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="c5174-145">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)
