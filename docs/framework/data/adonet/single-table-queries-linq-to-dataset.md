---
title: 單一資料表查詢 (LINQ to DataSet)
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
ms.assetid: 0b74bcf8-3f87-449f-bff7-6bcb0d69d212
ms.openlocfilehash: 1f4462f617eb81d30f893b52bdc674e1eee8961c
ms.sourcegitcommit: 7bc6887ab658550baa78f1520ea735838249345e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/03/2020
ms.locfileid: "75634764"
---
# <a name="single-table-queries-linq-to-dataset"></a><span data-ttu-id="8ee84-102">單一資料表查詢 (LINQ to DataSet)</span><span class="sxs-lookup"><span data-stu-id="8ee84-102">Single-Table Queries (LINQ to DataSet)</span></span>
<span data-ttu-id="8ee84-103">語言整合式查詢（LINQ）查詢適用于執行 <xref:System.Collections.Generic.IEnumerable%601> 介面或 <xref:System.Linq.IQueryable%601> 介面的資料來源。</span><span class="sxs-lookup"><span data-stu-id="8ee84-103">Language-Integrated Query (LINQ) queries work on data sources that implement the <xref:System.Collections.Generic.IEnumerable%601> interface or the <xref:System.Linq.IQueryable%601> interface.</span></span> <span data-ttu-id="8ee84-104"><xref:System.Data.DataTable> 類別不會實作用任一介面，因此，如果您想要在 LINQ 查詢的 `From` 子句中使用 <xref:System.Data.DataTable> 做為來源，則必須呼叫 <xref:System.Data.DataTableExtensions.AsEnumerable%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="8ee84-104">The <xref:System.Data.DataTable> class does not implement either interface, so you must call the <xref:System.Data.DataTableExtensions.AsEnumerable%2A> method if you want to use the <xref:System.Data.DataTable> as a source in the `From` clause of a LINQ query.</span></span>  
  
 <span data-ttu-id="8ee84-105">下列範例會從 SalesOrderHeader 資料表中取得所有線上訂單，並將訂單識別碼、訂單日期和訂單號碼輸出至主控台。</span><span class="sxs-lookup"><span data-stu-id="8ee84-105">The following example gets all the online orders from the SalesOrderHeader table and outputs the order ID, order date, and order number to the console.</span></span>  
  
 [!code-csharp[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/csharp/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/CS/Program.cs#where1)]  
 [!code-vb[DP LINQ to DataSet Examples#Where1](../../../../samples/snippets/visualbasic/VS_Snippets_ADO.NET/DP LINQ to DataSet Examples/VB/Module1.vb#where1)] 
  
 <span data-ttu-id="8ee84-106">本機變數查詢會使用查詢運算式進行初始化，其會透過套用標準查詢運算子的一個或多個查詢運算子，或在 LINQ to DataSet 的情況下，在 <xref:System.Data.DataSet> 類別特定的運算子中套用一或多個查詢運算子，以操作一或多個資訊來源。</span><span class="sxs-lookup"><span data-stu-id="8ee84-106">The local variable query is initialized with a query expression, which operates on one or more information sources by applying one or more query operators from either the standard query operators or, in the case of LINQ to DataSet, operators specific to the <xref:System.Data.DataSet> class.</span></span> <span data-ttu-id="8ee84-107">上一個範例中的查詢運算式會使用其中兩個標準查詢運算子：`Where` 與 `Select`。</span><span class="sxs-lookup"><span data-stu-id="8ee84-107">The query expression in the previous example uses two of the standard query operators: `Where` and `Select`.</span></span>  
  
 <span data-ttu-id="8ee84-108">在 `Where` 設定為 `OnlineOrderFlag` 的情況中，`true` 子句會根據條件來篩選序列 (Sequence)。</span><span class="sxs-lookup"><span data-stu-id="8ee84-108">The `Where` clause filters the sequence based on a condition, in this case that the `OnlineOrderFlag` is set to `true`.</span></span> <span data-ttu-id="8ee84-109">`Select` 運算子會配置並傳回擷取傳遞給運算子之引數的可列舉物件。</span><span class="sxs-lookup"><span data-stu-id="8ee84-109">The `Select` operator allocates and returns an enumerable object that captures the arguments passed to the operator.</span></span> <span data-ttu-id="8ee84-110">在上述範例中，匿名型別是使用三個屬性建立的：`SalesOrderID`、`OrderDate` 和 `SalesOrderNumber`。</span><span class="sxs-lookup"><span data-stu-id="8ee84-110">In this above example, an anonymous type is created with three properties: `SalesOrderID`, `OrderDate`, and `SalesOrderNumber`.</span></span> <span data-ttu-id="8ee84-111">這三個屬性的值分別設定為 `SalesOrderID` 資料表中 `OrderDate`、`SalesOrderNumber` 和 `SalesOrderHeader` 資料行的值。</span><span class="sxs-lookup"><span data-stu-id="8ee84-111">The values of these three properties are set to the values of the `SalesOrderID`, `OrderDate`, and `SalesOrderNumber` columns from the `SalesOrderHeader` table.</span></span>  
  
 <span data-ttu-id="8ee84-112">然後，`foreach` 迴圈 (Loop) 會列舉 `Select` 所傳回的可列舉物件並產生查詢結果。</span><span class="sxs-lookup"><span data-stu-id="8ee84-112">The `foreach` loop then enumerates the enumerable object returned by `Select` and yields the query results.</span></span> <span data-ttu-id="8ee84-113">由於查詢是實作 <xref:System.Linq.Enumerable> 的 <xref:System.Collections.Generic.IEnumerable%601> 型別，因此查詢的評估會延後，直到使用 `foreach` 迴圈來反覆查看查詢變數為止。</span><span class="sxs-lookup"><span data-stu-id="8ee84-113">Because query is an <xref:System.Linq.Enumerable> type, which implements <xref:System.Collections.Generic.IEnumerable%601>, the evaluation of the query is deferred until the query variable is iterated over using the `foreach` loop.</span></span> <span data-ttu-id="8ee84-114">延後的查詢評估允許將查詢保留成可多次評估的值，而且每次可能會產生不同的結果。</span><span class="sxs-lookup"><span data-stu-id="8ee84-114">Deferred query evaluation allows queries to be kept as values that can be evaluated multiple times, each time yielding potentially different results.</span></span>  
  
 <span data-ttu-id="8ee84-115"><xref:System.Data.DataRowExtensions.Field%2A> 方法可讓您存取 <xref:System.Data.DataRow> 的資料行值而 <xref:System.Data.DataRowExtensions.SetField%2A> (上一個範例中未顯示) 會設定 <xref:System.Data.DataRow> 中的資料行值。</span><span class="sxs-lookup"><span data-stu-id="8ee84-115">The <xref:System.Data.DataRowExtensions.Field%2A> method provides access to the column values of a <xref:System.Data.DataRow> and the <xref:System.Data.DataRowExtensions.SetField%2A> (not shown in the previous example) sets column values in a <xref:System.Data.DataRow>.</span></span> <span data-ttu-id="8ee84-116">由於 <xref:System.Data.DataRowExtensions.Field%2A> 方法和 <xref:System.Data.DataRowExtensions.SetField%2A> 方法都會處理可為 Null 的型別 (Nullable Type)，因此您不需要明確檢查是否有 Null 值。</span><span class="sxs-lookup"><span data-stu-id="8ee84-116">Both the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method handle nullable types, so you do not have to explicitly check for null values.</span></span> <span data-ttu-id="8ee84-117">此外，這兩種方法都是泛型方法，表示您不需要轉型傳回型別。</span><span class="sxs-lookup"><span data-stu-id="8ee84-117">Both methods are generic methods, also, which means you do not have to cast the return type.</span></span> <span data-ttu-id="8ee84-118">雖然您可以使用 <xref:System.Data.DataRow> 中的現有資料行存取子 (例如 `o["OrderDate"]`)，但是這樣做就必須將傳回物件轉型為適當的型別。</span><span class="sxs-lookup"><span data-stu-id="8ee84-118">You could use the pre-existing column accessor in <xref:System.Data.DataRow> (for example, `o["OrderDate"]`), but doing so would require you to cast the return object to the appropriate type.</span></span>  <span data-ttu-id="8ee84-119">如果資料行可為 Null，您就必須使用 <xref:System.Data.DataRow.IsNull%2A> 方法來檢查其值是否為 Null。</span><span class="sxs-lookup"><span data-stu-id="8ee84-119">If the column is nullable you have to check if the value is null by using the <xref:System.Data.DataRow.IsNull%2A> method.</span></span> <span data-ttu-id="8ee84-120">如需詳細資訊，請參閱[泛型 Field 和 SetField 方法](generic-field-and-setfield-methods-linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="8ee84-120">For more information, see [Generic Field and SetField Methods](generic-field-and-setfield-methods-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="8ee84-121">請注意，`T` 方法和 <xref:System.Data.DataRowExtensions.Field%2A> 方法之泛型參數 <xref:System.Data.DataRowExtensions.SetField%2A> 中指定的資料型別必須與基礎值的型別相符，否則系統將擲回 <xref:System.InvalidCastException>。</span><span class="sxs-lookup"><span data-stu-id="8ee84-121">Note that the data type specified in the generic parameter `T` of the <xref:System.Data.DataRowExtensions.Field%2A> method and <xref:System.Data.DataRowExtensions.SetField%2A> method must match the type of the underlying value or an <xref:System.InvalidCastException> will be thrown.</span></span> <span data-ttu-id="8ee84-122">此外，指定的資料行名稱也必須與 <xref:System.Data.DataSet> 中的資料行名稱相符，否則系統將擲回 <xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="8ee84-122">The specified column name must also match the name of a column in the <xref:System.Data.DataSet> or an <xref:System.ArgumentException> will be thrown.</span></span> <span data-ttu-id="8ee84-123">在這兩種情況中，其例外狀況 (Exception) 是在執行查詢的資料列舉執行階段中擲回。</span><span class="sxs-lookup"><span data-stu-id="8ee84-123">In both cases, the exception is thrown at run time data enumeration when the query is executed.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8ee84-124">請參閱</span><span class="sxs-lookup"><span data-stu-id="8ee84-124">See also</span></span>

- [<span data-ttu-id="8ee84-125">跨資料表查詢</span><span class="sxs-lookup"><span data-stu-id="8ee84-125">Cross-Table Queries</span></span>](cross-table-queries-linq-to-dataset.md)
- [<span data-ttu-id="8ee84-126">查詢具類型資料集</span><span class="sxs-lookup"><span data-stu-id="8ee84-126">Querying Typed DataSets</span></span>](querying-typed-datasets.md)
- [<span data-ttu-id="8ee84-127">泛型 Field 和 SetField 方法</span><span class="sxs-lookup"><span data-stu-id="8ee84-127">Generic Field and SetField Methods</span></span>](generic-field-and-setfield-methods-linq-to-dataset.md)
