---
title: 偵錯 LINQ to DataSet 查詢
ms.date: 03/30/2017
ms.assetid: f4c54015-8ce2-4c5c-8d18-7038144cc66d
ms.openlocfilehash: 6c7b8c6cec39adfd5b7456d94cfae5622649e5a3
ms.sourcegitcommit: 6b308cf6d627d78ee36dbbae8972a310ac7fd6c8
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/23/2019
ms.locfileid: "54680503"
---
# <a name="debugging-linq-to-dataset-queries"></a><span data-ttu-id="c7f61-102">偵錯 LINQ to DataSet 查詢</span><span class="sxs-lookup"><span data-stu-id="c7f61-102">Debugging LINQ to DataSet Queries</span></span>

<span data-ttu-id="c7f61-103">Visual Studio 支援的偵錯[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]程式碼。</span><span class="sxs-lookup"><span data-stu-id="c7f61-103">Visual Studio supports the debugging of [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] code.</span></span> <span data-ttu-id="c7f61-104">不過，有一些偵錯之間的差異[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]程式碼和非-[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] managed 程式碼。</span><span class="sxs-lookup"><span data-stu-id="c7f61-104">However, there are some differences between debugging [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] code and non-[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] managed code.</span></span> <span data-ttu-id="c7f61-105">大部分的偵錯功能搭配[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]陳述式，包括逐步執行、 設定中斷點，以及檢視偵錯工具視窗所示的結果。</span><span class="sxs-lookup"><span data-stu-id="c7f61-105">Most debugging features work with [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] statements, including stepping, setting breakpoints, and viewing results that are shown in debugger windows.</span></span> <span data-ttu-id="c7f61-106">但是，延後查詢執行中的有一些副作用，您應該考慮在偵錯時[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]程式碼，並有一些限制，若要使用 [編輯後繼續]。</span><span class="sxs-lookup"><span data-stu-id="c7f61-106">However, deferred query execution in has some side effects that you should consider while debugging [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] code and there are some limitations to using Edit and Continue.</span></span> <span data-ttu-id="c7f61-107">本主題討論特有的偵錯觀點[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]相較於非[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]managed 程式碼。</span><span class="sxs-lookup"><span data-stu-id="c7f61-107">This topic discusses aspects of debugging that are unique to [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] compared to non-[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] managed code.</span></span>  
  
## <a name="viewing-results"></a><span data-ttu-id="c7f61-108">檢視結果</span><span class="sxs-lookup"><span data-stu-id="c7f61-108">Viewing Results</span></span>  
 <span data-ttu-id="c7f61-109">您可以檢視的結果[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]使用 DataTips、 監看式 視窗中和 [快速監看式] 對話方塊中的陳述式。</span><span class="sxs-lookup"><span data-stu-id="c7f61-109">You can view the result of a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] statement by using DataTips, the Watch window, and the QuickWatch dialog box.</span></span> <span data-ttu-id="c7f61-110">藉由使用來源視窗，您可以在來源視窗中暫停查詢的指標，而且 DataTip 將會出現。</span><span class="sxs-lookup"><span data-stu-id="c7f61-110">By using a source window, you can pause the pointer on a query in the source window and a DataTip will appear.</span></span> <span data-ttu-id="c7f61-111">您可以複製 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 變數，並將其貼入監看式視窗或快速監看式對話方塊中。</span><span class="sxs-lookup"><span data-stu-id="c7f61-111">You can copy a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] variable and paste it into the Watch window or the QuickWatch dialog box.</span></span> <span data-ttu-id="c7f61-112">在 [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] 中建立或宣告查詢時，不會評估該查詢，只有在執行查詢時，才會進行評估。</span><span class="sxs-lookup"><span data-stu-id="c7f61-112">In [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], a query is not evaluated when it is created or declared, but only when the query is executed.</span></span> <span data-ttu-id="c7f61-113">這就叫做*延後執行*。</span><span class="sxs-lookup"><span data-stu-id="c7f61-113">This is called *deferred execution*.</span></span> <span data-ttu-id="c7f61-114">因此，查詢變數在接受評估前沒有值。</span><span class="sxs-lookup"><span data-stu-id="c7f61-114">Therefore, the query variable does not have a value until it is evaluated.</span></span> <span data-ttu-id="c7f61-115">如需詳細資訊，請參閱 < [LINQ to DataSet 中的查詢](../../../../docs/framework/data/adonet/queries-in-linq-to-dataset.md)。</span><span class="sxs-lookup"><span data-stu-id="c7f61-115">For more information, see [Queries in LINQ to DataSet](../../../../docs/framework/data/adonet/queries-in-linq-to-dataset.md).</span></span>  
  
 <span data-ttu-id="c7f61-116">偵錯工具必須評估查詢，才能顯示查詢結果。</span><span class="sxs-lookup"><span data-stu-id="c7f61-116">The debugger must evaluate a query to display the query results.</span></span> <span data-ttu-id="c7f61-117">當您檢視時，就會發生這個隱含評估[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]中偵錯工具，而且查詢結果有一些您應該考慮的效果。</span><span class="sxs-lookup"><span data-stu-id="c7f61-117">This implicit evaluation occurs when you view a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] query result in the debugger, and it has some effects you should consider.</span></span> <span data-ttu-id="c7f61-118">每個查詢評估會耗費些許時間。</span><span class="sxs-lookup"><span data-stu-id="c7f61-118">Each evaluation of the query takes time.</span></span> <span data-ttu-id="c7f61-119">展開結果節點也會耗用時間。</span><span class="sxs-lookup"><span data-stu-id="c7f61-119">Expanding the results node takes time.</span></span> <span data-ttu-id="c7f61-120">對於某些查詢而言，重複的評估可能會造成明顯的效能影響。</span><span class="sxs-lookup"><span data-stu-id="c7f61-120">For some queries, repeated evaluation might cause a noticeable performance penalty.</span></span> <span data-ttu-id="c7f61-121">評估查詢也可能造成變更資料值與程式狀態的副作用。</span><span class="sxs-lookup"><span data-stu-id="c7f61-121">Evaluating a query can also cause side effects, which are changes to the value of data or the state of your program.</span></span> <span data-ttu-id="c7f61-122">並不是所有的查詢都有副作用。</span><span class="sxs-lookup"><span data-stu-id="c7f61-122">Not all queries have side effects.</span></span> <span data-ttu-id="c7f61-123">若要判斷是否可以沒有副作用安全地評估查詢，您必須了解實作查詢的程式碼。</span><span class="sxs-lookup"><span data-stu-id="c7f61-123">To determine whether a query can be safely evaluated without side effects, you must understand the code that implements the query.</span></span> <span data-ttu-id="c7f61-124">如需詳細資訊，請參閱 <<c0> [ 副作用和運算式](https://msdn.microsoft.com/library/e1f8a6ea-9e19-481d-b6bd-df120ad3bf4e)。</span><span class="sxs-lookup"><span data-stu-id="c7f61-124">For more information, see [Side Effects and Expressions](https://msdn.microsoft.com/library/e1f8a6ea-9e19-481d-b6bd-df120ad3bf4e).</span></span>  
  
## <a name="edit-and-continue"></a><span data-ttu-id="c7f61-125">編輯後繼續</span><span class="sxs-lookup"><span data-stu-id="c7f61-125">Edit and Continue</span></span>  
 <span data-ttu-id="c7f61-126">編輯後繼續不支援變更[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]查詢。</span><span class="sxs-lookup"><span data-stu-id="c7f61-126">Edit and Continue does not support changes to [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] queries.</span></span> <span data-ttu-id="c7f61-127">如果您新增、 移除或變更[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]偵錯工作階段的陳述式，會出現一個對話方塊，告訴您的變更不支援編輯後繼續。</span><span class="sxs-lookup"><span data-stu-id="c7f61-127">If you add, remove, or change a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] statement during a debugging session, a dialog box appears that tells you the change is not supported by Edit and Continue.</span></span> <span data-ttu-id="c7f61-128">此時，您可以復原變更，或者是停止偵錯工作階段並使用編輯過的程式碼重新啟動新的工作階段。</span><span class="sxs-lookup"><span data-stu-id="c7f61-128">At that point, you can either undo the changes or stop the debugging session and restart a new session with the edited code.</span></span>  
  
 <span data-ttu-id="c7f61-129">此外，編輯後繼續 不支援變更類型或變數中所使用的值[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]陳述式。</span><span class="sxs-lookup"><span data-stu-id="c7f61-129">In addition, Edit and Continue does not support changing the type or the value of a variable that is used in a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] statement.</span></span> <span data-ttu-id="c7f61-130">同樣地，您可以復原變更，或者是停止並重新啟動偵錯工作階段。</span><span class="sxs-lookup"><span data-stu-id="c7f61-130">Again, you can either undo the changes or stop and restart the debugging session.</span></span>  
  
 <span data-ttu-id="c7f61-131">在 Visual C# 在 Visual Studio 中，您無法使用 編輯後繼續的方法中，包含任何程式碼上[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]查詢。</span><span class="sxs-lookup"><span data-stu-id="c7f61-131">In Visual C# in Visual Studio, you cannot use Edit and Continue on any code in a method that contains a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] query.</span></span>  
  
 <span data-ttu-id="c7f61-132">在 Visual Basic 在 Visual Studio 中，您可以使用 編輯後繼續非[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]程式碼，即使在包含方法[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]查詢。</span><span class="sxs-lookup"><span data-stu-id="c7f61-132">In Visual Basic in Visual Studio, you can use Edit and Continue on non-[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] code, even in a method that contains a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] query.</span></span> <span data-ttu-id="c7f61-133">您可以新增或移除程式碼，再[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]陳述式，即使這些變更會影響的行號[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]查詢。</span><span class="sxs-lookup"><span data-stu-id="c7f61-133">You can add or remove code before the [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] statement, even if the changes affect line number of the [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] query.</span></span> <span data-ttu-id="c7f61-134">Visual Basic 偵錯體驗，非[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]程式碼維持不變之前[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]引進。</span><span class="sxs-lookup"><span data-stu-id="c7f61-134">Your Visual Basic debugging experience for non-[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] code remains the same as it was before [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] was introduced.</span></span> <span data-ttu-id="c7f61-135">您無法變更、 新增或移除[!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]查詢，不過，除非您停止偵錯以套用所做的變更。</span><span class="sxs-lookup"><span data-stu-id="c7f61-135">You cannot change, add, or remove a [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] query, however, unless you stop debugging to apply the changes.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="c7f61-136">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c7f61-136">See also</span></span>
- [<span data-ttu-id="c7f61-137">偵錯 Managed 程式碼</span><span class="sxs-lookup"><span data-stu-id="c7f61-137">Debugging Managed Code</span></span>](/visualstudio/debugger/debugging-managed-code)
- [<span data-ttu-id="c7f61-138">程式設計手冊</span><span class="sxs-lookup"><span data-stu-id="c7f61-138">Programming Guide</span></span>](../../../../docs/framework/data/adonet/programming-guide-linq-to-dataset.md)
