---
title: 批次處理作業 (WCF 資料服務)
ms.date: 03/30/2017
helpviewer_keywords:
- WCF Data Services, client library
ms.assetid: 962a49d1-cc11-4b96-bc7d-071dd6607d6c
ms.openlocfilehash: 5284d1a3c2ea95e26eddd9c5617f09f299bda4f3
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33357857"
---
# <a name="batching-operations-wcf-data-services"></a><span data-ttu-id="46b85-102">批次處理作業 (WCF 資料服務)</span><span class="sxs-lookup"><span data-stu-id="46b85-102">Batching Operations (WCF Data Services)</span></span>
<span data-ttu-id="46b85-103">[!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)]支援以批次要求的處理[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]為基礎的服務。</span><span class="sxs-lookup"><span data-stu-id="46b85-103">The [!INCLUDE[ssODataFull](../../../../includes/ssodatafull-md.md)] supports batch processing of requests to an [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]-based service.</span></span> <span data-ttu-id="46b85-104">如需詳細資訊，請參閱[OData： 批次處理](http://go.microsoft.com/fwlink/?LinkId=186075)。</span><span class="sxs-lookup"><span data-stu-id="46b85-104">For more information, see [OData: Batch Processing](http://go.microsoft.com/fwlink/?LinkId=186075).</span></span> <span data-ttu-id="46b85-105">在[!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)]，會使用每個作業<xref:System.Data.Services.Client.DataServiceContext>，例如執行查詢，或儲存變更，正在傳送給資料服務的個別要求的結果。</span><span class="sxs-lookup"><span data-stu-id="46b85-105">In [!INCLUDE[ssAstoria](../../../../includes/ssastoria-md.md)], each operation that uses the <xref:System.Data.Services.Client.DataServiceContext>, such as executing a query or saving changes, results in a separate request being sent to the data service.</span></span> <span data-ttu-id="46b85-106">若要保持作業集的邏輯範圍，您可以明確地定義作業批次。</span><span class="sxs-lookup"><span data-stu-id="46b85-106">In order to maintain a logical scope for sets of operations, you can explicitly define operational batches.</span></span> <span data-ttu-id="46b85-107">這可確保批次中的所有作業，會傳送至單一 HTTP 要求中的資料服務，可讓伺服器以不可分割方式，處理作業，並減少往返次數至資料服務。</span><span class="sxs-lookup"><span data-stu-id="46b85-107">This ensures that all operations in the batch are sent to the data service in a single HTTP request, enables the server to process the operations atomically, and reduces the number of round trips to the data service.</span></span>  
  
## <a name="batching-query-operations"></a><span data-ttu-id="46b85-108">批次處理查詢作業</span><span class="sxs-lookup"><span data-stu-id="46b85-108">Batching Query Operations</span></span>  
 <span data-ttu-id="46b85-109">若要在單一批次中執行多個查詢，您必須將批次中的每個查詢建立為 <xref:System.Data.Services.Client.DataServiceRequest%601> 類別的個別執行個體。</span><span class="sxs-lookup"><span data-stu-id="46b85-109">To execute multiple queries in a single batch, you must create each query in the batch as a separate instance of the <xref:System.Data.Services.Client.DataServiceRequest%601> class.</span></span> <span data-ttu-id="46b85-110">當您利用這種方式建立查詢要求時，會將查詢本身定義為 URI，而且查詢會遵守定址資源的規則。</span><span class="sxs-lookup"><span data-stu-id="46b85-110">When you create a query request in this manner, the query itself is defined as a URI, and it follows the rules for addressing resources.</span></span> <span data-ttu-id="46b85-111">如需詳細資訊，請參閱[存取資料服務資源](../../../../docs/framework/data/wcf/accessing-data-service-resources-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="46b85-111">For more information, see [Accessing Data Service Resources](../../../../docs/framework/data/wcf/accessing-data-service-resources-wcf-data-services.md).</span></span> <span data-ttu-id="46b85-112">呼叫包含查詢要求物件的 <xref:System.Data.Services.Client.DataServiceContext.ExecuteBatch%2A> 方法時，會將批次的查詢要求傳送至資料服務。</span><span class="sxs-lookup"><span data-stu-id="46b85-112">The batched query requests are sent to the data service when the <xref:System.Data.Services.Client.DataServiceContext.ExecuteBatch%2A> method is called that contains the query request objects.</span></span> <span data-ttu-id="46b85-113">此方法會傳回 <xref:System.Data.Services.Client.DataServiceResponse> 物件，該物件是 <xref:System.Data.Services.Client.QueryOperationResponse%601> 物件集合，代表對批次中個別查詢的回應，其中每個物件均包含查詢傳回的物件集合或錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="46b85-113">This method returns a <xref:System.Data.Services.Client.DataServiceResponse> object, which is a collection of <xref:System.Data.Services.Client.QueryOperationResponse%601> objects that represent responses to individual queries in the batch, each of which contains either a collection of objects returned by the query or error information.</span></span> <span data-ttu-id="46b85-114">批次中的任何單一查詢失敗時，該作業的 <xref:System.Data.Services.Client.QueryOperationResponse%601> 物件中就會傳回與失敗作業相關的錯誤訊息，並且繼續執行其餘作業。</span><span class="sxs-lookup"><span data-stu-id="46b85-114">When any single query operation in the batch fails, error information is returned in the <xref:System.Data.Services.Client.QueryOperationResponse%601> object for the operation that failed and the remaining operations are still executed.</span></span> <span data-ttu-id="46b85-115">如需詳細資訊，請參閱[如何： 執行查詢批次中](../../../../docs/framework/data/wcf/how-to-execute-queries-in-a-batch-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="46b85-115">For more information, see [How to: Execute Queries in a Batch](../../../../docs/framework/data/wcf/how-to-execute-queries-in-a-batch-wcf-data-services.md).</span></span>  
  
 <span data-ttu-id="46b85-116">您也可以透過非同步方式執行批次查詢。</span><span class="sxs-lookup"><span data-stu-id="46b85-116">Batched queries can also be executed asynchronously.</span></span> <span data-ttu-id="46b85-117">如需詳細資訊，請參閱[非同步作業](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="46b85-117">For more information, see [Asynchronous Operations](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md).</span></span>  
  
## <a name="batching-the-savechanges-operation"></a><span data-ttu-id="46b85-118">批次處理 SaveChanges 作業</span><span class="sxs-lookup"><span data-stu-id="46b85-118">Batching the SaveChanges Operation</span></span>  
 <span data-ttu-id="46b85-119">當您呼叫<xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A>方法，追蹤會轉譯成以 REST 為基礎的作業，用做為傳送內容要求的所有變更[!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)]服務。</span><span class="sxs-lookup"><span data-stu-id="46b85-119">When you call the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%2A> method, all changes that the context tracks are translated into REST-based operations that are sent as requests to the [!INCLUDE[ssODataShort](../../../../includes/ssodatashort-md.md)] service.</span></span> <span data-ttu-id="46b85-120">根據預設，這些變更不會在單一要求訊息中傳送。</span><span class="sxs-lookup"><span data-stu-id="46b85-120">By default, these changes are not sent in a single request message.</span></span> <span data-ttu-id="46b85-121">若需要在單一要求中傳送的所有變更，您必須呼叫<xref:System.Data.Services.Client.DataServiceContext.SaveChanges%28System.Data.Services.Client.SaveChangesOptions%29>方法，並包含值為<xref:System.Data.Services.Client.SaveChangesOptions.Batch>中<xref:System.Data.Services.Client.SaveChangesOptions>提供給該方法的列舉。</span><span class="sxs-lookup"><span data-stu-id="46b85-121">To require that all changes be sent in a single request, you must call the <xref:System.Data.Services.Client.DataServiceContext.SaveChanges%28System.Data.Services.Client.SaveChangesOptions%29> method and include a value of <xref:System.Data.Services.Client.SaveChangesOptions.Batch> in the <xref:System.Data.Services.Client.SaveChangesOptions> enumeration that you supply to the method.</span></span>  
  
 <span data-ttu-id="46b85-122">您也可以透過非同步的方式儲存批次變更。</span><span class="sxs-lookup"><span data-stu-id="46b85-122">You can also asynchronously save batched changes.</span></span> <span data-ttu-id="46b85-123">如需詳細資訊，請參閱[非同步作業](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="46b85-123">For more information, see [Asynchronous Operations](../../../../docs/framework/data/wcf/asynchronous-operations-wcf-data-services.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="46b85-124">另請參閱</span><span class="sxs-lookup"><span data-stu-id="46b85-124">See Also</span></span>  
 [<span data-ttu-id="46b85-125">WCF Data Services 用戶端程式庫</span><span class="sxs-lookup"><span data-stu-id="46b85-125">WCF Data Services Client Library</span></span>](../../../../docs/framework/data/wcf/wcf-data-services-client-library.md)
