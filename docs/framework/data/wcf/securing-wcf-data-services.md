---
title: 保護 WCF Data Services 的安全
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- securing application [WCF Data Services]
- WCF Data Services, security
ms.assetid: 99fc2baa-a040-4549-bc4d-f683d60298af
ms.openlocfilehash: e09007e786772e838a9aaa76eb8ef7a3fe2b7cca
ms.sourcegitcommit: 7588136e355e10cbc2582f389c90c127363c02a5
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/12/2020
ms.locfileid: "79174650"
---
# <a name="securing-wcf-data-services"></a><span data-ttu-id="8901b-102">保護 WCF Data Services 的安全</span><span class="sxs-lookup"><span data-stu-id="8901b-102">Securing WCF Data Services</span></span>
<span data-ttu-id="8901b-103">本主題介紹特定于開發、部署和運行 WCF 資料服務和訪問支援開放資料協定 （OData） 的服務的應用程式的安全注意事項。</span><span class="sxs-lookup"><span data-stu-id="8901b-103">This topic describes security considerations that are specific to developing, deploying, and running WCF Data Services and applications that access services that support the Open Data Protocol (OData).</span></span> <span data-ttu-id="8901b-104">您還應遵循有關創建安全 .NET 框架應用程式的建議。</span><span class="sxs-lookup"><span data-stu-id="8901b-104">You should also follow recommendations for creating secure .NET Framework applications.</span></span>  
  
<span data-ttu-id="8901b-105">在規劃如何保護基於 WCF 資料服務的 OData 服務時，必須同時解決身份驗證、發現和驗證主體身份的過程以及授權，以確定經過身份驗證的委託人是否允許訪問請求的資源。</span><span class="sxs-lookup"><span data-stu-id="8901b-105">When planning how to secure a WCF Data Services-based OData service, you must address both authentication, the process of discovering and verifying the identity of a principal, and authorization, the process of determining whether an authenticated principal is allowed to access the requested resources.</span></span> <span data-ttu-id="8901b-106">您也應該考慮是否要使用 SSL 加密訊息。</span><span class="sxs-lookup"><span data-stu-id="8901b-106">You should also consider whether to encrypt the message by using SSL.</span></span>  
  
## <a name="authenticating-client-requests"></a><span data-ttu-id="8901b-107">驗證用戶端要求</span><span class="sxs-lookup"><span data-stu-id="8901b-107">Authenticating Client Requests</span></span>  
<span data-ttu-id="8901b-108">WCF 資料服務不實現自己的任何類型的身份驗證，而是依賴于資料服務主機的身份驗證規定。</span><span class="sxs-lookup"><span data-stu-id="8901b-108">WCF Data Services does not implement any kind of authentication of its own, but rather relies on the authentication provisions of the data service host.</span></span> <span data-ttu-id="8901b-109">這意味著服務假定它收到的任何請求已由網路主機進行身份驗證，並且主機已通過 WCF 資料服務提供的介面正確標識了請求的原則。</span><span class="sxs-lookup"><span data-stu-id="8901b-109">This means that the service assumes that any request that it receives has already been authenticated by the network host and that the host has correctly identified the principle for the request appropriately via the interfaces provided by WCF Data Services.</span></span> <span data-ttu-id="8901b-110">這些身份驗證選項和方法在多部分[OData 和身份驗證系列中](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22)進行了詳細說明。</span><span class="sxs-lookup"><span data-stu-id="8901b-110">These authentication options and approaches are detailed in the multipart [OData and Authentication series](https://devblogs.microsoft.com/odata/?s=%22OData+and+authentication%22).</span></span>  
  
### <a name="authentication-options-for-a-wcf-data-service"></a><span data-ttu-id="8901b-111">用於 WCF Data Service 的驗證選項</span><span class="sxs-lookup"><span data-stu-id="8901b-111">Authentication Options for a WCF Data Service</span></span>  
 <span data-ttu-id="8901b-112">下表列出了一些驗證機制，可協助您驗證 WCF Data Service 的要求。</span><span class="sxs-lookup"><span data-stu-id="8901b-112">The following table lists some of the authentication mechanisms that are available to help you authenticate requests to a WCF Data Service.</span></span>  
  
|<span data-ttu-id="8901b-113">驗證選項</span><span class="sxs-lookup"><span data-stu-id="8901b-113">Authentication Options</span></span>|<span data-ttu-id="8901b-114">描述</span><span class="sxs-lookup"><span data-stu-id="8901b-114">Description</span></span>|  
|----------------------------|-----------------|  
|<span data-ttu-id="8901b-115">匿名驗證</span><span class="sxs-lookup"><span data-stu-id="8901b-115">Anonymous authentication</span></span>|<span data-ttu-id="8901b-116">啟用 HTTP 匿名驗證時，任何原則都可以連線至資料服務。</span><span class="sxs-lookup"><span data-stu-id="8901b-116">When HTTP anonymous authentication is enabled, any principle is able to connect to the data service.</span></span> <span data-ttu-id="8901b-117">匿名存取不需要認證。</span><span class="sxs-lookup"><span data-stu-id="8901b-117">Credentials are not required for anonymous access.</span></span> <span data-ttu-id="8901b-118">只有在您想要允許任何人存取資料服務時，才使用此選項。</span><span class="sxs-lookup"><span data-stu-id="8901b-118">Use this option only when you want to allow anyone to access the data service.</span></span>|  
|<span data-ttu-id="8901b-119">基本和摘要式驗證</span><span class="sxs-lookup"><span data-stu-id="8901b-119">Basic and digest authentication</span></span>|<span data-ttu-id="8901b-120">驗證需要使用者名稱和密碼所組成的認證。</span><span class="sxs-lookup"><span data-stu-id="8901b-120">Credentials consisting of a user name and password are required for authentication.</span></span> <span data-ttu-id="8901b-121">支援非 Windows 用戶端的驗證。</span><span class="sxs-lookup"><span data-stu-id="8901b-121">Supports authentication of non-Windows clients.</span></span> <span data-ttu-id="8901b-122">**安全記事：** 基本驗證憑據（使用者名和密碼）以明明的方式發送，可以截獲。</span><span class="sxs-lookup"><span data-stu-id="8901b-122">**Security Note:**  Basic authentication credentials (user name and password) are sent in the clear and can be intercepted.</span></span> <span data-ttu-id="8901b-123">摘要式驗證會根據所提供的認證傳送雜湊，這讓它比基本驗證更安全。</span><span class="sxs-lookup"><span data-stu-id="8901b-123">Digest authentication sends a hash based-on the supplied credentials, which makes it more secure than basic authentication.</span></span> <span data-ttu-id="8901b-124">兩者都很容易受到攔截式攻擊。</span><span class="sxs-lookup"><span data-stu-id="8901b-124">Both are susceptible to man-in-the-middle attacks.</span></span> <span data-ttu-id="8901b-125">使用這些驗證方法時，您應該考慮使用安全通訊端層 (SSL)，加密用戶端與資料服務之間的通訊。</span><span class="sxs-lookup"><span data-stu-id="8901b-125">When using these authentication methods, you should consider encrypting communication between client and the data service by using the Secure Sockets Layer (SSL).</span></span> <br /><br /> <span data-ttu-id="8901b-126">Microsoft 互聯網資訊服務 （IIS） 為ASP.NET應用程式中的 HTTP 要求提供了基本驗證和摘要身份驗證的實現。</span><span class="sxs-lookup"><span data-stu-id="8901b-126">Microsoft Internet Information Services (IIS) provides an implementation of both basic and digest authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="8901b-127">這個 Windows 驗證提供者實作可讓 .NET Framework 用戶端應用程式將要求之 HTTP 標頭中的認證提供給資料服務，以便密切地交涉 Windows 使用者的驗證。</span><span class="sxs-lookup"><span data-stu-id="8901b-127">This Windows Authentication Provider implementation enables a .NET Framework client application to supply credentials in the HTTP header of the request to the data service to seamlessly negotiate authentication of a Windows user.</span></span> <span data-ttu-id="8901b-128">有關詳細資訊，請參閱[摘要身份驗證技術參考](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc782794(v=ws.10))。</span><span class="sxs-lookup"><span data-stu-id="8901b-128">For more information, see [Digest Authentication Technical Reference](https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2003/cc782794(v=ws.10)).</span></span><br /><br /> <span data-ttu-id="8901b-129">當希望資料服務使用基於某些自訂身份驗證服務而不是 Windows 憑據的基本驗證時，必須實現自訂ADP.NET HTTP 模組進行身份驗證。</span><span class="sxs-lookup"><span data-stu-id="8901b-129">When you want to have your data service use basic authentication based on some custom authentication service and not Windows credentials, you must implement a custom ADP.NET HTTP Module for authentication.</span></span><br /><br /> <span data-ttu-id="8901b-130">有關如何將自訂基本驗證方案與 WCF 資料服務一起使用的示例，請參閱博客文章[OData 和身份驗證 + 第 6 部分 = 自訂基本驗證](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/)。</span><span class="sxs-lookup"><span data-stu-id="8901b-130">For an example of how to use a custom basic authentication scheme with WCF Data Services, see the blog post [OData and Authentication – Part 6 – Custom Basic Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-6-custom-basic-authentication/).</span></span>|  
|<span data-ttu-id="8901b-131">Windows 驗證</span><span class="sxs-lookup"><span data-stu-id="8901b-131">Windows authentication</span></span>|<span data-ttu-id="8901b-132">Windows 型認證是使用 NTLM 或 Kerberos 交換。</span><span class="sxs-lookup"><span data-stu-id="8901b-132">Windows-based credentials are exchanged by using NTLM or Kerberos.</span></span> <span data-ttu-id="8901b-133">此機制比基本或摘要式驗證更安全，但它需要用戶端是 Windows 架構的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8901b-133">This mechanism is more secure than basic or digest authentication, but it requires that the client be a Windows-based application.</span></span> <span data-ttu-id="8901b-134">IIS 還為ASP.NET應用程式中的 HTTP 要求提供了 Windows 身份驗證的實現。</span><span class="sxs-lookup"><span data-stu-id="8901b-134">IIS also provides an implementation of Windows authentication for HTTP requests in an ASP.NET application.</span></span> <span data-ttu-id="8901b-135">有關詳細資訊，請參閱[ASP.NET表單身份驗證概述](https://docs.microsoft.com/previous-versions/aspnet/7t6b43z4(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="8901b-135">For more information, see [ASP.NET Forms Authentication Overview](https://docs.microsoft.com/previous-versions/aspnet/7t6b43z4(v=vs.100)).</span></span><br /><br /> <span data-ttu-id="8901b-136">有關如何將 Windows 身份驗證與 WCF 資料服務一起使用的示例，請參閱博客文章[OData 和身份驗證 + 第 2 部分 + Windows 身份驗證](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/)。</span><span class="sxs-lookup"><span data-stu-id="8901b-136">For an example of how to use Windows authentication with WCF Data Services, see the blog post [OData and Authentication – Part 2 – Windows Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-2-windows-authentication/).</span></span>|  
|<span data-ttu-id="8901b-137">ASP.NET表單身份驗證</span><span class="sxs-lookup"><span data-stu-id="8901b-137">ASP.NET forms authentication</span></span>|<span data-ttu-id="8901b-138">表單驗證可讓您使用自己的程式碼來驗證使用者，然後在 Cookie 或網頁 URL 中維護驗證語彙基元 (Token)。</span><span class="sxs-lookup"><span data-stu-id="8901b-138">Forms authentication lets you authenticate users by using your own code and then maintain an authentication token in a cookie or in the page URL.</span></span> <span data-ttu-id="8901b-139">您可以使用您所建立的登入表單驗證使用者的使用者名稱和密碼。</span><span class="sxs-lookup"><span data-stu-id="8901b-139">You authenticate the user name and password of your users using a login form that you create.</span></span> <span data-ttu-id="8901b-140">未經驗證的要求會重新導向至登入頁面，使用者可在此處提供認證和送出表單。</span><span class="sxs-lookup"><span data-stu-id="8901b-140">Unauthenticated requests are redirected to a login page, where the user provides credentials and submits the form.</span></span> <span data-ttu-id="8901b-141">如果應用程式驗證了要求，則系統會發出包含金鑰的票證，用於重新建立後續要求的身分識別。</span><span class="sxs-lookup"><span data-stu-id="8901b-141">If the application authenticates the request, the system issues a ticket that contains a key for reestablishing the identity for subsequent requests.</span></span> <span data-ttu-id="8901b-142">有關詳細資訊，請參閱[表單身份檢查器提供者](https://docs.microsoft.com/previous-versions/aspnet/9wff0kyh(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="8901b-142">For more information, see [Forms Authentication Provider](https://docs.microsoft.com/previous-versions/aspnet/9wff0kyh(v=vs.100)).</span></span> <span data-ttu-id="8901b-143">**安全記事：** 預設情況下，在 ASP.NET Web 應用程式中使用表單身份驗證時，包含表單身份驗證票證的 Cookie 不受保護。</span><span class="sxs-lookup"><span data-stu-id="8901b-143">**Security Note:**  By default, the cookie that contains the forms authentication ticket is not secured when you use forms authentication in a ASP.NET Web application.</span></span> <span data-ttu-id="8901b-144">您應該考慮要求 SSL 同時保護驗證票證和初始登入認證。</span><span class="sxs-lookup"><span data-stu-id="8901b-144">You should consider requiring SSL to protect both the authentication ticket and the initial login credentials.</span></span> <br /><br /> <span data-ttu-id="8901b-145">有關如何將表單身份驗證與 WCF 資料服務一起使用的示例，請參閱博客文章[OData 和身份驗證 – 第 7 部分 = 表單身份驗證](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/)。</span><span class="sxs-lookup"><span data-stu-id="8901b-145">For an example of how to use forms authentication with WCF Data Services, see the blog post [OData and Authentication – Part 7 – Forms Authentication](https://devblogs.microsoft.com/odata/odata-and-authentication-part-7-forms-authentication/).</span></span>|  
|<span data-ttu-id="8901b-146">宣告架構驗證</span><span class="sxs-lookup"><span data-stu-id="8901b-146">Claims-based authentication</span></span>|<span data-ttu-id="8901b-147">在基於聲明的身份驗證中，資料服務依賴于受信任的"協力廠商"標識提供程式服務來對使用者進行身份驗證。</span><span class="sxs-lookup"><span data-stu-id="8901b-147">In claims-based authentication, the data service relies on a trusted "third-party" identity provider service to authenticate the user.</span></span> <span data-ttu-id="8901b-148">身分識別提供者會明確地驗證要求資料服務資源之存取權的使用者，並發出授與要求資源之存取權的語彙基元。</span><span class="sxs-lookup"><span data-stu-id="8901b-148">The identity provider positively authenticates the user that is requesting access to data service resources and issues a token that grants access to the requested resources.</span></span> <span data-ttu-id="8901b-149">接著，系統會向資料服務呈現此權杖，然後根據與發出存取權杖之身分識別服務的信任關係，授與存取權給使用者。</span><span class="sxs-lookup"><span data-stu-id="8901b-149">This token is then presented to the data service, which then grants access to the user based on the trust relationship with the identity service that issued the access token.</span></span><br /><br /> <span data-ttu-id="8901b-150">使用宣告架構驗證提供者的優點是，它們可以跨信任網域，用來驗證各種不同類型的用戶端。</span><span class="sxs-lookup"><span data-stu-id="8901b-150">The benefit of using a claims-based authentication provider is that they can be used to authenticate various types of clients across trust domains.</span></span> <span data-ttu-id="8901b-151">資料服務可以採用此種協力廠商提供者，來卸載維護和驗證使用者的需求。</span><span class="sxs-lookup"><span data-stu-id="8901b-151">By employing such a third-party provider, a data service can offload the requirements of maintaining and authenticating users.</span></span> <span data-ttu-id="8901b-152">OAuth 2.0 是 Microsoft Azure AppFabric 存取控制所支援的宣告架構驗證通訊協定，以服務的方式用於聯盟授權。</span><span class="sxs-lookup"><span data-stu-id="8901b-152">OAuth 2.0 is a claims-based authentication protocol that is supported by Windows Azure AppFabric Access Control for federated authorization as a service.</span></span> <span data-ttu-id="8901b-153">此通訊協定支援 REST 型服務。</span><span class="sxs-lookup"><span data-stu-id="8901b-153">This protocol supports REST-based services.</span></span> <span data-ttu-id="8901b-154">有關如何將 OAuth 2.0 與 WCF 資料服務一起使用的示例，請參閱博客文章[OData 和身份驗證 – 第 8 部分 • OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/)。</span><span class="sxs-lookup"><span data-stu-id="8901b-154">For an example of how to use OAuth 2.0 with WCF Data Services, see the blog post [OData and Authentication – Part 8 – OAuth WRAP](https://devblogs.microsoft.com/odata/odata-and-authentication-part-8-oauth-wrap/).</span></span>|  
  
<a name="clientAuthentication"></a>
### <a name="authentication-in-the-client-library"></a><span data-ttu-id="8901b-155">用戶端程式庫中的驗證</span><span class="sxs-lookup"><span data-stu-id="8901b-155">Authentication in the Client Library</span></span>  
 <span data-ttu-id="8901b-156">預設情況下，WCF 資料服務用戶端庫在向 OData 服務發出請求時不提供憑據。</span><span class="sxs-lookup"><span data-stu-id="8901b-156">By default, the WCF Data Services client library does not supply credentials when making a request to an OData service.</span></span> <span data-ttu-id="8901b-157">當資料服務需要登入認證來驗證使用者時，這些認證可以在從 <xref:System.Net.NetworkCredential> 之 <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> 屬性存取的 <xref:System.Data.Services.Client.DataServiceContext> 中提供，如以下範例所示：</span><span class="sxs-lookup"><span data-stu-id="8901b-157">When login credentials are required by the data service to authenticate a user, these credentials can be supplied in a <xref:System.Net.NetworkCredential> accessed from the <xref:System.Data.Services.Client.DataServiceContext.Credentials%2A> property of the <xref:System.Data.Services.Client.DataServiceContext>, as in the following example:</span></span>  
  
```csharp  
// Set the client authentication credentials.  
context.Credentials =  
    new NetworkCredential(userName, password, domain);  
```  
  
```vb  
' Set the client authentication credentials.  
context.Credentials = _  
    New NetworkCredential(userName, password, domain)  
```  
  
 <span data-ttu-id="8901b-158">有關詳細資訊，請參閱[：為數據服務請求指定用戶端憑據](specify-client-creds-for-a-data-service-request-wcf.md)。</span><span class="sxs-lookup"><span data-stu-id="8901b-158">For more information, see [How to: Specify Client Credentials for a Data Service Request](specify-client-creds-for-a-data-service-request-wcf.md).</span></span>  
  
 <span data-ttu-id="8901b-159">當資料服務需要無法使用 <xref:System.Net.NetworkCredential> 物件指定的登入認證 (例如宣告架構語彙基元或 Cookie) 時，您必須在 HTTP 要求中手動設定標頭，這通常是 `Authorization` 和 `Cookie` 標頭。</span><span class="sxs-lookup"><span data-stu-id="8901b-159">When the data service requires login credentials that cannot be specified by using a <xref:System.Net.NetworkCredential> object, such as a claims-based token or cookie, you must manually set headers in the HTTP request, usually the `Authorization` and `Cookie` headers.</span></span> <span data-ttu-id="8901b-160">有關此類身份驗證方案的詳細資訊，請參閱博客文章[OData 和身份驗證 – 第 3 部分 – 用戶端掛鉤](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/)。</span><span class="sxs-lookup"><span data-stu-id="8901b-160">For more information about this kind of authentication scenario, see the blog post [ OData and Authentication – Part 3 – ClientSide Hooks](https://devblogs.microsoft.com/odata/odata-and-authentication-part-3-clientside-hooks/).</span></span> <span data-ttu-id="8901b-161">有關如何在請求消息中設置 HTTP 標頭的示例，請參閱[如何：在用戶端請求中設置標頭](how-to-set-headers-in-the-client-request-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="8901b-161">For an example of how to set HTTP headers in a request message, see [How to: Set Headers in the Client Request](how-to-set-headers-in-the-client-request-wcf-data-services.md).</span></span>  
  
## <a name="impersonation"></a><span data-ttu-id="8901b-162">模擬</span><span class="sxs-lookup"><span data-stu-id="8901b-162">Impersonation</span></span>  
 <span data-ttu-id="8901b-163">一般而言，資料服務會使用裝載資料服務之背景工作處理序的認證來存取所需的資源，例如伺服器或資料庫上的檔案。</span><span class="sxs-lookup"><span data-stu-id="8901b-163">Generally, the data service accesses required resources, such as files on the server or a database, by using the credentials of the worker process that is hosting the data service.</span></span> <span data-ttu-id="8901b-164">使用類比時，ASP.NET應用程式可以使用發出請求的使用者的 Windows 標識（使用者帳戶）執行。</span><span class="sxs-lookup"><span data-stu-id="8901b-164">When using impersonation, ASP.NET applications can execute with the Windows identity (user account) of the user making the request.</span></span> <span data-ttu-id="8901b-165">模擬常用於依賴 IIS 驗證使用者，而且此原則的認證用來存取必要資源的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8901b-165">Impersonation is commonly used in applications that rely on IIS to authenticate the user, and the credentials of this principle are used to access the required resources.</span></span> <span data-ttu-id="8901b-166">有關詳細資訊，請參閱[ASP.NET類比](https://docs.microsoft.com/previous-versions/aspnet/xh507fc5(v=vs.100))。</span><span class="sxs-lookup"><span data-stu-id="8901b-166">For more information, see [ASP.NET Impersonation](https://docs.microsoft.com/previous-versions/aspnet/xh507fc5(v=vs.100)).</span></span>  
  
## <a name="configuring-data-service-authorization"></a><span data-ttu-id="8901b-167">設定資料服務授權</span><span class="sxs-lookup"><span data-stu-id="8901b-167">Configuring Data Service Authorization</span></span>  
 <span data-ttu-id="8901b-168">授權是將應用程式資源的存取權授與根據先前成功驗證所識別的原則或過程。</span><span class="sxs-lookup"><span data-stu-id="8901b-168">Authorization is the granting of access to application resources to a principle or process that is identified based on a previously successful authentication.</span></span> <span data-ttu-id="8901b-169">一般的作法是，您應該只授與足夠的權限給資料服務的使用者來執行用戶端應用程式所需的作業。</span><span class="sxs-lookup"><span data-stu-id="8901b-169">As a general practice, you should only grant sufficient rights to users of the data service to perform the operations required by client applications.</span></span>  
  
### <a name="restrict-access-to-data-service-resources"></a><span data-ttu-id="8901b-170">限制資料服務資源的存取</span><span class="sxs-lookup"><span data-stu-id="8901b-170">Restrict Access to Data Service Resources</span></span>  
 <span data-ttu-id="8901b-171">預設情況下，WCF 資料服務使您能夠向能夠訪問資料服務的任何使用者授予針對資料服務資源（實體集和服務操作）的通用讀取和寫入存取權限。</span><span class="sxs-lookup"><span data-stu-id="8901b-171">By default, WCF Data Services enables you to grant common read and write access against data service resources (entity set and service operations) to any user that is able to access the data service.</span></span> <span data-ttu-id="8901b-172">定義讀取和寫入權限的規則可以針對資料服務所公開的每個實體，以及公開到任何服務作業的每個實體個別定義。</span><span class="sxs-lookup"><span data-stu-id="8901b-172">Rules that define read and write access can be defined separately for each entity set exposed by the data service, as well as to any service operations.</span></span> <span data-ttu-id="8901b-173">建議您同時將讀取和寫入權限僅限為用戶端應用程式所需的資源。</span><span class="sxs-lookup"><span data-stu-id="8901b-173">We recommend limiting both read and write access to only the resources required by the client application.</span></span> <span data-ttu-id="8901b-174">有關詳細資訊，請參閱[最低資源訪問要求](configuring-the-data-service-wcf-data-services.md#accessRequirements)。</span><span class="sxs-lookup"><span data-stu-id="8901b-174">For more information, see [Minimum Resource Access Requirements](configuring-the-data-service-wcf-data-services.md#accessRequirements).</span></span>  
  
### <a name="implement-role-based-interceptors"></a><span data-ttu-id="8901b-175">實作以角色為基礎的攔截器</span><span class="sxs-lookup"><span data-stu-id="8901b-175">Implement Role-Based Interceptors</span></span>  
 <span data-ttu-id="8901b-176">攔截器可讓您在資料服務實際運作之前，攔截對資料服務資源的要求。</span><span class="sxs-lookup"><span data-stu-id="8901b-176">Interceptors enable you to intercept requests against data service resources before they are acted on by the data service.</span></span> <span data-ttu-id="8901b-177">有關詳細資訊，請參閱[攔截器](interceptors-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="8901b-177">For more information, see [Interceptors](interceptors-wcf-data-services.md).</span></span> <span data-ttu-id="8901b-178">攔截器可讓您根據提出要求的已驗證使用者進行授權決策。</span><span class="sxs-lookup"><span data-stu-id="8901b-178">Interceptors enable you to make authorization decisions based the authenticated user that is making the request.</span></span> <span data-ttu-id="8901b-179">有關如何根據經過身份驗證的使用者標識限制對資料服務資源的訪問的示例，請參閱[如何：攔截資料服務消息](how-to-intercept-data-service-messages-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="8901b-179">For an example of how to restrict access to data service resources based on an authenticated user identity, see [How to: Intercept Data Service Messages](how-to-intercept-data-service-messages-wcf-data-services.md).</span></span>  
  
### <a name="restrict-access-to-the-persisted-data-store-and-local-resources"></a><span data-ttu-id="8901b-180">限制已保存之資料存放區和本機資源的存取</span><span class="sxs-lookup"><span data-stu-id="8901b-180">Restrict Access to the Persisted Data Store and Local Resources</span></span>  
 <span data-ttu-id="8901b-181">用來存取已保存之存放區的帳戶應該僅被授與資料庫或檔案系統中的足夠權限來支援資料服務的需求。</span><span class="sxs-lookup"><span data-stu-id="8901b-181">The accounts that are used to access the persisted store should be granted only enough rights in a database or the file system to support the requirements of the data service.</span></span> <span data-ttu-id="8901b-182">使用匿名驗證時，這是用來執行裝載應用程式的帳戶。</span><span class="sxs-lookup"><span data-stu-id="8901b-182">When anonymous authentication is used, this is the account used to run the hosting application.</span></span> <span data-ttu-id="8901b-183">如需詳細資訊，請參閱 [How to: Develop a WCF Data Service Running on IIS](how-to-develop-a-wcf-data-service-running-on-iis.md)。</span><span class="sxs-lookup"><span data-stu-id="8901b-183">For more information, see [How to: Develop a WCF Data Service Running on IIS](how-to-develop-a-wcf-data-service-running-on-iis.md).</span></span> <span data-ttu-id="8901b-184">使用模擬時，必須將這些資源的存取權授與已驗證的使用者，通常是做為 Windows 群組的一部分。</span><span class="sxs-lookup"><span data-stu-id="8901b-184">When impersonation is used, authenticated users must be granted access to these resources, usually as part of a Windows group.</span></span>  
  
## <a name="other-security-considerations"></a><span data-ttu-id="8901b-185">其他安全性考量</span><span class="sxs-lookup"><span data-stu-id="8901b-185">Other Security Considerations</span></span>  
  
### <a name="secure-the-data-in-the-payload"></a><span data-ttu-id="8901b-186">保護裝載中資料的安全</span><span class="sxs-lookup"><span data-stu-id="8901b-186">Secure the Data in the Payload</span></span>  
<span data-ttu-id="8901b-187">OData 基於 HTTP 協定。</span><span class="sxs-lookup"><span data-stu-id="8901b-187">OData is based on the HTTP protocol.</span></span> <span data-ttu-id="8901b-188">在 HTTP 訊息中，根據資料服務實作的驗證，標頭可能包含寶貴的使用者認證。</span><span class="sxs-lookup"><span data-stu-id="8901b-188">In an HTTP message, the header may contain valuable user credentials, depending on the authentication implemented by the data service.</span></span> <span data-ttu-id="8901b-189">訊息主體可能也包含必須受到保護的寶貴客戶資料。</span><span class="sxs-lookup"><span data-stu-id="8901b-189">The message body may also contain valuable customer data that must be protected.</span></span> <span data-ttu-id="8901b-190">在這兩種情況下，建議您使用 SSL 透過網路傳輸保護這項資訊。</span><span class="sxs-lookup"><span data-stu-id="8901b-190">In both of these cases, we recommend that you use SSL to protect this information over the wire.</span></span>  
  
### <a name="ignored-message-headers-and-cookies"></a><span data-ttu-id="8901b-191">已忽略的訊息標頭和 Cookie</span><span class="sxs-lookup"><span data-stu-id="8901b-191">Ignored Message Headers and Cookies</span></span>  
 <span data-ttu-id="8901b-192">資料服務會忽略，而且絕不會設定宣告內容類型與資源位置以外之標頭的 HTTP 要求標頭。</span><span class="sxs-lookup"><span data-stu-id="8901b-192">HTTP request headers, other than those that declare content types and resource locations, are ignored and are never set by the data service.</span></span>  
  
 <span data-ttu-id="8901b-193">Cookie 可用作身份驗證方案的一部分，例如與ASP.NET表單身份驗證一起使用。</span><span class="sxs-lookup"><span data-stu-id="8901b-193">Cookies can be used as part of an authentication scheme, such as with ASP.NET Forms Authentication.</span></span> <span data-ttu-id="8901b-194">但是，WCF 資料服務會忽略在傳入請求上設置的任何 HTTP Cookie。</span><span class="sxs-lookup"><span data-stu-id="8901b-194">However, any HTTP cookies set on an incoming request are ignored by WCF DataServices.</span></span> <span data-ttu-id="8901b-195">資料服務的主機可能會處理 Cookie，但 WCF 資料服務運行時從不分析或返回 Cookie。</span><span class="sxs-lookup"><span data-stu-id="8901b-195">The host of a data service may process the cookie, but the WCF Data Services runtime never analyzes or returns cookies.</span></span> <span data-ttu-id="8901b-196">WCF 資料服務用戶端庫也不會處理回應中發送的 Cookie。</span><span class="sxs-lookup"><span data-stu-id="8901b-196">The WCF Data Services client library also does not process cookies sent in the response.</span></span>  
  
### <a name="custom-hosting-requirements"></a><span data-ttu-id="8901b-197">自訂裝載需求</span><span class="sxs-lookup"><span data-stu-id="8901b-197">Custom Hosting Requirements</span></span>  
 <span data-ttu-id="8901b-198">預設情況下，WCF 資料服務創建為 IIS 中託管ASP.NET應用程式。</span><span class="sxs-lookup"><span data-stu-id="8901b-198">By default, WCF Data Services is created as an ASP.NET application hosted in IIS.</span></span> <span data-ttu-id="8901b-199">這可讓資料服務運用此平台的安全行為。</span><span class="sxs-lookup"><span data-stu-id="8901b-199">This enables the data service to leverage the secure behaviors of this platform.</span></span> <span data-ttu-id="8901b-200">您可以定義由自訂主機託管的 WCF 資料服務。</span><span class="sxs-lookup"><span data-stu-id="8901b-200">You can define WCF Data Services that are hosted by a custom host.</span></span> <span data-ttu-id="8901b-201">有關詳細資訊，請參閱[託管資料服務](hosting-the-data-service-wcf-data-services.md)。</span><span class="sxs-lookup"><span data-stu-id="8901b-201">For more information, see [Hosting the Data Service](hosting-the-data-service-wcf-data-services.md).</span></span> <span data-ttu-id="8901b-202">裝載資料服務的元件和平台必須確定下列安全性行為，以防止資料服務的攻擊：</span><span class="sxs-lookup"><span data-stu-id="8901b-202">The components and platform hosting a data service must ensure the following security behaviors to prevent attacks on the data service:</span></span>  
  
- <span data-ttu-id="8901b-203">限制所有可能作業之資料服務要求中接受的 URI 長度。</span><span class="sxs-lookup"><span data-stu-id="8901b-203">Limit the length of the URI accepted in a data service request for all possible operations.</span></span>  
  
- <span data-ttu-id="8901b-204">限制傳入與傳出之 HTTP 訊息的大小。</span><span class="sxs-lookup"><span data-stu-id="8901b-204">Limit the size of both incoming and outgoing HTTP messages.</span></span>  
  
- <span data-ttu-id="8901b-205">限制在任何指定時間的未完成要求總數。</span><span class="sxs-lookup"><span data-stu-id="8901b-205">Limit the total number of outstanding requests at any given time.</span></span>  
  
- <span data-ttu-id="8901b-206">限制 HTTP 標頭的大小及其值，並提供 WCF 資料服務對標頭資料的訪問。</span><span class="sxs-lookup"><span data-stu-id="8901b-206">Limit the size of HTTP headers and their values, and provide WCF Data Services access to header data.</span></span>  
  
- <span data-ttu-id="8901b-207">偵測並還擊已知的攻擊，如 TCP SYN 和訊息重新執行攻擊。</span><span class="sxs-lookup"><span data-stu-id="8901b-207">Detect and counter known attacks, such as TCP SYN and message replay attacks.</span></span>  
  
### <a name="values-are-not-further-encoded"></a><span data-ttu-id="8901b-208">值不會進一步編碼</span><span class="sxs-lookup"><span data-stu-id="8901b-208">Values Are Not Further Encoded</span></span>  
 <span data-ttu-id="8901b-209">發送到資料服務的屬性值不會由 WCF 資料服務運行時進一步編碼。</span><span class="sxs-lookup"><span data-stu-id="8901b-209">Property values sent to the data service are not further encoded by the WCF Data Services runtime.</span></span> <span data-ttu-id="8901b-210">例如，當實體的字串屬性包含 HTML 格式的內容時，資料服務不會以 HTML 編碼標記。</span><span class="sxs-lookup"><span data-stu-id="8901b-210">For example, when a string property of an entity contains formatted HTML content, the tags are not HTML encoded by the data service.</span></span> <span data-ttu-id="8901b-211">資料服務也不會進一步編碼回應中的屬性值。</span><span class="sxs-lookup"><span data-stu-id="8901b-211">The data service also does not further encode property values in the response.</span></span> <span data-ttu-id="8901b-212">用戶端程式庫也不會執行任何額外的編碼。</span><span class="sxs-lookup"><span data-stu-id="8901b-212">The client library also does not perform any additional encoding.</span></span>  
  
### <a name="considerations-for-client-applications"></a><span data-ttu-id="8901b-213">用戶端應用程式的考量</span><span class="sxs-lookup"><span data-stu-id="8901b-213">Considerations for Client Applications</span></span>  
 <span data-ttu-id="8901b-214">以下安全注意事項適用于使用 WCF 資料服務用戶端存取 OData 服務的應用程式：</span><span class="sxs-lookup"><span data-stu-id="8901b-214">The following security considerations apply to applications that use the WCF Data Services client to access OData services:</span></span>  
  
- <span data-ttu-id="8901b-215">用戶端程式庫假設用來存取資料服務的通訊協定會提供適當的安全性層級。</span><span class="sxs-lookup"><span data-stu-id="8901b-215">The client library assumes that the protocols used to access the data service provide an appropriate level of security.</span></span>  
  
- <span data-ttu-id="8901b-216">用戶端程式庫會針對基礎平台提供之傳輸堆疊的逾時和剖析選項，使用所有預設值。</span><span class="sxs-lookup"><span data-stu-id="8901b-216">The client library uses all the default values for timeouts and parsing options of the underlying platform-provided transport stacks.</span></span>  
  
- <span data-ttu-id="8901b-217">用戶端程式庫不會從應用程式組態檔讀取任何設定。</span><span class="sxs-lookup"><span data-stu-id="8901b-217">The client library does not read any settings from application configuration files.</span></span>  
  
- <span data-ttu-id="8901b-218">用戶端程式庫不會實作任何跨網域存取機制。</span><span class="sxs-lookup"><span data-stu-id="8901b-218">The client library does not implement any cross domain access mechanisms.</span></span> <span data-ttu-id="8901b-219">但是，它會依賴基礎 HTTP 堆疊所提供的機制。</span><span class="sxs-lookup"><span data-stu-id="8901b-219">Instead, it relies on the mechanisms provided by the underlying HTTP stack.</span></span>  
  
- <span data-ttu-id="8901b-220">用戶端程式庫沒有使用者介面項目，因此，絕不會嘗試顯示或呈現它所接收或傳送的資料。</span><span class="sxs-lookup"><span data-stu-id="8901b-220">The client library has no user interface elements, and it never tries to display or render the data that it receives or sends.</span></span>  
  
- <span data-ttu-id="8901b-221">建議用戶端應用程式一律驗證使用者輸入，以及接受自不受信任之服務的資料。</span><span class="sxs-lookup"><span data-stu-id="8901b-221">We recommend that client applications always validate user input as well as data accepted from untrusted services.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8901b-222">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8901b-222">See also</span></span>

- [<span data-ttu-id="8901b-223">定義 WCF 資料服務</span><span class="sxs-lookup"><span data-stu-id="8901b-223">Defining WCF Data Services</span></span>](defining-wcf-data-services.md)
- [<span data-ttu-id="8901b-224">WCF 資料服務用戶端程式庫</span><span class="sxs-lookup"><span data-stu-id="8901b-224">WCF Data Services Client Library</span></span>](wcf-data-services-client-library.md)
