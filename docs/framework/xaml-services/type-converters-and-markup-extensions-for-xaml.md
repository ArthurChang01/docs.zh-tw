---
title: XAML 的類型轉換子和標記延伸
ms.date: 03/30/2017
helpviewer_keywords:
- XAML [XAML Services], type converter services
- XAML [XAML Services], value converters
- XAML [XAML Services], markup extension services
- value converters for XAML [XAML Services]
- XAML [XAML Services], service context
ms.assetid: db07a952-05ce-4aa4-b6f9-aac7397d0326
ms.openlocfilehash: 1704a7a86e89685763da7bf49a67c1fe8373124a
ms.sourcegitcommit: 5c1abeec15fbddcc7dbaa729fabc1f1f29f12045
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/15/2019
ms.locfileid: "58050538"
---
# <a name="type-converters-and-markup-extensions-for-xaml"></a><span data-ttu-id="a8fbc-102">XAML 的類型轉換子和標記延伸</span><span class="sxs-lookup"><span data-stu-id="a8fbc-102">Type Converters and Markup Extensions for XAML</span></span>
<span data-ttu-id="a8fbc-103">類型轉換器和標記延伸是 XAML 類型系統和 XAML 寫入器用以產生物件圖形元件的兩項技術。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-103">Type converters and markup extensions are two techniques that XAML type systems and XAML writers use to generate object graph components.</span></span> <span data-ttu-id="a8fbc-104">雖然兩者共用某些特性，但類型轉換器和標記延伸在 XAML 節點資料流中會以不同的方式表示。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-104">Although they share some characteristics, type converters and markup extensions are represented differently in a XAML node stream.</span></span> <span data-ttu-id="a8fbc-105">在本文件集中，有時會將類型轉換器、標記延伸和類似的建構統稱為值轉換器。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-105">In this documentation set, type converters, markup extensions, and similar constructs are sometimes collectively referred to as value converters.</span></span>  
  
<a name="value_converters"></a>   
## <a name="value-converters"></a><span data-ttu-id="a8fbc-106">值轉換器</span><span class="sxs-lookup"><span data-stu-id="a8fbc-106">Value Converters</span></span>  
 <span data-ttu-id="a8fbc-107">在 XAML 中，值轉換器可用於多種情節。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-107">In XAML, value converters are used for various scenarios.</span></span> <span data-ttu-id="a8fbc-108">下列清單顯示 XAML 中不同類型的值轉換器：</span><span class="sxs-lookup"><span data-stu-id="a8fbc-108">The following list shows the different types of value converters in XAML:</span></span>  
  
-   <span data-ttu-id="a8fbc-109">類型轉換器</span><span class="sxs-lookup"><span data-stu-id="a8fbc-109">Type converter</span></span>  
  
-   <span data-ttu-id="a8fbc-110">標記延伸</span><span class="sxs-lookup"><span data-stu-id="a8fbc-110">Markup extension</span></span>  
  
-   <span data-ttu-id="a8fbc-111">值序列化程式</span><span class="sxs-lookup"><span data-stu-id="a8fbc-111">Value serializer</span></span>  
  
-   <span data-ttu-id="a8fbc-112">為 XAML 文字語法提供邏輯的相關類別或支援類別</span><span class="sxs-lookup"><span data-stu-id="a8fbc-112">Related class or support class that provides the logic for a XAML text syntax</span></span>  
  
<a name="type_converters"></a>   
## <a name="type-converters"></a><span data-ttu-id="a8fbc-113">類型轉換器</span><span class="sxs-lookup"><span data-stu-id="a8fbc-113">Type Converters</span></span>  
 <span data-ttu-id="a8fbc-114">在 .NET Framework XAML 服務定義中，類型轉換器是衍生自 CLR <xref:System.ComponentModel.TypeConverter> 類別的類別。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-114">In the .NET Framework XAML Services definition, type converters are classes that derive from the CLR <xref:System.ComponentModel.TypeConverter> class.</span></span> <span data-ttu-id="a8fbc-115"><xref:System.ComponentModel.TypeConverter> 是之前的 Microsoft.NET Framework XAML 就存在的類別。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-115"><xref:System.ComponentModel.TypeConverter> is a class that was in the Microsoft .NET Framework before XAML existed.</span></span> <span data-ttu-id="a8fbc-116">其原始用途是為了支援 [!INCLUDE[TLA2#tla_ide](../../../includes/tla2sharptla-ide-md.md)] 屬性的屬性視窗和類似的文字編輯表示。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-116">Its original purpose was to support property windows and similar text-based editing metaphors for [!INCLUDE[TLA2#tla_ide](../../../includes/tla2sharptla-ide-md.md)] properties.</span></span> <span data-ttu-id="a8fbc-117">.NET Framework 中引進的 XAML 使用 <xref:System.ComponentModel.TypeConverter> ，將文字語法 (如屬性值或 XAML 值節點中的文字語法) 轉換成物件。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-117">The introduction of XAML to .NET Framework uses <xref:System.ComponentModel.TypeConverter> to convert a text syntax (as found in an attribute value or a XAML value node) into an object.</span></span> <span data-ttu-id="a8fbc-118"><xref:System.ComponentModel.TypeConverter> 也可用來將物件值序列化為文字語法。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-118"><xref:System.ComponentModel.TypeConverter> can also be used to serialize an object value to text syntax.</span></span> <span data-ttu-id="a8fbc-119"><xref:System.ComponentModel.TypeConverter> 也在 Windows Presentation Foundation (WPF) 和 Windows Communication Foundation (WCF) 的舊版架構特定 XAML 實作中使用。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-119"><xref:System.ComponentModel.TypeConverter> was also used in previous framework-specific XAML implementations in Windows Presentation Foundation (WPF) and Windows Communication Foundation (WCF).</span></span> <span data-ttu-id="a8fbc-120">如需在 XAML 中 <xref:System.ComponentModel.TypeConverter> 的詳細資訊，請參閱 [Type Converters for XAML Overview](type-converters-for-xaml-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-120">For more information about the <xref:System.ComponentModel.TypeConverter> in XAML, see [Type Converters for XAML Overview](type-converters-for-xaml-overview.md).</span></span>  
  
<a name="markup_extensions"></a>   
## <a name="markup-extensions"></a><span data-ttu-id="a8fbc-121">標記延伸</span><span class="sxs-lookup"><span data-stu-id="a8fbc-121">Markup Extensions</span></span>  
 <span data-ttu-id="a8fbc-122">在 .NET Framework XAML 服務實作中，標記延伸是衍生自 <xref:System.Windows.Markup.MarkupExtension> 類別的類別。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-122">In the .NET Framework XAML Services implementation, markup extensions are classes that derive from the <xref:System.Windows.Markup.MarkupExtension> class.</span></span> <span data-ttu-id="a8fbc-123">標記延伸是一種概念，在這種形式下的標記都是源自 XAML 語言。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-123">Markup extensions are a concept that in this form is originated by the XAML language.</span></span> <span data-ttu-id="a8fbc-124">您可以將標記延伸視為類似可延伸的逸出序列，這個序列會呼叫服務類別來提供其邏輯。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-124">You can think of a markup extension as being something like an extensible escape sequence that calls into a service class to provide its logic.</span></span> <span data-ttu-id="a8fbc-125">就標記而言，XAML 處理器普遍會將文字字串中以左大括號 ({) 開頭的文字序列視為標記延伸。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-125">In terms of markup, XAML processors universally recognize a markup extension by a text sequence that starts with an opening brace ({) in a text string.</span></span>  
  
 <span data-ttu-id="a8fbc-126">標記延伸與類型轉換器不同。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-126">Markup extensions differ from type converters.</span></span> <span data-ttu-id="a8fbc-127">類型轉換器通常與類型或成員相關聯。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-127">Type converters are typically associated with types or members.</span></span> <span data-ttu-id="a8fbc-128">當物件圖形建立或序列化作業遇到與這些實體關聯的文字語法時，即會叫用類型轉換器。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-128">They are invoked when an object graph creation or a serialization encounters text syntax that is associated with those entities.</span></span>  
  
 <span data-ttu-id="a8fbc-129">標記延伸與單一支援服務類別相關聯，但可套用至任何成員值。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-129">Markup extensions are associated with a single supporting service class, but can be applied for any member value.</span></span> <span data-ttu-id="a8fbc-130">(不過，您可以透過服務內容實作標記延伸，刻意限制只有特定成員或目的類型才能使用)。標記延伸可覆寫類型轉換器關聯。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-130">(However, you can implement your markup extension to deliberately restrict its use to certain members or destination types, by using service context.) Markup extensions can override a type converter association.</span></span> <span data-ttu-id="a8fbc-131">或者，您可以使用標記延伸，為原本不支援文字語法的成員指定屬性值。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-131">Or you can use them to specify an attribute value for members that would not otherwise support a text syntax.</span></span>  
  
 <span data-ttu-id="a8fbc-132">如需 XAML 之標記延伸實作模式的詳細資訊，請參閱 [Markup Extensions for XAML Overview](markup-extensions-for-xaml-overview.md)。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-132">For more information about the markup extension implementation pattern for XAML, see [Markup Extensions for XAML Overview](markup-extensions-for-xaml-overview.md).</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="a8fbc-133"><xref:System.Windows.Markup.MarkupExtension> 和 <xref:System.Windows.Markup.ValueSerializer> 類型都在 <xref:System.Windows.Markup> 命名空間中，而不在 <xref:System.Xaml> 命名空間中。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-133">The <xref:System.Windows.Markup.MarkupExtension> and <xref:System.Windows.Markup.ValueSerializer> types are both in the <xref:System.Windows.Markup> namespace and not in the <xref:System.Xaml> namespace.</span></span> <span data-ttu-id="a8fbc-134">這不表示這些類型專屬於情況下填入包含字串的 CLR 命名空間的 WPF 或 Windows Form 技術`Windows`。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-134">This does not imply that these types are specific to either the WPF or Windows Forms technologies that otherwise populate CLR namespaces that contain the string `Windows`.</span></span> <span data-ttu-id="a8fbc-135"><xref:System.Windows.Markup.MarkupExtension> 和 <xref:System.Windows.Markup.ValueSerializer> 位於 System.Xaml 組件中，並且沒有特定架構相依性。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-135"><xref:System.Windows.Markup.MarkupExtension> and <xref:System.Windows.Markup.ValueSerializer> are in the System.Xaml assembly and have no specific framework dependency.</span></span> <span data-ttu-id="a8fbc-136">這些類型在 [!INCLUDE[net_v30_short](../../../includes/net-v30-short-md.md)] 存在於 CLR 命名空間中，到了 [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] 仍存在於 CLR 命名空間中，這是為了避免破壞現有 WPF 專案中的參考。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-136">These types existed in the CLR namespace for [!INCLUDE[net_v30_short](../../../includes/net-v30-short-md.md)] and remain in the CLR namespace in [!INCLUDE[net_v40_short](../../../includes/net-v40-short-md.md)] to avoid breaking references in existing WPF projects.</span></span> <span data-ttu-id="a8fbc-137">如需詳細資訊，請參閱 [Types Migrated from WPF to System.Xaml](types-migrated-from-wpf-to-system-xaml.md)。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-137">For more information, see [Types Migrated from WPF to System.Xaml](types-migrated-from-wpf-to-system-xaml.md).</span></span>  
  
<a name="value_serializers"></a>   
## <a name="value-serializers"></a><span data-ttu-id="a8fbc-138">值序列化程式</span><span class="sxs-lookup"><span data-stu-id="a8fbc-138">Value Serializers</span></span>  
 <span data-ttu-id="a8fbc-139"><xref:System.Windows.Markup.ValueSerializer> 是為了以最佳方式將物件轉換成字串而特製化的類型轉換器。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-139">A <xref:System.Windows.Markup.ValueSerializer> is a specialized type converter that is optimized for converting an object to a string.</span></span> <span data-ttu-id="a8fbc-140">XAML 的 <xref:System.Windows.Markup.ValueSerializer> 可能完全無法實作 `ConvertFrom` 方法。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-140">A <xref:System.Windows.Markup.ValueSerializer> for XAML might not implement the `ConvertFrom` method at all.</span></span> <span data-ttu-id="a8fbc-141"><xref:System.Windows.Markup.ValueSerializer> 實作取得服務的方式與 <xref:System.ComponentModel.TypeConverter> 實作類似。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-141">A <xref:System.Windows.Markup.ValueSerializer> implementation obtains services in a manner that is like a <xref:System.ComponentModel.TypeConverter> implementation.</span></span> <span data-ttu-id="a8fbc-142">虛擬方法會提供輸入 `context` 參數。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-142">The virtual methods provide an input `context` parameter.</span></span> <span data-ttu-id="a8fbc-143">`context` 參數屬於 <xref:System.Windows.Markup.IValueSerializerContext>類型，該類型繼承自 <xref:System.IServiceProvider> 介面並具有 <xref:System.IServiceProvider.GetService%2A> 方法。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-143">The `context` parameter is of type <xref:System.Windows.Markup.IValueSerializerContext>, which inherits from the <xref:System.IServiceProvider> interface and has a <xref:System.IServiceProvider.GetService%2A> method.</span></span>  
  
 <span data-ttu-id="a8fbc-144">在 XAML 類型系統中，以及針對使用 XAML 節點迴圈處理序列化的 XAML 寫入器實作，與類型或成員關聯的值轉換器會由其專屬的 <xref:System.Xaml.XamlType.ValueSerializer%2A?displayProperty=nameWithType> 屬性來報告。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-144">In the XAML type system and for XAML writer implementations that use XAML node loop processing for serialization, a value converter that is associated with a type or member is reported by its own <xref:System.Xaml.XamlType.ValueSerializer%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="a8fbc-145">這對執行序列化的 XAML 寫入器所代表的意義是，如果有 <xref:System.Xaml.XamlType.TypeConverter%2A?displayProperty=nameWithType> 和 <xref:System.Xaml.XamlType.ValueSerializer%2A?displayProperty=nameWithType> ，則應針對載入路徑使用類型轉換器，並應針對儲存路徑使用值序列化程式。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-145">The meaning to XAML writers that perform serialization is that if a <xref:System.Xaml.XamlType.TypeConverter%2A?displayProperty=nameWithType> and <xref:System.Xaml.XamlType.ValueSerializer%2A?displayProperty=nameWithType> exist, the type converter should be used for the load path and the value serializer should be used for the save path.</span></span> <span data-ttu-id="a8fbc-146">如果有 <xref:System.Xaml.XamlType.TypeConverter%2A?displayProperty=nameWithType> 但 <xref:System.Xaml.XamlType.ValueSerializer%2A?displayProperty=nameWithType> 為 `null`，也應針對儲存路徑使用類型轉換器。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-146">If <xref:System.Xaml.XamlType.TypeConverter%2A?displayProperty=nameWithType> exists but <xref:System.Xaml.XamlType.ValueSerializer%2A?displayProperty=nameWithType> is `null`, the type converter is also used for the save path.</span></span>  
  
<a name="other_value_converters"></a>   
## <a name="other-value-converters"></a><span data-ttu-id="a8fbc-147">其他值轉換器</span><span class="sxs-lookup"><span data-stu-id="a8fbc-147">Other Value Converters</span></span>  
 <span data-ttu-id="a8fbc-148">值轉換器可延伸至超出類型轉換器或標記延伸的特定模式。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-148">A value converter is extensible beyond the specific patterns of a type converter or a markup extension.</span></span> <span data-ttu-id="a8fbc-149">但若要進行這項自訂，還必須重新定義 .NET Framework XAML 服務所提供的 XAML 類型系統。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-149">However, this customization would also require the redefinition of the XAML type system as provided by .NET Framework XAML Services.</span></span> <span data-ttu-id="a8fbc-150">現有 XAML 類型系統具有適用於類型轉換子、標記延伸和值序列化程式的表示和報告系統，但沒有適用於自訂形式之值轉換的表示和報告系統。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-150">The existing XAML type system has representations and reporting systems for type converters, markup extensions, and value serializers, but not for custom forms of value conversion.</span></span> <span data-ttu-id="a8fbc-151">如果您想要建立自訂值轉換器，請使用 <xref:System.Xaml.Schema.XamlValueConverter%601> 類型。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-151">If you want to create custom value converters, use the <xref:System.Xaml.Schema.XamlValueConverter%601> type.</span></span>  
  
<a name="type_converters_and_markup_extensions_in_combination"></a>   
## <a name="type-converters-and-markup-extensions-in-combination"></a><span data-ttu-id="a8fbc-152">類型轉換器和標記延伸的組合</span><span class="sxs-lookup"><span data-stu-id="a8fbc-152">Type Converters and Markup Extensions in Combination</span></span>  
 <span data-ttu-id="a8fbc-153">標記延伸和類型轉換器會用於 XAML 中的不同情況。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-153">Markup extensions and type converters are used for different situations in XAML.</span></span> <span data-ttu-id="a8fbc-154">儘管有適合標記延伸使用的內容，但標記延伸負責提供值的屬性類型轉換行為在標記延伸實作中通常不會遭到檢查。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-154">Although context is available for markup extension usages, type conversion behavior of properties where a markup extension provides a value is generally is not checked in the markup extension implementations.</span></span> <span data-ttu-id="a8fbc-155">換句話說，即使標記延伸傳回文字字串做為其 `ProvideValue` 輸出，也不會在該字串上，叫用套用至特定屬性或屬性值類型的類型轉換行為。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-155">In other words, even if a markup extension returns a text string as its `ProvideValue` output, type conversion behavior on that string as applied to a specific property or property value type is not invoked.</span></span> <span data-ttu-id="a8fbc-156">一般來說，標記延伸的目的是在未涉及任何類型轉換器的情況下，處理字串及傳回物件。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-156">Generally, the purpose of a markup extension is to process a string and return an object without any type converter involved.</span></span>  
  
<a name="service_context_for_a_value_converter"></a>   
## <a name="service-context-for-a-value-converter"></a><span data-ttu-id="a8fbc-157">值轉換器的服務內容</span><span class="sxs-lookup"><span data-stu-id="a8fbc-157">Service Context for a Value Converter</span></span>  
 <span data-ttu-id="a8fbc-158">當您實作值轉換器時，您通常會需要存取套用值轉換器的內容。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-158">When you implement a value converter, you often need access to a context in which the value converter is applied.</span></span> <span data-ttu-id="a8fbc-159">這個內容稱為服務內容。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-159">This context is known as the service context.</span></span> <span data-ttu-id="a8fbc-160">服務內容可能包含作用中的 XAML 結構描述內容、XAML 結構描述內容和 XAML 物件寫入器提供之類型對應系統的存取等資訊。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-160">The service context might include information such as the active XAML schema context, access to the type mapping system that the XAML schema context and XAML object writer provide, and so on.</span></span> <span data-ttu-id="a8fbc-161">如需值轉換器的可用服務內容，以及如何存取服務內容可能提供之服務的詳細資訊，請參閱 [Service Contexts Available to Type Converters and Markup Extensions](service-contexts-available-to-type-converters-and-markup-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="a8fbc-161">For more information about the service contexts available for a value converter and how to access the services that a service context might provide, see [Service Contexts Available to Type Converters and Markup Extensions](service-contexts-available-to-type-converters-and-markup-extensions.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="a8fbc-162">另請參閱</span><span class="sxs-lookup"><span data-stu-id="a8fbc-162">See also</span></span>
- <xref:System.Windows.Markup.MarkupExtension>
- <xref:System.Xaml.XamlObjectWriter>
- [<span data-ttu-id="a8fbc-163">XAML 標記延伸概觀</span><span class="sxs-lookup"><span data-stu-id="a8fbc-163">Markup Extensions for XAML Overview</span></span>](markup-extensions-for-xaml-overview.md)
- [<span data-ttu-id="a8fbc-164">XAML 類型轉換子概觀</span><span class="sxs-lookup"><span data-stu-id="a8fbc-164">Type Converters for XAML Overview</span></span>](type-converters-for-xaml-overview.md)
- [<span data-ttu-id="a8fbc-165">Service Contexts Available to Type Converters and Markup Extensions</span><span class="sxs-lookup"><span data-stu-id="a8fbc-165">Service Contexts Available to Type Converters and Markup Extensions</span></span>](service-contexts-available-to-type-converters-and-markup-extensions.md)
