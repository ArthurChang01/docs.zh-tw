---
title: XAML 的集合和集合類型
ms.date: 03/30/2017
ms.assetid: 58f8e7c6-9a41-4f25-8551-c042f1315baa
ms.openlocfilehash: 63f6346837f77dbdbdcb4a90ec5af725be69ee02
ms.sourcegitcommit: 30a83efb57c468da74e9e218de26cf88d3254597
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 07/20/2019
ms.locfileid: "68364333"
---
# <a name="collections-and-collection-types-for-xaml"></a><span data-ttu-id="3151d-102">XAML 的集合和集合類型</span><span class="sxs-lookup"><span data-stu-id="3151d-102">Collections and Collection Types for XAML</span></span>

<span data-ttu-id="3151d-103">本主題描述如何定義要支援集合的型別屬性, 以及支援將收集項具現化為父物件元素或 property 專案之專案子系的 XAML 語法。</span><span class="sxs-lookup"><span data-stu-id="3151d-103">This topic describes how to define properties of types that are intended to support a collection, and to support the XAML syntax for instantiating collection items as element children of a parent object element or property element.</span></span>

## <a name="xaml-collection-concepts"></a><span data-ttu-id="3151d-104">XAML 集合概念</span><span class="sxs-lookup"><span data-stu-id="3151d-104">XAML Collection Concepts</span></span>

<span data-ttu-id="3151d-105">就概念而言, XAML 中有多個子專案的任何關聯性, 都必須實作為集合。</span><span class="sxs-lookup"><span data-stu-id="3151d-105">Conceptually, any relationship in XAML where there are multiple child items within the scope of a XAML object element or XAML property element must be implemented as a collection.</span></span> <span data-ttu-id="3151d-106">該集合必須與 XAML 類型 (該關聯性中的父系) 的特定 XAML 屬性相關聯。</span><span class="sxs-lookup"><span data-stu-id="3151d-106">That collection must be associated with a particular XAML property of the XAML type that is the parent in that relationship.</span></span> <span data-ttu-id="3151d-107">屬性必須是集合, 因為 XAML 處理器預期會將標記中的每個專案指派為支援集合屬性的新加入專案。</span><span class="sxs-lookup"><span data-stu-id="3151d-107">The property must be a collection because a XAML processor expects to assign each item in markup to be a newly added item of the backing collection property.</span></span>

<span data-ttu-id="3151d-108">在 XAML 語言層級, 集合支援的確切需求並未完整定義。</span><span class="sxs-lookup"><span data-stu-id="3151d-108">At the XAML language level, the exact requirements of collection support are not fully defined.</span></span> <span data-ttu-id="3151d-109">集合可以是清單或字典 (但不是兩者) 的概念是在 XAML 語言層級定義, 但哪些支援類型代表清單或字典不是由 XAML 語言所定義。</span><span class="sxs-lookup"><span data-stu-id="3151d-109">The concept that a collection can be either a list or a dictionary(but not both) is defined at the XAML language level, but which backing types represent either lists or dictionaries is not defined by the XAML language.</span></span>

<span data-ttu-id="3151d-110">在 .NET Framework XAML 服務中, XAML 集合支援的概念在 .NET Framework 支援類型方面更清楚地定義。</span><span class="sxs-lookup"><span data-stu-id="3151d-110">In .NET Framework XAML Services, the concept of XAML collection support is more clearly defined in terms of .NET Framework backing types.</span></span> <span data-ttu-id="3151d-111">具體而言, 針對集合的 XAML 支援是根據一般 .NET Framework 程式設計中用於清單和字典的幾個 .NET Framework 概念和 Api。</span><span class="sxs-lookup"><span data-stu-id="3151d-111">Specifically, the XAML support for collections is based on several .NET Framework concepts and APIs that are used for lists and dictionaries in general .NET Framework programming.</span></span>

1. <span data-ttu-id="3151d-112"><xref:System.Collections.IList>介面表示清單集合。</span><span class="sxs-lookup"><span data-stu-id="3151d-112">The <xref:System.Collections.IList> interface indicates a list collection.</span></span>

2. <span data-ttu-id="3151d-113"><xref:System.Collections.IDictionary>介面表示字典集合。</span><span class="sxs-lookup"><span data-stu-id="3151d-113">The <xref:System.Collections.IDictionary> interface indicates a dictionary collection.</span></span>

3. <span data-ttu-id="3151d-114"><xref:System.Array>表示陣列, 而陣列則支援<xref:System.Collections.IList>方法。</span><span class="sxs-lookup"><span data-stu-id="3151d-114"><xref:System.Array> represents an array, and an array supports <xref:System.Collections.IList> methods.</span></span>

<span data-ttu-id="3151d-115">在上述每個集合概念中, .NET Framework xaml 服務 xaml 處理器預期會在集合`Add`屬性類型的特定實例上呼叫方法。</span><span class="sxs-lookup"><span data-stu-id="3151d-115">In each of these collection concepts, a .NET Framework XAML Services XAML processor expects to call the `Add` method on a specific instance of the collection property's type.</span></span> <span data-ttu-id="3151d-116">或者, 在序列化案例中, XAML 處理器會根據每個集合的「專案」概念, 針對清單、字典或陣列中找到的每個專案, 產生離散的 XAML 型別實例。</span><span class="sxs-lookup"><span data-stu-id="3151d-116">Or, in a serialization scenario, a XAML processor produces discrete XAML-type instances for each item found in the list, dictionary or array based on each collection's specific concept of "Items".</span></span> <span data-ttu-id="3151d-117">這些是: <xref:System.Collections.IList.Item%2A>;<xref:System.Array.System%23Collections%23IList%23Item%2A> ;的<xref:System.Array>明確。 <xref:System.Collections.IDictionary.Item%2A></span><span class="sxs-lookup"><span data-stu-id="3151d-117">These are : <xref:System.Collections.IList.Item%2A>; <xref:System.Collections.IDictionary.Item%2A>; the explicit <xref:System.Array.System%23Collections%23IList%23Item%2A> for <xref:System.Array>.</span></span>

## <a name="generic-collections"></a><span data-ttu-id="3151d-118">泛型集合</span><span class="sxs-lookup"><span data-stu-id="3151d-118">Generic Collections</span></span>

<span data-ttu-id="3151d-119">泛型集合適用于一般 .NET Framework 程式設計, 而且也可以用於 XAML 集合屬性。</span><span class="sxs-lookup"><span data-stu-id="3151d-119">Generic collections can be useful for general .NET Framework programming, and can also be used for XAML collection properties.</span></span> <span data-ttu-id="3151d-120">不過, .NET Framework xaml 服務<xref:System.Collections.Generic.IList%601> xaml <xref:System.Collections.Generic.IDictionary%602>處理器與非泛型<xref:System.Collections.IList>或<xref:System.Collections.IDictionary>相等時, 不會識別泛型介面和。</span><span class="sxs-lookup"><span data-stu-id="3151d-120">However, the generic interfaces <xref:System.Collections.Generic.IList%601> and <xref:System.Collections.Generic.IDictionary%602> are not identified by .NET Framework XAML Services XAML processors as being equivalent to the non-generic <xref:System.Collections.IList> or <xref:System.Collections.IDictionary>.</span></span> <span data-ttu-id="3151d-121">泛型集合屬性類型的建議方法是衍生自類別<xref:System.Collections.Generic.List%601>或<xref:System.Collections.Generic.Dictionary%602>, 而不是執行介面。</span><span class="sxs-lookup"><span data-stu-id="3151d-121">Rather than implementing the interfaces, a recommended approach for generic collection property types is to derive from the classes <xref:System.Collections.Generic.List%601> or <xref:System.Collections.Generic.Dictionary%602>.</span></span> <span data-ttu-id="3151d-122">這些類別會執行非泛型介面, 因此在基底實作為中包含 XAML 集合的預期支援。</span><span class="sxs-lookup"><span data-stu-id="3151d-122">These classes implement the non-generic interfaces and thus include the expected support for XAML collections in the base implementation.</span></span>

## <a name="read-only-collections-and-initialization-logic"></a><span data-ttu-id="3151d-123">唯讀集合和初始化邏輯</span><span class="sxs-lookup"><span data-stu-id="3151d-123">Read-Only Collections and Initialization Logic</span></span>

<span data-ttu-id="3151d-124">在 .NET Framework 程式設計中, 這是一種常見的設計模式, 可讓任何屬性將集合的值保存為唯讀集合。</span><span class="sxs-lookup"><span data-stu-id="3151d-124">In .NET Framework programming, it is a common design pattern to make any property that holds a value of a collection as a read-only collection.</span></span> <span data-ttu-id="3151d-125">此模式可讓擁有集合屬性的實例更有效地控制要對集合進行的動作。</span><span class="sxs-lookup"><span data-stu-id="3151d-125">This pattern permits the instance that owns the collection property to better control what happens to the collection..</span></span> <span data-ttu-id="3151d-126">具體而言, 模式會藉由設定屬性, 來防止意外取代整個預先存在的集合。</span><span class="sxs-lookup"><span data-stu-id="3151d-126">Specifically, the pattern prevents accidental replacement of the entire pre-existing collection by setting the property.</span></span> <span data-ttu-id="3151d-127">在此模式中, 由呼叫端對集合所做的任何存取, 應改為呼叫集合類型和/或相關集合介面 (例如) <xref:System.Collections.IList>所支援的方法或屬性。</span><span class="sxs-lookup"><span data-stu-id="3151d-127">In this pattern, any access to the collection by callers should instead be made by calling methods or properties as supported by the collection type and/or the relevant collection interfaces such as <xref:System.Collections.IList>.</span></span>

<span data-ttu-id="3151d-128">使用此模式表示任何公開唯讀集合屬性的類別都必須先初始化該屬性, 以保存空的集合。</span><span class="sxs-lookup"><span data-stu-id="3151d-128">Using this pattern implies that any class that exposes a read-only collection property must first initialize that property to hold an empty collection.</span></span> <span data-ttu-id="3151d-129">一般來說, 初始化會當做類別的結構行為之一部分來執行。</span><span class="sxs-lookup"><span data-stu-id="3151d-129">Typically the initialization is performed as part of the construction behavior for the class.</span></span> <span data-ttu-id="3151d-130">對於 XAML 很有用, 因為 XAML 通常會在處理屬性 (集合屬性或其他) 之前呼叫無參數的函式, 所以一定要由無參數的函式來參考這類邏輯。</span><span class="sxs-lookup"><span data-stu-id="3151d-130">To be useful for XAML, it is important that such logic is always referenced by the parameterless constructor, because XAML generally calls the parameterless constructor prior to processing the properties (collection properties or otherwise).</span></span>

## <a name="xaml-type-system-support-and-collections"></a><span data-ttu-id="3151d-131">XAML 類型系統支援和集合</span><span class="sxs-lookup"><span data-stu-id="3151d-131">XAML Type System Support and Collections</span></span>

<span data-ttu-id="3151d-132">除了剖析 XAML 以及填入或序列化集合屬性的基本機制之外, 在 .NET Framework XAML 服務中實作為的 XAML 型別系統, 還包含數個與 XAML 集合相關的設計功能。</span><span class="sxs-lookup"><span data-stu-id="3151d-132">Beyond the basic mechanics of parsing XAML and populating or serializing collection properties, the XAML type system as implemented in .NET Framework XAML Services includes several design features that pertain to collections in XAML.</span></span>

1. <span data-ttu-id="3151d-133"><xref:System.Xaml.XamlType.IsCollection%2A>如果 XAML 型別是以提供 XAML 集合支援的型別為後盾, 則傳回 true。</span><span class="sxs-lookup"><span data-stu-id="3151d-133"><xref:System.Xaml.XamlType.IsCollection%2A> returns true if the XAML type is backed by a type that provides XAML collection support.</span></span>

2. <span data-ttu-id="3151d-134"><xref:System.Xaml.XamlType.IsDictionary%2A>和<xref:System.Xaml.XamlType.IsArray%2A>可以進一步識別 XAML 類型支援的收集模式。</span><span class="sxs-lookup"><span data-stu-id="3151d-134"><xref:System.Xaml.XamlType.IsDictionary%2A> and <xref:System.Xaml.XamlType.IsArray%2A> can further identify which collection mode the XAML type supports.</span></span> <span data-ttu-id="3151d-135">針對以 .NET Framework xaml 服務和 xaml 型別系統為基礎的自訂 xaml 處理器, 但不是<xref:System.Xaml.XamlWriter>以現有的實作為基礎, 知道要使用哪一個收集模式來知道要叫用的方法集合處理。</span><span class="sxs-lookup"><span data-stu-id="3151d-135">For custom XAML processors that are based on .NET Framework XAML Services and the XAML type system but not based on existing <xref:System.Xaml.XamlWriter> implementations, knowing which collection mode is used might be necessary in order to know which method to invoke for collection processing.</span></span>

3. <span data-ttu-id="3151d-136">上一個屬性值可能會受到 XAML 型別上之<xref:System.Xaml.XamlType.LookupCollectionKind%2A>覆寫的影響。</span><span class="sxs-lookup"><span data-stu-id="3151d-136">Each of the previous property values are potentially influenced by overrides of <xref:System.Xaml.XamlType.LookupCollectionKind%2A> on a XAML type.</span></span>
