---
title: "部署已裝載網際網路資訊服務的 WCF 服務"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: 04ebd329-3fbd-44c3-b3ab-1de3517e27d7
caps.latest.revision: "30"
author: Erikre
ms.author: erikre
manager: erikre
ms.openlocfilehash: 42c30c5f83f8245531a357c2d0b179deb87a2845
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/21/2017
---
# <a name="deploying-an-internet-information-services-hosted-wcf-service"></a><span data-ttu-id="d58eb-102">部署已裝載網際網路資訊服務的 WCF 服務</span><span class="sxs-lookup"><span data-stu-id="d58eb-102">Deploying an Internet Information Services-Hosted WCF Service</span></span>
<span data-ttu-id="d58eb-103">開發與部署由 Internet Information Services (IIS) 裝載的 [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] 服務包含下列工作：</span><span class="sxs-lookup"><span data-stu-id="d58eb-103">Developing and deploying a [!INCLUDE[indigo1](../../../../includes/indigo1-md.md)] service that is hosted in Internet Information Services (IIS) consists of the following tasks:</span></span>  
  
-   <span data-ttu-id="d58eb-104">確定 IIS、ASP.NET、 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]和 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 啟動元件都已正確安裝及註冊。</span><span class="sxs-lookup"><span data-stu-id="d58eb-104">Ensure that IIS, ASP.NET, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], and the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] activation component are correctly installed and registered.</span></span>  
  
-   <span data-ttu-id="d58eb-105">建立新的 IIS 應用程式，或是重複使用現有的 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d58eb-105">Create a new IIS application, or reuse an existing [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)] application.</span></span>  
  
-   <span data-ttu-id="d58eb-106">建立 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務的 .svc 檔案。</span><span class="sxs-lookup"><span data-stu-id="d58eb-106">Create a .svc file for the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service.</span></span>  
  
-   <span data-ttu-id="d58eb-107">將服務實作部署到 IIS 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d58eb-107">Deploy the service implementation to the IIS application.</span></span>  
  
-   <span data-ttu-id="d58eb-108">設定 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務。</span><span class="sxs-lookup"><span data-stu-id="d58eb-108">Configure the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service.</span></span>  
  
 <span data-ttu-id="d58eb-109">如需如何建立由 IIS 裝載之 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務的詳細逐步解說，請參閱 [How to: Host a WCF Service in IIS](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-109">For a detailed walkthrough of creating an IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service, see [How to: Host a WCF Service in IIS](../../../../docs/framework/wcf/feature-details/how-to-host-a-wcf-service-in-iis.md).</span></span>  
  
## <a name="ensure-that-iis-aspnet-and-wcf-are-correctly-installed-and-registered"></a><span data-ttu-id="d58eb-110">確定 IIS、ASP.NET 和 WCF 已正確安裝及註冊</span><span class="sxs-lookup"><span data-stu-id="d58eb-110">Ensure That IIS, ASP.NET and WCF Are Correctly Installed and Registered</span></span>  
 <span data-ttu-id="d58eb-111">您必須安裝[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]、IIS 和 ASP.NET，才能讓 IIS 裝載的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務正確運作。</span><span class="sxs-lookup"><span data-stu-id="d58eb-111">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)], IIS, and ASP.NET must be installed for IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services to function correctly.</span></span> <span data-ttu-id="d58eb-112">安裝 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] (屬於 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]一部分)、ASP.NET 和 IIS 的程序可能會因所使用的作業系統版本而異。</span><span class="sxs-lookup"><span data-stu-id="d58eb-112">The procedures for installing [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] (as part of the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]), ASP.NET and IIS vary depending on the operating system version being used.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d58eb-113"> 會安裝 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 及 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]，請參閱 [Microsoft .NET Framework 4 Web 安裝程式](http://go.microsoft.com/fwlink/?LinkId=201185)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-113"> installing [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] and the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], see [Microsoft .NET Framework 4 Web Installer](http://go.microsoft.com/fwlink/?LinkId=201185).</span></span> <span data-ttu-id="d58eb-114">您可以參閱 [安裝 IIS](http://go.microsoft.com/fwlink/?LinkId=201188)中的 IIS 安裝指示。</span><span class="sxs-lookup"><span data-stu-id="d58eb-114">Instructions for installing IIS can be found at [Installing IIS](http://go.microsoft.com/fwlink/?LinkId=201188).</span></span>  
  
 <span data-ttu-id="d58eb-115">[!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)] 的安裝處理序會將 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 自動註冊到 IIS 上 (如果 IIS 已經存在電腦上的話)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-115">The installation process for the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)] automatically registers [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] with IIS if IIS is already present on the machine.</span></span> <span data-ttu-id="d58eb-116">如果 IIS 是在 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]之後才安裝，則您需要採取額外步驟將 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 註冊到 IIS 和 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]。</span><span class="sxs-lookup"><span data-stu-id="d58eb-116">If IIS is installed after the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)], an additional step is required to register [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] with IIS and [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)].</span></span> <span data-ttu-id="d58eb-117">請依據您的作業系統，採取下列適當的步驟：</span><span class="sxs-lookup"><span data-stu-id="d58eb-117">You can do this as follows, depending on your operating system:</span></span>  
  
-   [!INCLUDE[wxpsp2](../../../../includes/wxpsp2-md.md)]<span data-ttu-id="d58eb-118">、 Windows 7 和[!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]： 使用[ServiceModel 註冊工具 (ServiceModelReg.exe)](../../../../docs/framework/wcf/servicemodelreg-exe.md)工具註冊[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]與 IIS： 若要使用此工具，輸入**ServiceModelReg.exe /i /x**中Visual Studio 命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="d58eb-118">, Windows 7, and [!INCLUDE[ws2003](../../../../includes/ws2003-md.md)]: Use the [ServiceModel Registration Tool (ServiceModelReg.exe)](../../../../docs/framework/wcf/servicemodelreg-exe.md) tool to register [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] with IIS: To use this tool, type **ServiceModelReg.exe /i /x** in the Visual Studio command prompt.</span></span> <span data-ttu-id="d58eb-119">按一下 [開始] 按鈕，並依序選取 [ **所有程式**, **Microsoft Visual Studio 2012**, **Visual Studio Tools**] 和 [ **Visual Studio 命令提示字元**]，您即可開啟這個命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="d58eb-119">You can open this command prompt by clicking the start button, selecting **All Programs**, **Microsoft Visual Studio 2012**, **Visual Studio Tools**, and **Visual Studio Command Prompt**</span></span>  
  
-   [!INCLUDE[wv](../../../../includes/wv-md.md)]<span data-ttu-id="d58eb-120">：安裝 [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)]的 Windows Communication Foundation 啟動元件子元件。</span><span class="sxs-lookup"><span data-stu-id="d58eb-120">: Install the Windows Communication Foundation Activation Components subcomponent of the [!INCLUDE[vstecwinfx](../../../../includes/vstecwinfx-md.md)].</span></span> <span data-ttu-id="d58eb-121">若要這樣做，請在控制台中按一下**新增或移除程式**然後**新增\/移除 Windows 元件**。</span><span class="sxs-lookup"><span data-stu-id="d58eb-121">To do this, in Control Panel, click **Add or Remove Programs** and then **Add\/Remove Windows Components**.</span></span> <span data-ttu-id="d58eb-122">這樣會啟動 [ **Windows 元件精靈**]。</span><span class="sxs-lookup"><span data-stu-id="d58eb-122">This activates the **Windows Component Wizard**.</span></span>  
  
-   <span data-ttu-id="d58eb-123">Windows 7：</span><span class="sxs-lookup"><span data-stu-id="d58eb-123">Windows 7:</span></span>  
  
 <span data-ttu-id="d58eb-124">最後，您必須確認 ASP.NET 設定成使用 .NET Framework 4 版。</span><span class="sxs-lookup"><span data-stu-id="d58eb-124">Finally you must verify that ASP.NET is configured to use the .NET Framework version 4.</span></span> <span data-ttu-id="d58eb-125">您可以使用 -i 選項來執行 ASPNET_Regiis 工具，藉以達成此目的。</span><span class="sxs-lookup"><span data-stu-id="d58eb-125">You do this by running the ASPNET_Regiis tool with the –i option.</span></span> [!INCLUDE[crdefault](../../../../includes/crdefault-md.md)]<span data-ttu-id="d58eb-126">[ASP.NET IIS 註冊工具](http://go.microsoft.com/fwlink/?LinkId=201186)</span><span class="sxs-lookup"><span data-stu-id="d58eb-126"> [ASP.NET IIS Registration Tool](http://go.microsoft.com/fwlink/?LinkId=201186)</span></span>  
  
## <a name="create-a-new-iis-application-or-reuse-an-existing-aspnet-application"></a><span data-ttu-id="d58eb-127">建立新的 IIS 應用程式或是重複使用現有的 ASP.NET 應用程式</span><span class="sxs-lookup"><span data-stu-id="d58eb-127">Create a New IIS Application or Reuse an Existing ASP.NET Application</span></span>  
 <span data-ttu-id="d58eb-128">IIS 裝載的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務必須駐留在 IIS 應用程式裡面。</span><span class="sxs-lookup"><span data-stu-id="d58eb-128">IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services must reside inside of an IIS application.</span></span> <span data-ttu-id="d58eb-129">您可以建立新的 IIS 應用程式來專門裝載 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務。</span><span class="sxs-lookup"><span data-stu-id="d58eb-129">You can create a new IIS application to host [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services exclusively.</span></span> <span data-ttu-id="d58eb-130">或者，您可以將 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務部署到已經裝載 [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] 內容 (例如 .aspx 網頁和 ASP.NET Web 服務 [ASMX]) 的現有應用程式上。</span><span class="sxs-lookup"><span data-stu-id="d58eb-130">Alternatively, you can deploy an [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service into an existing application that is already hosting [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] content (such as .aspx pages and ASP.NET Web services [ASMX]).</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d58eb-131"> 這些選項的詳細資訊，請參閱 [WCF Services and ASP.NET](../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-131"> these options, see the "Hosting WCF Side-by-Side with ASP.NET" and "Hosting WCF Services in ASP.NET Compatibility Mode" sections in [WCF Services and ASP.NET](../../../../docs/framework/wcf/feature-details/wcf-services-and-aspnet.md).</span></span>  
  
 <span data-ttu-id="d58eb-132">請注意， [!INCLUDE[iis601](../../../../includes/iis601-md.md)] 及更新版本會定期重新啟動獨立的物件導向程式設計應用程式。</span><span class="sxs-lookup"><span data-stu-id="d58eb-132">Note that [!INCLUDE[iis601](../../../../includes/iis601-md.md)] and later versions periodically restart an isolated object-oriented programming application.</span></span> <span data-ttu-id="d58eb-133">預設值為 1740 分鐘。</span><span class="sxs-lookup"><span data-stu-id="d58eb-133">The default value is 1740 minutes.</span></span> <span data-ttu-id="d58eb-134">支援的最大值為 71,582 分鐘。</span><span class="sxs-lookup"><span data-stu-id="d58eb-134">The maximum value supported is 71,582 minutes.</span></span> <span data-ttu-id="d58eb-135">您可以停用這項重新啟動。</span><span class="sxs-lookup"><span data-stu-id="d58eb-135">This restart can be disabled.</span></span> <span data-ttu-id="d58eb-136">如需[!INCLUDE[crabout](../../../../includes/crabout-md.md)] 這項屬性的詳細資訊，請參閱 [PeriodicRestartTime](http://go.microsoft.com/fwlink/?LinkId=109968)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-136">[!INCLUDE[crabout](../../../../includes/crabout-md.md)] this property, see the [PeriodicRestartTime](http://go.microsoft.com/fwlink/?LinkId=109968).</span></span>  
  
## <a name="create-an-svc-file-for-the-wcf-service"></a><span data-ttu-id="d58eb-137">建立 WCF 服務的 .svc 檔案</span><span class="sxs-lookup"><span data-stu-id="d58eb-137">Create an .svc File for the WCF Service</span></span>  
 <span data-ttu-id="d58eb-138">裝載在 IIS 的[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務會於 IIS 應用程式中以特殊內容檔 (.svc 檔) 形式表示。</span><span class="sxs-lookup"><span data-stu-id="d58eb-138">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in IIS are represented as special content files (.svc files) inside the IIS application.</span></span> <span data-ttu-id="d58eb-139">這個模型與 IIS 應用程式將 ASMX 頁面表示為 .asmx 檔案的方式很類似。</span><span class="sxs-lookup"><span data-stu-id="d58eb-139">This model is similar to the way ASMX pages are represented inside of an IIS application as .asmx files.</span></span> <span data-ttu-id="d58eb-140">.svc 檔案包含 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]的專用處理指示詞 ([@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md))，可允許 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 裝載基礎結構啟動裝載的服務來因應傳入的訊息。</span><span class="sxs-lookup"><span data-stu-id="d58eb-140">A .svc file contains a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]-specific processing directive ([@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md)) that allows the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] hosting infrastructure to activate hosted services in response to incoming messages.</span></span> <span data-ttu-id="d58eb-141">以下是 .svc 檔案最常見的語法：</span><span class="sxs-lookup"><span data-stu-id="d58eb-141">The most common syntax for a .svc file is in the following statement.</span></span>  
  
```  
<% @ServiceHost Service="MyNamespace.MyServiceImplementationTypeName" %>  
```  
  
 <span data-ttu-id="d58eb-142">此語法包含 [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md) 指示詞與一個屬性 `Service`。</span><span class="sxs-lookup"><span data-stu-id="d58eb-142">It consists of the [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md) directive and a single attribute, `Service`.</span></span> <span data-ttu-id="d58eb-143">`Service` 屬性值就是服務實作的 Common Language Runtime (CLR) 型別名稱。</span><span class="sxs-lookup"><span data-stu-id="d58eb-143">The value of the `Service` attribute is the common language runtime (CLR) type name of the service implementation.</span></span> <span data-ttu-id="d58eb-144">基本上，使用此指示詞與使用下列程式碼來建立服務主機是一樣的：</span><span class="sxs-lookup"><span data-stu-id="d58eb-144">Using this directive is basically equivalent to creating a service host using the following code.</span></span>  
  
```  
new ServiceHost( typeof( MyNamespace.MyServiceImplementationTypeName ) );  
```  
  
 <span data-ttu-id="d58eb-145">其他的裝載組態，例如建立服務的基底位址清單，也能夠透過此方式來完成。</span><span class="sxs-lookup"><span data-stu-id="d58eb-145">Additional hosting configuration, such as creating a list of base addresses for the service can also be done.</span></span> <span data-ttu-id="d58eb-146">您也可以使用自訂的 <xref:System.ServiceModel.Activation.ServiceHostFactory> 來延伸指示詞，以便搭配自訂裝載方案來使用。</span><span class="sxs-lookup"><span data-stu-id="d58eb-146">You can also use a custom <xref:System.ServiceModel.Activation.ServiceHostFactory> to extend the directive for use with custom hosting solutions.</span></span> <span data-ttu-id="d58eb-147">裝載 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務的 IIS 應用程式不負責管理 <xref:System.ServiceModel.ServiceHost> 執行個體的建立與存留期。</span><span class="sxs-lookup"><span data-stu-id="d58eb-147">The IIS applications that host [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services are not responsible for managing the creation and lifetime of <xref:System.ServiceModel.ServiceHost> instances.</span></span> <span data-ttu-id="d58eb-148">Managed [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 裝載基礎結構會在第一次收到 .svc 檔案要求時，動態建立必要的 <xref:System.ServiceModel.ServiceHost> 執行個體。</span><span class="sxs-lookup"><span data-stu-id="d58eb-148">The managed [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] hosting infrastructure creates the necessary <xref:System.ServiceModel.ServiceHost> instance dynamically when the first request is received for the .svc file.</span></span> <span data-ttu-id="d58eb-149">除非程式碼明確地關閉此執行個體，或當應用程式已回收時，才會釋放此執行個體。</span><span class="sxs-lookup"><span data-stu-id="d58eb-149">The instance is not released until either it is closed explicitly by code or when the application is recycled.</span></span>  
  
 [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="d58eb-150"> 之 .svc 檔案語法的詳細資訊，請參閱 [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-150"> the syntax for .svc files, see [@ServiceHost](../../../../docs/framework/configure-apps/file-schema/wcf-directive/servicehost.md).</span></span>  
  
## <a name="deploy-the-service-implementation-to-the-iis-application"></a><span data-ttu-id="d58eb-151">將服務實作部署到 IIS 應用程式</span><span class="sxs-lookup"><span data-stu-id="d58eb-151">Deploy the Service Implementation to the IIS Application</span></span>  
 <span data-ttu-id="d58eb-152">裝載在 IIS 中的[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務會使用與 [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)]相同的動態編譯模型。</span><span class="sxs-lookup"><span data-stu-id="d58eb-152">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in IIS use the same dynamic compilation model as [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)].</span></span> <span data-ttu-id="d58eb-153">就像 [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)]，您可以透過好幾種方式，將 IIS 裝載的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務的實作程式碼部署到幾個不同的位置，如下所示：</span><span class="sxs-lookup"><span data-stu-id="d58eb-153">Just as with [!INCLUDE[vstecasp](../../../../includes/vstecasp-md.md)], you can deploy the implementation code for IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services in several ways at various locations, as follows:</span></span>  
  
-   <span data-ttu-id="d58eb-154">做為預先編譯的 .dll 檔，位於全域組件快取 (GAC) 或應用程式的 \bin 目錄中。</span><span class="sxs-lookup"><span data-stu-id="d58eb-154">As a precompiled .dll file located in the global assembly cache (GAC) or in the application’s \bin directory.</span></span> <span data-ttu-id="d58eb-155">預先編譯的二進位檔會等到部署了新版本的類別庫之後才會更新。</span><span class="sxs-lookup"><span data-stu-id="d58eb-155">Precompiled binaries are not updated until a new version of the class library is deployed.</span></span>  
  
-   <span data-ttu-id="d58eb-156">成為未編譯的來源檔，位於應用程式的 \App_Code 目錄中。</span><span class="sxs-lookup"><span data-stu-id="d58eb-156">As un-compiled source files located in the application’s \App_Code directory.</span></span> <span data-ttu-id="d58eb-157">位於此目錄的來源檔會在處理應用程式的第一個要求時動態需要。</span><span class="sxs-lookup"><span data-stu-id="d58eb-157">Source files located in this directory are dynamically required when processing the application’s first request.</span></span> <span data-ttu-id="d58eb-158">在收到下一個要求時，對 \App_Code 目錄中檔案的任何變更都會導致整個應用程式的回收與重新編譯。</span><span class="sxs-lookup"><span data-stu-id="d58eb-158">Any changes to files in the \App_Code directory cause the entire application to be recycled and recompiled when the next request is received.</span></span>  
  
-   <span data-ttu-id="d58eb-159">成為未編譯的程式碼，直接位於 .svc 檔案中。</span><span class="sxs-lookup"><span data-stu-id="d58eb-159">As un-compiled code placed directly in the .svc file.</span></span> <span data-ttu-id="d58eb-160">實作程式碼也可以內嵌在服務的.svc 檔案中，位於後@ServiceHost指示詞。</span><span class="sxs-lookup"><span data-stu-id="d58eb-160">Implementation code can also be located inline in the service’s .svc file, after the @ServiceHost directive.</span></span> <span data-ttu-id="d58eb-161">在收到下一個要求時，對內嵌程式碼的任何變更都會導致整個應用程式的回收與重新編譯。</span><span class="sxs-lookup"><span data-stu-id="d58eb-161">Any changes to inline code cause the application to be recycled and recompiled when the next request is received.</span></span>  
  
 <span data-ttu-id="d58eb-162">如需[!INCLUDE[crabout](../../../../includes/crabout-md.md)]  [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] 編譯模型的詳細資訊，請參閱 [ASP.NET 編譯概觀](http://go.microsoft.com/fwlink/?LinkId=94773)。</span><span class="sxs-lookup"><span data-stu-id="d58eb-162">[!INCLUDE[crabout](../../../../includes/crabout-md.md)] the [!INCLUDE[vstecasplong](../../../../includes/vstecasplong-md.md)] compilation model, see [ASP.NET Compilation Overview](http://go.microsoft.com/fwlink/?LinkId=94773).</span></span>  
  
## <a name="configure-the-wcf-service"></a><span data-ttu-id="d58eb-163">設定 WCF 服務</span><span class="sxs-lookup"><span data-stu-id="d58eb-163">Configure the WCF Service</span></span>  
 <span data-ttu-id="d58eb-164">IIS 裝載的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務會將其組態儲存在應用程式的 Web.config 檔案中。</span><span class="sxs-lookup"><span data-stu-id="d58eb-164">IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services store their configuration in the applications Web.config file.</span></span> <span data-ttu-id="d58eb-165">IIS 裝載的服務會使用與在 IIS 外部裝載的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務相同的組態項目與語法。</span><span class="sxs-lookup"><span data-stu-id="d58eb-165">IIS-hosted services use the same configuration elements and syntax as [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted outside of IIS.</span></span> <span data-ttu-id="d58eb-166">然而，IIS 裝載環境具備了下列特殊限制：</span><span class="sxs-lookup"><span data-stu-id="d58eb-166">However, the following constraints are unique to the IIS hosting environment:</span></span>  
  
-   <span data-ttu-id="d58eb-167">IIS 裝載服務的基底位址。</span><span class="sxs-lookup"><span data-stu-id="d58eb-167">Base addresses for IIS-hosted services.</span></span>  
  
-   <span data-ttu-id="d58eb-168">主控應用程式[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]IIS 外部的服務可以控制所傳遞的基底的一組位址的 Uri 來裝載的服務的基底位址<xref:System.ServiceModel.ServiceHost>建構函式或藉由提供[\<主機 >](../../../../docs/framework/configure-apps/file-schema/wcf/host.md)服務組態中的項目。</span><span class="sxs-lookup"><span data-stu-id="d58eb-168">Applications hosting [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services outside of IIS can control the base address of the services they host by passing a set of base address URIs to the <xref:System.ServiceModel.ServiceHost> constructor or by providing a [\<host>](../../../../docs/framework/configure-apps/file-schema/wcf/host.md) element in the service’s configuration.</span></span> <span data-ttu-id="d58eb-169">IIS 所裝載的服務無法控制自己的基底位址；IIS 裝載服務的基底位址就是所屬 .svc 檔案的位址。</span><span class="sxs-lookup"><span data-stu-id="d58eb-169">Services hosted in IIS do not have the ability to control their base address; the base address of an IIS-hosted service is the address of its .svc file.</span></span>  
  
### <a name="endpoint-addresses-for-iis-hosted-services"></a><span data-ttu-id="d58eb-170">IIS 裝載服務的端點位址</span><span class="sxs-lookup"><span data-stu-id="d58eb-170">Endpoint Addresses for IIS-Hosted Services</span></span>  
 <span data-ttu-id="d58eb-171">透過 IIS 裝載時，端點位址一律視為相對於 .svc 檔案 (用來代表服務) 的位址。</span><span class="sxs-lookup"><span data-stu-id="d58eb-171">When hosted in IIS, endpoint addresses are always considered to be relative to the address of the .svc file that represents the service.</span></span> <span data-ttu-id="d58eb-172">例如，如果 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務的起始位址為包含下列端點組態的 http://localhost/Application1/MyService.svc。</span><span class="sxs-lookup"><span data-stu-id="d58eb-172">For example, if the base address of a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] service is http://localhost/Application1/MyService.svc with the following endpoint configuration.</span></span>  
  
```xml  
<endpoint address="anotherEndpoint" .../>  
```  
  
 <span data-ttu-id="d58eb-173">這會提供可以透過 "http://localhost/Application1/MyService.svc/anotherEndpoint" 抵達的端點。</span><span class="sxs-lookup"><span data-stu-id="d58eb-173">This provides an endpoint that can be reached at "http://localhost/Application1/MyService.svc/anotherEndpoint".</span></span>  
  
 <span data-ttu-id="d58eb-174">同理，使用空字串當成相對位址的端點組態項目也會提供可透過 http://localhost/Application1/MyService.svc (亦即基底位址) 抵達的端點。</span><span class="sxs-lookup"><span data-stu-id="d58eb-174">Similarly, the endpoint configuration element that uses an empty string as the relative address provides an endpoint reachable at http://localhost/Application1/MyService.svc, which is the base address.</span></span>  
  
```xml  
<endpoint address="" ... />  
```  
  
 <span data-ttu-id="d58eb-175">請務必針對 IIS 裝載服務端點使用相對端點位址。</span><span class="sxs-lookup"><span data-stu-id="d58eb-175">You must always use relative endpoint addresses for IIS-hosted service endpoints.</span></span> <span data-ttu-id="d58eb-176">如果端點位址並未指向 IIS 應用程式 (負責裝載會公開端點的服務)，則提供完整的端點位址 (例如，http://localhost/MyService.svc) 可能會在部署服務時導致錯誤。</span><span class="sxs-lookup"><span data-stu-id="d58eb-176">Supplying a fully-qualified endpoint address (for example, http://localhost/MyService.svc) can lead to errors in the deployment of the service if the endpoint address does not point to the IIS-application that hosts the service exposing the endpoint.</span></span> <span data-ttu-id="d58eb-177">針對裝載的服務使用相對端點位址可以避免這些潛在的衝突。</span><span class="sxs-lookup"><span data-stu-id="d58eb-177">Using relative endpoint addresses for hosted services avoids these potential conflicts.</span></span>  
  
### <a name="available-transports"></a><span data-ttu-id="d58eb-178">可用的傳輸</span><span class="sxs-lookup"><span data-stu-id="d58eb-178">Available Transports</span></span>  
 <span data-ttu-id="d58eb-179">IIS 5.1 和[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 所裝載的 [!INCLUDE[iis601](../../../../includes/iis601-md.md)] 服務僅限於使用 HTTP 通訊。</span><span class="sxs-lookup"><span data-stu-id="d58eb-179">[!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services hosted in IIS 5.1 and [!INCLUDE[iis601](../../../../includes/iis601-md.md)] are restricted to using HTTP-based communication.</span></span> <span data-ttu-id="d58eb-180">在這些 IIS 平台上，設定裝載的服務來使用非 HTTP 繫結會在服務啟動期間導致錯誤。</span><span class="sxs-lookup"><span data-stu-id="d58eb-180">On these IIS platforms, configuring a hosted service to use a non-HTTP binding results in an error during service activation.</span></span> <span data-ttu-id="d58eb-181">在 [!INCLUDE[iisver](../../../../includes/iisver-md.md)]上，支援的傳輸包括 HTTP、Net.TCP、Net.Pipe、Net.MSMQ，和 msmq.formatname，以便提供與現有 MSMQ 應用程式的回溯相容性。</span><span class="sxs-lookup"><span data-stu-id="d58eb-181">For [!INCLUDE[iisver](../../../../includes/iisver-md.md)], the supported transports include HTTP, Net.TCP, Net.Pipe, Net.MSMQ, and msmq.formatname for backwards compatibility with existing MSMQ applications.</span></span>  
  
### <a name="http-transport-security"></a><span data-ttu-id="d58eb-182">HTTP 傳輸安全性</span><span class="sxs-lookup"><span data-stu-id="d58eb-182">HTTP Transport Security</span></span>  
 <span data-ttu-id="d58eb-183">IIS 裝載的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 服務可以利用 HTTP 傳輸安全性 (例如，使用基本、摘要式與 Windows 整合式驗證的 HTTPS 和 HTTP 驗證配置)，只要包含服務的 IIS 虛擬目錄支援這些設定即可。</span><span class="sxs-lookup"><span data-stu-id="d58eb-183">IIS-hosted [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] services can make use of HTTP transport security (for example, HTTPS and HTTP authentication schemes such as Basic, Digest, and Windows Integrated Authentication) as long as the IIS virtual directory that contains the service supports those settings.</span></span> <span data-ttu-id="d58eb-184">裝載端點繫結上的 HTTP 傳輸安全性設定必須符合包含該設定之 IIS 虛擬目錄上的傳輸安全性設定。</span><span class="sxs-lookup"><span data-stu-id="d58eb-184">The HTTP Transport Security settings on a hosted endpoint’s binding must match the transport security settings on the IIS virtual directory that contains it.</span></span>  
  
 <span data-ttu-id="d58eb-185">例如，設定為使用 HTTP 摘要式驗證的 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 端點必須駐留在同時設定為允許使用 HTTP 摘要式驗證的 IIS 虛擬目錄中。</span><span class="sxs-lookup"><span data-stu-id="d58eb-185">For example, a [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint configured to use HTTP digest authentication must reside in an IIS virtual directory that is also configured to allow HTTP digest authentication.</span></span> <span data-ttu-id="d58eb-186">如果 IIS 設定與 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] 端點設定組合不相符，會在服務啟動期間導致錯誤。</span><span class="sxs-lookup"><span data-stu-id="d58eb-186">Unmatched combinations of IIS settings and [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] endpoint settings result in an error during service activation.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d58eb-187">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d58eb-187">See Also</span></span>  
 [<span data-ttu-id="d58eb-188">裝載在 Internet Information Services</span><span class="sxs-lookup"><span data-stu-id="d58eb-188">Hosting in Internet Information Services</span></span>](../../../../docs/framework/wcf/feature-details/hosting-in-internet-information-services.md)  
 [<span data-ttu-id="d58eb-189">網際網路資訊服務裝載最佳做法</span><span class="sxs-lookup"><span data-stu-id="d58eb-189">Internet Information Services Hosting Best Practices</span></span>](../../../../docs/framework/wcf/feature-details/internet-information-services-hosting-best-practices.md)  
 [<span data-ttu-id="d58eb-190">Windows Server App Fabric 裝載功能</span><span class="sxs-lookup"><span data-stu-id="d58eb-190">Windows Server App Fabric Hosting Features</span></span>](http://go.microsoft.com/fwlink/?LinkId=201276)
