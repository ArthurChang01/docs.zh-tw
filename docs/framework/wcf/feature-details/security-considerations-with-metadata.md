---
title: 中繼資料的安全性考量
ms.date: 03/30/2017
ms.assetid: e78ef8ab-4f63-4656-ab93-b1deab2666d5
ms.openlocfilehash: 0dc060475f868923e8c7e4c87ef43ef5912c7ac5
ms.sourcegitcommit: 9b552addadfb57fab0b9e7852ed4f1f1b8a42f8e
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/23/2019
ms.locfileid: "61748365"
---
# <a name="security-considerations-with-metadata"></a><span data-ttu-id="812aa-102">中繼資料的安全性考量</span><span class="sxs-lookup"><span data-stu-id="812aa-102">Security Considerations with Metadata</span></span>
<span data-ttu-id="812aa-103">當 Windows Communication Foundation (WCF) 中使用的中繼資料功能，請考慮發行、 擷取和使用服務中繼資料的安全性含意。</span><span class="sxs-lookup"><span data-stu-id="812aa-103">When using the metadata features in Windows Communication Foundation (WCF), consider the security implications of publishing, retrieving, and using service metadata.</span></span>  
  
## <a name="when-to-publish-metadata"></a><span data-ttu-id="812aa-104">發行中繼資料的時機</span><span class="sxs-lookup"><span data-stu-id="812aa-104">When to Publish Metadata</span></span>  
 <span data-ttu-id="812aa-105">根據預設，WCF 服務不要發佈中繼資料。</span><span class="sxs-lookup"><span data-stu-id="812aa-105">WCF services do not publish metadata by default.</span></span> <span data-ttu-id="812aa-106">若要發佈的 WCF 服務中繼資料您必須明確啟用中繼資料發行中繼資料端點新增至您的服務 (請參閱[中繼資料發行](../../../../docs/framework/wcf/feature-details/publishing-metadata.md))。</span><span class="sxs-lookup"><span data-stu-id="812aa-106">To publish metadata for a WCF service you must explicitly enable metadata publishing by adding metadata endpoints to your service (see [Publishing Metadata](../../../../docs/framework/wcf/feature-details/publishing-metadata.md)).</span></span> <span data-ttu-id="812aa-107">停用中繼資料發行則會降低服務的攻擊面，並降低非預期資料暴露的風險。</span><span class="sxs-lookup"><span data-stu-id="812aa-107">Leaving metadata publishing disabled reduces the attack surface for your service and lowers the risk of unintentional information disclosure.</span></span> <span data-ttu-id="812aa-108">不是所有服務都必須發行中繼資料。</span><span class="sxs-lookup"><span data-stu-id="812aa-108">Not all services must publish metadata.</span></span> <span data-ttu-id="812aa-109">如果您不需要發行中繼資料，可以考慮關閉這個功能。</span><span class="sxs-lookup"><span data-stu-id="812aa-109">If you do not have to publish metadata, consider leaving it turned off.</span></span> <span data-ttu-id="812aa-110">請注意，仍然可以直接從您使用的服務組件產生中繼資料和用戶端程式碼[ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md)。</span><span class="sxs-lookup"><span data-stu-id="812aa-110">Note that you can still generate metadata and client code directly from your service assemblies using the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="812aa-111">如需使用 Svcutil.exe 來匯出中繼資料的詳細資訊，請參閱[How to:使用 Svcutil.exe 來匯出編譯的服務程式碼的中繼資料](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md)。</span><span class="sxs-lookup"><span data-stu-id="812aa-111">For more information about using Svcutil.exe to export metadata, see [How to: Use Svcutil.exe to Export Metadata from Compiled Service Code](../../../../docs/framework/wcf/feature-details/how-to-use-svcutil-exe-to-export-metadata-from-compiled-service-code.md).</span></span>  
  
## <a name="publishing-metadata-using-a-secure-binding"></a><span data-ttu-id="812aa-112">使用安全繫結發行中繼資料</span><span class="sxs-lookup"><span data-stu-id="812aa-112">Publishing Metadata Using a Secure Binding</span></span>  
 <span data-ttu-id="812aa-113">WCF 會提供不安全的預設中繼資料繫結也允許匿名存取中繼資料。</span><span class="sxs-lookup"><span data-stu-id="812aa-113">The default metadata bindings that WCF provides are not secure and they allow anonymous access to the metadata.</span></span> <span data-ttu-id="812aa-114">WCF 服務發行服務中繼資料包含有關服務的詳細的描述，並可能有意或無意包含敏感資訊。</span><span class="sxs-lookup"><span data-stu-id="812aa-114">The service metadata that a WCF service publishes contains a detailed description about the service and may intentionally or unintentionally contain sensitive information.</span></span> <span data-ttu-id="812aa-115">例如，服務中繼資料可能包含原意不是要公開廣播的基礎結構作業的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="812aa-115">For example, service metadata may contain information about infrastructure operations that was not intended to be broadcast publicly.</span></span> <span data-ttu-id="812aa-116">若要防止未經授權存取服務中繼資料，您可以在中繼資料端點中使用安全繫結。</span><span class="sxs-lookup"><span data-stu-id="812aa-116">To protect service metadata from unauthorized access, you can use a secure binding for your metadata endpoint.</span></span> <span data-ttu-id="812aa-117">中繼資料端點會回應至使用 Secure Sockets Layer (SSL) 來確保中繼資料安全的 HTTP/GET 要求。</span><span class="sxs-lookup"><span data-stu-id="812aa-117">Metadata endpoints respond to HTTP/GET requests that can use Secure Sockets Layer (SSL) to secure the metadata.</span></span> <span data-ttu-id="812aa-118">如需詳細資訊，請參閱[如何：確保中繼資料端點的安全](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)。</span><span class="sxs-lookup"><span data-stu-id="812aa-118">For more information, see [How to: Secure Metadata Endpoints](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md).</span></span>  
  
 <span data-ttu-id="812aa-119">確保中繼資料端點的安全同樣能對要求者提供一種方法，可安全地擷取服務中繼資料而避免遇到竄改或詐騙等風險。</span><span class="sxs-lookup"><span data-stu-id="812aa-119">Securing your metadata endpoints also provides a way for requesters to securely retrieve service metadata without the risk of tampering or spoofing.</span></span>  
  
## <a name="using-only-trusted-metadata"></a><span data-ttu-id="812aa-120">僅使用信任的中繼資料</span><span class="sxs-lookup"><span data-stu-id="812aa-120">Using Only Trusted Metadata</span></span>  
 <span data-ttu-id="812aa-121">您可以使用服務中繼資料以自動建構呼叫服務時所需的執行階段元件。</span><span class="sxs-lookup"><span data-stu-id="812aa-121">You can use service metadata to automatically construct the run-time components required to call the service.</span></span> <span data-ttu-id="812aa-122">您也可以在設計階段時使用中繼資料以開發用戶端應用程式，或在執行階段時使用以更新用戶端用來呼叫服務的繫結。</span><span class="sxs-lookup"><span data-stu-id="812aa-122">You can also use metadata at design time to develop a client application or at runtime to dynamically update the binding a client uses to call a service.</span></span>  
  
 <span data-ttu-id="812aa-123">如果以不安全的方法擷取服務中繼資料，就可能遭到竄改或詐騙。</span><span class="sxs-lookup"><span data-stu-id="812aa-123">Service metadata can be tampered with or spoofed when retrieved in an insecure manner.</span></span> <span data-ttu-id="812aa-124">被竄改的中繼資料會將您的用戶端重新導向至惡意服務，其中並包含有害的安全性設定或惡意 XML 結構。</span><span class="sxs-lookup"><span data-stu-id="812aa-124">Tampered metadata can redirect your client to a malicious service, contain compromised security settings, or contain malicious XML structures.</span></span> <span data-ttu-id="812aa-125">中繼資料文件可能很大，並經常會儲存至檔案系統。</span><span class="sxs-lookup"><span data-stu-id="812aa-125">Metadata documents can be large and are frequently saved to the file system.</span></span> <span data-ttu-id="812aa-126">若要防止竄改和詐騙，請在具有安全繫結的情況下使用安全繫結來要求服務中繼資料。</span><span class="sxs-lookup"><span data-stu-id="812aa-126">To protect against tampering and spoofing, use a secure binding to request service metadata when one is available.</span></span>  
  
## <a name="using-safe-techniques-for-processing-metadata"></a><span data-ttu-id="812aa-127">使用安全技術來處理中繼資料</span><span class="sxs-lookup"><span data-stu-id="812aa-127">Using Safe Techniques for Processing Metadata</span></span>  
 <span data-ttu-id="812aa-128">將會使用標準化通訊協定 (例如 WS-MetadataExchange (MEX))，透過網路經常從服務擷取服務中繼資料。</span><span class="sxs-lookup"><span data-stu-id="812aa-128">Service metadata is frequently retrieved from a service over a network using standardized protocols such as WS-MetadataExchange (MEX).</span></span> <span data-ttu-id="812aa-129">許多中繼資料格式包括可指向其他中繼資料的參考機制。</span><span class="sxs-lookup"><span data-stu-id="812aa-129">Many metadata formats include referencing mechanisms for pointing to additional metadata.</span></span> <span data-ttu-id="812aa-130"><xref:System.ServiceModel.Description.MetadataExchangeClient> 型別會自動為您處理 Web 服務描述語言 (WSDL) 文件、XML 結構描述和 MEX 文件中的參考。</span><span class="sxs-lookup"><span data-stu-id="812aa-130">The <xref:System.ServiceModel.Description.MetadataExchangeClient> type automatically processes references for you in Web Services Description Language (WSDL) documents, XML Schema, and MEX documents.</span></span> <span data-ttu-id="812aa-131">從擷取的中繼資料所建立的 <xref:System.ServiceModel.Description.MetadataSet> 物件大小，則會直接與使用之 <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> 執行個體的 <xref:System.ServiceModel.Description.MetadataExchangeClient> 值成比例，也與該 `MaxReceivedMessageSize` 執行個體已使用的繫結 <xref:System.ServiceModel.Description.MetadataExchangeClient> 值成比例。</span><span class="sxs-lookup"><span data-stu-id="812aa-131">The size of the <xref:System.ServiceModel.Description.MetadataSet> object created from the retrieved metadata is directly proportional to the <xref:System.ServiceModel.Description.MetadataExchangeClient.MaximumResolvedReferences%2A> value for the <xref:System.ServiceModel.Description.MetadataExchangeClient> instance that is used and the `MaxReceivedMessageSize` value for the binding being used by that <xref:System.ServiceModel.Description.MetadataExchangeClient> instance.</span></span> <span data-ttu-id="812aa-132">根據案例的要求，將這些配額設定為適當的值。</span><span class="sxs-lookup"><span data-stu-id="812aa-132">Set these quotas to appropriate values as dictated by your scenario.</span></span>  
  
 <span data-ttu-id="812aa-133">在 WCF 中，服務中繼資料會當做 XML 處理。</span><span class="sxs-lookup"><span data-stu-id="812aa-133">In WCF, service metadata is processed as XML.</span></span> <span data-ttu-id="812aa-134">而在處理 XML 文件時，應用程式應該自我保護不會受到惡意 XML 結構的攻擊。</span><span class="sxs-lookup"><span data-stu-id="812aa-134">When processing XML documents, applications should protect themselves against malicious XML structures.</span></span> <span data-ttu-id="812aa-135">使用<xref:System.Xml.XmlDictionaryReader>與適當的配額時處理 XML，並且也設定了<xref:System.Xml.XmlTextReader.DtdProcessing%2A>屬性設<xref:System.Xml.DtdProcessing.Prohibit>。</span><span class="sxs-lookup"><span data-stu-id="812aa-135">Use the <xref:System.Xml.XmlDictionaryReader> with appropriate quotas when processing XML and also set the <xref:System.Xml.XmlTextReader.DtdProcessing%2A> property to <xref:System.Xml.DtdProcessing.Prohibit>.</span></span>  
  
 <span data-ttu-id="812aa-136">在 WCF 中的中繼資料系統加以擴充，而且可以在應用程式組態檔中註冊中繼資料延伸模組 (請參閱[擴充中繼資料系統](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md))。</span><span class="sxs-lookup"><span data-stu-id="812aa-136">The metadata system in WCF is extensible and metadata extensions can be registered in your application configuration file (see [Extending the Metadata System](../../../../docs/framework/wcf/extending/extending-the-metadata-system.md)).</span></span> <span data-ttu-id="812aa-137">中繼資料延伸項目可以執行任意程式碼，因此您應該使用適當的存取控制清單 (ACL) 來保護應用程式組態檔，並僅註冊信任的中繼資料延伸項目實作。</span><span class="sxs-lookup"><span data-stu-id="812aa-137">Metadata extensions can run arbitrary code, so you should protect your application configuration file with appropriate access control lists (ACLs) and register only trusted metadata extension implementations.</span></span>  
  
## <a name="validating-generated-clients"></a><span data-ttu-id="812aa-138">驗證產生的用戶端</span><span class="sxs-lookup"><span data-stu-id="812aa-138">Validating Generated Clients</span></span>  
 <span data-ttu-id="812aa-139">從擷取自不受信任來源的中繼資料產生用戶端程式碼時，請驗證產生的用戶端程式碼以確保產生的用戶端會遵照您的用戶端應用程式安全性原則。</span><span class="sxs-lookup"><span data-stu-id="812aa-139">When generating client code from metadata retrieved from a source that is not trusted, validate the generated client code to ensure that the generated client conforms to your client applications security policies.</span></span> <span data-ttu-id="812aa-140">您可以使用驗證行為來檢查用戶端繫結上的設定，或以視覺化方式檢查使用工具所產生的程式碼。</span><span class="sxs-lookup"><span data-stu-id="812aa-140">You can use a validating behavior to check settings on your client binding or visually inspect code generated by tools.</span></span> <span data-ttu-id="812aa-141">如需如何實作驗證行為的用戶端的範例，請參閱 <<c0> [ 用戶端驗證](../../../../docs/framework/wcf/samples/client-validation.md)。</span><span class="sxs-lookup"><span data-stu-id="812aa-141">For an example of how to implement a client that validates behaviors, see [Client Validation](../../../../docs/framework/wcf/samples/client-validation.md).</span></span>  
  
## <a name="protecting-application-configuration-files"></a><span data-ttu-id="812aa-142">保護應用程式組態檔</span><span class="sxs-lookup"><span data-stu-id="812aa-142">Protecting Application Configuration Files</span></span>  
 <span data-ttu-id="812aa-143">服務的應用程式組態檔可能會控制發行中繼資料的方法以及是否發行中繼資料。</span><span class="sxs-lookup"><span data-stu-id="812aa-143">A service's application configuration file may control how and if metadata is published.</span></span> <span data-ttu-id="812aa-144">強烈建議您透過適當的存取控制清單 (ACL) 來保護應用程式組態檔，以確保攻擊者無法修改這類設定。</span><span class="sxs-lookup"><span data-stu-id="812aa-144">It is a good idea to protect the application configuration file with appropriate access control lists (ACLs) to ensure an attacker cannot modify such settings.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="812aa-145">另請參閱</span><span class="sxs-lookup"><span data-stu-id="812aa-145">See also</span></span>

- [<span data-ttu-id="812aa-146">如何：確保中繼資料端點的安全</span><span class="sxs-lookup"><span data-stu-id="812aa-146">How to: Secure Metadata Endpoints</span></span>](../../../../docs/framework/wcf/feature-details/how-to-secure-metadata-endpoints.md)
- [<span data-ttu-id="812aa-147">安全性</span><span class="sxs-lookup"><span data-stu-id="812aa-147">Security</span></span>](../../../../docs/framework/wcf/feature-details/security.md)
