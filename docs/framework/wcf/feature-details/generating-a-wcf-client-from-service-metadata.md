---
title: 從服務中繼資料產生 WCF 用戶端
ms.date: 03/30/2017
ms.assetid: 27f8f545-cc44-412a-b104-617e0781b803
ms.openlocfilehash: 5cfbfc1e4be0003b3699f818212fbcd959f3ad91
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/18/2019
ms.locfileid: "59078248"
---
# <a name="generating-a-wcf-client-from-service-metadata"></a><span data-ttu-id="eb55e-102">從服務中繼資料產生 WCF 用戶端</span><span class="sxs-lookup"><span data-stu-id="eb55e-102">Generating a WCF Client from Service Metadata</span></span>
<span data-ttu-id="eb55e-103">本主題說明如何使用 Svcutil.exe 中不同的參數，從中繼資料文件中產生用戶端。</span><span class="sxs-lookup"><span data-stu-id="eb55e-103">This topic describes how to use the various switches in Svcutil.exe to generate clients from metadata documents.</span></span>  
  
 <span data-ttu-id="eb55e-104">中繼資料文件可以位於永久性儲存裝置上或在線上擷取。</span><span class="sxs-lookup"><span data-stu-id="eb55e-104">Metadata documents can be on a durable storage or be retrieved online.</span></span> <span data-ttu-id="eb55e-105">線上擷取會遵循 WS-MetadataExchange 通訊協定或 Microsoft Discovery (DISCO) 通訊協定。</span><span class="sxs-lookup"><span data-stu-id="eb55e-105">Online retrieval follows either the WS-MetadataExchange protocol or the Microsoft Discovery (DISCO) protocol.</span></span> <span data-ttu-id="eb55e-106">Svcutil.exe 會同時發出以下中繼資料要求，以擷取中繼資料：</span><span class="sxs-lookup"><span data-stu-id="eb55e-106">Svcutil.exe issues the following metadata requests simultaneously to retrieve metadata:</span></span>  
  
-   <span data-ttu-id="eb55e-107">對所提供位址的 WS-MetadataExchange (MEX) 要求。</span><span class="sxs-lookup"><span data-stu-id="eb55e-107">WS-MetadataExchange (MEX) request to the supplied address.</span></span>  
  
-   <span data-ttu-id="eb55e-108">對附加 `/mex` 之所提供位址的 MEX 要求。</span><span class="sxs-lookup"><span data-stu-id="eb55e-108">MEX request to the supplied address with `/mex` appended.</span></span>  
  
-   <span data-ttu-id="eb55e-109">DISCO 要求 (使用[DiscoveryClientProtocol](https://go.microsoft.com/fwlink/?LinkId=94777)從 ASP.NET Web 服務) 所提供的位址。</span><span class="sxs-lookup"><span data-stu-id="eb55e-109">DISCO request (using the [DiscoveryClientProtocol](https://go.microsoft.com/fwlink/?LinkId=94777) from ASP.NET Web services) to the supplied address.</span></span>  
  
 <span data-ttu-id="eb55e-110">Svcutil.exe 會根據 Web 服務描述語言 (WSDL) 或從服務收到的原則檔產生用戶端。</span><span class="sxs-lookup"><span data-stu-id="eb55e-110">Svcutil.exe generates the client based on the Web Services Description Language (WSDL) or policy file received from the service.</span></span> <span data-ttu-id="eb55e-111">使用者主體名稱 (UPN) 藉由串連使用者名稱與產生 「\@"，然後再新增一個完整網域名稱 (FQDN)。</span><span class="sxs-lookup"><span data-stu-id="eb55e-111">The user principal name (UPN) is generated by concatenating the user name with "\@" and then adding a fully-qualified domain name (FQDN).</span></span> <span data-ttu-id="eb55e-112">不過，在 Active Directory 上註冊的使用者，這種格式無效，此工具會產生的 UPN 會造成 Kerberos 驗證，並出現下列錯誤訊息中的失敗：**登入嘗試失敗。**</span><span class="sxs-lookup"><span data-stu-id="eb55e-112">However, for users who registered on Active Directory, this format is not valid and the UPN that the tool generates causes a failure in the Kerberos authentication with the following error message: **The logon attempt failed.**</span></span> <span data-ttu-id="eb55e-113">若要解決這個問題，請手動修復由此工具產生的用戶端檔案。</span><span class="sxs-lookup"><span data-stu-id="eb55e-113">To resolve this problem, manually fix the client file that the tool generated.</span></span>  
  
```  
svcutil.exe [/t:code]  <metadataDocumentPath>* | <url>* | <epr>  
```  
  
## <a name="referencing-and-sharing-types"></a><span data-ttu-id="eb55e-114">參照與共用型別</span><span class="sxs-lookup"><span data-stu-id="eb55e-114">Referencing and Sharing Types</span></span>  
  
|<span data-ttu-id="eb55e-115">選項</span><span class="sxs-lookup"><span data-stu-id="eb55e-115">Option</span></span>|<span data-ttu-id="eb55e-116">描述</span><span class="sxs-lookup"><span data-stu-id="eb55e-116">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="eb55e-117">**/reference:\<檔案路徑 >**</span><span class="sxs-lookup"><span data-stu-id="eb55e-117">**/reference:\<file path>**</span></span>|<span data-ttu-id="eb55e-118">參考指定組件中的型別。</span><span class="sxs-lookup"><span data-stu-id="eb55e-118">References types in the specified assembly.</span></span> <span data-ttu-id="eb55e-119">產生用戶端時，使用這個選項即可指定組件，這些組件可能包含代表匯入之中繼資料的類型。</span><span class="sxs-lookup"><span data-stu-id="eb55e-119">When generating clients, use this option to specify assemblies that might contain types that represent the metadata being imported.</span></span><br /><br /> <span data-ttu-id="eb55e-120">簡短形式：`/r`</span><span class="sxs-lookup"><span data-stu-id="eb55e-120">Short form: `/r`</span></span>|  
|<span data-ttu-id="eb55e-121">**/excludeType:\<type>**</span><span class="sxs-lookup"><span data-stu-id="eb55e-121">**/excludeType:\<type>**</span></span>|<span data-ttu-id="eb55e-122">指定要從參考的合約類型排除的完整型別名稱或組件限定型別名稱。</span><span class="sxs-lookup"><span data-stu-id="eb55e-122">Specifies a fully-qualified or assembly-qualified type name to be excluded from referenced contract types.</span></span><br /><br /> <span data-ttu-id="eb55e-123">簡短形式：`/et`</span><span class="sxs-lookup"><span data-stu-id="eb55e-123">Short form: `/et`</span></span>|  
  
## <a name="choosing-a-serializer"></a><span data-ttu-id="eb55e-124">選擇序列化程式</span><span class="sxs-lookup"><span data-stu-id="eb55e-124">Choosing a Serializer</span></span>  
  
|<span data-ttu-id="eb55e-125">選項</span><span class="sxs-lookup"><span data-stu-id="eb55e-125">Option</span></span>|<span data-ttu-id="eb55e-126">描述</span><span class="sxs-lookup"><span data-stu-id="eb55e-126">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="eb55e-127">**/serializer:Auto**</span><span class="sxs-lookup"><span data-stu-id="eb55e-127">**/serializer:Auto**</span></span>|<span data-ttu-id="eb55e-128">自動選取序列化程式。</span><span class="sxs-lookup"><span data-stu-id="eb55e-128">Automatically selects the serializer.</span></span> <span data-ttu-id="eb55e-129">這會使用 `DataContract` 序列化程式。</span><span class="sxs-lookup"><span data-stu-id="eb55e-129">This uses the `DataContract` serializer.</span></span> <span data-ttu-id="eb55e-130">如果這個作業失敗，則使用 `XmlSerializer`。</span><span class="sxs-lookup"><span data-stu-id="eb55e-130">If this fails, the `XmlSerializer` is used.</span></span><br /><br /> <span data-ttu-id="eb55e-131">簡短形式：`/ser:Auto`</span><span class="sxs-lookup"><span data-stu-id="eb55e-131">Short Form: `/ser:Auto`</span></span>|  
|<span data-ttu-id="eb55e-132">**/serializer:DataContractSerializer**</span><span class="sxs-lookup"><span data-stu-id="eb55e-132">**/serializer:DataContractSerializer**</span></span>|<span data-ttu-id="eb55e-133">產生使用 `DataContract` 序列化程式以進行序列化與還原序列化的資料型別。</span><span class="sxs-lookup"><span data-stu-id="eb55e-133">Generates data types that use the `DataContract` serializer for serialization and deserialization.</span></span><br /><br /> <span data-ttu-id="eb55e-134">簡短形式：`/ser:DataContractSerializer`</span><span class="sxs-lookup"><span data-stu-id="eb55e-134">Short form: `/ser:DataContractSerializer`</span></span>|  
|<span data-ttu-id="eb55e-135">**/serializer:XmlSerializer**</span><span class="sxs-lookup"><span data-stu-id="eb55e-135">**/serializer:XmlSerializer**</span></span>|<span data-ttu-id="eb55e-136">產生使用 `XmlSerializer` 以進行序列化與還原序列化的資料型別。</span><span class="sxs-lookup"><span data-stu-id="eb55e-136">Generates data types that use the `XmlSerializer` for serialization and deserialization.</span></span><br /><br /> <span data-ttu-id="eb55e-137">簡短形式：`/ser:XmlSerializer`</span><span class="sxs-lookup"><span data-stu-id="eb55e-137">Short form: `/ser:XmlSerializer`</span></span>|  
|<span data-ttu-id="eb55e-138">**/importXmlTypes**</span><span class="sxs-lookup"><span data-stu-id="eb55e-138">**/importXmlTypes**</span></span>|<span data-ttu-id="eb55e-139">設定 `DataContract` 序列化程式將非 `DataContract` 型別匯入為 `IXmlSerializable` 型別。</span><span class="sxs-lookup"><span data-stu-id="eb55e-139">Configures the `DataContract` serializer to import non-`DataContract` types as `IXmlSerializable` types.</span></span><br /><br /> <span data-ttu-id="eb55e-140">簡短形式：`/ixt`</span><span class="sxs-lookup"><span data-stu-id="eb55e-140">Short form: `/ixt`</span></span>|  
|<span data-ttu-id="eb55e-141">**/dataContractOnly**</span><span class="sxs-lookup"><span data-stu-id="eb55e-141">**/dataContractOnly**</span></span>|<span data-ttu-id="eb55e-142">只產生 `DataContract` 型別的程式碼。</span><span class="sxs-lookup"><span data-stu-id="eb55e-142">Generates code for `DataContract` types only.</span></span> <span data-ttu-id="eb55e-143">會產生 `ServiceContract` 型別。</span><span class="sxs-lookup"><span data-stu-id="eb55e-143">`ServiceContract` types are generated.</span></span><br /><br /> <span data-ttu-id="eb55e-144">這個選項應該只能指定本機中繼資料檔案。</span><span class="sxs-lookup"><span data-stu-id="eb55e-144">You should specify only local metadata files for this option.</span></span><br /><br /> <span data-ttu-id="eb55e-145">簡短形式：`/dconly`</span><span class="sxs-lookup"><span data-stu-id="eb55e-145">Short form: `/dconly`</span></span>|  
  
## <a name="choosing-a-language-for-the-client"></a><span data-ttu-id="eb55e-146">選擇用戶端語言</span><span class="sxs-lookup"><span data-stu-id="eb55e-146">Choosing a Language for the Client</span></span>  
  
|<span data-ttu-id="eb55e-147">選項</span><span class="sxs-lookup"><span data-stu-id="eb55e-147">Option</span></span>|<span data-ttu-id="eb55e-148">描述</span><span class="sxs-lookup"><span data-stu-id="eb55e-148">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="eb55e-149">**/language:\<language>**</span><span class="sxs-lookup"><span data-stu-id="eb55e-149">**/language:\<language>**</span></span>|<span data-ttu-id="eb55e-150">指定要用於產生程式碼的程式語言。</span><span class="sxs-lookup"><span data-stu-id="eb55e-150">Specifies the programming language to use for code generation.</span></span> <span data-ttu-id="eb55e-151">請提供在 Machine.config 檔案中註冊的語言名稱，或繼承自 <xref:System.CodeDom.Compiler.CodeDomProvider> 之類別的完整名稱。</span><span class="sxs-lookup"><span data-stu-id="eb55e-151">Provide either a language name registered in the Machine.config file or the fully-qualified name of a class that inherits from <xref:System.CodeDom.Compiler.CodeDomProvider>.</span></span><br /><br /> <span data-ttu-id="eb55e-152">值：C#、cs、csharp、vb、vbs、visualbasic、vbscript、javascript、c++、mc、cpp</span><span class="sxs-lookup"><span data-stu-id="eb55e-152">Values: c#, cs, csharp, vb, vbs, visualbasic, vbscript, javascript, c++, mc, cpp</span></span><br /><br /> <span data-ttu-id="eb55e-153">預設：csharp</span><span class="sxs-lookup"><span data-stu-id="eb55e-153">Default: csharp</span></span><br /><br /> <span data-ttu-id="eb55e-154">簡短形式：`/l`</span><span class="sxs-lookup"><span data-stu-id="eb55e-154">Short form: `/l`</span></span><br /><br /> <span data-ttu-id="eb55e-155">如需詳細資訊，請參閱 < [CodeDomProvider 類別](https://go.microsoft.com/fwlink/?LinkId=94778)。</span><span class="sxs-lookup"><span data-stu-id="eb55e-155">For more information, see [CodeDomProvider Class](https://go.microsoft.com/fwlink/?LinkId=94778).</span></span>|  
  
## <a name="choosing-a-namespace-for-the-client"></a><span data-ttu-id="eb55e-156">選擇用戶端命名空間</span><span class="sxs-lookup"><span data-stu-id="eb55e-156">Choosing a Namespace for the Client</span></span>  
  
|<span data-ttu-id="eb55e-157">選項</span><span class="sxs-lookup"><span data-stu-id="eb55e-157">Option</span></span>|<span data-ttu-id="eb55e-158">描述</span><span class="sxs-lookup"><span data-stu-id="eb55e-158">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="eb55e-159">**/namespace:\<string,string>**</span><span class="sxs-lookup"><span data-stu-id="eb55e-159">**/namespace:\<string,string>**</span></span>|<span data-ttu-id="eb55e-160">指定從 WSDL 或 XML 結構描述 `targetNamespace` 到 Common Language Runtime (CLR) 命名空間的對應。</span><span class="sxs-lookup"><span data-stu-id="eb55e-160">Specifies a mapping from a WSDL or XML Schema `targetNamespace` to a common language runtime (CLR) namespace.</span></span> <span data-ttu-id="eb55e-161">使用萬用字元 (\*) 做為 `targetNamespace` 會對應至所有的 `targetNamespaces`，而不會明確對應至該 CLR 命名空間。</span><span class="sxs-lookup"><span data-stu-id="eb55e-161">Using a wildcard (\*) for the `targetNamespace` maps all `targetNamespaces` without an explicit mapping to that CLR namespace.</span></span><br /><br /> <span data-ttu-id="eb55e-162">為了確保訊息合約名稱不會與作業名稱衝突，您應該以雙冒號 (`::`) 來限定型別參照，或確定名稱為唯一。</span><span class="sxs-lookup"><span data-stu-id="eb55e-162">To make sure that the message contract name does not collide with the operation name, either qualify the type reference with double colons (`::`) or make sure the names are unique.</span></span><br /><br /> <span data-ttu-id="eb55e-163">預設：衍生自結構描述文件的目標命名空間`DataContracts`。</span><span class="sxs-lookup"><span data-stu-id="eb55e-163">Default: Derived from the target namespace of the schema document for `DataContracts`.</span></span> <span data-ttu-id="eb55e-164">預設命名空間用於所有其他產生的型別。</span><span class="sxs-lookup"><span data-stu-id="eb55e-164">The default namespace is used for all other generated types.</span></span><br /><br /> <span data-ttu-id="eb55e-165">簡短形式：`/n`</span><span class="sxs-lookup"><span data-stu-id="eb55e-165">Short form: `/n`</span></span>|  
  
## <a name="choosing-a-data-binding"></a><span data-ttu-id="eb55e-166">選擇資料繫結</span><span class="sxs-lookup"><span data-stu-id="eb55e-166">Choosing a Data Binding</span></span>  
  
|<span data-ttu-id="eb55e-167">選項</span><span class="sxs-lookup"><span data-stu-id="eb55e-167">Option</span></span>|<span data-ttu-id="eb55e-168">描述</span><span class="sxs-lookup"><span data-stu-id="eb55e-168">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="eb55e-169">**/enableDataBinding**</span><span class="sxs-lookup"><span data-stu-id="eb55e-169">**/enableDataBinding**</span></span>|<span data-ttu-id="eb55e-170">在所有 <xref:System.ComponentModel.INotifyPropertyChanged> 型別上實作 `DataContract` 介面，以啟用資料繫結。</span><span class="sxs-lookup"><span data-stu-id="eb55e-170">Implements the <xref:System.ComponentModel.INotifyPropertyChanged> interface on all `DataContract` types to enable data binding.</span></span><br /><br /> <span data-ttu-id="eb55e-171">簡短形式：`/edb`</span><span class="sxs-lookup"><span data-stu-id="eb55e-171">Short form: `/edb`</span></span>|  
  
## <a name="generating-configuration"></a><span data-ttu-id="eb55e-172">產生組態</span><span class="sxs-lookup"><span data-stu-id="eb55e-172">Generating Configuration</span></span>  
  
|<span data-ttu-id="eb55e-173">選項</span><span class="sxs-lookup"><span data-stu-id="eb55e-173">Option</span></span>|<span data-ttu-id="eb55e-174">描述</span><span class="sxs-lookup"><span data-stu-id="eb55e-174">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="eb55e-175">**/config:\<configFile >**</span><span class="sxs-lookup"><span data-stu-id="eb55e-175">**/config:\<configFile>**</span></span>|<span data-ttu-id="eb55e-176">針對產生的組態檔指定檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="eb55e-176">Specifies the file name for the generated configuration file.</span></span><br /><br /> <span data-ttu-id="eb55e-177">預設：output.config</span><span class="sxs-lookup"><span data-stu-id="eb55e-177">Default: output.config</span></span>|  
|<span data-ttu-id="eb55e-178">**/mergeConfig**</span><span class="sxs-lookup"><span data-stu-id="eb55e-178">**/mergeConfig**</span></span>|<span data-ttu-id="eb55e-179">將產生的組態合併至現有檔案，而非覆寫現有檔案。</span><span class="sxs-lookup"><span data-stu-id="eb55e-179">Merges the generated configuration into an existing file, instead of overwriting the existing file.</span></span>|  
|<span data-ttu-id="eb55e-180">**/noConfig**</span><span class="sxs-lookup"><span data-stu-id="eb55e-180">**/noConfig**</span></span>|<span data-ttu-id="eb55e-181">不要產生組態檔。</span><span class="sxs-lookup"><span data-stu-id="eb55e-181">Do not generate configuration files.</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="eb55e-182">另請參閱</span><span class="sxs-lookup"><span data-stu-id="eb55e-182">See also</span></span>

- [<span data-ttu-id="eb55e-183">使用中繼資料</span><span class="sxs-lookup"><span data-stu-id="eb55e-183">Using Metadata</span></span>](../../../../docs/framework/wcf/feature-details/using-metadata.md)
- [<span data-ttu-id="eb55e-184">中繼資料架構概觀</span><span class="sxs-lookup"><span data-stu-id="eb55e-184">Metadata Architecture Overview</span></span>](../../../../docs/framework/wcf/feature-details/metadata-architecture-overview.md)
