---
title: 擴充用戶端
ms.date: 03/30/2017
helpviewer_keywords:
- proxy extensions [WCF]
ms.assetid: 1328c61c-06e5-455f-9ebd-ceefb59d3867
ms.openlocfilehash: 99b4dd5e4acfce8bea4d3c2cae3a53152585675d
ms.sourcegitcommit: 0be8a279af6d8a43e03141e349d3efd5d35f8767
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/18/2019
ms.locfileid: "59074751"
---
# <a name="extending-clients"></a><span data-ttu-id="dd56d-102">擴充用戶端</span><span class="sxs-lookup"><span data-stu-id="dd56d-102">Extending Clients</span></span>
<span data-ttu-id="dd56d-103">在呼叫應用程式中，服務模型層會負責使用應用程式程式碼將方法引動過程轉譯到傳出訊息中、將這些訊息推送到基礎通道、將結果轉譯回應用程式程式碼中的傳回值與 out 參數，並將結果傳回到呼叫端。</span><span class="sxs-lookup"><span data-stu-id="dd56d-103">In a calling application, the service model layer is responsible for translating method invocations in application code into outbound messages, pushing them to the underlying channels, translating results back into return values and out parameters in application code, and returning the results back to the caller.</span></span> <span data-ttu-id="dd56d-104">服務模型延伸會修改或實作涉及用戶端或發送器功能、自訂行為、訊息與參數攔截以及其他擴充性功能的執行或通訊行為與功能。</span><span class="sxs-lookup"><span data-stu-id="dd56d-104">Service model extensions modify or implement execution or communication behavior and features involving client or dispatcher functionality, custom behaviors, message and parameter interception, and other extensibility functionality.</span></span>  
  
 <span data-ttu-id="dd56d-105">本主題描述如何使用<xref:System.ServiceModel.Dispatcher.ClientRuntime>和<xref:System.ServiceModel.Dispatcher.ClientOperation>類別在 Windows Communication Foundation (WCF) 用戶端應用程式中修改預設的執行行為的 WCF 用戶端，或如何攔截或修改訊息、 參數或傳回值之前或之後傳送或擷取通道層。</span><span class="sxs-lookup"><span data-stu-id="dd56d-105">This topic describes how to use the <xref:System.ServiceModel.Dispatcher.ClientRuntime> and <xref:System.ServiceModel.Dispatcher.ClientOperation> classes in a Windows Communication Foundation (WCF) client application to modify the default execution behavior of a WCF client or to intercept or modify messages, parameters, or return values prior to or subsequent to sending or retrieving them from the channel layer.</span></span> <span data-ttu-id="dd56d-106">如需有關如何擴充服務執行階段的詳細資訊，請參閱[擴充發送器](../../../../docs/framework/wcf/extending/extending-dispatchers.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-106">For more information about extending the service runtime, see [Extending Dispatchers](../../../../docs/framework/wcf/extending/extending-dispatchers.md).</span></span> <span data-ttu-id="dd56d-107">如需修改，並將自訂物件插入至用戶端執行階段行為的詳細資訊，請參閱[設定和擴充執行階段行為](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-107">For more information about the behaviors that modify and insert customization objects into the client runtime, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
## <a name="clients"></a><span data-ttu-id="dd56d-108">用戶端</span><span class="sxs-lookup"><span data-stu-id="dd56d-108">Clients</span></span>  
 <span data-ttu-id="dd56d-109">在用戶端，WCF 用戶端物件或用戶端通道會將方法引動過程轉換成傳出訊息與作業結果傳回至呼叫的應用程式的內送訊息。</span><span class="sxs-lookup"><span data-stu-id="dd56d-109">On a client, a WCF client object or client channel converts method invocations into outgoing messages and incoming messages to operation results that are returned to the calling application.</span></span> <span data-ttu-id="dd56d-110">(如需用戶端類型的詳細資訊，請參閱[WCF 用戶端架構](../../../../docs/framework/wcf/feature-details/client-architecture.md)。)</span><span class="sxs-lookup"><span data-stu-id="dd56d-110">(For more information about client types, see [WCF Client Architecture](../../../../docs/framework/wcf/feature-details/client-architecture.md).)</span></span>  
  
 <span data-ttu-id="dd56d-111">WCF 用戶端類型具有執行階段類型，可處理這項端點和作業層級功能。</span><span class="sxs-lookup"><span data-stu-id="dd56d-111">WCF client types have runtime types that handle this endpoint- and operation-level functionality.</span></span> <span data-ttu-id="dd56d-112">當應用程式呼叫作業時，<xref:System.ServiceModel.Dispatcher.ClientOperation> 便會將傳出物件轉譯到訊息中、處理攔截器、確認該傳出呼叫符合目標合約，並將傳出訊息交給 <xref:System.ServiceModel.Dispatcher.ClientRuntime>，該執行階段會負責建立及管理傳出通道 (在雙工服務的情況下也包括傳入通道)、處理額外的傳出訊息處理程序 (例如標頭修改)、處理雙向的訊息攔截器，以及將傳入的雙工呼叫傳遞到適當的用戶端 <xref:System.ServiceModel.Dispatcher.DispatchRuntime> 物件。</span><span class="sxs-lookup"><span data-stu-id="dd56d-112">When an application calls an operation, the <xref:System.ServiceModel.Dispatcher.ClientOperation> translates the outbound objects into a message, processes interceptors, confirms that the outbound call conforms to the target contract, and hands the outbound message to the <xref:System.ServiceModel.Dispatcher.ClientRuntime>, which is responsible for creating and managing outbound channels (and inbound channels in the case of duplex services), handling extra outbound message processing (such as header modification), processing message interceptors in both directions, and routing inbound duplex calls to the appropriate client-side <xref:System.ServiceModel.Dispatcher.DispatchRuntime> object.</span></span> <span data-ttu-id="dd56d-113"><xref:System.ServiceModel.Dispatcher.ClientOperation> 和 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 都會在訊息 (包括錯誤) 傳回到用戶端時提供相似的服務。</span><span class="sxs-lookup"><span data-stu-id="dd56d-113">Both the <xref:System.ServiceModel.Dispatcher.ClientOperation> and <xref:System.ServiceModel.Dispatcher.ClientRuntime> provide similar services when messages (including faults) are returned to the client.</span></span>  
  
 <span data-ttu-id="dd56d-114">這兩個執行階段類別是主要的延伸模組，以自訂的 WCF 用戶端物件和通道處理。</span><span class="sxs-lookup"><span data-stu-id="dd56d-114">These two runtime classes are the main extension to customize the processing of WCF client objects and channels.</span></span> <span data-ttu-id="dd56d-115"><xref:System.ServiceModel.Dispatcher.ClientRuntime> 類別讓使用者能夠對合約中的所有訊息進行攔截和擴充用戶端執行。</span><span class="sxs-lookup"><span data-stu-id="dd56d-115">The <xref:System.ServiceModel.Dispatcher.ClientRuntime> class allows users to intercept and extend client execution across all messages in the contract.</span></span> <span data-ttu-id="dd56d-116"><xref:System.ServiceModel.Dispatcher.ClientOperation> 類別則讓使用者能夠對特定作業中的所有訊息進行攔截和擴充用戶端執行。</span><span class="sxs-lookup"><span data-stu-id="dd56d-116">The <xref:System.ServiceModel.Dispatcher.ClientOperation> class allows users to intercept and extend client execution for all messages in a given operation.</span></span>  
  
 <span data-ttu-id="dd56d-117">使用合約、端點及作業行為，即可修改屬性或插入自訂。</span><span class="sxs-lookup"><span data-stu-id="dd56d-117">Modifying the properties or inserting customizations are done by using contract, endpoint, and operation behaviors.</span></span> <span data-ttu-id="dd56d-118">如需如何使用這種行為來執行用戶端執行階段自訂的詳細資訊，請參閱[設定和擴充執行階段行為](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-118">For more information about how to use these types of behaviors to perform client runtime customizations, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
## <a name="scenarios"></a><span data-ttu-id="dd56d-119">案例</span><span class="sxs-lookup"><span data-stu-id="dd56d-119">Scenarios</span></span>  
 <span data-ttu-id="dd56d-120">用戶端系統會因為一些原因而需要擴充，其中包括：</span><span class="sxs-lookup"><span data-stu-id="dd56d-120">There a number of reasons to extend the client system, including:</span></span>  
  
-   <span data-ttu-id="dd56d-121">自訂訊息驗證。</span><span class="sxs-lookup"><span data-stu-id="dd56d-121">Custom Message Validation.</span></span> <span data-ttu-id="dd56d-122">使用者可能想要強制訊息對特定結構描述有效。</span><span class="sxs-lookup"><span data-stu-id="dd56d-122">A user may want to enforce that a message is valid for a certain schema.</span></span> <span data-ttu-id="dd56d-123">藉由實作 <xref:System.ServiceModel.Dispatcher.IClientMessageInspector> 介面，並將實作 (Implementation) 指派到 <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A> 屬性，即可做到這點。</span><span class="sxs-lookup"><span data-stu-id="dd56d-123">This can be done by implementing the <xref:System.ServiceModel.Dispatcher.IClientMessageInspector> interface and assigning the implementation to the <xref:System.ServiceModel.Dispatcher.DispatchRuntime.MessageInspectors%2A> property.</span></span> <span data-ttu-id="dd56d-124">如需範例，請參閱[如何：檢查或修改用戶端上的訊息](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)和[How to:檢查或修改用戶端上的訊息](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-124">For examples, see [How to: Inspect or Modify Messages on the Client](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md) and [How to: Inspect or Modify Messages on the Client](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md).</span></span>  
  
-   <span data-ttu-id="dd56d-125">自訂訊息記錄。</span><span class="sxs-lookup"><span data-stu-id="dd56d-125">Custom Message Logging.</span></span> <span data-ttu-id="dd56d-126">使用者可能想要檢查和記錄某些流經端點的應用程式訊息集。</span><span class="sxs-lookup"><span data-stu-id="dd56d-126">A user may want to inspect and log some set of application messages that flow through an endpoint.</span></span> <span data-ttu-id="dd56d-127">使用訊息攔截器介面也可以完成這個動作。</span><span class="sxs-lookup"><span data-stu-id="dd56d-127">This can also be accomplished with the message interceptor interfaces.</span></span>  
  
-   <span data-ttu-id="dd56d-128">自訂訊息轉換。</span><span class="sxs-lookup"><span data-stu-id="dd56d-128">Custom Message Transformations.</span></span> <span data-ttu-id="dd56d-129">除了修改應用程式程式碼以外，使用者可能想要將特定轉換套用到執行階段中的訊息 (例如，為了進行版本管理)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-129">Rather than modifying application code, the user may want to apply certain transformations to the message in the runtime (for example, for versioning).</span></span> <span data-ttu-id="dd56d-130">使用訊息攔截器介面同樣可以完成這個動作。</span><span class="sxs-lookup"><span data-stu-id="dd56d-130">This can be accomplished, again, with the message interceptor interfaces.</span></span>  
  
-   <span data-ttu-id="dd56d-131">自訂資料模型。</span><span class="sxs-lookup"><span data-stu-id="dd56d-131">Custom Data Model.</span></span> <span data-ttu-id="dd56d-132">使用者可能會想要有一個資料或序列化的模型不支援在 WCF 中的預設 (亦即<xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>， <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>，和<xref:System.ServiceModel.Channels.Message?displayProperty=nameWithType>物件)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-132">A user may want to have a data or serialization model other than those supported by default in WCF (namely, <xref:System.Runtime.Serialization.DataContractSerializer?displayProperty=nameWithType>, <xref:System.Xml.Serialization.XmlSerializer?displayProperty=nameWithType>, and <xref:System.ServiceModel.Channels.Message?displayProperty=nameWithType> objects).</span></span> <span data-ttu-id="dd56d-133">實作訊息格式器介面即可做到這點。</span><span class="sxs-lookup"><span data-stu-id="dd56d-133">This can be done by implementing the message formatter interfaces.</span></span> <span data-ttu-id="dd56d-134">如需詳細資訊，請參閱 <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter?displayProperty=nameWithType> 和 <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A?displayProperty=nameWithType> 屬性。</span><span class="sxs-lookup"><span data-stu-id="dd56d-134">For more information, see <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter?displayProperty=nameWithType> and the <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A?displayProperty=nameWithType> property.</span></span>  
  
-   <span data-ttu-id="dd56d-135">自訂參數驗證。</span><span class="sxs-lookup"><span data-stu-id="dd56d-135">Custom Parameter Validation.</span></span> <span data-ttu-id="dd56d-136">使用者可能想要強制型別參數都是有效的 (即非 XML)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-136">A user may want to enforce that typed parameters are valid (as opposed to XML).</span></span> <span data-ttu-id="dd56d-137">使用參數偵測器介面即可達到這個目的。</span><span class="sxs-lookup"><span data-stu-id="dd56d-137">This can be done using the parameter inspector interfaces.</span></span> <span data-ttu-id="dd56d-138">如需範例，請參閱[如何：檢查或修改參數](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md)或是[用戶端驗證](../../../../docs/framework/wcf/samples/client-validation.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-138">For an example, see [How to: Inspect or Modify Parameters](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md) or [Client Validation](../../../../docs/framework/wcf/samples/client-validation.md).</span></span>  
  
### <a name="using-the-clientruntime-class"></a><span data-ttu-id="dd56d-139">使用 ClientRuntime 類別</span><span class="sxs-lookup"><span data-stu-id="dd56d-139">Using the ClientRuntime Class</span></span>  
 <span data-ttu-id="dd56d-140"><xref:System.ServiceModel.Dispatcher.ClientRuntime> 類別是一個擴充點，您可以在這個擴充點上新增會攔截訊息及擴充用戶端行為的延伸物件。</span><span class="sxs-lookup"><span data-stu-id="dd56d-140">The <xref:System.ServiceModel.Dispatcher.ClientRuntime> class is an extensibility point to which you can add extension objects that intercept messages and extend client behavior.</span></span> <span data-ttu-id="dd56d-141">攔截物件可以處理特定合約中的所有訊息，只處理特定作業的訊息，執行自訂通道初始設定，以及實作其他的自訂用戶端應用程式行為。</span><span class="sxs-lookup"><span data-stu-id="dd56d-141">Interception objects can process all messages in a particular contract, process only messages for particular operations, perform custom channel initialization, and implement other custom client application behavior.</span></span>  
  
-   <span data-ttu-id="dd56d-142"><xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> 屬性會傳回服務初始化回呼用戶端的分派執行階段物件。</span><span class="sxs-lookup"><span data-stu-id="dd56d-142">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A> property returns the dispatch run-time object for service-initiated callback clients.</span></span>  
  
-   <span data-ttu-id="dd56d-143"><xref:System.ServiceModel.Dispatcher.ClientRuntime.OperationSelector%2A> 屬性則會接受自訂作業選取器物件。</span><span class="sxs-lookup"><span data-stu-id="dd56d-143">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.OperationSelector%2A> property accepts a custom operation selector object.</span></span>  
  
-   <span data-ttu-id="dd56d-144"><xref:System.ServiceModel.Dispatcher.ClientRuntime.ChannelInitializers%2A> 屬性可以用來加入通道初始設定式，以便檢查或修改用戶端通道。</span><span class="sxs-lookup"><span data-stu-id="dd56d-144">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.ChannelInitializers%2A> property enables the addition of a channel initializer that can inspect or modify the client channel.</span></span>  
  
-   <span data-ttu-id="dd56d-145"><xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> 屬性會取得 <xref:System.ServiceModel.Dispatcher.ClientOperation> 物件的集合，而您可以在這些物件中加入自訂訊息攔截器，以提供該作業之訊息的專屬功能。</span><span class="sxs-lookup"><span data-stu-id="dd56d-145">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> property gets a collection of <xref:System.ServiceModel.Dispatcher.ClientOperation> objects to which you can add custom message interceptors that provide functionality specific to the messages of that operation.</span></span>  
  
-   <span data-ttu-id="dd56d-146"><xref:System.ServiceModel.Dispatcher.ClientRuntime.ManualAddressing%2A> 屬性允許應用程式關閉一些自動定址標頭，以便直接控制定址。</span><span class="sxs-lookup"><span data-stu-id="dd56d-146">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.ManualAddressing%2A> property enables an application to turn off some automatic addressing headers to directly control addressing.</span></span>  
  
-   <span data-ttu-id="dd56d-147"><xref:System.ServiceModel.Dispatcher.ClientRuntime.Via%2A> 屬性會設定在傳輸層之訊息的目的端值，以便支援媒介及其他案例。</span><span class="sxs-lookup"><span data-stu-id="dd56d-147">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.Via%2A> property sets the value of the destination of the message at the transport level to support intermediaries and other scenarios.</span></span>  
  
-   <span data-ttu-id="dd56d-148"><xref:System.ServiceModel.Dispatcher.ClientRuntime.MessageInspectors%2A>屬性取得的集合<xref:System.ServiceModel.Dispatcher.IClientMessageInspector>物件，您可以新增自訂訊息攔截器，透過 WCF 用戶端傳輸的所有訊息。</span><span class="sxs-lookup"><span data-stu-id="dd56d-148">The <xref:System.ServiceModel.Dispatcher.ClientRuntime.MessageInspectors%2A> property gets a collection of <xref:System.ServiceModel.Dispatcher.IClientMessageInspector> objects to which you can add custom message interceptors for all messages traveling through a WCF client.</span></span>  
  
 <span data-ttu-id="dd56d-149">此外，還有一些會擷取合約資訊的其他屬性：</span><span class="sxs-lookup"><span data-stu-id="dd56d-149">In addition, there are a number of other properties that retrieve the contract information:</span></span>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.ContractName%2A>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.ContractNamespace%2A>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.ContractClientType%2A>  
  
 <span data-ttu-id="dd56d-150">如果 WCF 用戶端是雙工的 WCF 用戶端，下列屬性還會擷取回呼 WCF 用戶端資訊：</span><span class="sxs-lookup"><span data-stu-id="dd56d-150">If the WCF client is a duplex WCF client, the following properties also retrieve the callback WCF client information:</span></span>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackClientType%2A>  
  
-   <xref:System.ServiceModel.Dispatcher.ClientRuntime.CallbackDispatchRuntime%2A>  
  
 <span data-ttu-id="dd56d-151">若要擴充 WCF 用戶端執行跨整個的 WCF 用戶端，請檢閱上可用的屬性<xref:System.ServiceModel.Dispatcher.ClientRuntime>類別，以查看修改屬性或實作介面並將它新增至屬性是否會建立您所需要的功能。</span><span class="sxs-lookup"><span data-stu-id="dd56d-151">To extend WCF client execution across an entire WCF client, review the properties available on the <xref:System.ServiceModel.Dispatcher.ClientRuntime> class to see whether modifying a property or implementing an interface and adding it to a property creates the functionality you are seeking.</span></span> <span data-ttu-id="dd56d-152">選擇了要建置的特定延伸之後，請透過實作會在叫用時提供存取 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 類別的用戶端行為，將您的延伸插入到適當的 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 屬性。</span><span class="sxs-lookup"><span data-stu-id="dd56d-152">Once you have chosen a particular extension to build, insert your extension into the appropriate <xref:System.ServiceModel.Dispatcher.ClientRuntime> property by implementing a client behavior that provides access to the <xref:System.ServiceModel.Dispatcher.ClientRuntime> class when invoked.</span></span>  
  
 <span data-ttu-id="dd56d-153">您可以使用作業行為 (實作 <xref:System.ServiceModel.Description.IOperationBehavior> 的物件)、合約行為 (實作 <xref:System.ServiceModel.Description.IContractBehavior> 的物件) 或是端點行為 (實作 <xref:System.ServiceModel.Description.IEndpointBehavior> 的物件)，將自訂延伸物件插入到集合中。</span><span class="sxs-lookup"><span data-stu-id="dd56d-153">You can insert custom extension objects into a collection using an operation behavior (an object that implements <xref:System.ServiceModel.Description.IOperationBehavior>), a contract behavior (an object that implements <xref:System.ServiceModel.Description.IContractBehavior>), or an endpoint behavior (an object that implements <xref:System.ServiceModel.Description.IEndpointBehavior>).</span></span> <span data-ttu-id="dd56d-154">安裝行為物件新增到適當的行為集合的方式，可以是程式設計方式、宣告方式 (即透過實作自訂屬性)，或是實作自訂 <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> 物件以便讓該行為可透過應用程式組態檔來進行插入等方式。</span><span class="sxs-lookup"><span data-stu-id="dd56d-154">The installing behavior object is added to the appropriate collection of behaviors either programmatically, declaratively (by implementing a custom attribute), or by implementing a custom <xref:System.ServiceModel.Configuration.BehaviorExtensionElement> object to enable the behavior to be inserted using an application configuration file.</span></span> <span data-ttu-id="dd56d-155">如需詳細資訊，請參閱 <<c0> [ 設定和擴充執行階段行為](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-155">For details, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
 <span data-ttu-id="dd56d-156">如需示範攔截跨 WCF 用戶端的範例，請參閱[How to:檢查或修改用戶端上的訊息](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-156">For examples that demonstrate interception across a WCF client, see [How to: Inspect or Modify Messages on the Client](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md).</span></span>  
  
### <a name="using-the-clientoperation-class"></a><span data-ttu-id="dd56d-157">使用 ClientOperation 類別</span><span class="sxs-lookup"><span data-stu-id="dd56d-157">Using the ClientOperation Class</span></span>  
 <span data-ttu-id="dd56d-158">用戶端執行階段修改的位置以及範圍僅限一項服務作業之自訂擴充的插入點，就是 <xref:System.ServiceModel.Dispatcher.ClientOperation> 類別。</span><span class="sxs-lookup"><span data-stu-id="dd56d-158">The <xref:System.ServiceModel.Dispatcher.ClientOperation> class is the location for client run-time modifications and insertion point for custom extensions that are scoped to only one service operation.</span></span> <span data-ttu-id="dd56d-159">(若要修改合約中所有訊息的用戶端執行階段行為，請使用 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 類別)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-159">(To modify client run-time behavior for all messages in a contract, use the <xref:System.ServiceModel.Dispatcher.ClientRuntime> class.)</span></span>  
  
 <span data-ttu-id="dd56d-160">您可以使用 <xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> 屬性找出表示特定服務作業的 <xref:System.ServiceModel.Dispatcher.ClientOperation> 物件。</span><span class="sxs-lookup"><span data-stu-id="dd56d-160">Use the <xref:System.ServiceModel.Dispatcher.ClientRuntime.Operations%2A> property to locate the <xref:System.ServiceModel.Dispatcher.ClientOperation> object that represents a particular service operation.</span></span> <span data-ttu-id="dd56d-161">下列屬性可讓您將自訂物件插入至 WCF 用戶端系統：</span><span class="sxs-lookup"><span data-stu-id="dd56d-161">The following properties enable you to insert custom objects into the WCF client system:</span></span>  
  
-   <span data-ttu-id="dd56d-162">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A> 屬性，即可插入作業的自訂 <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter> 實作或修改目前的格式器。</span><span class="sxs-lookup"><span data-stu-id="dd56d-162">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Formatter%2A> property to insert a custom <xref:System.ServiceModel.Dispatcher.IClientMessageFormatter> implementation for an operation or modify the current formatter.</span></span>  
  
-   <span data-ttu-id="dd56d-163">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.ParameterInspectors%2A> 屬性，即可插入自訂 <xref:System.ServiceModel.Dispatcher.IParameterInspector> 實作或修改目前的實作。</span><span class="sxs-lookup"><span data-stu-id="dd56d-163">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.ParameterInspectors%2A> property to insert a custom <xref:System.ServiceModel.Dispatcher.IParameterInspector> implementation or to modify the current one.</span></span>  
  
 <span data-ttu-id="dd56d-164">下列屬性讓您能夠透過與格式器及自訂參數偵測器互動來修改系統。</span><span class="sxs-lookup"><span data-stu-id="dd56d-164">The following properties enable you to modify the system in interaction with the formatter and custom parameter inspectors:</span></span>  
  
-   <span data-ttu-id="dd56d-165">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.SerializeRequest%2A> 屬性，即可控制傳出訊息的序列化。</span><span class="sxs-lookup"><span data-stu-id="dd56d-165">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.SerializeRequest%2A> property to control the serialization of an outbound message.</span></span>  
  
-   <span data-ttu-id="dd56d-166">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.DeserializeReply%2A> 屬性，即可控制傳入訊息的還原序列化 (Deserialization)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-166">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.DeserializeReply%2A> property to control the deserialization of an inbound message.</span></span>  
  
-   <span data-ttu-id="dd56d-167">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Action%2A> 屬性，即可控制要求訊息的 WS-Addressing 動作。</span><span class="sxs-lookup"><span data-stu-id="dd56d-167">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Action%2A> property to control the WS-Addressing action of the request message.</span></span>  
  
-   <span data-ttu-id="dd56d-168">使用<xref:System.ServiceModel.Dispatcher.ClientOperation.BeginMethod%2A>和<xref:System.ServiceModel.Dispatcher.ClientOperation.EndMethod%2A>以指定哪一個 WCF 用戶端的方法與非同步作業建立關聯。</span><span class="sxs-lookup"><span data-stu-id="dd56d-168">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.BeginMethod%2A> and <xref:System.ServiceModel.Dispatcher.ClientOperation.EndMethod%2A> to specify which WCF client methods are associated with an asynchronous operation.</span></span>  
  
-   <span data-ttu-id="dd56d-169">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.FaultContractInfos%2A> 屬性來取得集合，其中包含可依詳細類型方式出現在 SOAP 錯誤中的型別。</span><span class="sxs-lookup"><span data-stu-id="dd56d-169">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.FaultContractInfos%2A> property to get a collection that contains the types that can appear in SOAP faults as the detail type.</span></span>  
  
-   <span data-ttu-id="dd56d-170">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.IsInitiating%2A> 和 <xref:System.ServiceModel.Dispatcher.ClientOperation.IsTerminating%2A> 屬性，即可分別控制在呼叫作業時是否要產生或卸除工作階段。</span><span class="sxs-lookup"><span data-stu-id="dd56d-170">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.IsInitiating%2A> and <xref:System.ServiceModel.Dispatcher.ClientOperation.IsTerminating%2A> properties to control whether a session is initiated or is torn down, respectively, when the operation is called.</span></span>  
  
-   <span data-ttu-id="dd56d-171">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.IsOneWay%2A> 屬性，即可控制作業是否為單向作業。</span><span class="sxs-lookup"><span data-stu-id="dd56d-171">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.IsOneWay%2A> property to control whether the operation is a one-way operation.</span></span>  
  
-   <span data-ttu-id="dd56d-172">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Parent%2A> 屬性，即可取得 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 包含物件。</span><span class="sxs-lookup"><span data-stu-id="dd56d-172">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Parent%2A> property to obtain the containing <xref:System.ServiceModel.Dispatcher.ClientRuntime> object.</span></span>  
  
-   <span data-ttu-id="dd56d-173">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.Name%2A> 屬性，即可取得作業的名稱。</span><span class="sxs-lookup"><span data-stu-id="dd56d-173">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.Name%2A> property to get the name of the operation.</span></span>  
  
-   <span data-ttu-id="dd56d-174">使用 <xref:System.ServiceModel.Dispatcher.ClientOperation.SyncMethod%2A> 屬性，即可控制要對應到作業的方法。</span><span class="sxs-lookup"><span data-stu-id="dd56d-174">Use the <xref:System.ServiceModel.Dispatcher.ClientOperation.SyncMethod%2A> property to control which method is mapped to the operation.</span></span>  
  
 <span data-ttu-id="dd56d-175">若要擴充 WCF 用戶端執行跨只有一個服務作業，請檢閱上可用的屬性<xref:System.ServiceModel.Dispatcher.ClientOperation>類別，以查看修改屬性或實作介面並將它新增至屬性是否會建立您所需要的功能。</span><span class="sxs-lookup"><span data-stu-id="dd56d-175">To extend WCF client execution across only one service operation, review the properties available on the <xref:System.ServiceModel.Dispatcher.ClientOperation> class to see whether modifying a property or implementing an interface and adding it to a property creates the functionality you are seeking.</span></span> <span data-ttu-id="dd56d-176">選擇了要建置的特定延伸之後，請透過實作會在叫用時提供存取 <xref:System.ServiceModel.Dispatcher.ClientOperation> 類別的用戶端行為，將您的延伸插入到適當的 <xref:System.ServiceModel.Dispatcher.ClientOperation> 屬性。</span><span class="sxs-lookup"><span data-stu-id="dd56d-176">Once you have chosen a particular extension to build, insert your extension into the appropriate <xref:System.ServiceModel.Dispatcher.ClientOperation> property by implementing a client behavior that provides access to the <xref:System.ServiceModel.Dispatcher.ClientOperation> class when invoked.</span></span> <span data-ttu-id="dd56d-177">然後，您就可以在該行為的內部，將 <xref:System.ServiceModel.Dispatcher.ClientRuntime> 屬性修改成符合您的需求。</span><span class="sxs-lookup"><span data-stu-id="dd56d-177">Inside that behavior you can then modify the <xref:System.ServiceModel.Dispatcher.ClientRuntime> property to fit your requirements.</span></span>  
  
 <span data-ttu-id="dd56d-178">一般而言，實作作業行為 (即實作 <xref:System.ServiceModel.Description.IOperationBehavior> 介面的物件) 就夠了，不過您也可以使用端點行為與合約行為，找到特定作業的 <xref:System.ServiceModel.Description.OperationDescription>，並在此處附加該行為來達成相同結果。</span><span class="sxs-lookup"><span data-stu-id="dd56d-178">Typically, implementing an operation behavior (an object that implements the <xref:System.ServiceModel.Description.IOperationBehavior> interface) suffices, but you can also use endpoint behaviors and contract behaviors to accomplish the same thing by locating the <xref:System.ServiceModel.Description.OperationDescription> for a particular operation and attaching the behavior there.</span></span> <span data-ttu-id="dd56d-179">如需詳細資訊，請參閱 <<c0> [ 設定和擴充執行階段行為](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-179">For details, see [Configuring and Extending the Runtime with Behaviors](../../../../docs/framework/wcf/extending/configuring-and-extending-the-runtime-with-behaviors.md).</span></span>  
  
 <span data-ttu-id="dd56d-180">若要從組態使用自訂行為，請使用自訂行為組態區段處理常式來安裝您的行為。</span><span class="sxs-lookup"><span data-stu-id="dd56d-180">To use your custom behavior from configuration, install your behavior using a custom behavior configuration section handler.</span></span> <span data-ttu-id="dd56d-181">您也可以建立自訂屬性以安裝行為。</span><span class="sxs-lookup"><span data-stu-id="dd56d-181">You can also install your behavior by creating a custom attribute.</span></span>  
  
 <span data-ttu-id="dd56d-182">如需示範攔截跨 WCF 用戶端的範例，請參閱[How to:檢查或修改參數](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md)。</span><span class="sxs-lookup"><span data-stu-id="dd56d-182">For examples that demonstrate interception across a WCF client, see [How to: Inspect or Modify Parameters](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="dd56d-183">另請參閱</span><span class="sxs-lookup"><span data-stu-id="dd56d-183">See also</span></span>

- <xref:System.ServiceModel.Dispatcher.ClientRuntime>
- <xref:System.ServiceModel.Dispatcher.ClientOperation>
- [<span data-ttu-id="dd56d-184">如何：檢查或修改用戶端上的訊息</span><span class="sxs-lookup"><span data-stu-id="dd56d-184">How to: Inspect or Modify Messages on the Client</span></span>](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-messages-on-the-client.md)
- [<span data-ttu-id="dd56d-185">如何：檢查或修改參數</span><span class="sxs-lookup"><span data-stu-id="dd56d-185">How to: Inspect or Modify Parameters</span></span>](../../../../docs/framework/wcf/extending/how-to-inspect-or-modify-parameters.md)
