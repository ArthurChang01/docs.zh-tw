---
title: "Regasm.exe (組件登錄工具)"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords:
- Assembly Registration tool
- assemblies [.NET Framework], registering
- Regasm.exe
- registering assemblies
ms.assetid: e190e342-36ef-4651-a0b4-0e8c2c0281cb
caps.latest.revision: "20"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: 21da853d442a86eb42d04ff4f32d9f2798e14477
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 11/21/2017
---
# <a name="regasmexe-assembly-registration-tool"></a><span data-ttu-id="70c91-102">Regasm.exe (組件登錄工具)</span><span class="sxs-lookup"><span data-stu-id="70c91-102">Regasm.exe (Assembly Registration Tool)</span></span>
<span data-ttu-id="70c91-103">組件註冊工具會讀取組件內的中繼資料，並將必要的項目加入至登錄，這樣可讓 COM 用戶端順利地建立 .NET Framework 類別。</span><span class="sxs-lookup"><span data-stu-id="70c91-103">The Assembly Registration tool reads the metadata within an assembly and adds the necessary entries to the registry, which allows COM clients to create .NET Framework classes transparently.</span></span> <span data-ttu-id="70c91-104">註冊類別之後，任何 COM 用戶端都可以將它當做 COM 類別使用。</span><span class="sxs-lookup"><span data-stu-id="70c91-104">Once a class is registered, any COM client can use it as though the class were a COM class.</span></span> <span data-ttu-id="70c91-105">類別只會在安裝組件時註冊一次。</span><span class="sxs-lookup"><span data-stu-id="70c91-105">The class is registered only once, when the assembly is installed.</span></span> <span data-ttu-id="70c91-106">在實際註冊類別之後，才能從 COM 建立組件內類別的執行個體。</span><span class="sxs-lookup"><span data-stu-id="70c91-106">Instances of classes within the assembly cannot be created from COM until they are actually registered.</span></span>  
  
 <span data-ttu-id="70c91-107">若要執行此工具，請使用 [開發人員命令提示字元] (或 Windows 7 中的 [Visual Studio 命令提示字元])。</span><span class="sxs-lookup"><span data-stu-id="70c91-107">To run the tool, use the Developer Command Prompt (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="70c91-108">如需詳細資訊，請參閱[命令提示字元](../../../docs/framework/tools/developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="70c91-108">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="70c91-109">在命令提示字元下輸入下列命令：</span><span class="sxs-lookup"><span data-stu-id="70c91-109">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="70c91-110">語法</span><span class="sxs-lookup"><span data-stu-id="70c91-110">Syntax</span></span>  
  
```  
regasm assemblyFile [options]  
```  
  
#### <a name="parameters"></a><span data-ttu-id="70c91-111">參數</span><span class="sxs-lookup"><span data-stu-id="70c91-111">Parameters</span></span>  
  
|<span data-ttu-id="70c91-112">參數</span><span class="sxs-lookup"><span data-stu-id="70c91-112">Parameter</span></span>|<span data-ttu-id="70c91-113">說明</span><span class="sxs-lookup"><span data-stu-id="70c91-113">Description</span></span>|  
|---------------|-----------------|  
|<span data-ttu-id="70c91-114">*assemblyFile*</span><span class="sxs-lookup"><span data-stu-id="70c91-114">*assemblyFile*</span></span>|<span data-ttu-id="70c91-115">要向 COM 註冊的組件。</span><span class="sxs-lookup"><span data-stu-id="70c91-115">The assembly to be registered with COM.</span></span>|  
  
|<span data-ttu-id="70c91-116">選項</span><span class="sxs-lookup"><span data-stu-id="70c91-116">Option</span></span>|<span data-ttu-id="70c91-117">說明</span><span class="sxs-lookup"><span data-stu-id="70c91-117">Description</span></span>|  
|------------|-----------------|  
|<span data-ttu-id="70c91-118">**/codebase**</span><span class="sxs-lookup"><span data-stu-id="70c91-118">**/codebase**</span></span>|<span data-ttu-id="70c91-119">在登錄中建立一個程式碼基底項目。</span><span class="sxs-lookup"><span data-stu-id="70c91-119">Creates a Codebase entry in the registry.</span></span> <span data-ttu-id="70c91-120">程式碼基底項目會指定未安裝於全域組件快取中之組件的檔案路徑。</span><span class="sxs-lookup"><span data-stu-id="70c91-120">The Codebase entry specifies the file path for an assembly that is not installed in the global assembly cache.</span></span> <span data-ttu-id="70c91-121">如果您將接著安裝要在全域組件快取中註冊的組件，則不應該指定這個選項。</span><span class="sxs-lookup"><span data-stu-id="70c91-121">You should not specify this option if you will subsequently install the assembly that you are registering into the global assembly cache.</span></span> <span data-ttu-id="70c91-122">您使用 **/codebase** 選項指定的 *assemblyFile* 引數必須是[強式名稱組件](../../../docs/framework/app-domains/strong-named-assemblies.md)。</span><span class="sxs-lookup"><span data-stu-id="70c91-122">The *assemblyFile* argument that you specify with the **/codebase** option must be a [strong-named assembly](../../../docs/framework/app-domains/strong-named-assemblies.md).</span></span>|  
|<span data-ttu-id="70c91-123">**/registered**</span><span class="sxs-lookup"><span data-stu-id="70c91-123">**/registered**</span></span>|<span data-ttu-id="70c91-124">指定這個工具只會參考已註冊的類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="70c91-124">Specifies that this tool will only refer to type libraries that have already been registered.</span></span>|  
|<span data-ttu-id="70c91-125">**/asmpath:directory**</span><span class="sxs-lookup"><span data-stu-id="70c91-125">**/asmpath:directory**</span></span>|<span data-ttu-id="70c91-126">指定包含組件參考的目錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-126">Specifies a directory containing assembly references.</span></span> <span data-ttu-id="70c91-127">必須與 **/regfile** 選項一起使用。</span><span class="sxs-lookup"><span data-stu-id="70c91-127">Must be used with the **/regfile** option.</span></span>|  
|<span data-ttu-id="70c91-128">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="70c91-128">**/nologo**</span></span>|<span data-ttu-id="70c91-129">隱藏 Microsoft 程式啟始資訊顯示。</span><span class="sxs-lookup"><span data-stu-id="70c91-129">Suppresses the Microsoft startup banner display.</span></span>|  
|<span data-ttu-id="70c91-130">**/regfile** [**:** *regFile*]</span><span class="sxs-lookup"><span data-stu-id="70c91-130">**/regfile** [**:** *regFile*]</span></span>|<span data-ttu-id="70c91-131">產生組件的指定 .reg 檔，其中包含所需的登錄項目。</span><span class="sxs-lookup"><span data-stu-id="70c91-131">Generates the specified .reg file for the assembly, which contains the needed registry entries.</span></span> <span data-ttu-id="70c91-132">指定這個選項並不會變更登錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-132">Specifying this option does not change the registry.</span></span> <span data-ttu-id="70c91-133">這個選項不可與 **/u** 或 **/tlb** 選項一起使用。</span><span class="sxs-lookup"><span data-stu-id="70c91-133">You cannot use this option with the **/u** or **/tlb** options.</span></span>|  
|<span data-ttu-id="70c91-134">**/silent** 或 **/s**</span><span class="sxs-lookup"><span data-stu-id="70c91-134">**/silent** or **/s**</span></span>|<span data-ttu-id="70c91-135">隱藏顯示成功訊息。</span><span class="sxs-lookup"><span data-stu-id="70c91-135">Suppresses the display of success messages.</span></span>|  
|<span data-ttu-id="70c91-136">**/tlb** [**:** *typeLibFile*]</span><span class="sxs-lookup"><span data-stu-id="70c91-136">**/tlb** [**:** *typeLibFile*]</span></span>|<span data-ttu-id="70c91-137">從指定的組件中產生類型程式庫，其中包含組件內所定義之可存取類型的定義。</span><span class="sxs-lookup"><span data-stu-id="70c91-137">Generates a type library from the specified assembly containing definitions of the accessible types defined within the assembly.</span></span>|  
|<span data-ttu-id="70c91-138">**/unregister** 或 **/u**</span><span class="sxs-lookup"><span data-stu-id="70c91-138">**/unregister** or **/u**</span></span>|<span data-ttu-id="70c91-139">移除註冊 *assemblyFile* 中所找到的可建立類別。</span><span class="sxs-lookup"><span data-stu-id="70c91-139">Unregisters the creatable classes found in *assemblyFile*.</span></span> <span data-ttu-id="70c91-140">省略這個選項會造成 Regasm.exe 註冊組件中可建立的類別。</span><span class="sxs-lookup"><span data-stu-id="70c91-140">Omitting this option causes Regasm.exe to register the creatable classes in the assembly.</span></span>|  
|<span data-ttu-id="70c91-141">**/verbose**</span><span class="sxs-lookup"><span data-stu-id="70c91-141">**/verbose**</span></span>|<span data-ttu-id="70c91-142">指定詳細資訊模式，與 **/tlb** 選項一起指定時，顯示需要產生型別程式庫之任何參考組件的清單。</span><span class="sxs-lookup"><span data-stu-id="70c91-142">Specifies verbose mode; displays a list of any referenced assemblies for which a type library needs to be generated, when specified with the **/tlb** option.</span></span>|  
|<span data-ttu-id="70c91-143">**/?**</span><span class="sxs-lookup"><span data-stu-id="70c91-143">**/?**</span></span> <span data-ttu-id="70c91-144">或 **/help**</span><span class="sxs-lookup"><span data-stu-id="70c91-144">or **/help**</span></span>|<span data-ttu-id="70c91-145">顯示工具的命令語法和選項。</span><span class="sxs-lookup"><span data-stu-id="70c91-145">Displays command syntax and options for the tool.</span></span>|  
  
> [!NOTE]
>  <span data-ttu-id="70c91-146">Regasm.exe 命令列選項不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="70c91-146">The Regasm.exe command-line options are case insensitive.</span></span> <span data-ttu-id="70c91-147">您只需要提供足夠的選項資訊，就可唯一識別該選項。</span><span class="sxs-lookup"><span data-stu-id="70c91-147">You only need to provide enough of the option to uniquely identify it.</span></span> <span data-ttu-id="70c91-148">例如，**/n** 相當於 **/nologo**，且 **/t:** *outfile.tlb* 相當於 **/tlb:** *outfile.tlb*。</span><span class="sxs-lookup"><span data-stu-id="70c91-148">For example, **/n** is equivalent to **/nologo** and **/t:** *outfile.tlb* is equivalent to **/tlb:** *outfile.tlb*.</span></span>  
  
## <a name="remarks"></a><span data-ttu-id="70c91-149">備註</span><span class="sxs-lookup"><span data-stu-id="70c91-149">Remarks</span></span>  
 <span data-ttu-id="70c91-150">您可以使用 **/regfile** 選項產生包含登錄項目的 .reg 檔，而不是直接變更登錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-150">You can use the **/regfile** option to generate a .reg file that contains the registry entries instead of making the changes directly to the registry.</span></span> <span data-ttu-id="70c91-151">您可以使用登錄編輯程式工具 (Regedit.exe) 匯入 .reg 檔，藉此更新電腦上的登錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-151">You can update the registry on a computer by importing the .reg file with the Registry Editor tool (Regedit.exe).</span></span> <span data-ttu-id="70c91-152">請注意，.reg 檔並不包含任何可以藉由使用者定義的註冊功能處理的登錄更新。</span><span class="sxs-lookup"><span data-stu-id="70c91-152">Note that the .reg file does not contain any registry updates that can be made by user-defined register functions.</span></span>  <span data-ttu-id="70c91-153">請注意，**/regfile** 選項只會發出 Managed 類別的登錄項目。</span><span class="sxs-lookup"><span data-stu-id="70c91-153">Note that the **/regfile** option only emits registry entries for managed classes.</span></span>  <span data-ttu-id="70c91-154">這個選項不會發出 `TypeLibID` 或 `InterfaceID` 的項目。</span><span class="sxs-lookup"><span data-stu-id="70c91-154">This option does not emit entries for `TypeLibID`s or `InterfaceID`s.</span></span>  
  
 <span data-ttu-id="70c91-155">當您指定 **/tlb** 選項時，Regasm.exe 會產生及註冊型別程式庫，描述組件中找到的類型。</span><span class="sxs-lookup"><span data-stu-id="70c91-155">When you specify the **/tlb** option, Regasm.exe generates and registers a type library describing the types found in the assembly.</span></span> <span data-ttu-id="70c91-156">Regasm.exe 會將產生的類型程式庫放入目前的工作目錄中，或是為輸出檔指定的目錄中。</span><span class="sxs-lookup"><span data-stu-id="70c91-156">Regasm.exe places the generated type libraries in the current working directory or the directory specified for the output file.</span></span> <span data-ttu-id="70c91-157">為參考其他組件的組件產生類型程式庫可能導致一次產生多個類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="70c91-157">Generating a type library for an assembly that references other assemblies may cause several type libraries to be generated at once.</span></span> <span data-ttu-id="70c91-158">您可以使用類型程式庫提供類型資訊給 [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)] 這類開發工具。</span><span class="sxs-lookup"><span data-stu-id="70c91-158">You can use the type library to provide type information to development tools like [!INCLUDE[vsprvslong](../../../includes/vsprvslong-md.md)].</span></span> <span data-ttu-id="70c91-159">如果您要註冊的組件是由型別程式庫匯入工具 ([Tlbimp.exe](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)) 所產生，則不應該使用 **/tlb** 選項。</span><span class="sxs-lookup"><span data-stu-id="70c91-159">You should not use the **/tlb** option if the assembly you are registering was produced by the Type Library Importer ([Tlbimp.exe](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)).</span></span> <span data-ttu-id="70c91-160">您無法從原本自類型程式庫匯入的組件匯出類型程式庫。</span><span class="sxs-lookup"><span data-stu-id="70c91-160">You cannot export a type library from an assembly that was imported from a type library.</span></span> <span data-ttu-id="70c91-161">使用 **/tlb** 選項與使用類型程式庫匯出工具 ([Tlbexp.exe](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)) 和 Regasm.exe 的效果相同，但是有一點除外，就是 Tlbexp.exe 不會註冊本身所產生的類型資料庫。</span><span class="sxs-lookup"><span data-stu-id="70c91-161">Using the **/tlb** option has the same effect as using the Type Library Exporter ([Tlbexp.exe](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)) and Regasm.exe, with the exception that Tlbexp.exe does not register the type library it produces.</span></span>  <span data-ttu-id="70c91-162">如果您使用 **/tlb** 選項註冊型別程式庫，就可以使用 **/tlb** 選項搭配 **/unregister** 選項將型別程式庫的註冊移除。</span><span class="sxs-lookup"><span data-stu-id="70c91-162">If you use the **/tlb** option to registered a type library, you can use **/tlb** option with the **/unregister** option to unregistered the type library.</span></span> <span data-ttu-id="70c91-163">這兩個選項一起使用時，將會移除類型程式庫和介面項目的註冊，因而大幅清除登錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-163">Using the two options together will unregister the type library and interface entries, which can clean the registry considerably.</span></span>  
  
 <span data-ttu-id="70c91-164">當您註冊 COM 要使用的組件時，Regasm.exe 會將項目加入至本機電腦上的登錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-164">When you register an assembly for use by COM, Regasm.exe adds entries to the registry on the local computer.</span></span> <span data-ttu-id="70c91-165">更精確地說，它會建立與版本相關的登錄機碼，允許相同組件的多個版本在電腦上並存執行。</span><span class="sxs-lookup"><span data-stu-id="70c91-165">More specifically, it creates version-dependent registry keys that allow multiple versions of the same assembly to run side by side on a computer.</span></span> <span data-ttu-id="70c91-166">第一次註冊組件時，系統會針對組件建立一個最上層機碼，並針對這個特定版本建立一個唯一子機碼。</span><span class="sxs-lookup"><span data-stu-id="70c91-166">The first time an assembly is registered, one top-level key is created for the assembly and a unique subkey is created for the specific version.</span></span> <span data-ttu-id="70c91-167">每次您註冊新的組件版本時，Regasm.exe 就會為這個新的版本建立一個子機碼。</span><span class="sxs-lookup"><span data-stu-id="70c91-167">Each time you register a new version of the assembly, Regasm.exe creates a subkey for the new version.</span></span>  
  
 <span data-ttu-id="70c91-168">例如，假設您註冊 Managed 元件 myComp.dll 1.0.0.0 版以供 COM 使用。</span><span class="sxs-lookup"><span data-stu-id="70c91-168">For example, consider a scenario where you register the managed component, myComp.dll, version 1.0.0.0 for use by COM.</span></span> <span data-ttu-id="70c91-169">稍後您又註冊 myComp.dll 2.0.0.0 版。</span><span class="sxs-lookup"><span data-stu-id="70c91-169">Later, you register myComp.dll, version 2.0.0.0.</span></span> <span data-ttu-id="70c91-170">您決定讓電腦上的所有 COM 用戶端應用程式都使用 myComp.dll 2.0.0.0 版，並決定移除 myComponent.dll 1.0.0.0 版的註冊。</span><span class="sxs-lookup"><span data-stu-id="70c91-170">You determine that all COM client applications on the computer are using myComp.dll version 2.0.0.0 and you decide to unregister myComponent.dll version 1.0.0.0.</span></span> <span data-ttu-id="70c91-171">這項登錄配置可讓您移除 myComp.dll 1.0.0.0 版的註冊，因為只會移除 1.0.0.0 版的子機碼。</span><span class="sxs-lookup"><span data-stu-id="70c91-171">This registry scheme allows you to unregister myComp.dll version 1.0.0.0 because only the version 1.0.0.0 subkey is removed.</span></span>  
  
 <span data-ttu-id="70c91-172">使用 Regasm.exe 註冊組件之後，您可以將它安裝在[全域組件快取](../../../docs/framework/app-domains/gac.md)中，以便可以從任何 COM 用戶端將它啟用。</span><span class="sxs-lookup"><span data-stu-id="70c91-172">After registering an assembly using Regasm.exe, you can install it in the [global assembly cache](../../../docs/framework/app-domains/gac.md) so that it can be activated from any COM client.</span></span> <span data-ttu-id="70c91-173">如果組件將只會由單一應用程式啟用，您可以將它放置到該應用程式的目錄中。</span><span class="sxs-lookup"><span data-stu-id="70c91-173">If the assembly is only going to be activated by a single application, you can place it in that application's directory.</span></span>  
  
## <a name="examples"></a><span data-ttu-id="70c91-174">範例</span><span class="sxs-lookup"><span data-stu-id="70c91-174">Examples</span></span>  
 <span data-ttu-id="70c91-175">下列命令會註冊所有包含在 `myTest.dll` 中的公用類別。</span><span class="sxs-lookup"><span data-stu-id="70c91-175">The following command registers all public classes contained in `myTest.dll`.</span></span>  
  
```  
regasm myTest.dll  
```  
  
 <span data-ttu-id="70c91-176">下列命令會產生 `myTest.reg` 檔案，該檔案中包含所有必要的登錄項目。</span><span class="sxs-lookup"><span data-stu-id="70c91-176">The following command generates the file `myTest.reg`, which contains all the necessary registry entries.</span></span> <span data-ttu-id="70c91-177">這個命令不會更新登錄。</span><span class="sxs-lookup"><span data-stu-id="70c91-177">This command does not update the registry.</span></span>  
  
```  
regasm myTest.dll /regfile:myTest.reg  
```  
  
 <span data-ttu-id="70c91-178">下列命令會註冊包含在 `myTest.dll` 檔中的所有公用類別，並且產生和註冊 `myTest.tlb` 類型程式庫，其中包含所有在 `myTest.dll` 中定義之公用類型的定義。</span><span class="sxs-lookup"><span data-stu-id="70c91-178">The following command registers all public classes contained in `myTest.dll`, and generates and registers the type library `myTest.tlb`, which contains definitions of all the public types defined in `myTest.dll`.</span></span>  
  
```  
regasm myTest.dll /tlb:myTest.tlb  
```  
  
## <a name="see-also"></a><span data-ttu-id="70c91-179">另請參閱</span><span class="sxs-lookup"><span data-stu-id="70c91-179">See Also</span></span>  
 [<span data-ttu-id="70c91-180">工具</span><span class="sxs-lookup"><span data-stu-id="70c91-180">Tools</span></span>](../../../docs/framework/tools/index.md)  
 [<span data-ttu-id="70c91-181">Tlbexp.exe (類型程式庫匯出工具)</span><span class="sxs-lookup"><span data-stu-id="70c91-181">Tlbexp.exe (Type Library Exporter)</span></span>](../../../docs/framework/tools/tlbexp-exe-type-library-exporter.md)  
 [<span data-ttu-id="70c91-182">Tlbimp.exe (類型程式庫匯入工具)</span><span class="sxs-lookup"><span data-stu-id="70c91-182">Tlbimp.exe (Type Library Importer)</span></span>](../../../docs/framework/tools/tlbimp-exe-type-library-importer.md)  
 [<span data-ttu-id="70c91-183">向 COM 註冊組件</span><span class="sxs-lookup"><span data-stu-id="70c91-183">Registering Assemblies with COM</span></span>](../../../docs/framework/interop/registering-assemblies-with-com.md)  
 [<span data-ttu-id="70c91-184">命令提示字元</span><span class="sxs-lookup"><span data-stu-id="70c91-184">Command Prompts</span></span>](../../../docs/framework/tools/developer-command-prompt-for-vs.md)
