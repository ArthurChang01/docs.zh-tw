---
title: Winmdexp.exe (Windows 執行階段中繼資料匯出工具)
ms.date: 03/30/2017
helpviewer_keywords:
- Windows Runtime Metadata Export Tool
- Winmdexp.exe
ms.assetid: d2ce0683-343d-403e-bb8d-209186f7a19d
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 7181f6f28d576c5ddbbbe57d27e1d41e412cef6c
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33408095"
---
# <a name="winmdexpexe-windows-runtime-metadata-export-tool"></a><span data-ttu-id="cb5e5-102">Winmdexp.exe (Windows 執行階段中繼資料匯出工具)</span><span class="sxs-lookup"><span data-stu-id="cb5e5-102">Winmdexp.exe (Windows Runtime Metadata Export Tool)</span></span>
<span data-ttu-id="cb5e5-103">[!INCLUDE[wrt](../../../includes/wrt-md.md)] 中繼資料匯出工具 (Winmdexp.exe) 會將 .NET Framework 模組轉換為包含 [!INCLUDE[wrt](../../../includes/wrt-md.md)]中繼資料的檔案。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-103">The [!INCLUDE[wrt](../../../includes/wrt-md.md)] Metadata Export Tool (Winmdexp.exe) transforms a .NET Framework module into a file that contains [!INCLUDE[wrt](../../../includes/wrt-md.md)] metadata.</span></span> <span data-ttu-id="cb5e5-104">雖然 .NET Framework 組件和 [!INCLUDE[wrt](../../../includes/wrt-md.md)]中繼資料檔案使用相同的實體格式，但是中繼資料資料表的內容有些差異，也就是說，.NET Framework 組件不會自動做為 [!INCLUDE[wrt](../../../includes/wrt-md.md)]元件使用。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-104">Although .NET Framework assemblies and [!INCLUDE[wrt](../../../includes/wrt-md.md)] metadata files use the same physical format, there are differences in the content of the metadata tables, which means that .NET Framework assemblies are not automatically usable as [!INCLUDE[wrt](../../../includes/wrt-md.md)] Components.</span></span> <span data-ttu-id="cb5e5-105">將 .NET Framework 模組轉換為 [!INCLUDE[wrt](../../../includes/wrt-md.md)] 元件的程序稱為「匯出」。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-105">The process of turning a .NET Framework module into a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component is referred to as *exporting*.</span></span> <span data-ttu-id="cb5e5-106">在 [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] 和 [!INCLUDE[net_v451](../../../includes/net-v451-md.md)] 中，產生的 Windows 中繼資料 (.winmd) 檔案同時包含中繼資料和實作。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-106">In the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] and [!INCLUDE[net_v451](../../../includes/net-v451-md.md)], the resulting Windows metadata (.winmd) file contains both metadata and implementation.</span></span>  
  
 <span data-ttu-id="cb5e5-107">當您使用 [[!INCLUDE[wrt](../../../includes/wrt-md.md)]元件] 範本時 (在 C# 中位於 [Windows 市集] 下，在 [!INCLUDE[vs_dev12](../../../includes/vs-dev12-md.md)] 或 [!INCLUDE[vs_dev11_ext](../../../includes/vs-dev11-ext-md.md)] 中位於 [Visual Basic] 下)，編譯器目標是 .winmdobj 檔案，而後續建置步驟會呼叫 Winmdexp.exe 將 .winmdobj 檔案匯出到 .winmd 檔案。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-107">When you use the **[!INCLUDE[wrt](../../../includes/wrt-md.md)] Component** template, which is located under **Windows Store** for C# and Visual Basic in [!INCLUDE[vs_dev12](../../../includes/vs-dev12-md.md)] or [!INCLUDE[vs_dev11_ext](../../../includes/vs-dev11-ext-md.md)], the compiler target is a .winmdobj file, and a subsequent build step calls Winmdexp.exe to export the .winmdobj file to a .winmd file.</span></span> <span data-ttu-id="cb5e5-108">這是建置 [!INCLUDE[wrt](../../../includes/wrt-md.md)]元件的建議方式。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-108">This is the recommended way to build a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component.</span></span> <span data-ttu-id="cb5e5-109">如果您想要更充分掌控建置流程，超越 Visual Studio 所提供的範圍，請直接使用 Winmdexp.exe。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-109">Use Winmdexp.exe directly when you want more control over the build process than Visual Studio provides.</span></span>  
  
 <span data-ttu-id="cb5e5-110">此工具會自動與 Visual Studio 一起安裝。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-110">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="cb5e5-111">若要執行此工具，請使用 [開發人員命令提示字元] \(或 Windows 7 中的 [Visual Studio 命令提示字元])。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-111">To run the tool, use the Developer Command Prompt (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="cb5e5-112">如需詳細資訊，請參閱[命令提示字元](../../../docs/framework/tools/developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-112">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>  
  
 <span data-ttu-id="cb5e5-113">在命令提示字元下輸入下列命令：</span><span class="sxs-lookup"><span data-stu-id="cb5e5-113">At the command prompt, type the following:</span></span>  
  
## <a name="syntax"></a><span data-ttu-id="cb5e5-114">語法</span><span class="sxs-lookup"><span data-stu-id="cb5e5-114">Syntax</span></span>  
  
```  
winmdexp [options] winmdmodule  
```  
  
#### <a name="parameters"></a><span data-ttu-id="cb5e5-115">參數</span><span class="sxs-lookup"><span data-stu-id="cb5e5-115">Parameters</span></span>  
  
|<span data-ttu-id="cb5e5-116">引數或選項</span><span class="sxs-lookup"><span data-stu-id="cb5e5-116">Argument or option</span></span>|<span data-ttu-id="cb5e5-117">描述</span><span class="sxs-lookup"><span data-stu-id="cb5e5-117">Description</span></span>|  
|------------------------|-----------------|  
|`winmdmodule`|<span data-ttu-id="cb5e5-118">指定要匯出的模組 (.winmdobj)。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-118">Specifies the module (.winmdobj) to be exported.</span></span> <span data-ttu-id="cb5e5-119">只允許一個模組。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-119">Only one module is allowed.</span></span> <span data-ttu-id="cb5e5-120">若要建立這個模組，請使用 `/target` 編譯器選項搭配 `winmdobj` 目標。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-120">To create this module, use the `/target` compiler option with the `winmdobj` target.</span></span> <span data-ttu-id="cb5e5-121">請參閱 [/target:winmdobj (C# 編譯器選項)](~/docs/csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) 或 [/target (Visual Basic)](~/docs/visual-basic/reference/command-line-compiler/target.md)。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-121">See [/target:winmdobj (C# Compiler Options)](~/docs/csharp/language-reference/compiler-options/target-winmdobj-compiler-option.md) or [/target (Visual Basic)](~/docs/visual-basic/reference/command-line-compiler/target.md).</span></span>|  
|<span data-ttu-id="cb5e5-122">`/docfile:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-122">`/docfile:` `docfile`</span></span><br /><br /> <span data-ttu-id="cb5e5-123">`/d:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-123">`/d:` `docfile`</span></span>|<span data-ttu-id="cb5e5-124">指定 Winmdexp.exe 將產生的輸出 XML 文件檔。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-124">Specifies the output XML documentation file that Winmdexp.exe will produce.</span></span> <span data-ttu-id="cb5e5-125">在 [!INCLUDE[net_v45](../../../includes/net-v45-md.md)] 中，輸出檔案基本上與輸入 XML 文件檔相同。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-125">In the [!INCLUDE[net_v45](../../../includes/net-v45-md.md)], the output file is essentially the same as the input XML documentation file.</span></span>|  
|<span data-ttu-id="cb5e5-126">`/moduledoc:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-126">`/moduledoc:` `docfile`</span></span><br /><br /> <span data-ttu-id="cb5e5-127">`/md:` `docfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-127">`/md:` `docfile`</span></span>|<span data-ttu-id="cb5e5-128">指定編譯器使用 `winmdmodule` 所產生的 XML 文件檔名稱。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-128">Specifies the name of the XML documentation file that the compiler produced with `winmdmodule`.</span></span>|  
|<span data-ttu-id="cb5e5-129">`/modulepdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-129">`/modulepdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="cb5e5-130">`/mp:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-130">`/mp:` `symbolfile`</span></span>|<span data-ttu-id="cb5e5-131">指定式資料庫 (PDB) 檔名稱，該檔案包含 `winmdmodule` 的符號。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-131">Specifies the name of the program database (PDB) file that contains symbols for `winmdmodule`.</span></span>|  
|<span data-ttu-id="cb5e5-132">`/nowarn:` `warning`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-132">`/nowarn:` `warning`</span></span>|<span data-ttu-id="cb5e5-133">隱藏指定的警告編號。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-133">Suppresses the specified warning number.</span></span> <span data-ttu-id="cb5e5-134">對於 *warning*，僅提供錯誤碼的數字部分，不包含前置零。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-134">For *warning*, supply only the numeric portion of the error code, without leading zeros.</span></span>|  
|<span data-ttu-id="cb5e5-135">`/out:` `file`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-135">`/out:` `file`</span></span><br /><br /> <span data-ttu-id="cb5e5-136">`/o:` `file`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-136">`/o:` `file`</span></span>|<span data-ttu-id="cb5e5-137">指定輸出 Windows 中繼資料 (.winmd) 檔的名稱。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-137">Specifies the name of the output Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="cb5e5-138">`/pdb:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-138">`/pdb:` `symbolfile`</span></span><br /><br /> <span data-ttu-id="cb5e5-139">`/p:` `symbolfile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-139">`/p:` `symbolfile`</span></span>|<span data-ttu-id="cb5e5-140">指定將包含所匯出 Windows 中繼資料 (.winmd) 檔之符號的輸出程式資料庫 (PDB) 檔 (PDB) 名稱。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-140">Specifies the name of the output program database (PDB) file that will contain the symbols for the exported Windows metadata (.winmd) file.</span></span>|  
|<span data-ttu-id="cb5e5-141">`/reference:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-141">`/reference:` `winmd`</span></span><br /><br /> <span data-ttu-id="cb5e5-142">`/r:` `winmd`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-142">`/r:` `winmd`</span></span>|<span data-ttu-id="cb5e5-143">指定匯出期間參考的中繼資料檔 (.winmd 或組件)。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-143">Specifies a metadata file (.winmd or assembly) to reference during export.</span></span> <span data-ttu-id="cb5e5-144">如果您使用位於 "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" 的參考組件 (在 32 位元電腦上位於 "\Program Files\\...")，請同時包含 System.Runtime.dll 和 mscorlib.dll 的參考。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-144">If you use the reference assemblies in "\Program Files (x86)\Reference Assemblies\Microsoft\Framework\\.NETCore\v4.5" ("\Program Files\\..." on 32-bit computers), include references to both System.Runtime.dll and mscorlib.dll.</span></span>|  
|`/utf8output`|<span data-ttu-id="cb5e5-145">指定應該採用 UTF-8 編碼的輸出訊息。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-145">Specifies that output messages should be in UTF-8 encoding.</span></span>|  
|`/warnaserror+`|<span data-ttu-id="cb5e5-146">指定應該將所有警告視為錯誤。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-146">Specifies that all warnings should be treated as errors.</span></span>|  
|<span data-ttu-id="cb5e5-147">**@** `responsefile`</span><span class="sxs-lookup"><span data-stu-id="cb5e5-147">**@** `responsefile`</span></span>|<span data-ttu-id="cb5e5-148">指定包含選項的回應檔 (.rsp) (以及選擇性的 `winmdmodule`)。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-148">Specifies a response (.rsp) file that contains options (and optionally `winmdmodule`).</span></span> <span data-ttu-id="cb5e5-149">`responsefile` 中的每一行都應該包含單一引數或選項。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-149">Each line in `responsefile` should contain a single argument or option.</span></span>|  
  
## <a name="remarks"></a><span data-ttu-id="cb5e5-150">備註</span><span class="sxs-lookup"><span data-stu-id="cb5e5-150">Remarks</span></span>  
 <span data-ttu-id="cb5e5-151">Winmdexp.exe 的設計並不是將任意 .NET Framework 組件轉換成 .winmd 檔案。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-151">Winmdexp.exe is not designed to convert an arbitrary .NET Framework assembly to a .winmd file.</span></span> <span data-ttu-id="cb5e5-152">它需要的是使用 `/target:winmdobj` 選項編譯的模組，並且適用其他限制。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-152">It requires a module that is compiled with the `/target:winmdobj` option, and additional restrictions apply.</span></span> <span data-ttu-id="cb5e5-153">這些限制中最重要的是，組件的 API 介面中公開的所有類型都必須是 [!INCLUDE[wrt](../../../includes/wrt-md.md)]類型。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-153">The most important of these restrictions is that all types that are exposed in the API surface of the assembly must be [!INCLUDE[wrt](../../../includes/wrt-md.md)] types.</span></span> <span data-ttu-id="cb5e5-154">如需詳細資訊，請參閱 Windows 開發人員中心的[在 C# 和 Visual Basic 中建立 Windows 執行階段元件文件](http://go.microsoft.com/fwlink/p/?LinkID=238313)中的＜宣告 Windows 執行階段元件中的類型＞一節。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-154">For more information, see the "Declaring types in Windows Runtime Components" section of the article [Creating Windows Runtime Components in C# and Visual Basic](http://go.microsoft.com/fwlink/p/?LinkID=238313) in the Windows Dev Center.</span></span>  
  
 <span data-ttu-id="cb5e5-155">當您使用 C# 或 Visual Basic 撰寫 [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)]應用程式或 [!INCLUDE[wrt](../../../includes/wrt-md.md)]元件時，.NET Framework 可提供支援，讓您透過 [!INCLUDE[wrt](../../../includes/wrt-md.md)]進行程式設計時更順暢。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-155">When you write a [!INCLUDE[win8_appname_long](../../../includes/win8-appname-long-md.md)] app or a [!INCLUDE[wrt](../../../includes/wrt-md.md)] component with C# or Visual Basic, the .NET Framework provides support to make programming with the [!INCLUDE[wrt](../../../includes/wrt-md.md)] more natural.</span></span> <span data-ttu-id="cb5e5-156">這會在[適用於 Windows 市集應用程式和 Windows 執行階段的 .NET Framework 支援](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)文章中討論。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-156">This is discussed in the article [.NET Framework Support for Windows Store Apps and Windows Runtime](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md).</span></span> <span data-ttu-id="cb5e5-157">在過程中，有些常用的 [!INCLUDE[wrt](../../../includes/wrt-md.md)]類型會對應至 .NET Framework 類型。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-157">In the process, some commonly used [!INCLUDE[wrt](../../../includes/wrt-md.md)] types are mapped to .NET Framework types.</span></span> <span data-ttu-id="cb5e5-158">Winmdexp.exe 會將這個過程反轉，並產生 API 介面來使用對應的 [!INCLUDE[wrt](../../../includes/wrt-md.md)]類型。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-158">Winmdexp.exe reverses this process and produces an API surface that uses the corresponding [!INCLUDE[wrt](../../../includes/wrt-md.md)] types.</span></span> <span data-ttu-id="cb5e5-159">例如，建構自 <xref:System.Collections.Generic.IList%601> 介面的類型會對應到建構自 [!INCLUDE[wrt](../../../includes/wrt-md.md)][IVector\<T>](http://go.microsoft.com/fwlink/p/?LinkId=251132) 介面的類型。</span><span class="sxs-lookup"><span data-stu-id="cb5e5-159">For example, types that are constructed from the <xref:System.Collections.Generic.IList%601> interface map to types that are constructed from the [!INCLUDE[wrt](../../../includes/wrt-md.md)][IVector\<T>](http://go.microsoft.com/fwlink/p/?LinkId=251132)interface.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="cb5e5-160">請參閱</span><span class="sxs-lookup"><span data-stu-id="cb5e5-160">See Also</span></span>  
 [<span data-ttu-id="cb5e5-161">Windows 市集應用程式和 Windows 執行階段的 .NET Framework 支援</span><span class="sxs-lookup"><span data-stu-id="cb5e5-161">.NET Framework Support for Windows Store Apps and Windows Runtime</span></span>](../../../docs/standard/cross-platform/support-for-windows-store-apps-and-windows-runtime.md)  
 [<span data-ttu-id="cb5e5-162">在 C++ 和 Visual Basic 中建立 Windows 執行階段元件</span><span class="sxs-lookup"><span data-stu-id="cb5e5-162">Creating Windows Runtime Components in C# and Visual Basic</span></span>](http://go.microsoft.com/fwlink/p/?LinkID=238313)  
 [<span data-ttu-id="cb5e5-163">Winmdexp.exe 錯誤訊息</span><span class="sxs-lookup"><span data-stu-id="cb5e5-163">Winmdexp.exe Error Messages</span></span>](../../../docs/framework/tools/winmdexp-exe-error-messages.md)  
 [<span data-ttu-id="cb5e5-164">建置、部署及組態工具 (.NET Framework)</span><span class="sxs-lookup"><span data-stu-id="cb5e5-164">Build, Deployment, and Configuration Tools (.NET Framework)</span></span>](http://msdn.microsoft.com/library/b8c921be-6012-4181-b8d4-ab15813fc9a7)
