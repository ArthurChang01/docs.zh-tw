---
title: Mage.exe (資訊清單產生和編輯工具)
ms.date: 12/06/2018
helpviewer_keywords:
- Manifest Generation and Editing tool
- Mage.exe
ms.assetid: 77dfe576-2962-407e-af13-82255df725a1
ms.openlocfilehash: 9ea293a3c96f193285f45f8d70ac038e785f548a
ms.sourcegitcommit: 5137208fa414d9ca3c58cdfd2155ac81bc89e917
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 03/06/2019
ms.locfileid: "57477658"
---
# <a name="mageexe-manifest-generation-and-editing-tool"></a><span data-ttu-id="d4e27-102">Mage.exe (資訊清單產生和編輯工具)</span><span class="sxs-lookup"><span data-stu-id="d4e27-102">Mage.exe (Manifest Generation and Editing Tool)</span></span>

<span data-ttu-id="d4e27-103">「資訊清單產生和編輯工具」(*Mage.exe*) 是命令列工具，可支援建立和編輯應用程式與部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-103">The Manifest Generation and Editing Tool (*Mage.exe*) is a command-line tool that supports the creation and editing of application and deployment manifests.</span></span> <span data-ttu-id="d4e27-104">由於 *Mage.exe* 是命令列工具，因此可以從批次指令碼及其他 Windows 架構應用程式 (包括 [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] 應用程式) 中執行。</span><span class="sxs-lookup"><span data-stu-id="d4e27-104">As a command-line tool, *Mage.exe* can be run from both batch scripts and other Windows-based applications, including [!INCLUDE[vstecasp](../../../includes/vstecasp-md.md)] applications.</span></span>

<span data-ttu-id="d4e27-105">您也可以使用 *MageUI.exe* 這個圖形應用程式來取代 *Mage.exe*。</span><span class="sxs-lookup"><span data-stu-id="d4e27-105">You can also use *MageUI.exe*, a graphical application, instead of *Mage.exe*.</span></span> <span data-ttu-id="d4e27-106">如需詳細資訊，請參閱 [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-106">For more information, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md).</span></span>

<span data-ttu-id="d4e27-107">此工具會自動與 Visual Studio 一起安裝。</span><span class="sxs-lookup"><span data-stu-id="d4e27-107">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="d4e27-108">若要執行工具，請使用 Visual Studio 的開發人員命令提示字元。</span><span class="sxs-lookup"><span data-stu-id="d4e27-108">To run the tool, use Developer Command Prompt for Visual Studio.</span></span> <span data-ttu-id="d4e27-109">如需詳細資訊，請參閱[命令提示字元](../../../docs/framework/tools/developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-109">For more information, see [Command Prompts](../../../docs/framework/tools/developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="d4e27-110">有兩個版本的 *Mage.exe* 和 *MageUI.exe* 隨附於 Visual Studio。</span><span class="sxs-lookup"><span data-stu-id="d4e27-110">Two versions of *Mage.exe* and *MageUI.exe* are included with Visual Studio.</span></span> <span data-ttu-id="d4e27-111">若要查看版本資訊，請執行 *MageUI.exe*，並依序選取 [說明] 和 [關於]。</span><span class="sxs-lookup"><span data-stu-id="d4e27-111">To see version information, run *MageUI.exe*, select **Help**, and select **About**.</span></span> <span data-ttu-id="d4e27-112">此文件描述 4.0.x.x 版本的 *Mage.exe* 和 *MageUI.exe*。</span><span class="sxs-lookup"><span data-stu-id="d4e27-112">This documentation describes version 4.0.x.x of *Mage.exe* and *MageUI.exe*.</span></span>

## <a name="syntax"></a><span data-ttu-id="d4e27-113">語法</span><span class="sxs-lookup"><span data-stu-id="d4e27-113">Syntax</span></span>

```console
Mage [commands] [commandOptions]
```

## <a name="parameters"></a><span data-ttu-id="d4e27-114">參數</span><span class="sxs-lookup"><span data-stu-id="d4e27-114">Parameters</span></span>

<span data-ttu-id="d4e27-115">下表顯示 *Mage.exe* 所支援的命令。</span><span class="sxs-lookup"><span data-stu-id="d4e27-115">The following table shows the commands supported by *Mage.exe*.</span></span> <span data-ttu-id="d4e27-116">如需這些命令所支援選項的詳細資訊，請參閱[新增和更新命令選項](#new-and-update-command-options)和 [Sign 命令選項](#sign-command-options)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-116">For more information about the options supported by these commands, see [New and Update command options](#new-and-update-command-options) and [Sign command options](#sign-command-options).</span></span>

|<span data-ttu-id="d4e27-117">命令</span><span class="sxs-lookup"><span data-stu-id="d4e27-117">Command</span></span>|<span data-ttu-id="d4e27-118">說明</span><span class="sxs-lookup"><span data-stu-id="d4e27-118">Description</span></span>|
|-------------|-----------------|
|<span data-ttu-id="d4e27-119">**-cc, ClearApplicationCache**</span><span class="sxs-lookup"><span data-stu-id="d4e27-119">**-cc, ClearApplicationCache**</span></span>|<span data-ttu-id="d4e27-120">清除所有僅供線上使用之應用程式的已下載應用程式快取。</span><span class="sxs-lookup"><span data-stu-id="d4e27-120">Clears the downloaded application cache of all online-only applications.</span></span>|
|<span data-ttu-id="d4e27-121">**-n, -New** *fileType [newOptions]*</span><span class="sxs-lookup"><span data-stu-id="d4e27-121">**-n, -New** *fileType [newOptions]*</span></span>|<span data-ttu-id="d4e27-122">建立指定類型的新檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-122">Creates a new file of the given type.</span></span> <span data-ttu-id="d4e27-123">有效的類型如下：</span><span class="sxs-lookup"><span data-stu-id="d4e27-123">Valid types are:</span></span><br /><br /> <span data-ttu-id="d4e27-124">-   `Deployment`：建立新的部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-124">-   `Deployment`: Creates a new deployment manifest.</span></span><br /><span data-ttu-id="d4e27-125">-   `Application`：建立新的應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-125">-   `Application`: Creates a new application manifest.</span></span><br /><br /> <span data-ttu-id="d4e27-126">如果這個命令沒有指定額外的參數，就會以適當的預設標記和屬性值，建立適當類型的檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-126">If you do not specify any additional parameters with this command, it will create a file of the appropriate type, with appropriate default tags and attribute values.</span></span><br /><br /> <span data-ttu-id="d4e27-127">使用 **-ToFile** 選項 (見下表) 可以指定新檔案的檔案名稱和路徑。</span><span class="sxs-lookup"><span data-stu-id="d4e27-127">Use the **-ToFile** option (see in the following table) to specify the file name and path of the new file.</span></span><br /><br /> <span data-ttu-id="d4e27-128">使用 **-FromDirectory** 選項 (見下表) 可以建立應用程式資訊清單，並在此資訊清單的 \<相依性> 區段中新增應用程式的所有組件。</span><span class="sxs-lookup"><span data-stu-id="d4e27-128">Use the **-FromDirectory** option (see in the following table) to create an application manifest with all of the assemblies for an application added to the \<dependency> section of the manifest.</span></span>|
|<span data-ttu-id="d4e27-129">**-u, -Update** *[filePath] [updateOptions]*</span><span class="sxs-lookup"><span data-stu-id="d4e27-129">**-u, -Update** *[filePath] [updateOptions]*</span></span>|<span data-ttu-id="d4e27-130">對資訊清單檔案進行一個或多個變更。</span><span class="sxs-lookup"><span data-stu-id="d4e27-130">Makes one or more changes to a manifest file.</span></span> <span data-ttu-id="d4e27-131">您不必指定要編輯的檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-131">You do not have to specify the type of file that you are editing.</span></span> <span data-ttu-id="d4e27-132">Mage.exe 會使用一組啟發學習法來檢查檔案並判斷它是部署資訊清單或應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-132">Mage.exe will examine the file by using a set of heuristics and determine whether it is a deployment manifest or an application manifest.</span></span><br /><br /> <span data-ttu-id="d4e27-133">如果您已經使用憑證簽署檔案， **-Update** 會移除金鑰簽章區塊。</span><span class="sxs-lookup"><span data-stu-id="d4e27-133">If you have already signed a file with a certificate, **-Update** will remove the key signature block.</span></span> <span data-ttu-id="d4e27-134">這是因為金鑰簽章含有檔案的雜湊，修改檔案會使得雜湊變成無效。</span><span class="sxs-lookup"><span data-stu-id="d4e27-134">This is because the key signature contains a hash of the file, and modifying the file renders the hash invalid.</span></span><br /><br /> <span data-ttu-id="d4e27-135">使用 **-ToFile** 選項 (見下表) 可以指定新檔案名稱和路徑，而不會覆寫現有檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-135">Use the **-ToFile** option (see in the following table) to specify a new file name and path instead of overwriting the existing file.</span></span>|
|<span data-ttu-id="d4e27-136">**-s, -Sign** `[signOptions]`</span><span class="sxs-lookup"><span data-stu-id="d4e27-136">**-s, -Sign** `[signOptions]`</span></span>|<span data-ttu-id="d4e27-137">使用金鑰組或 X509 憑證簽署檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-137">Uses a key pair or X509 certificate to sign a file.</span></span> <span data-ttu-id="d4e27-138">簽章會以 XML 項目的形式插入檔案內。</span><span class="sxs-lookup"><span data-stu-id="d4e27-138">Signatures are inserted as XML elements inside of the files.</span></span><br /><br /> <span data-ttu-id="d4e27-139">簽署指定 **-TimestampUri** 值的資訊清單時，您必須連線到網際網路。</span><span class="sxs-lookup"><span data-stu-id="d4e27-139">You must be connected to the Internet when signing a manifest that specifies a **-TimestampUri** value.</span></span>|
|<span data-ttu-id="d4e27-140">**-ver, -Verify** *[manifest-filename]*</span><span class="sxs-lookup"><span data-stu-id="d4e27-140">**-ver, -Verify** *[manifest-filename]*</span></span>|<span data-ttu-id="d4e27-141">確認已正確簽署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-141">Verifies that the manifest is signed correctly.</span></span> <span data-ttu-id="d4e27-142">無法與其他命令合併。</span><span class="sxs-lookup"><span data-stu-id="d4e27-142">Cannot be combined with other commands.</span></span> <br/><br/><span data-ttu-id="d4e27-143">**適用於 .NET Framework 4.7 和更新版本。**</span><span class="sxs-lookup"><span data-stu-id="d4e27-143">**Available in .NET Framework 4.7 and later versions.**</span></span>|
|<span data-ttu-id="d4e27-144">**-h, -?, -Help** *[verbose]*</span><span class="sxs-lookup"><span data-stu-id="d4e27-144">**-h, -?, -Help** *[verbose]*</span></span>|<span data-ttu-id="d4e27-145">描述所有可用命令及其選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-145">Describes all of the available commands and their options.</span></span> <span data-ttu-id="d4e27-146">指定 `verbose` 可取得詳細的說明。</span><span class="sxs-lookup"><span data-stu-id="d4e27-146">Specify `verbose` to get detailed help.</span></span>|

## <a name="new-and-update-command-options"></a><span data-ttu-id="d4e27-147">新增和更新命令選項</span><span class="sxs-lookup"><span data-stu-id="d4e27-147">New and Update command options</span></span>

<span data-ttu-id="d4e27-148">下表顯示 `-New` 和 `-Update` 命令支援的選項：</span><span class="sxs-lookup"><span data-stu-id="d4e27-148">The following table shows the options supported by the `-New` and `-Update` commands:</span></span>

|<span data-ttu-id="d4e27-149">選項</span><span class="sxs-lookup"><span data-stu-id="d4e27-149">Options</span></span>|<span data-ttu-id="d4e27-150">預設值</span><span class="sxs-lookup"><span data-stu-id="d4e27-150">Default Value</span></span>|<span data-ttu-id="d4e27-151">適用於</span><span class="sxs-lookup"><span data-stu-id="d4e27-151">Applies To</span></span>|<span data-ttu-id="d4e27-152">說明</span><span class="sxs-lookup"><span data-stu-id="d4e27-152">Description</span></span>|
|-------------|-------------------|----------------|-----------------|
|<span data-ttu-id="d4e27-153">**-a, -Algorithm**</span><span class="sxs-lookup"><span data-stu-id="d4e27-153">**-a, -Algorithm**</span></span>|<span data-ttu-id="d4e27-154">sha1RSA</span><span class="sxs-lookup"><span data-stu-id="d4e27-154">sha1RSA</span></span>|<span data-ttu-id="d4e27-155">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-155">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-156">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-156">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-157">指定產生相依性摘要的演算法。</span><span class="sxs-lookup"><span data-stu-id="d4e27-157">Specifies the algorithm to generate dependency digests with.</span></span> <span data-ttu-id="d4e27-158">值必須是 "sha256RSA" 或 "sha1RSA"。</span><span class="sxs-lookup"><span data-stu-id="d4e27-158">Value must be "sha256RSA" or "sha1RSA.</span></span><br /><br /> <span data-ttu-id="d4e27-159">搭配 "-Update" 選項一起使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-159">Use with the "-Update" option.</span></span> <span data-ttu-id="d4e27-160">這個選項在使用 "-Sign" 選項時會被忽略。</span><span class="sxs-lookup"><span data-stu-id="d4e27-160">This option is ignored when using the "-Sign" option</span></span>|
|<span data-ttu-id="d4e27-161">**-appc, -AppCodeBase** `manifestReference`</span><span class="sxs-lookup"><span data-stu-id="d4e27-161">**-appc, -AppCodeBase** `manifestReference`</span></span>||<span data-ttu-id="d4e27-162">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-162">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-163">插入應用程式資訊清單檔案的 URL 或檔案路徑參考。</span><span class="sxs-lookup"><span data-stu-id="d4e27-163">Inserts a URL or file path reference to the application manifest file.</span></span> <span data-ttu-id="d4e27-164">這個值必須是應用程式資訊清單的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="d4e27-164">This value must be the full path to the application manifest.</span></span>|
|<span data-ttu-id="d4e27-165">**-appm, -AppManifest** `manifestPath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-165">**-appm, -AppManifest** `manifestPath`</span></span>||<span data-ttu-id="d4e27-166">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-166">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-167">將部署的應用程式資訊清單參考插入其部署資訊清單中。</span><span class="sxs-lookup"><span data-stu-id="d4e27-167">Inserts a reference to a deployment's application manifest into its deployment manifest.</span></span><br /><br /> <span data-ttu-id="d4e27-168">`manifestPath` 所表示的檔案必須存在，否則 *Mage.exe* 會發出錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="d4e27-168">The file indicated by `manifestPath` must exist, or *Mage.exe* will issue an error.</span></span> <span data-ttu-id="d4e27-169">如果 `manifestPath` 所參考的檔案不是應用程式資訊清單，*Mage.exe* 會發出錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="d4e27-169">If the file referenced by `manifestPath` is not an application manifest, *Mage.exe* will issue an error.</span></span>|
|<span data-ttu-id="d4e27-170">**-cf, -CertFile** `filePath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-170">**-cf, -CertFile** `filePath`</span></span>||<span data-ttu-id="d4e27-171">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-171">All file types.</span></span>|<span data-ttu-id="d4e27-172">指定用來簽署資訊清單或授權檔案之 X509 數位憑證的位置。</span><span class="sxs-lookup"><span data-stu-id="d4e27-172">Specifies the location of an X509 digital certificate for signing a manifest or license file.</span></span> <span data-ttu-id="d4e27-173">如果憑證需要適用於個人資訊交換 (PFX) 檔案的密碼，這個選項就可以與 **-Password** 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-173">This option can be used in conjunction with the **-Password** option if the certificate requires a password for Personal Information Exchange (PFX) files.</span></span> <span data-ttu-id="d4e27-174">從 .NET Framework 4.7 開始，如果檔案不包含私用金鑰，則需要 **-CryptoProvider** 和 **-KeyContainer** 選項的組合。</span><span class="sxs-lookup"><span data-stu-id="d4e27-174">Starting with .NET Framework 4.7, if the file does not contain a private key, a combination of the **-CryptoProvider** and **-KeyContainer** options is required.</span></span><br/><br/><span data-ttu-id="d4e27-175">從 .NET Framework 4.6.2 開始，*Mage.exe* 會使用 CNG 以及 CAPI 憑證來簽署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-175">Starting with .NET Framework 4.6.2, *Mage.exe* signs manifests with CNG as well as CAPI certificates.</span></span>|
|<span data-ttu-id="d4e27-176">**-ch, -CertHash** `hashSignature`</span><span class="sxs-lookup"><span data-stu-id="d4e27-176">**-ch, -CertHash** `hashSignature`</span></span>||<span data-ttu-id="d4e27-177">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-177">All file types.</span></span>|<span data-ttu-id="d4e27-178">數位憑證的雜湊儲存在用戶端電腦的個人憑證存放區內。</span><span class="sxs-lookup"><span data-stu-id="d4e27-178">The hash of a digital certificate stored in the personal certificate store of the client computer.</span></span> <span data-ttu-id="d4e27-179">它對應到數位憑證的指模字串，此字串可以從 Windows 憑證主控台檢視。</span><span class="sxs-lookup"><span data-stu-id="d4e27-179">This corresponds to the Thumbprint string of a digital certificate viewed in the Windows Certificates Console.</span></span><br /><br /> <span data-ttu-id="d4e27-180">`hashSignature` 大小寫都可，提供的格式可以是單一字串，或是將整個指模以引號括起來 (指模中每八個位元組以空格隔開)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-180">`hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string, or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.</span></span>|
|<span data-ttu-id="d4e27-181">**-csp, -CryptoProvider** `provider-name`</span><span class="sxs-lookup"><span data-stu-id="d4e27-181">**-csp, -CryptoProvider** `provider-name`</span></span>||<span data-ttu-id="d4e27-182">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-182">All file types.</span></span>|<span data-ttu-id="d4e27-183">指定包含私密金鑰容器的密碼編譯服務提供者 (CSP) 名稱。</span><span class="sxs-lookup"><span data-stu-id="d4e27-183">Specifies the name of a cryptographic service provider (CSP) that contains the private key container.</span></span> <span data-ttu-id="d4e27-184">這個選項需要 **-KeyContainer** 選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-184">This option requires the **-KeyContainer** option.</span></span><br/><br/><span data-ttu-id="d4e27-185">從 .NET Framework 4.7 開始提供此選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-185">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d4e27-186">**-fd, -FromDirectory** `directoryPath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-186">**-fd, -FromDirectory** `directoryPath`</span></span>||<span data-ttu-id="d4e27-187">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-187">Application manifests.</span></span>|<span data-ttu-id="d4e27-188">將 `directoryPath`中找到的所有組件和檔案的描述，填入應用程式資訊清單中，包括所有的子目錄，其中 `directoryPath` 是您想部署應用程式所在的目錄。</span><span class="sxs-lookup"><span data-stu-id="d4e27-188">Populates the application manifest with descriptions of all assemblies and files found in `directoryPath`, including all subdirectories, where `directoryPath` is the directory that contains the application that you want to deploy.</span></span> <span data-ttu-id="d4e27-189">*Mage.exe* 會判斷目錄中的每個檔案是組件還是靜態檔。</span><span class="sxs-lookup"><span data-stu-id="d4e27-189">For each file in the directory, *Mage.exe* decides whether the file is an assembly or a static file.</span></span> <span data-ttu-id="d4e27-190">如果是組件，它會在應用程式中加入 `<dependency>` 標記和 `installFrom` 屬性，以及這個組件的名稱、程式碼基底和版本。</span><span class="sxs-lookup"><span data-stu-id="d4e27-190">If it is an assembly, it adds a `<dependency>` tag and `installFrom` attribute to the application with the assembly's name, code base, and version.</span></span> <span data-ttu-id="d4e27-191">如果是靜態檔案，它會加入 `<file>` 標記。</span><span class="sxs-lookup"><span data-stu-id="d4e27-191">If it is a static file, it adds a `<file>` tag.</span></span> <span data-ttu-id="d4e27-192">*Mage.exe* 也會使用一組簡單的啟發學習法來偵測應用程式的主要可執行檔，並在資訊清單中將它標示為 ClickOnce 應用程式的進入點。</span><span class="sxs-lookup"><span data-stu-id="d4e27-192">*Mage.exe* will also use a simple set of heuristics to detect the main executable for the application, and will mark it as the ClickOnce application's entry point in the manifest.</span></span><br /><br /> <span data-ttu-id="d4e27-193">*Mage.exe* 不會自動將檔案標示為「資料」檔。</span><span class="sxs-lookup"><span data-stu-id="d4e27-193">*Mage.exe* will never automatically mark a file as a "data" file.</span></span> <span data-ttu-id="d4e27-194">您必須手動標示。</span><span class="sxs-lookup"><span data-stu-id="d4e27-194">You must do this manually.</span></span> <span data-ttu-id="d4e27-195">如需詳細資訊，請參閱[如何：在 ClickOnce 應用程式中納入資料檔案](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-195">For more information, see [How to: Include a Data File in a ClickOnce Application](/visualstudio/deployment/how-to-include-a-data-file-in-a-clickonce-application).</span></span><br /><br /> <span data-ttu-id="d4e27-196">*Mage.exe* 也會依據每個檔案的大小來產生雜湊。</span><span class="sxs-lookup"><span data-stu-id="d4e27-196">*Mage.exe* also generates a hash for each file based on its size.</span></span> <span data-ttu-id="d4e27-197">ClickOnce 使用這些雜湊來確保自從建立資訊清單後，沒有遭他人修改過這個部署的檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-197">ClickOnce uses these hashes to ensure that no one has tampered with the deployment's files since the manifest was created.</span></span> <span data-ttu-id="d4e27-198">如果部署中的任何檔案有所變更，您可以搭配使用 **-Update** 命令和 **-FromDirectory** 選項來執行 *Mage.exe*，以更新所有參考檔案的雜湊和組件版本。</span><span class="sxs-lookup"><span data-stu-id="d4e27-198">If any of the files in your deployment change, you can run *Mage.exe* with the **-Update** command and the **-FromDirectory** option, and it will update the hashes and assembly versions of all referenced files.</span></span><br /><br /> <span data-ttu-id="d4e27-199">**-FromDirectory** 會包含 `directoryPath`內所有子目錄的全部檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-199">**-FromDirectory** will include all files in all subdirectories found within `directoryPath`.</span></span><br /><br /> <span data-ttu-id="d4e27-200">如果您搭配 **-FromDirectory** 使用 *-Update* 命令，**Mage.exe** 會從應用程式資訊清單中移除已不在目錄中的檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-200">If you use **-FromDirectory** with the **-Update** command, *Mage.exe* will remove any files in the application manifest that no longer exist in the directory.</span></span>|
|<span data-ttu-id="d4e27-201">**-if, -IconFile**  `filePath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-201">**-if, -IconFile**  `filePath`</span></span>||<span data-ttu-id="d4e27-202">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-202">Application manifests.</span></span>|<span data-ttu-id="d4e27-203">指定 .ICO 圖示檔的完整路徑。</span><span class="sxs-lookup"><span data-stu-id="d4e27-203">Specifies the full path to an .ICO icon file.</span></span> <span data-ttu-id="d4e27-204">這個圖示會出現在 [開始] 功能表中您的應用程式名稱旁，以及 [新增或移除程式] 項目中。</span><span class="sxs-lookup"><span data-stu-id="d4e27-204">This icon appears beside your application name in the start menu, and in its Add-or-Remove Programs entry.</span></span> <span data-ttu-id="d4e27-205">如果沒有提供圖示，就會使用預設圖示。</span><span class="sxs-lookup"><span data-stu-id="d4e27-205">If no icon is provided, a default icon is used.</span></span>|
|<span data-ttu-id="d4e27-206">**-ip, -IncludeProviderURL**  `url`</span><span class="sxs-lookup"><span data-stu-id="d4e27-206">**-ip, -IncludeProviderURL**  `url`</span></span>|<span data-ttu-id="d4e27-207">true</span><span class="sxs-lookup"><span data-stu-id="d4e27-207">true</span></span>|<span data-ttu-id="d4e27-208">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-208">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-209">指出部署資訊清單是否包括由 **-ProviderURL**設定的更新位置值。</span><span class="sxs-lookup"><span data-stu-id="d4e27-209">Indicates whether the deployment manifest includes the update location value set by **-ProviderURL**.</span></span>|
|<span data-ttu-id="d4e27-210">**-i, -Install** `willInstall`</span><span class="sxs-lookup"><span data-stu-id="d4e27-210">**-i, -Install** `willInstall`</span></span>|<span data-ttu-id="d4e27-211">true</span><span class="sxs-lookup"><span data-stu-id="d4e27-211">true</span></span>|<span data-ttu-id="d4e27-212">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-212">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-213">指出 ClickOnce 應用程式是否要安裝到本機電腦上，或者它是否要從 Web 執行安裝。</span><span class="sxs-lookup"><span data-stu-id="d4e27-213">Indicates whether or not the ClickOnce application should install onto the local computer, or whether it should run from the Web.</span></span> <span data-ttu-id="d4e27-214">應用程式在安裝後會出現在 Windows [ **開始** ] 功能表中。</span><span class="sxs-lookup"><span data-stu-id="d4e27-214">Installing an application gives that application a presence in the Windows **Start** menu.</span></span> <span data-ttu-id="d4e27-215">有效值為 "true" (或 "t") 和 "false" (或 "f")。</span><span class="sxs-lookup"><span data-stu-id="d4e27-215">Valid values are "true" or "t", and "false" or "f".</span></span><br /><br /> <span data-ttu-id="d4e27-216">如果您指定 **-MinVersion** 選項，但使用者擁有的版本低於所安裝的 **-MinVersion** ，這時會強制應用程式進行安裝，不管您傳遞至 **-Install**的值為何。</span><span class="sxs-lookup"><span data-stu-id="d4e27-216">If you specify the **-MinVersion** option, and a user has a version less than **-MinVersion** installed, it will force the application to install, regardless of the value that you pass to **-Install**.</span></span><br /><br /> <span data-ttu-id="d4e27-217">這個選項無法與 **-BrowserHosted** 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-217">This option cannot be used with the **-BrowserHosted** option.</span></span> <span data-ttu-id="d4e27-218">嘗試在相同的資訊清單同時指定這兩個選項會導致錯誤。</span><span class="sxs-lookup"><span data-stu-id="d4e27-218">Attempting to specify both for the same manifest will result in an error.</span></span>|
|<span data-ttu-id="d4e27-219">**-kc, -KeyContainer** `name`</span><span class="sxs-lookup"><span data-stu-id="d4e27-219">**-kc, -KeyContainer** `name`</span></span>||<span data-ttu-id="d4e27-220">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-220">All file types.</span></span>|<span data-ttu-id="d4e27-221">指定包含私密金鑰名稱的金鑰容器。</span><span class="sxs-lookup"><span data-stu-id="d4e27-221">Specifies the key container that contains the name of the private key.</span></span> <span data-ttu-id="d4e27-222">這個選項需要 **CyproProvider** 選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-222">This option requires the **CyproProvider** option.</span></span><br/><br/><span data-ttu-id="d4e27-223">從 .NET Framework 4.7 開始提供此選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-223">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d4e27-224">**-mv, -MinVersion**  `[version]`</span><span class="sxs-lookup"><span data-stu-id="d4e27-224">**-mv, -MinVersion**  `[version]`</span></span>|<span data-ttu-id="d4e27-225">列於 ClickOnce 部署資訊清單中，由 **-Version** 旗標指定的版本。</span><span class="sxs-lookup"><span data-stu-id="d4e27-225">The version listed in the ClickOnce deployment manifest as specified by the **-Version** flag.</span></span>|<span data-ttu-id="d4e27-226">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-226">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-227">使用者可以執行的應用程式最小版本。</span><span class="sxs-lookup"><span data-stu-id="d4e27-227">The minimum version of this application a user can run.</span></span> <span data-ttu-id="d4e27-228">這個旗標可讓應用程式的具名版本成為必要的更新項目。</span><span class="sxs-lookup"><span data-stu-id="d4e27-228">This flag makes the named version of your application a required update.</span></span> <span data-ttu-id="d4e27-229">如果您發行的產品版本具有重大變更的更新或嚴重的安全性問題，即可使用這個旗標，指定必須安裝這個更新項目，且使用者不可再繼續執行舊版。</span><span class="sxs-lookup"><span data-stu-id="d4e27-229">If you release a version of your product with an update to a breaking change or a critical security flaw, you can use this flag to specify that this update must be installed, and that the user cannot continue to run earlier versions.</span></span><br /><br /> <span data-ttu-id="d4e27-230">`version` 的語意與 **-Version** 旗標的引數相同。</span><span class="sxs-lookup"><span data-stu-id="d4e27-230">`version` has the same semantics as the argument to the **-Version** flag.</span></span>|
|<span data-ttu-id="d4e27-231">**-n, -Name** `nameString`</span><span class="sxs-lookup"><span data-stu-id="d4e27-231">**-n, -Name** `nameString`</span></span>|<span data-ttu-id="d4e27-232">部署</span><span class="sxs-lookup"><span data-stu-id="d4e27-232">Deploy</span></span>|<span data-ttu-id="d4e27-233">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-233">All file types.</span></span>|<span data-ttu-id="d4e27-234">用來識別應用程式的名稱。</span><span class="sxs-lookup"><span data-stu-id="d4e27-234">The name that is used to identify the application.</span></span> <span data-ttu-id="d4e27-235">ClickOnce 會使用這個名稱來識別 [開始] 功能表 (如果應用程式是設定為自行安裝) 和 [使用權限提高] 對話方塊中的應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4e27-235">ClickOnce will use this name to identify the application in the **Start** menu (if the application is configured to install itself) and in Permission Elevation dialog boxes.</span></span> <span data-ttu-id="d4e27-236">**注意：** 如果您要更新現有的資訊清單，但未使用此選項來指定發行者名稱，*Mage.exe* 會更新含電腦上定義之組織名稱的資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-236">**Note:**  If you are updating an existing manifest and you do not specify a publisher name with this option, *Mage.exe* updates the manifest with the organization name defined on the computer.</span></span> <span data-ttu-id="d4e27-237">若要使用不同的名稱，請務必使用這個選項，並指定所需的發行者名稱。</span><span class="sxs-lookup"><span data-stu-id="d4e27-237">To use a different name, make sure to use this option and specify the desired publisher name.</span></span>|
|<span data-ttu-id="d4e27-238">**-pwd, -Password** `passwd`</span><span class="sxs-lookup"><span data-stu-id="d4e27-238">**-pwd, -Password** `passwd`</span></span>||<span data-ttu-id="d4e27-239">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-239">All file types.</span></span>|<span data-ttu-id="d4e27-240">以數位憑證替資訊清單簽章時所使用的密碼。</span><span class="sxs-lookup"><span data-stu-id="d4e27-240">The password that is used for signing a manifest with a digital certificate.</span></span> <span data-ttu-id="d4e27-241">必須與 **-CertFile** 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-241">Must be used in conjunction with the **-CertFile** option.</span></span>|
|<span data-ttu-id="d4e27-242">**-p, Processor** `processorValue`</span><span class="sxs-lookup"><span data-stu-id="d4e27-242">**-p, Processor** `processorValue`</span></span>|<span data-ttu-id="d4e27-243">Msil</span><span class="sxs-lookup"><span data-stu-id="d4e27-243">Msil</span></span>|<span data-ttu-id="d4e27-244">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-244">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-245">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-245">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-246">此散發所要執行的微處理器架構。</span><span class="sxs-lookup"><span data-stu-id="d4e27-246">The microprocessor architecture on which this distribution will run.</span></span> <span data-ttu-id="d4e27-247">如果您正準備進行一或數個安裝，且其組件已針對特定微處理器先行編譯過，則需要這個值。</span><span class="sxs-lookup"><span data-stu-id="d4e27-247">This value is required if you are preparing one or more installations whose assemblies have been precompiled for a specific microprocessor.</span></span> <span data-ttu-id="d4e27-248">有效值包括 `msil`、 `x86`、 `ia64`和 `amd64`。</span><span class="sxs-lookup"><span data-stu-id="d4e27-248">Valid values include `msil`, `x86`, `ia64`, and `amd64`.</span></span> <span data-ttu-id="d4e27-249">`msil` 為 Microsoft 中繼語言，這表示您的所有組件都與平台無關，而且當您的應用程式首次執行時，通用語言執行平台 (CLR) 會對它們進行 Just-In-Time 編譯。</span><span class="sxs-lookup"><span data-stu-id="d4e27-249">`msil` is Microsoft intermediate language, which means all of your assemblies are platform-independent, and the common language runtime (CLR) will just-in-time compile them when your application is first run.</span></span>|
|<span data-ttu-id="d4e27-250">**-pu,** **-ProviderURL** `url`</span><span class="sxs-lookup"><span data-stu-id="d4e27-250">**-pu,** **-ProviderURL** `url`</span></span>||<span data-ttu-id="d4e27-251">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-251">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-252">指定 URL，讓 ClickOnce 從該處檢查是否有應用程式更新。</span><span class="sxs-lookup"><span data-stu-id="d4e27-252">Specifies the URL which ClickOnce will examine for application updates.</span></span>|
|<span data-ttu-id="d4e27-253">**-pub, -Publisher** `publisherName`</span><span class="sxs-lookup"><span data-stu-id="d4e27-253">**-pub, -Publisher** `publisherName`</span></span>||<span data-ttu-id="d4e27-254">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-254">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-255">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-255">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-256">將發行者名稱加入到部署或應用程式資訊清單的描述項目。</span><span class="sxs-lookup"><span data-stu-id="d4e27-256">Adds the publisher name to the description element of either the deployment or application manifest.</span></span> <span data-ttu-id="d4e27-257">使用在應用程式資訊清單上時，也必須使用值 "true" 或 "t" 指定 **-UseManifestForTrust** ，否則此參數會引發錯誤。</span><span class="sxs-lookup"><span data-stu-id="d4e27-257">When used on an application manifest, **-UseManifestForTrust** must also be specified with a value of "true" or "t"; otherwise, this parameter will raise an error.</span></span>|
|<span data-ttu-id="d4e27-258">**-s, -SupportURL**  `url`</span><span class="sxs-lookup"><span data-stu-id="d4e27-258">**-s, -SupportURL**  `url`</span></span>||<span data-ttu-id="d4e27-259">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-259">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-260">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-260">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-261">指定出現在 [新增或移除程式] 中的 ClickOnce 應用程式連結。</span><span class="sxs-lookup"><span data-stu-id="d4e27-261">Specifies the link that appears in Add or Remove Programs for the ClickOnce application.</span></span>|
|<span data-ttu-id="d4e27-262">**-ti, -TimestampUri** `uri`</span><span class="sxs-lookup"><span data-stu-id="d4e27-262">**-ti, -TimestampUri** `uri`</span></span>||<span data-ttu-id="d4e27-263">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-263">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-264">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-264">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-265">數位時間戳記服務的 URL。</span><span class="sxs-lookup"><span data-stu-id="d4e27-265">The URL of a digital timestamping service.</span></span> <span data-ttu-id="d4e27-266">在資訊清單加上時間戳記之後，若數位憑證在您部署應用程式的下一個版本之前到期，就無須重新簽署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-266">Timestamping the manifests prevents you from having to re-sign the manifests should your digital certificate expire before you deploy the next version of your application.</span></span> <span data-ttu-id="d4e27-267">如需詳細資訊，請參閱 [Windows 根憑證程式成員](https://go.microsoft.com/fwlink/?LinkId=159000)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-267">For more information, see [Windows root certificate program members](https://go.microsoft.com/fwlink/?LinkId=159000).</span></span>|
|<span data-ttu-id="d4e27-268">**-t, -ToFile** `filePath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-268">**-t, -ToFile** `filePath`</span></span>|<span data-ttu-id="d4e27-269">-   新增：</span><span class="sxs-lookup"><span data-stu-id="d4e27-269">-   New:</span></span><br /><span data-ttu-id="d4e27-270">-   部署：deploy.application</span><span class="sxs-lookup"><span data-stu-id="d4e27-270">-   Deployment: deploy.application</span></span><br /><span data-ttu-id="d4e27-271">-   應用程式：application.exe.manifest</span><span class="sxs-lookup"><span data-stu-id="d4e27-271">-   Application: application.exe.manifest</span></span><br /><span data-ttu-id="d4e27-272">-   更新：</span><span class="sxs-lookup"><span data-stu-id="d4e27-272">-   Update:</span></span><br /><span data-ttu-id="d4e27-273">-   輸入檔。</span><span class="sxs-lookup"><span data-stu-id="d4e27-273">-   The input file.</span></span>|<span data-ttu-id="d4e27-274">所有檔案類型。</span><span class="sxs-lookup"><span data-stu-id="d4e27-274">All file types.</span></span>|<span data-ttu-id="d4e27-275">指定已建立或已修改之檔案的輸出路徑。</span><span class="sxs-lookup"><span data-stu-id="d4e27-275">Specifies the output path of the file that has been created or modified.</span></span><br /><br /> <span data-ttu-id="d4e27-276">如果使用 **-New** 時未提供 **-ToFile**，就會將輸出寫入目前的工作目錄。</span><span class="sxs-lookup"><span data-stu-id="d4e27-276">If **-ToFile** is not supplied when you use **-New**, the output is written to the current working directory.</span></span> <span data-ttu-id="d4e27-277">如果使用 **-Update** 時未提供 **-ToFile**，*Mage.exe* 就會將檔案寫回輸入檔。</span><span class="sxs-lookup"><span data-stu-id="d4e27-277">If **-ToFile** is not supplied when you use **-Update**, *Mage.exe* will write the file back to the input file.</span></span>|
|<span data-ttu-id="d4e27-278">**-tr, -TrustLevel** `level`</span><span class="sxs-lookup"><span data-stu-id="d4e27-278">**-tr, -TrustLevel** `level`</span></span>|<span data-ttu-id="d4e27-279">以應用程式 URL 所在區域為基礎。</span><span class="sxs-lookup"><span data-stu-id="d4e27-279">Based on the zone in which the application URL resides.</span></span>|<span data-ttu-id="d4e27-280">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-280">Application manifests.</span></span>|<span data-ttu-id="d4e27-281">要授與用戶端電腦上應用程式的信任層級。</span><span class="sxs-lookup"><span data-stu-id="d4e27-281">The level of trust to grant the application on client computers.</span></span> <span data-ttu-id="d4e27-282">可用的值包括 "Internet"、"Intranet" 和 "FullTrust"。</span><span class="sxs-lookup"><span data-stu-id="d4e27-282">Values include "Internet", "Intranet", and "FullTrust".</span></span>|
|<span data-ttu-id="d4e27-283">**-um, -UseManifestForTrust** `willUseForTrust`</span><span class="sxs-lookup"><span data-stu-id="d4e27-283">**-um, -UseManifestForTrust** `willUseForTrust`</span></span>|<span data-ttu-id="d4e27-284">False</span><span class="sxs-lookup"><span data-stu-id="d4e27-284">False</span></span>|<span data-ttu-id="d4e27-285">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-285">Application manifests.</span></span>|<span data-ttu-id="d4e27-286">指定當應用程式在用戶端上執行時，是否會使用應用程式資訊清單的數位簽章進行信任決策。</span><span class="sxs-lookup"><span data-stu-id="d4e27-286">Specifies whether the digital signature of the application manifest will be used for making trust decisions when the application runs on the client.</span></span> <span data-ttu-id="d4e27-287">指定 "true" 或 "t" 表示信任決策會使用應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-287">Specifying "true" or "t" indicates that the application manifest will be used for trust decisions.</span></span> <span data-ttu-id="d4e27-288">指定 "false" 或 "f" 則表示會使用部署資訊清單的簽章。</span><span class="sxs-lookup"><span data-stu-id="d4e27-288">Specifying "false" or "f" indicates that the signature of the deployment manifest will be used.</span></span>|
|<span data-ttu-id="d4e27-289">**-v, -Version** `versionNumber`</span><span class="sxs-lookup"><span data-stu-id="d4e27-289">**-v, -Version** `versionNumber`</span></span>|<span data-ttu-id="d4e27-290">1.0.0.0</span><span class="sxs-lookup"><span data-stu-id="d4e27-290">1.0.0.0</span></span>|<span data-ttu-id="d4e27-291">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-291">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-292">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-292">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-293">部署的版本。</span><span class="sxs-lookup"><span data-stu-id="d4e27-293">The version of the deployment.</span></span> <span data-ttu-id="d4e27-294">引數必須是格式為 "*N.N.N.N*" 的有效版本字串，其中 "*N*" 是不帶正負號的 32 位元整數。</span><span class="sxs-lookup"><span data-stu-id="d4e27-294">The argument must be a valid version string of the format "*N.N.N.N*", where "*N*" is an unsigned 32-bit integer.</span></span>|
|<span data-ttu-id="d4e27-295">**-wpf, -WPFBrowserApp**  `isWPFApp`</span><span class="sxs-lookup"><span data-stu-id="d4e27-295">**-wpf, -WPFBrowserApp**  `isWPFApp`</span></span>|<span data-ttu-id="d4e27-296">False</span><span class="sxs-lookup"><span data-stu-id="d4e27-296">false</span></span>|<span data-ttu-id="d4e27-297">應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-297">Application manifests.</span></span><br /><br /> <span data-ttu-id="d4e27-298">部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-298">Deployment manifests.</span></span>|<span data-ttu-id="d4e27-299">只有在應用程式是裝載在 Internet Explorer 內的 Windows Presentation Foundation (WPF) 應用程式，且不是獨立的可執行檔時，才使用這個旗標。</span><span class="sxs-lookup"><span data-stu-id="d4e27-299">Use this flag only if the application is a Windows Presentation Foundation (WPF) application that will be hosted inside of Internet Explorer, and is not a stand-alone executable.</span></span> <span data-ttu-id="d4e27-300">有效值為 "true" (或 "t") 和 "false" (或 "f")。</span><span class="sxs-lookup"><span data-stu-id="d4e27-300">Valid values are "true" or "t", and "false" or "f".</span></span><br /><br /> <span data-ttu-id="d4e27-301">若為應用程式資訊清單，會在應用程式資訊清單的 `hostInBrowser` 項目底下插入 `entryPoint` 屬性。</span><span class="sxs-lookup"><span data-stu-id="d4e27-301">For application manifests, inserts the `hostInBrowser` attribute under the `entryPoint` element of the application manifest.</span></span><br /><br /> <span data-ttu-id="d4e27-302">若為部署資訊清單，會將 `install` 項目上的 `deployment` 屬性設為 false，並將部署資訊清單儲存成副檔名為 .xbap 的檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-302">For deployment manifests, sets the `install` attribute on the `deployment` element to false, and saves the deployment manifest with a .xbap extension.</span></span> <span data-ttu-id="d4e27-303">這個引數與 **-Install** 引數一起指定時會產生錯誤，因為瀏覽器裝載的應用程式不能是已安裝的離線應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4e27-303">Specifying this argument along with the **-Install** argument produces an error, because a browser-hosted application cannot be an installed, offline application.</span></span>|

## <a name="sign-command-options"></a><span data-ttu-id="d4e27-304">Sign 命令選項</span><span class="sxs-lookup"><span data-stu-id="d4e27-304">Sign command options</span></span>

<span data-ttu-id="d4e27-305">下表顯示 `-Sign` 命令支援的選項，這些選項可以套用至所有類型的檔案。</span><span class="sxs-lookup"><span data-stu-id="d4e27-305">The following table shows the options supported by the `-Sign` command, which apply to all types of files.</span></span>

|<span data-ttu-id="d4e27-306">選項</span><span class="sxs-lookup"><span data-stu-id="d4e27-306">Options</span></span>|<span data-ttu-id="d4e27-307">說明</span><span class="sxs-lookup"><span data-stu-id="d4e27-307">Description</span></span>|
|-------------|-----------------|
|<span data-ttu-id="d4e27-308">**-cf, -CertFile** `filePath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-308">**-cf, -CertFile** `filePath`</span></span>|<span data-ttu-id="d4e27-309">指定為資訊清單簽署之數位憑證的位置。</span><span class="sxs-lookup"><span data-stu-id="d4e27-309">Specifies The location of a digital certificate for signing a manifest.</span></span> <span data-ttu-id="d4e27-310">如果憑證需要適用於個人資訊交換 (PFX) 檔案的密碼，這個選項就可以與 **-Password** 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-310">This option can be used in conjunction with the **-Password** option if the certificate requires a password for Personal Information Exchange (PFX) files.</span></span> <span data-ttu-id="d4e27-311">從 .NET Framework 4.7 開始，如果檔案不包含私用金鑰，則需要 **-CryptoProvider** 和 **-KeyContainer** 選項的組合。</span><span class="sxs-lookup"><span data-stu-id="d4e27-311">Starting with .NET Framework 4.7, if the file does not contain a private key, a combination of the **-CryptoProvider** and **-KeyContainer** options is required.</span></span><br/><br/><span data-ttu-id="d4e27-312">從 .NET Framework 4.6.2 開始，*Mage.exe* 會使用 CNG 以及 CAPI 憑證來簽署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-312">Starting with .NET Framework 4.6.2, *Mage.exe* signs manifests with CNG as well as CAPI certificates.</span></span>|
|<span data-ttu-id="d4e27-313">**-ch, -CertHash** `hashSignature`</span><span class="sxs-lookup"><span data-stu-id="d4e27-313">**-ch, -CertHash** `hashSignature`</span></span>|<span data-ttu-id="d4e27-314">數位憑證的雜湊儲存在用戶端電腦的個人憑證存放區內。</span><span class="sxs-lookup"><span data-stu-id="d4e27-314">The hash of a digital certificate stored in the personal certificate store of the client computer.</span></span> <span data-ttu-id="d4e27-315">它對應到數位憑證的 Thumbprint 屬性，此屬性可以從 Windows 憑證主控台檢視。</span><span class="sxs-lookup"><span data-stu-id="d4e27-315">This corresponds to the Thumbprint property of a digital certificate viewed in the Windows Certificates Console.</span></span><br /><br /> <span data-ttu-id="d4e27-316">`hashSignature` 大小寫都可，提供的格式可以是單一字串，或是將整個指模以引號括起來 (指模中每八個位元組以空格隔開)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-316">`hashSignature` can be either uppercase or lowercase, and can be supplied either as a single string or with each octet of the Thumbprint separated by spaces and the entire Thumbprint enclosed in quotation marks.</span></span>|
<span data-ttu-id="d4e27-317">**-csp, -CryptoProvider** `provider-name`</span><span class="sxs-lookup"><span data-stu-id="d4e27-317">**-csp, -CryptoProvider** `provider-name`</span></span>|<span data-ttu-id="d4e27-318">指定包含私密金鑰容器的密碼編譯服務提供者 (CSP) 名稱。</span><span class="sxs-lookup"><span data-stu-id="d4e27-318">Specifies the name of a cryptographic service provider (CSP) that contains the private key container.</span></span> <span data-ttu-id="d4e27-319">這個選項需要 **-KeyContainer** 選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-319">This option requires the **-KeyContainer** option.</span></span><br/><br/><span data-ttu-id="d4e27-320">從 .NET Framework 4.7 開始提供此選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-320">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d4e27-321">**-kc, -KeyContainer** `name`</span><span class="sxs-lookup"><span data-stu-id="d4e27-321">**-kc, -KeyContainer** `name`</span></span>|<span data-ttu-id="d4e27-322">指定包含私密金鑰名稱的金鑰容器。</span><span class="sxs-lookup"><span data-stu-id="d4e27-322">Specifies the key container that contains the name of the private key.</span></span> <span data-ttu-id="d4e27-323">這個選項需要 **CyproProvider** 選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-323">This option requires the **CyproProvider** option.</span></span><br/><br/><span data-ttu-id="d4e27-324">從 .NET Framework 4.7 開始提供此選項。</span><span class="sxs-lookup"><span data-stu-id="d4e27-324">This option is available starting with .NET Framework 4.7.</span></span>|
|<span data-ttu-id="d4e27-325">**-pwd, -Password** `passwd`</span><span class="sxs-lookup"><span data-stu-id="d4e27-325">**-pwd, -Password** `passwd`</span></span>|<span data-ttu-id="d4e27-326">以數位憑證替資訊清單簽章時所使用的密碼。</span><span class="sxs-lookup"><span data-stu-id="d4e27-326">The password that is used for signing a manifest with a digital certificate.</span></span> <span data-ttu-id="d4e27-327">必須與 **-CertFile** 選項搭配使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-327">Must be used in conjunction with the **-CertFile** option.</span></span>|
|<span data-ttu-id="d4e27-328">**-t, -ToFile** `filePath`</span><span class="sxs-lookup"><span data-stu-id="d4e27-328">**-t, -ToFile** `filePath`</span></span>|<span data-ttu-id="d4e27-329">指定已建立或已修改之檔案的輸出路徑。</span><span class="sxs-lookup"><span data-stu-id="d4e27-329">Specifies the output path of the file that has been created or modified.</span></span>|

## <a name="remarks"></a><span data-ttu-id="d4e27-330">備註</span><span class="sxs-lookup"><span data-stu-id="d4e27-330">Remarks</span></span>

<span data-ttu-id="d4e27-331">*Mage.exe* 的所有引數都不區分大小寫。</span><span class="sxs-lookup"><span data-stu-id="d4e27-331">All arguments to *Mage.exe* are case-insensitive.</span></span> <span data-ttu-id="d4e27-332">命令和選項可以使用破折號 (-) 或正斜線 (/) 當做前置字元。</span><span class="sxs-lookup"><span data-stu-id="d4e27-332">Commands and options can be prefixed with a dash (-) or a forward slash (/).</span></span>

<span data-ttu-id="d4e27-333">搭配 **-Sign** 命令使用的所有引數，也隨時都能搭配 **-New** 或 **-Update** 命令使用。</span><span class="sxs-lookup"><span data-stu-id="d4e27-333">All of the arguments used with the **-Sign** command can be used at any time with the **-New** or **-Update** commands as well.</span></span> <span data-ttu-id="d4e27-334">下列命令是相同的。</span><span class="sxs-lookup"><span data-stu-id="d4e27-334">The following commands are equivalent.</span></span>

```console
mage -Sign c:\HelloWorldDeployment\HelloWorld.deploy -CertFile cert.pfx
mage -Update c:\HelloWorldDeployment\HelloWorld.deploy -CertFile cert.pfx
```

> [!NOTE]
> <span data-ttu-id="d4e27-335">從 .NET Framework 4.6.2 版開始，也支援 CNG 憑證。</span><span class="sxs-lookup"><span data-stu-id="d4e27-335">Beginning with .NET Framework version 4.6.2, CNG certificates are also supported.</span></span>

 <span data-ttu-id="d4e27-336">最後要執行的工作是簽署，因為簽署後的文件會使用檔案雜湊來驗證此簽章對文件是否有效。</span><span class="sxs-lookup"><span data-stu-id="d4e27-336">Signing is the last task you should perform, because a signed document uses a hash of the file to verify that the signature is valid for the document.</span></span> <span data-ttu-id="d4e27-337">如果您已對簽署後的檔案進行任何變更，就必須重新簽署一次。</span><span class="sxs-lookup"><span data-stu-id="d4e27-337">If you make any changes to a signed file, you must sign it again.</span></span> <span data-ttu-id="d4e27-338">如果您對先前簽署過的文件再次簽章，*Mage.exe* 會以新簽章取代舊簽章。</span><span class="sxs-lookup"><span data-stu-id="d4e27-338">If you sign a document that was previously signed, *Mage.exe* will replace the old signature with the new.</span></span>

 <span data-ttu-id="d4e27-339">當您使用 **-AppManifest** 選項填入部署資訊清單時，*Mage.exe* 會假設應用程式資訊清單位於以目前的部署版本命名的子目錄下，與部署資訊清單相同的目錄中，並且會適當地設定部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-339">When you use the **-AppManifest** option to populate a deployment manifest, *Mage.exe* will assume that your application manifest will reside in the same directory as the deployment manifest within a subdirectory named after the current deployment version, and will configure your deployment manifest appropriately.</span></span> <span data-ttu-id="d4e27-340">如果您的應用程式資訊清單要位於其他位置，請使用 **-AppCodeBase** 選項設定替代位置。</span><span class="sxs-lookup"><span data-stu-id="d4e27-340">If your application manifest will reside elsewhere, use the **-AppCodeBase** option to set the alternate location.</span></span>

 <span data-ttu-id="d4e27-341">在部署應用程式之前，必須先替部署和應用程式資訊清單簽章。</span><span class="sxs-lookup"><span data-stu-id="d4e27-341">Your deployment and application manifest must be signed before you deploy your application.</span></span> <span data-ttu-id="d4e27-342">如需簽署資訊清單的相關指引，請參閱 [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-342">For guidance about signing manifests, see [Trusted Application Deployment Overview](/visualstudio/deployment/trusted-application-deployment-overview).</span></span>

 <span data-ttu-id="d4e27-343">應用程式資訊清單的 **-TrustLevel** 選項，描述了要在用戶端電腦上執行應用程式時所需的使用權限集合。</span><span class="sxs-lookup"><span data-stu-id="d4e27-343">The **-TrustLevel** option for application manifests describes the permission set an application requires to run on the client computer.</span></span> <span data-ttu-id="d4e27-344">根據預設，應用程式的信任層級是依據其 URL 所在的「 *區域* 」(Zone) 來指派。</span><span class="sxs-lookup"><span data-stu-id="d4e27-344">By default, applications are assigned a trust level based on the *zone* in which their URL resides.</span></span> <span data-ttu-id="d4e27-345">透過公司網路所部署的應用程式，通常都位於內部網路區域，而透過網際網路所部署的應用程式，則位於網際網路區域。</span><span class="sxs-lookup"><span data-stu-id="d4e27-345">Applications deployed over a corporate network are generally placed in the Intranet zone, while those deployed over the Internet are placed in the Internet zone.</span></span> <span data-ttu-id="d4e27-346">這兩個安全性區域對應用程式存取本機資源的能力都有限制，其中內部網路區域的使用權限稍微大於網際網路區域。</span><span class="sxs-lookup"><span data-stu-id="d4e27-346">Both security zones place restrictions on the application's access to local resources, with the Intranet zone slightly more permissive than the Internet zone.</span></span> <span data-ttu-id="d4e27-347">FullTrust 區域授與應用程式完整的存取權限，可以存取電腦的本機資源。</span><span class="sxs-lookup"><span data-stu-id="d4e27-347">The FullTrust zone gives applications complete access to a computer's local resources.</span></span> <span data-ttu-id="d4e27-348">如果使用 **-TrustLevel** 選項將應用程式放在這個區域，則 CLR 的「信任管理員」元件將會提示使用者決定是否要授與這個較高層次的信任。</span><span class="sxs-lookup"><span data-stu-id="d4e27-348">If you use the **-TrustLevel** option to place an application in this zone, the Trust Manager component of the CLR will prompt the user to decide whether he or she wants to grant this higher level of trust.</span></span> <span data-ttu-id="d4e27-349">如果您透過公司網路來部署應用程式，即可使用「受信任的應用程式部署」來提高應用程式的信任層次，而不需要提示使用者做決定。</span><span class="sxs-lookup"><span data-stu-id="d4e27-349">If you are deploying your application over a corporate network, you can use Trusted Application Deployment to raise the trust level of the application without prompting the user.</span></span>

 <span data-ttu-id="d4e27-350">應用程式資訊清單同時也支援自訂信任的區段。</span><span class="sxs-lookup"><span data-stu-id="d4e27-350">Application manifests also support custom trust sections.</span></span> <span data-ttu-id="d4e27-351">這可以協助應用程式遵守「要求最少使用權限」的安全性原則，因為您可以將資訊清單設定成只要求執行應用程式所需的特定使用權限。</span><span class="sxs-lookup"><span data-stu-id="d4e27-351">This helps your application obey the security principle of requesting least permission, as you can configure the manifest to demand only those specific permissions that the application requires in order to execute.</span></span> <span data-ttu-id="d4e27-352">*Mage.exe* 不直接支援新增自訂信任區段。</span><span class="sxs-lookup"><span data-stu-id="d4e27-352">*Mage.exe* does not directly support adding a custom trust section.</span></span> <span data-ttu-id="d4e27-353">您可以使用文字編輯器、XML 剖析器或圖形工具 *MageUI.exe* 來新增一個區段。</span><span class="sxs-lookup"><span data-stu-id="d4e27-353">You can add one using a text editor, an XML parser, or the graphical tool *MageUI.exe*.</span></span> <span data-ttu-id="d4e27-354">如需如何使用 *MageUI.exe* 新增自訂信任區段的詳細資訊，請參閱 [MageUI.exe (圖形用戶端、資訊清單產生和編輯工具)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)。</span><span class="sxs-lookup"><span data-stu-id="d4e27-354">For more information about how to use *MageUI.exe* to add custom trust sections, see [MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md).</span></span>

<span data-ttu-id="d4e27-355">Visual Studio 2017 包含 *Mage.exe* 的 4.6.1 版。</span><span class="sxs-lookup"><span data-stu-id="d4e27-355">Visual Studio 2017 includes version 4.6.1 of *Mage.exe*.</span></span> <span data-ttu-id="d4e27-356">使用此版本的 *Mage.exe* 建立的資訊清單以 .NET Framework 4 為目標。</span><span class="sxs-lookup"><span data-stu-id="d4e27-356">Manifests created with this version of *Mage.exe* target .NET Framework 4.</span></span> <span data-ttu-id="d4e27-357">若要以舊版的 .NET Framework 為目標，請使用舊版的 *Mage.exe*。</span><span class="sxs-lookup"><span data-stu-id="d4e27-357">To target older versions of the .NET Framework, use an earlier version of *Mage.exe*.</span></span>

<span data-ttu-id="d4e27-358">當從現有的資訊清單新增或移除組件或重新簽署現有的資訊清單時，*Mage.exe* 並不會以 .NET Framework 4 為目標更新資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-358">When you add or remove assemblies from an existing manifest, or re-sign an existing manifest, *Mage.exe* does not update the manifest to target .NET Framework 4.</span></span>

<span data-ttu-id="d4e27-359">下表顯示這些功能和限制：</span><span class="sxs-lookup"><span data-stu-id="d4e27-359">The following tables show these features and restrictions:</span></span>

|<span data-ttu-id="d4e27-360">資訊清單版本</span><span class="sxs-lookup"><span data-stu-id="d4e27-360">Manifest version</span></span>|<span data-ttu-id="d4e27-361">運算</span><span class="sxs-lookup"><span data-stu-id="d4e27-361">Operation</span></span>|<span data-ttu-id="d4e27-362">Mage v2.0</span><span class="sxs-lookup"><span data-stu-id="d4e27-362">Mage v2.0</span></span>|<span data-ttu-id="d4e27-363">Mage v4.0</span><span class="sxs-lookup"><span data-stu-id="d4e27-363">Mage v4.0</span></span>|
|----------------------|---------------|---------------|---------------|
|<span data-ttu-id="d4e27-364">以 .NET Framework 2.0 或 3.x 為目標之應用程式的資訊清單</span><span class="sxs-lookup"><span data-stu-id="d4e27-364">Manifest for applications targeting version 2.0 or 3.x of the .NET Framework</span></span>|<span data-ttu-id="d4e27-365">開啟</span><span class="sxs-lookup"><span data-stu-id="d4e27-365">Open</span></span>|<span data-ttu-id="d4e27-366">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-366">OK</span></span>|<span data-ttu-id="d4e27-367">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-367">OK</span></span>|
||<span data-ttu-id="d4e27-368">關閉</span><span class="sxs-lookup"><span data-stu-id="d4e27-368">Close</span></span>|<span data-ttu-id="d4e27-369">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-369">OK</span></span>|<span data-ttu-id="d4e27-370">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-370">OK</span></span>|
||<span data-ttu-id="d4e27-371">儲存</span><span class="sxs-lookup"><span data-stu-id="d4e27-371">Save</span></span>|<span data-ttu-id="d4e27-372">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-372">OK</span></span>|<span data-ttu-id="d4e27-373">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-373">OK</span></span>|
||<span data-ttu-id="d4e27-374">重新簽署</span><span class="sxs-lookup"><span data-stu-id="d4e27-374">Re-sign</span></span>|<span data-ttu-id="d4e27-375">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-375">OK</span></span>|<span data-ttu-id="d4e27-376">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-376">OK</span></span>|
||<span data-ttu-id="d4e27-377">新增</span><span class="sxs-lookup"><span data-stu-id="d4e27-377">New</span></span>|<span data-ttu-id="d4e27-378">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-378">OK</span></span>|<span data-ttu-id="d4e27-379">不支援</span><span class="sxs-lookup"><span data-stu-id="d4e27-379">Not supported</span></span>|
||<span data-ttu-id="d4e27-380">更新 (請參閱下方)</span><span class="sxs-lookup"><span data-stu-id="d4e27-380">Update (see below)</span></span>|<span data-ttu-id="d4e27-381">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-381">OK</span></span>|<span data-ttu-id="d4e27-382">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-382">OK</span></span>|
|<span data-ttu-id="d4e27-383">以 .NET Framework 第 4 版為目標之應用程式的資訊清單</span><span class="sxs-lookup"><span data-stu-id="d4e27-383">Manifest for applications targeting version 4 of the .NET Framework</span></span>|<span data-ttu-id="d4e27-384">開啟</span><span class="sxs-lookup"><span data-stu-id="d4e27-384">Open</span></span>|<span data-ttu-id="d4e27-385">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-385">OK</span></span>|<span data-ttu-id="d4e27-386">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-386">OK</span></span>|
||<span data-ttu-id="d4e27-387">關閉</span><span class="sxs-lookup"><span data-stu-id="d4e27-387">Close</span></span>|<span data-ttu-id="d4e27-388">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-388">OK</span></span>|<span data-ttu-id="d4e27-389">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-389">OK</span></span>|
||<span data-ttu-id="d4e27-390">儲存</span><span class="sxs-lookup"><span data-stu-id="d4e27-390">Save</span></span>|<span data-ttu-id="d4e27-391">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-391">OK</span></span>|<span data-ttu-id="d4e27-392">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-392">OK</span></span>|
||<span data-ttu-id="d4e27-393">重新簽署</span><span class="sxs-lookup"><span data-stu-id="d4e27-393">Re-sign</span></span>|<span data-ttu-id="d4e27-394">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-394">OK</span></span>|<span data-ttu-id="d4e27-395">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-395">OK</span></span>|
||<span data-ttu-id="d4e27-396">新增</span><span class="sxs-lookup"><span data-stu-id="d4e27-396">New</span></span>|<span data-ttu-id="d4e27-397">不支援</span><span class="sxs-lookup"><span data-stu-id="d4e27-397">Not supported</span></span>|<span data-ttu-id="d4e27-398">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-398">OK</span></span>|
||<span data-ttu-id="d4e27-399">更新 (請參閱下方)</span><span class="sxs-lookup"><span data-stu-id="d4e27-399">Update (see below)</span></span>|<span data-ttu-id="d4e27-400">不支援</span><span class="sxs-lookup"><span data-stu-id="d4e27-400">Not supported</span></span>|<span data-ttu-id="d4e27-401">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-401">OK</span></span>|

|<span data-ttu-id="d4e27-402">資訊清單版本</span><span class="sxs-lookup"><span data-stu-id="d4e27-402">Manifest version</span></span>|<span data-ttu-id="d4e27-403">更新作業詳細資料</span><span class="sxs-lookup"><span data-stu-id="d4e27-403">Update Operation Details</span></span>|<span data-ttu-id="d4e27-404">Mage v2.0</span><span class="sxs-lookup"><span data-stu-id="d4e27-404">Mage v2.0</span></span>|<span data-ttu-id="d4e27-405">Mage v4.0</span><span class="sxs-lookup"><span data-stu-id="d4e27-405">Mage v4.0</span></span>|
|----------------------|------------------------------|---------------|---------------|
|<span data-ttu-id="d4e27-406">以 .NET Framework 2.0 或 3.x 為目標之應用程式的資訊清單</span><span class="sxs-lookup"><span data-stu-id="d4e27-406">Manifest for applications targeting version 2.0 or 3.x of the .NET Framework</span></span>|<span data-ttu-id="d4e27-407">修改組件</span><span class="sxs-lookup"><span data-stu-id="d4e27-407">Modify an assembly</span></span>|<span data-ttu-id="d4e27-408">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-408">OK</span></span>|<span data-ttu-id="d4e27-409">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-409">OK</span></span>|
||<span data-ttu-id="d4e27-410">加入組件</span><span class="sxs-lookup"><span data-stu-id="d4e27-410">Add an assembly</span></span>|<span data-ttu-id="d4e27-411">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-411">OK</span></span>|<span data-ttu-id="d4e27-412">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-412">OK</span></span>|
||<span data-ttu-id="d4e27-413">移除組件</span><span class="sxs-lookup"><span data-stu-id="d4e27-413">Remove an assembly</span></span>|<span data-ttu-id="d4e27-414">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-414">OK</span></span>|<span data-ttu-id="d4e27-415">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-415">OK</span></span>|
|<span data-ttu-id="d4e27-416">以 .NET Framework 第 4 版為目標之應用程式的資訊清單</span><span class="sxs-lookup"><span data-stu-id="d4e27-416">Manifest for applications targeting version 4 of the .NET Framework</span></span>|<span data-ttu-id="d4e27-417">修改組件</span><span class="sxs-lookup"><span data-stu-id="d4e27-417">Modify an assembly</span></span>|<span data-ttu-id="d4e27-418">不支援</span><span class="sxs-lookup"><span data-stu-id="d4e27-418">Not supported</span></span>|<span data-ttu-id="d4e27-419">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-419">OK</span></span>|
||<span data-ttu-id="d4e27-420">加入組件</span><span class="sxs-lookup"><span data-stu-id="d4e27-420">Add an assembly</span></span>|<span data-ttu-id="d4e27-421">不支援</span><span class="sxs-lookup"><span data-stu-id="d4e27-421">Not supported</span></span>|<span data-ttu-id="d4e27-422">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-422">OK</span></span>|
||<span data-ttu-id="d4e27-423">移除組件</span><span class="sxs-lookup"><span data-stu-id="d4e27-423">Remove an assembly</span></span>|<span data-ttu-id="d4e27-424">不支援</span><span class="sxs-lookup"><span data-stu-id="d4e27-424">Not supported</span></span>|<span data-ttu-id="d4e27-425">確定</span><span class="sxs-lookup"><span data-stu-id="d4e27-425">OK</span></span>|

 <span data-ttu-id="d4e27-426">Mage.exe 會建立以 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]為目標的新資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-426">Mage.exe creates new manifests that target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)].</span></span> <span data-ttu-id="d4e27-427">以 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] 為目標的 ClickOnce 應用程式可以在 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] 和完整版的 .NET Framework 4 上執行。</span><span class="sxs-lookup"><span data-stu-id="d4e27-427">ClickOnce applications that target the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] can run on both the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] and the full version of the .NET Framework 4.</span></span> <span data-ttu-id="d4e27-428">如果您的應用程式以完整版的 .NET Framework 4 為目標，而且無法在 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] 上執行，請使用文字編輯器移除用戶端 `<framework>` 元素，並且重新簽署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-428">If your application targets the full version of the .NET Framework 4 and cannot run on the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)], remove the client `<framework>` element by using a text editor and re-sign the manifest.</span></span>

<span data-ttu-id="d4e27-429">下列是以 [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)] 為目標的範例 `<framework>` 元素：</span><span class="sxs-lookup"><span data-stu-id="d4e27-429">The following is a sample `<framework>` element that targets the [!INCLUDE[net_client_v40_long](../../../includes/net-client-v40-long-md.md)]:</span></span>

```xml
<framework targetVersion="4.0" profile="client" supportedRuntime="4.0.20506" />
```

## <a name="examples"></a><span data-ttu-id="d4e27-430">範例</span><span class="sxs-lookup"><span data-stu-id="d4e27-430">Examples</span></span>

<span data-ttu-id="d4e27-431">下列範例會開啟 Mage (*MageUI.exe*) 的使用者介面。</span><span class="sxs-lookup"><span data-stu-id="d4e27-431">The following example opens the user interface for Mage (*MageUI.exe*).</span></span>

```console
mage
```

<span data-ttu-id="d4e27-432">下列範例會建立預設部署資訊清單和應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-432">The following examples create a default deployment manifest and application manifest.</span></span> <span data-ttu-id="d4e27-433">這些檔案都在目前工作目錄中建立，名稱分別是 deploy.application 和 application.exe.manifest。</span><span class="sxs-lookup"><span data-stu-id="d4e27-433">These files are all created in the current working directory and are named deploy.application and application.exe.manifest, respectively.</span></span>

```console
mage -New Deployment
mage -New Application
```

<span data-ttu-id="d4e27-434">下列範例會建立應用程式資訊清單，其中將填入目前目錄中的所有組件和資源檔。</span><span class="sxs-lookup"><span data-stu-id="d4e27-434">The following example creates an application manifest populated with all of the assemblies and resource files from the current directory.</span></span>

```console
mage -New Application -FromDirectory . -Version 1.0.0.0
```

<span data-ttu-id="d4e27-435">下列範例延續前一個範例，其中會指定部署名稱和目標微處理器。</span><span class="sxs-lookup"><span data-stu-id="d4e27-435">The following example continues the previous example by specifying the deployment name and target microprocessor.</span></span> <span data-ttu-id="d4e27-436">此外也會指定 URL，讓 ClickOnce 從該位置檢查是否有更新。</span><span class="sxs-lookup"><span data-stu-id="d4e27-436">It also specifies a URL against which ClickOnce should check for updates.</span></span>

```console
mage -New Application -FromDirectory . -Name "Hello, World! Application" -Version 1.0.0.0 -Processor "x86" -ProviderUrl http://internalserver/HelloWorld/
```

<span data-ttu-id="d4e27-437">下列範例示範如何建立一組資訊清單，以部署裝載在 Internet Explorer 中的 WPF 應用程式。</span><span class="sxs-lookup"><span data-stu-id="d4e27-437">The following example demonstrates how to create a pair of manifests for deploying a WPF application that will be hosted in Internet Explorer.</span></span>

```console
mage -New Application -FromDirectory . -Version 1.0.0.0 -WPFBrowserApp true
mage -New Deployment -AppManifest 1.0.0.0\application.manifest -WPFBrowserApp true
```

<span data-ttu-id="d4e27-438">下列範例會建立應用程式資訊清單，其中將填入目前目錄中的所有組件和資源檔，並進行簽署。</span><span class="sxs-lookup"><span data-stu-id="d4e27-438">The following example creates an application manifest populated with all of the assemblies and resource files from the current directory and signs.</span></span>

```console
mage -New Application -FromDirectory . -Version 1.0.0.0 -KeyContainer keypair.snk -CryptoProvider "Microsoft Enhanced Cryptographic Provider v1.0"
```

<span data-ttu-id="d4e27-439">下列範例會以應用程式資訊清單的資訊來更新部署資訊清單，並針對應用程式資訊清單的位置設定程式碼基底。</span><span class="sxs-lookup"><span data-stu-id="d4e27-439">The following example updates a deployment manifest with information from an application manifest, and sets the code base for the location of the application manifest.</span></span>

```console
mage -Update HelloWorld.deploy -AppManifest 1.0.0.0\application.manifest -AppCodeBase http://internalserver/HelloWorld.deploy
```

<span data-ttu-id="d4e27-440">下列範例會編輯部署資訊清單，以強制更新使用者所安裝的版本。</span><span class="sxs-lookup"><span data-stu-id="d4e27-440">The following example edits the deployment manifest to force an update of the user's installed version.</span></span>

```console
mage -Update c:\HelloWorldDeployment\HelloWorld.deploy -MinVersion 1.1.0.0
```

<span data-ttu-id="d4e27-441">下列範例會告知部署資訊清單從另一個目錄擷取應用程式資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-441">The following example tells the deployment manifest to retrieve the application manifest from another directory.</span></span>

```console
mage -Update HelloWorld.deploy -AppCodeBase http://anotherserver/HelloWorld/1.1.0.0/
```

<span data-ttu-id="d4e27-442">下列範例會使用目前工作目錄中的數位憑證，替現有的部署資訊清單簽章。</span><span class="sxs-lookup"><span data-stu-id="d4e27-442">The following example signs an existing deployment manifest using a digital certificate in the current working directory.</span></span>

```console
mage -Sign deploy.application -CertFile cert.pfx -Password <passwd>
```

<span data-ttu-id="d4e27-443">下列範例會使用目前工作目錄中的數位憑證和私密金鑰，來簽署現有的部署資訊清單。</span><span class="sxs-lookup"><span data-stu-id="d4e27-443">The following example signs an existing deployment manifest using a digital certificate and private key in the current working directory.</span></span>

```console
mage -Sign deploy.application -CertFile cert.pfx -KeyContainer keyfile.snk -CryptoProvider "Microsoft Enghanced Cryptographic Provider v1.0"
```

## <a name="see-also"></a><span data-ttu-id="d4e27-444">另請參閱</span><span class="sxs-lookup"><span data-stu-id="d4e27-444">See also</span></span>

- [<span data-ttu-id="d4e27-445">ClickOnce 安全性和部署</span><span class="sxs-lookup"><span data-stu-id="d4e27-445">ClickOnce Security and Deployment</span></span>](/visualstudio/deployment/clickonce-security-and-deployment)
- [<span data-ttu-id="d4e27-446">逐步解說：手動部署 ClickOnce 應用程式</span><span class="sxs-lookup"><span data-stu-id="d4e27-446">Walkthrough: Manually Deploying a ClickOnce Application</span></span>](/visualstudio/deployment/walkthrough-manually-deploying-a-clickonce-application)
- [<span data-ttu-id="d4e27-447">受信任的應用程式部署概觀</span><span class="sxs-lookup"><span data-stu-id="d4e27-447">Trusted Application Deployment Overview</span></span>](/visualstudio/deployment/trusted-application-deployment-overview)
- [<span data-ttu-id="d4e27-448">MageUI.exe (圖形用戶端、資訊清單產生和編輯工具)</span><span class="sxs-lookup"><span data-stu-id="d4e27-448">MageUI.exe (Manifest Generation and Editing Tool, Graphical Client)</span></span>](../../../docs/framework/tools/mageui-exe-manifest-generation-and-editing-tool-graphical-client.md)
- [<span data-ttu-id="d4e27-449">命令提示字元</span><span class="sxs-lookup"><span data-stu-id="d4e27-449">Command Prompts</span></span>](../../../docs/framework/tools/developer-command-prompt-for-vs.md)