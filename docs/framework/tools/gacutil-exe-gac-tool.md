---
title: Gacutil.exe (全域組件快取工具)
ms.date: 03/30/2017
helpviewer_keywords:
- assemblies [.NET Framework], global assembly cache
- global assembly cache, viewing contents
- viewing assemblies in global assembly cache
- global assembly cache, manipulating contents
- GAC (global assembly cache), Gacutil.exe
- Gacutil.exe
- GAC (global assembly cache), viewing contents
- installing assemblies into global assembly cache
- removing assemblies from global assembly cache
- list of assemblies in global assembly cache
- cache [.NET Framework], global assembly cache
- GAC (global assembly cache), manipulating contents
- global assembly cache, Gacutil.exe
- Global Assembly Cache tool
ms.assetid: 4c7be9c8-72ae-481f-a01c-1a4716806e99
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 437d2d1bb026795dfa01a4c01ca12acf2b8f5792
ms.sourcegitcommit: 289e06e904b72f34ac717dbcc5074239b977e707
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/17/2019
ms.locfileid: "71044671"
---
# <a name="gacutilexe-global-assembly-cache-tool"></a><span data-ttu-id="1bdca-102">Gacutil.exe (全域組件快取工具)</span><span class="sxs-lookup"><span data-stu-id="1bdca-102">Gacutil.exe (Global Assembly Cache Tool)</span></span>

<span data-ttu-id="1bdca-103">全域組件快取工具可以讓您檢視和操作全域組件快取和下載快取的內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-103">The Global Assembly Cache tool allows you to view and manipulate the contents of the global assembly cache and download cache.</span></span>

<span data-ttu-id="1bdca-104">此工具會自動與 Visual Studio 一起安裝。</span><span class="sxs-lookup"><span data-stu-id="1bdca-104">This tool is automatically installed with Visual Studio.</span></span> <span data-ttu-id="1bdca-105">若要執行這項工具，請使用 [Visual Studio 開發人員命令提示字元] (或 Windows 7 中的 [Visual Studio 命令提示字元])。</span><span class="sxs-lookup"><span data-stu-id="1bdca-105">To run the tool, use the Developer Command Prompt for Visual Studio (or the Visual Studio Command Prompt in Windows 7).</span></span> <span data-ttu-id="1bdca-106">如需詳細資訊，請參閱[命令提示字元](developer-command-prompt-for-vs.md)。</span><span class="sxs-lookup"><span data-stu-id="1bdca-106">For more information, see [Command Prompts](developer-command-prompt-for-vs.md).</span></span>

<span data-ttu-id="1bdca-107">在命令提示字元下輸入下列命令：</span><span class="sxs-lookup"><span data-stu-id="1bdca-107">At the command prompt, type the following:</span></span>

## <a name="syntax"></a><span data-ttu-id="1bdca-108">語法</span><span class="sxs-lookup"><span data-stu-id="1bdca-108">Syntax</span></span>

```console
gacutil [options] [assemblyName | assemblyPath | assemblyListFile]
```

## <a name="parameters"></a><span data-ttu-id="1bdca-109">參數</span><span class="sxs-lookup"><span data-stu-id="1bdca-109">Parameters</span></span>

|<span data-ttu-id="1bdca-110">引數</span><span class="sxs-lookup"><span data-stu-id="1bdca-110">Argument</span></span>|<span data-ttu-id="1bdca-111">描述</span><span class="sxs-lookup"><span data-stu-id="1bdca-111">Description</span></span>|
|--------------|-----------------|
|<span data-ttu-id="1bdca-112">*assemblyName*</span><span class="sxs-lookup"><span data-stu-id="1bdca-112">*assemblyName*</span></span>|<span data-ttu-id="1bdca-113">組件的名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-113">The name of an assembly.</span></span> <span data-ttu-id="1bdca-114">您可以提供如 `myAssembly` 的部分指定組件名稱，或如 `myAssembly, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0038abc9deabfle5` 的完整指定組件名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-114">You can supply either a partially specified assembly name such as `myAssembly` or a fully specified assembly name such as `myAssembly, Version=2.0.0.0, Culture=neutral, PublicKeyToken=0038abc9deabfle5`.</span></span>|
|<span data-ttu-id="1bdca-115">*assemblyPath*</span><span class="sxs-lookup"><span data-stu-id="1bdca-115">*assemblyPath*</span></span>|<span data-ttu-id="1bdca-116">含有組件資訊清單 (Assembly Manifest) 的檔案名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-116">The name of a file that contains an assembly manifest.</span></span>|
|<span data-ttu-id="1bdca-117">*assemblyListFile*</span><span class="sxs-lookup"><span data-stu-id="1bdca-117">*assemblyListFile*</span></span>|<span data-ttu-id="1bdca-118">列出要安裝或解除安裝之組件的 ANSI 文字檔路徑。</span><span class="sxs-lookup"><span data-stu-id="1bdca-118">The path to an ANSI text file that lists assemblies to install or uninstall.</span></span> <span data-ttu-id="1bdca-119">若要使用文字檔安裝組件，請在檔案的個別行上指定每個組件的路徑。</span><span class="sxs-lookup"><span data-stu-id="1bdca-119">To use a text file to install assemblies, specify the path to each assembly on a separate line in the file.</span></span> <span data-ttu-id="1bdca-120">這個工具會解譯相對路徑 (相對於 *assemblyListFile* 的位置)。</span><span class="sxs-lookup"><span data-stu-id="1bdca-120">The tool interprets relative paths, relative to the location of the *assemblyListFile*.</span></span> <span data-ttu-id="1bdca-121">若要使用文字檔來解除安裝組件，請在檔案的個別行上為每個組件指定完整的組件名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-121">To use a text file to uninstall assemblies, specify the fully qualified assembly name for each assembly on a separate line in the file.</span></span> <span data-ttu-id="1bdca-122">請參閱本主題稍後的 *assemblyListFile* 內容範例。</span><span class="sxs-lookup"><span data-stu-id="1bdca-122">See the *assemblyListFile* contents examples later in this topic.</span></span>|

|<span data-ttu-id="1bdca-123">選項</span><span class="sxs-lookup"><span data-stu-id="1bdca-123">Option</span></span>|<span data-ttu-id="1bdca-124">描述</span><span class="sxs-lookup"><span data-stu-id="1bdca-124">Description</span></span>|
|------------|-----------------|
|<span data-ttu-id="1bdca-125">**/cdl**</span><span class="sxs-lookup"><span data-stu-id="1bdca-125">**/cdl**</span></span>|<span data-ttu-id="1bdca-126">刪除下載快取的內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-126">Deletes the contents of the download cache.</span></span>|
|<span data-ttu-id="1bdca-127">**/f**</span><span class="sxs-lookup"><span data-stu-id="1bdca-127">**/f**</span></span>|<span data-ttu-id="1bdca-128">請使用 **/** 或 **/il** 選項指定這個選項，以強制進行組件的重新安裝。</span><span class="sxs-lookup"><span data-stu-id="1bdca-128">Specify this option with the **/i** or **/il** options to force an assembly to reinstall.</span></span> <span data-ttu-id="1bdca-129">如果具有相同名稱的組件已存在於全域組件快取中，則這個工具會覆寫它。</span><span class="sxs-lookup"><span data-stu-id="1bdca-129">If an assembly with the same name already exists in the global assembly cache, the tool overwrites it.</span></span>|
|<span data-ttu-id="1bdca-130">**/h**[**elp**]</span><span class="sxs-lookup"><span data-stu-id="1bdca-130">**/h**[**elp**]</span></span>|<span data-ttu-id="1bdca-131">顯示工具的命令語法和選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-131">Displays command syntax and options for the tool.</span></span>|
|<span data-ttu-id="1bdca-132">**/i** *assemblyPath*</span><span class="sxs-lookup"><span data-stu-id="1bdca-132">**/i** *assemblyPath*</span></span>|<span data-ttu-id="1bdca-133">在全域組件快取中安裝單一組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-133">Installs an assembly into the global assembly cache.</span></span>|
|<span data-ttu-id="1bdca-134">**/if**  *assemblyPath*</span><span class="sxs-lookup"><span data-stu-id="1bdca-134">**/if**  *assemblyPath*</span></span>|<span data-ttu-id="1bdca-135">在全域組件快取中安裝單一組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-135">Installs an assembly into the global assembly cache.</span></span> <span data-ttu-id="1bdca-136">如果具有相同名稱的組件已存在於全域組件快取中，則這個工具會覆寫它。</span><span class="sxs-lookup"><span data-stu-id="1bdca-136">If an assembly with the same name already exists in the global assembly cache, the tool overwrites it.</span></span><br /><br /> <span data-ttu-id="1bdca-137">指定這個選項相當於同時指定 **/i** 和 **/f** 選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-137">Specifying this option is equivalent to specifying the **/i** and **/f** options together.</span></span>|
|<span data-ttu-id="1bdca-138">**/il** *assemblyListFile*</span><span class="sxs-lookup"><span data-stu-id="1bdca-138">**/il** *assemblyListFile*</span></span>|<span data-ttu-id="1bdca-139">將 *assemblyListFile* 中指定的一或多個組件安裝到全域組件快取中。</span><span class="sxs-lookup"><span data-stu-id="1bdca-139">Installs one or more assemblies specified in *assemblyListFile* into the global assembly cache.</span></span>|
|<span data-ttu-id="1bdca-140">**/ir**  *assemblyPath*</span><span class="sxs-lookup"><span data-stu-id="1bdca-140">**/ir**  *assemblyPath*</span></span><br /><br /> <span data-ttu-id="1bdca-141">*scheme*</span><span class="sxs-lookup"><span data-stu-id="1bdca-141">*scheme*</span></span><br /><br /> <span data-ttu-id="1bdca-142">*id*</span><span class="sxs-lookup"><span data-stu-id="1bdca-142">*id*</span></span><br /><br /> <span data-ttu-id="1bdca-143">*description*</span><span class="sxs-lookup"><span data-stu-id="1bdca-143">*description*</span></span>|<span data-ttu-id="1bdca-144">將組件安裝到全域組件快取中，並新增參考以計數組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-144">Installs an assembly into the global assembly cache and adds a reference to count the assembly.</span></span> <span data-ttu-id="1bdca-145">您必須使用這個選項指定 *assemblyPath*、*scheme*、*id* 和 *description* 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-145">You must specify the *assemblyPath*, *scheme*, *id*,and *description* parameters with this option.</span></span> <span data-ttu-id="1bdca-146">如需可以為這些參數指定之有效值的描述，請參閱 **/r** 選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-146">For a description of the valid values you can specify for these parameters, see the **/r** option.</span></span><br /><br /> <span data-ttu-id="1bdca-147">指定這個選項相當於同時指定 **/i** 和 **/r** 選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-147">Specifying this option is equivalent to specifying the **/i** and **/r** options together.</span></span>|
|<span data-ttu-id="1bdca-148">**/l** [*assemblyName*]</span><span class="sxs-lookup"><span data-stu-id="1bdca-148">**/l** [*assemblyName*]</span></span>|<span data-ttu-id="1bdca-149">列出全域組件快取的內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-149">Lists the contents of the global assembly cache.</span></span> <span data-ttu-id="1bdca-150">如果您指定 *assemblyName*參數，這個工具只會列出符合該名稱的組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-150">If you specify the *assemblyName* parameter, the tool lists only the assemblies matching that name.</span></span>|
|<span data-ttu-id="1bdca-151">**/ldl**</span><span class="sxs-lookup"><span data-stu-id="1bdca-151">**/ldl**</span></span>|<span data-ttu-id="1bdca-152">列出已下載之檔案快取的內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-152">Lists the contents of the downloaded files cache.</span></span>|
|<span data-ttu-id="1bdca-153">**/lr** [*assemblyName*]</span><span class="sxs-lookup"><span data-stu-id="1bdca-153">**/lr** [*assemblyName*]</span></span>|<span data-ttu-id="1bdca-154">列出所有組件及其對應的參考計數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-154">Lists all assemblies and their corresponding reference counts.</span></span> <span data-ttu-id="1bdca-155">如果您指定 *assemblyName* 參數，這個工具只會列出符合該名稱的組件及其對應的參考計數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-155">If you specify the *assemblyName* parameter, the tool lists only the assemblies matching that name and their corresponding reference counts.</span></span>|
|<span data-ttu-id="1bdca-156">**/nologo**</span><span class="sxs-lookup"><span data-stu-id="1bdca-156">**/nologo**</span></span>|<span data-ttu-id="1bdca-157">隱藏 Microsoft 程式啟始資訊顯示。</span><span class="sxs-lookup"><span data-stu-id="1bdca-157">Suppresses the Microsoft startup banner display.</span></span>|
|<span data-ttu-id="1bdca-158">**/r** [*assemblyName &#124; assemblyPath*]</span><span class="sxs-lookup"><span data-stu-id="1bdca-158">**/r** [*assemblyName &#124; assemblyPath*]</span></span><br /><br /> <span data-ttu-id="1bdca-159">*scheme*</span><span class="sxs-lookup"><span data-stu-id="1bdca-159">*scheme*</span></span><br /><br /> <span data-ttu-id="1bdca-160">*id*</span><span class="sxs-lookup"><span data-stu-id="1bdca-160">*id*</span></span><br /><br /> <span data-ttu-id="1bdca-161">*description*</span><span class="sxs-lookup"><span data-stu-id="1bdca-161">*description*</span></span>|<span data-ttu-id="1bdca-162">指定要安裝或解除安裝之組件的追蹤參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-162">Specifies a traced reference to an assembly or assemblies to install or uninstall.</span></span> <span data-ttu-id="1bdca-163">請使用 **/i**、 **/il**、 **/u** 或 **/ul** 選項指定這個選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-163">Specify this option with the **/i**, **/il**, **/u**, or **/ul** options.</span></span><br /><br /> <span data-ttu-id="1bdca-164">若要安裝組件，請使用這個選項指定 *assemblyPath*、*scheme*、*id* 及 *description* 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-164">To install an assembly, specify the *assemblyPath*, *scheme*, *id*,and *description* parameters with this option.</span></span> <span data-ttu-id="1bdca-165">若要解除安裝組件，請指定 *assemblyName*、*scheme*、*id* 和 *description* 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-165">To uninstall an assembly, specify the *assemblyName*, *scheme*, *id*,and *description* parameters.</span></span><br /><br /> <span data-ttu-id="1bdca-166">若要移除組件的參考，您必須在指定安裝組件時使用與 */i* 和 */r* (或 */ir*) 選項指定的相同 **scheme**、**id** 和 **description** 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-166">To remove a reference to an assembly, you must specify the same *scheme*, *id*, and *description* parameters that were specified with the **/i** and **/r** (or **/ir**) options when the assembly was installed.</span></span> <span data-ttu-id="1bdca-167">如果您正在解除安裝組件，並且這個組件是最後要移除的參考，且 Windows Installer 沒有這個組件的未解決參考，這個工具也會從全域組件快取中移除這個組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-167">If you are uninstalling an assembly, the tool also removes the assembly from the global assembly cache if it is the last reference to remove and if Windows Installer has no outstanding references to the assembly.</span></span><br /><br /> <span data-ttu-id="1bdca-168">*scheme* 參數指定安裝配置的類型。</span><span class="sxs-lookup"><span data-stu-id="1bdca-168">The *scheme* parameter specifies the type of installation scheme.</span></span> <span data-ttu-id="1bdca-169">您可以指定下列其中一個值：</span><span class="sxs-lookup"><span data-stu-id="1bdca-169">You can specify one of the following values:</span></span><br /><br /> <span data-ttu-id="1bdca-170">- UNINSTALL_KEY：如果安裝程式將應用程式新增至 Microsoft Windows 中的 [新增/移除程式]，則指定這個值。</span><span class="sxs-lookup"><span data-stu-id="1bdca-170">- UNINSTALL_KEY: Specify this value if the installer adds the application to Add/Remove Programs in Microsoft Windows.</span></span> <span data-ttu-id="1bdca-171">應用程式會將一個登錄機碼加入 HKLM\Software\Microsoft\Windows\CurrentVersion，以將其本身加入至 [新增或移除程式] 中。</span><span class="sxs-lookup"><span data-stu-id="1bdca-171">Applications add themselves to Add/Remove Programs by adding a registry key to HKLM\Software\Microsoft\Windows\CurrentVersion.</span></span><br /><span data-ttu-id="1bdca-172">- FILEPATH：如果安裝程式沒有將應用程式新增至 [新增/移除程式] 中，則指定這個值。</span><span class="sxs-lookup"><span data-stu-id="1bdca-172">- FILEPATH: Specify this value if the installer does not add the application to Add/Remove Programs.</span></span><br /><span data-ttu-id="1bdca-173">- OPAQUE：如果提供之登錄機碼或檔案路徑不適用於您的安裝情節，則指定這個值。</span><span class="sxs-lookup"><span data-stu-id="1bdca-173">- OPAQUE: Specify this value if supplying a registry key or file path does not apply to your installation scenario.</span></span> <span data-ttu-id="1bdca-174">這個值允許您對 *id* 參數指定自訂資訊。</span><span class="sxs-lookup"><span data-stu-id="1bdca-174">This value allows you to specify custom information for the *id* parameter.</span></span><br /><br /> <span data-ttu-id="1bdca-175">要對 *id* 參數指定的值取決於對 *scheme* 參數指定的值：</span><span class="sxs-lookup"><span data-stu-id="1bdca-175">The value to specify for the *id* parameter depends on the value specified for the *scheme* parameter:</span></span><br /><br /> <span data-ttu-id="1bdca-176">- 如果您為 *scheme* 參數指定 UNINSTALL_KEY，請在 HKLM\Software\Microsoft\Windows\CurrentVersion 登錄機碼中指定應用程式集的名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-176">- If you specify UNINSTALL_KEY for the *scheme* parameter, specify the name of the application set in the HKLM\Software\Microsoft\Windows\CurrentVersion registry key.</span></span> <span data-ttu-id="1bdca-177">例如，如果登錄機碼是 HKLM\Software\Microsoft\Windows\CurrentVersion\MyApp，請對 *id* 參數指定 MyApp。</span><span class="sxs-lookup"><span data-stu-id="1bdca-177">For example, if the registry key is HKLM\Software\Microsoft\Windows\CurrentVersion\MyApp, specify MyApp for the *id* parameter.</span></span><br /><span data-ttu-id="1bdca-178">- 如果您為 *scheme* 參數指定 FILEPATH，請將安裝組件之可執行檔的完整路徑指定為 *id* 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-178">- If you specify FILEPATH for the *scheme* parameter, specify the full path to the executable file that installs the assembly as the *id* parameter.</span></span><br /><span data-ttu-id="1bdca-179">- 如果您為 *scheme* 參數指定 OPAQUE，則可以提供任何資料片段作為 *id* 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-179">- If you specify OPAQUE for the *scheme* parameter, you can supply any piece of data as the *id* parameter.</span></span> <span data-ttu-id="1bdca-180">您所指定的資料必須包含在引號 ("") 中。</span><span class="sxs-lookup"><span data-stu-id="1bdca-180">The data you specify must be enclosed in quotation marks ("").</span></span><br /><br /> <span data-ttu-id="1bdca-181">*description* 參數允許您指定與要安裝之應用程式有關的描述文字。</span><span class="sxs-lookup"><span data-stu-id="1bdca-181">The *description* parameter allows you to specify descriptive text about the application to install.</span></span> <span data-ttu-id="1bdca-182">這項資訊會在列舉參考時顯示。</span><span class="sxs-lookup"><span data-stu-id="1bdca-182">This information is displayed when references are enumerated.</span></span>|
|<span data-ttu-id="1bdca-183">**/silent**</span><span class="sxs-lookup"><span data-stu-id="1bdca-183">**/silent**</span></span>|<span data-ttu-id="1bdca-184">隱藏所有輸出的顯示。</span><span class="sxs-lookup"><span data-stu-id="1bdca-184">Suppresses the display of all output.</span></span>|
|<span data-ttu-id="1bdca-185">**/u**  *assemblyName*</span><span class="sxs-lookup"><span data-stu-id="1bdca-185">**/u**  *assemblyName*</span></span>|<span data-ttu-id="1bdca-186">解除安裝全域組件快取中的單一組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-186">Uninstalls an assembly from the global assembly cache.</span></span>|
|<span data-ttu-id="1bdca-187">**/uf**  *assemblyName*</span><span class="sxs-lookup"><span data-stu-id="1bdca-187">**/uf**  *assemblyName*</span></span>|<span data-ttu-id="1bdca-188">移除組件的所有參考，強制解除安裝指定的組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-188">Forces a specified assembly to uninstall by removing all references to the assembly.</span></span><br /><br /> <span data-ttu-id="1bdca-189">指定這個選項相當於同時指定 **/u** 和 **/f** 選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-189">Specifying this option is equivalent to specifying the **/u** and **/f** options together.</span></span> <span data-ttu-id="1bdca-190">**注意：** 您無法使用這個選項移除使用 Microsoft Windows Installer 所安裝的組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-190">**Note:**  You cannot use this option to remove an assembly that was installed using Microsoft Windows Installer.</span></span> <span data-ttu-id="1bdca-191">如果您嘗試這項作業，工具就會顯示錯誤訊息。</span><span class="sxs-lookup"><span data-stu-id="1bdca-191">If you attempt this operation, the tool displays an error message.</span></span>|
|<span data-ttu-id="1bdca-192">**/ul** *assemblyListFile*</span><span class="sxs-lookup"><span data-stu-id="1bdca-192">**/ul** *assemblyListFile*</span></span>|<span data-ttu-id="1bdca-193">從全域組件快取中解除安裝 *assemblyListFile* 中指定的一或多個組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-193">Uninstalls one or more assemblies specified in *assemblyListFile* from the global assembly cache.</span></span>|
|<span data-ttu-id="1bdca-194">**/u**[**ngen**] *assemblyName*</span><span class="sxs-lookup"><span data-stu-id="1bdca-194">**/u**[**ngen**] *assemblyName*</span></span>|<span data-ttu-id="1bdca-195">從全域組件快取解除安裝指定的組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-195">Uninstalls a specified assembly from the global assembly cache.</span></span> <span data-ttu-id="1bdca-196">如果指定的組件具有現存的參考計數，工具就會顯示參考計數，並且不會從全域組件快取中移除組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-196">If the specified assembly has existing reference counts, the tool displays the reference counts and does not remove the assembly from the global assembly cache.</span></span> <span data-ttu-id="1bdca-197">**注意：** 在 .NET Framework 2.0 版中不支援 `/ungen`。</span><span class="sxs-lookup"><span data-stu-id="1bdca-197">**Note:**  In the .NET Framework version 2.0, `/ungen` is not supported.</span></span> <span data-ttu-id="1bdca-198">請改用 [Ngen.exe (原生映像產生器)](ngen-exe-native-image-generator.md) 的 `uninstall` 命令。</span><span class="sxs-lookup"><span data-stu-id="1bdca-198">Instead, use the `uninstall` command of the [Ngen.exe (Native Image Generator)](ngen-exe-native-image-generator.md).</span></span> <br /><br /> <span data-ttu-id="1bdca-199">在 .NET Framework 1.0 和 1.1 版中，指定 **/ungen** 會使 Gacutil.exe 移除原生映像快取中的組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-199">In the .NET Framework versions 1.0 and 1.1, specifying **/ungen** causes Gacutil.exe to remove the assembly from the native image cache.</span></span> <span data-ttu-id="1bdca-200">這個快取儲存了使用 [Ngen.exe (原生映像產生器)](ngen-exe-native-image-generator.md) 建立之組件的原生映像。</span><span class="sxs-lookup"><span data-stu-id="1bdca-200">This cache stores the native images for assemblies that have been created using the [Ngen.exe (Native Image Generator)](ngen-exe-native-image-generator.md).</span></span>|
|<span data-ttu-id="1bdca-201">**/ur**  *assemblyName*</span><span class="sxs-lookup"><span data-stu-id="1bdca-201">**/ur**  *assemblyName*</span></span><br /><br /> <span data-ttu-id="1bdca-202">*scheme*</span><span class="sxs-lookup"><span data-stu-id="1bdca-202">*scheme*</span></span><br /><br /> <span data-ttu-id="1bdca-203">*id*</span><span class="sxs-lookup"><span data-stu-id="1bdca-203">*id*</span></span><br /><br /> <span data-ttu-id="1bdca-204">*description*</span><span class="sxs-lookup"><span data-stu-id="1bdca-204">*description*</span></span>|<span data-ttu-id="1bdca-205">從全域組件快取解除安裝指定之組件的參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-205">Uninstalls a reference to a specified assembly from the global assembly cache.</span></span> <span data-ttu-id="1bdca-206">若要移除組件的參考，您必須在指定安裝組件時使用與 */i* 和 */r* (或 */ir*) 選項指定的相同 **scheme**、**id** 和 **description** 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-206">To remove a reference to an assembly, you must specify the same *scheme*, *id*, and *description* parameters that were specified with the **/i** and **/r** (or **/ir)** options when the assembly was installed.</span></span> <span data-ttu-id="1bdca-207">如需可以為這些參數指定之有效值的描述，請參閱 **/r** 選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-207">For a description of the valid values you can specify for these parameters, see the **/r** option.</span></span><br /><br /> <span data-ttu-id="1bdca-208">指定這個選項相當於同時指定 **/u** 和 **/r** 選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-208">Specifying this option is equivalent to specifying the **/u** and **/r** options together.</span></span>|
|<span data-ttu-id="1bdca-209">**/?**</span><span class="sxs-lookup"><span data-stu-id="1bdca-209">**/?**</span></span>|<span data-ttu-id="1bdca-210">顯示工具的命令語法和選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-210">Displays command syntax and options for the tool.</span></span>|

## <a name="remarks"></a><span data-ttu-id="1bdca-211">備註</span><span class="sxs-lookup"><span data-stu-id="1bdca-211">Remarks</span></span>

> [!NOTE]
> <span data-ttu-id="1bdca-212">您必須擁有系統管理員權限才能使用 Gacutil.exe。</span><span class="sxs-lookup"><span data-stu-id="1bdca-212">You must have administrator privileges to use Gacutil.exe.</span></span>

<span data-ttu-id="1bdca-213">具體來說，Gacutil.exe 可以讓您將組件安裝到快取、從快取中將它們移除，以及列出快取的內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-213">Specifically, Gacutil.exe allows you to install assemblies into the cache, remove them from the cache, and list the contents of the cache.</span></span>

<span data-ttu-id="1bdca-214">Gacutil.exe 提供支援參考計數的選項，與 Windows Installer 所支援的參考計數配置相似。</span><span class="sxs-lookup"><span data-stu-id="1bdca-214">Gacutil.exe provides options that support reference counting similar to the reference counting scheme supported by Windows Installer.</span></span> <span data-ttu-id="1bdca-215">您可以使用 Gacutil.exe 安裝兩個安裝相同組件的應用程式﹔這個工具會追蹤組件的參考數量。</span><span class="sxs-lookup"><span data-stu-id="1bdca-215">You can use Gacutil.exe to install two applications that install the same assembly; the tool keeps track of the number of references to the assembly.</span></span> <span data-ttu-id="1bdca-216">因此，組件會保留在電腦上，直到兩個應用程式都解除安裝為止。</span><span class="sxs-lookup"><span data-stu-id="1bdca-216">As a result, the assembly will remain on the computer until both applications are uninstalled.</span></span> <span data-ttu-id="1bdca-217">如果您使用 Gacutil.exe 進行實際的產品安裝，請使用支援參考計數的選項。</span><span class="sxs-lookup"><span data-stu-id="1bdca-217">If you are using Gacutil.exe for actual product installations, use the options that support reference counting.</span></span> <span data-ttu-id="1bdca-218">請同時使用 **/i** 和 **/r** 選項安裝組件，並加入要對組件計數的參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-218">Use the **/i** and **/r** options together to install an assembly and add a reference to count it.</span></span> <span data-ttu-id="1bdca-219">請同時使用 **/u** 和 **/r** 選項移除組件的參考計數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-219">Use the **/u** and **/r** options together to remove a reference count for an assembly.</span></span> <span data-ttu-id="1bdca-220">請注意，單獨使用 **/i** 和 **/u** 選項並不支援參考計數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-220">Be aware that using the **/i** and **/u** options alone does not support reference counting.</span></span> <span data-ttu-id="1bdca-221">這些選項適用於產品開發期間，但不適用於實際產品安裝。</span><span class="sxs-lookup"><span data-stu-id="1bdca-221">These options are appropriate for use during product development but not for actual product installations.</span></span>

<span data-ttu-id="1bdca-222">請使用 **/il** 或 **/ul** 選項，安裝或解除安裝存放在 ANSI 文字檔中的組件清單。</span><span class="sxs-lookup"><span data-stu-id="1bdca-222">Use the **/il** or **/ul** options to install or uninstall a list of assemblies stored in an ANSI text file.</span></span> <span data-ttu-id="1bdca-223">文字檔的內容必須被正確格式化。</span><span class="sxs-lookup"><span data-stu-id="1bdca-223">The contents of the text file must be formatted correctly.</span></span> <span data-ttu-id="1bdca-224">若要使用文字檔安裝組件，請在檔案的個別行上指定每個組件的路徑。</span><span class="sxs-lookup"><span data-stu-id="1bdca-224">To use a text file to install assemblies, specify the path to each assembly on a separate line in the file.</span></span> <span data-ttu-id="1bdca-225">下列範例說明包含要安裝之組件的檔案內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-225">The following example demonstrates the contents of a file containing assemblies to install.</span></span>

```text
myAssembly1.dll
myAssembly2.dll
myAssembly3.dll
```

<span data-ttu-id="1bdca-226">若要使用文字檔來解除安裝組件，請在檔案的個別行上為每個組件指定完整的組件名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-226">To use a text file to uninstall assemblies, specify the fully qualified assembly name for each assembly on a separate line in the file.</span></span> <span data-ttu-id="1bdca-227">下列範例說明包含要解除安裝之組件的檔案內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-227">The following example demonstrates the contents of a file containing assemblies to uninstall.</span></span>

```text
myAssembly1,Version=1.1.0.0,Culture=en,PublicKeyToken=874e23ab874e23ab
myAssembly2,Version=1.1.0.0,Culture=en,PublicKeyToken=874e23ab874e23ab
myAssembly3,Version=1.1.0.0,Culture=en,PublicKeyToken=874e23ab874e23ab
```

> [!NOTE]
> <span data-ttu-id="1bdca-228">嘗試安裝檔案名稱超過 79 到 91 個字元 (不含副檔名) 的組件，可能導致下列錯誤：</span><span class="sxs-lookup"><span data-stu-id="1bdca-228">Attempting to install an assembly with a filename longer than between 79 and 91 characters (excluding the file extension) can result in the following error:</span></span>
>
> ```output
> Failure adding assembly to the cache:   The file name is too long.
> ```
>
> <span data-ttu-id="1bdca-229">這是因為 Gacutil.exe 在內部建構的路徑超過 MAX_PATH 個字元，其中包含下列元素：</span><span class="sxs-lookup"><span data-stu-id="1bdca-229">This is because internally Gacutil.exe constructs a path of up to MAX_PATH characters that consists of the following elements:</span></span>
>
> - <span data-ttu-id="1bdca-230">GAC 根目錄 - 34 個字元 (即 `C:\Windows\Microsoft.NET\assembly\`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-230">GAC Root - 34 chars (ie. `C:\Windows\Microsoft.NET\assembly\`)</span></span>
> - <span data-ttu-id="1bdca-231">架構 - 7 或 9 個字元 (即 `GAC_32\`、`GAC_64\`、`GAC_MSIL`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-231">Architecture - 7 or 9 chars (ie. `GAC_32\`, `GAC_64\`, `GAC_MSIL`)</span></span>
> - <span data-ttu-id="1bdca-232">AssemblyName - 最多 91 個字元，根據其他元素的大小而定 (例如</span><span class="sxs-lookup"><span data-stu-id="1bdca-232">AssemblyName - Up to 91 chars, depending on the size of the other elements (eg.</span></span> <span data-ttu-id="1bdca-233">`System.Xml.Linq\`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-233">`System.Xml.Linq\`)</span></span>
> - <span data-ttu-id="1bdca-234">AssemblyInfo - 31 到 48 個字元或以上，其中包含下列元素：</span><span class="sxs-lookup"><span data-stu-id="1bdca-234">AssemblyInfo - 31 to 48 chars or more consisting of:</span></span>
>   - <span data-ttu-id="1bdca-235">Framework - 5 個字元 (例如</span><span class="sxs-lookup"><span data-stu-id="1bdca-235">Framework - 5 chars (eg.</span></span> <span data-ttu-id="1bdca-236">`v4.0_`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-236">`v4.0_`)</span></span>
>   - <span data-ttu-id="1bdca-237">AssemblyVersion - 8 到 24 個字元 (例如</span><span class="sxs-lookup"><span data-stu-id="1bdca-237">AssemblyVersion - 8 to 24 chars (eg.</span></span> <span data-ttu-id="1bdca-238">`9.0.1000.0_`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-238">`9.0.1000.0_`)</span></span>
>   - <span data-ttu-id="1bdca-239">AssemblyLanguage - 1 到 8 個字元 (例如</span><span class="sxs-lookup"><span data-stu-id="1bdca-239">AssemblyLanguage - 1 to 8 chars (eg.</span></span> <span data-ttu-id="1bdca-240">`de_`、`sr-Cyrl_`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-240">`de_`, `sr-Cyrl_`)</span></span>
>   - <span data-ttu-id="1bdca-241">PublicKey - 17 個字元 (例如</span><span class="sxs-lookup"><span data-stu-id="1bdca-241">PublicKey - 17 chars (eg.</span></span> <span data-ttu-id="1bdca-242">`31bf3856ad364e35\`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-242">`31bf3856ad364e35\`)</span></span>
> - <span data-ttu-id="1bdca-243">DllFileName - 最多 91 + 4 個字元 (即 `<AssemblyName>.dll`)</span><span class="sxs-lookup"><span data-stu-id="1bdca-243">DllFileName - Up to 91 + 4 chars (ie. `<AssemblyName>.dll`)</span></span>

## <a name="examples"></a><span data-ttu-id="1bdca-244">範例</span><span class="sxs-lookup"><span data-stu-id="1bdca-244">Examples</span></span>

<span data-ttu-id="1bdca-245">下列命令會將 `mydll.dll` 組件安裝到全域組件快取中。</span><span class="sxs-lookup"><span data-stu-id="1bdca-245">The following command installs the assembly `mydll.dll` into the global assembly cache.</span></span>

```console
gacutil /i mydll.dll
```

<span data-ttu-id="1bdca-246">只要組件的參考計數不存在，下列命令便會從全域組件快取中移除 `hello` 組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-246">The following command removes the assembly `hello` from the global assembly cache as long as no reference counts exist for the assembly.</span></span>

```console
gacutil /u hello
```

<span data-ttu-id="1bdca-247">請注意，上述命令可能會從組件快取中移除一個以上的組件，因為沒有完整地指定組件名稱。</span><span class="sxs-lookup"><span data-stu-id="1bdca-247">Note that the previous command might remove more than one assembly from the assembly cache because the assembly name is not fully specified.</span></span> <span data-ttu-id="1bdca-248">例如，如果快取中同時安裝了 `hello` 的 1.0.0.0 和 3.2.2.1 版本，`gacutil /u hello` 命令會將這兩個組件同時移除。</span><span class="sxs-lookup"><span data-stu-id="1bdca-248">For example, if both version 1.0.0.0 and 3.2.2.1 of `hello` are installed in the cache, the command `gacutil /u hello` removes both of the assemblies.</span></span>

<span data-ttu-id="1bdca-249">為避免移除一個以上的組件，請使用下列範例。</span><span class="sxs-lookup"><span data-stu-id="1bdca-249">Use the following example to avoid removing more than one assembly.</span></span> <span data-ttu-id="1bdca-250">這個命令只會移除符合完整指定版本號碼、文化特性 (Culture) 和公開金鑰的 `hello` 組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-250">This command removes only the `hello` assembly that matches the fully specified version number, culture, and public key.</span></span>

```console
gacutil /u hello, Version=1.0.0.1, Culture="de",PublicKeyToken=45e343aae32233ca
```

<span data-ttu-id="1bdca-251">下列命令會將 `assemblyList.txt` 檔案中所指定的組件安裝到全域組件快取中。</span><span class="sxs-lookup"><span data-stu-id="1bdca-251">The following command installs the assemblies specified in the file `assemblyList.txt` into the global assembly cache.</span></span>

```console
gacutil /il assemblyList.txt
```

<span data-ttu-id="1bdca-252">下列命令會從全域組件快取中移除 `assemblyList.txt` 檔案中指定的組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-252">The following command removes the assemblies specified in the file `assemblyList.txt` from the global assembly cache.</span></span>

```console
gacutil /ul assemblyList.txt
```

<span data-ttu-id="1bdca-253">下列命令會將 `myDll.dll` 安裝到全域組件快取中，並加入要計數的參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-253">The following command installs `myDll.dll` into the global assembly cache and adds a reference to count it.</span></span> <span data-ttu-id="1bdca-254">`myDll.dll` 組件是由 `MyApp` 應用程式使用。</span><span class="sxs-lookup"><span data-stu-id="1bdca-254">The assembly `myDll.dll` is used by the application `MyApp`.</span></span> <span data-ttu-id="1bdca-255">`UNINSTALL_KEY MyApp` 參數指定將 `MyApp` 加入至 Windows 中 [新增或移除程式] 的登錄機碼。</span><span class="sxs-lookup"><span data-stu-id="1bdca-255">The `UNINSTALL_KEY MyApp` parameter specifies the registry key that adds `MyApp` to Add/Remove Programs in Windows.</span></span> <span data-ttu-id="1bdca-256">說明參數指定為 `My Application Description`。</span><span class="sxs-lookup"><span data-stu-id="1bdca-256">The description parameter is specified as `My Application Description`.</span></span>

```console
gacutil /i /r myDll.dll UNINSTALL_KEY MyApp "My Application Description"
```

<span data-ttu-id="1bdca-257">下列命令會將 `myDll.dll` 安裝到全域組件快取中，並加入要計數的參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-257">The following command installs `myDll.dll` into the global assembly cache and adds a reference to count it.</span></span> <span data-ttu-id="1bdca-258">配置參數 `FILEPATH` 和 id 參數 `c:\applications\myApp\myApp.exe`，指定安裝 `myDll.dll.` 之應用程式的路徑。說明參數指定為 `MyApp`。</span><span class="sxs-lookup"><span data-stu-id="1bdca-258">The scheme parameter, `FILEPATH`, and the id parameter, `c:\applications\myApp\myApp.exe`, specify the path to the application that is installing `myDll.dll.` The description parameter is specified as `MyApp`.</span></span>

```console
gacutil /i /r myDll.dll FILEPATH c:\applications\myApp\myApp.exe MyApp
```

<span data-ttu-id="1bdca-259">下列命令會將 `myDll.dll` 安裝到全域組件快取中，並加入要計數的參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-259">The following command installs `myDll.dll` into the global assembly cache and adds a reference to count it.</span></span> <span data-ttu-id="1bdca-260">配置參數 `OPAQUE` 允許您自訂 id 和 description 參數。</span><span class="sxs-lookup"><span data-stu-id="1bdca-260">The scheme parameter, `OPAQUE`, allows you to customize the id and description parameters.</span></span>

```console
gacutil /i /r mydll.dll OPAQUE "Insert custom application details here" "Insert Custom description information here"
```

<span data-ttu-id="1bdca-261">下列命令會使用 `myDll.dll` 應用程式移除 `myApp` 的參考。</span><span class="sxs-lookup"><span data-stu-id="1bdca-261">The following command removes the reference to `myDll.dll` by the application `myApp`.</span></span> <span data-ttu-id="1bdca-262">如果這是組件的最後一個參考，它也會從全域組件快取中移除這個組件。</span><span class="sxs-lookup"><span data-stu-id="1bdca-262">If this is the last reference to the assembly, it will also remove the assembly from the global assembly cache.</span></span>

```console
gacutil /u /r myDll.dll FILEPATH c:\applications\myApp\myApp.exe MyApp
```

<span data-ttu-id="1bdca-263">下列命令會列出全域組件快取的內容。</span><span class="sxs-lookup"><span data-stu-id="1bdca-263">The following command lists the contents of the global assembly cache.</span></span>

```console
gacutil /l
```

## <a name="see-also"></a><span data-ttu-id="1bdca-264">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1bdca-264">See also</span></span>

- [<span data-ttu-id="1bdca-265">工具</span><span class="sxs-lookup"><span data-stu-id="1bdca-265">Tools</span></span>](index.md)
- [<span data-ttu-id="1bdca-266">全域組件快取</span><span class="sxs-lookup"><span data-stu-id="1bdca-266">Global Assembly Cache</span></span>](../app-domains/gac.md)
- [<span data-ttu-id="1bdca-267">Regasm.exe (組件登錄工具)</span><span class="sxs-lookup"><span data-stu-id="1bdca-267">Regasm.exe (Assembly Registration Tool)</span></span>](regasm-exe-assembly-registration-tool.md)
- [<span data-ttu-id="1bdca-268">命令提示字元</span><span class="sxs-lookup"><span data-stu-id="1bdca-268">Command Prompts</span></span>](developer-command-prompt-for-vs.md)
