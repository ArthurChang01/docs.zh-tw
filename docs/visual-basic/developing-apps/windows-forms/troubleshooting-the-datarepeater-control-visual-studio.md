---
title: 疑難排解 DataRepeater 控制項 (Visual Studio)
ms.date: 07/20/2015
dev_langs:
- csharp
- vb
helpviewer_keywords:
- DataRepeater, troubleshooting
ms.assetid: c0ab9469-eced-4f52-aa18-4bd8dd4f1a9a
ms.openlocfilehash: 092bbe89bb73a40dee7161f014d40a581b0ddc06
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 05/04/2018
ms.locfileid: "33591894"
---
# <a name="troubleshooting-the-datarepeater-control-visual-studio"></a><span data-ttu-id="1c9d2-102">疑難排解 DataRepeater 控制項 (Visual Studio)</span><span class="sxs-lookup"><span data-stu-id="1c9d2-102">Troubleshooting the DataRepeater Control (Visual Studio)</span></span>
<span data-ttu-id="1c9d2-103">本主題列出常見的問題，當您正在使用時，可能會發生<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-103">This topic lists common issues that may occur when you are working with the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control.</span></span>  
  
## <a name="datarepeater-keyboard-and-mouse-events-are-not-raised"></a><span data-ttu-id="1c9d2-104">不引發 DataRepeater 鍵盤和滑鼠事件</span><span class="sxs-lookup"><span data-stu-id="1c9d2-104">DataRepeater Keyboard and Mouse Events Are Not Raised</span></span>  
 <span data-ttu-id="1c9d2-105">某些<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項事件，例如鍵盤和滑鼠事件，則不會引發。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-105">Some <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control events, such as keyboard and mouse events, are not raised.</span></span> <span data-ttu-id="1c9d2-106">這是依設計的結果。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-106">This is by design.</span></span> <span data-ttu-id="1c9d2-107"><xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項本身是容器<xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem>物件，並在執行階段無法存取。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-107">The <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control itself is a container for <xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem> objects and cannot be accessed at run time.</span></span> <span data-ttu-id="1c9d2-108"><xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem>不會在設計階段中公開事件。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-108">The <xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem> does not expose events at design time.</span></span> <span data-ttu-id="1c9d2-109">因此，按一下項目或項目有焦點時按下按鍵不會引發事件。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-109">Therefore, clicking an item or pressing a key when the item has focus does not raise an event.</span></span>  
  
 <span data-ttu-id="1c9d2-110">這個例外狀況時，<xref:System.Windows.Forms.Control.Padding%2A>屬性會設定為大一點的值，以公開邊緣<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-110">The exception to this is when the <xref:System.Windows.Forms.Control.Padding%2A> property is set to a large enough value to expose the edges of the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control.</span></span> <span data-ttu-id="1c9d2-111">在此情況下，按一下公開的邊界會引發滑鼠事件。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-111">In this case, clicking in the exposed margin will raise mouse events.</span></span>  
  
 <span data-ttu-id="1c9d2-112">若要解決此問題，請加入<xref:System.Windows.Forms.Panel>控制權傳輸至<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemTemplate%2A>區段<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項，然後再加入剩餘的控制項加入<xref:System.Windows.Forms.Panel>。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-112">To resolve this issue, add a <xref:System.Windows.Forms.Panel> control to the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemTemplate%2A> section of the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control, and then add the rest of the controls to the <xref:System.Windows.Forms.Panel>.</span></span> <span data-ttu-id="1c9d2-113">然後，您可以加入程式碼以<xref:System.Windows.Forms.Panel>控制項的鍵盤和滑鼠事件的事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-113">You can then add code to the <xref:System.Windows.Forms.Panel> control's event handlers for keyboard and mouse events.</span></span>  
  
## <a name="the-datarepeater-is-partially-hidden-behind-the-binding-navigator"></a><span data-ttu-id="1c9d2-114">DataRepeater 部分藏繫結導覽</span><span class="sxs-lookup"><span data-stu-id="1c9d2-114">The DataRepeater Is Partially Hidden Behind the Binding Navigator</span></span>  
 <span data-ttu-id="1c9d2-115">當您第一次加入<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項加入表單，並將資料繫結控制項，從**資料來源**視窗中，<xref:System.Windows.Forms.BindingNavigator>控制項可能會出現在最上層的<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-115">When you first add a <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control to a form and then add data-bound controls from the **Data Sources** window, the <xref:System.Windows.Forms.BindingNavigator> control may appear on top of the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control.</span></span> <span data-ttu-id="1c9d2-116">這是已知的限制**資料來源**視窗，與保持一致的行為的其他控制項，例如<xref:System.Windows.Forms.DataGridView>控制項。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-116">This is a known limitation of the **Data Sources** window and is consistent with the behavior of other controls, such as the <xref:System.Windows.Forms.DataGridView> control.</span></span>  
  
 <span data-ttu-id="1c9d2-117">您可以移動任一<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>低於<xref:System.Windows.Forms.BindingNavigator>控制在設計階段，或加入程式碼中的下列類似一個框住`Load`事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-117">You can either move the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> lower than the <xref:System.Windows.Forms.BindingNavigator> control at design time, or add code resembling the following in the `Load` event handler.</span></span>  
  
```vb  
DataRepeater1.Top = ProductsBindingNavigator.Height  
```  
  
```csharp  
dataRepeater1.Top = productsBindingNavigator.Height;  
```  
  
## <a name="controls-are-not-displayed-correctly-at-run-time"></a><span data-ttu-id="1c9d2-118">控制項無法正確顯示在執行階段</span><span class="sxs-lookup"><span data-stu-id="1c9d2-118">Controls Are Not Displayed Correctly at Run Time</span></span>  
 <span data-ttu-id="1c9d2-119">在某些控制項<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項可能不在執行階段如預期般顯示。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-119">Some controls in a <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control may not be displayed as expected at run time.</span></span> <span data-ttu-id="1c9d2-120">處理序用來複製控制項從<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemTemplate%2A>至<xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem>永遠無法判斷所有控制項的所有屬性。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-120">The process used to clone controls from the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemTemplate%2A> to the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem> cannot always determine all the properties of all controls.</span></span> <span data-ttu-id="1c9d2-121">比方說，如果您加入未繫結<xref:System.Windows.Forms.ListBox>控制權傳輸至<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制在設計階段，並擴展其<xref:System.Windows.Forms.ListBox.Items%2A>清單的字串集合，<xref:System.Windows.Forms.ListBox>空白，在將執行階段。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-121">For example, if you add an unbound <xref:System.Windows.Forms.ListBox> control to a <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control at design time and populate its <xref:System.Windows.Forms.ListBox.Items%2A> collection with a list of strings, the <xref:System.Windows.Forms.ListBox> will be empty at run time.</span></span> <span data-ttu-id="1c9d2-122">這是因為在複製程序無法納入考量<xref:System.Windows.Forms.ListBox.Items%2A>屬性。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-122">This is because the cloning process cannot take into account the <xref:System.Windows.Forms.ListBox.Items%2A> property.</span></span>  
  
 <span data-ttu-id="1c9d2-123">您可以還原中遺漏的屬性，以修正問題，例如這<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemCloned>預設複製完成之後，就會發生的事件。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-123">You can fix problems such as this by restoring the missing properties in the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemCloned> event, which occurs after the default cloning is completed.</span></span> <span data-ttu-id="1c9d2-124">下列範例示範如何修復<xref:System.Windows.Forms.ListBox.Items%2A>集合<xref:System.Windows.Forms.ListBox>控制<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemCloned>事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-124">The following example demonstrates how to repair the <xref:System.Windows.Forms.ListBox.Items%2A> collection of a <xref:System.Windows.Forms.ListBox> control in the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemCloned> event handler.</span></span>  
  
 [!code-csharp[VbPowerPacksDataRepeaterItemCloned#1](../../../visual-basic/developing-apps/windows-forms/codesnippet/CSharp/troubleshooting-the-datarepeater-control-visual-studio_1.cs)]
 [!code-vb[VbPowerPacksDataRepeaterItemCloned#1](../../../visual-basic/developing-apps/windows-forms/codesnippet/VisualBasic/troubleshooting-the-datarepeater-control-visual-studio_1.vb)]  
  
## <a name="the-selection-symbol-on-the-item-header-is-missing"></a><span data-ttu-id="1c9d2-125">遺漏項目標題的選取項目符號</span><span class="sxs-lookup"><span data-stu-id="1c9d2-125">The Selection Symbol on the Item Header Is Missing</span></span>  
 <span data-ttu-id="1c9d2-126">當您變更<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.SelectionColor%2A>屬性中的項目標頭<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項，某些色彩選項可能會造成選取項目符號會消失。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-126">When you change the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.SelectionColor%2A> property of the item header in a <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control, some color choices may cause the selection symbol to disappear.</span></span> <span data-ttu-id="1c9d2-127">變更<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemHeaderSize%2A>屬性可能也會造成選取項目符號會消失。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-127">Changing the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemHeaderSize%2A> property may also cause the selection symbol to disappear.</span></span>  
  
 <span data-ttu-id="1c9d2-128">無法變更的色彩和大小的選取項目符號。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-128">The color and size of the selection symbol cannot be changed.</span></span>  
  
-   <span data-ttu-id="1c9d2-129">如果您設定<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.SelectionColor%2A>至<xref:System.Drawing.Color.White%2A>，選取項目符號將不會顯示第一次選取項目。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-129">If you set the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.SelectionColor%2A> to <xref:System.Drawing.Color.White%2A>, the selection symbol will not be visible when an item is first selected.</span></span>  
  
-   <span data-ttu-id="1c9d2-130">如果您設定<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.SelectionColor%2A>至<xref:System.Drawing.Color.Black%2A>，選取項目符號選取控制項時，和鉛筆符號將不會顯示當控制項處於編輯模式時，將無法看到。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-130">If you set the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.SelectionColor%2A> to <xref:System.Drawing.Color.Black%2A>, the selection symbol will not be visible when a control is selected, and the pencil symbol will not be visible when a control is in edit mode.</span></span>  
  
-   <span data-ttu-id="1c9d2-131">如果<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemHeaderSize%2A>屬性設為小於 11 的值，將不會顯示項目標頭中的標記符號。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-131">If the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.ItemHeaderSize%2A> property is set to a value that is less than 11, the indicator symbols in the item header will not be displayed.</span></span>  
  
 <span data-ttu-id="1c9d2-132">您可以使用，以提供您自己的項目標頭和選取項目符號<xref:System.Windows.Forms.PictureBox>控制和監視<xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem.IsCurrent%2A>屬性<xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem>中<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.DrawItem>事件<xref:Microsoft.VisualBasic.PowerPacks.DataRepeater>控制項。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-132">You can provide your own item header and selection symbol by using a <xref:System.Windows.Forms.PictureBox> control and monitoring the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem.IsCurrent%2A> property of the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem> in the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater.DrawItem> event of the <xref:Microsoft.VisualBasic.PowerPacks.DataRepeater> control.</span></span> <span data-ttu-id="1c9d2-133">如需詳細資訊，請參閱<xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem.IsCurrent%2A>。</span><span class="sxs-lookup"><span data-stu-id="1c9d2-133">For more information, see <xref:Microsoft.VisualBasic.PowerPacks.DataRepeaterItem.IsCurrent%2A>.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="1c9d2-134">另請參閱</span><span class="sxs-lookup"><span data-stu-id="1c9d2-134">See Also</span></span>  
 [<span data-ttu-id="1c9d2-135">DataRepeater 控制項簡介</span><span class="sxs-lookup"><span data-stu-id="1c9d2-135">Introduction to the DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/introduction-to-the-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-136">操作說明：在 DataRepeater 控制項中顯示繫結資料</span><span class="sxs-lookup"><span data-stu-id="1c9d2-136">How to: Display Bound Data in a DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-display-bound-data-in-a-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-137">操作說明：在 DataRepeater 控制項中顯示未繫結的控制項</span><span class="sxs-lookup"><span data-stu-id="1c9d2-137">How to: Display Unbound Controls in a DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-display-unbound-controls-in-a-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-138">操作說明：變更 DataRepeater 控制項的配置</span><span class="sxs-lookup"><span data-stu-id="1c9d2-138">How to: Change the Layout of a DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-change-the-layout-of-a-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-139">操作說明：變更 DataRepeater 控制項的外觀</span><span class="sxs-lookup"><span data-stu-id="1c9d2-139">How to: Change the Appearance of a DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-change-the-appearance-of-a-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-140">操作說明：在 DataRepeater 控制項中顯示項目標題</span><span class="sxs-lookup"><span data-stu-id="1c9d2-140">How to: Display Item Headers in a DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-display-item-headers-in-a-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-141">操作說明：停用加入和刪除 DataRepeater 項目</span><span class="sxs-lookup"><span data-stu-id="1c9d2-141">How to: Disable Adding and Deleting DataRepeater Items</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-disable-adding-and-deleting-datarepeater-items-visual-studio.md)  
 [<span data-ttu-id="1c9d2-142">操作說明：搜尋 DataRepeater 控制項中的資料</span><span class="sxs-lookup"><span data-stu-id="1c9d2-142">How to: Search Data in a DataRepeater Control</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-search-data-in-a-datarepeater-control-visual-studio.md)  
 [<span data-ttu-id="1c9d2-143">如何： 利用兩個 DataRepeater 控制項 (Visual Studio) 來建立主從式表單</span><span class="sxs-lookup"><span data-stu-id="1c9d2-143">How to: Create a Master/Detail Form by Using Two DataRepeater Controls (Visual Studio)</span></span>](../../../visual-basic/developing-apps/windows-forms/how-to-create-a-master-detail-form-by-using-two-datarepeater-controls.md)
