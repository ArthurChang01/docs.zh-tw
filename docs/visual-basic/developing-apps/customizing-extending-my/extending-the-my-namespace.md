---
title: 擴充 Visual Basic 中的 My 命名空間
ms.date: 07/20/2015
f1_keywords:
- vb.AddingMyExtensions
helpviewer_keywords:
- My namespace [Visual Basic], customizing
- My namespace
- My namespace [Visual Basic], extending
ms.assetid: 808e8617-b01c-4135-8b21-babe87389e8e
ms.openlocfilehash: 6da0914c9d2d4dc1220ede5d6fa9f1aa6b43426a
ms.sourcegitcommit: 559259da2738a7b33a46c0130e51d336091c2097
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/22/2019
ms.locfileid: "72775293"
---
# <a name="extending-the-my-namespace-in-visual-basic"></a><span data-ttu-id="aa8f8-102">擴充中的 `My` 命名空間 Visual Basic</span><span class="sxs-lookup"><span data-stu-id="aa8f8-102">Extending the `My` Namespace in Visual Basic</span></span>

<span data-ttu-id="aa8f8-103">Visual Basic 中的 `My` 命名空間會公開屬性和方法，讓您可以輕鬆地利用 .NET Framework 的強大功能。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-103">The `My` namespace in Visual Basic exposes properties and methods that enable you to easily take advantage of the power of the .NET Framework.</span></span> <span data-ttu-id="aa8f8-104">@No__t_0 命名空間簡化了常見的程式設計問題，通常會減少一行程式碼的困難工作。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-104">The `My` namespace simplifies common programming problems, often reducing a difficult task to a single line of code.</span></span> <span data-ttu-id="aa8f8-105">此外，`My` 命名空間是完全可延伸的，因此您可以自訂 `My` 的行為，並將新的服務新增至其階層，以適應特定的應用程式需求。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-105">Additionally, the `My` namespace is fully extensible so that you can customize the behavior of `My` and add new services to its hierarchy to adapt to specific application needs.</span></span> <span data-ttu-id="aa8f8-106">本主題討論如何自訂 `My` 命名空間的現有成員，以及如何將您自己的自訂類別加入 `My` 命名空間。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-106">This topic discusses both how to customize existing members of the `My` namespace and how to add your own custom classes to the `My` namespace.</span></span>

## <a name="customizing-existing-my-namespace-members"></a><span data-ttu-id="aa8f8-107">自訂現有的 `My` 命名空間成員</span><span class="sxs-lookup"><span data-stu-id="aa8f8-107">Customizing existing `My` namespace members</span></span>

<span data-ttu-id="aa8f8-108">Visual Basic 中的 `My` 命名空間會公開有關您的應用程式、電腦及其他的常用資訊。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-108">The `My` namespace in Visual Basic exposes frequently used information about your application, your computer, and more.</span></span> <span data-ttu-id="aa8f8-109">如需 `My` 命名空間中物件的完整清單，請參閱[我的參考](../../language-reference/keywords/my-reference.md)。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-109">For a complete list of the objects in the `My` namespace, see [My Reference](../../language-reference/keywords/my-reference.md).</span></span> <span data-ttu-id="aa8f8-110">您可能必須自訂 `My` 命名空間的現有成員，使其更符合應用程式的需求。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-110">You may have to customize existing members of the `My` namespace so that they better match the needs of your application.</span></span> <span data-ttu-id="aa8f8-111">@No__t_0 命名空間中，物件的任何屬性都不是唯讀的，可以設定為自訂值。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-111">Any property of an object in the `My` namespace that is not read-only can be set to a custom value.</span></span>

<span data-ttu-id="aa8f8-112">例如，假設您經常使用 `My.User` 物件來存取執行應用程式之使用者的目前安全性內容。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-112">For example, assume that you frequently use the `My.User` object to access the current security context for the user running your application.</span></span> <span data-ttu-id="aa8f8-113">不過，您的公司會使用自訂的使用者物件，為公司內的使用者公開其他資訊和功能。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-113">However, your company uses a custom user object to expose additional information and capabilities for users within the company.</span></span> <span data-ttu-id="aa8f8-114">在此案例中，您可以使用您自己的自訂主體物件的實例來取代 `My.User.CurrentPrincipal` 屬性的預設值，如下列範例所示：</span><span class="sxs-lookup"><span data-stu-id="aa8f8-114">In this scenario, you can replace the default value of the `My.User.CurrentPrincipal` property with an instance of your own custom principal object, as shown in the following example:</span></span>

[!code-vb[VbVbcnExtendingMy#1](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#1)]

<span data-ttu-id="aa8f8-115">在 `My.User` 物件上設定 `CurrentPrincipal` 屬性會變更執行應用程式所用的身分識別。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-115">Setting the `CurrentPrincipal` property on the `My.User` object changes the identity under which the application runs.</span></span> <span data-ttu-id="aa8f8-116">接著，`My.User` 物件會傳回新指定使用者的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-116">The `My.User` object, in turn, returns information about the newly specified user.</span></span>
  
## <a name="adding-members-to-my-objects"></a><span data-ttu-id="aa8f8-117">將成員新增至 `My` 物件</span><span class="sxs-lookup"><span data-stu-id="aa8f8-117">Adding members to `My` objects</span></span>

<span data-ttu-id="aa8f8-118">從 `My.Application` 和 `My.Computer` 傳回的類型會定義為 `Partial` 類別。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-118">The types returned from `My.Application` and `My.Computer` are defined as `Partial` classes.</span></span> <span data-ttu-id="aa8f8-119">因此，您可以藉由建立名為 `MyApplication` 或 `MyComputer` 的 `Partial` 類別，來擴充 `My.Application` 和 `My.Computer` 物件。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-119">Therefore, you can extend the `My.Application` and `My.Computer` objects by creating a `Partial` class named `MyApplication` or `MyComputer`.</span></span> <span data-ttu-id="aa8f8-120">類別不可以是 `Private` 類別。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-120">The class cannot be a `Private` class.</span></span> <span data-ttu-id="aa8f8-121">如果您將類別指定為 `My` 命名空間的一部分，您可以加入 `My.Application` 或 `My.Computer` 物件中將包含的屬性和方法。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-121">If you specify the class as part of the `My` namespace, you can add properties and methods that will be included with the `My.Application` or `My.Computer` objects.</span></span>

<span data-ttu-id="aa8f8-122">下列範例會將名為 `DnsServerIPAddresses` 的屬性新增至 `My.Computer` 物件：</span><span class="sxs-lookup"><span data-stu-id="aa8f8-122">The following example adds a property named `DnsServerIPAddresses` to the `My.Computer` object:</span></span>

[!code-vb[VbVbcnExtendingMy#2](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class2.vb#2)]

## <a name="adding-custom-objects-to-the-my-namespace"></a><span data-ttu-id="aa8f8-123">將自訂物件新增至 `My` 命名空間</span><span class="sxs-lookup"><span data-stu-id="aa8f8-123">Adding custom objects to the `My` namespace</span></span>

<span data-ttu-id="aa8f8-124">雖然 `My` 命名空間提供許多常見程式設計工作的解決方案，但您可能會遇到 `My` 命名空間無法解決的工作。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-124">Although the `My` namespace provides solutions for many common programming tasks, you may encounter tasks that the `My` namespace does not address.</span></span> <span data-ttu-id="aa8f8-125">例如，您的應用程式可能會存取使用者資料的自訂目錄服務，或者您的應用程式可能會使用預設不會隨 Visual Basic 安裝的元件。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-125">For example, your application might access custom directory services for user data, or your application might use assemblies that are not installed by default with Visual Basic.</span></span> <span data-ttu-id="aa8f8-126">您可以擴充 `My` 命名空間，以將自訂解決方案納入您環境特有的一般工作。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-126">You can extend the `My` namespace to include custom solutions to common tasks that are specific to your environment.</span></span> <span data-ttu-id="aa8f8-127">您可以輕鬆地擴充 `My` 命名空間來加入新成員，以符合成長中的應用程式需求。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-127">The `My` namespace can easily be extended to add new members to meet growing application needs.</span></span> <span data-ttu-id="aa8f8-128">此外，您也可以將 `My` 的命名空間延伸模組部署至其他開發人員，做為 Visual Basic 範本。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-128">Additionally, you can deploy your `My` namespace extensions to other developers as a Visual Basic template.</span></span>
  
### <a name="adding-members-to-the-my-namespace"></a><span data-ttu-id="aa8f8-129">將成員新增至 `My` 命名空間</span><span class="sxs-lookup"><span data-stu-id="aa8f8-129">Adding members to the `My` namespace</span></span>

<span data-ttu-id="aa8f8-130">因為 `My` 的命名空間與其他命名空間相似，所以只要加入模組並指定 `My` 的 `Namespace`，就可以將最上層的屬性新增至其中。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-130">Because `My` is a namespace like any other namespace, you can add top-level properties to it by just adding a module and specifying a `Namespace` of `My`.</span></span> <span data-ttu-id="aa8f8-131">使用 `HideModuleName` 屬性來標注模組，如下列範例所示。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-131">Annotate the module with the `HideModuleName` attribute as shown in the following example.</span></span> <span data-ttu-id="aa8f8-132">@No__t_0 屬性可確保 IntelliSense 在顯示 `My` 命名空間的成員時，不會顯示模組名稱。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-132">The `HideModuleName` attribute ensures that IntelliSense will not display the module name when it displays the members of the `My` namespace.</span></span>

[!code-vb[VbVbcnExtendingMy#3](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#3)]

<span data-ttu-id="aa8f8-133">若要將成員新增至 `My` 命名空間，請視需要將屬性新增至模組。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-133">To add members to the `My` namespace, add properties as needed to the module.</span></span> <span data-ttu-id="aa8f8-134">針對加入至 `My` 命名空間的每個屬性，加入 `ThreadSafeObjectProvider(Of T)` 類型的私用欄位，其中類型是自訂屬性所傳回的類型。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-134">For each property added to the `My` namespace, add a private field of type `ThreadSafeObjectProvider(Of T)`, where the type is the type returned by your custom property.</span></span> <span data-ttu-id="aa8f8-135">這個欄位是用來建立由屬性傳回的安全線程物件實例，其方式是呼叫 `GetInstance` 方法。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-135">This field is used to create thread-safe object instances to be returned by the property by calling the `GetInstance` method.</span></span> <span data-ttu-id="aa8f8-136">因此，每個存取擴充屬性的執行緒都會收到自己的傳回型別實例。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-136">As a result, each thread that is accessing the extended property receives its own instance of the returned type.</span></span> <span data-ttu-id="aa8f8-137">下列範例會將名為 `SampleExtension` 的屬性加入 `SampleExtension` `My` 命名空間的類型：</span><span class="sxs-lookup"><span data-stu-id="aa8f8-137">The following example adds a property named `SampleExtension` that is of type `SampleExtension` to the `My` namespace:</span></span>

[!code-vb[VbVbcnExtendingMy#4](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#4)]

## <a name="adding-events-to-custom-my-objects"></a><span data-ttu-id="aa8f8-138">將事件加入至自訂 `My` 物件</span><span class="sxs-lookup"><span data-stu-id="aa8f8-138">Adding events to custom `My` objects</span></span>

<span data-ttu-id="aa8f8-139">您可以藉由擴充 `My` 命名空間中的 `MyApplication` 部分類別，使用 `My.Application` 物件來公開自訂 `My` 物件的事件。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-139">You can use the `My.Application` object to expose events for your custom `My` objects by extending the `MyApplication` partial class in the `My` namespace.</span></span> <span data-ttu-id="aa8f8-140">對於以 Windows 為基礎的專案，您可以在**方案總管**中按兩下專案的 [**我的專案**] 節點。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-140">For Windows-based projects, you can double-click the **My Project** node in for your project in **Solution Explorer**.</span></span> <span data-ttu-id="aa8f8-141">在 Visual Basic**專案設計**工具中，按一下 [**應用程式**] 索引標籤，然後按一下 [**視圖應用程式事件**] 按鈕。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-141">In the Visual Basic **Project Designer**, click the **Application** tab and then click the **View Application Events** button.</span></span> <span data-ttu-id="aa8f8-142">將會建立名為*applicationevents.vb*的新檔案。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-142">A new file that is named *ApplicationEvents.vb* will be created.</span></span> <span data-ttu-id="aa8f8-143">其中包含用來擴充 `MyApplication` 類別的下列程式碼：</span><span class="sxs-lookup"><span data-stu-id="aa8f8-143">It contains the following code for extending the `MyApplication` class:</span></span>

[!code-vb[VbVbcnExtendingMy#5](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#5)]

<span data-ttu-id="aa8f8-144">您可以藉由將自訂事件處理常式加入 `MyApplication` 類別中，為您的自訂 `My` 物件加入事件處理常式。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-144">You can add event handlers for your custom `My` objects by adding custom event handlers to the `MyApplication` class.</span></span> <span data-ttu-id="aa8f8-145">自訂事件可讓您加入在加入、移除事件處理常式或引發事件時，將執行的程式碼。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-145">Custom events enable you to add code that will execute when an event handler is added, removed, or the event is raised.</span></span> <span data-ttu-id="aa8f8-146">請注意，只有當使用者新增程式碼來處理事件時，才會執行自訂事件的 `AddHandler` 程式碼。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-146">Note that the `AddHandler` code for a custom event runs only if code is added by a user to handle the event.</span></span> <span data-ttu-id="aa8f8-147">例如，假設上一節中的 `SampleExtension` 物件有您想要為其加入自訂事件處理常式的 `Load` 事件。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-147">For example, consider that the `SampleExtension` object from the previous section has a `Load` event that you want to add a custom event handler for.</span></span> <span data-ttu-id="aa8f8-148">下列程式碼範例顯示名為 `SampleExtensionLoad` 的自訂事件處理常式，當發生 `My.SampleExtension.Load` 事件時將會叫用。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-148">The following code example shows a custom event handler named `SampleExtensionLoad` that will be invoked when the `My.SampleExtension.Load` event occurs.</span></span> <span data-ttu-id="aa8f8-149">加入程式碼以處理新的 `My.SampleExtensionLoad` 事件時，會執行此自訂事件程式碼的 `AddHandler` 部分。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-149">When code is added to handle the new `My.SampleExtensionLoad` event, the `AddHandler` part of this custom event code is executed.</span></span> <span data-ttu-id="aa8f8-150">@No__t_0 的方法包含在程式碼範例中，以顯示處理 `My.SampleExtensionLoad` 事件的事件處理常式範例。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-150">The `MyApplication_SampleExtensionLoad` method is included in the code example to show an example of an event handler that handles the `My.SampleExtensionLoad` event.</span></span> <span data-ttu-id="aa8f8-151">請注意，當您編輯*applicationevents.vb*檔時，如果您在程式碼編輯器上方的左側下拉式清單中選取 [**我的應用程式事件**] 選項，就可以使用 [`SampleExtensionLoad`] 事件。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-151">Note that the `SampleExtensionLoad` event will be available when you select the **My Application Events** option in the left drop-down list above the Code Editor when you are editing the *ApplicationEvents.vb* file.</span></span>

[!code-vb[VbVbcnExtendingMy#6](~/samples/snippets/visualbasic/VS_Snippets_VBCSharp/VbVbcnExtendingMy/VB/Class1.vb#6)]

## <a name="design-guidelines"></a><span data-ttu-id="aa8f8-152">設計指導方針</span><span class="sxs-lookup"><span data-stu-id="aa8f8-152">Design guidelines</span></span>

<span data-ttu-id="aa8f8-153">當您開發 `My` 命名空間的延伸模組時，請使用下列指導方針來協助將延伸模組元件的維護成本降至最低：</span><span class="sxs-lookup"><span data-stu-id="aa8f8-153">When you develop extensions to the `My` namespace, use the following guidelines to help minimize the maintenance costs of your extension components:</span></span>

- <span data-ttu-id="aa8f8-154">**只包含延伸模組邏輯。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-154">**Include only the extension logic.**</span></span> <span data-ttu-id="aa8f8-155">@No__t_0 命名空間延伸模組中包含的邏輯，應該只包含在 `My` 命名空間中公開必要功能所需的程式碼。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-155">The logic included in the `My` namespace extension should include only the code that is needed to expose the required functionality in the `My` namespace.</span></span> <span data-ttu-id="aa8f8-156">因為您的延伸模組會在使用者專案中做為原始程式碼，所以更新延伸模組元件會產生較高的維護成本，而且應該盡可能避免。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-156">Because your extension will reside in user projects as source code, updating the extension component incurs a high maintenance cost and should be avoided if possible.</span></span>
- <span data-ttu-id="aa8f8-157">**最小化專案假設。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-157">**Minimize project assumptions.**</span></span> <span data-ttu-id="aa8f8-158">當您建立 `My` 命名空間的延伸模組時，請勿假設一組參考、專案層級匯入或特定編譯器設定（例如，`Option Strict` 關閉）。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-158">When you create your extensions of the `My` namespace, do not assume a set of references, project-level imports, or specific compiler settings (for example, `Option Strict` off).</span></span> <span data-ttu-id="aa8f8-159">相反地，請將相依性最小化，並使用 `Global` 關鍵字來完整限定所有類型參考。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-159">Instead, minimize dependencies and fully qualify all type references by using the `Global` keyword.</span></span> <span data-ttu-id="aa8f8-160">此外，請確定延伸模組會使用 `Option Strict` 進行編譯，以將擴充功能中的錯誤降至最低。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-160">Also, ensure that the extension compiles with `Option Strict` on to minimize errors in the extension.</span></span>
- <span data-ttu-id="aa8f8-161">**隔離延伸模組程式碼。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-161">**Isolate the extension code.**</span></span> <span data-ttu-id="aa8f8-162">將程式碼放在單一檔案中，可讓您輕鬆地將擴充功能部署為 Visual Studio 專案範本。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-162">Placing the code in a single file makes your extension easily deployable as a Visual Studio item template.</span></span> <span data-ttu-id="aa8f8-163">如需詳細資訊，請參閱本主題稍後的「封裝和部署擴充功能」。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-163">For more information, see "Packaging and Deploying Extensions" later in this topic.</span></span> <span data-ttu-id="aa8f8-164">將所有的 `My` 命名空間延伸模組程式碼放入單一檔案或專案中的個別資料夾，也有助於使用者找到 `My` 的命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-164">Placing all the `My` namespace extension code in a single file or a separate folder in a project will also help users locate the `My` namespace extension.</span></span>

## <a name="designing-class-libraries-for-my"></a><span data-ttu-id="aa8f8-165">設計 `My` 的類別庫</span><span class="sxs-lookup"><span data-stu-id="aa8f8-165">Designing class libraries for `My`</span></span>

<span data-ttu-id="aa8f8-166">就像大部分的物件模型一樣，某些設計模式在 `My` 命名空間中會良好運作，而其他則不適用。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-166">As is the case with most object models, some design patterns work well in the `My` namespace and others do not.</span></span> <span data-ttu-id="aa8f8-167">設計 `My` 命名空間的延伸模組時，請考慮下列原則：</span><span class="sxs-lookup"><span data-stu-id="aa8f8-167">When designing an extension to the `My` namespace, consider the following principles:</span></span>

- <span data-ttu-id="aa8f8-168">**無狀態方法。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-168">**Stateless methods.**</span></span> <span data-ttu-id="aa8f8-169">@No__t_0 命名空間中的方法應該為特定工作提供完整的解決方案。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-169">Methods in the `My` namespace should provide a complete solution to a specific task.</span></span> <span data-ttu-id="aa8f8-170">請確定傳遞至方法的參數值提供完成特定工作所需的所有輸入。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-170">Ensure that the parameter values that are passed to the method provide all the input required to complete the particular task.</span></span> <span data-ttu-id="aa8f8-171">避免建立依賴先前狀態的方法，例如開啟資源的連接。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-171">Avoid creating methods that rely on prior state, such as open connections to resources.</span></span>
- <span data-ttu-id="aa8f8-172">**全域實例。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-172">**Global instances.**</span></span> <span data-ttu-id="aa8f8-173">在 `My` 命名空間中維護的唯一狀態，對專案而言是全域的。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-173">The only state that is maintained in the `My` namespace is global to the project.</span></span> <span data-ttu-id="aa8f8-174">例如，`My.Application.Info` 會封裝在整個應用程式中共用的狀態。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-174">For example, `My.Application.Info` encapsulates state that is shared throughout the application.</span></span>
- <span data-ttu-id="aa8f8-175">**簡單的參數類型。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-175">**Simple parameter types.**</span></span> <span data-ttu-id="aa8f8-176">避免複雜的參數類型，讓事情保持簡單。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-176">Keep things simple by avoiding complex parameter types.</span></span> <span data-ttu-id="aa8f8-177">相反地，請建立不接受參數輸入或接受簡單輸入類型（例如字串、基本類型等等）的方法。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-177">Instead, create methods that either take no parameter input or that take simple input types such as strings, primitive types, and so on.</span></span>
- <span data-ttu-id="aa8f8-178">**Factory 方法。**</span><span class="sxs-lookup"><span data-stu-id="aa8f8-178">**Factory methods.**</span></span> <span data-ttu-id="aa8f8-179">有些類型一定很難具現化。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-179">Some types are necessarily difficult to instantiate.</span></span> <span data-ttu-id="aa8f8-180">提供 factory 方法做為 `My` 命名空間的延伸模組，可讓您更輕鬆地探索及使用屬於此類別的類型。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-180">Providing factory methods as extensions to the `My` namespace enables you to more easily discover and consume types that fall into this category.</span></span> <span data-ttu-id="aa8f8-181">@No__t_0，這是一種良好運作的 factory 方法範例。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-181">An example of a factory method that works well is `My.Computer.FileSystem.OpenTextFileReader`.</span></span> <span data-ttu-id="aa8f8-182">.NET Framework 中有數個可用的資料流程類型。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-182">There are several stream types available in the .NET Framework.</span></span> <span data-ttu-id="aa8f8-183">藉由明確指定文字檔，`OpenTextFileReader` 可協助使用者瞭解要使用哪一個資料流程。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-183">By specifying text files specifically, the `OpenTextFileReader` helps the user understand which stream to use.</span></span>

<span data-ttu-id="aa8f8-184">這些指導方針不會排除類別庫的一般設計原則。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-184">These guidelines do not preclude general design principles for class libraries.</span></span> <span data-ttu-id="aa8f8-185">相反地，它們是針對使用 Visual Basic 和 `My` 命名空間的開發人員優化的建議。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-185">Rather, they are recommendations that are optimized for developers who are using Visual Basic and the `My` namespace.</span></span> <span data-ttu-id="aa8f8-186">如需建立類別庫的一般設計原則，請參閱[架構設計方針](../../../standard/design-guidelines/index.md)。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-186">For general design principles for creating class libraries, see [Framework Design Guidelines](../../../standard/design-guidelines/index.md).</span></span>

## <a name="packaging-and-deploying-extensions"></a><span data-ttu-id="aa8f8-187">封裝和部署擴充功能</span><span class="sxs-lookup"><span data-stu-id="aa8f8-187">Packaging and deploying extensions</span></span>

<span data-ttu-id="aa8f8-188">您可以在 Visual Studio 專案範本中包含 `My` 命名空間延伸模組，也可以封裝您的擴充功能，並將其部署為 Visual Studio 專案範本。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-188">You can include `My` namespace extensions in a Visual Studio project template, or you can package your extensions and deploy them as a Visual Studio item template.</span></span> <span data-ttu-id="aa8f8-189">當您將 `My` 命名空間延伸模組封裝為 Visual Studio 專案範本時，您可以利用 Visual Basic 所提供的其他功能。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-189">When you package your `My` namespace extensions as a Visual Studio item template, you can take advantage of additional capabilities provided by Visual Basic.</span></span> <span data-ttu-id="aa8f8-190">這些功能可讓您在專案參考特定元件時包含延伸模組，或讓使用者使用 Visual Basic 專案設計工具的 [**我的延伸**模組] 頁面，明確加入您的 `My` 命名空間延伸模組。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-190">These capabilities enable you to include an extension when a project references a particular assembly, or enable users to explicitly add your `My` namespace extension by using the **My Extensions** page of the Visual Basic Project Designer.</span></span>

<span data-ttu-id="aa8f8-191">如需如何部署 `My` 命名空間延伸模組的詳細資訊，請參閱[封裝和部署自訂 My extensions](packaging-and-deploying-custom-my-extensions.md)。</span><span class="sxs-lookup"><span data-stu-id="aa8f8-191">For details about how to deploy `My` namespace extensions, see [Packaging and Deploying Custom My Extensions](packaging-and-deploying-custom-my-extensions.md).</span></span>

## <a name="see-also"></a><span data-ttu-id="aa8f8-192">請參閱</span><span class="sxs-lookup"><span data-stu-id="aa8f8-192">See also</span></span>

- [<span data-ttu-id="aa8f8-193">封裝和部署自訂的 My 擴充</span><span class="sxs-lookup"><span data-stu-id="aa8f8-193">Packaging and Deploying Custom My Extensions</span></span>](packaging-and-deploying-custom-my-extensions.md)
- [<span data-ttu-id="aa8f8-194">擴充 Visual Basic 應用程式模型</span><span class="sxs-lookup"><span data-stu-id="aa8f8-194">Extending the Visual Basic Application Model</span></span>](extending-the-visual-basic-application-model.md)
- [<span data-ttu-id="aa8f8-195">自訂 My 中可用的物件</span><span class="sxs-lookup"><span data-stu-id="aa8f8-195">Customizing Which Objects are Available in My</span></span>](customizing-which-objects-are-available-in-my.md)
- [<span data-ttu-id="aa8f8-196">我的延伸模組頁面、專案設計工具</span><span class="sxs-lookup"><span data-stu-id="aa8f8-196">My Extensions Page, Project Designer</span></span>](/visualstudio/ide/reference/my-extensions-page-project-designer-visual-basic)
- [<span data-ttu-id="aa8f8-197">專案設計工具、應用程式頁面 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="aa8f8-197">Application Page, Project Designer (Visual Basic)</span></span>](/visualstudio/ide/reference/application-page-project-designer-visual-basic)
- [<span data-ttu-id="aa8f8-198">Partial</span><span class="sxs-lookup"><span data-stu-id="aa8f8-198">Partial</span></span>](../../language-reference/modifiers/partial.md)
