---
title: "解析外部資源"
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
ms.assetid: ad3fa320-4b8f-4e5c-b549-01157591007a
caps.latest.revision: "4"
author: mairaw
ms.author: mairaw
manager: wpickett
ms.openlocfilehash: 824a35ee5d4ecafc45167ff3f4bc89802af4ed96
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/18/2017
---
# <a name="resolving-external-resources"></a><span data-ttu-id="2e3df-102">解析外部資源</span><span class="sxs-lookup"><span data-stu-id="2e3df-102">Resolving External Resources</span></span>
<span data-ttu-id="2e3df-103">**XmlResolver**屬性**XmlDocument**正由**XmlDocument**找不到沒有內嵌在 XML 資料，例如外部文件類型資源類別定義 (Dtd)、 實體和結構描述。</span><span class="sxs-lookup"><span data-stu-id="2e3df-103">The **XmlResolver** property of the **XmlDocument** is used by the **XmlDocument** class to locate resources that are not inline in the XML data, such as external document type definitions (DTDs), entities, and schemas.</span></span> <span data-ttu-id="2e3df-104">這些項目可位於網路或本機磁碟上，並且可以由統一資源識別元 (URI) 辨識。</span><span class="sxs-lookup"><span data-stu-id="2e3df-104">These items can be located on a network or on a local drive, and are identifiable by a Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="2e3df-105">這可讓**XmlDocument**解析**EntityReference**節點會出現在文件，並驗證根據外部 DTD 或結構描述文件。</span><span class="sxs-lookup"><span data-stu-id="2e3df-105">This allows the **XmlDocument** to resolve **EntityReference** nodes that are present in the document and validate the document according to the external DTD or schema.</span></span>  
  
## <a name="fully-trusted-xmldocument"></a><span data-ttu-id="2e3df-106">完全信任的 XmlDocument</span><span class="sxs-lookup"><span data-stu-id="2e3df-106">Fully-Trusted XmlDocument</span></span>  
 <span data-ttu-id="2e3df-107">**XmlResolver**屬性會影響的功能**Textreader**方法。</span><span class="sxs-lookup"><span data-stu-id="2e3df-107">The **XmlResolver** property affects the functionality of the **XmlDocument.Load** method.</span></span> <span data-ttu-id="2e3df-108">下的表顯示如何**XmlDocument.XmlResolver**屬性的運作方式時**XmlDocument**物件是完全受信任。</span><span class="sxs-lookup"><span data-stu-id="2e3df-108">The table below shows how the **XmlDocument.XmlResolver** property works when the **XmlDocument** object is fully trusted.</span></span> <span data-ttu-id="2e3df-109">下表顯示**Textreader**方法時載入的輸入是**TextReader**，**字串**，**資料流**，或**URI**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-109">The following table shows the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="2e3df-110">這個表格不適用於**負載**方法如果**XmlDocument**是從載入**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-110">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="2e3df-111">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="2e3df-111">XmlResolver property</span></span>|<span data-ttu-id="2e3df-112">函式</span><span class="sxs-lookup"><span data-stu-id="2e3df-112">Function</span></span>|<span data-ttu-id="2e3df-113">注意</span><span class="sxs-lookup"><span data-stu-id="2e3df-113">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="2e3df-114">屬性設定為**XmlResolver**先前已建立且已由使用者在其上設定屬性的類別。</span><span class="sxs-lookup"><span data-stu-id="2e3df-114">The property is set to an **XmlResolver** class that has been previously created and has properties already set on it by the user.</span></span>|<span data-ttu-id="2e3df-115">**XmlDocument**使用**XmlResolver** ，指定用來解析檔案名稱，來解析外部資源，例如 Dtd、 實體和結構描述的參考。</span><span class="sxs-lookup"><span data-stu-id="2e3df-115">The **XmlDocument** uses the **XmlResolver** that is given to resolve file names, to resolve references to external resources such as DTDs, entities, and schemas.</span></span><br /><br /> <span data-ttu-id="2e3df-116">**XmlResolver**當解析外部資源所需新增或編輯中的節點時也會使用**XmlDocument**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-116">The **XmlResolver** is also used when resolving external resources that are needed when adding or editing nodes in the **XmlDocument**.</span></span>|<span data-ttu-id="2e3df-117">**XmlResolver**提供給**XmlDocument**是需要尋找並解析外部資源時，都會使用的解析程式。</span><span class="sxs-lookup"><span data-stu-id="2e3df-117">The **XmlResolver** given to the **XmlDocument** is the resolver that is used whenever external resources need to be located and resolved.</span></span>|  
|<span data-ttu-id="2e3df-118">屬性設定為**null** (**Nothing**在 Microsoft Visual Basic.NET)。</span><span class="sxs-lookup"><span data-stu-id="2e3df-118">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="2e3df-119">不支援需要外部資源的功能，例如尋找外部結構描述或 DTD。</span><span class="sxs-lookup"><span data-stu-id="2e3df-119">Features that require an external resource are not supported, such as locating an external schema, or DTD.</span></span> <span data-ttu-id="2e3df-120">也不會解析外部實體，並且也不支援執行編輯功能 (例如插入需要解析的實體節點)。</span><span class="sxs-lookup"><span data-stu-id="2e3df-120">Nor will external entities be resolved, and performing editing functions, such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="2e3df-121">**XmlDocument**載入檔案匿名身分，並不會嘗試解決其他任何資源。</span><span class="sxs-lookup"><span data-stu-id="2e3df-121">The **XmlDocument** loads files as anonymous and does not attempt to resolve any other resources.</span></span>|  
|<span data-ttu-id="2e3df-122">尚未設定屬性，但是保留為預設狀態。</span><span class="sxs-lookup"><span data-stu-id="2e3df-122">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="2e3df-123">**XmlUrlResolver** null 認證會具現化並供**XmlDocument**時解析檔案名稱、 尋找外部 Dtd、 實體和結構描述，和**null**編輯節點時會使用的認證。</span><span class="sxs-lookup"><span data-stu-id="2e3df-123">An **XmlUrlResolver** with NULL credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>||  
  
 <span data-ttu-id="2e3df-124">下表顯示**Textreader**方法時的輸入**負載**是**XmlReader**和**XmlDocument**是完全信任。</span><span class="sxs-lookup"><span data-stu-id="2e3df-124">The following table shows the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader** and the **XmlDocument** is fully trusted.</span></span>  
  
|<span data-ttu-id="2e3df-125">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="2e3df-125">XmlResolver property</span></span>|<span data-ttu-id="2e3df-126">函式</span><span class="sxs-lookup"><span data-stu-id="2e3df-126">Function</span></span>|<span data-ttu-id="2e3df-127">注意</span><span class="sxs-lookup"><span data-stu-id="2e3df-127">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="2e3df-128">**XmlResolver**類別所使用**XmlDocument**是正在使用的相同類別**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-128">The **XmlResolver** class used by the **XmlDocument** is the same class being used by the **XmlReader**.</span></span>|<span data-ttu-id="2e3df-129">**XmlDocument**使用**XmlResolver** ，已指派給**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-129">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="2e3df-130">**XmlDocument.Resolver**屬性不可設定，而不論**XmlDocument**信任層級，因為它即將**XmlResolver**從**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-130">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="2e3df-131">您無法嘗試覆寫的設定**Xmldocument**' **XmlResolver**藉由設定**XmlResolver**屬性**XmlDocument**.</span><span class="sxs-lookup"><span data-stu-id="2e3df-131">You cannot attempt to override the settings of the **XmlReaders**' **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="2e3df-132">**XmlReader**可以**XmlTextReader**， **XmlValidatingReader**，或自訂撰寫的讀取器。</span><span class="sxs-lookup"><span data-stu-id="2e3df-132">The **XmlReader** can be the **XmlTextReader**, **XmlValidatingReader**, or a custom-written reader.</span></span> <span data-ttu-id="2e3df-133">如果所用的讀取器支援實體解析，則會解析外部實體。</span><span class="sxs-lookup"><span data-stu-id="2e3df-133">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="2e3df-134">如果傳遞的讀取器不支援實體參考，則不會解析實體參考。</span><span class="sxs-lookup"><span data-stu-id="2e3df-134">If the reader passed does not support entity references, then entity references are not resolved.</span></span>|  
  
## <a name="semi-trusted-xmldocument"></a><span data-ttu-id="2e3df-135">非完全信任的 XmlDocument</span><span class="sxs-lookup"><span data-stu-id="2e3df-135">Semi-Trusted XmlDocument</span></span>  
 <span data-ttu-id="2e3df-136">下表顯示如何**XmlDocument.XmlResolver**屬性的物件是完全信任的運作方式。</span><span class="sxs-lookup"><span data-stu-id="2e3df-136">The following table shows how the **XmlDocument.XmlResolver** property works when the object is semi-trusted.</span></span> <span data-ttu-id="2e3df-137">此表格適用於**Textreader**方法時載入的輸入是**TextReader**，**字串**，**資料流**，或**URI**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-137">This table applies to the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="2e3df-138">這個表格不適用於**負載**方法如果**XmlDocument**是從載入**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-138">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="2e3df-139">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="2e3df-139">XmlResolver property</span></span>|<span data-ttu-id="2e3df-140">函式</span><span class="sxs-lookup"><span data-stu-id="2e3df-140">Function</span></span>|<span data-ttu-id="2e3df-141">注意</span><span class="sxs-lookup"><span data-stu-id="2e3df-141">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="2e3df-142">在非完全信任的案例中， **XmlResolver**屬性無法設定為 null 以外的任何項目。</span><span class="sxs-lookup"><span data-stu-id="2e3df-142">In the semi-trusted scenario, the **XmlResolver** property cannot be set to anything other than null.</span></span>|<span data-ttu-id="2e3df-143">**XmlUrlResolver**與**null**認證會具現化並供**XmlDocument**時解析檔案名稱、 尋找外部 Dtd、 實體和結構描述，和**null**編輯節點時會使用的認證。</span><span class="sxs-lookup"><span data-stu-id="2e3df-143">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="2e3df-144">此行為是相同的行為時**XmlResolver**屬性尚未設定，但是保留為預設狀態。</span><span class="sxs-lookup"><span data-stu-id="2e3df-144">This behavior is identical to the behavior when the **XmlResolver** property is not set, but left in its default state.</span></span><br /><br /> <span data-ttu-id="2e3df-145">**XmlDocument**使用匿名權限執行所有動作。</span><span class="sxs-lookup"><span data-stu-id="2e3df-145">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
|<span data-ttu-id="2e3df-146">屬性設定為**null** (**Nothing**在 Microsoft Visual Basic.NET)。</span><span class="sxs-lookup"><span data-stu-id="2e3df-146">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="2e3df-147">不支援需要外部資源的功能，例如尋找外部結構描述或 DTD。</span><span class="sxs-lookup"><span data-stu-id="2e3df-147">No features that require an external resource are supported, such as locating an external schema or DTD.</span></span> <span data-ttu-id="2e3df-148">也不會解析外部實體，並且也不支援執行編輯功能，例如插入需要資源的實體節點。</span><span class="sxs-lookup"><span data-stu-id="2e3df-148">Nor will external entities be resolved, and performing editing functions such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="2e3df-149">若屬性是**null**，則行為是相同的不論 if **XmlDocument**是完全受信任或非完全信任。</span><span class="sxs-lookup"><span data-stu-id="2e3df-149">When the property is **null**, the behavior is the same regardless if the **XmlDocument** is fully trusted or semi-trusted.</span></span>|  
|<span data-ttu-id="2e3df-150">尚未設定屬性，但是保留為預設狀態。</span><span class="sxs-lookup"><span data-stu-id="2e3df-150">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="2e3df-151">**XmlUrlResolver**與**null**認證會具現化並供**XmlDocument**時解析檔案名稱、 尋找外部 Dtd、 實體和結構描述，和**null**編輯節點時會使用的認證。</span><span class="sxs-lookup"><span data-stu-id="2e3df-151">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="2e3df-152">**XmlDocument**使用匿名權限執行所有動作。</span><span class="sxs-lookup"><span data-stu-id="2e3df-152">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
  
 <span data-ttu-id="2e3df-153">此表格適用於**Textreader**方法時的輸入**負載**是**XmlReader**，而**XmlDocument**是非完全信任。</span><span class="sxs-lookup"><span data-stu-id="2e3df-153">This table applies to the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader**, and the **XmlDocument** is semi-trusted.</span></span>  
  
|<span data-ttu-id="2e3df-154">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="2e3df-154">XmlResolver property</span></span>|<span data-ttu-id="2e3df-155">函式</span><span class="sxs-lookup"><span data-stu-id="2e3df-155">Function</span></span>|<span data-ttu-id="2e3df-156">注意</span><span class="sxs-lookup"><span data-stu-id="2e3df-156">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="2e3df-157">**XmlResolver**類別所使用**XmlDocument**正由相同**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-157">The **XmlResolver** class used by the **XmlDocument** is the same one being used by the **XmlReader**.</span></span>|<span data-ttu-id="2e3df-158">**XmlDocument**使用**XmlResolver** ，已指派給**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-158">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="2e3df-159">**XmlDocument.Resolver**屬性不可設定，而不論**XmlDocument**信任層級，因為它即將**XmlResolver**從**XmlReader**。</span><span class="sxs-lookup"><span data-stu-id="2e3df-159">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="2e3df-160">您無法嘗試覆寫的設定**Xmldocument** **XmlResolver**藉由設定**XmlResolver**屬性**XmlDocument**.</span><span class="sxs-lookup"><span data-stu-id="2e3df-160">You cannot attempt to override the settings of the **XmlReaders** **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="2e3df-161">**XmlReader**可以**XmlTextReader**、 驗證<xref:System.Xml.XmlReader>，或自訂撰寫的讀取器。</span><span class="sxs-lookup"><span data-stu-id="2e3df-161">The **XmlReader** can be the **XmlTextReader**, validating <xref:System.Xml.XmlReader>, or a custom-written reader.</span></span> <span data-ttu-id="2e3df-162">如果所用的讀取器支援實體解析，則會解析外部實體。</span><span class="sxs-lookup"><span data-stu-id="2e3df-162">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="2e3df-163">如果傳遞的讀取器不支援實體參考，則不會解析實體參考。</span><span class="sxs-lookup"><span data-stu-id="2e3df-163">If the reader passed in does not support entity references, then entity references are not resolved.</span></span>|  
  
 <span data-ttu-id="2e3df-164">設定 XmlResolver 使其含有正確的認證，即可存取外部資源。</span><span class="sxs-lookup"><span data-stu-id="2e3df-164">Setting the XmlResolver to contain the correct credentials allows access to external resources.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="2e3df-165">沒有任何方法來擷取**XmlResolver**屬性。</span><span class="sxs-lookup"><span data-stu-id="2e3df-165">There is no way to retrieve the **XmlResolver** property.</span></span> <span data-ttu-id="2e3df-166">這有助於防止使用者重複使用**XmlResolver**上的認證已設定。</span><span class="sxs-lookup"><span data-stu-id="2e3df-166">This helps to prevent a user from reusing an **XmlResolver** on which credentials have been set.</span></span> <span data-ttu-id="2e3df-167">此外，如果**XmlTextReader**或驗證<xref:System.Xml.XmlReader>用來載入**XmlDocument**和**XmlDocument**具有已設定，從解析程式的解析程式這些讀取器不會快取**XmlDocument**之後**負載**階段，因為這也意謂著安全性風險。</span><span class="sxs-lookup"><span data-stu-id="2e3df-167">Also, if an **XmlTextReader** or validating <xref:System.Xml.XmlReader> is used to load the **XmlDocument** and the **XmlDocument** has a resolver that has been set, the resolvers from these readers are not cached by the **XmlDocument** after the **Load** phase, since this also presents a security risk.</span></span>  
  
 <span data-ttu-id="2e3df-168">如需詳細資訊，請參閱 <xref:System.Xml.XmlResolver> 參考頁面的＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="2e3df-168">For more information, see the Remarks section of the <xref:System.Xml.XmlResolver> reference page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="2e3df-169">另請參閱</span><span class="sxs-lookup"><span data-stu-id="2e3df-169">See Also</span></span>  
 [<span data-ttu-id="2e3df-170">XML 文件物件模型 (DOM)</span><span class="sxs-lookup"><span data-stu-id="2e3df-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
