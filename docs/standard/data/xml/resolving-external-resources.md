---
title: 解析外部資源
ms.date: 03/30/2017
ms.technology: dotnet-standard
ms.assetid: ad3fa320-4b8f-4e5c-b549-01157591007a
ms.openlocfilehash: 05cc41cef7da07581d4f0ec8e584858b913d1a80
ms.sourcegitcommit: 5f236cd78cf09593c8945a7d753e0850e96a0b80
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/07/2020
ms.locfileid: "75710267"
---
# <a name="resolving-external-resources"></a><span data-ttu-id="aae2b-102">解析外部資源</span><span class="sxs-lookup"><span data-stu-id="aae2b-102">Resolving External Resources</span></span>
<span data-ttu-id="aae2b-103">**XmlDocument** 類別可以使用 **XmlDocument** 的 **XmlResolver** 屬性尋找沒有內嵌到 XML 資料的資源，例如外部文件類型定義 (DTD)、實體和結構描述。</span><span class="sxs-lookup"><span data-stu-id="aae2b-103">The **XmlResolver** property of the **XmlDocument** is used by the **XmlDocument** class to locate resources that are not inline in the XML data, such as external document type definitions (DTDs), entities, and schemas.</span></span> <span data-ttu-id="aae2b-104">這些項目可位於網路或本機磁碟上，並且可以由統一資源識別元 (URI) 辨識。</span><span class="sxs-lookup"><span data-stu-id="aae2b-104">These items can be located on a network or on a local drive, and are identifiable by a Uniform Resource Identifier (URI).</span></span> <span data-ttu-id="aae2b-105">如此可讓 **XmlDocument** 解析文件中出現的 **EntityReference** 節點，並依據外部 DTD 或結構描述驗證文件。</span><span class="sxs-lookup"><span data-stu-id="aae2b-105">This allows the **XmlDocument** to resolve **EntityReference** nodes that are present in the document and validate the document according to the external DTD or schema.</span></span>  
  
## <a name="fully-trusted-xmldocument"></a><span data-ttu-id="aae2b-106">完全信任的 XmlDocument</span><span class="sxs-lookup"><span data-stu-id="aae2b-106">Fully-Trusted XmlDocument</span></span>  
 <span data-ttu-id="aae2b-107">**XmlResolver** 屬性會影響 **XmlDocument.Load** 方法的功能。</span><span class="sxs-lookup"><span data-stu-id="aae2b-107">The **XmlResolver** property affects the functionality of the **XmlDocument.Load** method.</span></span> <span data-ttu-id="aae2b-108">下表顯示，在 **XmlDocument** 物件是完全受信任時，**XmlDocument.XmlResolver** 屬性將會如何運作。</span><span class="sxs-lookup"><span data-stu-id="aae2b-108">The table below shows how the **XmlDocument.XmlResolver** property works when the **XmlDocument** object is fully trusted.</span></span> <span data-ttu-id="aae2b-109">下表說明當 Load 的輸入為 **TextReader**、**String**、**Stream** 或 **URI** 時的 **XmlDocument.Load** 方法。</span><span class="sxs-lookup"><span data-stu-id="aae2b-109">The following table shows the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="aae2b-110">如果 **XmlDocument** 是從 **XmlReader** 載入，則這個表格不適用於 **Load** 方法。</span><span class="sxs-lookup"><span data-stu-id="aae2b-110">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="aae2b-111">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="aae2b-111">XmlResolver property</span></span>|<span data-ttu-id="aae2b-112">函數</span><span class="sxs-lookup"><span data-stu-id="aae2b-112">Function</span></span>|<span data-ttu-id="aae2b-113">注意事項</span><span class="sxs-lookup"><span data-stu-id="aae2b-113">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="aae2b-114">屬性設定為之前已建立的 **XmlResolver** 類別，而這個類別已經有由使用者設定好的屬性。</span><span class="sxs-lookup"><span data-stu-id="aae2b-114">The property is set to an **XmlResolver** class that has been previously created and has properties already set on it by the user.</span></span>|<span data-ttu-id="aae2b-115">**XmlDocument** 使用的 **XmlResolver**，是指定用來解析檔案名稱、解析外部資源的參考 (例如 DTD、實體和結構描述)。</span><span class="sxs-lookup"><span data-stu-id="aae2b-115">The **XmlDocument** uses the **XmlResolver** that is given to resolve file names, to resolve references to external resources such as DTDs, entities, and schemas.</span></span><br /><br /> <span data-ttu-id="aae2b-116">當解析在加入或編輯 **XmlDocument** 中節點必要的外部資源時，也會使用 **XmlResolver**。</span><span class="sxs-lookup"><span data-stu-id="aae2b-116">The **XmlResolver** is also used when resolving external resources that are needed when adding or editing nodes in the **XmlDocument**.</span></span>|<span data-ttu-id="aae2b-117">每當您要尋找並解析外部資源時，就必須使用指定給 **XmlDocument** 之 **XmlResolver** 解析程式。</span><span class="sxs-lookup"><span data-stu-id="aae2b-117">The **XmlResolver** given to the **XmlDocument** is the resolver that is used whenever external resources need to be located and resolved.</span></span>|  
|<span data-ttu-id="aae2b-118">屬性會設定為 **null** (在 Microsoft Visual Basic .NET中則為 **Nothing**)。</span><span class="sxs-lookup"><span data-stu-id="aae2b-118">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="aae2b-119">不支援需要外部資源的功能，例如尋找外部結構描述或 DTD。</span><span class="sxs-lookup"><span data-stu-id="aae2b-119">Features that require an external resource are not supported, such as locating an external schema, or DTD.</span></span> <span data-ttu-id="aae2b-120">也不會解析外部實體，並且也不支援執行編輯功能 (例如插入需要解析的實體節點)。</span><span class="sxs-lookup"><span data-stu-id="aae2b-120">Nor will external entities be resolved, and performing editing functions, such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="aae2b-121">**XmlDocument** 將檔案以匿名載入，並且不會嘗試解析任何其他的資源。</span><span class="sxs-lookup"><span data-stu-id="aae2b-121">The **XmlDocument** loads files as anonymous and does not attempt to resolve any other resources.</span></span>|  
|<span data-ttu-id="aae2b-122">尚未設定屬性，但是保留為預設狀態。</span><span class="sxs-lookup"><span data-stu-id="aae2b-122">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="aae2b-123">在解析檔案名稱、尋找外部 DTD、實體和結構描述時，帶有 NULL 認證的 **XmlUrlResolver** 會被具現化，並且被 **XmlDocument** 使用，同時在編輯節點時會使用 **null** 認證。</span><span class="sxs-lookup"><span data-stu-id="aae2b-123">An **XmlUrlResolver** with NULL credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>||  
  
 <span data-ttu-id="aae2b-124">下表說明當 **Load** 的輸入是 **XmlReader**，且 **XmlDocument** 是完全受信任時的 **XmlDocument.Load** 方法。</span><span class="sxs-lookup"><span data-stu-id="aae2b-124">The following table shows the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader** and the **XmlDocument** is fully trusted.</span></span>  
  
|<span data-ttu-id="aae2b-125">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="aae2b-125">XmlResolver property</span></span>|<span data-ttu-id="aae2b-126">函數</span><span class="sxs-lookup"><span data-stu-id="aae2b-126">Function</span></span>|<span data-ttu-id="aae2b-127">注意事項</span><span class="sxs-lookup"><span data-stu-id="aae2b-127">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="aae2b-128">**XmlDocument** 使用的 **XmlResolver** 類別與 **XmlReader** 使用的類別相同。</span><span class="sxs-lookup"><span data-stu-id="aae2b-128">The **XmlResolver** class used by the **XmlDocument** is the same class being used by the **XmlReader**.</span></span>|<span data-ttu-id="aae2b-129">**XmlDocument** 使用指定給 **XmlReader** 的 **XmlResolver**。</span><span class="sxs-lookup"><span data-stu-id="aae2b-129">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="aae2b-130">因為 **XmlDocument.Resolver** 是從 **XmlReader** 取得 **XmlResolver**，所以不論 **XmlDocument** 的信任層級為何，其屬性都無法設定。</span><span class="sxs-lookup"><span data-stu-id="aae2b-130">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="aae2b-131">您無法藉由設定 **XmlDocument** 的 **XmlResolver** 屬性，來覆寫 **XmlReader** 的 **XmlResolver** 的設定。</span><span class="sxs-lookup"><span data-stu-id="aae2b-131">You cannot attempt to override the settings of the **XmlReaders**' **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="aae2b-132">**XmlReader** 可能是 **XmlTextReader**、**XmlValidatingReader** 或自訂撰寫的讀取器。</span><span class="sxs-lookup"><span data-stu-id="aae2b-132">The **XmlReader** can be the **XmlTextReader**, **XmlValidatingReader**, or a custom-written reader.</span></span> <span data-ttu-id="aae2b-133">如果所用的讀取器支援實體解析，則會解析外部實體。</span><span class="sxs-lookup"><span data-stu-id="aae2b-133">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="aae2b-134">如果傳遞的讀取器不支援實體參考，則不會解析實體參考。</span><span class="sxs-lookup"><span data-stu-id="aae2b-134">If the reader passed does not support entity references, then entity references are not resolved.</span></span>|  
  
## <a name="semi-trusted-xmldocument"></a><span data-ttu-id="aae2b-135">非完全信任的 XmlDocument</span><span class="sxs-lookup"><span data-stu-id="aae2b-135">Semi-Trusted XmlDocument</span></span>  
 <span data-ttu-id="aae2b-136">下表顯示當物件是非完全信任時，**XmlDocument.XmlResolver** 屬性如何運作。</span><span class="sxs-lookup"><span data-stu-id="aae2b-136">The following table shows how the **XmlDocument.XmlResolver** property works when the object is semi-trusted.</span></span> <span data-ttu-id="aae2b-137">當 Load 的輸入為 **TextReader**、**String**、**Stream** 或 **URI** 時，此表格即適用於 **XmlDocument.Load** 方法。</span><span class="sxs-lookup"><span data-stu-id="aae2b-137">This table applies to the **XmlDocument.Load** methods when the input to the Load is a **TextReader**, **String**, **Stream**, or **URI**.</span></span> <span data-ttu-id="aae2b-138">如果 **XmlDocument** 是從 **XmlReader** 載入，則這個表格不適用於 **Load** 方法。</span><span class="sxs-lookup"><span data-stu-id="aae2b-138">This table does not apply to the **Load** method if the **XmlDocument** is loaded from an **XmlReader**.</span></span>  
  
|<span data-ttu-id="aae2b-139">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="aae2b-139">XmlResolver property</span></span>|<span data-ttu-id="aae2b-140">函數</span><span class="sxs-lookup"><span data-stu-id="aae2b-140">Function</span></span>|<span data-ttu-id="aae2b-141">注意事項</span><span class="sxs-lookup"><span data-stu-id="aae2b-141">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="aae2b-142">在非完全信任的案例中，**XmlResolver** 屬性只能設定為 Null。</span><span class="sxs-lookup"><span data-stu-id="aae2b-142">In the semi-trusted scenario, the **XmlResolver** property cannot be set to anything other than null.</span></span>|<span data-ttu-id="aae2b-143">在解析檔案名稱、尋找外部 DTD、實體和結構描述時，帶有 **null** 認證的 **XmlUrlResolver** 會被具現化，並且被 **XmlDocument** 使用，同時在編輯節點時會使用 **null** 認證。</span><span class="sxs-lookup"><span data-stu-id="aae2b-143">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="aae2b-144">這個行為和 **XmlResolver** 屬性沒有設定並保留為預設狀態時的行為相同。</span><span class="sxs-lookup"><span data-stu-id="aae2b-144">This behavior is identical to the behavior when the **XmlResolver** property is not set, but left in its default state.</span></span><br /><br /> <span data-ttu-id="aae2b-145">**XmlDocument** 使用匿名權限執行所有的動作。</span><span class="sxs-lookup"><span data-stu-id="aae2b-145">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
|<span data-ttu-id="aae2b-146">屬性會設定為 **null** (在 Microsoft Visual Basic .NET中則為 **Nothing**)。</span><span class="sxs-lookup"><span data-stu-id="aae2b-146">The property is set to **null** (**Nothing** in Microsoft Visual Basic .NET).</span></span>|<span data-ttu-id="aae2b-147">不支援需要外部資源的功能，例如尋找外部結構描述或 DTD。</span><span class="sxs-lookup"><span data-stu-id="aae2b-147">No features that require an external resource are supported, such as locating an external schema or DTD.</span></span> <span data-ttu-id="aae2b-148">也不會解析外部實體，並且也不支援執行編輯功能，例如插入需要資源的實體節點。</span><span class="sxs-lookup"><span data-stu-id="aae2b-148">Nor will external entities be resolved, and performing editing functions such as inserting entity nodes that require resolution, are not supported.</span></span>|<span data-ttu-id="aae2b-149">若屬性是 **null**，則不論 **XmlDocument** 是完全受信任或非完全受信任，都會有相同的行為。</span><span class="sxs-lookup"><span data-stu-id="aae2b-149">When the property is **null**, the behavior is the same regardless if the **XmlDocument** is fully trusted or semi-trusted.</span></span>|  
|<span data-ttu-id="aae2b-150">尚未設定屬性，但是保留為預設狀態。</span><span class="sxs-lookup"><span data-stu-id="aae2b-150">The property is not set, but left in its default state.</span></span>|<span data-ttu-id="aae2b-151">在解析檔案名稱、尋找外部 DTD、實體和結構描述時，帶有 **null** 認證的 **XmlUrlResolver** 會被具現化，並且被 **XmlDocument** 使用，同時在編輯節點時會使用 **null** 認證。</span><span class="sxs-lookup"><span data-stu-id="aae2b-151">An **XmlUrlResolver** with **null** credentials will be instantiated and used by the **XmlDocument** when resolving file names, locating external DTDs, entities, and schemas, and **null** credentials are used when editing nodes.</span></span>|<span data-ttu-id="aae2b-152">**XmlDocument** 使用匿名權限執行所有的動作。</span><span class="sxs-lookup"><span data-stu-id="aae2b-152">The **XmlDocument** uses anonymous permissions for all actions.</span></span>|  
  
 <span data-ttu-id="aae2b-153">當 **Load** 的輸入為 **XmlReader** 並且 **XmlDocument** 是非完全信任時，這個表格適用於 **XmlDocument.Load** 方法。</span><span class="sxs-lookup"><span data-stu-id="aae2b-153">This table applies to the **XmlDocument.Load** method when the input to the **Load** is an **XmlReader**, and the **XmlDocument** is semi-trusted.</span></span>  
  
|<span data-ttu-id="aae2b-154">XmlResolver 屬性</span><span class="sxs-lookup"><span data-stu-id="aae2b-154">XmlResolver property</span></span>|<span data-ttu-id="aae2b-155">函數</span><span class="sxs-lookup"><span data-stu-id="aae2b-155">Function</span></span>|<span data-ttu-id="aae2b-156">注意事項</span><span class="sxs-lookup"><span data-stu-id="aae2b-156">Notes</span></span>|  
|--------------------------|--------------|-----------|  
|<span data-ttu-id="aae2b-157">**XmlDocument** 使用的 **XmlResolver** 類別與 **XmlReader** 使用的類別相同。</span><span class="sxs-lookup"><span data-stu-id="aae2b-157">The **XmlResolver** class used by the **XmlDocument** is the same one being used by the **XmlReader**.</span></span>|<span data-ttu-id="aae2b-158">**XmlDocument** 使用指定給 **XmlReader** 的 **XmlResolver**。</span><span class="sxs-lookup"><span data-stu-id="aae2b-158">The **XmlDocument** uses the **XmlResolver** that was assigned to the **XmlReader**.</span></span><br /><br /> <span data-ttu-id="aae2b-159">因為 **XmlDocument.Resolver** 是從 **XmlReader** 取得 **XmlResolver**，所以不論 **XmlDocument** 的信任層級為何，其屬性都無法設定。</span><span class="sxs-lookup"><span data-stu-id="aae2b-159">The **XmlDocument.Resolver** property cannot be set, regardless of the **XmlDocument** trust level, because it is getting an **XmlResolver** from the **XmlReader**.</span></span> <span data-ttu-id="aae2b-160">您無法嘗試藉由設定**xmlreader** **XmlResolver**的**XmlResolver**屬性來覆寫這些**設定。**</span><span class="sxs-lookup"><span data-stu-id="aae2b-160">You cannot attempt to override the settings of the **XmlReaders** **XmlResolver** by setting the **XmlResolver** property of the **XmlDocument**.</span></span>|<span data-ttu-id="aae2b-161">**XmlReader** 可以是 **XmlTextReader**、驗證的 <xref:System.Xml.XmlReader> 或自訂撰寫的讀取器。</span><span class="sxs-lookup"><span data-stu-id="aae2b-161">The **XmlReader** can be the **XmlTextReader**, validating <xref:System.Xml.XmlReader>, or a custom-written reader.</span></span> <span data-ttu-id="aae2b-162">如果所用的讀取器支援實體解析，則會解析外部實體。</span><span class="sxs-lookup"><span data-stu-id="aae2b-162">If the reader used supports entity resolution, external entities are resolved.</span></span> <span data-ttu-id="aae2b-163">如果傳遞的讀取器不支援實體參考，則不會解析實體參考。</span><span class="sxs-lookup"><span data-stu-id="aae2b-163">If the reader passed in does not support entity references, then entity references are not resolved.</span></span>|  
  
 <span data-ttu-id="aae2b-164">設定 XmlResolver 使其含有正確的認證，即可存取外部資源。</span><span class="sxs-lookup"><span data-stu-id="aae2b-164">Setting the XmlResolver to contain the correct credentials allows access to external resources.</span></span>  
  
> [!NOTE]
> <span data-ttu-id="aae2b-165">您無法擷取 **XmlResolver** 屬性。</span><span class="sxs-lookup"><span data-stu-id="aae2b-165">There is no way to retrieve the **XmlResolver** property.</span></span> <span data-ttu-id="aae2b-166">這有助於防止使用者重複使用已經在其上設定安全性認證的 **XmlResolver**。</span><span class="sxs-lookup"><span data-stu-id="aae2b-166">This helps to prevent a user from reusing an **XmlResolver** on which credentials have been set.</span></span> <span data-ttu-id="aae2b-167">此外，若使用 **XmlTextReader** 或驗證的 <xref:System.Xml.XmlReader> 來載入 **XmlDocument**，且 **XmlDocument** 具有已經設定的解析程式，則 **XmlDocument** 在 **Load** 階段之後將不會快取這些讀取器的解析程式，因為這也會帶來安全性方面的風險。</span><span class="sxs-lookup"><span data-stu-id="aae2b-167">Also, if an **XmlTextReader** or validating <xref:System.Xml.XmlReader> is used to load the **XmlDocument** and the **XmlDocument** has a resolver that has been set, the resolvers from these readers are not cached by the **XmlDocument** after the **Load** phase, since this also presents a security risk.</span></span>  
  
 <span data-ttu-id="aae2b-168">如需詳細資訊，請參閱 <xref:System.Xml.XmlResolver> 參考頁面的＜備註＞一節。</span><span class="sxs-lookup"><span data-stu-id="aae2b-168">For more information, see the Remarks section of the <xref:System.Xml.XmlResolver> reference page.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="aae2b-169">請參閱</span><span class="sxs-lookup"><span data-stu-id="aae2b-169">See also</span></span>

- [<span data-ttu-id="aae2b-170">XML 文件物件模型 (DOM)</span><span class="sxs-lookup"><span data-stu-id="aae2b-170">XML Document Object Model (DOM)</span></span>](../../../../docs/standard/data/xml/xml-document-object-model-dom.md)
