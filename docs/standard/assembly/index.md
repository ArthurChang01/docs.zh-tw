---
title: .NET 中的組件
ms.date: 07/10/2018
ms.assetid: 149f5ca5-5b34-4746-9542-1ae43b2d0256
---
# <a name="assemblies-in-net"></a><span data-ttu-id="8a1a9-102">.NET 中的組件</span><span class="sxs-lookup"><span data-stu-id="8a1a9-102">Assemblies in .NET</span></span>

<span data-ttu-id="8a1a9-103">組件會構成 .NET 型應用程式之部署、版本控制、重複使用、啟動範圍和安全性權限的基本單位。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-103">Assemblies form the fundamental unit of deployment, version control, reuse, activation scoping, and security permissions for a .NET-based application.</span></span> <span data-ttu-id="8a1a9-104">組件會以可執行檔 (.exe) 或動態連結程式庫 (.dll) 檔案的形式呈現，而且是 .NET 應用程式的建置組塊。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-104">Assemblies take the form of an executable (.exe) file or dynamic link library (.dll) file, and are the building blocks of the .NET applications.</span></span> <span data-ttu-id="8a1a9-105">它們為通用語言執行平台提供了感知型別實作所需的資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-105">They provide the common language runtime with the information it needs to be aware of type implementations.</span></span> <span data-ttu-id="8a1a9-106">您可以將組件視為型別和資源的集合，其構成功能的邏輯單元，而且是為了共同運作而建置。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-106">You can think of an assembly as a collection of types and resources that form a logical unit of functionality and are built to work together.</span></span>

<span data-ttu-id="8a1a9-107">在 .NET Core 及 .NET Framework 中，一個組件可由一或多個原始程式碼檔案建置而成。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-107">In .NET Core and .NET Framework, an assembly can be built from one or more source code files.</span></span> <span data-ttu-id="8a1a9-108">在 .NET Framework 中，組件可以包含一或多個模組。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-108">In .NET Framework, assemblies can contain one or more modules.</span></span> <span data-ttu-id="8a1a9-109">如此便可以透過由個別開發人員處理不同原始程式碼檔案或模組，再將其合併來建立單一組件等方式，來規劃較大型的專案。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-109">This allows larger projects to be planned in such a way that several individual developers work on separate source code files or modules, which are combined to create a single assembly.</span></span> <span data-ttu-id="8a1a9-110">如需模組的詳細資訊，請參閱[如何：建置多檔案組件](../../framework/app-domains/how-to-build-a-multifile-assembly.md)主題。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-110">For more information about modules, see [How to: Build a Multifile Assembly](../../framework/app-domains/how-to-build-a-multifile-assembly.md).</span></span>

<span data-ttu-id="8a1a9-111">組件包含下列屬性：</span><span class="sxs-lookup"><span data-stu-id="8a1a9-111">Assemblies have the following properties:</span></span>

- <span data-ttu-id="8a1a9-112">組件會實作為 .exe 或 .dll 檔。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-112">Assemblies are implemented as .exe or .dll files.</span></span>

- <span data-ttu-id="8a1a9-113">針對以 .NET Framework 為目標的程式庫，您可以藉由將組件放進[全域組件快取](../../framework/app-domains/gac.md)，在應用程式之間共用組件。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-113">For libraries that target the .NET Framework, you can share an assembly between applications by putting it in the [global assembly cache](../../framework/app-domains/gac.md).</span></span> <span data-ttu-id="8a1a9-114">組件必須經強式命名後才能包含在全域組件快取內。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-114">Assemblies must be strong-named before they can be included in the global assembly cache.</span></span> <span data-ttu-id="8a1a9-115">如需詳細資訊，請參閱[強式名稱的組件](../../framework/app-domains/strong-named-assemblies.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-115">For more information, see [Strong-Named Assemblies](../../framework/app-domains/strong-named-assemblies.md).</span></span>

- <span data-ttu-id="8a1a9-116">系統只會在需要時才將組件載入到記憶體。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-116">Assemblies are only loaded into memory if they are required.</span></span> <span data-ttu-id="8a1a9-117">如果不使用，則不會予以載入。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-117">If they are not used, they are not loaded.</span></span> <span data-ttu-id="8a1a9-118">這表示使用組件可以有效地管理大型專案中的資源。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-118">This means that assemblies can be an efficient way to manage resources in larger projects.</span></span>

- <span data-ttu-id="8a1a9-119">藉由使用反映，您能以程式設計方式取得組件的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-119">You can programmatically obtain information about an assembly by using reflection.</span></span> <span data-ttu-id="8a1a9-120">如需詳細資訊，請參閱[反映 (C#)](../../csharp/programming-guide/concepts/reflection.md) 或 [Reflection (Visual Basic)](../../visual-basic/programming-guide/concepts/reflection.md) (反映 (Visual Basic))。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-120">For more information, see [Reflection (C#)](../../csharp/programming-guide/concepts/reflection.md) or [Reflection (Visual Basic)](../../visual-basic/programming-guide/concepts/reflection.md).</span></span>

- <span data-ttu-id="8a1a9-121">您可以藉由呼叫方法 <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A?displayProperty=nameWithType>，來僅為了檢查組件載入該組件。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-121">You can load an assembly only to inspect it by calling a method <xref:System.Reflection.Assembly.ReflectionOnlyLoadFrom%2A?displayProperty=nameWithType>.</span></span>

## <a name="assembly-manifest"></a><span data-ttu-id="8a1a9-122">資訊清單</span><span class="sxs-lookup"><span data-stu-id="8a1a9-122">Assembly manifest</span></span>

<span data-ttu-id="8a1a9-123">每個組件內都有「組件資訊清單」。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-123">Within every assembly is an *assembly manifest*.</span></span> <span data-ttu-id="8a1a9-124">類似於目錄，組件資訊清單包含下列資訊︰</span><span class="sxs-lookup"><span data-stu-id="8a1a9-124">Similar to a table of contents, the assembly manifest contains the following:</span></span>

- <span data-ttu-id="8a1a9-125">組件的身分識別 (其名稱和版本)。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-125">The assembly's identity (its name and version).</span></span>

- <span data-ttu-id="8a1a9-126">一個檔案表格，描述構成該組件的所有其他檔案，例如由您建立且您 .exe 或 .dll 檔案所依賴的其他組件，甚至是點陣圖或讀我檔案。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-126">A file table describing all the other files that make up the assembly, such as other assemblies you created that your .exe or .dll file relies on, or even bitmap or Readme files.</span></span>

- <span data-ttu-id="8a1a9-127">一個「組件參考清單」，它是所有外部相依性的清單，可能是由他人建立而您應用程式需要的 .dll 或其他檔案。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-127">An *assembly reference list*, which is a list of all external dependencies — .dlls or other files your application needs that may have been created by someone else.</span></span> <span data-ttu-id="8a1a9-128">組件參考同時包含全域和私用物件的參考。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-128">Assembly references contain references to both global and private objects.</span></span> <span data-ttu-id="8a1a9-129">所有其他應用程式皆可使用全域物件。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-129">Global objects are available to all other applications.</span></span> <span data-ttu-id="8a1a9-130">在 .NET Core 中，它們會與特定的 .NET Core 執行階段結合。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-130">In .NET Core, they are coupled with a particular .NET Core runtime.</span></span> <span data-ttu-id="8a1a9-131">在 .NET Framework 中，它們位於全域組件快取內。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-131">In .NET Framework, they reside in the global assembly cache.</span></span> <span data-ttu-id="8a1a9-132"><xref:System.IO?displayProperty=nameWithType> 命名空間就是全域組件快取中組件的一個例子。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-132">The <xref:System.IO?displayProperty=nameWithType> namespace is an example of an assembly in the global assembly cache.</span></span> <span data-ttu-id="8a1a9-133">私用物件必須同樣位在您的應用程式安裝目錄中或位在其底下的目錄。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-133">Private objects must be in a directory at either the same level as or below the directory in which your application is installed.</span></span>

<span data-ttu-id="8a1a9-134">因為組件包含內容、版本設定及相依性的相關資訊，所以使用它們的應用程式不需依賴 Windows 登錄值就能正常運作。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-134">Because assemblies contain information about content, versioning, and dependencies, the applications that use them need not rely don Windows registry values to function properly.</span></span> <span data-ttu-id="8a1a9-135">組件可減少 .dll 衝突，並讓您的應用程式更可靠，也更容易部署。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-135">Assemblies reduce .dll conflicts and make your applications more reliable and easier to deploy.</span></span> <span data-ttu-id="8a1a9-136">在許多情況下，您只要將 .NET 型應用程式的檔案複製到目標電腦，即完成安裝。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-136">In many cases, you can install a .NET-based application simply by copying its files to the target computer.</span></span> <span data-ttu-id="8a1a9-137">如需詳細資訊，請參閱[資訊清單](../../framework/app-domains/assembly-manifest.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-137">For more information, see [Assembly Manifest](../../framework/app-domains/assembly-manifest.md).</span></span>

## <a name="adding-a-reference-to-an-assembly"></a><span data-ttu-id="8a1a9-138">將參考新增至組件</span><span class="sxs-lookup"><span data-stu-id="8a1a9-138">Adding a reference to an assembly</span></span>

<span data-ttu-id="8a1a9-139">若要使用組件，您必須加入對它的參考。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-139">To use an assembly, you must add a reference to it.</span></span> <span data-ttu-id="8a1a9-140">接著，您可以針對 C# 使用 [using 指示詞](../../csharp/language-reference/keywords/using-directive.md)，或針對 Visual Basic 使用 [Imports 陳述式](../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md)，來選擇您欲使用項目的命名空間。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-140">Next, you can use the [using directive](../../csharp/language-reference/keywords/using-directive.md) for C# or [Imports statement](../../visual-basic/language-reference/statements/imports-statement-net-namespace-and-type.md) for Visual Basic to choose the namespace of the items you want to use.</span></span> <span data-ttu-id="8a1a9-141">在參考並匯入組件後，您的應用程式即可使用其所有可存取的類型、屬性、方法及命名空間的其他成員，他們的程式碼就如同您來源檔案的一部分。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-141">Once an assembly is referenced and imported, all the accessible types, properties, methods, and other members of its namespaces are available to your application as if their code were part of your source file.</span></span>

> [!NOTE]
> <span data-ttu-id="8a1a9-142">系統會自動參考 .NET 類別庫中的大多數組件。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-142">Most assemblies from the .NET Class Library are referenced automatically.</span></span> <span data-ttu-id="8a1a9-143">然而在某些情況下，有些系統組件不會受到自動參考。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-143">In some cases, though, a system assembly may not automatically be referenced.</span></span> <span data-ttu-id="8a1a9-144">在 .NET Core 中，您可以藉由使用 Visual Studio 中的 NuGet 套件管理員，或將組件的 [<PackageReference>](../../core/tools/dependencies.md#the-new-packagereference-element) 元素新增至 \*.csproj 或 \*.vbproj 專案中，來將參考新增至包含該組件的 NuGet 套件。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-144">In .NET Core, you can add a reference to the NuGet package that contains the assembly either by using NuGet Package Manager in Visual Studio or by adding a [<PackageReference>](../../core/tools/dependencies.md#the-new-packagereference-element) element for the assembly to the \*.csproj or \*.vbproj project.</span></span> <span data-ttu-id="8a1a9-145">在 .NET Framework 中，您可以藉由使用 Visual Studio 中的 [新增參考] 對話方塊，或使用 [C#](../../csharp/language-reference/compiler-options/reference-compiler-option.md) 或 [Visual Basic](../../visual-basic/reference/command-line-compiler/reference.md) 編譯器的 `-reference` 命令列選項，來將參考新增至組件。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-145">In .NET Framework, you can add a reference to the assembly by using the **Add Reference** dialog in Visual Studio or by using the `-reference` command line option for the [C#](../../csharp/language-reference/compiler-options/reference-compiler-option.md) or [Visual Basic](../../visual-basic/reference/command-line-compiler/reference.md) compilers.</span></span>

<span data-ttu-id="8a1a9-146">在 C# 中，您也可以在單一應用程式中使用同一組件的兩種版本。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-146">In C#, you can also use two versions of the same assembly in a single application.</span></span> <span data-ttu-id="8a1a9-147">如需詳細資訊，請參閱[外部別名](../../csharp/language-reference/keywords/extern-alias.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-147">For more information, see [extern alias](../../csharp/language-reference/keywords/extern-alias.md).</span></span>

## <a name="creating-an-assembly"></a><span data-ttu-id="8a1a9-148">建立組件</span><span class="sxs-lookup"><span data-stu-id="8a1a9-148">Creating an assembly</span></span>

<span data-ttu-id="8a1a9-149">請藉由在 Visual Studio 中建置應用程式、使用 .NET Core 命令列介面 (CLI) 從命令列建置應用程式，或使用命令列編譯器建置 .NET Framework 組件，來編譯您的應用程式。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-149">Compile your application by building it in Visual Studio, by building it from the command line by using .NET Core command-line interface (CLI) tools, or by building .NET Framework assemblies with a command-line compiler.</span></span> <span data-ttu-id="8a1a9-150">如需使用 .NET CLI 工具建置組件的詳細資訊，請參閱 [.NET Core 命令列介面 (CLI) 工具](../../core/tools/index.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-150">For more information about building assemblies using .NET CLI tools, see [.NET Core command-line interface (CLI) tools](../../core/tools/index.md).</span></span> <span data-ttu-id="8a1a9-151">如需使用命令列編譯器建置組件的資訊，針對 C# 請參閱[使用 csc.exe 建置命令列](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md)，針對 Visual Basic 請參閱[從命令列建置](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md)。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-151">For building assemblies with the command-line compilers, see [Command-line build with csc.exe](../../csharp/language-reference/compiler-options/command-line-building-with-csc-exe.md) for C# and [Building from the Command Line](../../visual-basic/reference/command-line-compiler/building-from-the-command-line.md) for Visual Basic.</span></span>

> [!NOTE]
> <span data-ttu-id="8a1a9-152">若要在 Visual Studio 中建置組件，請在[建置] 功能表中選擇 [建置]。</span><span class="sxs-lookup"><span data-stu-id="8a1a9-152">To build an assembly in Visual Studio, on the **Build** menu choose **Build**.</span></span>

## <a name="see-also"></a><span data-ttu-id="8a1a9-153">另請參閱</span><span class="sxs-lookup"><span data-stu-id="8a1a9-153">See also</span></span>

- [<span data-ttu-id="8a1a9-154">.NET 組件檔格式</span><span class="sxs-lookup"><span data-stu-id="8a1a9-154">.NET assembly file format</span></span>](file-format.md)
- [<span data-ttu-id="8a1a9-155">Common Language Runtime 中的組件</span><span class="sxs-lookup"><span data-stu-id="8a1a9-155">Assemblies in the Common Language Runtime</span></span>](../../framework/app-domains/assemblies-in-the-common-language-runtime.md)
- [<span data-ttu-id="8a1a9-156">Friend 組件</span><span class="sxs-lookup"><span data-stu-id="8a1a9-156">Friend Assemblies</span></span>](friend-assemblies.md)
- [<span data-ttu-id="8a1a9-157">如何：載入和卸載組件 (C#)</span><span class="sxs-lookup"><span data-stu-id="8a1a9-157">How to: Load and Unload Assemblies (C#)</span></span>](../../csharp/programming-guide/concepts/assemblies-gac/how-to-load-and-unload-assemblies.md)
- [<span data-ttu-id="8a1a9-158">如何：載入和卸載組件 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="8a1a9-158">How to: Load and Unload Assemblies (Visual Basic)</span></span>](../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-load-and-unload-assemblies.md)
- [<span data-ttu-id="8a1a9-159">如何：在 .NET Core 中使用組件解除載入性及進行偵錯</span><span class="sxs-lookup"><span data-stu-id="8a1a9-159">How to: Use and Debug Assembly Unloadability in .NET Core</span></span>](unloadability-howto.md)
- [<span data-ttu-id="8a1a9-160">如何：判斷檔案是否為組件 (C#)</span><span class="sxs-lookup"><span data-stu-id="8a1a9-160">How to: Determine If a File Is an Assembly (C#)</span></span>](../../csharp/programming-guide/concepts/assemblies-gac/how-to-determine-if-a-file-is-an-assembly.md)
- [<span data-ttu-id="8a1a9-161">如何：判斷檔案是否為組件 (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="8a1a9-161">How to: Determine If a File Is an Assembly (Visual Basic)</span></span>](../../visual-basic/programming-guide/concepts/assemblies-gac/how-to-determine-if-a-file-is-an-assembly.md)
