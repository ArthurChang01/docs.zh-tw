---
title: 在規則運算式中執行替代
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- regular expressions, substitutions
- replacement patterns
- metacharacters, substitutions
- .NET Framework regular expressions, substitutions
- constructs, substitutions
- substitutions
ms.assetid: d1f52431-1c7d-4dc6-8792-6b988256892e
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 51e22407bd20cc6aa17b242948a83d698167590e
ms.sourcegitcommit: 3b9b7ae6771712337d40374d2fef6b25b0d53df6
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 01/04/2019
ms.locfileid: "54030150"
---
# <a name="substitutions-in-regular-expressions"></a><span data-ttu-id="c11ba-102">在規則運算式中執行替代</span><span class="sxs-lookup"><span data-stu-id="c11ba-102">Substitutions in Regular Expressions</span></span>
<a name="Top"></a> <span data-ttu-id="c11ba-103">替代是指只有在取代模式內才能辨識的語言項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-103">Substitutions are language elements that are recognized only within replacement patterns.</span></span> <span data-ttu-id="c11ba-104">這些項目使用規則運算式模式定義要取代輸入字串中相符文字的全部或部分文字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-104">They use a regular expression pattern to define all or part of the text that is to replace matched text in the input string.</span></span> <span data-ttu-id="c11ba-105">取代模式可以包含一個或多個替代，以及常值字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-105">The replacement pattern can consist of one or more substitutions along with literal characters.</span></span> <span data-ttu-id="c11ba-106">取代模式會提供給具有 `replacement` 參數的 <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> 方法多載，以及提供給 <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="c11ba-106">Replacement patterns are provided to overloads of the <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method that have a `replacement` parameter and to the <xref:System.Text.RegularExpressions.Match.Result%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="c11ba-107">這些方法會將符合的模式取代為 `replacement` 參數所定義的模式。</span><span class="sxs-lookup"><span data-stu-id="c11ba-107">The methods replace the matched pattern with the pattern that is defined by the `replacement` parameter.</span></span>  
  
 <span data-ttu-id="c11ba-108">.NET Framework 會定義下表列出的替代項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-108">The .NET Framework defines the substitution elements listed in the following table.</span></span>  
  
|<span data-ttu-id="c11ba-109">替代</span><span class="sxs-lookup"><span data-stu-id="c11ba-109">Substitution</span></span>|<span data-ttu-id="c11ba-110">說明</span><span class="sxs-lookup"><span data-stu-id="c11ba-110">Description</span></span>|  
|------------------|-----------------|  
|<span data-ttu-id="c11ba-111">`$` *數字*</span><span class="sxs-lookup"><span data-stu-id="c11ba-111">`$` *number*</span></span>|<span data-ttu-id="c11ba-112">包括在取代字串中與 *數字*所指定之擷取群組相符的最後一個子字串，其中 *數字* 是十進位值。</span><span class="sxs-lookup"><span data-stu-id="c11ba-112">Includes the last substring matched by the capturing group that is identified by *number*, where *number* is a decimal value, in the replacement string.</span></span> <span data-ttu-id="c11ba-113">如需詳細資訊，請參閱 [替代編號群組](#Numbered)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-113">For more information, see [Substituting a Numbered Group](#Numbered).</span></span>|  
|<span data-ttu-id="c11ba-114">`${` *name* `}`</span><span class="sxs-lookup"><span data-stu-id="c11ba-114">`${` *name* `}`</span></span>|<span data-ttu-id="c11ba-115">包括在取代字串中與 `(?<`*名稱*`> )` 所指定之具名群組相符的最後一個子字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-115">Includes the last substring matched by the named group that is designated by `(?<`*name*`> )` in the replacement string.</span></span> <span data-ttu-id="c11ba-116">如需詳細資訊，請參閱 [替代具名群組](#Named)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-116">For more information, see [Substituting a Named Group](#Named).</span></span>|  
|`$$`|<span data-ttu-id="c11ba-117">取代字串中包括單一 "$" 常值。</span><span class="sxs-lookup"><span data-stu-id="c11ba-117">Includes a single "$" literal in the replacement string.</span></span> <span data-ttu-id="c11ba-118">如需詳細資訊，請參閱 [替代 "$" 符號](#DollarSign)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-118">For more information, see [Substituting a "$" Symbol](#DollarSign).</span></span>|  
|`$&`|<span data-ttu-id="c11ba-119">取代字串中包括整個相符項目的複本。</span><span class="sxs-lookup"><span data-stu-id="c11ba-119">Includes a copy of the entire match in the replacement string.</span></span> <span data-ttu-id="c11ba-120">如需詳細資訊，請參閱 [替代整個相符項目](#EntireMatch)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-120">For more information, see [Substituting the Entire Match](#EntireMatch).</span></span>|  
|``$` ``|<span data-ttu-id="c11ba-121">取代字串中包括輸入字串中相符項目之前的所有文字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-121">Includes all the text of the input string before the match in the replacement string.</span></span> <span data-ttu-id="c11ba-122">如需詳細資訊，請參閱 [替代相符項目前的文字](#BeforeMatch)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-122">For more information, see [Substituting the Text before the Match](#BeforeMatch).</span></span>|  
|`$'`|<span data-ttu-id="c11ba-123">取代字串中包括輸入字串中相符項目之後的所有文字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-123">Includes all the text of the input string after the match in the replacement string.</span></span> <span data-ttu-id="c11ba-124">如需詳細資訊，請參閱 [替代相符項目後的文字](#AfterMatch)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-124">For more information, see [Substituting the Text after the Match](#AfterMatch).</span></span>|  
|`$+`|<span data-ttu-id="c11ba-125">取代字串中包括最後擷取的群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-125">Includes the last group captured in the replacement string.</span></span> <span data-ttu-id="c11ba-126">如需詳細資訊，請參閱 [替代最後擷取的群組](#LastGroup)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-126">For more information, see [Substituting the Last Captured Group](#LastGroup).</span></span>|  
|`$_`|<span data-ttu-id="c11ba-127">取代字串中包括整個輸入字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-127">Includes the entire input string in the replacement string.</span></span> <span data-ttu-id="c11ba-128">如需詳細資訊，請參閱 [替代整個輸入字串](#EntireString)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-128">For more information, see [Substituting the Entire Input String](#EntireString).</span></span>|  
  
## <a name="substitution-elements-and-replacement-patterns"></a><span data-ttu-id="c11ba-129">替代項目和取代模式</span><span class="sxs-lookup"><span data-stu-id="c11ba-129">Substitution Elements and Replacement Patterns</span></span>  
 <span data-ttu-id="c11ba-130">替代是取代模式中唯一能夠辨認的特殊建構。</span><span class="sxs-lookup"><span data-stu-id="c11ba-130">Substitutions are the only special constructs recognized in a replacement pattern.</span></span> <span data-ttu-id="c11ba-131">不支援其他規則運算式語言項目，包括逸出字元和符合任何字元的句號 (`.`)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-131">None of the other regular expression language elements, including character escapes and the period (`.`), which matches any character, are supported.</span></span> <span data-ttu-id="c11ba-132">同樣的，替代語言項目只有在取代模式中才能辨識，而且在規則運算式模式中永遠無效。</span><span class="sxs-lookup"><span data-stu-id="c11ba-132">Similarly, substitution language elements are recognized only in replacement patterns and are never valid in regular expression patterns.</span></span>  
  
 <span data-ttu-id="c11ba-133">唯一能夠在規則運算式模式或替代中出現的字元是 `$` 字元，不過它在這兩種內容中的意義不同。</span><span class="sxs-lookup"><span data-stu-id="c11ba-133">The only character that can appear either in a regular expression pattern or in a substitution is the `$` character, although it has a different meaning in each context.</span></span> <span data-ttu-id="c11ba-134">在規則運算式模式中， `$` 是比對字串結尾的錨點。</span><span class="sxs-lookup"><span data-stu-id="c11ba-134">In a regular expression pattern, `$` is an anchor that matches the end of the string.</span></span> <span data-ttu-id="c11ba-135">在取代模式中， `$` 表示替代開頭。</span><span class="sxs-lookup"><span data-stu-id="c11ba-135">In a replacement pattern, `$` indicates the beginning of a substitution.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="c11ba-136">如需規則運算式內類似取代模式的功能，請使用反向參考。</span><span class="sxs-lookup"><span data-stu-id="c11ba-136">For functionality similar to a replacement pattern within a regular expression, use a backreference.</span></span> <span data-ttu-id="c11ba-137">如需反向參考的詳細資訊，請參閱 [反向參考建構](../../../docs/standard/base-types/backreference-constructs-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-137">For more information about backreferences, see [Backreference Constructs](../../../docs/standard/base-types/backreference-constructs-in-regular-expressions.md).</span></span>  
  
<a name="Numbered"></a>   
## <a name="substituting-a-numbered-group"></a><span data-ttu-id="c11ba-138">替代編號群組</span><span class="sxs-lookup"><span data-stu-id="c11ba-138">Substituting a Numbered Group</span></span>  
 <span data-ttu-id="c11ba-139">`$`*數字* 語言項目包括取代字串中與 *數字* 擷取群組相符的最後一個子字串，其中 *數字* 是擷取群組的索引。</span><span class="sxs-lookup"><span data-stu-id="c11ba-139">The `$`*number* language element includes the last substring matched by the *number* capturing group in the replacement string, where *number* is the index of the capturing group.</span></span> <span data-ttu-id="c11ba-140">例如，取代模式 `$1` 表示第一個擷取的群組將取代相符的子字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-140">For example, the replacement pattern `$1` indicates that the matched substring is to be replaced by the first captured group.</span></span> <span data-ttu-id="c11ba-141">如需編號擷取群組的詳細資訊，請參閱 [Grouping Constructs](../../../docs/standard/base-types/grouping-constructs-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-141">For more information about numbered capturing groups, see [Grouping Constructs](../../../docs/standard/base-types/grouping-constructs-in-regular-expressions.md).</span></span>  
  
 <span data-ttu-id="c11ba-142">`$` 後面接著的所有數字都會解譯為屬於 *數字* 群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-142">All digits that follow `$` are interpreted as belonging to the *number* group.</span></span> <span data-ttu-id="c11ba-143">如果這不是您的目的，可以改為替代具名群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-143">If this is not your intent, you can substitute a named group instead.</span></span> <span data-ttu-id="c11ba-144">例如，您可以使用取代字串 `${1}1` 而非 `$11` ，將取代字串定義為第一個擷取之群組的值連同數字 "1"。</span><span class="sxs-lookup"><span data-stu-id="c11ba-144">For example, you can use the replacement string `${1}1` instead of `$11` to define the replacement string as the value of the first captured group along with the number "1".</span></span> <span data-ttu-id="c11ba-145">如需詳細資訊，請參閱 [替代具名群組](#Named)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-145">For more information, see [Substituting a Named Group](#Named).</span></span>  
  
 <span data-ttu-id="c11ba-146">未使用 `(?<`*名稱*`>)` 語法明確指派名稱的擷取群組，會從一開始由左至右編號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-146">Capturing groups that are not explicitly assigned names using the `(?<`*name*`>)` syntax are numbered from left to right starting at one.</span></span> <span data-ttu-id="c11ba-147">具名群組是從最後一個未命名群組的索引加一開始，由左至右編號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-147">Named groups are also numbered from left to right, starting at one greater than the index of the last unnamed group.</span></span> <span data-ttu-id="c11ba-148">例如，在規則運算式 `(\w)(?<digit>\d)`中， `digit` 具名群組的索引為 2。</span><span class="sxs-lookup"><span data-stu-id="c11ba-148">For example, in the regular expression `(\w)(?<digit>\d)`, the index of the `digit` named group is 2.</span></span>  
  
 <span data-ttu-id="c11ba-149">如果 *數字* 沒有指定在規則運算式模式中定義的有效擷取群組， `$`*數字* 就會解譯為用以取代每個相符項目的常值字元序列。</span><span class="sxs-lookup"><span data-stu-id="c11ba-149">If *number* does not specify a valid capturing group defined in the regular expression pattern, `$`*number* is interpreted as a literal character sequence that is used to replace each match.</span></span>  
  
 <span data-ttu-id="c11ba-150">下列範例使用 `$`*數字* 替代從十進位值中去除貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-150">The following example uses the `$`*number* substitution to strip the currency symbol from a decimal value.</span></span> <span data-ttu-id="c11ba-151">它會移除在貨幣數值的開頭或結尾找到的貨幣符號，並且辨識兩種最常見的十進位分隔符號 ("." 和 ",")。</span><span class="sxs-lookup"><span data-stu-id="c11ba-151">It removes currency symbols found at the beginning or end of a monetary value, and recognizes the two most common decimal separators ("." and ",").</span></span>  
  
 [!code-csharp[Conceptual.RegEx.Language.Substitutions#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/numberedgroup1.cs#1)]
 [!code-vb[Conceptual.RegEx.Language.Substitutions#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/numberedgroup1.vb#1)]  
  
 <span data-ttu-id="c11ba-152">規則運算式模式 `\p{Sc}*(\s?\d+[.,]?\d*)\p{Sc}*` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="c11ba-152">The regular expression pattern `\p{Sc}*(\s?\d+[.,]?\d*)\p{Sc}*` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="c11ba-153">模式</span><span class="sxs-lookup"><span data-stu-id="c11ba-153">Pattern</span></span>|<span data-ttu-id="c11ba-154">說明</span><span class="sxs-lookup"><span data-stu-id="c11ba-154">Description</span></span>|  
|-------------|-----------------|  
|`\p{Sc}*`|<span data-ttu-id="c11ba-155">比對零個或多個貨幣符號字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-155">Match zero or more currency symbol characters.</span></span>|  
|`\s?`|<span data-ttu-id="c11ba-156">比對零個或一個空白字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-156">Match zero or one white-space characters.</span></span>|  
|`\d+`|<span data-ttu-id="c11ba-157">比對一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-157">Match one or more decimal digits.</span></span>|  
|`[.,]?`|<span data-ttu-id="c11ba-158">比對零個或一個句號或逗號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-158">Match zero or one period or comma.</span></span>|  
|`\d*`|<span data-ttu-id="c11ba-159">比對零個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-159">Match zero or more decimal digits.</span></span>|  
|`(\s?\d+[.,]?\d*)`|<span data-ttu-id="c11ba-160">比對空白字元後面接著一個或多個十進位數字，再接零個或一個句號或逗號，最後再接零個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-160">Match a white space followed by one or more decimal digits, followed by zero or one period or comma, followed by zero or more decimal digits.</span></span> <span data-ttu-id="c11ba-161">這是第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-161">This is the first capturing group.</span></span> <span data-ttu-id="c11ba-162">由於取代模式為 `$1`，因此呼叫 <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> 方法會將整個相符的子字串取代為這個擷取的群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-162">Because the replacement pattern is `$1`, the call to the <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method replaces the entire matched substring with this captured group.</span></span>|  
  
 [<span data-ttu-id="c11ba-163">回到頁首</span><span class="sxs-lookup"><span data-stu-id="c11ba-163">Back to top</span></span>](#Top)  
  
<a name="Named"></a>   
## <a name="substituting-a-named-group"></a><span data-ttu-id="c11ba-164">替代具名群組</span><span class="sxs-lookup"><span data-stu-id="c11ba-164">Substituting a Named Group</span></span>  
 <span data-ttu-id="c11ba-165">`${`*名稱*`}` 語言項目會替代與 *稱* 擷取群組相符的最後一個子字串，其中 *稱* 稱是由 `(?<`*名稱*`>)` 語言項目定義之擷取群組的名稱。</span><span class="sxs-lookup"><span data-stu-id="c11ba-165">The `${`*name*`}` language element substitutes the last substring matched by the *name* capturing group, where *name* is the name of a capturing group defined by the `(?<`*name*`>)` language element.</span></span> <span data-ttu-id="c11ba-166">如需具名擷取群組的詳細資訊，請參閱 [Grouping Constructs](../../../docs/standard/base-types/grouping-constructs-in-regular-expressions.md)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-166">For more information about named capturing groups, see [Grouping Constructs](../../../docs/standard/base-types/grouping-constructs-in-regular-expressions.md).</span></span>  
  
 <span data-ttu-id="c11ba-167">如果 *名稱* 未指定規則運算式模式中定義的有效具名擷取群組，而包含數字，則 `${`*名稱*`}` 會解譯為編號的群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-167">If *name* doesn't specify a valid named capturing group defined in the regular expression pattern but consists of digits, `${`*name*`}` is interpreted as a numbered group.</span></span>  
  
 <span data-ttu-id="c11ba-168">如果 *名稱* 未指定規則運算式模式中定義的有效具名擷取群組，也未定義有效的編號擷取群組，則 `${`*名稱*`}` 會解譯為用以取代每個相符項目的常值字元序列。</span><span class="sxs-lookup"><span data-stu-id="c11ba-168">If *name* specifies neither a valid named capturing group nor a valid numbered capturing group defined in the regular expression pattern, `${`*name*`}` is interpreted as a literal character sequence that is used to replace each match.</span></span>  
  
 <span data-ttu-id="c11ba-169">下列範例使用 `${`*稱*`}` 替代從十進位值中去除貨幣符號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-169">The following example uses the `${`*name*`}` substitution to strip the currency symbol from a decimal value.</span></span> <span data-ttu-id="c11ba-170">它會移除在貨幣數值的開頭或結尾找到的貨幣符號，並且辨識兩種最常見的十進位分隔符號 ("." 和 ",")。</span><span class="sxs-lookup"><span data-stu-id="c11ba-170">It removes currency symbols found at the beginning or end of a monetary value, and recognizes the two most common decimal separators ("." and ",").</span></span>  
  
 [!code-csharp[Conceptual.RegEx.Language.Substitutions#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/namedgroup1.cs#2)]
 [!code-vb[Conceptual.RegEx.Language.Substitutions#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/namedgroup1.vb#2)]  
  
 <span data-ttu-id="c11ba-171">規則運算式模式 `\p{Sc}*(?<amount>\s?\d[.,]?\d*)\p{Sc}*` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="c11ba-171">The regular expression pattern `\p{Sc}*(?<amount>\s?\d[.,]?\d*)\p{Sc}*` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="c11ba-172">模式</span><span class="sxs-lookup"><span data-stu-id="c11ba-172">Pattern</span></span>|<span data-ttu-id="c11ba-173">說明</span><span class="sxs-lookup"><span data-stu-id="c11ba-173">Description</span></span>|  
|-------------|-----------------|  
|`\p{Sc}*`|<span data-ttu-id="c11ba-174">比對零個或多個貨幣符號字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-174">Match zero or more currency symbol characters.</span></span>|  
|`\s?`|<span data-ttu-id="c11ba-175">比對零個或一個空白字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-175">Match zero or one white-space characters.</span></span>|  
|`\d+`|<span data-ttu-id="c11ba-176">比對一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-176">Match one or more decimal digits.</span></span>|  
|`[.,]?`|<span data-ttu-id="c11ba-177">比對零個或一個句號或逗號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-177">Match zero or one period or comma.</span></span>|  
|`\d*`|<span data-ttu-id="c11ba-178">比對零個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-178">Match zero or more decimal digits.</span></span>|  
|`(?<amount>\s?\d[.,]?\d*)`|<span data-ttu-id="c11ba-179">比對空白字元，後面接著一個或多個十進位數字，再接零個或一個句號或逗號，最後再接零個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-179">Match a white space, followed by one or more decimal digits, followed by zero or one period or comma, followed by zero or more decimal digits.</span></span> <span data-ttu-id="c11ba-180">這是名為 `amount`的擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-180">This is the capturing group named `amount`.</span></span> <span data-ttu-id="c11ba-181">由於取代模式為 `${amount}`，因此呼叫 <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> 方法會將整個相符的子字串取代為這個擷取的群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-181">Because the replacement pattern is `${amount}`, the call to the <xref:System.Text.RegularExpressions.Regex.Replace%2A?displayProperty=nameWithType> method replaces the entire matched substring with this captured group.</span></span>|  
  
 [<span data-ttu-id="c11ba-182">回到頁首</span><span class="sxs-lookup"><span data-stu-id="c11ba-182">Back to top</span></span>](#Top)  
  
<a name="DollarSign"></a>   
## <a name="substituting-a--character"></a><span data-ttu-id="c11ba-183">替代 "$" 字元</span><span class="sxs-lookup"><span data-stu-id="c11ba-183">Substituting a "$" Character</span></span>  
 <span data-ttu-id="c11ba-184">`$$` 替代會在取代的字串中插入常值 "$" 字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-184">The `$$` substitution inserts a literal "$" character in the replaced string.</span></span>  
  
 <span data-ttu-id="c11ba-185">下列範例會使用 <xref:System.Globalization.NumberFormatInfo> 物件決定目前文化特性的貨幣符號，以及它在貨幣字串中的位置。</span><span class="sxs-lookup"><span data-stu-id="c11ba-185">The following example uses the <xref:System.Globalization.NumberFormatInfo> object to determine the current culture's currency symbol and its placement in a currency string.</span></span> <span data-ttu-id="c11ba-186">然後，它會動態建置規則運算式模式和取代模式。</span><span class="sxs-lookup"><span data-stu-id="c11ba-186">It then builds both a regular expression pattern and a replacement pattern dynamically.</span></span> <span data-ttu-id="c11ba-187">如果這個範例是在目前文化特性為 zh-TW 的電腦上執行，則會產生規則運算式模式 `\b(\d+)(\.(\d+))?` 以及取代模式 `$$ $1$2`。</span><span class="sxs-lookup"><span data-stu-id="c11ba-187">If the example is run on a computer whose current culture is en-US, it generates the regular expression pattern `\b(\d+)(\.(\d+))?` and the replacement pattern `$$ $1$2`.</span></span> <span data-ttu-id="c11ba-188">取代模式會將相符的文字取代為貨幣符號和空格，後面接著第一個和第二個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-188">The replacement pattern replaces the matched text with a currency symbol and a space followed by the first and second captured groups.</span></span>  
  
 [!code-csharp[Conceptual.Regex.Language.Substitutions#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/dollarsign1.cs#8)]
 [!code-vb[Conceptual.Regex.Language.Substitutions#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/dollarsign1.vb#8)]  
  
 <span data-ttu-id="c11ba-189">規則運算式模式 `\b(\d+)(\.(\d+))?` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="c11ba-189">The regular expression pattern `\b(\d+)(\.(\d+))?` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="c11ba-190">模式</span><span class="sxs-lookup"><span data-stu-id="c11ba-190">Pattern</span></span>|<span data-ttu-id="c11ba-191">說明</span><span class="sxs-lookup"><span data-stu-id="c11ba-191">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="c11ba-192">在字邊界的開頭開始比對。</span><span class="sxs-lookup"><span data-stu-id="c11ba-192">Start the match at the beginning of a word boundary.</span></span>|  
|`(\d+)`|<span data-ttu-id="c11ba-193">比對一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-193">Match one or more decimal digits.</span></span> <span data-ttu-id="c11ba-194">這是第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-194">This is the first capturing group.</span></span>|  
|`\.`|<span data-ttu-id="c11ba-195">比對句號 (十進位分隔符號)。</span><span class="sxs-lookup"><span data-stu-id="c11ba-195">Match a period (the decimal separator).</span></span>|  
|`(\d+)`|<span data-ttu-id="c11ba-196">比對一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-196">Match one or more decimal digits.</span></span> <span data-ttu-id="c11ba-197">這是第三個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-197">This is the third capturing group.</span></span>|  
|`(\.(\d+))?`|<span data-ttu-id="c11ba-198">比對零個或一個句號，後面接著一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-198">Match zero or one occurrence of a period followed by one or more decimal digits.</span></span> <span data-ttu-id="c11ba-199">這是第二個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-199">This is the second capturing group.</span></span>|  
  
<a name="EntireMatch"></a>   
## <a name="substituting-the-entire-match"></a><span data-ttu-id="c11ba-200">替代整個相符項目</span><span class="sxs-lookup"><span data-stu-id="c11ba-200">Substituting the Entire Match</span></span>  
 <span data-ttu-id="c11ba-201">`$&` 替代會在取代字串中包含整個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-201">The `$&` substitution includes the entire match in the replacement string.</span></span> <span data-ttu-id="c11ba-202">通常，它會用來將子字串加入至相符字串的開頭或結尾。</span><span class="sxs-lookup"><span data-stu-id="c11ba-202">Often, it is used to add a substring to the beginning or end of the matched string.</span></span> <span data-ttu-id="c11ba-203">例如， `($&)` 取代模式會在每個相符項目的開頭和結尾加上括號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-203">For example, the `($&)` replacement pattern adds parentheses to the beginning and end of each match.</span></span> <span data-ttu-id="c11ba-204">如果沒有相符項目， `$&` 替代就不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="c11ba-204">If there is no match, the `$&` substitution has no effect.</span></span>  
  
 <span data-ttu-id="c11ba-205">下列範例會使用 `$&` 替代，在字串陣列中所儲存的書名開頭和結尾加上引號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-205">The following example uses the `$&` substitution to add quotation marks at the beginning and end of book titles stored in a string array.</span></span>  
  
 [!code-csharp[Conceptual.RegEx.Language.Substitutions#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/entirematch1.cs#3)]
 [!code-vb[Conceptual.RegEx.Language.Substitutions#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/entirematch1.vb#3)]  
  
 <span data-ttu-id="c11ba-206">規則運算式模式 `^(\w+\s?)+$` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="c11ba-206">The regular expression pattern `^(\w+\s?)+$` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="c11ba-207">模式</span><span class="sxs-lookup"><span data-stu-id="c11ba-207">Pattern</span></span>|<span data-ttu-id="c11ba-208">說明</span><span class="sxs-lookup"><span data-stu-id="c11ba-208">Description</span></span>|  
|-------------|-----------------|  
|`^`|<span data-ttu-id="c11ba-209">在輸入字串的開頭開始比對。</span><span class="sxs-lookup"><span data-stu-id="c11ba-209">Start the match at the beginning of the input string.</span></span>|  
|`(\w+\s?)+`|<span data-ttu-id="c11ba-210">一次或多次比對一個或多個文字字元後面接著零或一個空白字元的模式。</span><span class="sxs-lookup"><span data-stu-id="c11ba-210">Match the pattern of one or more word characters followed by zero or one white-space characters one or more times.</span></span>|  
|`$`|<span data-ttu-id="c11ba-211">比對輸入字串的結尾。</span><span class="sxs-lookup"><span data-stu-id="c11ba-211">Match the end of the input string.</span></span>|  
  
 <span data-ttu-id="c11ba-212">`"$&"` 取代模式會在每個相符項目的開頭和結尾加上常值引號。</span><span class="sxs-lookup"><span data-stu-id="c11ba-212">The `"$&"` replacement pattern adds a literal quotation mark to the beginning and end of each match.</span></span>  
  
 [<span data-ttu-id="c11ba-213">回到頁首</span><span class="sxs-lookup"><span data-stu-id="c11ba-213">Back to top</span></span>](#Top)  
  
<a name="BeforeMatch"></a>   
## <a name="substituting-the-text-before-the-match"></a><span data-ttu-id="c11ba-214">替代相符項目前的文字</span><span class="sxs-lookup"><span data-stu-id="c11ba-214">Substituting the Text Before the Match</span></span>  
 <span data-ttu-id="c11ba-215">``$` `` 替代會將相符的字串取代為相符項目前的整個輸入字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-215">The ``$` `` substitution replaces the matched string with the entire input string before the match.</span></span> <span data-ttu-id="c11ba-216">也就是說，它在移除相符文字的同時，也會複製輸入字串直到相符項目前。</span><span class="sxs-lookup"><span data-stu-id="c11ba-216">That is, it duplicates the input string up to the match while removing the matched text.</span></span> <span data-ttu-id="c11ba-217">在結果字串中，相符文字後面接著的任何文字都會保持不變。</span><span class="sxs-lookup"><span data-stu-id="c11ba-217">Any text that follows the matched text is unchanged in the result string.</span></span> <span data-ttu-id="c11ba-218">如果在輸入字串中有多個相符項目，取代文字就會衍生自原始輸入字串，而非其中文字已經由先前的相符項目取代的字串 </span><span class="sxs-lookup"><span data-stu-id="c11ba-218">If there are multiple matches in an input string, the replacement text is derived from the original input string, rather than from the string in which text has been replaced by earlier matches.</span></span> <span data-ttu-id="c11ba-219">\(這個範例將提供說明。\)如果沒有相符項目， ``$` `` 替代就不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="c11ba-219">\(The example provides an illustration.\) If there is no match, the ``$` `` substitution has no effect.</span></span>  
  
 <span data-ttu-id="c11ba-220">下列範例會使用規則運算式模式 `\d+` ，比對輸入字串中的一或多個十進位數字序列。</span><span class="sxs-lookup"><span data-stu-id="c11ba-220">The following example uses the regular expression pattern `\d+` to match a sequence of one or more decimal digits in the input string.</span></span> <span data-ttu-id="c11ba-221">取代字串 ``$` `` 會以相符文字前的文字取代這些數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-221">The replacement string ``$` `` replaces these digits with the text that precedes the match.</span></span>  
  
 [!code-csharp[Conceptual.Regex.Language.Substitutions#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/before1.cs#4)]
 [!code-vb[Conceptual.Regex.Language.Substitutions#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/before1.vb#4)]  
  
 <span data-ttu-id="c11ba-222">在這個範例中，輸入字串 `"aa1bb2cc3dd4ee5"` 包含五個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-222">In this example, the input string `"aa1bb2cc3dd4ee5"` contains five matches.</span></span> <span data-ttu-id="c11ba-223">下表將說明 ``$` `` 替代如何使規則運算式引擎取代輸入字串中的每個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-223">The following table illustrates how the ``$` `` substitution causes the regular expression engine to replace each match in the input string.</span></span> <span data-ttu-id="c11ba-224">插入的文字會以粗體顯示在結果資料行中。</span><span class="sxs-lookup"><span data-stu-id="c11ba-224">Inserted text is shown in bold in the results column.</span></span>  
  
|<span data-ttu-id="c11ba-225">比對</span><span class="sxs-lookup"><span data-stu-id="c11ba-225">Match</span></span>|<span data-ttu-id="c11ba-226">位置</span><span class="sxs-lookup"><span data-stu-id="c11ba-226">Position</span></span>|<span data-ttu-id="c11ba-227">相符項目前的字串</span><span class="sxs-lookup"><span data-stu-id="c11ba-227">String before match</span></span>|<span data-ttu-id="c11ba-228">結果字串</span><span class="sxs-lookup"><span data-stu-id="c11ba-228">Result string</span></span>|  
|-----------|--------------|-------------------------|-------------------|  
|<span data-ttu-id="c11ba-229">1</span><span class="sxs-lookup"><span data-stu-id="c11ba-229">1</span></span>|<span data-ttu-id="c11ba-230">2</span><span class="sxs-lookup"><span data-stu-id="c11ba-230">2</span></span>|<span data-ttu-id="c11ba-231">aa</span><span class="sxs-lookup"><span data-stu-id="c11ba-231">aa</span></span>|<span data-ttu-id="c11ba-232">aa**aa**bb2cc3dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-232">aa**aa**bb2cc3dd4ee5</span></span>|  
|<span data-ttu-id="c11ba-233">2</span><span class="sxs-lookup"><span data-stu-id="c11ba-233">2</span></span>|<span data-ttu-id="c11ba-234">5</span><span class="sxs-lookup"><span data-stu-id="c11ba-234">5</span></span>|<span data-ttu-id="c11ba-235">aa1bb</span><span class="sxs-lookup"><span data-stu-id="c11ba-235">aa1bb</span></span>|<span data-ttu-id="c11ba-236">aaaabb**aa1bb**cc3dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-236">aaaabb**aa1bb**cc3dd4ee5</span></span>|  
|<span data-ttu-id="c11ba-237">3</span><span class="sxs-lookup"><span data-stu-id="c11ba-237">3</span></span>|<span data-ttu-id="c11ba-238">8</span><span class="sxs-lookup"><span data-stu-id="c11ba-238">8</span></span>|<span data-ttu-id="c11ba-239">aa1bb2cc</span><span class="sxs-lookup"><span data-stu-id="c11ba-239">aa1bb2cc</span></span>|<span data-ttu-id="c11ba-240">aaaabbaa1bbcc**aa1bb2cc**dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-240">aaaabbaa1bbcc**aa1bb2cc**dd4ee5</span></span>|  
|<span data-ttu-id="c11ba-241">4</span><span class="sxs-lookup"><span data-stu-id="c11ba-241">4</span></span>|<span data-ttu-id="c11ba-242">11</span><span class="sxs-lookup"><span data-stu-id="c11ba-242">11</span></span>|<span data-ttu-id="c11ba-243">aa1bb2cc3dd</span><span class="sxs-lookup"><span data-stu-id="c11ba-243">aa1bb2cc3dd</span></span>|<span data-ttu-id="c11ba-244">aaaabbaa1bbccaa1bb2ccdd**aa1bb2cc3dd**ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-244">aaaabbaa1bbccaa1bb2ccdd**aa1bb2cc3dd**ee5</span></span>|  
|<span data-ttu-id="c11ba-245">5</span><span class="sxs-lookup"><span data-stu-id="c11ba-245">5</span></span>|<span data-ttu-id="c11ba-246">14</span><span class="sxs-lookup"><span data-stu-id="c11ba-246">14</span></span>|<span data-ttu-id="c11ba-247">aa1bb2cc3dd4ee</span><span class="sxs-lookup"><span data-stu-id="c11ba-247">aa1bb2cc3dd4ee</span></span>|<span data-ttu-id="c11ba-248">aaaabbaa1bbccaa1bb2ccddaa1bb2cc3ddee**aa1bb2cc3dd4ee**</span><span class="sxs-lookup"><span data-stu-id="c11ba-248">aaaabbaa1bbccaa1bb2ccddaa1bb2cc3ddee**aa1bb2cc3dd4ee**</span></span>|  
  
 [<span data-ttu-id="c11ba-249">回到頁首</span><span class="sxs-lookup"><span data-stu-id="c11ba-249">Back to top</span></span>](#Top)  
  
<a name="AfterMatch"></a>   
## <a name="substituting-the-text-after-the-match"></a><span data-ttu-id="c11ba-250">替代相符項目後的文字</span><span class="sxs-lookup"><span data-stu-id="c11ba-250">Substituting the Text After the Match</span></span>  
 <span data-ttu-id="c11ba-251">`$'` 替代會以相符項目後的整個輸入字串取代相符的字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-251">The `$'` substitution replaces the matched string with the entire input string after the match.</span></span> <span data-ttu-id="c11ba-252">也就是說，它在移除相符文字的同時，也會在相符項目後複製輸入字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-252">That is, it duplicates the input string after the match while removing the matched text.</span></span> <span data-ttu-id="c11ba-253">在結果字串中，相符文字之前的任何文字都會保持不變。</span><span class="sxs-lookup"><span data-stu-id="c11ba-253">Any text that precedes the matched text is unchanged in the result string.</span></span> <span data-ttu-id="c11ba-254">如果沒有相符項目，  `$'` 替代就不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="c11ba-254">If there is no match, the  `$'` substitution has no effect.</span></span>  
  
 <span data-ttu-id="c11ba-255">下列範例會使用規則運算式模式 `\d+` ，比對輸入字串中的一或多個十進位數字序列。</span><span class="sxs-lookup"><span data-stu-id="c11ba-255">The following example uses the regular expression pattern `\d+` to match a sequence of one or more decimal digits in the input string.</span></span> <span data-ttu-id="c11ba-256">取代字串 `$'` 會以相符項目後的文字取代這些數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-256">The replacement string `$'` replaces these digits with the text that follows the match.</span></span>  
  
 [!code-csharp[Conceptual.Regex.Language.Substitutions#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/after1.cs#5)]
 [!code-vb[Conceptual.Regex.Language.Substitutions#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/after1.vb#5)]  
  
 <span data-ttu-id="c11ba-257">在這個範例中，輸入字串 `"aa1bb2cc3dd4ee5"` 包含五個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-257">In this example, the input string `"aa1bb2cc3dd4ee5"` contains five matches.</span></span> <span data-ttu-id="c11ba-258">下表將說明 `$'` 替代如何使規則運算式引擎取代輸入字串中的每個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-258">The following table illustrates how the `$'` substitution causes the regular expression engine to replace each match in the input string.</span></span> <span data-ttu-id="c11ba-259">插入的文字會以粗體顯示在結果資料行中。</span><span class="sxs-lookup"><span data-stu-id="c11ba-259">Inserted text is shown in bold in the results column.</span></span>  
  
|<span data-ttu-id="c11ba-260">比對</span><span class="sxs-lookup"><span data-stu-id="c11ba-260">Match</span></span>|<span data-ttu-id="c11ba-261">位置</span><span class="sxs-lookup"><span data-stu-id="c11ba-261">Position</span></span>|<span data-ttu-id="c11ba-262">相符項目後的字串</span><span class="sxs-lookup"><span data-stu-id="c11ba-262">String after match</span></span>|<span data-ttu-id="c11ba-263">結果字串</span><span class="sxs-lookup"><span data-stu-id="c11ba-263">Result string</span></span>|  
|-----------|--------------|------------------------|-------------------|  
|<span data-ttu-id="c11ba-264">1</span><span class="sxs-lookup"><span data-stu-id="c11ba-264">1</span></span>|<span data-ttu-id="c11ba-265">2</span><span class="sxs-lookup"><span data-stu-id="c11ba-265">2</span></span>|<span data-ttu-id="c11ba-266">bb2cc3dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-266">bb2cc3dd4ee5</span></span>|<span data-ttu-id="c11ba-267">aa**bb2cc3dd4ee5**bb2cc3dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-267">aa**bb2cc3dd4ee5**bb2cc3dd4ee5</span></span>|  
|<span data-ttu-id="c11ba-268">2</span><span class="sxs-lookup"><span data-stu-id="c11ba-268">2</span></span>|<span data-ttu-id="c11ba-269">5</span><span class="sxs-lookup"><span data-stu-id="c11ba-269">5</span></span>|<span data-ttu-id="c11ba-270">cc3dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-270">cc3dd4ee5</span></span>|<span data-ttu-id="c11ba-271">aabb2cc3dd4ee5bb**cc3dd4ee5**cc3dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-271">aabb2cc3dd4ee5bb**cc3dd4ee5**cc3dd4ee5</span></span>|  
|<span data-ttu-id="c11ba-272">3</span><span class="sxs-lookup"><span data-stu-id="c11ba-272">3</span></span>|<span data-ttu-id="c11ba-273">8</span><span class="sxs-lookup"><span data-stu-id="c11ba-273">8</span></span>|<span data-ttu-id="c11ba-274">dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-274">dd4ee5</span></span>|<span data-ttu-id="c11ba-275">aabb2cc3dd4ee5bbcc3dd4ee5cc**dd4ee5**dd4ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-275">aabb2cc3dd4ee5bbcc3dd4ee5cc**dd4ee5**dd4ee5</span></span>|  
|<span data-ttu-id="c11ba-276">4</span><span class="sxs-lookup"><span data-stu-id="c11ba-276">4</span></span>|<span data-ttu-id="c11ba-277">11</span><span class="sxs-lookup"><span data-stu-id="c11ba-277">11</span></span>|<span data-ttu-id="c11ba-278">ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-278">ee5</span></span>|<span data-ttu-id="c11ba-279">aabb2cc3dd4ee5bbcc3dd4ee5ccdd4ee5dd**ee5**ee5</span><span class="sxs-lookup"><span data-stu-id="c11ba-279">aabb2cc3dd4ee5bbcc3dd4ee5ccdd4ee5dd**ee5**ee5</span></span>|  
|<span data-ttu-id="c11ba-280">5</span><span class="sxs-lookup"><span data-stu-id="c11ba-280">5</span></span>|<span data-ttu-id="c11ba-281">14</span><span class="sxs-lookup"><span data-stu-id="c11ba-281">14</span></span>|<xref:System.String.Empty?displayProperty=nameWithType>|<span data-ttu-id="c11ba-282">aabb2cc3dd4ee5bbcc3dd4ee5ccdd4ee5ddee5ee</span><span class="sxs-lookup"><span data-stu-id="c11ba-282">aabb2cc3dd4ee5bbcc3dd4ee5ccdd4ee5ddee5ee</span></span>|  
  
 [<span data-ttu-id="c11ba-283">回到頁首</span><span class="sxs-lookup"><span data-stu-id="c11ba-283">Back to top</span></span>](#Top)  
  
<a name="LastGroup"></a>   
## <a name="substituting-the-last-captured-group"></a><span data-ttu-id="c11ba-284">替代最後擷取的群組</span><span class="sxs-lookup"><span data-stu-id="c11ba-284">Substituting the Last Captured Group</span></span>  
 <span data-ttu-id="c11ba-285">`$+` 替代會以最後擷取的群組取代相符的字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-285">The `$+` substitution replaces the matched string with the last captured group.</span></span> <span data-ttu-id="c11ba-286">如果沒有擷取的群組，或者最後一個擷取群組的值是 <xref:System.String.Empty?displayProperty=nameWithType>， `$+` 替代就不會有任何作用。</span><span class="sxs-lookup"><span data-stu-id="c11ba-286">If there are no captured groups or if the value of the last captured group is <xref:System.String.Empty?displayProperty=nameWithType>, the `$+` substitution has no effect.</span></span>  
  
 <span data-ttu-id="c11ba-287">下列範例會識別字串中的重複文字，並使用 `$+` 替代將這些文字取代為出現的單一文字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-287">The following example identifies duplicate words in a string and uses the `$+` substitution to replace them with a single occurrence of the word.</span></span> <span data-ttu-id="c11ba-288"><xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType> 選項是用來確保只有大小寫不同的相同單字，都會視為重複項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-288">The <xref:System.Text.RegularExpressions.RegexOptions.IgnoreCase?displayProperty=nameWithType> option is used to ensure that words that differ in case but that are otherwise identical are considered duplicates.</span></span>  
  
 [!code-csharp[Conceptual.Regex.Language.Substitutions#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/lastmatch1.cs#6)]
 [!code-vb[Conceptual.Regex.Language.Substitutions#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/lastmatch1.vb#6)]  
  
 <span data-ttu-id="c11ba-289">規則運算式模式 `\b(\w+)\s\1\b` 的定義如下表所示。</span><span class="sxs-lookup"><span data-stu-id="c11ba-289">The regular expression pattern `\b(\w+)\s\1\b` is defined as shown in the following table.</span></span>  
  
|<span data-ttu-id="c11ba-290">模式</span><span class="sxs-lookup"><span data-stu-id="c11ba-290">Pattern</span></span>|<span data-ttu-id="c11ba-291">說明</span><span class="sxs-lookup"><span data-stu-id="c11ba-291">Description</span></span>|  
|-------------|-----------------|  
|`\b`|<span data-ttu-id="c11ba-292">開始字緣比對。</span><span class="sxs-lookup"><span data-stu-id="c11ba-292">Begin the match at a word boundary.</span></span>|  
|`(\w+)`|<span data-ttu-id="c11ba-293">比對一個或多個文字字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-293">Match one or more word characters.</span></span> <span data-ttu-id="c11ba-294">這是第一個擷取群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-294">This is the first capturing group.</span></span>|  
|`\s`|<span data-ttu-id="c11ba-295">比對空白字元。</span><span class="sxs-lookup"><span data-stu-id="c11ba-295">Match a white-space character.</span></span>|  
|`\1`|<span data-ttu-id="c11ba-296">比對第一個擷取的群組。</span><span class="sxs-lookup"><span data-stu-id="c11ba-296">Match the first captured group.</span></span>|  
|`\b`|<span data-ttu-id="c11ba-297">結束字緣比對。</span><span class="sxs-lookup"><span data-stu-id="c11ba-297">End the match at a word boundary.</span></span>|  
  
 [<span data-ttu-id="c11ba-298">回到頁首</span><span class="sxs-lookup"><span data-stu-id="c11ba-298">Back to top</span></span>](#Top)  
  
<a name="EntireString"></a>   
## <a name="substituting-the-entire-input-string"></a><span data-ttu-id="c11ba-299">替代整個輸入字串</span><span class="sxs-lookup"><span data-stu-id="c11ba-299">Substituting the Entire Input String</span></span>  
 <span data-ttu-id="c11ba-300">`$_` 替代會將相符的字串取代整個輸入字串。</span><span class="sxs-lookup"><span data-stu-id="c11ba-300">The `$_` substitution replaces the matched string with the entire input string.</span></span> <span data-ttu-id="c11ba-301">也就是說，它會移除相符的文字，並會以整個字串來取代，包括相符的文字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-301">That is, it removes the matched text and replaces it with the entire string, including the matched text.</span></span>  
  
 <span data-ttu-id="c11ba-302">下列範例會比對輸入字串中的一個或多個十進位數字。</span><span class="sxs-lookup"><span data-stu-id="c11ba-302">The following example matches one or more decimal digits in the input string.</span></span> <span data-ttu-id="c11ba-303">它會使用 `$_` 替代，以整個輸入字串來取代它們。</span><span class="sxs-lookup"><span data-stu-id="c11ba-303">It uses the `$_` substitution to replace them with the entire input string.</span></span>  
  
 [!code-csharp[Conceptual.Regex.Language.Substitutions#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.regex.language.substitutions/cs/entire1.cs#7)]
 [!code-vb[Conceptual.Regex.Language.Substitutions#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.regex.language.substitutions/vb/entire1.vb#7)]  
  
 <span data-ttu-id="c11ba-304">在這個範例中，輸入字串 `"ABC123DEF456"` 包含兩個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-304">In this example, the input string `"ABC123DEF456"` contains two matches.</span></span> <span data-ttu-id="c11ba-305">下表將說明 `$_` 替代如何使規則運算式引擎取代輸入字串中的每個相符項目。</span><span class="sxs-lookup"><span data-stu-id="c11ba-305">The following table illustrates how the `$_` substitution causes the regular expression engine to replace each match in the input string.</span></span> <span data-ttu-id="c11ba-306">插入的文字會以粗體顯示在結果資料行中。</span><span class="sxs-lookup"><span data-stu-id="c11ba-306">Inserted text is shown in bold in the results column.</span></span>  
  
|<span data-ttu-id="c11ba-307">比對</span><span class="sxs-lookup"><span data-stu-id="c11ba-307">Match</span></span>|<span data-ttu-id="c11ba-308">位置</span><span class="sxs-lookup"><span data-stu-id="c11ba-308">Position</span></span>|<span data-ttu-id="c11ba-309">比對</span><span class="sxs-lookup"><span data-stu-id="c11ba-309">Match</span></span>|<span data-ttu-id="c11ba-310">結果字串</span><span class="sxs-lookup"><span data-stu-id="c11ba-310">Result string</span></span>|  
|-----------|--------------|-----------|-------------------|  
|<span data-ttu-id="c11ba-311">1</span><span class="sxs-lookup"><span data-stu-id="c11ba-311">1</span></span>|<span data-ttu-id="c11ba-312">3</span><span class="sxs-lookup"><span data-stu-id="c11ba-312">3</span></span>|<span data-ttu-id="c11ba-313">123</span><span class="sxs-lookup"><span data-stu-id="c11ba-313">123</span></span>|<span data-ttu-id="c11ba-314">ABC**ABC123DEF456**DEF456</span><span class="sxs-lookup"><span data-stu-id="c11ba-314">ABC**ABC123DEF456**DEF456</span></span>|  
|<span data-ttu-id="c11ba-315">2</span><span class="sxs-lookup"><span data-stu-id="c11ba-315">2</span></span>|<span data-ttu-id="c11ba-316">5</span><span class="sxs-lookup"><span data-stu-id="c11ba-316">5</span></span>|<span data-ttu-id="c11ba-317">456</span><span class="sxs-lookup"><span data-stu-id="c11ba-317">456</span></span>|<span data-ttu-id="c11ba-318">ABCABC123DEF456DEF**ABC123DEF456**</span><span class="sxs-lookup"><span data-stu-id="c11ba-318">ABCABC123DEF456DEF**ABC123DEF456**</span></span>|  
  
## <a name="see-also"></a><span data-ttu-id="c11ba-319">另請參閱</span><span class="sxs-lookup"><span data-stu-id="c11ba-319">See also</span></span>

- [<span data-ttu-id="c11ba-320">規則運算式語言 - 快速參考</span><span class="sxs-lookup"><span data-stu-id="c11ba-320">Regular Expression Language - Quick Reference</span></span>](../../../docs/standard/base-types/regular-expression-language-quick-reference.md)
