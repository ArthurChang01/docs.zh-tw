---
title: 使用行事曆
ms.date: 03/30/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- globalization [.NET Framework], calendars
- calendars, global applications
- global applications, calendars
- world-ready applications, calendars
- international applications [.NET Framework], calendars
- culture, calendars
ms.assetid: 0c1534e5-979b-4c8a-a588-1c24301aefb3
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 6fca25786096ebeb97c133d306129f33f2bb4580
ms.sourcegitcommit: c7f3e2e9d6ead6cc3acd0d66b10a251d0c66e59d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/08/2018
ms.locfileid: "44181046"
---
# <a name="working-with-calendars"></a><span data-ttu-id="b176d-102">使用行事曆</span><span class="sxs-lookup"><span data-stu-id="b176d-102">Working with calendars</span></span>

<span data-ttu-id="b176d-103">雖然日期和時間值代表一個時間點，但是其字串表示區分文化特性，而且同時取決於用於顯示特定文化特性之日期和時間值的慣例，以及該文化特性所使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-103">Although a date and time value represents a moment in time, its string representation is culture-sensitive and depends both on the conventions used for displaying date and time values by a specific culture and on the calendar used by that culture.</span></span> <span data-ttu-id="b176d-104">本主題探討在.NET 中的行事曆的支援，並討論使用的曆法類別，使用日期值時。</span><span class="sxs-lookup"><span data-stu-id="b176d-104">This topic explores the support for calendars in .NET and discusses the use of the calendar classes when working with date values.</span></span>

## <a name="calendars-in-net"></a><span data-ttu-id="b176d-105">在.NET 中的行事曆</span><span class="sxs-lookup"><span data-stu-id="b176d-105">Calendars in .NET</span></span>

<span data-ttu-id="b176d-106">在.NET 中的所有行事曆衍生自<xref:System.Globalization.Calendar?displayProperty=nameWithType>類別，可提供了基準曆法實作。</span><span class="sxs-lookup"><span data-stu-id="b176d-106">All calendars in .NET derive from the <xref:System.Globalization.Calendar?displayProperty=nameWithType> class, which provides the base calendar implementation.</span></span> <span data-ttu-id="b176d-107">其中一個衍生自 <xref:System.Globalization.Calendar> 類別的類別是 <xref:System.Globalization.EastAsianLunisolarCalendar> 類別，其為所有陰陽曆的基底類別。</span><span class="sxs-lookup"><span data-stu-id="b176d-107">One of the classes that inherits from the <xref:System.Globalization.Calendar> class is the <xref:System.Globalization.EastAsianLunisolarCalendar> class, which is the base class for all lunisolar calendars.</span></span> <span data-ttu-id="b176d-108">.NET 還包括下列曆法實作：</span><span class="sxs-lookup"><span data-stu-id="b176d-108">.NET includes the following calendar implementations:</span></span>

* <span data-ttu-id="b176d-109"><xref:System.Globalization.ChineseLunisolarCalendar>，表示中文陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-109"><xref:System.Globalization.ChineseLunisolarCalendar>, which represents the Chinese lunisolar calendar.</span></span>

* <span data-ttu-id="b176d-110"><xref:System.Globalization.GregorianCalendar>，表示西曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-110"><xref:System.Globalization.GregorianCalendar>, which represents the Gregorian calendar.</span></span> <span data-ttu-id="b176d-111">這個曆法會進一步細分成子類型 (例如阿拉伯和中東法文)，這些子類別是由 <xref:System.Globalization.GregorianCalendarTypes?displayProperty=nameWithType> 列舉類型所定義。</span><span class="sxs-lookup"><span data-stu-id="b176d-111">This calendar is further divided into subtypes (such as Arabic and Middle East French) that are defined by the <xref:System.Globalization.GregorianCalendarTypes?displayProperty=nameWithType> enumeration.</span></span> <span data-ttu-id="b176d-112"><xref:System.Globalization.GregorianCalendar.CalendarType%2A?displayProperty=nameWithType> 屬性會指定西曆的子類型。</span><span class="sxs-lookup"><span data-stu-id="b176d-112">The <xref:System.Globalization.GregorianCalendar.CalendarType%2A?displayProperty=nameWithType> property specifies the subtype of the Gregorian calendar.</span></span>

* <span data-ttu-id="b176d-113"><xref:System.Globalization.HebrewCalendar>，表示希伯來曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-113"><xref:System.Globalization.HebrewCalendar>, which represents the Hebrew calendar.</span></span>

* <span data-ttu-id="b176d-114"><xref:System.Globalization.HijriCalendar>，表示回曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-114"><xref:System.Globalization.HijriCalendar>, which represents the Hijri calendar.</span></span>

* <span data-ttu-id="b176d-115"><xref:System.Globalization.JapaneseCalendar>，表示日本曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-115"><xref:System.Globalization.JapaneseCalendar>, which represents the Japanese calendar.</span></span>

* <span data-ttu-id="b176d-116"><xref:System.Globalization.JapaneseLunisolarCalendar>，表示日文陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-116"><xref:System.Globalization.JapaneseLunisolarCalendar>, which represents the Japanese lunisolar calendar.</span></span>

* <span data-ttu-id="b176d-117"><xref:System.Globalization.JulianCalendar>，表示凱撒曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-117"><xref:System.Globalization.JulianCalendar>, which represents the Julian calendar.</span></span>

* <span data-ttu-id="b176d-118"><xref:System.Globalization.KoreanCalendar>，表示韓國曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-118"><xref:System.Globalization.KoreanCalendar>, which represents the Korean calendar.</span></span>

* <span data-ttu-id="b176d-119"><xref:System.Globalization.KoreanLunisolarCalendar>，表示韓文陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-119"><xref:System.Globalization.KoreanLunisolarCalendar>, which represents the Korean lunisolar calendar.</span></span>

* <span data-ttu-id="b176d-120"><xref:System.Globalization.PersianCalendar>，表示波斯曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-120"><xref:System.Globalization.PersianCalendar>, which represents the Persian calendar.</span></span>

* <span data-ttu-id="b176d-121"><xref:System.Globalization.TaiwanCalendar>，表示台灣曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-121"><xref:System.Globalization.TaiwanCalendar>, which represents the Taiwan calendar.</span></span>

* <span data-ttu-id="b176d-122"><xref:System.Globalization.TaiwanLunisolarCalendar>，表示台灣使用的陰陽曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-122"><xref:System.Globalization.TaiwanLunisolarCalendar>, which represents the Taiwan lunisolar calendar.</span></span>

* <span data-ttu-id="b176d-123"><xref:System.Globalization.ThaiBuddhistCalendar>，表示泰國佛教曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-123"><xref:System.Globalization.ThaiBuddhistCalendar>, which represents the Thai Buddhist calendar.</span></span>

* <span data-ttu-id="b176d-124"><xref:System.Globalization.UmAlQuraCalendar>，表示 Um Al Qura 曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-124"><xref:System.Globalization.UmAlQuraCalendar>, which represents the Um Al Qura calendar.</span></span>

<span data-ttu-id="b176d-125">曆法的使用方式有兩種：</span><span class="sxs-lookup"><span data-stu-id="b176d-125">A calendar can be used in one of two ways:</span></span>

* <span data-ttu-id="b176d-126">做為特定文化特性使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-126">As the calendar used by a specific culture.</span></span> <span data-ttu-id="b176d-127">每個 <xref:System.Globalization.CultureInfo> 物件都有現行的曆法，也就是物件目前使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-127">Each <xref:System.Globalization.CultureInfo> object has a current calendar, which is the calendar that the object is currently using.</span></span> <span data-ttu-id="b176d-128">所有日期和時間值的字串表示都會自動反映目前的文化特性及其現行曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-128">The string representations of all date and time values automatically reflect the current culture and its current calendar.</span></span> <span data-ttu-id="b176d-129">通常現行曆法是文化特性的預設曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-129">Typically, the current calendar is the culture's default calendar.</span></span> <span data-ttu-id="b176d-130"><xref:System.Globalization.CultureInfo> 物件還包含選擇性的曆法，包括該文化特性可以使用的額外曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-130"><xref:System.Globalization.CultureInfo> objects also have optional calendars, which include additional calendars that that culture can use.</span></span>

* <span data-ttu-id="b176d-131">做為與特定文化特性無關的獨立曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-131">As a standalone calendar independent of a specific culture.</span></span> <span data-ttu-id="b176d-132">這種情況下會使用 <xref:System.Globalization.Calendar> 方法以反映曆法的值表達日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-132">In this case, <xref:System.Globalization.Calendar> methods are used to express dates as values that reflect the calendar.</span></span>

<span data-ttu-id="b176d-133">請注意，這六種曆法類別 <xref:System.Globalization.ChineseLunisolarCalendar>、<xref:System.Globalization.JapaneseLunisolarCalendar>、<xref:System.Globalization.JulianCalendar>、<xref:System.Globalization.KoreanLunisolarCalendar>、<xref:System.Globalization.PersianCalendar> 和 <xref:System.Globalization.TaiwanLunisolarCalendar> 只能做為獨立曆法使用。</span><span class="sxs-lookup"><span data-stu-id="b176d-133">Note that six calendar classes – <xref:System.Globalization.ChineseLunisolarCalendar>, <xref:System.Globalization.JapaneseLunisolarCalendar>, <xref:System.Globalization.JulianCalendar>, <xref:System.Globalization.KoreanLunisolarCalendar>, <xref:System.Globalization.PersianCalendar>, and <xref:System.Globalization.TaiwanLunisolarCalendar> – can be used only as standalone calendars.</span></span> <span data-ttu-id="b176d-134">這些類別不會由任何文化特性做為預設曆法或選擇性曆法使用。</span><span class="sxs-lookup"><span data-stu-id="b176d-134">They are not used by any culture as either the default calendar or as an optional calendar.</span></span>

## <a name="calendars-and-cultures"></a><span data-ttu-id="b176d-135">曆法與文化特性</span><span class="sxs-lookup"><span data-stu-id="b176d-135">Calendars and cultures</span></span>

<span data-ttu-id="b176d-136">每一種文化特性都有預設曆法，該曆法是由 <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> 屬性所定義。</span><span class="sxs-lookup"><span data-stu-id="b176d-136">Each culture has a default calendar, which is defined by the <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b176d-137"><xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性會傳回 <xref:System.Globalization.Calendar> 物件的陣列，該陣列會指定特定文化特性支援的所有曆法，包括該文化特性的預設曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-137">The <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> property returns an array of <xref:System.Globalization.Calendar> objects that specifies all the calendars supported by a particular culture, including that culture's default calendar.</span></span>

<span data-ttu-id="b176d-138">下列範例說明 <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> 和 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性。</span><span class="sxs-lookup"><span data-stu-id="b176d-138">The following example illustrates the <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> and <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> properties.</span></span> <span data-ttu-id="b176d-139">範例中會為泰文 (泰國) 和日文 (日本) 文化特性建立 `CultureInfo` 物件，並且顯示其預設和選擇性曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-139">It creates `CultureInfo` objects for the Thai (Thailand) and Japanese (Japan) cultures and displays their default and optional calendars.</span></span> <span data-ttu-id="b176d-140">請注意，在這兩種情況下，文化特性的預設曆法也會包含在 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 集合中。</span><span class="sxs-lookup"><span data-stu-id="b176d-140">Note that in both cases, the culture's default calendar is also included in the <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> collection.</span></span>

[!code-csharp[Conceptual.Calendars#1](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/calendarinfo1.cs#1)]
[!code-vb[Conceptual.Calendars#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/calendarinfo1.vb#1)]

<span data-ttu-id="b176d-141">特定 <xref:System.Globalization.CultureInfo> 物件目前使用的曆法是由文化特性的 <xref:System.Globalization.DateTimeFormatInfo.Calendar%2A?displayProperty=nameWithType> 屬性定義。</span><span class="sxs-lookup"><span data-stu-id="b176d-141">The calendar currently in use by a particular <xref:System.Globalization.CultureInfo> object is defined by the culture's <xref:System.Globalization.DateTimeFormatInfo.Calendar%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b176d-142">文化特性的 <xref:System.Globalization.DateTimeFormatInfo> 物件是由 <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> 屬性所傳回。</span><span class="sxs-lookup"><span data-stu-id="b176d-142">A culture's <xref:System.Globalization.DateTimeFormatInfo> object is returned by the <xref:System.Globalization.CultureInfo.DateTimeFormat%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b176d-143">建立文化特性時，其預設值與 <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> 屬性的值相同。</span><span class="sxs-lookup"><span data-stu-id="b176d-143">When a culture is created, its default value is the same as the value of the <xref:System.Globalization.CultureInfo.Calendar%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b176d-144">不過，您可以將文化特性的現行曆法變更為 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性所傳回陣列中包含的任何曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-144">However, you can change the culture's current calendar to any calendar contained in the array returned by the <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b176d-145">如果您嘗試將現行曆法設定為不包括在 <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> 屬性值中的曆法，則會顯示 <xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="b176d-145">If you try to set the current calendar to a calendar that is not included in the <xref:System.Globalization.CultureInfo.OptionalCalendars%2A?displayProperty=nameWithType> property value, an <xref:System.ArgumentException> is thrown.</span></span>

<span data-ttu-id="b176d-146">下列範例會變更阿拉伯文 (沙烏地阿拉伯) 文化特性使用的曆法。</span><span class="sxs-lookup"><span data-stu-id="b176d-146">The following example changes the calendar used by the Arabic (Saudi Arabia) culture.</span></span> <span data-ttu-id="b176d-147">首先會具現化 <xref:System.DateTime> 值，並且使用現行文化特性 (此案例中是英文 (美國)) 和目前文化特性的曆法 (此案例中是西曆) 顯示該值。</span><span class="sxs-lookup"><span data-stu-id="b176d-147">It first instantiates a <xref:System.DateTime> value and displays it using the current culture - which, in this case, is English (United States) - and the current culture's calendar (which, in this case, is the Gregorian calendar).</span></span> <span data-ttu-id="b176d-148">接著會將目前的文化特性變更為阿拉伯文 (沙烏地阿拉伯)，並且使用其預設的 Um Al-Qura 曆法顯示日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-148">Next, it changes the current culture to Arabic (Saudi Arabia) and displays the date using its default Um Al-Qura calendar.</span></span> <span data-ttu-id="b176d-149">最後呼叫 `CalendarExists` 方法，判斷阿拉伯文 (沙烏地阿拉伯) 文化特性是否支援回曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-149">It then calls the `CalendarExists` method to determine whether the Hijri calendar is supported by the Arabic (Saudi Arabia) culture.</span></span> <span data-ttu-id="b176d-150">由於支援此曆法，因此會將現行曆法變更為回曆，並且再次顯示日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-150">Because the calendar is supported, it changes the current calendar to Hijri and again displays the date.</span></span> <span data-ttu-id="b176d-151">請注意，在各案例中，日期會使用目前文化特性的現行曆法顯示。</span><span class="sxs-lookup"><span data-stu-id="b176d-151">Note that in each case, the date is displayed using the current culture's current calendar.</span></span>

[!code-csharp[Conceptual.Calendars#2](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/changecalendar2.cs#2)]
[!code-vb[Conceptual.Calendars#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/changecalendar2.vb#2)]

## <a name="dates-and-calendars"></a><span data-ttu-id="b176d-152">日期和行事曆</span><span class="sxs-lookup"><span data-stu-id="b176d-152">Dates and calendars</span></span>

<span data-ttu-id="b176d-153">除了包括 <xref:System.Globalization.Calendar> 類型的參數且允許日期的項目 (也就是月、日和年) 以指定的曆法反映值的建構函式之外，<xref:System.DateTime> 和 <xref:System.DateTimeOffset> 這兩個值永遠以西曆為主。</span><span class="sxs-lookup"><span data-stu-id="b176d-153">With the exception of the constructors that include a parameter of type <xref:System.Globalization.Calendar> and allow the elements of a date (that is, the month, the day, and the year) to reflect values in a designated calendar, both <xref:System.DateTime> and <xref:System.DateTimeOffset> values are always based on the Gregorian calendar.</span></span> <span data-ttu-id="b176d-154">例如，這表示 <xref:System.DateTime.Year%2A?displayProperty=nameWithType> 屬性會傳回西曆的年，而 <xref:System.DateTime.Day%2A?displayProperty=nameWithType> 屬性會傳回西曆的月份日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-154">This means, for example, that the <xref:System.DateTime.Year%2A?displayProperty=nameWithType> property returns the year in the Gregorian calendar, and the <xref:System.DateTime.Day%2A?displayProperty=nameWithType> property returns the day of the month in the Gregorian calendar.</span></span>

> [!IMPORTANT]
> <span data-ttu-id="b176d-155">務必記得，日期值及其字串表示之間有一項差異。</span><span class="sxs-lookup"><span data-stu-id="b176d-155">It is important to remember that there is a difference between a date value and its string representation.</span></span> <span data-ttu-id="b176d-156">前者是以西曆為主，後者是以特定文化特性的現行曆法為主。</span><span class="sxs-lookup"><span data-stu-id="b176d-156">The former is based on the Gregorian calendar; the latter is based on the current calendar of a specific culture.</span></span>

<span data-ttu-id="b176d-157">下列範例會說明 <xref:System.DateTime> 屬性及其對應的 <xref:System.Globalization.Calendar> 方法之間的這項差異。</span><span class="sxs-lookup"><span data-stu-id="b176d-157">The following example illustrates this difference between <xref:System.DateTime> properties and their corresponding <xref:System.Globalization.Calendar> methods.</span></span> <span data-ttu-id="b176d-158">在此範例中，目前文化特性為阿拉伯文 (埃及)，而現行曆法為 Um Al Qura。</span><span class="sxs-lookup"><span data-stu-id="b176d-158">In the example, the current culture is Arabic (Egypt), and the current calendar is Um Al Qura.</span></span> <span data-ttu-id="b176d-159"><xref:System.DateTime> 值會設定為 2011 年第七個月的第 15 天。</span><span class="sxs-lookup"><span data-stu-id="b176d-159">A <xref:System.DateTime> value is set to the fifteenth day of the seventh month of 2011.</span></span> <span data-ttu-id="b176d-160">很清楚這個日期是解譯為西曆日期，因為這些相同值是 <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> 方法在使用不因文化特性而異的慣例時所傳回。</span><span class="sxs-lookup"><span data-stu-id="b176d-160">It is clear that this is interpreted as a Gregorian date, because these same values are returned by the <xref:System.DateTime.ToString%28System.String%2CSystem.IFormatProvider%29?displayProperty=nameWithType> method when it uses the conventions of the invariant culture.</span></span> <span data-ttu-id="b176d-161">使用目前文化特性格式化之日期的字串表示為 14/08/32，其為 Um Al Qura 曆法的同等日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-161">The string representation of the date that is formatted using the conventions of the current culture is 14/08/32, which is the equivalent date in the Um Al Qura calendar.</span></span> <span data-ttu-id="b176d-162">其次，`DateTime` 和 `Calendar` 的成員會用來傳回 <xref:System.DateTime> 值的日、月和年。</span><span class="sxs-lookup"><span data-stu-id="b176d-162">Next, members of `DateTime` and `Calendar` are used to return the day, the month, and the year of the <xref:System.DateTime> value.</span></span> <span data-ttu-id="b176d-163">在各案例中，<xref:System.DateTime> 成員傳回的值會反映西曆的值，而 <xref:System.Globalization.UmAlQuraCalendar> 成員傳回的值則會反映 Uum al-Qura 曆法的值。</span><span class="sxs-lookup"><span data-stu-id="b176d-163">In each case, the values returned by <xref:System.DateTime> members reflect values in the Gregorian calendar, whereas values returned by <xref:System.Globalization.UmAlQuraCalendar> members reflect values in the Uum al-Qura calendar.</span></span>

[!code-csharp[Conceptual.Calendars#3](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/datesandcalendars2.cs#3)]
[!code-vb[Conceptual.Calendars#3](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/datesandcalendars2.vb#3)]

### <a name="instantiating-dates-based-on-a-calendar"></a><span data-ttu-id="b176d-164">具現化根據行事曆的日期</span><span class="sxs-lookup"><span data-stu-id="b176d-164">Instantiating dates based on a calendar</span></span>

<span data-ttu-id="b176d-165">由於 <xref:System.DateTime> 和 <xref:System.DateTimeOffset> 值是以西曆為主，因此，如果您想要使用不同曆法的日、月或年值，則必須呼叫包含 <xref:System.Globalization.Calendar> 類型之參數的多載建構函式來具現化日期值。</span><span class="sxs-lookup"><span data-stu-id="b176d-165">Because <xref:System.DateTime> and <xref:System.DateTimeOffset> values are based on the Gregorian calendar, you must call an overloaded constructor that includes a parameter of type <xref:System.Globalization.Calendar> to instantiate a date value if you want to use the day, month, or year values from a different calendar.</span></span> <span data-ttu-id="b176d-166">您也可以呼叫特定曆法之 <xref:System.Globalization.Calendar.ToDateTime%2A?displayProperty=nameWithType> 方法的其中一個多載，依據特殊曆法的值具現化 <xref:System.DateTime> 物件。</span><span class="sxs-lookup"><span data-stu-id="b176d-166">You can also call one of the overloads of a specific calendar's <xref:System.Globalization.Calendar.ToDateTime%2A?displayProperty=nameWithType> method to instantiate a <xref:System.DateTime> object based on the values of a particular calendar.</span></span>

<span data-ttu-id="b176d-167">下列範例會藉由將 <xref:System.DateTime> 物件傳遞至 <xref:System.Globalization.HebrewCalendar> 建構函式具現化一個 <xref:System.DateTime> 值，並且藉由呼叫 <xref:System.DateTime> 方法具現化另一個 <xref:System.Globalization.HebrewCalendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="b176d-167">The following example instantiates one <xref:System.DateTime> value by passing a <xref:System.Globalization.HebrewCalendar> object to a <xref:System.DateTime> constructor, and instantiates a second <xref:System.DateTime> value by calling the <xref:System.Globalization.HebrewCalendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="b176d-168">由於這兩個值是使用希伯來曆法的相同值所建立，因此呼叫 <xref:System.DateTime.Equals%2A?displayProperty=nameWithType> 方法會顯示這兩個 <xref:System.DateTime> 值相等。</span><span class="sxs-lookup"><span data-stu-id="b176d-168">Because the two values are created with identical values from the Hebrew calendar, the call to the <xref:System.DateTime.Equals%2A?displayProperty=nameWithType> method shows that the two <xref:System.DateTime> values are equal.</span></span>

[!code-csharp[Conceptual.Calendars#4](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/instantiatehcdate1.cs#4)]
[!code-vb[Conceptual.Calendars#4](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/instantiatehcdate1.vb#4)]

### <a name="representing-dates-in-the-current-calendar"></a><span data-ttu-id="b176d-169">以現行曆法表示日期</span><span class="sxs-lookup"><span data-stu-id="b176d-169">Representing dates in the current calendar</span></span>

<span data-ttu-id="b176d-170">日期和時間格式化方法會固定使用現行曆法將日期轉換為字串。</span><span class="sxs-lookup"><span data-stu-id="b176d-170">Date and time formatting methods always use the current calendar when converting dates to strings.</span></span> <span data-ttu-id="b176d-171">這表示年、月和月份日期的字串表示會反映現行曆法，而且不一定會反映西曆。</span><span class="sxs-lookup"><span data-stu-id="b176d-171">This means that the string representation of the year, the month, and the day of the month reflect the current calendar, and do not necessarily reflect the Gregorian calendar.</span></span>

<span data-ttu-id="b176d-172">下列範例顯示現行曆法如何影響日期的字串表示。</span><span class="sxs-lookup"><span data-stu-id="b176d-172">The following example shows how the current calendar affects the string representation of a date.</span></span> <span data-ttu-id="b176d-173">它會將目前文化特性變更為中文 (繁體，台灣)，並且具現化日期值。</span><span class="sxs-lookup"><span data-stu-id="b176d-173">It changes the current culture to Chinese (Traditional, Taiwan), and instantiates a date value.</span></span> <span data-ttu-id="b176d-174">接著會顯示現行曆法和日期，將現行曆法變更為 <xref:System.Globalization.TaiwanCalendar>，然後再次顯示現行曆法和日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-174">It then displays the current calendar and the date, changes the current calendar to <xref:System.Globalization.TaiwanCalendar>, and displays the current calendar and date once again.</span></span> <span data-ttu-id="b176d-175">第一次顯示日期時，該日期會以西曆日期表示。</span><span class="sxs-lookup"><span data-stu-id="b176d-175">The first time the date is displayed, it is represented as a date in the Gregorian calendar.</span></span> <span data-ttu-id="b176d-176">第二次顯示日期時，該日期會以台灣曆法的日期表示。</span><span class="sxs-lookup"><span data-stu-id="b176d-176">The second time it is displayed, it is represented as a date in the Taiwan calendar.</span></span>

[!code-csharp[Conceptual.Calendars#5](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/currentcalendar1.cs#5)]
[!code-vb[Conceptual.Calendars#5](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/currentcalendar1.vb#5)]

### <a name="representing-dates-in-a-non-current-calendar"></a><span data-ttu-id="b176d-177">以非現行曆法表示日期</span><span class="sxs-lookup"><span data-stu-id="b176d-177">Representing dates in a non-current calendar</span></span>

<span data-ttu-id="b176d-178">若要使用不是特定文化特性的現行曆法來表示日期，您必須呼叫該 <xref:System.Globalization.Calendar> 物件的方法。</span><span class="sxs-lookup"><span data-stu-id="b176d-178">To represent a date using a calendar that is not the current calendar of a particular culture, you must call methods of that <xref:System.Globalization.Calendar> object.</span></span> <span data-ttu-id="b176d-179">例如，<xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>、<xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType> 和 <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> 方法會將年、月和日轉換成反映特定曆法的值。</span><span class="sxs-lookup"><span data-stu-id="b176d-179">For example, the <xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>, <xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType>, and <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> methods convert the year, month, and day to values that reflect a particular calendar.</span></span>

> [!WARNING]
> <span data-ttu-id="b176d-180">由於某些曆法並非任何文化特性的選擇性曆法，因此使用這些曆法表示日期一定要呼叫曆法方法。</span><span class="sxs-lookup"><span data-stu-id="b176d-180">Because some calendars are not optional calendars of any culture, representing dates in these calendars always requires that you call calendar methods.</span></span> <span data-ttu-id="b176d-181">所有衍生自 <xref:System.Globalization.EastAsianLunisolarCalendar>、<xref:System.Globalization.JulianCalendar> 和 <xref:System.Globalization.PersianCalendar> 類別的曆法都要這樣做。</span><span class="sxs-lookup"><span data-stu-id="b176d-181">This is true of all calendars that derive from the <xref:System.Globalization.EastAsianLunisolarCalendar>, <xref:System.Globalization.JulianCalendar>, and <xref:System.Globalization.PersianCalendar> classes.</span></span>

<span data-ttu-id="b176d-182">下列範例使用 <xref:System.Globalization.JulianCalendar> 物件具現化凱撒曆法的日期 1905 年 1 月 9 日。</span><span class="sxs-lookup"><span data-stu-id="b176d-182">The following example uses a <xref:System.Globalization.JulianCalendar> object to instantiate a date, January 9, 1905, in the Julian calendar.</span></span> <span data-ttu-id="b176d-183">使用預設曆法 (西曆) 顯示這個日期時，該日期會表示為 1905 年 1 月 22 日。</span><span class="sxs-lookup"><span data-stu-id="b176d-183">When this date is displayed using the default (Gregorian) calendar, it is represented as January 22, 1905.</span></span> <span data-ttu-id="b176d-184">呼叫個別 <xref:System.Globalization.JulianCalendar> 方法即可使用凱撒曆法表示日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-184">Calls to individual <xref:System.Globalization.JulianCalendar> methods enable the date to be represented in the Julian calendar.</span></span>

[!code-csharp[Conceptual.Calendars#6](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/noncurrentcalendar1.cs#6)]
[!code-vb[Conceptual.Calendars#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/noncurrentcalendar1.vb#6)]

### <a name="calendars-and-date-ranges"></a><span data-ttu-id="b176d-185">曆法和日期範圍</span><span class="sxs-lookup"><span data-stu-id="b176d-185">Calendars and date ranges</span></span>

<span data-ttu-id="b176d-186">曆法所支援的最早日期是由該曆法的 <xref:System.Globalization.Calendar.MinSupportedDateTime%2A?displayProperty=nameWithType> 屬性所表示。</span><span class="sxs-lookup"><span data-stu-id="b176d-186">The earliest date supported by a calendar is indicated by that calendar's <xref:System.Globalization.Calendar.MinSupportedDateTime%2A?displayProperty=nameWithType> property.</span></span> <span data-ttu-id="b176d-187">如果是 <xref:System.Globalization.GregorianCalendar> 類別，該日期是公元 0001 年 1 月 1 日。</span><span class="sxs-lookup"><span data-stu-id="b176d-187">For the <xref:System.Globalization.GregorianCalendar> class, that date is January 1, 0001 C.E.</span></span> <span data-ttu-id="b176d-188">大部分的.NET 中的其他行事曆支援較晚的日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-188">Most of the other calendars in .NET support a later date.</span></span> <span data-ttu-id="b176d-189">嘗試處理早於曆法所支援最早日期的日期和時間值，會擲回 <xref:System.ArgumentOutOfRangeException> 例外狀況。</span><span class="sxs-lookup"><span data-stu-id="b176d-189">Trying to work with a date and time value that precedes a calendar's earliest supported date throws an <xref:System.ArgumentOutOfRangeException> exception.</span></span>

<span data-ttu-id="b176d-190">不過，有一個重要的例外狀況。</span><span class="sxs-lookup"><span data-stu-id="b176d-190">However, there is one important exception.</span></span> <span data-ttu-id="b176d-191"><xref:System.DateTime> 物件和 <xref:System.DateTimeOffset> 物件的預設值 (未初始化的值) 相當於 <xref:System.Globalization.GregorianCalendar.MinSupportedDateTime%2A?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="b176d-191">The default (uninitialized) value of a <xref:System.DateTime> object and a <xref:System.DateTimeOffset> object is equal to the <xref:System.Globalization.GregorianCalendar.MinSupportedDateTime%2A?displayProperty=nameWithType> value.</span></span> <span data-ttu-id="b176d-192">如果您嘗試在行事曆不支援公元 0001 年 1 月 1 日這個日期格式化</span><span class="sxs-lookup"><span data-stu-id="b176d-192">If you try to format this date in a calendar that does not support January 1, 0001 C.E.</span></span> <span data-ttu-id="b176d-193">您未提供格式規範，則格式化方法使用"s"（可排序日期/時間模式） 格式規範，而不是"G"（一般日期/時間模式） 格式規範。</span><span class="sxs-lookup"><span data-stu-id="b176d-193">and you do not provide a format specifier, the formatting method uses the "s" (sortable date/time pattern) format specifier instead of the "G" (general date/time pattern) format specifier.</span></span> <span data-ttu-id="b176d-194">結果，格式化作業並不會擲回 <xref:System.ArgumentOutOfRangeException> 例外狀況，</span><span class="sxs-lookup"><span data-stu-id="b176d-194">As a result, the formatting operation does not throw an <xref:System.ArgumentOutOfRangeException> exception.</span></span> <span data-ttu-id="b176d-195">而是傳回不支援的日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-195">Instead, it returns the unsupported date.</span></span> <span data-ttu-id="b176d-196">下列範例將說明這種情況，當目前文化特性設為日文 (日本) 並採用日本曆法，以及設為阿拉伯文 (埃及) 並採用 Um Al Qura 曆法時，會顯示 <xref:System.DateTime.MinValue?displayProperty=nameWithType> 值。</span><span class="sxs-lookup"><span data-stu-id="b176d-196">This is illustrated in the following example, which displays the value of <xref:System.DateTime.MinValue?displayProperty=nameWithType> when the current culture is set to Japanese (Japan) with the Japanese calendar, and to Arabic (Egypt) with the Um Al Qura calendar.</span></span> <span data-ttu-id="b176d-197">另外也會將目前文化特性設為英文 (美國)，並且對每一個 <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType> 物件呼叫 <xref:System.Globalization.CultureInfo> 方法。</span><span class="sxs-lookup"><span data-stu-id="b176d-197">It also sets the current culture to English (United States) and calls the <xref:System.DateTime.ToString%28System.IFormatProvider%29?displayProperty=nameWithType> method with each of these <xref:System.Globalization.CultureInfo> objects.</span></span> <span data-ttu-id="b176d-198">在每個案例中，日期是使用可排序日期/時間模式顯示。</span><span class="sxs-lookup"><span data-stu-id="b176d-198">In each case, the date is displayed by using the sortable date/time pattern.</span></span>

[!code-csharp[Conceptual.Calendars#11](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/minsupporteddatetime1.cs#11)]
[!code-vb[Conceptual.Calendars#11](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/minsupporteddatetime1.vb#11)]

## <a name="working-with-eras"></a><span data-ttu-id="b176d-199">使用紀元</span><span class="sxs-lookup"><span data-stu-id="b176d-199">Working with eras</span></span>

<span data-ttu-id="b176d-200">曆法通常會將日期細分成紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-200">Calendars typically divide dates into eras.</span></span> <span data-ttu-id="b176d-201">不過，<xref:System.Globalization.Calendar>在.NET 中的類別不支援定義行事曆，以及大部份的每一個紀元<xref:System.Globalization.Calendar>類別可支援單一紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-201">However, the <xref:System.Globalization.Calendar> classes in .NET do not support every era defined by a calendar, and most of the <xref:System.Globalization.Calendar> classes support only a single era.</span></span> <span data-ttu-id="b176d-202">只有 <xref:System.Globalization.JapaneseCalendar> 和 <xref:System.Globalization.JapaneseLunisolarCalendar> 類別支援多個紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-202">Only the <xref:System.Globalization.JapaneseCalendar> and <xref:System.Globalization.JapaneseLunisolarCalendar> classes support multiple eras.</span></span>

### <a name="eras-and-era-names"></a><span data-ttu-id="b176d-203">紀元和紀元名稱</span><span class="sxs-lookup"><span data-stu-id="b176d-203">Eras and era names</span></span>

<span data-ttu-id="b176d-204">在.NET 中，代表特定曆法實作支援的紀元的整數會以反向順序在儲存<xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType>陣列。</span><span class="sxs-lookup"><span data-stu-id="b176d-204">In .NET, integers that represent the eras supported by a particular calendar implementation are stored in reverse order in the <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> array.</span></span> <span data-ttu-id="b176d-205">目前紀元的索引位置為零，而針對支援多個紀元的 <xref:System.Globalization.Calendar> 類別，後續每個索引都會反映前一個紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-205">The current era is at index zero, and for <xref:System.Globalization.Calendar> classes that support multiple eras, each successive index reflects the previous era.</span></span> <span data-ttu-id="b176d-206">靜態 <xref:System.Globalization.Calendar.CurrentEra?displayProperty=nameWithType> 屬性會定義 <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> 陣列中目前紀元的索引，它是一個常數，且其值永遠為零。</span><span class="sxs-lookup"><span data-stu-id="b176d-206">The static <xref:System.Globalization.Calendar.CurrentEra?displayProperty=nameWithType> property defines the index of the current era in the <xref:System.Globalization.Calendar.Eras%2A?displayProperty=nameWithType> array; it is a constant whose value is always zero.</span></span> <span data-ttu-id="b176d-207">個別 <xref:System.Globalization.Calendar> 類別也會包含傳回目前紀元值的靜態欄位。</span><span class="sxs-lookup"><span data-stu-id="b176d-207">Individual <xref:System.Globalization.Calendar> classes also include static fields that return the value of the current era.</span></span> <span data-ttu-id="b176d-208">下表中列出這些欄位。</span><span class="sxs-lookup"><span data-stu-id="b176d-208">They are listed in the following table.</span></span>

| <span data-ttu-id="b176d-209">曆法類別</span><span class="sxs-lookup"><span data-stu-id="b176d-209">Calendar class</span></span>                                        | <span data-ttu-id="b176d-210">目前紀元欄位</span><span class="sxs-lookup"><span data-stu-id="b176d-210">Current era field</span></span>                                                 |
| ----------------------------------------------------- | ----------------------------------------------------------------- |
| <xref:System.Globalization.ChineseLunisolarCalendar>  | <xref:System.Globalization.ChineseLunisolarCalendar.ChineseEra>   |
| <xref:System.Globalization.GregorianCalendar>         | <xref:System.Globalization.GregorianCalendar.ADEra>               |
| <xref:System.Globalization.HebrewCalendar>            | <xref:System.Globalization.HebrewCalendar.HebrewEra>              |
| <xref:System.Globalization.HijriCalendar>             | <xref:System.Globalization.HijriCalendar.HijriEra>                |
| <xref:System.Globalization.JapaneseLunisolarCalendar> | <xref:System.Globalization.JapaneseLunisolarCalendar.JapaneseEra> |
| <xref:System.Globalization.JulianCalendar>            | <xref:System.Globalization.JulianCalendar.JulianEra>              |
| <xref:System.Globalization.KoreanCalendar>            | <xref:System.Globalization.KoreanCalendar.KoreanEra>              |
| <xref:System.Globalization.KoreanLunisolarCalendar>   | <xref:System.Globalization.KoreanLunisolarCalendar.GregorianEra>  |
| <xref:System.Globalization.PersianCalendar>           | <xref:System.Globalization.PersianCalendar.PersianEra>            |
| <xref:System.Globalization.ThaiBuddhistCalendar>      | <xref:System.Globalization.ThaiBuddhistCalendar.ThaiBuddhistEra>  |
| <xref:System.Globalization.UmAlQuraCalendar>          | <xref:System.Globalization.UmAlQuraCalendar.UmAlQuraEra>          |

<span data-ttu-id="b176d-211">對應特定紀元數的名稱可藉由將紀元數傳遞至 <xref:System.Globalization.DateTimeFormatInfo.GetEraName%2A?displayProperty=nameWithType> 或 <xref:System.Globalization.DateTimeFormatInfo.GetAbbreviatedEraName%2A?displayProperty=nameWithType> 方法的方式擷取。</span><span class="sxs-lookup"><span data-stu-id="b176d-211">The name that corresponds to a particular era number can be retrieved by passing the era number to the <xref:System.Globalization.DateTimeFormatInfo.GetEraName%2A?displayProperty=nameWithType> or <xref:System.Globalization.DateTimeFormatInfo.GetAbbreviatedEraName%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="b176d-212">下列範例會呼叫這些方法來擷取 <xref:System.Globalization.GregorianCalendar> 類別中紀元支援的相關資訊。</span><span class="sxs-lookup"><span data-stu-id="b176d-212">The following example calls these methods to retrieve information about era support in the <xref:System.Globalization.GregorianCalendar> class.</span></span>

[!code-csharp[Conceptual.Calendars#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/instantiatewithera1.cs#7)]
[!code-vb[Conceptual.Calendars#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/instantiatewithera1.vb#7)]

<span data-ttu-id="b176d-213">此外，"g" 自訂日期和時間格式字串包括曆法的紀元名稱，該名稱為日期和時間的字串表示。</span><span class="sxs-lookup"><span data-stu-id="b176d-213">In addition, the "g" custom date and time format string includes a calendar's era name in the string representation of a date and time.</span></span> <span data-ttu-id="b176d-214">如需詳細資訊，請參閱 <<c0> [ 自訂日期和時間格式字串](../../../docs/standard/base-types/custom-date-and-time-format-strings.md)。</span><span class="sxs-lookup"><span data-stu-id="b176d-214">For more information, see [Custom date and time format strings](../../../docs/standard/base-types/custom-date-and-time-format-strings.md).</span></span>

### <a name="instantiating-a-date-with-an-era"></a><span data-ttu-id="b176d-215">具現化包含紀元的日期</span><span class="sxs-lookup"><span data-stu-id="b176d-215">Instantiating a date with an era</span></span>

<span data-ttu-id="b176d-216">針對支援多個紀元的兩個 <xref:System.Globalization.Calendar> 類別，包含特定年、月和月份日期值的日期可能模稜兩可，例如 <xref:System.Globalization.JapaneseCalendar> 的四個紀元全都編號 1 到 15 的年。</span><span class="sxs-lookup"><span data-stu-id="b176d-216">For the two <xref:System.Globalization.Calendar> classes that support multiple eras, a date that consists of a particular year, month, and day of the month value can be ambiguous, For example, all four eras of the <xref:System.Globalization.JapaneseCalendar> have years numbered from 1 to 15.</span></span> <span data-ttu-id="b176d-217">一般而言，如果未指定紀元，日期和時間及曆法方法都會假設這些值屬於目前紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-217">Ordinarily, if an era is not specified, both date and time and calendar methods assume that values belong to the current era.</span></span> <span data-ttu-id="b176d-218">若要在具現化支援多個紀元之 <xref:System.Globalization.Calendar> 類別的日期時明確指定紀元，可以呼叫 <xref:System.Globalization.Calendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> 方法。</span><span class="sxs-lookup"><span data-stu-id="b176d-218">To explicitly specify the era when instantiating a date for a <xref:System.Globalization.Calendar> class that supports multiple eras, you can call the <xref:System.Globalization.Calendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="b176d-219">這個方法可讓您明確指定紀元，連同曆法的年、月、日、時、分、秒和毫秒。</span><span class="sxs-lookup"><span data-stu-id="b176d-219">This method enables you to explicitly specify an era along with the calendar's year, month, day, hour, minute, second, and millisecond.</span></span>

<span data-ttu-id="b176d-220">下列範例會使用 <xref:System.Globalization.Calendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> 方法，在 <xref:System.Globalization.JapaneseCalendar> 類別支援的每個紀元中具現化相同的日期，也就是第二年之第一個月的第一天。</span><span class="sxs-lookup"><span data-stu-id="b176d-220">The following example uses the <xref:System.Globalization.Calendar.ToDateTime%28System.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%2CSystem.Int32%29?displayProperty=nameWithType> method to instantiate the same date, the first month of the first day of the second year, in each era supported by the <xref:System.Globalization.JapaneseCalendar> class.</span></span> <span data-ttu-id="b176d-221">接著會使用日本曆法和西曆來顯示日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-221">It then displays the date in both the Japanese and Gregorian calendars.</span></span> <span data-ttu-id="b176d-222">另外還會呼叫 <xref:System.DateTime> 建構函式，說明建立日期值但未指定紀元的方法會以目前紀元建立日期。</span><span class="sxs-lookup"><span data-stu-id="b176d-222">It also calls a <xref:System.DateTime> constructor to illustrate that methods that create date values without specifying an era create dates in the current era.</span></span>

[!code-csharp[Conceptual.Calendars#7](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/instantiatewithera1.cs#7)]
[!code-vb[Conceptual.Calendars#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/instantiatewithera1.vb#7)]

### <a name="representing-dates-in-calendars-with-eras"></a><span data-ttu-id="b176d-223">以包含紀元的曆法表示日期</span><span class="sxs-lookup"><span data-stu-id="b176d-223">Representing dates in calendars with eras</span></span>

<span data-ttu-id="b176d-224">如果 <xref:System.Globalization.Calendar> 物件支援紀元而且是 <xref:System.Globalization.CultureInfo> 物件的現行曆法，則紀元會包含在完整日期和時間模式、完整日期模式及簡短日期模式之日期和時間值的字串表示中。</span><span class="sxs-lookup"><span data-stu-id="b176d-224">If a <xref:System.Globalization.Calendar> object supports eras and is the current calendar of a <xref:System.Globalization.CultureInfo> object, the era is included in the string representation of a date and time value for the full date and time, long date, and short date patterns.</span></span> <span data-ttu-id="b176d-225">下列範例顯示目前文化特性為日本 (日文) 且現行曆法為日本曆法時的這些日期模式。</span><span class="sxs-lookup"><span data-stu-id="b176d-225">The following example displays these date patterns when the current culture is Japan (Japanese) and the current calendar is the Japanese calendar.</span></span>

[!code-csharp[Conceptual.Calendars#8](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/formatstrings1.cs#8)]
[!code-vb[Conceptual.Calendars#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/formatstrings1.vb#8)]

> [!WARNING]
> <span data-ttu-id="b176d-226"><xref:System.Globalization.JapaneseCalendar>類別是唯一的行事曆類別，在.NET 中可在多個紀元，這兩個支援日期的現行曆法<xref:System.Globalization.CultureInfo>物件-具體而言，<xref:System.Globalization.CultureInfo>表示日文 （日本） 文化特性物件。</span><span class="sxs-lookup"><span data-stu-id="b176d-226">The <xref:System.Globalization.JapaneseCalendar> class is the only calendar class in .NET that both supports dates in more than one era and that can be the current calendar of a <xref:System.Globalization.CultureInfo> object - specifically, of a <xref:System.Globalization.CultureInfo> object that represents the Japanese (Japan) culture.</span></span>

<span data-ttu-id="b176d-227">針對所有曆法，"g" 自訂格式規範會在結果字串中包含紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-227">For all calendars, the "g" custom format specifier includes the era in the result string.</span></span> <span data-ttu-id="b176d-228">下列範例在現行曆法為西曆時，使用 "MM-dd-yyyy g" 自訂格式字串在結果字串中包含紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-228">The following example uses the "MM-dd-yyyy g" custom format string to include the era in the result string when the current calendar is the Gregorian calendar.</span></span>

[!code-csharp[Conceptual.Calendars#9](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/formatstrings2.cs#9)]
[!code-vb[Conceptual.Calendars#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/formatstrings2.vb#9)]

<span data-ttu-id="b176d-229">在日期的字串表示不是以現行曆法表示的情況下，<xref:System.Globalization.Calendar> 類別會包含 <xref:System.Globalization.Calendar.GetEra%2A?displayProperty=nameWithType> 方法，該方法可搭配 <xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>、<xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType> 和 <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> 方法用來明確指出日期，以及該日期所屬的紀元。</span><span class="sxs-lookup"><span data-stu-id="b176d-229">In cases where the string representation of a date is expressed in a calendar that is not the current calendar, the <xref:System.Globalization.Calendar> class includes a <xref:System.Globalization.Calendar.GetEra%2A?displayProperty=nameWithType> method that can be used along with the <xref:System.Globalization.Calendar.GetYear%2A?displayProperty=nameWithType>, <xref:System.Globalization.Calendar.GetMonth%2A?displayProperty=nameWithType>, and <xref:System.Globalization.Calendar.GetDayOfMonth%2A?displayProperty=nameWithType> methods to unambiguously indicate a date as well as the era to which it belongs.</span></span> <span data-ttu-id="b176d-230">下列範例使用 <xref:System.Globalization.JapaneseLunisolarCalendar> 類別提供圖例。</span><span class="sxs-lookup"><span data-stu-id="b176d-230">The following example uses the <xref:System.Globalization.JapaneseLunisolarCalendar> class to provide an illustration.</span></span> <span data-ttu-id="b176d-231">不過請注意，若要在結果字串中包含代表紀元的有意義名稱或縮寫而非整數，必須將 <xref:System.Globalization.DateTimeFormatInfo> 物件具現化，並且讓 <xref:System.Globalization.JapaneseCalendar> 成為現行曆法 </span><span class="sxs-lookup"><span data-stu-id="b176d-231">However, note that including a meaningful name or abbreviation instead of an integer for the era in the result string requires that you instantiate a <xref:System.Globalization.DateTimeFormatInfo> object and make <xref:System.Globalization.JapaneseCalendar> its current calendar.</span></span> <span data-ttu-id="b176d-232">(<xref:System.Globalization.JapaneseLunisolarCalendar> 曆法不得為任何文化特性的現行曆法，但在這個案例中，兩個曆法共用相同的紀元)。</span><span class="sxs-lookup"><span data-stu-id="b176d-232">(The <xref:System.Globalization.JapaneseLunisolarCalendar> calendar cannot be the current calendar of any culture, but in this case the two calendars share the same eras.)</span></span>

[!code-csharp[Conceptual.Calendars#10](../../../samples/snippets/csharp/VS_Snippets_CLR/conceptual.calendars/cs/formatstrings3.cs#10)]
[!code-vb[Conceptual.Calendars#10](../../../samples/snippets/visualbasic/VS_Snippets_CLR/conceptual.calendars/vb/formatstrings3.vb#10)]

## <a name="see-also"></a><span data-ttu-id="b176d-233">另請參閱</span><span class="sxs-lookup"><span data-stu-id="b176d-233">See also</span></span>

* [<span data-ttu-id="b176d-234">如何： 在非西曆中顯示日期</span><span class="sxs-lookup"><span data-stu-id="b176d-234">How to: Display dates in non-Gregorian calendars</span></span>](../../../docs/standard/base-types/how-to-display-dates-in-non-gregorian-calendars.md)
* [<span data-ttu-id="b176d-235">範例： 行事曆週範圍公用程式</span><span class="sxs-lookup"><span data-stu-id="b176d-235">Sample: Calendar week range utility</span></span>](https://code.msdn.microsoft.com/NET-Framework-4-Calendar-3360a84a)
