---
title: 在各時區間轉換時間
ms.date: 04/10/2017
ms.technology: dotnet-standard
dev_langs:
- csharp
- vb
helpviewer_keywords:
- times [.NET Framework], converting
- time zones [.NET Framework], conversions
- UTC times, converting
- converting times
- local time conversions
ms.assetid: a51e1a3b-c983-4320-b31a-1f9fa3cf824a
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 0c77832a4c578ddb2c8a427b133e53ab4ab5c5e3
ms.sourcegitcommit: 6eac9a01ff5d70c6d18460324c016a3612c5e268
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/14/2018
ms.locfileid: "45595622"
---
# <a name="converting-times-between-time-zones"></a><span data-ttu-id="ea194-102">在各時區間轉換時間</span><span class="sxs-lookup"><span data-stu-id="ea194-102">Converting times between time zones</span></span>

<span data-ttu-id="ea194-103">對於使用日期和時間來處理時區差異的任何應用程式，它會變得越來越重要。</span><span class="sxs-lookup"><span data-stu-id="ea194-103">It is becoming increasingly important for any application that works with dates and times to handle differences between time zones.</span></span> <span data-ttu-id="ea194-104">應用程式不會再假設，隨時可以是以當地時間表示，這是時間可從<xref:System.DateTime>結構。</span><span class="sxs-lookup"><span data-stu-id="ea194-104">An application can no longer assume that all times can be expressed in the local time, which is the time available from the <xref:System.DateTime> structure.</span></span> <span data-ttu-id="ea194-105">例如，顯示美國東部目前時間的網頁對東亞地區的客戶不具公信力。</span><span class="sxs-lookup"><span data-stu-id="ea194-105">For example, a Web page that displays the current time in the eastern part of the United States will lack credibility to a customer in eastern Asia.</span></span> <span data-ttu-id="ea194-106">本主題說明如何將時間從某個時區轉換到另一個，以及如何將轉換<xref:System.DateTimeOffset>具有有限時區感知的值。</span><span class="sxs-lookup"><span data-stu-id="ea194-106">This topic explains how to convert times from one time zone to another, as well as how to convert <xref:System.DateTimeOffset> values that have limited time zone awareness.</span></span>

## <a name="converting-to-coordinated-universal-time"></a><span data-ttu-id="ea194-107">轉換為國際標準時間</span><span class="sxs-lookup"><span data-stu-id="ea194-107">Converting to Coordinated Universal Time</span></span>

<span data-ttu-id="ea194-108">國際標準時間 (UTC) 是高精確度且不可部分完成的時間標準。</span><span class="sxs-lookup"><span data-stu-id="ea194-108">Coordinated Universal Time (UTC) is a high-precision, atomic time standard.</span></span> <span data-ttu-id="ea194-109">全世界的時區都會表示為與 UTC 的正或負位移。</span><span class="sxs-lookup"><span data-stu-id="ea194-109">The world’s time zones are expressed as positive or negative offsets from UTC.</span></span> <span data-ttu-id="ea194-110">因此，UTC 提供一種無時區或時區中性時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-110">Thus, UTC provides a kind of time-zone free or time-zone neutral time.</span></span> <span data-ttu-id="ea194-111">跨電腦的日期和時間可攜性十分重要時，建議使用 UTC 時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-111">The use of UTC time is recommended when a date and time's portability across computers is important.</span></span> <span data-ttu-id="ea194-112">(如需詳細資料和其他使用日期和時間的最佳做法，請參閱[撰寫程式碼使用.NET Framework 中的日期時間的最佳做法](https://msdn.microsoft.com/library/ms973825.aspx)。)將個別時區轉換為 UTC 可輕鬆地比較時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-112">(For details and other best practices using dates and times, see [Coding best practices using DateTime in the .NET Framework](https://msdn.microsoft.com/library/ms973825.aspx).) Converting individual time zones to UTC makes time comparisons easy.</span></span>

> [!NOTE]
> <span data-ttu-id="ea194-113">您也可以序列化<xref:System.DateTimeOffset>結構來明確代表單一點的時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-113">You can also serialize a <xref:System.DateTimeOffset> structure to unambiguously represent a single point in time.</span></span> <span data-ttu-id="ea194-114">因為<xref:System.DateTimeOffset>物件會儲存日期和時間的值，以及其與 UTC 的時差，所以它們一律代表特定點的關聯性中的時間為 UTC。</span><span class="sxs-lookup"><span data-stu-id="ea194-114">Because <xref:System.DateTimeOffset> objects store a date and time value along with its offset from UTC, they always represent a particular point in time in relationship to UTC.</span></span>

<span data-ttu-id="ea194-115">將時間轉換為 UTC 的最簡單方式是呼叫`static`(`Shared` Visual Basic 中)<xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-115">The easiest way to convert a time to UTC is to call the `static` (`Shared` in Visual Basic) <xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="ea194-116">方法所執行的確切轉換取決於 windows 7`dateTime`參數的<xref:System.DateTime.Kind%2A>屬性，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="ea194-116">The exact conversion performed by the method depends on the value of the `dateTime` parameter's <xref:System.DateTime.Kind%2A> property, as the following table shows.</span></span>

| `DateTime.Kind`            | <span data-ttu-id="ea194-117">轉換</span><span class="sxs-lookup"><span data-stu-id="ea194-117">Conversion</span></span>                                                                     |
| -------------------------- | ------------------------------------------------------------------------------ |
| `DateTimeKind.Local`       | <span data-ttu-id="ea194-118">將當地時間轉換為 UTC。</span><span class="sxs-lookup"><span data-stu-id="ea194-118">Converts local time to UTC.</span></span>                                                    |
| `DateTimeKind.Unspecified` | <span data-ttu-id="ea194-119">假設 `dateTime` 參數是當地時間，並將當地時間轉換為 UTC。</span><span class="sxs-lookup"><span data-stu-id="ea194-119">Assumes the `dateTime` parameter is local time and converts local time to UTC.</span></span> |
| `DateTimeKind.Utc`         | <span data-ttu-id="ea194-120">傳回未變更的 `dateTime` 參數。</span><span class="sxs-lookup"><span data-stu-id="ea194-120">Returns the `dateTime` parameter unchanged.</span></span>                                    |

<span data-ttu-id="ea194-121">下列程式碼會將目前當地時間轉換為 UTC，並將結果顯示到主控台。</span><span class="sxs-lookup"><span data-stu-id="ea194-121">The following code converts the current local time to UTC and displays the result to the console.</span></span>

[!code-csharp[System.TimeZone2.Concepts#6](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#6)]
[!code-vb[System.TimeZone2.Concepts#6](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#6)]

> [!NOTE]
> <span data-ttu-id="ea194-122"><xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType>方法不一定會產生相同的結果<xref:System.TimeZone.ToUniversalTime%2A?displayProperty=nameWithType>和<xref:System.DateTime.ToUniversalTime%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-122">The <xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType> method does not necessarily produce results that are identical to the <xref:System.TimeZone.ToUniversalTime%2A?displayProperty=nameWithType> and <xref:System.DateTime.ToUniversalTime%2A?displayProperty=nameWithType> methods.</span></span> <span data-ttu-id="ea194-123">如果主機系統的當地時區包含多個調整規則，<xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType>適當的規則適用於特定日期和時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-123">If the host system's local time zone includes multiple adjustment rules, <xref:System.TimeZoneInfo.ConvertTimeToUtc%28System.DateTime%29?displayProperty=nameWithType> applies the appropriate rule to a particular date and time.</span></span> <span data-ttu-id="ea194-124">另兩種方法一律會套用最新的調整規則。</span><span class="sxs-lookup"><span data-stu-id="ea194-124">The other two methods always apply the latest adjustment rule.</span></span>

<span data-ttu-id="ea194-125">如果日期和時間值不代表當地時間或 UTC，<xref:System.DateTime.ToUniversalTime%2A>方法可能會傳回錯誤結果。</span><span class="sxs-lookup"><span data-stu-id="ea194-125">If the date and time value does not represent either the local time or UTC, the <xref:System.DateTime.ToUniversalTime%2A> method will likely return an erroneous result.</span></span> <span data-ttu-id="ea194-126">不過，您可以使用<xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType>方法，以從指定的時區轉換的日期和時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-126">However, you can use the <xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType> method to convert the date and time from a specified time zone.</span></span> <span data-ttu-id="ea194-127">(如需有關擷取<xref:System.TimeZoneInfo>物件，代表目的地時區中，請參閱[尋找定義於本機系統的時區](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)。)下列程式碼會使用<xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType>方法將美加東部標準時間轉換為 UTC。</span><span class="sxs-lookup"><span data-stu-id="ea194-127">(For details on retrieving a <xref:System.TimeZoneInfo> object that represents the destination time zone, see [Finding the time zones defined on a local system](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md).) The following code uses the <xref:System.TimeZoneInfo.ConvertTimeToUtc%2A?displayProperty=nameWithType> method to convert Eastern Standard Time to UTC.</span></span>

[!code-csharp[System.TimeZone2.Concepts#7](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#7)]
[!code-vb[System.TimeZone2.Concepts#7](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#7)]

<span data-ttu-id="ea194-128">請注意，此方法會擲回<xref:System.ArgumentException>如果<xref:System.DateTime>物件的<xref:System.DateTime.Kind%2A>屬性和時區不相符。</span><span class="sxs-lookup"><span data-stu-id="ea194-128">Note that this method throws an <xref:System.ArgumentException> if the <xref:System.DateTime> object's <xref:System.DateTime.Kind%2A> property and the time zone are mismatched.</span></span> <span data-ttu-id="ea194-129">如果發生不符的情形<xref:System.DateTime.Kind%2A>屬性是<xref:System.DateTimeKind.Local?displayProperty=nameWithType>但<xref:System.TimeZoneInfo>物件不代表當地時區，或如果<xref:System.DateTime.Kind%2A>屬性<xref:System.DateTimeKind.Utc?displayProperty=nameWithType>但<xref:System.TimeZoneInfo>物件不等於<xref:System.TimeZoneInfo.Utc?displayProperty=nameWithType>。</span><span class="sxs-lookup"><span data-stu-id="ea194-129">A mismatch occurs if the <xref:System.DateTime.Kind%2A> property is <xref:System.DateTimeKind.Local?displayProperty=nameWithType> but the <xref:System.TimeZoneInfo> object does not represent the local time zone, or if the <xref:System.DateTime.Kind%2A> property is <xref:System.DateTimeKind.Utc?displayProperty=nameWithType> but the <xref:System.TimeZoneInfo> object does not equal <xref:System.TimeZoneInfo.Utc?displayProperty=nameWithType>.</span></span>

<span data-ttu-id="ea194-130">所有這些方法採取<xref:System.DateTime>值做為參數和傳回<xref:System.DateTime>值。</span><span class="sxs-lookup"><span data-stu-id="ea194-130">All of these methods take <xref:System.DateTime> values as parameters and return a <xref:System.DateTime> value.</span></span> <span data-ttu-id="ea194-131">針對<xref:System.DateTimeOffset>值，<xref:System.DateTimeOffset>結構具有<xref:System.DateTimeOffset.ToUniversalTime%2A>執行個體方法，將目前的執行個體的時間與日期轉換為 UTC。</span><span class="sxs-lookup"><span data-stu-id="ea194-131">For <xref:System.DateTimeOffset> values, the <xref:System.DateTimeOffset> structure has a <xref:System.DateTimeOffset.ToUniversalTime%2A> instance method that converts the date and time of the current instance to UTC.</span></span> <span data-ttu-id="ea194-132">下列範例會呼叫<xref:System.DateTimeOffset.ToUniversalTime%2A>方法，以將當地時間和數個其他時間轉換為 Coordinated Universal Time (UTC)。</span><span class="sxs-lookup"><span data-stu-id="ea194-132">The following example calls the <xref:System.DateTimeOffset.ToUniversalTime%2A> method to convert a local time and several other times to Coordinated Universal Time (UTC).</span></span>

[!code-csharp[System.DateTimeOffset.Methods#16](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.DateTimeOffset.Methods/cs/Methods.cs#16)]
[!code-vb[System.DateTimeOffset.Methods#16](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.DateTimeOffset.Methods/vb/Methods.vb#16)]

## <a name="converting-utc-to-a-designated-time-zone"></a><span data-ttu-id="ea194-133">將 UTC 轉換為指定的時區</span><span class="sxs-lookup"><span data-stu-id="ea194-133">Converting UTC to a designated time zone</span></span>

<span data-ttu-id="ea194-134">若要將 UTC 轉換為當地時間，請參閱 「 轉換 UTC 到本地時間 」 一節。</span><span class="sxs-lookup"><span data-stu-id="ea194-134">To convert UTC to local time, see the "Converting UTC to Local Time" section that follows.</span></span> <span data-ttu-id="ea194-135">若要將 UTC 轉換為您指定的任何時區的時間，呼叫<xref:System.TimeZoneInfo.ConvertTimeFromUtc%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-135">To convert UTC to the time in any time zone that you designate, call the <xref:System.TimeZoneInfo.ConvertTimeFromUtc%2A> method.</span></span> <span data-ttu-id="ea194-136">這個方法採用兩個參數：</span><span class="sxs-lookup"><span data-stu-id="ea194-136">The method takes two parameters:</span></span>

* <span data-ttu-id="ea194-137">要轉換的 UTC。</span><span class="sxs-lookup"><span data-stu-id="ea194-137">The UTC to convert.</span></span> <span data-ttu-id="ea194-138">這必須是<xref:System.DateTime>值<xref:System.DateTime.Kind%2A>屬性設定為`Unspecified`或`Utc`。</span><span class="sxs-lookup"><span data-stu-id="ea194-138">This must be a <xref:System.DateTime> value whose <xref:System.DateTime.Kind%2A> property is set to `Unspecified` or `Utc`.</span></span>

* <span data-ttu-id="ea194-139">要將 UTC 轉換為的時區。</span><span class="sxs-lookup"><span data-stu-id="ea194-139">The time zone to convert the UTC to.</span></span>

<span data-ttu-id="ea194-140">下列程式碼會將 UTC 轉換為美加中部標準時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-140">The following code converts UTC to Central Standard Time.</span></span>

[!code-csharp[System.TimeZone2.Concepts#8](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#8)]
[!code-vb[System.TimeZone2.Concepts#8](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#8)]

## <a name="converting-utc-to-local-time"></a><span data-ttu-id="ea194-141">將 UTC 轉換為當地時間</span><span class="sxs-lookup"><span data-stu-id="ea194-141">Converting UTC to local time</span></span>

<span data-ttu-id="ea194-142">若要將 UTC 轉換為當地時間，呼叫<xref:System.DateTime.ToLocalTime%2A>方法的<xref:System.DateTime>物件您想要轉換的時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-142">To convert UTC to local time, call the <xref:System.DateTime.ToLocalTime%2A> method of the <xref:System.DateTime> object whose time you want to convert.</span></span> <span data-ttu-id="ea194-143">方法的確切行為取決於物件的值<xref:System.DateTime.Kind%2A>屬性，如下表所示。</span><span class="sxs-lookup"><span data-stu-id="ea194-143">The exact behavior of the method depends on the value of the object’s <xref:System.DateTime.Kind%2A> property, as the following table shows.</span></span>

| `DateTime.Kind`            | <span data-ttu-id="ea194-144">轉換</span><span class="sxs-lookup"><span data-stu-id="ea194-144">Conversion</span></span>                                                                               |
| -------------------------- | ---------------------------------------------------------------------------------------- |
| `DateTimeKind.Local`       | <span data-ttu-id="ea194-145">傳回<xref:System.DateTime>保持不變的值。</span><span class="sxs-lookup"><span data-stu-id="ea194-145">Returns the <xref:System.DateTime> value unchanged.</span></span>                                      |
| `DateTimeKind.Unspecified` | <span data-ttu-id="ea194-146">假設<xref:System.DateTime>值為 UTC，並將 UTC 轉換為當地時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-146">Assumes that the <xref:System.DateTime> value is UTC and converts the UTC to local time.</span></span> |
| `DateTimeKind.Utc`         | <span data-ttu-id="ea194-147">將轉換<xref:System.DateTime>為當地時間的值。</span><span class="sxs-lookup"><span data-stu-id="ea194-147">Converts the <xref:System.DateTime> value to local time.</span></span>                                 |

> [!NOTE]
> <span data-ttu-id="ea194-148"><xref:System.TimeZone.ToLocalTime%2A?displayProperty=nameWithType>方法的行為相同`DateTime.ToLocalTime`方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-148">The <xref:System.TimeZone.ToLocalTime%2A?displayProperty=nameWithType> method behaves identically to the `DateTime.ToLocalTime` method.</span></span> <span data-ttu-id="ea194-149">它會採用單一參數，這是要轉換的日期和時間值。</span><span class="sxs-lookup"><span data-stu-id="ea194-149">It takes a single parameter, which is the date and time value to convert.</span></span>

<span data-ttu-id="ea194-150">您也可以轉換為當地時間的時間，在任何指定的時區中，使用`static`(`Shared` Visual Basic 中)<xref:System.TimeZoneInfo.ConvertTime%2A?displayProperty=nameWithType>方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-150">You can also convert the time in any designated time zone to local time by using the `static` (`Shared` in Visual Basic) <xref:System.TimeZoneInfo.ConvertTime%2A?displayProperty=nameWithType> method.</span></span> <span data-ttu-id="ea194-151">這項技術會在下一節中討論。</span><span class="sxs-lookup"><span data-stu-id="ea194-151">This technique is discussed in the next section.</span></span>

## <a name="converting-between-any-two-time-zones"></a><span data-ttu-id="ea194-152">在兩個時區之間轉換</span><span class="sxs-lookup"><span data-stu-id="ea194-152">Converting between any two time zones</span></span>

<span data-ttu-id="ea194-153">您可以使用下列兩個的任兩個時區之間轉換`static`(`Shared` Visual Basic 中) 的方法<xref:System.TimeZoneInfo>類別：</span><span class="sxs-lookup"><span data-stu-id="ea194-153">You can convert between any two time zones by using either of the following two `static` (`Shared` in Visual Basic) methods of the <xref:System.TimeZoneInfo> class:</span></span>

* <xref:System.TimeZoneInfo.ConvertTime%2A>

  <span data-ttu-id="ea194-154">此方法的參數是日期和時間值轉換時，`TimeZoneInfo`物件，表示日期和時間值的時區和`TimeZoneInfo`物件，表示要轉換的日期和時間值的時區。</span><span class="sxs-lookup"><span data-stu-id="ea194-154">This method's parameters are the date and time value to convert, a `TimeZoneInfo` object that represents the time zone of the date and time value, and a `TimeZoneInfo` object that represents the time zone to convert the date and time value to.</span></span>

* <xref:System.TimeZoneInfo.ConvertTimeBySystemTimeZoneId%2A>

  <span data-ttu-id="ea194-155">此方法的參數是時區的日期和時間值轉換、 的日期和時間值的時區識別項以及日期和時間值轉換為識別項。</span><span class="sxs-lookup"><span data-stu-id="ea194-155">This method's parameters are the date and time value to convert, the identifier of the date and time value's time zone, and the identifier of the time zone to convert the date and time value to.</span></span>

<span data-ttu-id="ea194-156">這兩種方法需要<xref:System.DateTime.Kind%2A>要轉換的日期和時間值的屬性和<xref:System.TimeZoneInfo>代表其時區的物件或時區的識別項對應至另一部。</span><span class="sxs-lookup"><span data-stu-id="ea194-156">Both methods require that the <xref:System.DateTime.Kind%2A> property of the date and time value to convert and the <xref:System.TimeZoneInfo> object or time zone identifier that represents its time zone correspond to one another.</span></span> <span data-ttu-id="ea194-157">否則會擲回 <xref:System.ArgumentException>。</span><span class="sxs-lookup"><span data-stu-id="ea194-157">Otherwise, an <xref:System.ArgumentException> is thrown.</span></span> <span data-ttu-id="ea194-158">例如，如果`Kind`屬性的日期和時間值是`DateTimeKind.Local`，如果擲回例外狀況`TimeZoneInfo`做為參數傳遞給方法的物件是否不等於`TimeZoneInfo.Local`。</span><span class="sxs-lookup"><span data-stu-id="ea194-158">For example, if the `Kind` property of the date and time value is `DateTimeKind.Local`, an exception is thrown if the `TimeZoneInfo` object passed as a parameter to the method is not equal to `TimeZoneInfo.Local`.</span></span> <span data-ttu-id="ea194-159">例外狀況也會擲回做為參數傳遞給方法的識別項是否不等於`TimeZoneInfo.Local.Id`。</span><span class="sxs-lookup"><span data-stu-id="ea194-159">An exception is also thrown if the identifier passed as a parameter to the method is not equal to `TimeZoneInfo.Local.Id`.</span></span>

<span data-ttu-id="ea194-160">下列範例會使用<xref:System.TimeZoneInfo.ConvertTime%2A>方法，將夏威夷標準時間轉換為當地時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-160">The following example uses the <xref:System.TimeZoneInfo.ConvertTime%2A> method to convert from Hawaiian Standard Time to local time.</span></span>

[!code-csharp[System.TimeZone2.Concepts#9](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.TimeZone2.Concepts/CS/TimeZone2Concepts.cs#9)]
[!code-vb[System.TimeZone2.Concepts#9](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.TimeZone2.Concepts/VB/TimeZone2Concepts.vb#9)]

## <a name="converting-datetimeoffset-values"></a><span data-ttu-id="ea194-161">轉換 DateTimeOffset 值</span><span class="sxs-lookup"><span data-stu-id="ea194-161">Converting DateTimeOffset values</span></span>

<span data-ttu-id="ea194-162">所表示的日期和時間值<xref:System.DateTimeOffset>物件不是完全時區感知物件會與其時區解除關聯時，因為它具現化。</span><span class="sxs-lookup"><span data-stu-id="ea194-162">Date and time values represented by <xref:System.DateTimeOffset> objects are not fully time-zone aware because the object is disassociated from its time zone at the time it is instantiated.</span></span> <span data-ttu-id="ea194-163">不過，在許多情況下，應用程式只需要根據與 UTC 的兩個不同位移來轉換日期和時間，而不是根據特定時區的時間。</span><span class="sxs-lookup"><span data-stu-id="ea194-163">However, in many cases an application simply needs to convert a date and time based on two different offsets from UTC rather than on the time in particular time zones.</span></span> <span data-ttu-id="ea194-164">若要執行這項轉換，您可以呼叫目前的執行個體<xref:System.DateTimeOffset.ToOffset%2A>方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-164">To perform this conversion, you can call the current instance's <xref:System.DateTimeOffset.ToOffset%2A> method.</span></span> <span data-ttu-id="ea194-165">方法的單一參數是新的日期和時間值，這個方法會傳回值的位移。</span><span class="sxs-lookup"><span data-stu-id="ea194-165">The method's single parameter is the offset of the new date and time value that the method is to return.</span></span>

<span data-ttu-id="ea194-166">例如，如果網頁使用者要求的日期和時間已知且序列化為字串 (格式為 MM/dd/yyyy hh:mm:ss zzzz)，則下列 `ReturnTimeOnServer` 方法會將這個日期和時間值轉換為 Web 伺服器上的時間和日期。</span><span class="sxs-lookup"><span data-stu-id="ea194-166">For example, if the date and time of a user request for a Web page is known and is serialized as a string in the format MM/dd/yyyy hh:mm:ss zzzz, the following `ReturnTimeOnServer` method converts this date and time value to the date and time on the Web server.</span></span>

[!code-csharp[System.DateTimeOffset.Conceptual.OffsetConversions#1](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/cs/TimeConversions.cs#1)]
[!code-vb[System.DateTimeOffset.Conceptual.OffsetConversions#1](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/vb/TimeConversions.vb#1)] 

<span data-ttu-id="ea194-167">如果將字串 "9/1/2007 5:32:07 -05:00" 傳遞給這個方法，代表時區中的日期和時間比 UTC 早五個小時，就會傳回 9/1/2007 3:32:07 AM -07:00，代表伺服器位於美國太平洋標準時區。</span><span class="sxs-lookup"><span data-stu-id="ea194-167">If the method is passed the string "9/1/2007 5:32:07 -05:00", which represents the date and time in a time zone five hours earlier than UTC, it returns 9/1/2007 3:32:07 AM -07:00 for a server located in the U.S. Pacific Standard Time zone.</span></span>

<span data-ttu-id="ea194-168"><xref:System.TimeZoneInfo>類別也包含的多載<xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29?displayProperty=nameWithType>方法，會使用時區轉換<xref:System.DateTimeOffset.ToOffset(System.TimeSpan)>值。</span><span class="sxs-lookup"><span data-stu-id="ea194-168">The <xref:System.TimeZoneInfo> class also includes an overload of the <xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29?displayProperty=nameWithType> method that performs time zone conversions with <xref:System.DateTimeOffset.ToOffset(System.TimeSpan)> values.</span></span> <span data-ttu-id="ea194-169">方法的參數是<xref:System.DateTimeOffset>值以及時區的時間要轉換的參考。</span><span class="sxs-lookup"><span data-stu-id="ea194-169">The method's parameters are a <xref:System.DateTimeOffset> value and a reference to the time zone to which the time is to be converted.</span></span> <span data-ttu-id="ea194-170">方法呼叫傳回<xref:System.DateTimeOffset>值。</span><span class="sxs-lookup"><span data-stu-id="ea194-170">The method call returns a <xref:System.DateTimeOffset> value.</span></span> <span data-ttu-id="ea194-171">例如，`ReturnTimeOnServer`可以如下所示改寫上一個範例中的方法，來呼叫<xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29>方法。</span><span class="sxs-lookup"><span data-stu-id="ea194-171">For example, the `ReturnTimeOnServer` method in the previous example could be rewritten as follows to call the <xref:System.TimeZoneInfo.ConvertTime%28System.DateTimeOffset%2CSystem.TimeZoneInfo%29> method.</span></span>

[!code-csharp[System.DateTimeOffset.Conceptual.OffsetConversions#2](../../../samples/snippets/csharp/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/cs/timeconversions2.cs#2)]
[!code-vb[System.DateTimeOffset.Conceptual.OffsetConversions#2](../../../samples/snippets/visualbasic/VS_Snippets_CLR_System/system.DateTimeOffset.Conceptual.OffsetConversions/vb/TimeConversions2.vb#2)]

## <a name="see-also"></a><span data-ttu-id="ea194-172">另請參閱</span><span class="sxs-lookup"><span data-stu-id="ea194-172">See also</span></span>

* <xref:System.TimeZoneInfo>
* [<span data-ttu-id="ea194-173">日期、時間和時區</span><span class="sxs-lookup"><span data-stu-id="ea194-173">Dates, times, and time zones</span></span>](../../../docs/standard/datetime/index.md)
* [<span data-ttu-id="ea194-174">尋找本機系統上定義的時區</span><span class="sxs-lookup"><span data-stu-id="ea194-174">Finding the time zones defined on a local system</span></span>](../../../docs/standard/datetime/finding-the-time-zones-on-local-system.md)
