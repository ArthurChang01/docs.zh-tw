---
title: .NET Portability Analyzer - .NET
description: 了解如何使用.NET Portability Analyzer 工具來評估程式碼移植到不同 .NET 實作之間的可行性，包括 .NET Core、.NET Standard、UWP 和 Xamarin。
ms.date: 09/13/2019
ms.technology: dotnet-standard
ms.assetid: 0375250f-5704-4993-a6d5-e21c499cea1e
ms.openlocfilehash: e0a5c791926b36fe5a35c5446471c3dcdb75cd7b
ms.sourcegitcommit: 559259da2738a7b33a46c0130e51d336091c2097
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 10/22/2019
ms.locfileid: "72774382"
---
# <a name="the-net-portability-analyzer"></a><span data-ttu-id="860c2-103">.NET Portability Analyzer</span><span class="sxs-lookup"><span data-stu-id="860c2-103">The .NET Portability Analyzer</span></span>

<span data-ttu-id="860c2-104">要讓您的程式庫支援多平台？</span><span class="sxs-lookup"><span data-stu-id="860c2-104">Want to make your libraries support multi-platform?</span></span> <span data-ttu-id="860c2-105">想要查看需要多少工作才能讓您的 .NET Framework 應用程式在 .NET Core 上執行？</span><span class="sxs-lookup"><span data-stu-id="860c2-105">Want to see how much work is required to make your .NET Framework application run on .NET Core?</span></span> <span data-ttu-id="860c2-106">[.Net 可攜性分析器](https://github.com/microsoft/dotnet-apiport)是一種工具，可分析元件，並提供有關 .net api 的詳細報表，這些應用程式或程式庫在您指定的目標 .net 平臺上是可移植的。</span><span class="sxs-lookup"><span data-stu-id="860c2-106">The [.NET Portability Analyzer](https://github.com/microsoft/dotnet-apiport) is a tool that analyzes assemblies and provides a detailed report on .NET APIs that are missing for the applications or libraries to be portable on your specified targeted .NET platforms.</span></span> <span data-ttu-id="860c2-107">可攜性分析器以[Visual Studio 延伸](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer)模組的形式提供，它會分析每個專案的一個元件，並作為[ApiPort 主控台應用程式](https://aka.ms/apiportdownload)，以根據指定的檔案或目錄來分析元件。</span><span class="sxs-lookup"><span data-stu-id="860c2-107">The Portability Analyzer is offered as a [Visual Studio Extension](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer), which analyzes one assembly per project, and as a [ApiPort console app](https://aka.ms/apiportdownload), which analyzes assemblies by specified files or directory.</span></span>

<span data-ttu-id="860c2-108">當您將專案轉換成以新平臺（例如 .NET Core）為目標時，您可以使用以 Roslyn 為基礎的[API 分析器工具](api-analyzer.md)來識別會擲回 <xref:System.PlatformNotSupportedException> 例外狀況和其他相容性問題的 API。</span><span class="sxs-lookup"><span data-stu-id="860c2-108">Once you've converted your project to target the new platform, like .NET Core, you can use the Roslyn-based [API Analyzer tool](api-analyzer.md) to identify APIs throwing <xref:System.PlatformNotSupportedException> exceptions and other compatibility issues.</span></span>

## <a name="common-targets"></a><span data-ttu-id="860c2-109">常見目標</span><span class="sxs-lookup"><span data-stu-id="860c2-109">Common targets</span></span>

- <span data-ttu-id="860c2-110">[.NET Core](../../core/index.md)︰具有模組化的設計，採用並存，並且適合在跨平台的情況下使用。</span><span class="sxs-lookup"><span data-stu-id="860c2-110">[.NET Core](../../core/index.md): Has a modular design, employs side-by-side, and targets cross-platform scenarios.</span></span> <span data-ttu-id="860c2-111">並存可讓您採用新的 .NET Core 版本，而不會中斷其他應用程式。</span><span class="sxs-lookup"><span data-stu-id="860c2-111">Side-by-side allows you to adopt new .NET Core versions without breaking other apps.</span></span> <span data-ttu-id="860c2-112">如果您的目標，是要將應用程式移植到 .NET Core 來支援跨平台，這是建議的目標。</span><span class="sxs-lookup"><span data-stu-id="860c2-112">If your goal is to port your app to .NET Core supporting cross-platforms, this is the recommended target.</span></span>
- <span data-ttu-id="860c2-113">.[NET Standard](../../standard/net-standard.md)：包含適用于所有 .NET 部署的 .NET Standard API。</span><span class="sxs-lookup"><span data-stu-id="860c2-113">.[NET Standard](../../standard/net-standard.md): Includes the .NET Standard APIs available on all .NET implementations.</span></span> <span data-ttu-id="860c2-114">如果您的目標，是讓程式庫在所有支援 .NET 的平台上執行，這是建議的目標。</span><span class="sxs-lookup"><span data-stu-id="860c2-114">If your goal is to make your library to run on all .NET supported platforms, this is recommended target.</span></span>
- <span data-ttu-id="860c2-115">[ASP.NET Core](/aspnet/core)：以 .NET Core 為基礎的新式 web 架構。</span><span class="sxs-lookup"><span data-stu-id="860c2-115">[ASP.NET Core](/aspnet/core): A modern web-framework built on .NET Core.</span></span> <span data-ttu-id="860c2-116">如果您的目標，是要將 Web 應用程式移植到 .NET Core 來支援多平台，這是建議的目標。</span><span class="sxs-lookup"><span data-stu-id="860c2-116">If your goal is to port your web app to .NET Core to support multiple platforms, this is the recommended target.</span></span>
- <span data-ttu-id="860c2-117">.NET Core +[平臺延伸](../../core/porting/windows-compat-pack.md)模組：除了 Windows 相容性套件以外，還包含 .NET Core API，提供許多可用的 .NET Framework 技術。</span><span class="sxs-lookup"><span data-stu-id="860c2-117">.NET Core + [Platform Extensions](../../core/porting/windows-compat-pack.md): Includes the .NET Core APIs in addition to the Windows Compatibility Pack, which provides many of the .NET Framework available technologies.</span></span> <span data-ttu-id="860c2-118">如需將您的應用程式從 .NET Framework 移植到 Windows 上的 .NET Core，這是建議的目標。</span><span class="sxs-lookup"><span data-stu-id="860c2-118">This is a recommended target for porting your app from .NET Framework to .NET Core on Windows.</span></span>
- <span data-ttu-id="860c2-119">.NET Standard +[平臺擴充](../../core/porting/windows-compat-pack.md)功能：除了 Windows 相容性套件以外，還包括 .NET Standard API，其提供許多 .NET Framework 可用的技術。</span><span class="sxs-lookup"><span data-stu-id="860c2-119">.NET Standard + [Platform Extensions](../../core/porting/windows-compat-pack.md): Includes the .NET Standard APIs in addition to the Windows Compatibility Pack, which provides many of the .NET Framework available technologies.</span></span> <span data-ttu-id="860c2-120">如需將您的程式庫從 .NET Framework 移植到 Windows 上的 .NET Core，這是建議的目標。</span><span class="sxs-lookup"><span data-stu-id="860c2-120">This is a recommended target for porting your library from .NET Framework to .NET Core on Windows.</span></span>

## <a name="how-to-use-the-net-portability-analyzer"></a><span data-ttu-id="860c2-121">如何使用 .NET 可攜性分析器</span><span class="sxs-lookup"><span data-stu-id="860c2-121">How to use the .NET Portability Analyzer</span></span>

<span data-ttu-id="860c2-122">若要開始在 Visual Studio 中使用 .NET 可攜性分析器，您必須從 [Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer) 下載及安裝此延伸模組。</span><span class="sxs-lookup"><span data-stu-id="860c2-122">To begin using the .NET Portability Analyzer in Visual Studio, you first need to download and install the extension from the [Visual Studio Marketplace](https://marketplace.visualstudio.com/items?itemName=ConnieYau.NETPortabilityAnalyzer).</span></span> <span data-ttu-id="860c2-123">它適用於 Visual Studio 2017 和更新版本。</span><span class="sxs-lookup"><span data-stu-id="860c2-123">It works on Visual Studio 2017 and later versions.</span></span> <span data-ttu-id="860c2-124">您可以透過**分析** > **可攜性分析器設定**並選取目標平台 (這是您要評估可攜性間距的 .NET 平台/版本，與建置您目前組件的平台/版本比較)，在 Visual Studio 中對其進行設定。</span><span class="sxs-lookup"><span data-stu-id="860c2-124">You can configure it in Visual Studio via **Analyze** > **Portability Analyzer Settings** and select your Target Platforms, which is the .NET platforms/versions that you want to evaluate the portability gaps comparing with the platform/version that your current assembly is built with.</span></span>

![可攜性分析器的螢幕擷取畫面。](./media/portability-analyzer/portability-screenshot.png)

<span data-ttu-id="860c2-126">您也可以使用 ApiPort 主控台應用程式，可從 [ApiPort 存放庫](https://aka.ms/apiportdownload)下載。</span><span class="sxs-lookup"><span data-stu-id="860c2-126">You can also use the ApiPort console application, download it from [ApiPort repository](https://aka.ms/apiportdownload).</span></span> <span data-ttu-id="860c2-127">您可以使用 `listTargets` 命令選項來顯示可用的目標清單，然後指定 `-t` 或 `--target` 命令選項來挑選目標平台。</span><span class="sxs-lookup"><span data-stu-id="860c2-127">You can use `listTargets` command option to display the available target list, then pick target platforms by specifying `-t` or `--target` command option.</span></span>

### <a name="analyze-portability"></a><span data-ttu-id="860c2-128">分析可攜性</span><span class="sxs-lookup"><span data-stu-id="860c2-128">Analyze portability</span></span>
<span data-ttu-id="860c2-129">若要在 Visual Studio 中分析整個專案，在 [方案總管] 中以滑鼠右鍵按一下您的專案，然後選取 [分析組件可攜性]。</span><span class="sxs-lookup"><span data-stu-id="860c2-129">To analyze your entire project in Visual Studio, right-click on your project in **Solution Explorer** and select **Analyze Assembly Portability**.</span></span> <span data-ttu-id="860c2-130">否則，請移至 [分析] 功能表，然後選取 [Analyze Assembly Portability] (分析組件可攜性)。</span><span class="sxs-lookup"><span data-stu-id="860c2-130">Otherwise, go to the **Analyze** menu and select **Analyze Assembly Portability**.</span></span> <span data-ttu-id="860c2-131">從這裡選取專案的可執行檔或 DLL。</span><span class="sxs-lookup"><span data-stu-id="860c2-131">From there, select your project’s executable or DLL.</span></span>

![方案總管的可攜性分析器螢幕擷取畫面。](./media/portability-analyzer/portability-solution-explorer.png)

<span data-ttu-id="860c2-133">您也可以使用 [ApiPort 主控台應用程式](https://aka.ms/apiportdownload)。</span><span class="sxs-lookup"><span data-stu-id="860c2-133">You can also use the [ApiPort console app](https://aka.ms/apiportdownload).</span></span>

- <span data-ttu-id="860c2-134">輸入下列命令分析目前的目錄︰`ApiPort.exe analyze -f .`</span><span class="sxs-lookup"><span data-stu-id="860c2-134">Type the following command to analyze the current directory: `ApiPort.exe analyze -f .`</span></span>
- <span data-ttu-id="860c2-135">若要分析特定的 .dll 檔案清單，請輸入下列命令︰`ApiPort.exe analyze -f first.dll -f second.dll -f third.dll`</span><span class="sxs-lookup"><span data-stu-id="860c2-135">To analyze a specific list of .dll files, type the following command: `ApiPort.exe analyze -f first.dll -f second.dll -f third.dll`</span></span>
- <span data-ttu-id="860c2-136">執行 `ApiPort.exe -?` 以取得詳細說明</span><span class="sxs-lookup"><span data-stu-id="860c2-136">Run `ApiPort.exe -?` to get more help</span></span>

<span data-ttu-id="860c2-137">建議您納入所有您擁有並想要移植的相關 exe 與 dll 檔案，並排除應用程式所依賴，但您未擁有也無法移植的檔案。</span><span class="sxs-lookup"><span data-stu-id="860c2-137">It is recommended that you include all the related exe and dll files that you own and want to port, and exclude the files that your app depends on, but you don't own and can't port.</span></span> <span data-ttu-id="860c2-138">這會提供您最相關的可攜性報告。</span><span class="sxs-lookup"><span data-stu-id="860c2-138">This will give you most relevant portability report.</span></span>

### <a name="view-and-interpret-portability-result"></a><span data-ttu-id="860c2-139">檢視並解譯可攜性結果</span><span class="sxs-lookup"><span data-stu-id="860c2-139">View and interpret portability result</span></span>

<span data-ttu-id="860c2-140">只有目標平台不支援的 API 會顯示在報表中。</span><span class="sxs-lookup"><span data-stu-id="860c2-140">Only APIs that are unsupported by a Target Platform appear in the report.</span></span>
<span data-ttu-id="860c2-141">在 Visual Studio 執行分析之後，您會看到 .NET 可攜性報表檔案連結。</span><span class="sxs-lookup"><span data-stu-id="860c2-141">After running the analysis in Visual Studio, you'll see your .NET Portability report file link pops up.</span></span> <span data-ttu-id="860c2-142">如果您使用 [ApiPort 主控台應用程式](https://aka.ms/apiportdownload)，您的 .NET 可攜性報表會儲存為您指定格式的檔案。</span><span class="sxs-lookup"><span data-stu-id="860c2-142">If you used the [ApiPort console app](https://aka.ms/apiportdownload), your .NET Portability report is saved as a file in the format you specified.</span></span> <span data-ttu-id="860c2-143">預設會在您目前的目錄中儲存為 Excel 檔案 ( *.xlsx*)。</span><span class="sxs-lookup"><span data-stu-id="860c2-143">The default is in an Excel file (*.xlsx*) in your current directory.</span></span>

#### <a name="portability-summary"></a><span data-ttu-id="860c2-144">可攜性摘要</span><span class="sxs-lookup"><span data-stu-id="860c2-144">Portability Summary</span></span>

![可攜性摘要的螢幕擷取畫面。](./media/portability-analyzer/api-catalog-portablility-summary.png)

<span data-ttu-id="860c2-146">此報表顯示的可攜性摘要區段，會顯示該次執行中每個組件的可攜性百分比。</span><span class="sxs-lookup"><span data-stu-id="860c2-146">The Portability Summary section of the report shows the portability percentage for each assembly included in the run.</span></span> <span data-ttu-id="860c2-147">在上述範例中，71.24% 用於 `svcutil` 應用程式中的 .NET Framework API 可在 .NET Core + 平台延伸模組中取得。</span><span class="sxs-lookup"><span data-stu-id="860c2-147">In the previous example, 71.24% of the .NET Framework APIs used in the `svcutil` app are available in .NET Core + Platform Extensions.</span></span> <span data-ttu-id="860c2-148">如果您對多個組件執行 .NET 可攜性分析工具，每個組件都應該在可攜性摘要報告中具有一個資料列。</span><span class="sxs-lookup"><span data-stu-id="860c2-148">If you run the .NET Portability Analyzer tool against multiple assemblies, each assembly should have a row in the Portability Summary report.</span></span>

#### <a name="details"></a><span data-ttu-id="860c2-149">詳細資料</span><span class="sxs-lookup"><span data-stu-id="860c2-149">Details</span></span>

![可攜性詳細資料的螢幕擷取畫面。](./media/portability-analyzer/api-catalog-portablility-details.png)

<span data-ttu-id="860c2-151">報表的 [**詳細資料**] 區段會列出任何選取的**目標平臺**中遺失的 api。</span><span class="sxs-lookup"><span data-stu-id="860c2-151">The **Details** section of the report lists the APIs missing from any of the selected **Targeted Platforms**.</span></span>

- <span data-ttu-id="860c2-152">目標類型：類型缺少目標平台的 API</span><span class="sxs-lookup"><span data-stu-id="860c2-152">Target type: the type has missing API from a Target Platform</span></span>
- <span data-ttu-id="860c2-153">目標成員：目標平台缺少方法</span><span class="sxs-lookup"><span data-stu-id="860c2-153">Target member: the method is missing from a Target Platform</span></span>
- <span data-ttu-id="860c2-154">組件名稱：缺少之 API 所在的 .NET Framework 組件。</span><span class="sxs-lookup"><span data-stu-id="860c2-154">Assembly name: the .NET Framework assembly that the missing API lives in.</span></span>
- <span data-ttu-id="860c2-155">每個選取的目標平臺都是一個資料行，例如「.NET Core」：「不支援」的值表示此目標平臺不支援此 API。</span><span class="sxs-lookup"><span data-stu-id="860c2-155">Each of the selected Target Platforms is one column, such as ".NET Core": "Not supported" value means the API is not supported on this Target Platform.</span></span>
- <span data-ttu-id="860c2-156">建議的變更：建議變更 API 或技術。</span><span class="sxs-lookup"><span data-stu-id="860c2-156">Recommended Changes: recommended API or technology to change to.</span></span> <span data-ttu-id="860c2-157">目前，許多 API 的此欄位為空白或過期。</span><span class="sxs-lookup"><span data-stu-id="860c2-157">Currently, this field is empty or out of date for a lot of APIs.</span></span> <span data-ttu-id="860c2-158">因為 API 太多，導致我們難以繼續。</span><span class="sxs-lookup"><span data-stu-id="860c2-158">Due to the large number of APIs, we have big challenge to keep it up.</span></span> <span data-ttu-id="860c2-159">我們將尋找替代解決方案，來為客戶提供有用的資訊。</span><span class="sxs-lookup"><span data-stu-id="860c2-159">We are looking at alternate solutions to provide helpful information to customers.</span></span>

#### <a name="missing-assemblies"></a><span data-ttu-id="860c2-160">缺少的組件</span><span class="sxs-lookup"><span data-stu-id="860c2-160">Missing Assemblies</span></span>

![遺漏元件的螢幕擷取畫面。](./media/portability-analyzer/api-catalog-missing-assemblies.png)

<span data-ttu-id="860c2-162">您可在報表中找到缺少的組件區段。</span><span class="sxs-lookup"><span data-stu-id="860c2-162">You may find a Missing Assemblies section in your report.</span></span> <span data-ttu-id="860c2-163">該區段會告訴您這份組件清單由已分析的組件所參考，但未進行分析。</span><span class="sxs-lookup"><span data-stu-id="860c2-163">It tells you that this list of assemblies are referenced by your analyzed assemblies and were not analyzed.</span></span> <span data-ttu-id="860c2-164">如果是您自己擁有的組件，請將其納入 API 可攜性分析器中執行，以便您可為其取得 API 層級的詳細可攜性報告。</span><span class="sxs-lookup"><span data-stu-id="860c2-164">If it's an assembly that you own, include it in the Api portability analyzer run so that you can get API level detailed portability report for it.</span></span> <span data-ttu-id="860c2-165">如果是第三方程式庫，請查看是否有支援您目標平台的較新版本。</span><span class="sxs-lookup"><span data-stu-id="860c2-165">If it's third party library, looks for if they have newer version supporting your target platform.</span></span> <span data-ttu-id="860c2-166">如果有，請考慮改用較新版本。</span><span class="sxs-lookup"><span data-stu-id="860c2-166">If so, consider moving to the newer version.</span></span> <span data-ttu-id="860c2-167">最後，您會預期這份清單包含您應用程式所依賴的所有第三方組件，並確認它們有支援您目標平台的版本。</span><span class="sxs-lookup"><span data-stu-id="860c2-167">Eventually, you would expect this list includes all the third party assemblies that your app depends on and confirmed that they have a version supporting your target platform.</span></span>

<span data-ttu-id="860c2-168">如需 .NET Portability Analyzer 的詳細資訊，請瀏覽 [GitHub 文件](https://github.com/Microsoft/dotnet-apiport#documentation)和 Channel 9 影片 [Brief Look at the .NET Portability Analyzer](https://channel9.msdn.com/Blogs/Seth-Juarez/A-Brief-Look-at-the-NET-Portability-Analyzer) (.NET Portability Analyzer 簡介)。</span><span class="sxs-lookup"><span data-stu-id="860c2-168">For more information on the .NET Portability Analyzer, visit the [GitHub documentation](https://github.com/Microsoft/dotnet-apiport#documentation) and [A Brief Look at the .NET Portability Analyzer](https://channel9.msdn.com/Blogs/Seth-Juarez/A-Brief-Look-at-the-NET-Portability-Analyzer) Channel 9 video.</span></span>
