---
title: ".NET Core 發佈封裝"
description: "了解如何封裝、命名以及建立 .NET Core 版本以進行發佈。"
keywords: ".NET, .NET Core, 來源, 組建"
author: bleroy
ms.author: mairaw
ms.date: 06/28/2017
ms.topic: article
ms.prod: .net-core
ms.devlang: dotnet
ms.assetid: 71b9d722-c5a8-4271-9ce1-d87e7ae2494d
ms.workload: dotnetcore
ms.openlocfilehash: 9f5cd2f7c4fec553dfdfaf1765663b6896b3061d
ms.sourcegitcommit: e7f04439d78909229506b56935a1105a4149ff3d
ms.translationtype: HT
ms.contentlocale: zh-TW
ms.lasthandoff: 12/23/2017
---
# <a name="net-core-distribution-packaging"></a><span data-ttu-id="b789c-104">.NET Core 發佈封裝</span><span class="sxs-lookup"><span data-stu-id="b789c-104">.NET Core distribution packaging</span></span>

<span data-ttu-id="b789c-105">隨著 .NET Core 可在越來越多的平台上使用，了解如何封裝、命名和建立 .NET Core 版本是有用的。</span><span class="sxs-lookup"><span data-stu-id="b789c-105">As .NET Core becomes available on more and more platforms, it's useful to learn how to package, name, and version it.</span></span> <span data-ttu-id="b789c-106">如此一來，套件維護人員可以協助確保一致的體驗，無論使用者選擇在何處執行 .NET。</span><span class="sxs-lookup"><span data-stu-id="b789c-106">This way, package maintainers can help ensure a consistent experience no matter where users choose to run .NET.</span></span>

## <a name="net-core-components"></a><span data-ttu-id="b789c-107">.NET Core 元件</span><span class="sxs-lookup"><span data-stu-id="b789c-107">.NET Core components</span></span>

<span data-ttu-id="b789c-108">.NET Core 是由三個必須封裝的主要部分組成：</span><span class="sxs-lookup"><span data-stu-id="b789c-108">.NET Core is made of three major parts that need to be packaged:</span></span>

1. <span data-ttu-id="b789c-109">**主機** (也稱為"muxer") 有兩個不同的角色：啟用執行階段以啟動應用程式，以及啟用 SDK 來分派命令給它。</span><span class="sxs-lookup"><span data-stu-id="b789c-109">**The host** (also known as the "muxer") has two distinct roles: activate a runtime to launch an application, and activate an SDK to dispatch commands to it.</span></span> <span data-ttu-id="b789c-110">主機是原生可執行檔 (`dotnet.exe`) 和其支援的原則文件庫 (安裝在 `host/fxr` 中)。</span><span class="sxs-lookup"><span data-stu-id="b789c-110">The host is a native executable (`dotnet.exe`) and its supporting policy libraries (installed in `host/fxr`).</span></span> <span data-ttu-id="b789c-111">它是以 [`dotnet/core-setup`](https://github.com/dotnet/core-setup/) 存放庫中的程式碼建置。</span><span class="sxs-lookup"><span data-stu-id="b789c-111">It's built from the code in the [`dotnet/core-setup`](https://github.com/dotnet/core-setup/) repository.</span></span> <span data-ttu-id="b789c-112">在指定的電腦上通常只有一個主機，雖然這不是嚴格要求。</span><span class="sxs-lookup"><span data-stu-id="b789c-112">There is typically only one host on a given machine, although that isn't a strict requirement.</span></span>
2. <span data-ttu-id="b789c-113">**架構**是由執行階段和支援的 Managed 程式庫組成。</span><span class="sxs-lookup"><span data-stu-id="b789c-113">**The framework** is made of a runtime and supporting managed libraries.</span></span> <span data-ttu-id="b789c-114">該架構可以作為應用程式的一部分安裝，也可以作為可由多個應用程式重複使用之中央位置的共用架構來安裝。</span><span class="sxs-lookup"><span data-stu-id="b789c-114">The framework may be installed as part of an application, or as a shared framework in a central location that can be reused by multiple applications.</span></span> <span data-ttu-id="b789c-115">在指定的電腦上可能會安裝任意數目的共用架構。</span><span class="sxs-lookup"><span data-stu-id="b789c-115">There may be any number of shared frameworks installed on a given machine.</span></span> <span data-ttu-id="b789c-116">共用架構位在 `shared/Microsoft.NETCore.App/<version>` 下。</span><span class="sxs-lookup"><span data-stu-id="b789c-116">Shared frameworks live under `shared/Microsoft.NETCore.App/<version>`.</span></span> <span data-ttu-id="b789c-117">主機會在所有更新程式版本上向前復原。</span><span class="sxs-lookup"><span data-stu-id="b789c-117">The host rolls forward across patch versions.</span></span> <span data-ttu-id="b789c-118">如果應用程式以 `Microsoft.NETCore.App` 1.0.0 為目標，而只存在 1.0.4，則應用程式將針對 1.0.4 啟動。</span><span class="sxs-lookup"><span data-stu-id="b789c-118">If an application targets `Microsoft.NETCore.App` 1.0.0, and only 1.0.4 is present, the app is launched against 1.0.4.</span></span>
3. <span data-ttu-id="b789c-119">**SDK** (也稱為「工具」) 是一組受管理的工具，可用來撰寫及建置 .NET Core 程式庫和應用程式。</span><span class="sxs-lookup"><span data-stu-id="b789c-119">**The SDK** (also known as "the tooling") is a set of managed tools that can be used to write and build .NET Core libraries and applications.</span></span> <span data-ttu-id="b789c-120">SDK 包含 CLI、MSBuild，以及相關聯的建置工作與目標、NuGet，新的專案範本等。電腦上可以有多個 SDK (例如，建置明確要求較舊版本的專案)，但建議使用最新發行的工具。</span><span class="sxs-lookup"><span data-stu-id="b789c-120">The SDK includes the CLI, MSBuild, and associated build tasks and targets, NuGet, new project templates, etc. It's possible to have multiple SDKs on a machine (for example, to build projects that explicitly require an older version), but the recommendation is to use the latest released tools.</span></span>

## <a name="recommended-package-names"></a><span data-ttu-id="b789c-121">建議的套件名稱</span><span class="sxs-lookup"><span data-stu-id="b789c-121">Recommended package names</span></span>

<span data-ttu-id="b789c-122">下列指導方針是套件名稱的建議。</span><span class="sxs-lookup"><span data-stu-id="b789c-122">The following guidance is our recommendation for package names.</span></span> <span data-ttu-id="b789c-123">套件維護人員可能會根據各種原因而選擇不遵循建議，例如他們設為目標之特定發佈的不同傳統。</span><span class="sxs-lookup"><span data-stu-id="b789c-123">A package maintainer may choose to diverge from it based on various reasons, such as, a different tradition of the specific distribution they're targeting.</span></span>

### <a name="minimum-package-set"></a><span data-ttu-id="b789c-124">最小封裝集合</span><span class="sxs-lookup"><span data-stu-id="b789c-124">Minimum package set</span></span>

* <span data-ttu-id="b789c-125">`dotnet-runtime-[major].[minor]`：指定版本的共用架構 (針對指定的主要 + 次要組合，封裝管理員中僅可使用最新的更新程式版本)。</span><span class="sxs-lookup"><span data-stu-id="b789c-125">`dotnet-runtime-[major].[minor]`: a shared framework with the specified version (only the latest patch version for a given major+minor combination should be available in the package manager).</span></span> <span data-ttu-id="b789c-126">**相依性**：`dotnet-host`</span><span class="sxs-lookup"><span data-stu-id="b789c-126">**dependencies**: `dotnet-host`</span></span>
* <span data-ttu-id="b789c-127">`dotnet-sdk`：最新的 SDK。</span><span class="sxs-lookup"><span data-stu-id="b789c-127">`dotnet-sdk`: the latest SDK.</span></span> <span data-ttu-id="b789c-128">**相依性**：最新的 `dotnet-sdk-[major].[minor]`。</span><span class="sxs-lookup"><span data-stu-id="b789c-128">**dependencies**: the latest `dotnet-sdk-[major].[minor]`.</span></span>
* <span data-ttu-id="b789c-129">`dotnet-sdk-[major].[minor]`：指定版本的 SDK。</span><span class="sxs-lookup"><span data-stu-id="b789c-129">`dotnet-sdk-[major].[minor]`: the SDK with the specified version.</span></span> <span data-ttu-id="b789c-130">指定的版本是內含共用架構的最高內含版本，因此使用者可以輕鬆地將 SDK 與共用架構相關聯。</span><span class="sxs-lookup"><span data-stu-id="b789c-130">The version specified is the highest included version of included shared frameworks, so that users can easily relate an SDK to a shared framework.</span></span> <span data-ttu-id="b789c-131">**相依性**：`dotnet-host`，一或多個 `dotnet-runtime-[major].[minor]` (其中一個執行階段是由 SDK 程式碼本身使用，其他執行階段則是供使用者作為目標建置和執行)。</span><span class="sxs-lookup"><span data-stu-id="b789c-131">**dependencies**: `dotnet-host`, one or more `dotnet-runtime-[major].[minor]` (one of the runtimes is used by the SDK code itself, the others are here for users to build and run against).</span></span>
* <span data-ttu-id="b789c-132">`dotnet-host`：最新的主機。</span><span class="sxs-lookup"><span data-stu-id="b789c-132">`dotnet-host`: the latest host.</span></span>

#### <a name="preview-versions"></a><span data-ttu-id="b789c-133">預覽版本</span><span class="sxs-lookup"><span data-stu-id="b789c-133">Preview versions</span></span>

<span data-ttu-id="b789c-134">套件維護人員可能會決定要包含共用架構和 SDK 的預覽版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-134">Package maintainers may decide to include preview versions of the shared framework and SDK.</span></span> <span data-ttu-id="b789c-135">這些永遠不應該包含在未建立版本的 `dotnet-sdk` 套件中，但可以作為已建立版本的套件發佈，且將其他預覽標記附加到名稱的主要版本和次要版本區段。</span><span class="sxs-lookup"><span data-stu-id="b789c-135">Those should never be included in the unversioned `dotnet-sdk` package, but may be released as versioned packages with an additional preview marker appended to the major and minor version sections of the name.</span></span> <span data-ttu-id="b789c-136">例如，可能會有 `dotnet-sdk-2.0-preview-final` 套件。</span><span class="sxs-lookup"><span data-stu-id="b789c-136">For example, there may be a `dotnet-sdk-2.0-preview-final` package.</span></span>

### <a name="optional-additional-packages"></a><span data-ttu-id="b789c-137">選用的其他套件</span><span class="sxs-lookup"><span data-stu-id="b789c-137">Optional additional packages</span></span>

<span data-ttu-id="b789c-138">某些維護人員可能會選擇提供其他套件，例如：</span><span class="sxs-lookup"><span data-stu-id="b789c-138">Some maintainers may choose to provide additional packages such as:</span></span>

* <span data-ttu-id="b789c-139">`dotnet-lts`：共用架構的最新長期支援 (LTS) 版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-139">`dotnet-lts`: the latest Long-Term Support (LTS) version of the shared framework.</span></span> <span data-ttu-id="b789c-140">[LTS 和目前的版本序列](~/docs/core/versions/lts-current.md)會對應 .NET Core 發行的不同步調。</span><span class="sxs-lookup"><span data-stu-id="b789c-140">[LTS and Current release trains](~/docs/core/versions/lts-current.md) correspond to different cadences at which .NET Core gets released.</span></span> <span data-ttu-id="b789c-141">根據使用者希望更新的頻率，他們可以選擇採用一個序列或其他序列。</span><span class="sxs-lookup"><span data-stu-id="b789c-141">Users have a choice of adopting one or the other train, based on how often they are willing to update.</span></span> <span data-ttu-id="b789c-142">這也是一個與支援層級相關的概念，因此根據考量的發行套件，不一定會有意義。</span><span class="sxs-lookup"><span data-stu-id="b789c-142">This is a concept that is also tied to support levels, so it may or may not make sense depending on the distro being considered.</span></span>

## <a name="disk-layout"></a><span data-ttu-id="b789c-143">磁碟配置</span><span class="sxs-lookup"><span data-stu-id="b789c-143">Disk layout</span></span>

<span data-ttu-id="b789c-144">安裝 .NET Core 套件時，其目標目的地在磁碟上的相對位置是很重要的。</span><span class="sxs-lookup"><span data-stu-id="b789c-144">When installing .NET Core packages, the relative placement of their target destinations on disk matter.</span></span>
<span data-ttu-id="b789c-145">`dotnet.exe` 主機應該放在 `sdk` 和 `shared` 資料夾旁，其中包含 `dotnet-sdk` SDK 套件已建立版本的內容，以及 `dotnet-runtime` 共用架構套件。</span><span class="sxs-lookup"><span data-stu-id="b789c-145">The `dotnet.exe` host should be placed next to `sdk` and `shared` folders that contain the versioned contents of the `dotnet-sdk` SDK packages, and `dotnet-runtime` shared framework packages.</span></span>

<span data-ttu-id="b789c-146">套件內檔案和目錄的磁碟配置已建立版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-146">The disk layout of files and directories inside the packages is versioned.</span></span> <span data-ttu-id="b789c-147">這表示更新至最新的 `dotnet-runtime` 會將新版本與先前的版本並存安裝，降低因更新套件而中斷現有應用程式的可能性。</span><span class="sxs-lookup"><span data-stu-id="b789c-147">This means that updating to the latest `dotnet-runtime` installs the new version side by side with previous versions, reducing the possibility of breaking existing applications by updating the package.</span></span> <span data-ttu-id="b789c-148">套件更新不應該移除先前的版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-148">Package updates should not remove previous versions.</span></span>

## <a name="update-policies"></a><span data-ttu-id="b789c-149">更新原則</span><span class="sxs-lookup"><span data-stu-id="b789c-149">Update policies</span></span>

<span data-ttu-id="b789c-150">當執行 `update` 時，每個套件的行為會如下所示：</span><span class="sxs-lookup"><span data-stu-id="b789c-150">When an `update` is performed, the behavior of each package is as follows:</span></span>

* <span data-ttu-id="b789c-151">`dotnet-runtime-[major].[minor]`：新的更新程式版本會更新套件，但新的次要版本或主要版本是個別的套件。</span><span class="sxs-lookup"><span data-stu-id="b789c-151">`dotnet-runtime-[major].[minor]`: new patch versions update the package, but new minor or major versions are separate packages.</span></span>
* <span data-ttu-id="b789c-152">`dotnet-sdk`：`update` 會向前復原主要、次要和更新程式版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-152">`dotnet-sdk`: `update` rolls forward major, minor, and patch versions.</span></span>
* <span data-ttu-id="b789c-153">`dotnet-sdk-[major].[minor]`：新的更新程式版本會更新套件，但新的次要版本或主要版本是個別的套件。</span><span class="sxs-lookup"><span data-stu-id="b789c-153">`dotnet-sdk-[major].[minor]`: new patch versions update the package, but new minor or major versions are separate packages.</span></span>
* <span data-ttu-id="b789c-154">`dotnet-lts`：`update` 會向前復原主要、次要和更新程式版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-154">`dotnet-lts`: `update` rolls forward major, minor, and patch versions.</span></span>

<span data-ttu-id="b789c-155">本主題說明我們針對封裝 .NET Core 的建議，不過每個發行套件都能自由選擇要提供哪些版本與提供的時間。</span><span class="sxs-lookup"><span data-stu-id="b789c-155">This topic has presented our recommendations for packaging .NET Core, however each distro is free to choose what versions to offer and when.</span></span> <span data-ttu-id="b789c-156">例如，重視穩定性勝過最新版本的發行套件，可能會選擇僅發布與 LTS 版本序列符合的版本。</span><span class="sxs-lookup"><span data-stu-id="b789c-156">For example, a distro that values stability more than being up-to-date may choose to release only versions that snap with the LTS release train.</span></span>