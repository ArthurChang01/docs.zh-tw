---
title: 串流服務與重複的欄位-適用于 WCF 開發人員的 gRPC
description: 比較重複的欄位與串流服務，做為使用 gRPC 傳遞資料集合的方式。
ms.date: 09/02/2019
ms.openlocfilehash: 0e717df57ba2bb52d63a063072d8a45bf0f7e395
ms.sourcegitcommit: f38e527623883b92010cf4760246203073e12898
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 02/20/2020
ms.locfileid: "77503380"
---
# <a name="grpc-streaming-services-vs-repeated-fields"></a>gRPC 串流服務與重複欄位的比較

gRPC services 提供兩種方法來傳回資料集或物件清單。 通訊協定緩衝區訊息規格會使用 `repeated` 關鍵字，來宣告另一個訊息中的清單或訊息陣列。 GRPC 服務規格會使用 `stream` 關鍵字來宣告長時間執行的持續性連接。 透過該連接，就會傳送多則訊息，而且可以個別處理。 

您也可以使用 `stream` 功能進行長時間執行的時態性資料，例如通知或記錄訊息。 但這一章會考慮使用它來傳回單一資料集。

您應該使用的取決於下列因素：

- 資料集的整體大小。
- 在用戶端或伺服器端建立資料集所花的時間。
- 資料集的取用者是否可以在第一個專案可用時立即開始作用，或需要完整的資料集來執行任何有用的工作。

## <a name="when-to-use-repeated-fields"></a>使用 `repeated` 欄位的時機

對於大小限制，而且可以在短時間內完整產生的任何資料集（例如，在一秒內），您應該使用一般 Protobuf 訊息中的 `repeated` 欄位。 例如，在電子商務系統中，若要建立訂單中的專案清單可能很快，而且清單不會很大。 以 `repeated` 欄位傳回單一訊息的順序，比使用 `stream` 更快，而且會產生較少的網路額外負荷。

如果用戶端在開始處理之前需要所有資料，而且資料集夠小，可在記憶體中建立，則請考慮使用 `repeated` 欄位。 即使在伺服器的記憶體中建立資料集的速度較慢，也請考慮這一點。

## <a name="when-to-use-stream-methods"></a>使用 `stream` 方法的時機

當您資料集中的訊息物件可能非常大時，最好是使用串流要求或回應來傳輸它們。 在記憶體中建立大型物件、將它寫入網路，然後釋放資源，會更有效率。 這種方法可以改善服務的擴充性。

同樣地，您應該在資料流程上傳送不受限制大小的資料集，以避免在進行處理時記憶體不足。

對於取用者可以個別處理每個專案的資料集，您應該考慮使用資料流程（如果它表示進度可以向使用者表示）。 使用資料流程可以改善應用程式的回應能力，但您應該將它與應用程式的整體效能進行平衡。

資料流程可能很有用的另一種情況是在多個服務之間處理訊息的位置。 如果鏈中的每個服務傳回資料流程，則終端機服務（也就是鏈中的最後一個）可以開始傳回訊息。 這些訊息可以進行處理，並沿著鏈傳回給原始要求者。 要求者可以傳回資料流程，或將結果匯總成單一回應訊息。 這種方法很適合用於 MapReduce 之類的模式。

>[!div class="step-by-step"]
>[上一頁](migrate-duplex-services.md)
>[下一頁](client-libraries.md)
