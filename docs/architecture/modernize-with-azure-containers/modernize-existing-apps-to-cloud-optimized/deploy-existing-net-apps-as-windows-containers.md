---
title: 將現有 .NET 應用程式部署為 Windows 容器
description: 使用 Azure 雲和 Windows 容器對現有 .NET 應用程式進行現代化 |將現有的 .NET 應用部署為 Windows 容器
ms.date: 04/29/2018
ms.openlocfilehash: c99c2e756320fc886203efcbf98a81e571d907e5
ms.sourcegitcommit: e3cbf26d67f7e9286c7108a2752804050762d02d
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 04/09/2020
ms.locfileid: "80987968"
---
# <a name="deploy-existing-net-apps-as-windows-containers"></a><span data-ttu-id="87142-103">將現有 .NET 應用程式部署為 Windows 容器</span><span class="sxs-lookup"><span data-stu-id="87142-103">Deploy existing .NET apps as Windows containers</span></span>

<span data-ttu-id="87142-104">基於 Windows 容器的部署適用於雲端優化應用程式和雲端原生應用程式。</span><span class="sxs-lookup"><span data-stu-id="87142-104">Deployments that are based on Windows Containers are applicable to Cloud-Optimized applications and Cloud-Native applications.</span></span>

<span data-ttu-id="87142-105">但是,在本指南中,尤其是以下部分中,它主要側重於將 Windows 容器用於*雲優化*應用程式的應用,而雲優化應用程式不需要重新構建應用程式。</span><span class="sxs-lookup"><span data-stu-id="87142-105">However, in this guide and especially in the following sections, it mostly focuses on using Windows Containers for *Cloud-Optimized* applications where you don't need to rearchitect your application.</span></span>

## <a name="what-are-containers-linux-or-windows"></a><span data-ttu-id="87142-106">什麼是容器？</span><span class="sxs-lookup"><span data-stu-id="87142-106">What are containers?</span></span> <span data-ttu-id="87142-107">(Linux 或 Windows)</span><span class="sxs-lookup"><span data-stu-id="87142-107">(Linux or Windows)</span></span>

<span data-ttu-id="87142-108">容器是一種將應用程式包裝到其自己的獨立包中的方法。</span><span class="sxs-lookup"><span data-stu-id="87142-108">Containers are a way to wrap up an application into its own isolated package.</span></span> <span data-ttu-id="87142-109">在其容器中,應用程式不受容器外部存在的應用程式或進程的影響。</span><span class="sxs-lookup"><span data-stu-id="87142-109">In its container, the application is not affected by applications or processes that exist outside of the container.</span></span> <span data-ttu-id="87142-110">應用程式所依賴的一切,以成功運行,因為進程位於容器內。</span><span class="sxs-lookup"><span data-stu-id="87142-110">Everything the application depends on to run successfully as a process is inside the container.</span></span> <span data-ttu-id="87142-111">無論容器可能移動的位置,應用程式的要求將始終滿足直接依賴項,因為它與它需要運行的所有內容(庫依賴項、運行時等)捆綁在一起。</span><span class="sxs-lookup"><span data-stu-id="87142-111">Wherever the container might move, the requirements of the application will always be met, in terms of direct dependencies, because it is bundled with everything that it needs to run (library dependencies, runtimes, and so on).</span></span>

<span data-ttu-id="87142-112">容器的主要特性是它使環境在不同的部署中相同,因為容器本身附帶了它需要的所有依賴項。</span><span class="sxs-lookup"><span data-stu-id="87142-112">The main characteristic of a container is that it makes the environment the same across different deployments because the container itself comes with all the dependencies it needs.</span></span> <span data-ttu-id="87142-113">您可以在電腦上調試應用程式,然後將其部署到另一台計算機,並保證使用相同的環境。</span><span class="sxs-lookup"><span data-stu-id="87142-113">You can debug the application on your machine, and then deploy it to another machine, with the same environment guaranteed.</span></span>

<span data-ttu-id="87142-114">容器是容器映像的實例。</span><span class="sxs-lookup"><span data-stu-id="87142-114">A container is an instance of a container image.</span></span> <span data-ttu-id="87142-115">容器映像是打包應用或服務(如快照)然後以可靠且可重現的方式部署它的方法。</span><span class="sxs-lookup"><span data-stu-id="87142-115">A container image is a way to package an app or service (like a snapshot), and then deploy it in a reliable and reproducible way.</span></span> <span data-ttu-id="87142-116">你可以說Docker不僅是一種技術,而且是一種哲學和過程。</span><span class="sxs-lookup"><span data-stu-id="87142-116">You could say that Docker is not only a technology-it's also a philosophy and a process.</span></span>

<span data-ttu-id="87142-117">隨著容器每天變得越來越常見,它們正在成為全行業範圍內的"部署單元"。</span><span class="sxs-lookup"><span data-stu-id="87142-117">As containers daily become more common, they are becoming an industry-wide "unit of deployment."</span></span>

## <a name="benefits-of-containers-docker-engine-on-linux-or-windows"></a><span data-ttu-id="87142-118">容器的優勢(Linux 或 Windows 上的 Docker 引擎)</span><span class="sxs-lookup"><span data-stu-id="87142-118">Benefits of containers (Docker Engine on Linux or Windows)</span></span>

<span data-ttu-id="87142-119">使用容器(也可以定義為輕量級構建基塊)構建應用程式,可顯著提高跨任何基礎結構構建、運輸和運行任何應用程式的敏捷性。</span><span class="sxs-lookup"><span data-stu-id="87142-119">Building applications by using containers-which also might be defined as lightweight building blocks-offers a significant increase in agility for building, shipping, and running any application, across any infrastructure.</span></span>

<span data-ttu-id="87142-120">借助容器,藉助 Microsoft 開發人員工具、作業系統和雲端的 Docker 整合,您可以將任何應用從開發到生產,而代碼更改很少或根本沒有。</span><span class="sxs-lookup"><span data-stu-id="87142-120">With containers, you can take any app from development to production with little or no code change, thanks to Docker integration across Microsoft developer tools, operating systems, and cloud.</span></span>

<span data-ttu-id="87142-121">部署到普通 VM 時,您可能已經具備了將ASP.NET應用部署到 VM 的方法。</span><span class="sxs-lookup"><span data-stu-id="87142-121">When you deploy to plain VMs, you probably already have a method in place for deploying ASP.NET apps to your VMs.</span></span> <span data-ttu-id="87142-122">但是,使用 Puppet 或類似工具等部署工具,您的方法可能涉及多個手動步驟或複雜的自動化過程。</span><span class="sxs-lookup"><span data-stu-id="87142-122">It's likely, though, that your method involves multiple manual steps or complex automated processes by using a deployment tool like Puppet, or a similar tool.</span></span> <span data-ttu-id="87142-123">您可能需要執行修改配置項、在伺服器之間複製應用程式內容以及基於 .msi 設置運行互動式安裝程式等任務,然後進行測試。</span><span class="sxs-lookup"><span data-stu-id="87142-123">You might need to perform tasks like modifying configuration items, copying application content between servers, and running interactive setup programs based on .msi setups, followed by testing.</span></span> <span data-ttu-id="87142-124">部署中的所有這些步驟都增加了部署的時間和風險。</span><span class="sxs-lookup"><span data-stu-id="87142-124">All those steps in the deployment add time and risk to deployments.</span></span> <span data-ttu-id="87142-125">每當目標環境中不存在依賴項時,您就會收到失敗。</span><span class="sxs-lookup"><span data-stu-id="87142-125">You will get failures whenever a dependency is not present in the target environment.</span></span>

<span data-ttu-id="87142-126">在 Windows 容器中,打包應用程式的過程是完全自動化的。</span><span class="sxs-lookup"><span data-stu-id="87142-126">In Windows Containers, the process of packaging applications is fully automated.</span></span> <span data-ttu-id="87142-127">Windows 容器基於 Docker 平臺,該平臺為容器部署提供自動更新和回滾。</span><span class="sxs-lookup"><span data-stu-id="87142-127">Windows Containers is based on the Docker platform, which offers automatic updates and rollbacks for container deployments.</span></span> <span data-ttu-id="87142-128">使用 Docker 引擎得到的主要改進是創建映射,這些映射類似於應用程式的快照及其所有依賴項。</span><span class="sxs-lookup"><span data-stu-id="87142-128">The main improvement you get from using the Docker engine is that you create images, which are like snapshots of your application, with all its dependencies.</span></span> <span data-ttu-id="87142-129">這些映像是 Docker 映射(本例中為 Windows 容器映射)。</span><span class="sxs-lookup"><span data-stu-id="87142-129">The images are Docker images (a Windows container image, in this case).</span></span> <span data-ttu-id="87142-130">這些映射在容器中運行ASP.NET應用,而無需返回原始程式碼。</span><span class="sxs-lookup"><span data-stu-id="87142-130">The images run ASP.NET apps in containers, without going back to source code.</span></span> <span data-ttu-id="87142-131">容器快照將成為部署單元。</span><span class="sxs-lookup"><span data-stu-id="87142-131">The container snapshot becomes the unit of deployment.</span></span>

<span data-ttu-id="87142-132">許多組織正在容器化現有的單片應用程式,原因如下:</span><span class="sxs-lookup"><span data-stu-id="87142-132">Many organizations are containerizing existing monolithic applications for the following reasons:</span></span>

- <span data-ttu-id="87142-133">**使用改進的部署釋放敏捷性**。</span><span class="sxs-lookup"><span data-stu-id="87142-133">**Release agility through improved deployment**.</span></span> <span data-ttu-id="87142-134">容器在開發和操作之間提供一致的部署協定。</span><span class="sxs-lookup"><span data-stu-id="87142-134">Containers offer a consistent deployment contract between development and operations.</span></span> <span data-ttu-id="87142-135">當您使用容器時,您不會聽到開發人員說:「它在我的機器上工作,為什麼不在生產中呢?</span><span class="sxs-lookup"><span data-stu-id="87142-135">When you use containers, you won't hear developers say, "It works on my machine, why not in production?"</span></span> <span data-ttu-id="87142-136">他們可以說,"它作為一個容器運行,所以它將在生產中運行。</span><span class="sxs-lookup"><span data-stu-id="87142-136">They can say, "It runs as a container, so it will run in production."</span></span> <span data-ttu-id="87142-137">打包的應用程式及其所有依賴項都可以在任何受支援的基於容器的環境中執行。</span><span class="sxs-lookup"><span data-stu-id="87142-137">The packaged application, with all its dependencies, can be executed in any supported container-based environment.</span></span> <span data-ttu-id="87142-138">它將以它打算在所有部署目標(開發、QA、暫存、生產)中運行的方式運行。</span><span class="sxs-lookup"><span data-stu-id="87142-138">It will run the way it was intended to run in all deployment targets (dev, QA, staging, production).</span></span> <span data-ttu-id="87142-139">容器在從一個階段移動到下一個階段時消除了大多數摩擦,這極大地改進了部署,而且您可以更快地發貨。</span><span class="sxs-lookup"><span data-stu-id="87142-139">Containers eliminate most frictions when they move from one stage to the next, which greatly improves deployment, and you can ship faster.</span></span>

- <span data-ttu-id="87142-140">**成本降低**。</span><span class="sxs-lookup"><span data-stu-id="87142-140">**Cost reductions**.</span></span> <span data-ttu-id="87142-141">容器通過整合和刪除現有硬體或以每單元硬體的較高密度運行應用程式來降低成本。</span><span class="sxs-lookup"><span data-stu-id="87142-141">Containers lead to lower costs, either by the consolidation and removal of existing hardware, or from running applications at a higher density per unit of hardware.</span></span>

- <span data-ttu-id="87142-142">**可攜性**。</span><span class="sxs-lookup"><span data-stu-id="87142-142">**Portability**.</span></span> <span data-ttu-id="87142-143">容器是模組化和便攜的。</span><span class="sxs-lookup"><span data-stu-id="87142-143">Containers are modular and portable.</span></span> <span data-ttu-id="87142-144">在任何伺服器作業系統(Linux 和 Windows)、任何主要公共雲(Microsoft Azure、Amazon AWS、Google、IBM)以及本地和私有雲端環境中都支援 Docker 容器。</span><span class="sxs-lookup"><span data-stu-id="87142-144">Docker containers are supported on any server operating system (Linux and Windows), in any major public cloud (Microsoft Azure, Amazon AWS, Google, IBM), and in on-premises and private or hybrid cloud environments.</span></span>

- <span data-ttu-id="87142-145">**控制**。</span><span class="sxs-lookup"><span data-stu-id="87142-145">**Control**.</span></span> <span data-ttu-id="87142-146">容器提供靈活和安全的環境,在容器級別進行控制。</span><span class="sxs-lookup"><span data-stu-id="87142-146">Containers offer a flexible and secure environment that's controlled at the container level.</span></span> <span data-ttu-id="87142-147">可以通過在容器上設置執行約束策略來保護、隔離甚至限制容器。</span><span class="sxs-lookup"><span data-stu-id="87142-147">A container can be secured, isolated, and even limited by setting execution constraint policies on the container.</span></span> <span data-ttu-id="87142-148">如有關 Windows 容器的部分中所述,Windows Server 2016 和 Hyper-V 容器提供了其他企業支援選項。</span><span class="sxs-lookup"><span data-stu-id="87142-148">As detailed in the section about Windows Containers, Windows Server 2016 and Hyper-V containers offer additional enterprise support options.</span></span>

<span data-ttu-id="87142-149">當您使用容器開發和維護應用程式時,敏捷性、可移植性和控制性的重大改進最終可顯著降低成本。</span><span class="sxs-lookup"><span data-stu-id="87142-149">Significant improvements in agility, portability, and control ultimately lead to significant cost reductions when you use containers to develop and maintain applications.</span></span>

## <a name="what-is-docker"></a><span data-ttu-id="87142-150">什麼是 Docker？</span><span class="sxs-lookup"><span data-stu-id="87142-150">What is Docker?</span></span>

<span data-ttu-id="87142-151">[Docker](https://www.docker.com/)是一個[開源專案](https://github.com/docker/docker),它自動將應用程式部署為可在雲或本地運行的可移植的、自給自足的容器。</span><span class="sxs-lookup"><span data-stu-id="87142-151">[Docker](https://www.docker.com/) is an [open-source project](https://github.com/docker/docker) that automates the deployment of applications as portable, self-sufficient containers that can run in the cloud or on-premises.</span></span> <span data-ttu-id="87142-152">Docker 也是升級及發展這項技術的[公司](https://www.docker.com/)。</span><span class="sxs-lookup"><span data-stu-id="87142-152">Docker is also a [company](https://www.docker.com/) that promotes and evolves this technology.</span></span> <span data-ttu-id="87142-153">該公司與雲端、Linux和 Windows 供應商(包括 Microsoft)合作。</span><span class="sxs-lookup"><span data-stu-id="87142-153">The company works in collaboration with cloud, Linux, and Windows vendors, including Microsoft.</span></span>

![顯示 Docker 如何在混合雲中部署容器的圖表。](./media/deploy-existing-net-apps-as-windows-containers/docker-deploys-containers-all-layers.png)

<span data-ttu-id="87142-155">**圖 4-6。**</span><span class="sxs-lookup"><span data-stu-id="87142-155">**Figure 4-6.**</span></span> <span data-ttu-id="87142-156">Docker 將容器部署在混合式雲端的所有圖層</span><span class="sxs-lookup"><span data-stu-id="87142-156">Docker deploys containers at all layers of the hybrid cloud</span></span>

<span data-ttu-id="87142-157">對於熟悉虛擬機的人來說,容器可能看起來非常相似。</span><span class="sxs-lookup"><span data-stu-id="87142-157">To someone familiar with virtual machines, containers might appear to be remarkably similar.</span></span> <span data-ttu-id="87142-158">容器運行作業系統,具有檔案系統,並且可以通過網路訪問,就像物理或虛擬計算機系統一樣。</span><span class="sxs-lookup"><span data-stu-id="87142-158">A container runs an operating system, has a file system, and can be accessed over a network, just like a physical or virtual computer system.</span></span> <span data-ttu-id="87142-159">即便如此，容器的基本技術和概念還是與虛擬機器非常不同。</span><span class="sxs-lookup"><span data-stu-id="87142-159">However, the technology and concepts behind containers are vastly different from virtual machines.</span></span> <span data-ttu-id="87142-160">從開發人員的角度來看,容器必須更像一個進程。</span><span class="sxs-lookup"><span data-stu-id="87142-160">From a developer point of view, a container must be treated more like a single process.</span></span> <span data-ttu-id="87142-161">實際上,容器具有一個進程的單個入口點。</span><span class="sxs-lookup"><span data-stu-id="87142-161">In fact, a container has a single entry point for one process.</span></span>

<span data-ttu-id="87142-162">Docker 容器(為了簡單起見,*容器*)可以在 Linux 和 Windows 上本機運行。</span><span class="sxs-lookup"><span data-stu-id="87142-162">Docker containers (for simplicity, *containers*) can run natively on Linux and Windows.</span></span> <span data-ttu-id="87142-163">運行常規容器時,Windows 容器只能在 Windows 主機(主機伺服器或 VM)上運行,Linux 容器只能在 Linux 主機上運行。</span><span class="sxs-lookup"><span data-stu-id="87142-163">When running regular containers, Windows containers can run only on Windows hosts (a host server or a VM), and Linux containers can run only on Linux hosts.</span></span> <span data-ttu-id="87142-164">但是,在最新版本的 Windows Server 和 Hyper-V 容器中,Linux 容器還可以透過使用目前僅在 Windows 伺服器容器中可用的 Hyper-V 隔離技術在 Windows Server 上本機運行。</span><span class="sxs-lookup"><span data-stu-id="87142-164">However, in recent versions of Windows Server and Hyper-V containers, a Linux container also can run natively on Windows Server by using the Hyper-V isolation technology that currently is available only in Windows Server Containers.</span></span>

<span data-ttu-id="87142-165">在不久的將來,同時具有 Linux 和 Windows 容器的混合環境是可能的,甚至很常見。</span><span class="sxs-lookup"><span data-stu-id="87142-165">In the near future, mixed environments that have both Linux and Windows containers will be possible and even common.</span></span>

## <a name="benefits-of-windows-containers-for-your-existing-net-applications"></a><span data-ttu-id="87142-166">Windows 容器對現有 .NET 應用程式的優勢</span><span class="sxs-lookup"><span data-stu-id="87142-166">Benefits of Windows Containers for your existing .NET applications</span></span>

<span data-ttu-id="87142-167">使用 Windows 容器的好處與您從容器中通常獲得的好處基本相同。</span><span class="sxs-lookup"><span data-stu-id="87142-167">The benefits of using Windows Containers are fundamentally the same benefits you get from containers in general.</span></span> <span data-ttu-id="87142-168">使用 Windows 容器將極大地提高敏捷性、可移植性和控制性。</span><span class="sxs-lookup"><span data-stu-id="87142-168">Using Windows Containers is about greatly improving agility, portability, and control.</span></span>

<span data-ttu-id="87142-169">現有 .NET 應用程式是指使用 .NET 框架創建的應用程式。</span><span class="sxs-lookup"><span data-stu-id="87142-169">Existing .NET applications refer to those applications that were created using the .NET Framework.</span></span> <span data-ttu-id="87142-170">例如,它們可能是傳統的ASP.NET Web 應用程式-他們不使用 .NET Core,這是更新的,並在 Linux、Windows 和 MacOS 上運行跨平臺。</span><span class="sxs-lookup"><span data-stu-id="87142-170">For example, they might be traditional ASP.NET web applications-they don't use .NET Core, which is newer and runs cross-platform on Linux, Windows, and MacOS.</span></span>

<span data-ttu-id="87142-171">.NET 框架中的主要依賴項是 Windows。</span><span class="sxs-lookup"><span data-stu-id="87142-171">The main dependency in the .NET Framework is Windows.</span></span> <span data-ttu-id="87142-172">它還具有輔助依賴項,如IIS和System.Web在傳統ASP.NET。</span><span class="sxs-lookup"><span data-stu-id="87142-172">It also has secondary dependencies, like IIS, and System.Web in traditional ASP.NET.</span></span>

<span data-ttu-id="87142-173">.NET 框架應用程式必須在Windows期間運行。</span><span class="sxs-lookup"><span data-stu-id="87142-173">A .NET Framework application must run on Windows, period.</span></span> <span data-ttu-id="87142-174">如果要對現有的 .NET 框架應用程式進行容器化,並且不能或不想投資遷移到 .NET Core("如果工作正常,不要遷移它"),則容器的唯一選擇是使用 Windows 容器。</span><span class="sxs-lookup"><span data-stu-id="87142-174">If you want to containerize existing .NET Framework applications and you can't or don't want to invest in a migration to .NET Core ("If it works properly, don't migrate it"), the only choice you have for containers is to use Windows Containers.</span></span>

<span data-ttu-id="87142-175">因此,Windows 容器的主要優點之一是,它們提供了一種實現在 Windows 通過容器化上運行的現有 .NET 框架應用程式現代化的方法。</span><span class="sxs-lookup"><span data-stu-id="87142-175">So, one of the main benefits of Windows Containers is that they offer you a way to modernize your existing .NET Framework applications that are running on Windows-through containerization.</span></span> <span data-ttu-id="87142-176">最終,Windows 容器通過使用容器敏捷性、可移植性和更好的控制功能,為您帶來您所尋找的優勢。</span><span class="sxs-lookup"><span data-stu-id="87142-176">Ultimately, Windows Containers gets you the benefits that you are looking for by using containers-agility, portability, and better control.</span></span>

## <a name="choose-an-os-to-target-with-net-based-containers"></a><span data-ttu-id="87142-177">選擇要以的目標作業系統。基於 NET 的容器</span><span class="sxs-lookup"><span data-stu-id="87142-177">Choose an OS to target with .NET-based containers</span></span>

<span data-ttu-id="87142-178">鑒於 Docker 支援的作業系統的多樣性以及 .NET 框架和 .NET Core 之間的差異,您應該根據正在使用的框架定位特定的作業系統和特定版本。</span><span class="sxs-lookup"><span data-stu-id="87142-178">Given the diversity of operating systems that are supported by Docker, as well as the differences between .NET Framework and .NET Core, you should target a specific OS and specific versions based on the framework you are using.</span></span>

<span data-ttu-id="87142-179">針對 Windows，您可以使用 Windows Server Core 或 Windows Nano Server。</span><span class="sxs-lookup"><span data-stu-id="87142-179">For Windows, you can use Windows Server Core or Windows Nano Server.</span></span> <span data-ttu-id="87142-180">這些 Windows 版本提供了 .NET Framework 或 .NET Core 應用程式可能需要的不同特性(如 IIS 與自託管的 Web 伺服器(如 Kestrel)。</span><span class="sxs-lookup"><span data-stu-id="87142-180">These Windows versions provide different characteristics (like IIS versus a self-hosted web server like Kestrel) that might be needed by .NET Framework or .NET Core applications.</span></span>

<span data-ttu-id="87142-181">針對 Linux，有多個發佈可供使用，且受到正式 .NET Docker 映像的支援 (例如 Debian)。</span><span class="sxs-lookup"><span data-stu-id="87142-181">For Linux, multiple distros are available and supported in official .NET Docker images (like Debian).</span></span>

<span data-ttu-id="87142-182">圖 4-7 顯示了您可以定位的作業系統版本,具體取決於應用版本的 .NET Framework。</span><span class="sxs-lookup"><span data-stu-id="87142-182">Figure 4-7 shows OS versions that you can target, depending on the app's version of the .NET Framework.</span></span>

![顯示基於 .NET 框架版本的目標操作系統的圖表。](./media/deploy-existing-net-apps-as-windows-containers/dotnet-framework-operating-systems.png)

<span data-ttu-id="87142-184">**圖 4-7。**</span><span class="sxs-lookup"><span data-stu-id="87142-184">**Figure 4-7.**</span></span> <span data-ttu-id="87142-185">基於 .NET 架構版本定位的作業系統</span><span class="sxs-lookup"><span data-stu-id="87142-185">Operating systems to target based on .NET Framework version</span></span>

<span data-ttu-id="87142-186">在基於 .NET 框架應用程式的現有或舊應用程式遷移方案中,主要依賴項位於 Windows 和 IIS 上。</span><span class="sxs-lookup"><span data-stu-id="87142-186">In migration scenarios for existing or legacy applications that are based on .NET Framework applications, the main dependencies are on Windows and IIS.</span></span> <span data-ttu-id="87142-187">您唯一的選擇是基於 Windows 伺服器核心和 .NET 框架使用 Docker 映射。</span><span class="sxs-lookup"><span data-stu-id="87142-187">Your only option is to use Docker images based on Windows Server Core and the .NET Framework.</span></span>

<span data-ttu-id="87142-188">將映像名稱加入 Dockerfile 檔時,可以使用標記選擇作業系統和版本,如以下基於 .NET 框架的 Windows 容器映像的範例的範例 :</span><span class="sxs-lookup"><span data-stu-id="87142-188">When you add the image name to your Dockerfile file, you can select the operating system and version by using a tag, as in the following examples for .NET Framework-based Windows container images:</span></span>

> | <span data-ttu-id="87142-189">**標記**</span><span class="sxs-lookup"><span data-stu-id="87142-189">**Tag**</span></span> | <span data-ttu-id="87142-190">**系統和版本**</span><span class="sxs-lookup"><span data-stu-id="87142-190">**System and version**</span></span> |
> |---|---|
> | <span data-ttu-id="87142-191">**微軟/點網框架:4.x-windows伺服器核心**</span><span class="sxs-lookup"><span data-stu-id="87142-191">**microsoft/dotnet-framework:4.x-windowsservercore**</span></span> | <span data-ttu-id="87142-192">.NET 架構 4.x 在 Windows 伺服器核心</span><span class="sxs-lookup"><span data-stu-id="87142-192">.NET Framework 4.x on Windows Server Core</span></span> |
> | <span data-ttu-id="87142-193">**微軟/阿斯普內特:4.x-windows伺服器核心**</span><span class="sxs-lookup"><span data-stu-id="87142-193">**microsoft/aspnet:4.x-windowsservercore**</span></span> | <span data-ttu-id="87142-194">.NET 框架 4.x 在 Windows 伺服器核心上具有其他ASP.NET自訂</span><span class="sxs-lookup"><span data-stu-id="87142-194">.NET Framework 4.x with additional ASP.NET customization, on Windows Server Core</span></span> |

<span data-ttu-id="87142-195">對於 .NET Core(適用於 Linux 和 Windows 的跨平臺),這些標記如下所示:</span><span class="sxs-lookup"><span data-stu-id="87142-195">For .NET Core (cross-platform for Linux and Windows), the tags would look like the following:</span></span>

> | <span data-ttu-id="87142-196">**標記**</span><span class="sxs-lookup"><span data-stu-id="87142-196">**Tag**</span></span> | <span data-ttu-id="87142-197">**系統和版本**</span><span class="sxs-lookup"><span data-stu-id="87142-197">**System and version**</span></span>
> |---|---|
> | <span data-ttu-id="87142-198">**微軟/點網:2.0.0-運行時間**</span><span class="sxs-lookup"><span data-stu-id="87142-198">**microsoft/dotnet:2.0.0-runtime**</span></span> | <span data-ttu-id="87142-199">.NET 核心 2.0 僅在 Linux 上運行時間</span><span class="sxs-lookup"><span data-stu-id="87142-199">.NET Core 2.0 runtime-only on Linux</span></span> |
> | <span data-ttu-id="87142-200">**微軟/點網:2.0.0-運行時納米伺服器**</span><span class="sxs-lookup"><span data-stu-id="87142-200">**microsoft/dotnet:2.0.0-runtime-nanoserver**</span></span> | <span data-ttu-id="87142-201">.NET 核心 2.0 僅在 Windows Nano 伺服器上執行時</span><span class="sxs-lookup"><span data-stu-id="87142-201">.NET Core 2.0 runtime-only on Windows Nano Server</span></span> |

### <a name="multi-arch-images"></a><span data-ttu-id="87142-202">多拱形影像</span><span class="sxs-lookup"><span data-stu-id="87142-202">Multi-arch images</span></span>

<span data-ttu-id="87142-203">從 2017 年年中開始,您還可以在 Docker 中使用稱為[多拱圖像的](https://github.com/moby/moby/issues/15866)新功能。</span><span class="sxs-lookup"><span data-stu-id="87142-203">Beginning in mid-2017, you also can use a new feature in Docker called [multi-arch](https://github.com/moby/moby/issues/15866) images.</span></span> <span data-ttu-id="87142-204">.NET 核心 Docker 映射可以使用多拱標記。</span><span class="sxs-lookup"><span data-stu-id="87142-204">.NET Core Docker images can use multi-arch tags.</span></span> <span data-ttu-id="87142-205">Dockerfile 檔案不再需要定義您所針對的作業系統。</span><span class="sxs-lookup"><span data-stu-id="87142-205">Your Dockerfile files no longer need to define the operating system that you are targeting.</span></span> <span data-ttu-id="87142-206">多拱功能允許跨多個計算機配置使用單個標記。</span><span class="sxs-lookup"><span data-stu-id="87142-206">The multi-arch feature allows a single tag to be used across multiple machine configurations.</span></span> <span data-ttu-id="87142-207">例如,對於多 arch,可以使用一個通用標記 **:microsoft/dotnet:2.0.0 執行時**。</span><span class="sxs-lookup"><span data-stu-id="87142-207">For instance, with multi-arch, you can use one common tag: **microsoft/dotnet:2.0.0-runtime**.</span></span> <span data-ttu-id="87142-208">如果從 Linux 容器環境中提取該標記,則獲取基於 Debian 的映射。</span><span class="sxs-lookup"><span data-stu-id="87142-208">If you pull that tag from a Linux container environment, you get the Debian-based image.</span></span> <span data-ttu-id="87142-209">如果從 Windows 容器環境中提取該標記,則獲取基於 Nano Server 的圖像。</span><span class="sxs-lookup"><span data-stu-id="87142-209">If you pull that tag from a Windows container environment, you get the Nano Server-based image.</span></span>

<span data-ttu-id="87142-210">對於 .NET 框架圖像,由於傳統的 .NET 框架僅支援 Windows,因此無法使用多拱功能。</span><span class="sxs-lookup"><span data-stu-id="87142-210">For .NET Framework images, because the traditional .NET Framework supports only Windows, you cannot use the multi-arch feature.</span></span>

## <a name="windows-container-types"></a><span data-ttu-id="87142-211">視窗容器類型</span><span class="sxs-lookup"><span data-stu-id="87142-211">Windows container types</span></span>

<span data-ttu-id="87142-212">與 Linux 容器一樣,Windows Server 容器使用 Docker 引擎進行管理。</span><span class="sxs-lookup"><span data-stu-id="87142-212">Like Linux containers, Windows Server containers are managed by using Docker Engine.</span></span> <span data-ttu-id="87142-213">與 Linux 容器不同,Windows 容器包括兩種不同的容器類型,或運行時 -Windows Server 容器和 Hyper-V 隔離。</span><span class="sxs-lookup"><span data-stu-id="87142-213">Unlike Linux containers, Windows containers include two different container types, or run times-Windows Server containers and Hyper-V isolation.</span></span>

<span data-ttu-id="87142-214">**Windows 伺服器容器**:通過行程和命名空間隔離技術提供應用程式隔離。</span><span class="sxs-lookup"><span data-stu-id="87142-214">**Windows Server containers**: Provides application isolation through process and namespace isolation technology.</span></span> <span data-ttu-id="87142-215">Windows Server 容器與容器主機和主機上運行的所有容器共用內核。</span><span class="sxs-lookup"><span data-stu-id="87142-215">A Windows Server container shares a kernel with the container host and all containers that are running on the host.</span></span> <span data-ttu-id="87142-216">這些容器沒有提供惡意防護界限，不應用來隔離未受信任的程式碼。</span><span class="sxs-lookup"><span data-stu-id="87142-216">These containers do not provide a hostile security boundary and should not be used to isolate untrusted code.</span></span> <span data-ttu-id="87142-217">由於共用核心空間，因此這些容器需要相同的核心版本和組態。</span><span class="sxs-lookup"><span data-stu-id="87142-217">Because of the shared kernel space, these containers require the same kernel version and configuration.</span></span>

<span data-ttu-id="87142-218">**Hyper-V 隔離**:透過在高度最佳化的 VM 上執行每個容器,擴展 Windows 伺服器容器提供的隔離。</span><span class="sxs-lookup"><span data-stu-id="87142-218">**Hyper-V isolation**: Expands on the isolation provided by Windows Server Containers by running each container on a highly optimized VM.</span></span> <span data-ttu-id="87142-219">在此設定中，容器主機的核心不會與相同主機上的其他容器共用。</span><span class="sxs-lookup"><span data-stu-id="87142-219">In this configuration, the kernel of the container host is not shared with other containers on the same host.</span></span> <span data-ttu-id="87142-220">這些容器專為敵對的多租戶託管而設計,具有 VM 相同的安全保證。</span><span class="sxs-lookup"><span data-stu-id="87142-220">These containers are designed for hostile multitenant hosting, with the same security assurances of a VM.</span></span> <span data-ttu-id="87142-221">由於這些容器不與主機上的主機或其他容器共用內核,因此它們可以使用不同的版本和配置(支援的版本)運行內核。</span><span class="sxs-lookup"><span data-stu-id="87142-221">Because these containers don't share the kernel with the host or other containers on the host, they can run kernels with different versions and configurations (with supported versions).</span></span> <span data-ttu-id="87142-222">例如,Windows 10 上的所有 Windows 容器都使用 Hyper-V 隔離來利用 Windows Server 內核版本和配置。</span><span class="sxs-lookup"><span data-stu-id="87142-222">For example, all Windows containers on Windows 10 use Hyper-V isolation to utilize the Windows Server kernel version and configuration.</span></span>

<span data-ttu-id="87142-223">在 Windows 上運行具有超 V 隔離或不帶 Hyper-V 隔離的容器是一個運行時決策。</span><span class="sxs-lookup"><span data-stu-id="87142-223">Running a container on Windows with or without Hyper-V isolation is a run-time decision.</span></span> <span data-ttu-id="87142-224">您可以選擇最初使用 Hyper-V 隔離建立容器,在執行時,可以選擇將其作為 Windows Server 容器執行。</span><span class="sxs-lookup"><span data-stu-id="87142-224">You might choose to create the container with Hyper-V isolation initially, and at run time, choose to run it as a Windows Server container instead.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="87142-225">其他資源</span><span class="sxs-lookup"><span data-stu-id="87142-225">Additional resources</span></span>

- <span data-ttu-id="87142-226">**Windows 容器文件**</span><span class="sxs-lookup"><span data-stu-id="87142-226">**Windows Containers documentation**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/>

- <span data-ttu-id="87142-227">**Windows 容器基礎知識**</span><span class="sxs-lookup"><span data-stu-id="87142-227">**Windows Containers fundamentals**</span></span>

    <https://docs.microsoft.com/virtualization/windowscontainers/about/>

- <span data-ttu-id="87142-228">**資訊圖:微軟和容器**</span><span class="sxs-lookup"><span data-stu-id="87142-228">**Infographic: Microsoft and containers**</span></span>

    <https://info.microsoft.com/rs/157-GQE-382/images/Container%20infographic%201.4.17.pdf>

## <a name="the-container-ecosystem-in-azure"></a><span data-ttu-id="87142-229">Azure 的容器生態系統</span><span class="sxs-lookup"><span data-stu-id="87142-229">The container ecosystem in Azure</span></span>

<span data-ttu-id="87142-230">在前面的章節中,已經解釋了 Docker 容器的優勢以及 .NET 應用程式的特定容器映射的詳細資訊。</span><span class="sxs-lookup"><span data-stu-id="87142-230">In previous sections, it's been explained what the benefits of Docker containers are as well as details on the specific container images for .NET applications.</span></span> <span data-ttu-id="87142-231">為了開發或容器化應用程式,所有這些通用資訊都是基礎資訊。</span><span class="sxs-lookup"><span data-stu-id="87142-231">All that generic information is fundamental in order to develop or containerize an application.</span></span>
<span data-ttu-id="87142-232">但是,在考慮生產部署環境甚至 QA 和開發人員/測試環境時,Microsoft Azure 提供了一個開放且廣泛的選擇,即雲中的完整容器生態系統(如下圖所示)。</span><span class="sxs-lookup"><span data-stu-id="87142-232">However, when thinking about the production deployment environment or even QA and Dev/Test environments, Microsoft Azure provides an open and broad variety of choices, a full container ecosystem in the cloud (shown in the diagram below).</span></span> <span data-ttu-id="87142-233">根據特定應用程式的需求,應選擇一個或另一個 Azure 產品。</span><span class="sxs-lookup"><span data-stu-id="87142-233">Depending on your specific application's needs, you should choose one or another Azure product.</span></span>

![Azure 中的容器生態系統圖。](./media/deploy-existing-net-apps-as-windows-containers/azure-container-ecosystem.png)

<span data-ttu-id="87142-235">**圖 4-7.5。**</span><span class="sxs-lookup"><span data-stu-id="87142-235">**Figure 4-7.5.**</span></span> <span data-ttu-id="87142-236">Azure 的容器生態系統</span><span class="sxs-lookup"><span data-stu-id="87142-236">The container ecosystem in Azure</span></span>

<span data-ttu-id="87142-237">從 Azure 中的容器生態系統中,支援被視為基礎結構的容器的以下產品:</span><span class="sxs-lookup"><span data-stu-id="87142-237">From the container ecosystem in Azure, the following products supporting containers that are considered infrastructure:</span></span>

- <span data-ttu-id="87142-238">**Azure 容器實體 (ACI)**</span><span class="sxs-lookup"><span data-stu-id="87142-238">**Azure Container Instances (ACI)**</span></span>
- <span data-ttu-id="87142-239">**Azure 虛擬機器**(支援容器)</span><span class="sxs-lookup"><span data-stu-id="87142-239">**Azure Virtual Machines** (With container's support)</span></span>
- <span data-ttu-id="87142-240">**Azure 虛擬機器縮放集**(支援容器)</span><span class="sxs-lookup"><span data-stu-id="87142-240">**Azure Virtual Machine Scale Sets** (With container's support)</span></span>

<span data-ttu-id="87142-241">從這三個,ACI提供了一個很大的好處,這是事實,你不需要維護的基礎操作系統,不需要你升級/補丁等,但ACI仍然定位在基礎設施級別,更好地解釋在本書的後續部分。</span><span class="sxs-lookup"><span data-stu-id="87142-241">From those three, ACI provides a great benefit, which is the fact that you don't need to maintain the underlying OS, no need for you to upgrade/patch, etc. but ACI still is positioned in the infrastructure level, as better explained in the upcoming sections of this book.</span></span>

<span data-ttu-id="87142-242">Azure 支援容器中同時位於 PaaS(平台即服務)等級的產品包括:</span><span class="sxs-lookup"><span data-stu-id="87142-242">The products in Azure supporting containers that are at the same time positioned more in the PaaS (Platform as a Service) level are:</span></span>

- <span data-ttu-id="87142-243">**Azure App Service**</span><span class="sxs-lookup"><span data-stu-id="87142-243">**Azure App Service**</span></span>
- <span data-ttu-id="87142-244">**Azure 庫伯奈斯服務(AKS 和 ACS)**</span><span class="sxs-lookup"><span data-stu-id="87142-244">**Azure Kubernetes Service (AKS and ACS)**</span></span>
- <span data-ttu-id="87142-245">**Azure Batch**</span><span class="sxs-lookup"><span data-stu-id="87142-245">**Azure Batch**</span></span>

<span data-ttu-id="87142-246">然後,Azure 容器註冊表是託管在 Azure 中的高可擴展容器註冊錶,您可以在註冊和部署自定義容器映射時從所有以前的產品中使用。</span><span class="sxs-lookup"><span data-stu-id="87142-246">Then, Azure Container Registry is a high scalable container registry hosted in Azure that you can use from all the previous products when registering and deploying your custom container images.</span></span>

<span data-ttu-id="87142-247">此外,在容器中,可以使用 Azure 中的其他託管服務,如 Azure SQL 資料庫、Azure Redis 緩存、Azure Cosmos DB 等。</span><span class="sxs-lookup"><span data-stu-id="87142-247">In addition, from your containers, you can consume other managed services in Azure like Azure SQL Database, Azure Redis cache, Azure Cosmos DB, etc.</span></span> <span data-ttu-id="87142-248">此外,Azure 應用商店中還有第三方解決方案/平臺,如雲鑄造和 OpenShift,您也可以在 Azure 中使用容器。</span><span class="sxs-lookup"><span data-stu-id="87142-248">plus there are third-party solutions/platforms available in Azure Marketplace like Cloud Foundry and OpenShift where you can also use containers within Azure.</span></span>

<span data-ttu-id="87142-249">在下一節中,您可以流覽 Microsoft 關於何時使用這些 Azure 產品和解決方案的建議,特別是針對 Windows 容器時。</span><span class="sxs-lookup"><span data-stu-id="87142-249">In the next sections, you can explore Microsoft's recommendations on when to use each of those Azure products and solutions specifically when targeting Windows Containers.</span></span>

>[!div class="step-by-step"]
><span data-ttu-id="87142-250">[前一個](what-about-cloud-native-applications.md)
>[下一個](when-not-to-deploy-to-windows-containers.md)</span><span class="sxs-lookup"><span data-stu-id="87142-250">[Previous](what-about-cloud-native-applications.md)
[Next](when-not-to-deploy-to-windows-containers.md)</span></span>
