---
title: 調整容器和無伺服器應用程式的規模
description: 使用 Azure Kubernetes Service 調整雲端原生應用程式，藉由增加個別機器資源或增加應用程式叢集中的機器數目，以滿足使用者需求。
ms.date: 09/23/2019
ms.openlocfilehash: 2d0537fb3ed56beb4eccbf9b8c34a5d87793413b
ms.sourcegitcommit: 55f438d4d00a34b9aca9eedaac3f85590bb11565
ms.translationtype: MT
ms.contentlocale: zh-TW
ms.lasthandoff: 09/23/2019
ms.locfileid: "71184796"
---
# <a name="scaling-containers-and-serverless-applications"></a><span data-ttu-id="3952d-103">調整容器和無伺服器應用程式的規模</span><span class="sxs-lookup"><span data-stu-id="3952d-103">Scaling containers and serverless applications</span></span>

<span data-ttu-id="3952d-104">有兩種典型的方式可以調整應用程式：相應增加和相應放大。前者是指將功能新增至一部主機，而後者則是指新增到主機總數。</span><span class="sxs-lookup"><span data-stu-id="3952d-104">There are two typical ways to scale an application: scaling up and scaling out. The former refers to adding capabilities to one host, while the latter refers to adding to the total number of hosts.</span></span> <span data-ttu-id="3952d-105">用來思考這種常見的比喻是如何讓自己和一些朋友橫跨城鎮。</span><span class="sxs-lookup"><span data-stu-id="3952d-105">A common analogy to use to think about this is how to get yourself and some friends across town.</span></span> <span data-ttu-id="3952d-106">如果只是一個 friend，您可以跳到您的兩個基座的賽車。</span><span class="sxs-lookup"><span data-stu-id="3952d-106">If it's just one friend, you could hop into your two-seat race car.</span></span> <span data-ttu-id="3952d-107">但如果有三或四個，您可能需要採用其中一個 SUVs 或 minivan，相應增加以提高容量。</span><span class="sxs-lookup"><span data-stu-id="3952d-107">But if it's three or four, you might need to take one of your SUVs or a minivan, scaling up to increase capacity.</span></span> <span data-ttu-id="3952d-108">不過，當您的總數最多會跳到一或多個時，您可能需要採用多個車輛（除非有人推動匯流排），這會示範藉由新增更多實例（在此案例中為更多車輛）來相應放大的概念。</span><span class="sxs-lookup"><span data-stu-id="3952d-108">When your total number jumps up to a dozen or more, though, you probably need to take multiple vehicles (unless someone drives a bus), which demonstrates the concept of scaling out by adding more instances (in this case, more vehicles).</span></span> <span data-ttu-id="3952d-109">讓我們來看看這如何適用于我們的應用程式。</span><span class="sxs-lookup"><span data-stu-id="3952d-109">Let's see how this applies to our applications.</span></span>

## <a name="the-simple-solution-scaling-up"></a><span data-ttu-id="3952d-110">簡單的解決方案：向上延展</span><span class="sxs-lookup"><span data-stu-id="3952d-110">The simple solution: scaling up</span></span>

<span data-ttu-id="3952d-111">升級現有伺服器以提供更多資源（CPU、記憶體、磁片 i/o 速度、網路 i/o 速度）的程式，稱為「相應*增加*」。</span><span class="sxs-lookup"><span data-stu-id="3952d-111">The process of upgrading existing servers to give them more resources (CPU, memory, disk I/O speed, network I/O speed) is known as *scaling up*.</span></span> <span data-ttu-id="3952d-112">在雲端原生應用程式中，相應增加通常不是指購買和安裝實體電腦上的實際硬體，因此您可以從可用的選項清單中選擇更有能力的方案。</span><span class="sxs-lookup"><span data-stu-id="3952d-112">In cloud-native applications, scaling up doesn't typically refer to purchasing and installing actual hardware on physical machines so much as choosing a more capable plan from a list of options available.</span></span> <span data-ttu-id="3952d-113">雲端原生應用程式通常會藉由修改用來裝載其 Kubernetes 節點集區中個別節點的虛擬機器（VM）大小進行相應增加。</span><span class="sxs-lookup"><span data-stu-id="3952d-113">Cloud-native apps typically scale up by modifying the virtual machine (VM) size used to host the individual nodes in their Kubernetes node pool.</span></span> <span data-ttu-id="3952d-114">[下一節](leverage-containers-orchestrators.md)會進一步說明節點、叢集和 pod 之類的 Kubernetes 概念。</span><span class="sxs-lookup"><span data-stu-id="3952d-114">Kubernetes concepts like nodes, clusters, and pods are described further in [the next section](leverage-containers-orchestrators.md).</span></span> <span data-ttu-id="3952d-115">Azure 支援各種同時執行[Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sizes?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json)和[Linux](https://docs.microsoft.com/azure/virtual-machines/linux/sizes)的 VM 大小。</span><span class="sxs-lookup"><span data-stu-id="3952d-115">Azure supports a wide variety of VM sizes running both [Windows](https://docs.microsoft.com/azure/virtual-machines/windows/sizes?toc=%2fazure%2fvirtual-machines%2fwindows%2ftoc.json) and [Linux](https://docs.microsoft.com/azure/virtual-machines/linux/sizes).</span></span> <span data-ttu-id="3952d-116">若要以垂直方式調整您的應用程式，請建立具有較大節點 VM 大小的新節點集區，然後將工作負載遷移至新的集區。</span><span class="sxs-lookup"><span data-stu-id="3952d-116">To vertically scale your application, create a new node pool with a larger node VM size and then migrate workloads to the new pool.</span></span> <span data-ttu-id="3952d-117">這需要[AKS 叢集的多個節點](https://docs.microsoft.com/azure/aks/use-multiple-node-pools)集區，這是一專案前處於預覽狀態的功能。</span><span class="sxs-lookup"><span data-stu-id="3952d-117">This requires [multiple node pools for your AKS cluster](https://docs.microsoft.com/azure/aks/use-multiple-node-pools), a feature that is currently in preview.</span></span> <span data-ttu-id="3952d-118">無伺服器應用程式會藉由選擇[premium 方案](https://docs.microsoft.com/azure/azure-functions/functions-scale)和 premium 實例大小，或選擇不同的專用 app service 方案來相應增加。</span><span class="sxs-lookup"><span data-stu-id="3952d-118">Serverless apps scale up by choosing a [premium plan](https://docs.microsoft.com/azure/azure-functions/functions-scale) and premium instance sizes or by choosing a different dedicated app service plan.</span></span>

## <a name="scaling-out-cloud-native-apps"></a><span data-ttu-id="3952d-119">相應放大雲端原生應用程式</span><span class="sxs-lookup"><span data-stu-id="3952d-119">Scaling out cloud-native apps</span></span>

<span data-ttu-id="3952d-120">雲端原生應用程式可將其他節點或 pod 新增至服務要求，以支援相應放大。</span><span class="sxs-lookup"><span data-stu-id="3952d-120">Cloud-native apps support scaling out by adding additional nodes or pods to service requests.</span></span> <span data-ttu-id="3952d-121">這可以藉由調整應用程式的設定（例如，調整[節點集](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)區）*或透過自動*調整來手動完成。</span><span class="sxs-lookup"><span data-stu-id="3952d-121">This can be accomplished manually by adjusting configuration settings for the app (for example, [scaling a node pool](https://docs.microsoft.com/azure/aks/use-multiple-node-pools#scale-a-node-pool-manually)), or through *autoscaling*.</span></span> <span data-ttu-id="3952d-122">自動調整會調整應用程式所使用的資源，以回應需求，類似于控溫器如何藉由撥打額外的加熱或冷卻來回應溫度。</span><span class="sxs-lookup"><span data-stu-id="3952d-122">Autoscaling adjusts the resources used by an app in order to respond to demand, similar to how a thermostat responds to temperature by calling for additional heating or cooling.</span></span> <span data-ttu-id="3952d-123">使用自動調整時，會停用手動縮放。</span><span class="sxs-lookup"><span data-stu-id="3952d-123">When using autoscaling, manual scaling is disabled.</span></span>

<span data-ttu-id="3952d-124">AKS 叢集可以透過下列兩種方式的其中一種進行調整：</span><span class="sxs-lookup"><span data-stu-id="3952d-124">AKS clusters can scale in one of two ways:</span></span>

- <span data-ttu-id="3952d-125">叢集[自動調整程式](https://docs.microsoft.com/azure/aks/cluster-autoscaler)會監看因為資源限制而無法在節點上排程的 pod。</span><span class="sxs-lookup"><span data-stu-id="3952d-125">The [cluster autoscaler](https://docs.microsoft.com/azure/aks/cluster-autoscaler) watches for pods that can't be scheduled on nodes because of resource constraints.</span></span> <span data-ttu-id="3952d-126">它會視需要新增其他節點。</span><span class="sxs-lookup"><span data-stu-id="3952d-126">It adds additional nodes as required.</span></span>
- <span data-ttu-id="3952d-127">**水準 pod 自動調整程式**會使用 Kubernetes 叢集中的計量伺服器來監視 pod 的資源需求。</span><span class="sxs-lookup"><span data-stu-id="3952d-127">The **horizontal pod autoscaler** uses the Metrics Server in a Kubernetes cluster to monitor the resource demands of pods.</span></span> <span data-ttu-id="3952d-128">如果服務需要更多資源，自動調整程式會增加 pod 數目。</span><span class="sxs-lookup"><span data-stu-id="3952d-128">If a service needs more resources, the autoscaler increases the number of pods.</span></span>

<span data-ttu-id="3952d-129">圖3-13 顯示這兩個調整服務之間的關聯性。</span><span class="sxs-lookup"><span data-stu-id="3952d-129">Figure 3-13 shows the relationship between these two scaling services.</span></span>

![相應放大 App Service 計畫。](./media/aks-cluster-autoscaler.png)

<span data-ttu-id="3952d-131">**圖 3-13**。</span><span class="sxs-lookup"><span data-stu-id="3952d-131">**Figure 3-13**.</span></span> <span data-ttu-id="3952d-132">相應放大 App Service 計畫。</span><span class="sxs-lookup"><span data-stu-id="3952d-132">Scaling out an App Service plan.</span></span>

<span data-ttu-id="3952d-133">這些服務也可以視需要減少 pod 或節點的數目。</span><span class="sxs-lookup"><span data-stu-id="3952d-133">These services can also reduce the number of pods or nodes as needed.</span></span> <span data-ttu-id="3952d-134">這兩項服務可以一起使用，而且通常會一起部署在叢集中。</span><span class="sxs-lookup"><span data-stu-id="3952d-134">These two services can work together and are often deployed together in a cluster.</span></span> <span data-ttu-id="3952d-135">合併時，水準 pod 自動調整程式著重于執行滿足應用程式需求所需的 pod 數目。</span><span class="sxs-lookup"><span data-stu-id="3952d-135">When combined, the horizontal pod autoscaler is focused on running the number of pods required to meet application demand.</span></span> <span data-ttu-id="3952d-136">叢集自動調整程式著重于執行支援已排程 pod 所需的節點數目。</span><span class="sxs-lookup"><span data-stu-id="3952d-136">The cluster autoscaler is focused on running the number of nodes required to support the scheduled pods.</span></span>

### <a name="scaling-azure-functions"></a><span data-ttu-id="3952d-137">調整 Azure Functions</span><span class="sxs-lookup"><span data-stu-id="3952d-137">Scaling Azure Functions</span></span>

<span data-ttu-id="3952d-138">Azure Functions 會自動支援相應放大。預設取用方案會根據傳入的觸發事件數目，動態地新增（和移除）資源。</span><span class="sxs-lookup"><span data-stu-id="3952d-138">Azure Functions automatically supports scaling out. The default consumption plan adds (and removes) resources dynamically based on the number of triggering events coming in.</span></span> <span data-ttu-id="3952d-139">當您的函式執行時，您只需支付所使用的計算資源費用，取決於所使用的執行次數、執行時間和記憶體。</span><span class="sxs-lookup"><span data-stu-id="3952d-139">You're only charged for compute resources being used when your functions are running based on the number of executions, execution time, and memory used.</span></span> <span data-ttu-id="3952d-140">使用高階方案，您可以取得這些相同的功能，但您也可以控制使用的實例大小、已準備就緒的實例（以避免冷啟動延遲），以及設定要在其上執行函數的專用 Vm。</span><span class="sxs-lookup"><span data-stu-id="3952d-140">Using the premium plan, you get these same features but you can also control the instance sizes that are used, have instances already warmed up (to avoid cold start delays), and configure dedicated VMs on which to run your functions.</span></span> <span data-ttu-id="3952d-141">雖然預設設定應為大部分應用程式提供經濟實惠且可調整的解決方案，但 premium 選項可讓開發人員彈性自訂 Azure Functions 需求。</span><span class="sxs-lookup"><span data-stu-id="3952d-141">While the default configuration should provide an economical and scalable solution for most apps, the premium option allows developers flexibility for custom Azure Functions requirements.</span></span>

## <a name="references"></a><span data-ttu-id="3952d-142">參考</span><span class="sxs-lookup"><span data-stu-id="3952d-142">References</span></span>

- [<span data-ttu-id="3952d-143">AKS 多個節點集區</span><span class="sxs-lookup"><span data-stu-id="3952d-143">AKS Multiple Node Pools</span></span>](https://docs.microsoft.com/azure/aks/use-multiple-node-pools)
- [<span data-ttu-id="3952d-144">AKS Cluster 自動調整程式</span><span class="sxs-lookup"><span data-stu-id="3952d-144">AKS Cluster Autoscaler</span></span>](https://docs.microsoft.com/azure/aks/cluster-autoscaler)
- [<span data-ttu-id="3952d-145">教學課程：在 AKS 中調整應用程式</span><span class="sxs-lookup"><span data-stu-id="3952d-145">Tutorial: Scale applications in AKS</span></span>](https://docs.microsoft.com/azure/aks/tutorial-kubernetes-scale)
- [<span data-ttu-id="3952d-146">Azure Functions 規模和裝載</span><span class="sxs-lookup"><span data-stu-id="3952d-146">Azure Functions scale and hosting</span></span>](https://docs.microsoft.com/azure/azure-functions/functions-scale)

>[!div class="step-by-step"]
><span data-ttu-id="3952d-147">[上一頁](deploy-containers-azure.md)
>[下一頁](other-deployment-options.md)</span><span class="sxs-lookup"><span data-stu-id="3952d-147">[Previous](deploy-containers-azure.md)
[Next](other-deployment-options.md)</span></span>
